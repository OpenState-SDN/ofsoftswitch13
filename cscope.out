cscope 15 $HOME/hani-xfsm/stateful-ofsoftswitch13               0001587028
	@config.h

6 
	#BUILDNR
 ""

	)

12 
	#HAVE_IF_PACKET
 1

	)

15 
	#HAVE_INTTYPES_H
 1

	)

18 
	#HAVE_LIBNBEE
 1

	)

25 
	#HAVE_MALLOC_HOOKS
 1

	)

28 
	#HAVE_MEMORY_H
 1

	)

31 
	#HAVE_NETLINK
 1

	)

37 
	#HAVE_STDINT_H
 1

	)

40 
	#HAVE_STDLIB_H
 1

	)

43 
	#HAVE_STRINGS_H
 1

	)

46 
	#HAVE_STRING_H
 1

	)

52 
	#HAVE_STRSIGNAL
 1

	)

55 
	#HAVE_SYS_STAT_H
 1

	)

58 
	#HAVE_SYS_TYPES_H
 1

	)

61 
	#HAVE_UNISTD_H
 1

	)

73 
	#PACKAGE
 "›íÊow"

	)

76 
	#PACKAGE_BUGREPORT
 "›íÊow-discuss@›íÊowswôch.‹g"

	)

79 
	#PACKAGE_NAME
 "›íÊow"

	)

82 
	#PACKAGE_STRING
 "›íÊow 1.3.0"

	)

85 
	#PACKAGE_TARNAME
 "›íÊow"

	)

88 
	#PACKAGE_URL
 ""

	)

91 
	#PACKAGE_VERSION
 "1.3.0"

	)

97 
	#STDC_HEADERS
 1

	)

103 #i‚de‡
_ALL_SOURCE


104 
	#_ALL_SOURCE
 1

	)

107 #i‚de‡
_GNU_SOURCE


108 
	#_GNU_SOURCE
 1

	)

111 #i‚de‡
_POSIX_PTHREAD_SEMANTICS


112 
	#_POSIX_PTHREAD_SEMANTICS
 1

	)

115 #i‚de‡
_TANDEM_SOURCE


116 
	#_TANDEM_SOURCE
 1

	)

119 #i‚de‡
__EXTENSIONS__


120 
	#__EXTENSIONS__
 1

	)

125 
	#VERSION
 "1.3.0"

	)

128 #i‚de‡
_DARWIN_USE_64_BIT_INODE


129 
	#_DARWIN_USE_64_BIT_INODE
 1

	)

	@include/openflow/nicira-ext.h

17 #i‚de‡
OPENFLOW_NICIRA_EXT_H


18 
	#OPENFLOW_NICIRA_EXT_H
 1

	)

20 
	~"›íÊow/›íÊow.h
"

22 
	#NICIRA_OUI_STR
 "002320"

	)

28 
	#NX_VENDOR_ID
 0x00002320

	)

30 
	enicúa_ty≥
 {

34 
	mNXT_STATUS_REQUEST
,

38 
	mNXT_STATUS_REPLY
,

41 
	mNXT_ACT_SET_CONFIG__OBSOLETE
,

42 
	mNXT_ACT_GET_CONFIG__OBSOLETE
,

43 
	mNXT_COMMAND_REQUEST__OBSOLETE
,

44 
	mNXT_COMMAND_REPLY__OBSOLETE
,

45 
	mNXT_FLOW_END_CONFIG__OBSOLETE
,

46 
	mNXT_FLOW_END__OBSOLETE
,

47 
	mNXT_MGMT__OBSOLETE
,

51 
	mNXT_TUN_ID_FROM_COOKIE
,

55 
	mNXT_ROLE_REQUEST
,

56 
	mNXT_ROLE_REPLY


59 
	snicúa_hódî
 {

60 
oÂ_hódî
 
	mhódî
;

61 
uöt32_t
 
	mvíd‹
;

62 
uöt32_t
 
	msubty≥
;

64 
OFP_ASSERT
((
nicúa_hódî
) == 16);

66 
	snxt_tun_id_cookõ
 {

67 
oÂ_hódî
 
	mhódî
;

68 
uöt32_t
 
	mvíd‹
;

69 
uöt32_t
 
	msubty≥
;

70 
uöt8_t
 
	m£t
;

71 
uöt8_t
 
	m∑d
[7];

73 
OFP_ASSERT
((
nxt_tun_id_cookõ
) == 24);

94 
	snx_rﬁe_ªque°
 {

95 
nicúa_hódî
 
	mnxh
;

96 
uöt32_t
 
	mrﬁe
;

99 
	enx_rﬁe
 {

100 
	mNX_ROLE_OTHER
,

101 
	mNX_ROLE_MASTER
,

102 
	mNX_ROLE_SLAVE


105 
	enx_a˘i⁄_subty≥
 {

106 
	mNXAST_SNAT__OBSOLETE
,

132 
	mNXAST_RESUBMIT
,

135 
	mNXAST_SET_TUNNEL
,

145 
	mNXAST_DROP_SPOOFED_ARP


149 
	snx_a˘i⁄_ªsubmô
 {

150 
uöt16_t
 
	mty≥
;

151 
uöt16_t
 
	mÀn
;

152 
uöt32_t
 
	mvíd‹
;

153 
uöt16_t
 
	msubty≥
;

154 
uöt16_t
 
	mö_p‹t
;

155 
uöt8_t
 
	m∑d
[4];

157 
OFP_ASSERT
((
nx_a˘i⁄_ªsubmô
) == 16);

160 
	snx_a˘i⁄_£t_tu¬ñ
 {

161 
uöt16_t
 
	mty≥
;

162 
uöt16_t
 
	mÀn
;

163 
uöt32_t
 
	mvíd‹
;

164 
uöt16_t
 
	msubty≥
;

165 
uöt8_t
 
	m∑d
[2];

166 
uöt32_t
 
	mtun_id
;

168 
OFP_ASSERT
((
nx_a˘i⁄_£t_tu¬ñ
) == 16);

171 
	snx_a˘i⁄_hódî
 {

172 
uöt16_t
 
	mty≥
;

173 
uöt16_t
 
	mÀn
;

174 
uöt32_t
 
	mvíd‹
;

175 
uöt16_t
 
	msubty≥
;

176 
uöt8_t
 
	m∑d
[6];

178 
OFP_ASSERT
((
nx_a˘i⁄_hódî
) == 16);

181 
	#NXFW_TUN_ID
 (1 << 25)

	)

182 
	#NXFW_NW_SRC
 (1 << 26)

	)

183 
	#NXFW_NW_DST
 (1 << 27)

	)

184 
	#NXFW_DL_SRC
 (1 << 28)

	)

185 
	#NXFW_DL_DST
 (1 << 29)

	)

187 
	#NXFW_ALL
 
NXFW_TUN_ID
 | 
NXFW_NW_SRC
 | 
NXFW_NW_DST
 | 
NXFW_DL_SRC
 | 
NXFW_DL_DST


	)

188 
	#OVSFW_ALL
 (
OFPFW_ALL
 | 
NXFW_ALL
)

	)

	@include/openflow/of_hw_api.h

34 #i‡!
deföed
(
OF_HW_API_H
)

35 
	#OF_HW_API_H


	)

51 
	~<›íÊow/›íÊow.h
>

52 
	~<ud©≠©h/èbÀ.h
>

68 
uöt32_t
 
	tof_p‹t_t
;

69 
of_hw_drivî
 
	tof_hw_drivî_t
;

74 *
	tos_pkt_t
;

77 
	sof_∑ckë_s
 {

78 *
	md©a
;

79 
	mÀngth
;

80 
os_pkt_t
 
	mos_pkt
;

81 } 
	tof_∑ckë_t
;

84 
	#OF_PKT_INIT
(
pkt
, 
oÂ_buf
) do { \

85 (
pkt
)->
d©a
 = (
oÂ_buf
)->data; \

86 (
pkt
)->
Àngth
 = (
oÂ_buf
)->
size
; \

87 (
pkt
)->
os_pkt
 = (
oÂ_buf
); \

88 } 0)

	)

93 (*
	tof_∑ckë_ö_f
)(
	tof_p‹t_t
 
	tp‹t
,

94 
	tof_∑ckë_t
 *
	t∑ckë
,

95 
	tªas⁄
,

96 *
	tcookõ
);

98 (*
	tof_p‹t_ch™ge_f
)(
	tof_p‹t_t
 
	tp‹t
,

99 
	t°©e
,

100 *
	tcookõ
);

109 
	sof_hw_drivî_ˇps
 {

117 
uöt32_t
 
Êags
;

120 
max_Êows
;

121 
uöt32_t
 
wc_suµ‹ãd
;

122 
uöt32_t
 
a˘i⁄s_suµ‹ãd
;

123 
uöt32_t
 
oÂc_Êags
;

124 } 
	tof_hw_drivî_ˇps_t
;

126 
	eof_hw_drivî_Êags
 {

127 
OF_HW_DRV_COUNT_PKTS_OR_BYTES
 = 1 << 0,

128 
OF_HW_DRV_INTERNAL_PRI
 = 1 << 1,

129 
OF_HW_DRV_CPU_PKTS_THRU_TABLE
 = 1 << 2

134 
of_hw_drivî_t
 *
	`√w_of_hw_drivî
(
d©≠©h
 *
dp
);

135 
	`dñëe_of_hw_drivî
(
of_hw_drivî_t
 *
hw_drv
);

141 
	sof_hw_drivî
 {

151 
sw_èbÀ
 sw_table;

154 
of_hw_drivî_ˇps_t
 
ˇps
;

168 (*
öô
)(
of_hw_drivî_t
 *
hw_drv
, 
uöt32_t
 
Êags
);

188 (*
èbÀ_°©s_gë
)(
of_hw_drivî_t
 *
hw_drv
, 

189 
oÂ_èbÀ_°©s
 *
°©s
);

190 (*
p‹t_°©s_gë
)(
of_hw_drivî_t
 *
hw_drv
, 
of_p‹t
,

191 
oÂ_p‹t_°©s
 *
°©s
);

192 (*
Êow_°©s_gë
)(
of_hw_drivî_t
 *
hw_drv
, 
oÂ_m©ch
,

193 
oÂ_Êow_°©s
 **
°©s
, *
cou¡
);

194 (*
aggªg©e_°©s_gë
)(
oÂ_m©ch
,

195 
oÂ_aggªg©e_°©s_ª∂y
 *
°©s
);

203 (*
p‹t_add
)(
of_hw_drivî_t
 *
hw_drv
, 
of_p‹t
, c⁄° *
hw_«me
);

204 (*
p‹t_ªmove
)(
of_hw_drivî_t
 *
hw_drv
, 
of_p‹t_t
 
p‹t
);

214 (*
p‹t_lök_gë
)(
of_hw_drivî_t
 *
hw_drv
, 
of_p‹t
);

215 (*
p‹t_íabÀ_£t
)(
of_hw_drivî_t
 *
hw_drv
, 
of_p‹t
, 
íabÀ
);

216 (*
p‹t_íabÀ_gë
)(
of_hw_drivî_t
 *
hw_drv
, 
of_p‹t
);

224 (*
p‹t_queue_c⁄fig
)(
of_hw_drivî_t
 *
hw_drv
, 
of_p‹t
,

225 
uöt32_t
 
qid
, 
mö_bw
);

226 (*
p‹t_queue_ªmove
)(
of_hw_drivî_t
 *
hw_drv
, 
of_p‹t
,

227 
uöt32_t
 
qid
);

235 (*
p‹t_ch™ge_ªgi°î
)(
of_hw_drivî_t
 *
hw_drv
,

236 
of_p‹t_ch™ge_f
 
ˇŒback
, *
cookõ
);

251 (*
∑ckë_£nd
)(
of_hw_drivî_t
 *
hw_drv
, 
of_p‹t
, 
of_∑ckë_t
 *
pkt
,

252 
uöt32_t
 
Êags
);

262 (*
∑ckë_ª˚ive_ªgi°î
)(
of_hw_drivî_t
 *
hw_drv
,

263 
of_∑ckë_ö_f
 
ˇŒback
, *
cookõ
);

290 (*
io˘l
)(
of_hw_drivî_t
 *
hw_drv
, 
uöt32_t
 
›
, **
io_∑øm
,

291 *
io_Àn
);

297 
	eof_hw_io˘l_e
 {

298 
OF_HW_IOCTL_TABLE_DEBUG_SET
 = 1,

299 
OF_HW_IOCTL_PORT_DEBUG_SET
 = 2,

300 
OF_HW_IOCTL_BYTE_PKT_CNTR_SET
 = 3

304 
	#OF_HW_CNTR_PACKETS
 0

	)

305 
	#OF_HW_CNTR_BYTES
 1

	)

307 
	eof_hw_îr‹_e
 {

308 
OF_HW_OKAY
 = 0,

309 
OF_HW_ERROR
 = -1,

310 
OF_HW_PORT_DOWN
 = -2

	@include/openflow/openflow-ext.h

6 #i‚de‡
OPENFLOW_OPENFLOW_EXT_H


7 
	#OPENFLOW_OPENFLOW_EXT_H
 1

	)

9 
	~"›íÊow/›íÊow.h
"

19 
	#OPENFLOW_VENDOR_ID
 0x000026e1

	)

21 
	eoÂ_exãnsi⁄_comm™ds
 {

23 
	mOFP_EXT_QUEUE_MODIFY
,

24 
	mOFP_EXT_QUEUE_DELETE
,

25 
	mOFP_EXT_SET_DESC
,

27 
	mOFP_EXT_COUNT


30 
	soÂ_exãnsi⁄_hódî
 {

31 
oÂ_hódî
 
	mhódî
;

32 
uöt32_t
 
	mvíd‹
;

33 
uöt32_t
 
	msubty≥
;

35 
OFP_ASSERT
((
oÂ_exãnsi⁄_hódî
) == 16);

43 
	s›íÊow_queue_comm™d_hódî
 {

44 
oÂ_exãnsi⁄_hódî
 
	mhódî
;

45 
uöt32_t
 
	mp‹t
;

46 
uöt8_t
 
	m∑d
[4];

47 
uöt8_t
 
	mbody
[0];

49 
OFP_ASSERT
((
›íÊow_queue_comm™d_hódî
) == 24);

63 
	e›íÊow_queue_îr‹_code
 {

64 
	mOFQ_ERR_NONE
,

65 
	mOFQ_ERR_FAIL
,

66 
	mOFQ_ERR_NOT_FOUND
,

67 
	mOFQ_ERR_DISCIPLINE
,

68 
	mOFQ_ERR_BW_UNAVAIL
,

69 
	mOFQ_ERR_QUEUE_UNAVAIL
,

70 
	mOFQ_ERR_COUNT


73 
	#OPENFLOW_QUEUE_ERROR_STRINGS_DEF
 { \

80 }

	)

82 *
›íÊow_queue_îr‹_°rögs
[];

84 
	s›íÊow_ext_£t_dp_desc
 {

85 
oÂ_exãnsi⁄_hódî
 
	mhódî
;

86 
	mdp_desc
[
DESC_STR_LEN
];

88 
OFP_ASSERT
((
›íÊow_ext_£t_dp_desc
) == 272);

90 
	#ofq_îr‹_°rög
(
rv
Ë((‘vË< 
OFQ_ERR_COUNT
) && ((rv) >= 0) ? \

91 
›íÊow_queue_îr‹_°rögs
[
rv
] : "Unknow¿îr‹ code")

	)

101 
	#OPENFLOW_QUEUE_PROP_STRINGS_DEF
 { \

107 }

	)

108 *
›íÊow_queue_¥›_°rögs
[];

110 
	#ofq_¥›_°rög
(
vÆ
Ë(((vÆË< 
OFPQT_EXT_COUNT
) && ((val) >= 0) ? \

111 
›íÊow_queue_¥›_°rögs
[
vÆ
] : "Unknow¿¥›îty vÆue")

	)

115 
	soÂ_queue_¥›_buf_Æloc
 {

116 
oÂ_queue_¥›_hódî
 
	m¥›_hódî
;

117 
uöt16_t
 
	mÆloc_vÆ
;

118 
uöt8_t
 
	m∑d
[6];

120 
OFP_ASSERT
((
oÂ_queue_¥›_buf_Æloc
) == 16);

123 
	soÂ_queue_¥›_sched_weight
 {

124 
oÂ_queue_¥›_hódî
 
	m¥›_hódî
;

125 
uöt16_t
 
	mweight
;

126 
uöt8_t
 
	m∑d
[6];

128 
OFP_ASSERT
((
oÂ_queue_¥›_sched_weight
) == 16);

	@include/openflow/openflow-netlink.h

34 #i‚de‡
OPENFLOW_OPENFLOW_NETLINK_H


35 
	#OPENFLOW_OPENFLOW_NETLINK_H
 1

	)

37 
	#DP_GENL_FAMILY_NAME
 "O≥nFlow"

	)

41 
	mDP_GENL_A_UNSPEC
,

42 
	mDP_GENL_A_DP_IDX
,

43 
	mDP_GENL_A_PORTNAME
,

44 
	mDP_GENL_A_MC_GROUP
,

45 
	mDP_GENL_A_OPENFLOW
,

46 
	mDP_GENL_A_DP_NAME
,

48 
	m__DP_GENL_A_MAX
,

49 
	mDP_GENL_A_MAX
 = 
__DP_GENL_A_MAX
 - 1

53 
	edp_gíl_comm™d
 {

54 
	mDP_GENL_C_UNSPEC
,

55 
	mDP_GENL_C_ADD_DP
,

56 
	mDP_GENL_C_DEL_DP
,

57 
	mDP_GENL_C_QUERY_DP
,

58 
	mDP_GENL_C_ADD_PORT
,

59 
	mDP_GENL_C_DEL_PORT
,

60 
	mDP_GENL_C_OPENFLOW
,

62 
	m__DP_GENL_C_MAX
,

63 
	mDP_GENL_C_MAX
 = 
__DP_GENL_C_MAX
 - 1

67 
	#DP_MAX
 256

	)

	@include/openflow/openflow.h

3 #i‚de‡
OPENFLOW_OPENFLOW_H


4 
	#OPENFLOW_OPENFLOW_H
 1

	)

6 #ifde‡
__KERNEL__


7 
	~<löux/ty≥s.h
>

9 
	~<°döt.h
>

11 #ifde‡
SWIG


12 
	#OFP_ASSERT
(
EXPR
Ë

	)

13 #ñi‡!
deföed
(
__˝lu•lus
)

15 
	#OFP_ASSERT
(
EXPR
) \

16 (*
	`buûd_as£π
())[ (struct { \

17 
buûd_as£π_Áûed
 : (
EXPR
Ë? 1 : -1; })]

	)

19 
	#OFP_ASSERT
(
_EXPR
Ë
	tbuûd_as£π_Áûed
[(_EXPRË? 1 : -1]

	)

21 #i‚de‡
	tSWIG


22 
	tOFP_PACKED
 
	t__©åibuã__
((
	t∑cked
))

	)

24 
	tOFP_PACKED


	)

35 
	tOFP_VERSION
 0x04

	)

36 
	tOFP_MAX_TABLE_NAME_LEN
 32

	)

37 
	tOFP_MAX_PORT_NAME_LEN
 16

	)

38 
	tOFP_TCP_PORT
 6633

	)

39 
	tOFP_SSL_PORT
 6633

	)

40 
	tOFP_ETH_ALEN
 6

	)

42 
	tPIPELINE_TABLES
 64

	)

45 
	soÂ_hódî
 {

46 
uöt8_t
 
vîsi⁄
;

47 
uöt8_t
 
ty≥
;

48 
uöt16_t
 
Àngth
;

49 
uöt32_t
 
xid
;

53 
OFP_ASSERT
((
oÂ_hódî
) == 8);

55 
	eoÂ_ty≥
 {

57 
	mOFPT_HELLO
 = 0,

58 
	mOFPT_ERROR
 = 1,

59 
	mOFPT_ECHO_REQUEST
 = 2,

60 
	mOFPT_ECHO_REPLY
 = 3,

61 
	mOFPT_EXPERIMENTER
 = 4,

63 
	mOFPT_FEATURES_REQUEST
 = 5,

64 
	mOFPT_FEATURES_REPLY
 = 6,

65 
	mOFPT_GET_CONFIG_REQUEST
 = 7,

66 
	mOFPT_GET_CONFIG_REPLY
 = 8,

67 
	mOFPT_SET_CONFIG
 = 9,

69 
	mOFPT_PACKET_IN
 = 10,

70 
	mOFPT_FLOW_REMOVED
 = 11,

71 
	mOFPT_PORT_STATUS
 = 12,

73 
	mOFPT_PACKET_OUT
 = 13,

74 
	mOFPT_FLOW_MOD
 = 14,

75 
	mOFPT_GROUP_MOD
 = 15,

76 
	mOFPT_PORT_MOD
 = 16,

77 
	mOFPT_TABLE_MOD
 = 17,

79 
	mOFPT_MULTIPART_REQUEST
 = 18,

80 
	mOFPT_MULTIPART_REPLY
 = 19,

82 
	mOFPT_BARRIER_REQUEST
 = 20,

83 
	mOFPT_BARRIER_REPLY
 = 21,

85 
	mOFPT_QUEUE_GET_CONFIG_REQUEST
 = 22,

86 
	mOFPT_QUEUE_GET_CONFIG_REPLY
 = 23,

88 
	mOFPT_ROLE_REQUEST
 = 24,

89 
	mOFPT_ROLE_REPLY
 = 25,

91 
	mOFPT_GET_ASYNC_REQUEST
 = 26,

92 
	mOFPT_GET_ASYNC_REPLY
 = 27,

93 
	mOFPT_SET_ASYNC
 = 28,

95 
	mOFPT_METER_MOD
 = 29,

96 
	mOFPT_STATE_MOD
 = 30,

102 
	#OFPSC_MAX_FIELD_COUNT
 6

	)

103 
	#OFPSC_MAX_KEY_LEN
 48

	)

105 
	soÂ_°©e_mod
 {

106 
oÂ_hódî
 
	mhódî
;

107 
uöt64_t
 
	mcookõ
;

108 
uöt64_t
 
	mcookõ_mask
;

109 
uöt8_t
 
	mèbÀ_id
;

110 
uöt8_t
 
	mcomm™d
;

112 
uöt8_t
 
	m∑ylﬂd
[];

115 
	soÂ_°©e_íåy
 {

116 
uöt32_t
 
	mkey_Àn
;

118 
uöt64_t
 
	m°©e
;

119 
uöt8_t
 
	mkey
[
OFPSC_MAX_KEY_LEN
];

122 
	soÂ_exåa˘i⁄
 {

123 
uöt32_t
 
	mfõld_cou¡
;

124 
uöt8_t
 
	mfõlds
[
OFPSC_MAX_FIELD_COUNT
];

127 
	eoÂ_°©e_mod_comm™d
 {

128 
	mOFPSC_SET_L_EXTRACTOR
 = 0,

129 
	mOFPSC_SET_U_EXTRACTOR
,

130 
	mOFPSC_ADD_FLOW_STATE
,

131 
	mOFPSC_DEL_FLOW_STATE


136 
	soÂ_hñlo
 {

137 
oÂ_hódî
 
	mhódî
;

140 
	#OFP_DEFAULT_MISS_SEND_LEN
 128

	)

146 
	soÂ_p‹t
 {

147 
uöt32_t
 
	mp‹t_no
;

148 
uöt8_t
 
	m∑d
[4];

149 
uöt8_t
 
	mhw_addr
[
OFP_ETH_ALEN
];

150 
uöt8_t
 
	m∑d2
[2];

151 
	m«me
[
OFP_MAX_PORT_NAME_LEN
];

152 
uöt32_t
 
	mc⁄fig
;

153 
uöt32_t
 
	m°©e
;

156 
uöt32_t
 
	mcuº
;

157 
uöt32_t
 
	madvîti£d
;

158 
uöt32_t
 
	msuµ‹ãd
;

159 
uöt32_t
 
	m≥î
;

160 
uöt32_t
 
	mcuº_•ìd
;

161 
uöt32_t
 
	mmax_•ìd
;

163 
OFP_ASSERT
((
oÂ_p‹t
) == 64);

169 
	eoÂ_p‹t_c⁄fig
 {

170 
	mOFPPC_PORT_DOWN
 = 1 << 0,

171 
	mOFPPC_NO_RECV
 = 1 << 2,

172 
	mOFPPC_NO_FWD
 = 1 << 5,

173 
	mOFPPC_NO_PACKET_IN
 = 1 << 6

179 
	eoÂ_p‹t_°©e
 {

180 
	mOFPPS_LINK_DOWN
 = 1 << 0,

181 
	mOFPPS_BLOCKED
 = 1 << 1,

182 
	mOFPPS_LIVE
 = 1 << 2,

186 
	eoÂ_p‹t_no
 {

188 
	mOFPP_MAX
 = 0xffffff00,

190 
	mOFPP_IN_PORT
 = 0xfffffff8,

194 
	mOFPP_TABLE
 = 0xfffffff9,

197 
	mOFPP_NORMAL
 = 0xfffffffa,

198 
	mOFPP_FLOOD
 = 0xfffffffb,

200 
	mOFPP_ALL
 = 0xfffffffc,

201 
	mOFPP_CONTROLLER
 = 0xfffffffd,

202 
	mOFPP_LOCAL
 = 0xfffffffe,

203 
	mOFPP_ANY
 = 0xffffffff

210 
	eoÂ_p‹t_„©uªs
 {

211 
	mOFPPF_10MB_HD
 = 1 << 0,

212 
	mOFPPF_10MB_FD
 = 1 << 1,

213 
	mOFPPF_100MB_HD
 = 1 << 2,

214 
	mOFPPF_100MB_FD
 = 1 << 3,

215 
	mOFPPF_1GB_HD
 = 1 << 4,

216 
	mOFPPF_1GB_FD
 = 1 << 5,

217 
	mOFPPF_10GB_FD
 = 1 << 6,

218 
	mOFPPF_40GB_FD
 = 1 << 7,

219 
	mOFPPF_100GB_FD
 = 1 << 8,

220 
	mOFPPF_1TB_FD
 = 1 << 9,

221 
	mOFPPF_OTHER
 = 1 << 10,

222 
	mOFPPF_COPPER
 = 1 << 11,

223 
	mOFPPF_FIBER
 = 1 << 12,

224 
	mOFPPF_AUTONEG
 = 1 << 13,

225 
	mOFPPF_PAUSE
 = 1 << 14,

226 
	mOFPPF_PAUSE_ASYM
 = 1 << 15

230 
	soÂ_queue_¥›_hódî
 {

231 
uöt16_t
 
	m¥›îty
;

232 
uöt16_t
 
	mÀn
;

233 
uöt8_t
 
	m∑d
[4];

235 
OFP_ASSERT
((
oÂ_queue_¥›_hódî
) == 8);

238 
	soÂ_∑ckë_queue
 {

239 
uöt32_t
 
	mqueue_id
;

240 
uöt32_t
 
	mp‹t
;

241 
uöt16_t
 
	mÀn
;

242 
uöt8_t
 
	m∑d
[6];

243 
oÂ_queue_¥›_hódî
 
	m¥›îtõs
[0];

245 
OFP_ASSERT
((
oÂ_∑ckë_queue
) == 16);

248 
	#OFPQ_ALL
 0xffffffff

	)

251 
	#OFPQ_MIN_RATE_UNCFG
 0xffff

	)

254 
	eoÂ_queue_¥›îtõs
 {

255 
	mOFPQT_MIN_RATE
 = 1,

256 
	mOFPQT_MAX_RATE
 = 2,

257 
	mOFPQT_EXPERIMENTER
 = 0xffff

261 
	soÂ_queue_¥›_mö_øã
 {

262 
oÂ_queue_¥›_hódî
 
	m¥›_hódî
;

263 
uöt16_t
 
	møã
;

264 
uöt8_t
 
	m∑d
[6];

266 
OFP_ASSERT
((
oÂ_queue_¥›_mö_øã
) == 16);

269 
	soÂ_queue_¥›_max_øã
 {

270 
oÂ_queue_¥›_hódî
 
	m¥›_hódî
;

271 
uöt16_t
 
	møã
;

272 
uöt8_t
 
	m∑d
[6];

274 
OFP_ASSERT
((
oÂ_queue_¥›_max_øã
) == 16);

277 
	soÂ_queue_¥›_ex≥rimíãr
 {

278 
oÂ_queue_¥›_hódî
 
	m¥›_hódî
;

279 
uöt32_t
 
	mex≥rimíãr
;

281 
uöt8_t
 
	m∑d
[4];

282 
uöt8_t
 
	md©a
[0];

284 
OFP_ASSERT
((
oÂ_queue_¥›_ex≥rimíãr
) == 16);

287 
	soÂ_m©ch
 {

288 
uöt16_t
 
	mty≥
;

289 
uöt16_t
 
	mÀngth
;

297 
uöt8_t
 
	moxm_fõlds
[4];

299 
OFP_ASSERT
((
oÂ_m©ch
) == 8);

308 
	eoÂ_m©ch_ty≥
 {

309 
	mOFPMT_STANDARD
 = 0,

310 
	mOFPMT_OXM
 = 1,

318 
	eoÂ_oxm_˛ass
 {

319 
	mOFPXMC_NXM_0
 = 0x0000,

320 
	mOFPXMC_NXM_1
 = 0x0001,

321 
	mOFPXMC_OPENFLOW_BASIC
 = 0x8000,

322 
	mOFPXMC_EXPERIMENTER
 = 0xFFFF,

326 
	eoxm_ofb_m©ch_fõlds
 {

327 
	mOFPXMT_OFB_IN_PORT
 = 0,

328 
	mOFPXMT_OFB_IN_PHY_PORT
 = 1,

329 
	mOFPXMT_OFB_METADATA
 = 2,

330 
	mOFPXMT_OFB_ETH_DST
 = 3,

331 
	mOFPXMT_OFB_ETH_SRC
 = 4,

332 
	mOFPXMT_OFB_ETH_TYPE
 = 5,

333 
	mOFPXMT_OFB_VLAN_VID
 = 6,

334 
	mOFPXMT_OFB_VLAN_PCP
 = 7,

335 
	mOFPXMT_OFB_IP_DSCP
 = 8,

336 
	mOFPXMT_OFB_IP_ECN
 = 9,

337 
	mOFPXMT_OFB_IP_PROTO
 = 10,

338 
	mOFPXMT_OFB_IPV4_SRC
 = 11,

339 
	mOFPXMT_OFB_IPV4_DST
 = 12,

340 
	mOFPXMT_OFB_TCP_SRC
 = 13,

341 
	mOFPXMT_OFB_TCP_DST
 = 14,

342 
	mOFPXMT_OFB_UDP_SRC
 = 15,

343 
	mOFPXMT_OFB_UDP_DST
 = 16,

344 
	mOFPXMT_OFB_SCTP_SRC
 = 17,

345 
	mOFPXMT_OFB_SCTP_DST
 = 18,

346 
	mOFPXMT_OFB_ICMPV4_TYPE
 = 19,

347 
	mOFPXMT_OFB_ICMPV4_CODE
 = 20,

348 
	mOFPXMT_OFB_ARP_OP
 = 21,

349 
	mOFPXMT_OFB_ARP_SPA
 = 22,

350 
	mOFPXMT_OFB_ARP_TPA
 = 23,

351 
	mOFPXMT_OFB_ARP_SHA
 = 24,

352 
	mOFPXMT_OFB_ARP_THA
 = 25,

353 
	mOFPXMT_OFB_IPV6_SRC
 = 26,

354 
	mOFPXMT_OFB_IPV6_DST
 = 27,

355 
	mOFPXMT_OFB_IPV6_FLABEL
 = 28,

356 
	mOFPXMT_OFB_ICMPV6_TYPE
 = 29,

357 
	mOFPXMT_OFB_ICMPV6_CODE
 = 30,

358 
	mOFPXMT_OFB_IPV6_ND_TARGET
 = 31,

359 
	mOFPXMT_OFB_IPV6_ND_SLL
 = 32,

360 
	mOFPXMT_OFB_IPV6_ND_TLL
 = 33,

361 
	mOFPXMT_OFB_MPLS_LABEL
 = 34,

362 
	mOFPXMT_OFB_MPLS_TC
 = 35,

363 
	mOFPXMT_OFB_MPLS_BOS
 = 36,

364 
	mOFPXMT_OFB_PBB_ISID
 = 37,

365 
	mOFPXMT_OFB_TUNNEL_ID
 = 38,

366 
	mOFPXMT_OFB_IPV6_EXTHDR
 = 39

372 
	eoÂ_vœn_id
 {

373 
	mOFPVID_PRESENT
 = 0x1000,

374 
	mOFPVID_NONE
 = 0x0000,

378 
	eoÂ_ùv6exthdr_Êags
 {

379 
	mOFPIEH_NONEXT
 = 1 << 0,

380 
	mOFPIEH_ESP
 = 1 << 1,

381 
	mOFPIEH_AUTH
 = 1 << 2,

382 
	mOFPIEH_DEST
 = 1 << 3,

383 
	mOFPIEH_FRAG
 = 1 << 4,

384 
	mOFPIEH_ROUTER
 = 1 << 5,

385 
	mOFPIEH_HOP
 = 1 << 6,

386 
	mOFPIEH_UNREP
 = 1 << 7,

387 
	mOFPIEH_UNSEQ
 = 1 << 8,

391 
	soÂ_oxm_ex≥rimíãr_hódî
 {

392 
uöt32_t
 
	moxm_hódî
;

393 
uöt32_t
 
	mex≥rimíãr
;

396 
OFP_ASSERT
((
oÂ_oxm_ex≥rimíãr_hódî
) == 8);

398 
	eoÂ_ö°ru˘i⁄_ty≥
 {

399 
	mOFPIT_GOTO_TABLE
 = 1,

400 
	mOFPIT_WRITE_METADATA
 = 2,

402 
	mOFPIT_WRITE_ACTIONS
 = 3,

404 
	mOFPIT_APPLY_ACTIONS
 = 4,

405 
	mOFPIT_CLEAR_ACTIONS
 = 5,

407 
	mOFPIT_METER
 = 6,

408 
	mOFPIT_SET_STATE
 = 7,

411 
	mOFPIT_EXPERIMENTER
 = 0xFFFF

415 
	soÂ_ö°ru˘i⁄
 {

416 
uöt16_t
 
	mty≥
;

417 
uöt16_t
 
	mÀn
;

418 
uöt8_t
 
	m∑d
[4];

420 
OFP_ASSERT
((
oÂ_ö°ru˘i⁄
) == 8);

423 
	soÂ_ö°ru˘i⁄_gŸo_èbÀ
 {

424 
uöt16_t
 
	mty≥
;

425 
uöt16_t
 
	mÀn
;

426 
uöt8_t
 
	mèbÀ_id
;

427 
uöt8_t
 
	m∑d
[3];

429 
OFP_ASSERT
((
oÂ_ö°ru˘i⁄_gŸo_èbÀ
) == 8);

432 
	soÂ_ö°ru˘i⁄_wrôe_mëad©a
 {

433 
uöt16_t
 
	mty≥
;

434 
uöt16_t
 
	mÀn
;

435 
uöt8_t
 
	m∑d
[4];

436 
uöt64_t
 
	mmëad©a
;

437 
uöt64_t
 
	mmëad©a_mask
;

439 
OFP_ASSERT
((
oÂ_ö°ru˘i⁄_wrôe_mëad©a
) == 24);

444 
	soÂ_a˘i⁄_hódî
 {

445 
uöt16_t
 
	mty≥
;

446 
uöt16_t
 
	mÀn
;

450 
uöt8_t
 
	m∑d
[4];

452 
OFP_ASSERT
((
oÂ_a˘i⁄_hódî
) == 8);

455 
	soÂ_ö°ru˘i⁄_a˘i⁄s
 {

456 
uöt16_t
 
	mty≥
;

457 
uöt16_t
 
	mÀn
;

458 
uöt8_t
 
	m∑d
[4];

459 
oÂ_a˘i⁄_hódî
 
	ma˘i⁄s
[0];

463 
OFP_ASSERT
((
oÂ_ö°ru˘i⁄_a˘i⁄s
) == 8);

466 
	soÂ_ö°ru˘i⁄_mëî
 {

467 
uöt16_t
 
	mty≥
;

468 
uöt16_t
 
	mÀn
;

469 
uöt32_t
 
	mmëî_id
;

471 
OFP_ASSERT
((
oÂ_ö°ru˘i⁄_mëî
) == 8);

474 
	soÂ_ö°ru˘i⁄_£t_°©e
 {

475 
uöt16_t
 
	mty≥
;

476 
uöt16_t
 
	mÀn
;

478 
uöt64_t
 
	m°©e
;

481 
OFP_ASSERT
((
oÂ_ö°ru˘i⁄_£t_°©e
) == 16);

483 
	eoÂ_a˘i⁄_ty≥
 {

484 
	mOFPAT_OUTPUT
 = 0,

485 
	mOFPAT_COPY_TTL_OUT
 = 11,

487 
	mOFPAT_COPY_TTL_IN
 = 12,

489 
	mOFPAT_SET_MPLS_TTL
 = 15,

490 
	mOFPAT_DEC_MPLS_TTL
 = 16,

491 
	mOFPAT_PUSH_VLAN
 = 17,

492 
	mOFPAT_POP_VLAN
 = 18,

493 
	mOFPAT_PUSH_MPLS
 = 19,

494 
	mOFPAT_POP_MPLS
 = 20,

495 
	mOFPAT_SET_QUEUE
 = 21,

496 
	mOFPAT_GROUP
 = 22,

497 
	mOFPAT_SET_NW_TTL
 = 23,

498 
	mOFPAT_DEC_NW_TTL
 = 24,

499 
	mOFPAT_SET_FIELD
 = 25,

500 
	mOFPAT_PUSH_PBB
 = 26,

501 
	mOFPAT_POP_PBB
 = 27,

502 
	mOFPAT_EXPERIMENTER
 = 0xffff

513 
	soÂ_a˘i⁄_ouçut
 {

514 
uöt16_t
 
	mty≥
;

515 
uöt16_t
 
	mÀn
;

516 
uöt32_t
 
	mp‹t
;

517 
uöt16_t
 
	mmax_Àn
;

518 
uöt8_t
 
	m∑d
[6];

520 
OFP_ASSERT
((
oÂ_a˘i⁄_ouçut
) == 16);

522 
	eoÂ_c⁄åﬁÀr_max_Àn
 {

523 
	mOFPCML_MAX
 = 0xffe5,

525 
	mOFPCML_NO_BUFFER
 = 0xffff

531 
	soÂ_a˘i⁄_group
 {

532 
uöt16_t
 
	mty≥
;

533 
uöt16_t
 
	mÀn
;

534 
uöt32_t
 
	mgroup_id
;

536 
OFP_ASSERT
((
oÂ_a˘i⁄_group
) == 8);

539 
	soÂ_a˘i⁄_£t_queue
 {

540 
uöt16_t
 
	mty≥
;

541 
uöt16_t
 
	mÀn
;

542 
uöt32_t
 
	mqueue_id
;

544 
OFP_ASSERT
((
oÂ_a˘i⁄_£t_queue
) == 8);

547 
	soÂ_a˘i⁄_m∂s_âl
 {

548 
uöt16_t
 
	mty≥
;

549 
uöt16_t
 
	mÀn
;

550 
uöt8_t
 
	mm∂s_âl
;

551 
uöt8_t
 
	m∑d
[3];

553 
OFP_ASSERT
((
oÂ_a˘i⁄_m∂s_âl
) == 8);

556 
	soÂ_a˘i⁄_nw_âl
 {

557 
uöt16_t
 
	mty≥
;

558 
uöt16_t
 
	mÀn
;

559 
uöt8_t
 
	mnw_âl
;

560 
uöt8_t
 
	m∑d
[3];

562 
OFP_ASSERT
((
oÂ_a˘i⁄_nw_âl
) == 8);

565 
	soÂ_a˘i⁄_push
 {

566 
uöt16_t
 
	mty≥
;

567 
uöt16_t
 
	mÀn
;

568 
uöt16_t
 
	mëhîty≥
;

569 
uöt8_t
 
	m∑d
[2];

571 
OFP_ASSERT
((
oÂ_a˘i⁄_push
) == 8);

574 
	soÂ_a˘i⁄_p›_m∂s
 {

575 
uöt16_t
 
	mty≥
;

576 
uöt16_t
 
	mÀn
;

577 
uöt16_t
 
	mëhîty≥
;

578 
uöt8_t
 
	m∑d
[2];

580 
OFP_ASSERT
((
oÂ_a˘i⁄_p›_m∂s
) == 8);

583 
	soÂ_a˘i⁄_£t_fõld
 {

584 
uöt16_t
 
	mty≥
;

585 
uöt16_t
 
	mÀn
;

591 
uöt8_t
 
	mfõld
[4];

593 
OFP_ASSERT
((
oÂ_a˘i⁄_£t_fõld
) == 8);

597 
	soÂ_a˘i⁄_ex≥rimíãr_hódî
 {

598 
uöt16_t
 
	mty≥
;

599 
uöt16_t
 
	mÀn
;

600 
uöt32_t
 
	mex≥rimíãr
;

604 
OFP_ASSERT
((
oÂ_a˘i⁄_ex≥rimíãr_hódî
) == 8);

610 
	soÂ_swôch_„©uªs
 {

611 
oÂ_hódî
 
	mhódî
;

612 
uöt64_t
 
	md©≠©h_id
;

615 
uöt32_t
 
	mn_buf„rs
;

616 
uöt8_t
 
	mn_èbÀs
;

617 
uöt8_t
 
	mauxûüry_id
;

618 
uöt8_t
 
	m∑d
[2];

620 
uöt32_t
 
	mˇ∑bûôõs
;

621 
uöt32_t
 
	mª£rved
;

623 
OFP_ASSERT
((
oÂ_swôch_„©uªs
) == 32);

626 
	eoÂ_ˇ∑bûôõs
 {

627 
	mOFPC_FLOW_STATS
 = 1 << 0,

628 
	mOFPC_TABLE_STATS
 = 1 << 1,

629 
	mOFPC_PORT_STATS
 = 1 << 2,

630 
	mOFPC_GROUP_STATS
 = 1 << 3,

631 
	mOFPC_IP_REASM
 = 1 << 5,

632 
	mOFPC_QUEUE_STATS
 = 1 << 6,

633 
	mOFPC_PORT_BLOCKED
 = 1 << 8,

634 
	mOFPC_TABLE_STATEFUL
 = 1 << 9

639 
	soÂ_swôch_c⁄fig
 {

640 
oÂ_hódî
 
	mhódî
;

641 
uöt16_t
 
	mÊags
;

642 
uöt16_t
 
	mmiss_£nd_Àn
;

646 
OFP_ASSERT
((
oÂ_swôch_c⁄fig
) == 12);

648 
	eoÂ_c⁄fig_Êags
 {

650 
	mOFPC_FRAG_NORMAL
 = 0,

651 
	mOFPC_FRAG_DROP
 = 1 << 0,

652 
	mOFPC_FRAG_REASM
 = 1 << 1,

653 
	mOFPC_FRAG_MASK
 = 3,

655 
	mOFPC_INVALID_TTL_TO_CONTROLLER
 = 1 << 2,

660 
	eoÂ_èbÀ
 {

662 
	mOFPTT_MAX
 = 0xfe,

664 
	mOFPTT_ALL
 = 0xff

669 
	soÂ_èbÀ_mod
 {

670 
oÂ_hódî
 
	mhódî
;

671 
uöt8_t
 
	mèbÀ_id
;

672 
uöt8_t
 
	m∑d
[3];

673 
uöt32_t
 
	mc⁄fig
;

675 
OFP_ASSERT
((
oÂ_èbÀ_mod
) == 16);

677 
	eoÂ_èbÀ_c⁄fig
 {

678 
	mOFPTC_TABLE_MISS_CONTROLLER
 = 0,

679 
	mOFPTC_TABLE_MISS_CONTINUE
 = 1 << 0,

681 
	mOFPTC_TABLE_MISS_DROP
 = 1 << 1,

682 
	mOFPTC_TABLE_MISS_MASK
 = 3,

683 
	mOFPTC_TABLE_STATEFUL
 = 1 << 4

686 
	#OFP_DEFAULT_PRIORITY
 0x8000

	)

687 
	#OFP_FLOW_PERMANENT
 0

	)

690 
	soÂ_Êow_mod
 {

691 
oÂ_hódî
 
	mhódî
;

692 
uöt64_t
 
	mcookõ
;

693 
uöt64_t
 
	mcookõ_mask
;

698 
uöt8_t
 
	mèbÀ_id
;

702 
uöt8_t
 
	mcomm™d
;

703 
uöt16_t
 
	midÀ_timeout
;

704 
uöt16_t
 
	mh¨d_timeout
;

705 
uöt16_t
 
	m¥i‹ôy
;

706 
uöt32_t
 
	mbuf„r_id
;

709 
uöt32_t
 
	mout_p‹t
;

713 
uöt32_t
 
	mout_group
;

717 
uöt16_t
 
	mÊags
;

718 
uöt8_t
 
	m∑d
[2];

719 
oÂ_m©ch
 
	mm©ch
;

722 
OFP_ASSERT
((
oÂ_Êow_mod
) == 56);

724 
	eoÂ_Êow_mod_comm™d
 {

725 
	mOFPFC_ADD
 = 0,

726 
	mOFPFC_MODIFY
 = 1,

727 
	mOFPFC_MODIFY_STRICT
 = 2,

729 
	mOFPFC_DELETE
 = 3,

730 
	mOFPFC_DELETE_STRICT
 = 4,

734 
	eoÂ_Êow_mod_Êags
 {

735 
	mOFPFF_SEND_FLOW_REM
 = 1 << 0,

737 
	mOFPFF_CHECK_OVERLAP
 = 1 << 1,

738 
	mOFPFF_RESET_COUNTS
 = 1 << 2,

739 
	mOFPFF_NO_PKT_COUNTS
 = 1 << 3,

740 
	mOFPFF_NO_BYT_COUNTS
 = 1 << 4

744 
	eoÂ_group
 {

746 
	mOFPG_MAX
 = 0xffffff00,

749 
	mOFPG_ALL
 = 0xfffffffc,

751 
	mOFPG_ANY
 = 0xffffffff

757 
	soÂ_buckë
 {

758 
uöt16_t
 
	mÀn
;

761 
uöt16_t
 
	mweight
;

763 
uöt32_t
 
	mw©ch_p‹t
;

766 
uöt32_t
 
	mw©ch_group
;

769 
uöt8_t
 
	m∑d
[4];

770 
oÂ_a˘i⁄_hódî
 
	ma˘i⁄s
[0];

774 
OFP_ASSERT
((
oÂ_buckë
) == 16);

777 
	soÂ_group_mod
 {

778 
oÂ_hódî
 
	mhódî
;

779 
uöt16_t
 
	mcomm™d
;

780 
uöt8_t
 
	mty≥
;

781 
uöt8_t
 
	m∑d
;

782 
uöt32_t
 
	mgroup_id
;

783 
oÂ_buckë
 
	mbuckës
[0];

786 
OFP_ASSERT
((
oÂ_group_mod
) == 16);

789 
	eoÂ_group_mod_comm™d
 {

790 
	mOFPGC_ADD
 = 0,

791 
	mOFPGC_MODIFY
 = 1,

792 
	mOFPGC_DELETE
 = 2,

797 
	eoÂ_group_ty≥
 {

798 
	mOFPGT_ALL
 = 0,

799 
	mOFPGT_SELECT
 = 1,

800 
	mOFPGT_INDIRECT
 = 2,

801 
	mOFPGT_FF
 = 3,

806 
	soÂ_p‹t_mod
 {

807 
oÂ_hódî
 
	mhódî
;

808 
uöt32_t
 
	mp‹t_no
;

809 
uöt8_t
 
	m∑d
[4];

810 
uöt8_t
 
	mhw_addr
[
OFP_ETH_ALEN
];

815 
uöt8_t
 
	m∑d2
[2];

816 
uöt32_t
 
	mc⁄fig
;

817 
uöt32_t
 
	mmask
;

818 
uöt32_t
 
	madvîti£
;

820 
uöt8_t
 
	m∑d3
[4];

822 
OFP_ASSERT
((
oÂ_p‹t_mod
) == 40);

825 
	soÂ_mëî_b™d_hódî
 {

826 
uöt16_t
 
	mty≥
;

827 
uöt16_t
 
	mÀn
;

828 
uöt32_t
 
	møã
;

829 
uöt32_t
 
	mbur°_size
;

831 
OFP_ASSERT
((
oÂ_mëî_b™d_hódî
) == 12);

834 
	soÂ_mëî_mod
 {

835 
oÂ_hódî
 
	mhódî
;

836 
uöt16_t
 
	mcomm™d
;

837 
uöt16_t
 
	mÊags
;

838 
uöt32_t
 
	mmëî_id
;

839 
oÂ_mëî_b™d_hódî
 
	mb™ds
[0];

843 
OFP_ASSERT
((
oÂ_mëî_mod
) == 16);

846 
	eoÂ_mëî
 {

848 
	mOFPM_MAX
 = 0xffff0000,

850 
	mOFPM_SLOWPATH
 = 0xfffffffd,

851 
	mOFPM_CONTROLLER
 = 0xfffffffe,

852 
	mOFPM_ALL
 = 0xffffffff,

859 
	eoÂ_mëî_mod_comm™d
 {

860 
	mOFPMC_ADD
,

861 
	mOFPMC_MODIFY
,

862 
	mOFPMC_DELETE
,

866 
	eoÂ_mëî_Êags
 {

867 
	mOFPMF_KBPS
 = 1 << 0,

868 
	mOFPMF_PKTPS
 = 1 << 1,

869 
	mOFPMF_BURST
 = 1 << 2,

870 
	mOFPMF_STATS
 = 1 << 3,

875 
	eoÂ_mëî_b™d_ty≥
 {

876 
	mOFPMBT_DROP
 = 1,

877 
	mOFPMBT_DSCP_REMARK
 = 2,

878 
	mOFPMBT_EXPERIMENTER
 = 0xFFFF

882 
	soÂ_mëî_b™d_dr›
 {

883 
uöt16_t
 
	mty≥
;

884 
uöt16_t
 
	mÀn
;

885 
uöt32_t
 
	møã
;

886 
uöt32_t
 
	mbur°_size
;

887 
uöt8_t
 
	m∑d
[4];

889 
OFP_ASSERT
((
oÂ_mëî_b™d_dr›
) == 16);

892 
	soÂ_mëî_b™d_ds˝_ªm¨k
 {

893 
uöt16_t
 
	mty≥
;

894 
uöt16_t
 
	mÀn
;

895 
uöt32_t
 
	møã
;

896 
uöt32_t
 
	mbur°_size
;

897 
uöt8_t
 
	m¥ec_Àvñ
;

898 
uöt8_t
 
	m∑d
[3];

900 
OFP_ASSERT
((
oÂ_mëî_b™d_ds˝_ªm¨k
) == 16);

903 
	soÂ_mëî_b™d_ex≥rimíãr
 {

904 
uöt16_t
 
	mty≥
;

905 
uöt16_t
 
	mÀn
;

906 
uöt32_t
 
	møã
;

907 
uöt32_t
 
	mbur°_size
;

908 
uöt32_t
 
	mex≥rimíãr
;

912 
OFP_ASSERT
((
oÂ_mëî_b™d_ex≥rimíãr
) == 16);

915 
	soÂ_mu…ù¨t_ªque°
 {

916 
oÂ_hódî
 
	mhódî
;

917 
uöt16_t
 
	mty≥
;

918 
uöt16_t
 
	mÊags
;

919 
uöt8_t
 
	m∑d
[4];

920 
uöt8_t
 
	mbody
[0];

922 
OFP_ASSERT
((
oÂ_mu…ù¨t_ªque°
) == 16);

924 
	eoÂ_mu…ù¨t_ªque°_Êags
 {

925 
	mOFPMPF_REQ_MORE
 = 1 << 0

928 
	eoÂ_mu…ù¨t_ª∂y_Êags
 {

929 
	mOFPMPF_REPLY_MORE
 = 1 << 0

932 
	soÂ_mu…ù¨t_ª∂y
 {

933 
oÂ_hódî
 
	mhódî
;

934 
uöt16_t
 
	mty≥
;

935 
uöt16_t
 
	mÊags
;

936 
uöt8_t
 
	m∑d
[4];

937 
uöt8_t
 
	mbody
[0];

939 
OFP_ASSERT
((
oÂ_mu…ù¨t_ª∂y
) == 16);

941 
	eoÂ_mu…ù¨t_ty≥s
 {

945 
	mOFPMP_DESC
 = 0,

949 
	mOFPMP_FLOW
 = 1,

953 
	mOFPMP_AGGREGATE
 = 2,

957 
	mOFPMP_TABLE
 = 3,

961 
	mOFPMP_PORT_STATS
 = 4,

965 
	mOFPMP_QUEUE
 = 5,

969 
	mOFPMP_GROUP
 = 6,

973 
	mOFPMP_GROUP_DESC
 = 7,

977 
	mOFPMP_GROUP_FEATURES
 = 8,

981 
	mOFPMP_METER
 = 9,

985 
	mOFPMP_METER_CONFIG
 = 10,

989 
	mOFPMP_METER_FEATURES
 = 11,

996 
	mOFPMP_TABLE_FEATURES
 = 12,

1000 
	mOFPMP_PORT_DESC
 = 13,

1005 
	mOFPMP_EXPERIMENTER
 = 0xffff

1008 
	#DESC_STR_LEN
 256

	)

1009 
	#SERIAL_NUM_LEN
 32

	)

1012 
	soÂ_desc
 {

1013 
	mm‰_desc
[
DESC_STR_LEN
];

1014 
	mhw_desc
[
DESC_STR_LEN
];

1015 
	msw_desc
[
DESC_STR_LEN
];

1016 
	m£rül_num
[
SERIAL_NUM_LEN
];

1017 
	mdp_desc
[
DESC_STR_LEN
];

1019 
OFP_ASSERT
((
oÂ_desc
) == 1056);

1022 
	soÂ_Êow_°©s_ªque°
 {

1023 
uöt8_t
 
	mèbÀ_id
;

1025 
uöt8_t
 
	m∑d
[3];

1026 
uöt32_t
 
	mout_p‹t
;

1029 
uöt32_t
 
	mout_group
;

1032 
uöt8_t
 
	m∑d2
[4];

1033 
uöt64_t
 
	mcookõ
;

1035 
uöt64_t
 
	mcookõ_mask
;

1038 
oÂ_m©ch
 
	mm©ch
;

1040 
OFP_ASSERT
((
oÂ_Êow_°©s_ªque°
) == 40);

1043 
	soÂ_Êow_°©s
 {

1044 
uöt16_t
 
	mÀngth
;

1045 
uöt8_t
 
	mèbÀ_id
;

1046 
uöt8_t
 
	m∑d
;

1047 
uöt32_t
 
	mduøti⁄_£c
;

1048 
uöt32_t
 
	mduøti⁄_n£c
;

1050 
uöt16_t
 
	m¥i‹ôy
;

1051 
uöt16_t
 
	midÀ_timeout
;

1052 
uöt16_t
 
	mh¨d_timeout
;

1053 
uöt8_t
 
	m∑d2
[6];

1054 
uöt64_t
 
	mcookõ
;

1055 
uöt64_t
 
	m∑ckë_cou¡
;

1056 
uöt64_t
 
	mbyã_cou¡
;

1057 
oÂ_m©ch
 
	mm©ch
;

1060 
OFP_ASSERT
((
oÂ_Êow_°©s
) == 56);

1063 
	soÂ_aggªg©e_°©s_ªque°
 {

1064 
uöt8_t
 
	mèbÀ_id
;

1066 
uöt8_t
 
	m∑d
[3];

1067 
uöt32_t
 
	mout_p‹t
;

1070 
uöt32_t
 
	mout_group
;

1073 
uöt8_t
 
	m∑d2
[4];

1074 
uöt64_t
 
	mcookõ
;

1076 
uöt64_t
 
	mcookõ_mask
;

1079 
oÂ_m©ch
 
	mm©ch
;

1081 
OFP_ASSERT
((
oÂ_aggªg©e_°©s_ªque°
) == 40);

1084 
	soÂ_aggªg©e_°©s_ª∂y
 {

1085 
uöt64_t
 
	m∑ckë_cou¡
;

1086 
uöt64_t
 
	mbyã_cou¡
;

1087 
uöt32_t
 
	mÊow_cou¡
;

1088 
uöt8_t
 
	m∑d
[4];

1090 
OFP_ASSERT
((
oÂ_aggªg©e_°©s_ª∂y
) == 24);

1093 
	soÂ_èbÀ_°©s
 {

1094 
uöt8_t
 
	mèbÀ_id
;

1096 
uöt8_t
 
	m∑d
[3];

1097 
uöt32_t
 
	ma˘ive_cou¡
;

1098 
uöt64_t
 
	mlookup_cou¡
;

1099 
uöt64_t
 
	mm©ched_cou¡
;

1101 
OFP_ASSERT
((
oÂ_èbÀ_°©s
) == 24);

1103 
	soÂ_èbÀ_„©uª_¥›_hódî
{

1104 
uöt16_t
 
	mty≥
;

1106 
uöt16_t
 
	mÀngth
;

1108 
OFP_ASSERT
((
oÂ_èbÀ_„©uª_¥›_hódî
) == 4);

1112 
	soÂ_èbÀ_„©uªs
 {

1113 
uöt16_t
 
	mÀngth
;

1114 
uöt8_t
 
	mèbÀ_id
;

1116 
uöt8_t
 
	m∑d
[5];

1117 
	m«me
[
OFP_MAX_TABLE_NAME_LEN
];

1118 
uöt64_t
 
	mmëad©a_m©ch
;

1119 
uöt64_t
 
	mmëad©a_wrôe
;

1120 
uöt32_t
 
	mc⁄fig
;

1121 
uöt32_t
 
	mmax_íåõs
;

1123 
oÂ_èbÀ_„©uª_¥›_hódî
 
	m¥›îtõs
[0];

1125 
OFP_ASSERT
((
oÂ_èbÀ_„©uªs
) == 64);

1131 
	eoÂ_èbÀ_„©uª_¥›_ty≥
 {

1132 
	mOFPTFPT_INSTRUCTIONS
 = 0,

1133 
	mOFPTFPT_INSTRUCTIONS_MISS
 = 1,

1134 
	mOFPTFPT_NEXT_TABLES
 = 2,

1135 
	mOFPTFPT_NEXT_TABLES_MISS
 = 3,

1136 
	mOFPTFPT_WRITE_ACTIONS
 = 4,

1137 
	mOFPTFPT_WRITE_ACTIONS_MISS
 = 5,

1138 
	mOFPTFPT_APPLY_ACTIONS
 = 6,

1139 
	mOFPTFPT_APPLY_ACTIONS_MISS
 = 7,

1140 
	mOFPTFPT_MATCH
 = 8,

1141 
	mOFPTFPT_WILDCARDS
 = 10,

1142 
	mOFPTFPT_WRITE_SETFIELD
 = 12,

1143 
	mOFPTFPT_WRITE_SETFIELD_MISS
 = 13,

1144 
	mOFPTFPT_APPLY_SETFIELD
 = 14,

1145 
	mOFPTFPT_APPLY_SETFIELD_MISS
 = 15,

1146 
	mOFPTFPT_EXPERIMENTER
 = 0xFFFE,

1147 
	mOFPTFPT_EXPERIMENTER_MISS
 = 0xFFFF,

1151 
	soÂ_èbÀ_„©uª_¥›_ö°ru˘i⁄s
 {

1152 
uöt16_t
 
	mty≥
;

1154 
uöt16_t
 
	mÀngth
;

1162 
oÂ_ö°ru˘i⁄
 
	mö°ru˘i⁄_ids
[0];

1164 
OFP_ASSERT
((
oÂ_èbÀ_„©uª_¥›_ö°ru˘i⁄s
) == 4);

1167 
	soÂ_èbÀ_„©uª_¥›_√xt_èbÀs
 {

1168 
uöt16_t
 
	mty≥
;

1170 
uöt16_t
 
	mÀngth
;

1178 
uöt8_t
 
	m√xt_èbÀ_ids
[0];

1180 
OFP_ASSERT
((
oÂ_èbÀ_„©uª_¥›_√xt_èbÀs
) == 4);

1183 
	soÂ_èbÀ_„©uª_¥›_a˘i⁄s
 {

1184 
uöt16_t
 
	mty≥
;

1189 
uöt16_t
 
	mÀngth
;

1197 
oÂ_a˘i⁄_hódî
 
	ma˘i⁄_ids
[0];

1199 
OFP_ASSERT
((
oÂ_èbÀ_„©uª_¥›_a˘i⁄s
) == 4);

1202 
	soÂ_èbÀ_„©uª_¥›_oxm
 {

1203 
uöt16_t
 
	mty≥
;

1210 
uöt16_t
 
	mÀngth
;

1218 
uöt32_t
 
	moxm_ids
[0];

1220 
OFP_ASSERT
((
oÂ_èbÀ_„©uª_¥›_oxm
) == 4);

1224 
	soÂ_p‹t_°©s_ªque°
 {

1225 
uöt32_t
 
	mp‹t_no
;

1229 
uöt8_t
 
	m∑d
[4];

1231 
OFP_ASSERT
((
oÂ_p‹t_°©s_ªque°
) == 8);

1235 
	soÂ_p‹t_°©s
 {

1236 
uöt32_t
 
	mp‹t_no
;

1237 
uöt8_t
 
	m∑d
[4];

1238 
uöt64_t
 
	mrx_∑ckës
;

1239 
uöt64_t
 
	mtx_∑ckës
;

1240 
uöt64_t
 
	mrx_byãs
;

1241 
uöt64_t
 
	mtx_byãs
;

1242 
uöt64_t
 
	mrx_dr›≥d
;

1243 
uöt64_t
 
	mtx_dr›≥d
;

1244 
uöt64_t
 
	mrx_îr‹s
;

1248 
uöt64_t
 
	mtx_îr‹s
;

1252 
uöt64_t
 
	mrx_‰ame_îr
;

1253 
uöt64_t
 
	mrx_ovî_îr
;

1254 
uöt64_t
 
	mrx_¸c_îr
;

1255 
uöt64_t
 
	mcﬁlisi⁄s
;

1256 
uöt32_t
 
	mduøti⁄_£c
;

1257 
uöt32_t
 
	mduøti⁄_n£c
;

1260 
OFP_ASSERT
((
oÂ_p‹t_°©s
) == 112);

1262 
	soÂ_queue_°©s_ªque°
 {

1263 
uöt32_t
 
	mp‹t_no
;

1264 
uöt32_t
 
	mqueue_id
;

1266 
OFP_ASSERT
((
oÂ_queue_°©s_ªque°
) == 8);

1268 
	soÂ_queue_°©s
 {

1269 
uöt32_t
 
	mp‹t_no
;

1270 
uöt32_t
 
	mqueue_id
;

1271 
uöt64_t
 
	mtx_byãs
;

1272 
uöt64_t
 
	mtx_∑ckës
;

1273 
uöt64_t
 
	mtx_îr‹s
;

1274 
uöt32_t
 
	mduøti⁄_£c
;

1275 
uöt32_t
 
	mduøti⁄_n£c
;

1278 
OFP_ASSERT
((
oÂ_queue_°©s
) == 40);

1281 
	soÂ_group_°©s_ªque°
 {

1282 
uöt32_t
 
	mgroup_id
;

1283 
uöt8_t
 
	m∑d
[4];

1285 
OFP_ASSERT
((
oÂ_group_°©s_ªque°
) == 8);

1288 
	soÂ_buckë_cou¡î
 {

1289 
uöt64_t
 
	m∑ckë_cou¡
;

1290 
uöt64_t
 
	mbyã_cou¡
;

1292 
OFP_ASSERT
((
oÂ_buckë_cou¡î
) == 16);

1295 
	soÂ_group_°©s
 {

1296 
uöt16_t
 
	mÀngth
;

1297 
uöt8_t
 
	m∑d
[2];

1298 
uöt32_t
 
	mgroup_id
;

1299 
uöt32_t
 
	mªf_cou¡
;

1301 
uöt8_t
 
	m∑d2
[4];

1302 
uöt64_t
 
	m∑ckë_cou¡
;

1303 
uöt64_t
 
	mbyã_cou¡
;

1304 
uöt32_t
 
	mduøti⁄_£c
;

1305 
uöt32_t
 
	mduøti⁄_n£c
;

1307 
oÂ_buckë_cou¡î
 
	mbuckë_°©s
[0];

1310 
OFP_ASSERT
((
oÂ_group_°©s
) == 40);

1313 
	soÂ_group_desc_°©s
 {

1314 
uöt16_t
 
	mÀngth
;

1315 
uöt8_t
 
	mty≥
;

1316 
uöt8_t
 
	m∑d
;

1317 
uöt32_t
 
	mgroup_id
;

1318 
oÂ_buckë
 
	mbuckës
[0];

1320 
OFP_ASSERT
((
oÂ_group_desc_°©s
) == 8);

1323 
	soÂ_group_„©uªs_°©s
 {

1324 
uöt32_t
 
	mty≥s
;

1325 
uöt32_t
 
	mˇ∑bûôõs
;

1326 
uöt32_t
 
	mmax_groups
[4];

1327 
uöt32_t
 
	ma˘i⁄s
[4];

1329 
OFP_ASSERT
((
oÂ_group_„©uªs_°©s
) == 40);

1332 
	eoÂ_group_ˇ∑bûôõs
 {

1333 
	mOFPGFC_SELECT_WEIGHT
 = 1 << 0,

1334 
	mOFPGFC_SELECT_LIVENESS
 = 1 << 1,

1335 
	mOFPGFC_CHAINING
 = 1 << 2,

1336 
	mOFPGFC_CHAINING_CHECKS
 = 1 << 3,

1340 
	soÂ_mëî_mu…ù¨t_ªque°
 {

1341 
uöt32_t
 
	mmëî_id
;

1342 
uöt8_t
 
	m∑d
[4];

1344 
OFP_ASSERT
((
oÂ_mëî_mu…ù¨t_ªque°
) == 8);

1347 
	soÂ_mëî_b™d_°©s
 {

1348 
uöt64_t
 
	m∑ckë_b™d_cou¡
;

1349 
uöt64_t
 
	mbyã_b™d_cou¡
;

1351 
OFP_ASSERT
((
oÂ_mëî_b™d_°©s
) == 16);

1354 
	soÂ_mëî_°©s
 {

1355 
uöt32_t
 
	mmëî_id
;

1356 
uöt16_t
 
	mÀn
;

1357 
uöt8_t
 
	m∑d
[6];

1358 
uöt32_t
 
	mÊow_cou¡
;

1359 
uöt64_t
 
	m∑ckë_ö_cou¡
;

1360 
uöt64_t
 
	mbyã_ö_cou¡
;

1361 
uöt32_t
 
	mduøti⁄_£c
;

1362 
uöt32_t
 
	mduøti⁄_n£c
;

1364 
oÂ_mëî_b™d_°©s
 
	mb™d_°©s
[0];

1367 
OFP_ASSERT
((
oÂ_mëî_°©s
) == 40);

1370 
	soÂ_mëî_c⁄fig
 {

1371 
uöt16_t
 
	mÀngth
;

1372 
uöt16_t
 
	mÊags
;

1373 
uöt32_t
 
	mmëî_id
;

1374 
oÂ_mëî_b™d_hódî
 
	mb™ds
[0];

1377 
OFP_ASSERT
((
oÂ_mëî_c⁄fig
) == 8);

1380 
	soÂ_mëî_„©uªs
 {

1381 
uöt32_t
 
	mmax_mëî
;

1382 
uöt32_t
 
	mb™d_ty≥s
;

1383 
uöt32_t
 
	mˇ∑bûôõs
;

1384 
uöt8_t
 
	mmax_b™ds
;

1385 
uöt8_t
 
	mmax_cﬁ‹
;

1386 
uöt8_t
 
	m∑d
[2];

1388 
OFP_ASSERT
((
oÂ_mëî_„©uªs
) == 16);

1392 
	soÂ_ex≥rimíãr_°©s_hódî
 {

1393 
uöt32_t
 
	mex≥rimíãr
;

1395 
uöt32_t
 
	mexp_ty≥
;

1398 
OFP_ASSERT
((
oÂ_ex≥rimíãr_°©s_hódî
) == 8);

1401 
	soÂ_queue_gë_c⁄fig_ªque°
 {

1402 
oÂ_hódî
 
	mhódî
;

1403 
uöt32_t
 
	mp‹t
;

1407 
uöt8_t
 
	m∑d
[4];

1409 
OFP_ASSERT
((
oÂ_queue_gë_c⁄fig_ªque°
) == 16);

1412 
	soÂ_queue_gë_c⁄fig_ª∂y
 {

1413 
oÂ_hódî
 
	mhódî
;

1414 
uöt32_t
 
	mp‹t
;

1415 
uöt8_t
 
	m∑d
[4];

1416 
oÂ_∑ckë_queue
 
	mqueues
[0];

1418 
OFP_ASSERT
((
oÂ_queue_gë_c⁄fig_ª∂y
) == 16);

1421 
	soÂ_∑ckë_out
 {

1422 
oÂ_hódî
 
	mhódî
;

1423 
uöt32_t
 
	mbuf„r_id
;

1425 
uöt32_t
 
	mö_p‹t
;

1426 
uöt16_t
 
	ma˘i⁄s_Àn
;

1427 
uöt8_t
 
	m∑d
[6];

1428 
oÂ_a˘i⁄_hódî
 
	ma˘i⁄s
[0];

1433 
OFP_ASSERT
((
oÂ_∑ckë_out
) == 24);

1436 
	soÂ_rﬁe_ªque°
 {

1437 
oÂ_hódî
 
	mhódî
;

1438 
uöt32_t
 
	mrﬁe
;

1439 
uöt8_t
 
	m∑d
[4];

1440 
uöt64_t
 
	mgíî©i⁄_id
;

1442 
OFP_ASSERT
((
oÂ_rﬁe_ªque°
) == 24);

1445 
	eoÂ_c⁄åﬁÀr_rﬁe
 {

1446 
	mOFPCR_ROLE_NOCHANGE
 = 0,

1447 
	mOFPCR_ROLE_EQUAL
 = 1,

1448 
	mOFPCR_ROLE_MASTER
 = 2,

1449 
	mOFPCR_ROLE_SLAVE
 = 3,

1453 
	soÂ_async_c⁄fig
 {

1454 
oÂ_hódî
 
	mhódî
;

1455 
uöt32_t
 
	m∑ckë_ö_mask
[2];

1456 
uöt32_t
 
	mp‹t_°©us_mask
[2];

1457 
uöt32_t
 
	mÊow_ªmoved_mask
[2];

1459 
OFP_ASSERT
((
oÂ_async_c⁄fig
) == 32);

1463 
	#OFP_NO_BUFFER
 0xffffffff

	)

1466 
	soÂ_∑ckë_ö
 {

1467 
oÂ_hódî
 
	mhódî
;

1468 
uöt32_t
 
	mbuf„r_id
;

1469 
uöt16_t
 
	mtŸÆ_Àn
;

1470 
uöt8_t
 
	mªas⁄
;

1471 
uöt8_t
 
	mèbÀ_id
;

1472 
uöt64_t
 
	mcookõ
;

1473 
oÂ_m©ch
 
	mm©ch
;

1483 
OFP_ASSERT
((
oÂ_∑ckë_ö
) == 32);

1486 
	eoÂ_∑ckë_ö_ªas⁄
 {

1487 
	mOFPR_NO_MATCH
 = 0,

1488 
	mOFPR_ACTION
 = 1,

1489 
	mOFPR_INVALID_TTL
 = 2,

1493 
	soÂ_Êow_ªmoved
 {

1494 
oÂ_hódî
 
	mhódî
;

1495 
uöt64_t
 
	mcookõ
;

1496 
uöt16_t
 
	m¥i‹ôy
;

1497 
uöt8_t
 
	mªas⁄
;

1498 
uöt8_t
 
	mèbÀ_id
;

1499 
uöt32_t
 
	mduøti⁄_£c
;

1500 
uöt32_t
 
	mduøti⁄_n£c
;

1502 
uöt16_t
 
	midÀ_timeout
;

1503 
uöt16_t
 
	mh¨d_timeout
;

1504 
uöt64_t
 
	m∑ckë_cou¡
;

1505 
uöt64_t
 
	mbyã_cou¡
;

1506 
oÂ_m©ch
 
	mm©ch
;

1508 
OFP_ASSERT
((
oÂ_Êow_ªmoved
) == 56);

1511 
	eoÂ_Êow_ªmoved_ªas⁄
 {

1512 
	mOFPRR_IDLE_TIMEOUT
 = 0,

1513 
	mOFPRR_HARD_TIMEOUT
 = 1,

1514 
	mOFPRR_DELETE
 = 2,

1515 
	mOFPRR_GROUP_DELETE
 = 3,

1516 
	mOFPRR_METER_DELETE
 = 4,

1520 
	soÂ_p‹t_°©us
 {

1521 
oÂ_hódî
 
	mhódî
;

1522 
uöt8_t
 
	mªas⁄
;

1523 
uöt8_t
 
	m∑d
[7];

1524 
oÂ_p‹t
 
	mdesc
;

1526 
OFP_ASSERT
((
oÂ_p‹t_°©us
) == 80);

1529 
	eoÂ_p‹t_ªas⁄
 {

1530 
	mOFPPR_ADD
 = 0,

1531 
	mOFPPR_DELETE
 = 1,

1532 
	mOFPPR_MODIFY
 = 2,

1536 
	soÂ_îr‹_msg
 {

1537 
oÂ_hódî
 
	mhódî
;

1538 
uöt16_t
 
	mty≥
;

1539 
uöt16_t
 
	mcode
;

1540 
uöt8_t
 
	md©a
[0];

1543 
OFP_ASSERT
((
oÂ_îr‹_msg
) == 12);

1548 
	eoÂ_îr‹_ty≥
 {

1549 
	mOFPET_HELLO_FAILED
 = 0,

1550 
	mOFPET_BAD_REQUEST
 = 1,

1551 
	mOFPET_BAD_ACTION
 = 2,

1552 
	mOFPET_BAD_INSTRUCTION
 = 3,

1553 
	mOFPET_BAD_MATCH
 = 4,

1554 
	mOFPET_FLOW_MOD_FAILED
 = 5,

1555 
	mOFPET_GROUP_MOD_FAILED
 = 6,

1556 
	mOFPET_PORT_MOD_FAILED
 = 7,

1557 
	mOFPET_TABLE_MOD_FAILED
 = 8,

1558 
	mOFPET_QUEUE_OP_FAILED
 = 9,

1559 
	mOFPET_SWITCH_CONFIG_FAILED
 = 10,

1560 
	mOFPET_ROLE_REQUEST_FAILED
 = 11,

1561 
	mOFPET_METER_MOD_FAILED
 = 12,

1562 
	mOFPET_TABLE_FEATURES_FAILED
 = 13,

1563 
	mOFPET_EXPERIMENTER
 = 0xffff

1568 
	eoÂ_hñlo_Áûed_code
 {

1569 
	mOFPHFC_INCOMPATIBLE
 = 0,

1570 
	mOFPHFC_EPERM
 = 1,

1575 
	eoÂ_bad_ªque°_code
 {

1576 
	mOFPBRC_BAD_VERSION
 = 0,

1577 
	mOFPBRC_BAD_TYPE
 = 1,

1578 
	mOFPBRC_BAD_MULTIPART
 = 2,

1579 
	mOFPBRC_BAD_EXPERIMENTER
 = 3,

1582 
	mOFPBRC_BAD_EXP_TYPE
 = 4,

1583 
	mOFPBRC_EPERM
 = 5,

1584 
	mOFPBRC_BAD_LEN
 = 6,

1585 
	mOFPBRC_BUFFER_EMPTY
 = 7,

1586 
	mOFPBRC_BUFFER_UNKNOWN
 = 8,

1587 
	mOFPBRC_BAD_TABLE_ID
 = 9,

1589 
	mOFPBRC_IS_SLAVE
 = 10,

1590 
	mOFPBRC_BAD_PORT
 = 11,

1591 
	mOFPBRC_BAD_PACKET
 = 12,

1592 
	mOFPBRC_MULTIPART_BUFFER_OVERFLOW
 = 13,

1599 
	eoÂ_bad_a˘i⁄_code
 {

1600 
	mOFPBAC_BAD_TYPE
 = 0,

1601 
	mOFPBAC_BAD_LEN
 = 1,

1602 
	mOFPBAC_BAD_EXPERIMENTER
 = 2,

1603 
	mOFPBAC_BAD_EXP_TYPE
 = 3,

1604 
	mOFPBAC_BAD_OUT_PORT
 = 4,

1605 
	mOFPBAC_BAD_ARGUMENT
 = 5,

1606 
	mOFPBAC_EPERM
 = 6,

1607 
	mOFPBAC_TOO_MANY
 = 7,

1608 
	mOFPBAC_BAD_QUEUE
 = 8,

1609 
	mOFPBAC_BAD_OUT_GROUP
 = 9,

1610 
	mOFPBAC_MATCH_INCONSISTENT
 = 10,

1612 
	mOFPBAC_UNSUPPORTED_ORDER
 = 11,

1614 
	mOFPBAC_BAD_TAG
 = 12,

1616 
	mOFPBAC_BAD_SET_TYPE
 = 13,

1617 
	mOFPBAC_BAD_SET_LEN
 = 14,

1618 
	mOFPBAC_BAD_SET_ARGUMENT
 = 15,

1623 
	eoÂ_bad_ö°ru˘i⁄_code
 {

1624 
	mOFPBIC_UNKNOWN_INST
 = 0,

1625 
	mOFPBIC_UNSUP_INST
 = 1,

1627 
	mOFPBIC_BAD_TABLE_ID
 = 2,

1628 
	mOFPBIC_UNSUP_METADATA
 = 3,

1629 
	mOFPBIC_UNSUP_METADATA_MASK
 = 4,

1631 
	mOFPBIC_BAD_EXPERIMENTER
 = 5,

1632 
	mOFPBIC_BAD_EXP_TYPE
 = 6,

1633 
	mOFPBIC_BAD_LEN
 = 7,

1634 
	mOFPBIC_EPERM
 = 8,

1639 
	eoÂ_bad_m©ch_code
 {

1640 
	mOFPBMC_BAD_TYPE
 = 0,

1642 
	mOFPBMC_BAD_LEN
 = 1,

1643 
	mOFPBMC_BAD_TAG
 = 2,

1644 
	mOFPBMC_BAD_DL_ADDR_MASK
 = 3,

1647 
	mOFPBMC_BAD_NW_ADDR_MASK
 = 4,

1650 
	mOFPBMC_BAD_WILDCARDS
 = 5,

1652 
	mOFPBMC_BAD_FIELD
 = 6,

1653 
	mOFPBMC_BAD_VALUE
 = 7,

1654 
	mOFPBMC_BAD_MASK
 = 8,

1656 
	mOFPBMC_BAD_PREREQ
 = 9,

1657 
	mOFPBMC_DUP_FIELD
 = 10,

1658 
	mOFPBMC_EPERM
 = 11,

1663 
	eoÂ_Êow_mod_Áûed_code
 {

1664 
	mOFPFMFC_UNKNOWN
 = 0,

1665 
	mOFPFMFC_TABLE_FULL
 = 1,

1666 
	mOFPFMFC_BAD_TABLE_ID
 = 2,

1667 
	mOFPFMFC_OVERLAP
 = 3,

1669 
	mOFPFMFC_EPERM
 = 4,

1670 
	mOFPFMFC_BAD_TIMEOUT
 = 5,

1672 
	mOFPFMFC_BAD_COMMAND
 = 6,

1673 
	mOFPFMFC_BAD_FLAGS
 = 7,

1678 
	eoÂ_group_mod_Áûed_code
 {

1679 
	mOFPGMFC_GROUP_EXISTS
 = 0,

1682 
	mOFPGMFC_INVALID_GROUP
 = 1,

1684 
	mOFPGMFC_OUT_OF_GROUPS
 = 3,

1686 
	mOFPGMFC_OUT_OF_BUCKETS
 = 4,

1688 
	mOFPGMFC_CHAINING_UNSUPPORTED
 = 5,

1690 
	mOFPGMFC_WATCH_UNSUPPORTED
 = 6,

1692 
	mOFPGMFC_LOOP
 = 7,

1693 
	mOFPGMFC_UNKNOWN_GROUP
 = 8,

1696 
	mOFPGMFC_CHAINED_GROUP
 = 9,

1698 
	mOFPGMFC_BAD_TYPE
 = 10,

1699 
	mOFPGMFC_BAD_COMMAND
 = 11,

1700 
	mOFPGMFC_BAD_BUCKET
 = 12,

1701 
	mOFPGMFC_BAD_WATCH
 = 13,

1702 
	mOFPGMFC_EPERM
 = 14,

1707 
	eoÂ_p‹t_mod_Áûed_code
 {

1708 
	mOFPPMFC_BAD_PORT
 = 0,

1709 
	mOFPPMFC_BAD_HW_ADDR
 = 1,

1711 
	mOFPPMFC_BAD_CONFIG
 = 2,

1712 
	mOFPPMFC_BAD_ADVERTISE
 = 3,

1713 
	mOFPPMFC_EPERM
 = 4,

1718 
	eoÂ_èbÀ_mod_Áûed_code
 {

1719 
	mOFPTMFC_BAD_TABLE
 = 0,

1720 
	mOFPTMFC_BAD_CONFIG
 = 1,

1721 
	mOFPTMFC_EPERM
 = 2,

1726 
	eoÂ_queue_›_Áûed_code
 {

1727 
	mOFPQOFC_BAD_PORT
 = 0,

1728 
	mOFPQOFC_BAD_QUEUE
 = 1,

1729 
	mOFPQOFC_EPERM
 = 2,

1734 
	eoÂ_swôch_c⁄fig_Áûed_code
 {

1735 
	mOFPSCFC_BAD_FLAGS
 = 0,

1736 
	mOFPSCFC_BAD_LEN
 = 1,

1737 
	mOFPQCFC_EPERM
 = 2,

1742 
	eoÂ_rﬁe_ªque°_Áûed_code
 {

1743 
	mOFPRRFC_STALE
 = 0,

1744 
	mOFPRRFC_UNSUP
 = 1,

1745 
	mOFPRRFC_BAD_ROLE
 = 2,

1750 
	eoÂ_mëî_mod_Áûed_code
 {

1751 
	mOFPMMFC_UNKNOWN
 = 0,

1752 
	mOFPMMFC_METER_EXISTS
 = 1,

1754 
	mOFPMMFC_INVALID_METER
 = 2,

1756 
	mOFPMMFC_UNKNOWN_METER
 = 3,

1759 
	mOFPMMFC_BAD_COMMAND
 = 4,

1760 
	mOFPMMFC_BAD_FLAGS
 = 5,

1761 
	mOFPMMFC_BAD_RATE
 = 6,

1762 
	mOFPMMFC_BAD_BURST
 = 7,

1763 
	mOFPMMFC_BAD_BAND
 = 8,

1764 
	mOFPMMFC_BAD_BAND_VALUE
 = 9,

1765 
	mOFPMMFC_OUT_OF_METERS
 = 10,

1766 
	mOFPMMFC_OUT_OF_BANDS
 = 11,

1772 
	eoÂ_èbÀ_„©uªs_Áûed_code
 {

1773 
	mOFPTFFC_BAD_TABLE
 = 0,

1774 
	mOFPTFFC_BAD_METADATA
 = 1,

1775 
	mOFPTFFC_BAD_TYPE
 = 2,

1776 
	mOFPTFFC_BAD_LEN
 = 3,

1777 
	mOFPTFFC_BAD_ARGUMENT
 = 4,

1778 
	mOFPTFFC_EPERM
 = 5,

1782 
	soÂ_îr‹_ex≥rimíãr_msg
 {

1783 
oÂ_hódî
 
	mhódî
;

1784 
uöt16_t
 
	mty≥
;

1785 
uöt16_t
 
	mexp_ty≥
;

1786 
uöt32_t
 
	mex≥rimíãr
;

1788 
uöt8_t
 
	md©a
[0];

1791 
OFP_ASSERT
((
oÂ_îr‹_ex≥rimíãr_msg
) == 16);

1794 
	soÂ_ex≥rimíãr_hódî
 {

1795 
oÂ_hódî
 
	mhódî
;

1796 
uöt32_t
 
	mex≥rimíãr
;

1799 
uöt32_t
 
	mexp_ty≥
;

1802 
OFP_ASSERT
((
oÂ_ex≥rimíãr_hódî
) == 16);

	@include/openflow/private-ext.h

33 #i‚de‡
OPENFLOW_PRIVATE_EXT_H_


34 
	#OPENFLOW_PRIVATE_EXT_H_


	)

36 #ifde‡
__KERNEL__


37 
	~<asm/byã‹dî.h
>

40 
	~"›íÊow/›íÊow.h
"

49 
	#PRIVATE_VENDOR_ID
 0x00acde48

	)

50 
	#PRIVATEOPT_PROTOCOL_STATS_REQUEST
 0x0001

	)

51 
	#PRIVATEOPT_PROTOCOL_STATS_REPLY
 0x0002

	)

52 
	#PRIVATEOPT_EMERG_FLOW_PROTECTION
 0x0003

	)

53 
	#PRIVATEOPT_EMERG_FLOW_RESTORATION
 0x0004

	)

55 
	s¥iv©e_vxhdr
 {

56 
oÂ_hódî
 
	moÂ_hdr
;

57 
uöt32_t
 
	moÂ_vxid
;

58 } 
__©åibuã__
 ((
__∑cked__
));

61 
	s¥iv©e_vx›t
 {

62 
uöt16_t
 
	mpvo_ty≥
;

63 
uöt16_t
 
	mpvo_Àn
;

66 } 
__©åibuã__
 ((
__∑cked__
));

	@lib/backtrace.c

34 
	~<c⁄fig.h
>

35 
	~"backåa˚.h
"

36 
	~<î∫o.h
>

37 
	~<öây≥s.h
>

38 
	~<°dboﬁ.h
>

39 
	~<°dio.h
>

40 
	~"compûî.h
"

42 
	#LOG_MODULE
 
VLM_backåa˚


	)

43 
	~"vlog.h
"

45 
uöçå_t
 
UNUSED


46 
	$gë_max_°ack
()

48 c⁄° 
fûe_«me
[] = "/proc/self/maps";

49 
löe
[1024];

50 
löe_numbî
;

51 
FILE
 *
f
;

53 
f
 = 
	`f›í
(
fûe_«me
, "r");

54 i‡(
f
 =
NULL
) {

55 
	`VLOG_WARN
(
LOG_MODULE
, "›íög %†Áûed: %s", 
fûe_«me
, 
	`°ªº‹
(
î∫o
));

59 
löe_numbî
 = 1; 
	`fgës
(
löe
, Üöe, 
f
);Üine_number++) {

60 i‡(
	`°r°r
(
löe
, "[stack]")) {

61 
uöçå_t
 
íd
;

62 i‡(
	`ssˇnf
(
löe
, "%*"
SCNxPTR
"-%"SCNxPTR, &
íd
) != 1) {

63 
	`VLOG_WARN
(
LOG_MODULE
, "%s:%d:Ö¨£Éº‹", 
fûe_«me
, 
löe_numbî
);

66 
	`f˛o£
(
f
);

67  
íd
;

70 
	`f˛o£
(
f
);

72 
	`VLOG_WARN
(
LOG_MODULE
, "%s:Çÿ°ack found", 
fûe_«me
);

74 
	}
}

76 
uöçå_t


77 
	$°ack_high
()

79 
uöçå_t
 
high
;

80 i‡(!
high
) {

81 
high
 = 
	`gë_max_°ack
();

83  
high
;

84 
	}
}

86 
uöçå_t


87 
	$°ack_low
()

89 #ifde‡
__i386__


90 
uöçå_t
 
low
;

91 
	`asm
("mov»%%e•,%0" : "=g" (
low
));

92  
low
;

96 
dummy
;

97  (
uöçå_t
Ë&
dummy
;

99 
	}
}

101 
boﬁ


102 
	$ö_°ack
(*
p
)

104 
uöçå_t
 
addªss
 = (uöçå_tË
p
;

105  
addªss
 >
	`°ack_low
(Ë&&áddªs†< 
	`°ack_high
();

106 
	}
}

109 
	$backåa˚_ˇ±uª
(
backåa˚
 *backtrace)

111 **
‰ame
;

112 
size_t
 
n
;

114 
n
 = 0;

115 
‰ame
 = 
	`__buûtö_‰ame_addªss
(1);

116 
‰ame
 !
NULL
 && 
	`ö_°ack
(frame) && frame[0] != NULL

117 && 
n
 < 
BACKTRACE_MAX_FRAMES
;

118 
‰ame
 = frame[0])

120 
backåa˚
->
‰ames
[
n
++] = (
uöçå_t
Ë
‰ame
[1];

122 
backåa˚
->
n_‰ames
 = 
n
;

123 
	}
}

	@lib/backtrace.h

34 #i‚de‡
BACKTRACE_H


35 
	#BACKTRACE_H
 1

	)

37 
	~<°döt.h
>

39 
	#BACKTRACE_MAX_FRAMES
 31

	)

41 
	sbackåa˚
 {

42 
	mn_‰ames
;

43 
uöçå_t
 
	m‰ames
[
BACKTRACE_MAX_FRAMES
];

46 
backåa˚_ˇ±uª
(
backåa˚
 *);

	@lib/byte-order.h

16 #i‚de‡
BYTE_ORDER_H


17 
	#BYTE_ORDER_H
 1

	)

19 
	~<¨∑/öë.h
>

20 
	~<sys/ty≥s.h
>

21 
	~<öây≥s.h
>

23 
	ebyã_‹dî
{

25 
	mNETWORK_ORDER
 = 0,

26 
	mHOST_ORDER
 = 1,

29 
ölöe
 
uöt64_t


30 
	$ht⁄Œ
(
uöt64_t
 
n
)

32  
	`ht⁄l
(1Ë=1 ? 
n
 : ((
uöt64_t
) htonl(n) << 32) | htonl(n >> 32);

33 
	}
}

35 
ölöe
 
uöt64_t


36 
	$¡ohŒ
(
uöt64_t
 
n
)

38  
	`ht⁄l
(1Ë=1 ? 
n
 : ((
uöt64_t
Ë
	`¡ohl
(n) << 32) |Çtohl(n >> 32);

39 
	}
}

46 #ifde‡
WORDS_BIGENDIAN


47 
	#CONSTANT_HTONS
(
VALUE
Ë((
uöt16_t
Ë(VALUE))

	)

48 
	#CONSTANT_HTONL
(
VALUE
Ë((
uöt32_t
Ë(VALUE))

	)

49 
	#CONSTANT_HTONLL
(
VALUE
Ë((
uöt64_t
Ë(VALUE))

	)

51 
	#CONSTANT_HTONS
(
VALUE
) \

52 (((((
uöt16_t
Ë(
VALUE
)) & 0xff00) >> 8) | \

53 ((((
uöt16_t
Ë(
VALUE
)Ë& 0x00ffË<< 8))

	)

54 
	#CONSTANT_HTONL
(
VALUE
) \

55 (((((
uöt32_t
Ë(
VALUE
)) & 0x000000ff) << 24) | \

56 ((((
uöt32_t
Ë(
VALUE
)) & 0x0000ff00) << 8) | \

57 ((((
uöt32_t
Ë(
VALUE
)) & 0x00ff0000) >> 8) | \

58 ((((
uöt32_t
Ë(
VALUE
)Ë& 0xff000000Ë>> 24))

	)

59 
	#CONSTANT_HTONLL
(
VALUE
) \

60 (((((
uöt64_t
Ë(
VALUE
)Ë& 
	`UINT64_C
(0x00000000000000ff)) << 56) | \

61 ((((
uöt64_t
Ë(
VALUE
)Ë& 
	`UINT64_C
(0x000000000000ff00)) << 40) | \

62 ((((
uöt64_t
Ë(
VALUE
)Ë& 
	`UINT64_C
(0x0000000000ff0000)) << 24) | \

63 ((((
uöt64_t
Ë(
VALUE
)Ë& 
	`UINT64_C
(0x00000000ff000000)) << 8) | \

64 ((((
uöt64_t
Ë(
VALUE
)Ë& 
	`UINT64_C
(0x000000ff00000000)) >> 8) | \

65 ((((
uöt64_t
Ë(
VALUE
)Ë& 
	`UINT64_C
(0x0000ff0000000000)) >> 24) | \

66 ((((
uöt64_t
Ë(
VALUE
)Ë& 
	`UINT64_C
(0x00ff000000000000)) >> 40) | \

67 ((((
uöt64_t
Ë(
VALUE
)Ë& 
	`UINT64_C
(0xff00000000000000)Ë>> 56))

	)

	@lib/command-line.c

34 
	~<c⁄fig.h
>

35 
	~"comm™d-löe.h
"

36 
	~<gë›t.h
>

37 
	~<limôs.h
>

38 
	~"utû.h
"

39 
	~"vlog.h
"

45 
	$l⁄g_›ti⁄s_to_sh‹t_›ti⁄s
(c⁄° 
›ti⁄
 
›ti⁄s
[])

47 
sh‹t_›ti⁄s
[
UCHAR_MAX
 * 3 + 1];

48 *
p
 = 
sh‹t_›ti⁄s
;

50 ; 
›ti⁄s
->
«me
; options++) {

51 c⁄° 
›ti⁄
 *
o
 = 
›ti⁄s
;

52 i‡(
o
->
Êag
 =
NULL
 && o->
vÆ
 > 0 && o->vÆ <
UCHAR_MAX
) {

53 *
p
++ = 
o
->
vÆ
;

54 i‡(
o
->
has_¨g
 =
ªquúed_¨gumít
) {

55 *
p
++ = ':';

56 } i‡(
o
->
has_¨g
 =
›ti⁄Æ_¨gumít
) {

57 *
p
++ = ':';

58 *
p
++ = ':';

62 *
p
 = '\0';

64  
	`x°rdup
(
sh‹t_›ti⁄s
);

65 
	}
}

	@lib/command-line.h

34 #i‚de‡
COMMAND_LINE_H


35 
	#COMMAND_LINE_H
 1

	)

39 
	g›ti⁄
;

40 *
l⁄g_›ti⁄s_to_sh‹t_›ti⁄s
(c⁄° 
›ti⁄
 *
›ti⁄s
);

	@lib/compiler.h

34 #i‚de‡
COMPILER_H


35 
	#COMPILER_H
 1

	)

37 
	#NO_RETURN
 
	`__©åibuã__
((
__n‹ëu∫__
))

	)

38 
	#UNUSED
 
	`__©åibuã__
((
__unu£d__
))

	)

39 
	#PACKED
 
	`__©åibuã__
((
__∑cked__
))

	)

40 
	#PRINTF_FORMAT
(
FMT
, 
ARG1
Ë
	`__©åibuã__
((
	`__f‹m©__
(
¥ötf
, FMT, ARG1)))

	)

41 
	#STRFTIME_FORMAT
(
FMT
Ë
	`__©åibuã__
((
	`__f‹m©__
(
__°r·ime__
, FMT, 0)))

	)

42 
	#MALLOC_LIKE
 
	`__©åibuã__
((
__mÆloc__
))

	)

43 
	#likñy
(
x
Ë
	`__buûtö_ex≥˘
((x),1)

	)

44 
	#u∆ikñy
(
x
Ë
	`__buûtö_ex≥˘
((x),0)

	)

	@lib/csum.c

34 
	~<c⁄fig.h
>

35 
	~"csum.h
"

38 
uöt16_t


39 
	$csum
(c⁄° *
d©a
, 
size_t
 
n
)

41  
	`csum_föish
(
	`csum_c⁄töue
(0, 
d©a
, 
n
));

42 
	}
}

47 
uöt32_t


48 
	$csum_add16
(
uöt32_t
 
∑πül
, 
uöt16_t
 
√w
)

50  
∑πül
 + 
√w
;

51 
	}
}

56 
uöt32_t


57 
	$csum_add32
(
uöt32_t
 
∑πül
, uöt32_à
√w
)

59  
∑πül
 + (
√w
 >> 16) + (new & 0xffff);

60 
	}
}

67 
uöt32_t


68 
	$csum_c⁄töue
(
uöt32_t
 
∑πül
, c⁄° *
d©a_
, 
size_t
 
n
)

70 c⁄° 
uöt16_t
 *
d©a
 = 
d©a_
;

72 ; 
n
 > 1;Ç -= 2) {

73 
∑πül
 = 
	`csum_add16
’¨tül, *
d©a
++);

75 i‡(
n
) {

76 
∑πül
 +*(
uöt8_t
 *Ë
d©a
;

78  
∑πül
;

79 
	}
}

83 
uöt16_t


84 
	$csum_föish
(
uöt32_t
 
∑πül
)

86  ~((
∑πül
 & 0xffff) + (partial >> 16));

87 
	}
}

92 
uöt16_t


93 
	$ªˇlc_csum16
(
uöt16_t
 
ﬁd_csum
, uöt16_à
ﬁd_u16
, uöt16_à
√w_u16
)

99 
uöt16_t
 
hc_com∂emít
 = ~
ﬁd_csum
;

100 
uöt16_t
 
m_com∂emít
 = ~
ﬁd_u16
;

101 
uöt16_t
 
m_¥ime
 = 
√w_u16
;

102 
uöt32_t
 
sum
 = 
hc_com∂emít
 + 
m_com∂emít
 + 
m_¥ime
;

103 
uöt16_t
 
hc_¥ime_com∂emít
 = 
sum
 + (sum >> 16);

104  ~
hc_¥ime_com∂emít
;

105 
	}
}

110 
uöt16_t


111 
	$ªˇlc_csum32
(
uöt16_t
 
ﬁd_csum
, 
uöt32_t
 
ﬁd_u32
, uöt32_à
√w_u32
)

113  
	`ªˇlc_csum16
‘eˇlc_csum16(
ﬁd_csum
, 
ﬁd_u32
, 
√w_u32
),

114 
ﬁd_u32
 >> 16, 
√w_u32
 >> 16);

115 
	}
}

	@lib/csum.h

34 #i‚de‡
CSUM_H


35 
	#CSUM_H
 1

	)

37 
	~<°ddef.h
>

38 
	~<°döt.h
>

40 
uöt16_t
 
csum
(c⁄° *, 
size_t
);

41 
uöt32_t
 
csum_add16
(uöt32_à
∑πül
, 
uöt16_t
);

42 
uöt32_t
 
csum_add32
(uöt32_à
∑πül
, uint32_t);

43 
uöt32_t
 
csum_c⁄töue
(uöt32_à
∑πül
, c⁄° *, 
size_t
);

44 
uöt16_t
 
csum_föish
(
uöt32_t
 
∑πül
);

45 
uöt16_t
 
ªˇlc_csum16
(uöt16_à
ﬁd_csum
, uöt16_à
ﬁd_u16
, uöt16_à
√w_u16
);

46 
uöt16_t
 
ªˇlc_csum32
(uöt16_à
ﬁd_csum
, 
uöt32_t
 
ﬁd_u32
, uöt32_à
√w_u32
);

	@lib/daemon.c

34 
	~<c⁄fig.h
>

35 
	~"d´m⁄.h
"

36 
	~<î∫o.h
>

37 
	~<f˙é.h
>

38 
	~<°dlib.h
>

39 
	~<°rög.h
>

40 
	~<uni°d.h
>

41 
	~"Áèl-sig«l.h
"

42 
	~"dús.h
"

43 
	~"utû.h
"

45 
	#LOG_MODULE
 
VLM_d´m⁄


	)

46 
	~"vlog.h
"

49 
boﬁ
 
	gdëach
;

52 *
	gpidfûe
;

55 
boﬁ
 
	gf‹˚
;

60 
	$make_pidfûe_«me
(c⁄° *
«me
)

62  (!
«me
 ? 
	`xa•rötf
("%s/%s.pid", 
oÂ_rundú
, 
¥ogøm_«me
)

63 : *
«me
 ='/' ? 
	`x°rdup
(name)

64 : 
	`xa•rötf
("%s/%s", 
oÂ_rundú
, 
«me
));

65 
	}
}

74 
	$£t_pidfûe
(c⁄° *
«me
)

76 
	`‰ì
(
pidfûe
);

77 
pidfûe
 = 
	`make_pidfûe_«me
(
«me
);

78 
	}
}

84 
	$gë_pidfûe
()

86  
pidfûe
;

87 
	}
}

93 
	$ign‹e_exi°ög_pidfûe
()

95 
f‹˚
 = 
åue
;

96 
	}
}

101 
	$£t_dëach
()

103 
dëach
 = 
åue
;

104 
	}
}

109 
pid_t


110 
	$Æªady_ru¬ög
()

112 
pid_t
 
pid
 = 0;

113 i‡(
pidfûe
) {

114 
fd
 = 
	`›í
(
pidfûe
, 
O_RDWR
);

115 i‡(
fd
 >= 0) {

116 
Êock
 
lck
;

117 
lck
.
l_ty≥
 = 
F_WRLCK
;

118 
lck
.
l_whí˚
 = 
SEEK_SET
;

119 
lck
.
l_°¨t
 = 0;

120 
lck
.
l_Àn
 = 0;

121 i‡(
	`f˙é
(
fd
, 
F_GETLK
, &
lck
Ë!-1 &&Ück.
l_ty≥
 !
F_UNLCK
) {

122 
pid
 = 
lck
.
l_pid
;

124 
	`˛o£
(
fd
);

127  
pid
;

128 
	}
}

133 
	$dõ_if_Æªady_ru¬ög
()

135 
pid_t
 
pid
 = 
	`Æªady_ru¬ög
();

136 i‡(
pid
) {

137 i‡(!
f‹˚
) {

138 
	`oÂ_Áèl
(0, "%s:álreadyÑunningásÖid %ld",

139 
	`gë_pidfûe
(), (Ë
pid
);

141 
	`VLOG_WARN
(
LOG_MODULE
, "%s: %sálreadyÑunningásÖid %ld",

142 
	`gë_pidfûe
(), 
¥ogøm_«me
, (Ë
pid
);

145 
	}
}

151 
	$make_pidfûe
()

153 i‡(
pidfûe
) {

156 
pid
 = 
	`gëpid
();

157 *
tmpfûe
;

158 
fd
;

160 
tmpfûe
 = 
	`xa•rötf
("%s.tmp%ld", 
pidfûe
, 
pid
);

161 
	`Áèl_sig«l_add_fûe_to_u∆ök
(
tmpfûe
);

162 
fd
 = 
	`›í
(
tmpfûe
, 
O_CREAT
 | 
O_WRONLY
 | 
O_TRUNC
, 0666);

163 i‡(
fd
 >= 0) {

164 
Êock
 
lck
;

165 
lck
.
l_ty≥
 = 
F_WRLCK
;

166 
lck
.
l_whí˚
 = 
SEEK_SET
;

167 
lck
.
l_°¨t
 = 0;

168 
lck
.
l_Àn
 = 0;

169 i‡(
	`f˙é
(
fd
, 
F_SETLK
, &
lck
) != -1) {

170 *
ãxt
 = 
	`xa•rötf
("%ld\n", 
pid
);

171 i‡(
	`wrôe
(
fd
, 
ãxt
, 
	`°æí
(text)) == strlen(text)) {

172 
	`Áèl_sig«l_add_fûe_to_u∆ök
(
pidfûe
);

173 i‡(
	`ª«me
(
tmpfûe
, 
pidfûe
) < 0) {

174 
	`VLOG_ERR
(
LOG_MODULE
, "failedÅoÑename \"%s\"Åo \"%s\": %s",

175 
tmpfûe
, 
pidfûe
, 
	`°ªº‹
(
î∫o
));

176 
	`Áèl_sig«l_ªmove_fûe_to_u∆ök
(
pidfûe
);

177 
	`˛o£
(
fd
);

181 
	`‰ì
(
ãxt
);

183 
	`VLOG_ERR
(
LOG_MODULE
, "%s: wrôêÁûed: %s", 
tmpfûe
, 
	`°ªº‹
(
î∫o
));

184 
	`˛o£
(
fd
);

187 
	`VLOG_ERR
(
LOG_MODULE
, "%s: f˙é faûed: %s", 
tmpfûe
, 
	`°ªº‹
(
î∫o
));

188 
	`˛o£
(
fd
);

191 
	`VLOG_ERR
(
LOG_MODULE
, "%s: cª©êÁûed: %s", 
tmpfûe
, 
	`°ªº‹
(
î∫o
));

193 
	`Áèl_sig«l_ªmove_fûe_to_u∆ök
(
tmpfûe
);

194 
	`‰ì
(
tmpfûe
);

196 
	`‰ì
(
pidfûe
);

197 
pidfûe
 = 
NULL
;

198 
	}
}

203 
	$d´m⁄ize
()

205 i‡(
dëach
) {

206 
c
 = 0;

207 
fds
[2];

208 i‡(
	`pùe
(
fds
) < 0) {

209 
	`oÂ_Áèl
(
î∫o
, "pipe failed");

212 
	`f‹k
()) {

215 
	`˛o£
(
fds
[1]);

216 
	`Áèl_sig«l_f‹k
();

217 i‡(
	`ªad
(
fds
[0], &
c
, 1) != 1) {

218 
	`oÂ_Áèl
(
î∫o
, "daemon child failedÅo signal startup");

220 
	`exô
(0);

224 
	`˛o£
(
fds
[0]);

225 
	`make_pidfûe
();

226 
	`wrôe
(
fds
[1], &
c
, 1);

227 
	`˛o£
(
fds
[1]);

228 
	`£tsid
();

229 
	`chdú
("/");

234 
	`oÂ_Áèl
(
î∫o
, "couldÇot fork");

238 
	`make_pidfûe
();

240 
	}
}

243 
	$d´m⁄_ußge
()

245 
	`¥ötf
(

250 
oÂ_rundú
, 
¥ogøm_«me
);

251 
	}
}

255 
pid_t


256 
	$ªad_pidfûe
(c⁄° *
pidfûe
)

258 
löe
[128];

259 
Êock
 
lck
;

260 
FILE
 *
fûe
;

261 
îr‹
;

263 
fûe
 = 
	`f›í
(
pidfûe
, "r");

264 i‡(!
fûe
) {

265 
îr‹
 = 
î∫o
;

266 
	`VLOG_WARN
(
LOG_MODULE
, "%s: o≥n: %s", 
pidfûe
, 
	`°ªº‹
(
îr‹
));

267 
îr‹
;

270 
lck
.
l_ty≥
 = 
F_WRLCK
;

271 
lck
.
l_whí˚
 = 
SEEK_SET
;

272 
lck
.
l_°¨t
 = 0;

273 
lck
.
l_Àn
 = 0;

274 i‡(
	`f˙é
(
	`fûío
(
fûe
), 
F_GETLK
, &
lck
)) {

275 
îr‹
 = 
î∫o
;

276 
	`VLOG_WARN
(
LOG_MODULE
, "%s: f˙é: %s", 
pidfûe
, 
	`°ªº‹
(
îr‹
));

277 
îr‹
;

279 i‡(
lck
.
l_ty≥
 =
F_UNLCK
) {

280 
îr‹
 = 
ESRCH
;

281 
	`VLOG_WARN
(
LOG_MODULE
, "%s:Öid fûêi†nŸÜocked", 
pidfûe
);

282 
îr‹
;

285 i‡(!
	`fgës
(
löe
, Üöe, 
fûe
)) {

286 i‡(
	`„º‹
(
fûe
)) {

287 
îr‹
 = 
î∫o
;

288 
	`VLOG_WARN
(
LOG_MODULE
, "%s:Ñód: %s", 
pidfûe
, 
	`°ªº‹
(
îr‹
));

290 
îr‹
 = 
ESRCH
;

291 
	`VLOG_WARN
(
LOG_MODULE
, "%s:Ñód: u√x≥˘edÉnd o‡fûe", 
pidfûe
);

293 
îr‹
;

296 i‡(
lck
.
l_pid
 !
	`°πoul
(
löe
, 
NULL
, 10)) {

297 
îr‹
 = 
ESRCH
;

298 
	`VLOG_WARN
(
LOG_MODULE
, "l_pid (%ld) != %sÖid (%s)",

299 (Ë
lck
.
l_pid
, 
pidfûe
, 
löe
);

300 
îr‹
;

303 
	`f˛o£
(
fûe
);

304  
lck
.
l_pid
;

306 
îr‹
:

307 i‡(
fûe
) {

308 
	`f˛o£
(
fûe
);

310  -
îr‹
;

311 
	}
}

	@lib/daemon.h

34 #i‚de‡
DAEMON_H


35 
	#DAEMON_H
 1

	)

37 
	~<°dboﬁ.h
>

38 
	~<sys/ty≥s.h
>

40 
	#DAEMON_LONG_OPTIONS
 \

41 {"dëach", 
no_¨gumít
, 0, 'D'}, \

42 {"f‹˚", 
no_¨gumít
, 0, 'f'}, \

43 {"pidfûe", 
›ti⁄Æ_¨gumít
, 0, 'P'}

	)

45 
	#DAEMON_OPTION_HANDLERS
 \

47 
	`£t_dëach
(); \

51 
	`£t_pidfûe
(
›èrg
); \

55 
	`ign‹e_exi°ög_pidfûe
(); \

56 ;

	)

58 *
make_pidfûe_«me
(c⁄° *
«me
);

59 
£t_pidfûe
(c⁄° *
«me
);

60 c⁄° *
gë_pidfûe
();

61 
£t_dëach
();

62 
d´m⁄ize
();

63 
dõ_if_Æªady_ru¬ög
();

64 
ign‹e_exi°ög_pidfûe
();

65 
d´m⁄_ußge
();

66 
pid_t
 
ªad_pidfûe
(c⁄° *
«me
);

	@lib/dhcp-client.c

34 
	~<c⁄fig.h
>

35 
	~"dh˝-˛õ¡.h
"

36 
	~<¨∑/öë.h
>

37 
	~<as£π.h
>

38 
	~<î∫o.h
>

39 
	~<öây≥s.h
>

40 
	~<limôs.h
>

41 
	~<°dlib.h
>

42 
	~<°rög.h
>

43 
	~<sys/ty≥s.h
>

44 
	~<time.h
>

45 
	~<uni°d.h
>

46 
	~"csum.h
"

47 
	~"dh˝.h
"

48 
	~"dy«mic-°rög.h
"

49 
	~"√tdev.h
"

50 
	~"oÂbuf.h
"

51 
	~"pﬁl-lo›.h
"

52 
	~"ßt-m©h.h
"

53 
	~"timevÆ.h
"

55 
	#LOG_MODULE
 
VLM_dh˝_˛õ¡


	)

56 
	~"vlog.h
"

58 
	#DHCLIENT_STATES
 \

59 
	`DHCLIENT_STATE
(
INIT
, 1 << 0) \

60 
	`DHCLIENT_STATE
(
INIT_REBOOT
, 1 << 1) \

61 
	`DHCLIENT_STATE
(
REBOOTING
, 1 << 2) \

62 
	`DHCLIENT_STATE
(
SELECTING
, 1 << 3) \

63 
	`DHCLIENT_STATE
(
REQUESTING
, 1 << 4) \

64 
	`DHCLIENT_STATE
(
BOUND
, 1 << 5) \

65 
	`DHCLIENT_STATE
(
RENEWING
, 1 << 6) \

66 
	`DHCLIENT_STATE
(
REBINDING
, 1 << 7) \

67 
	`DHCLIENT_STATE
(
RELEASED
, 1 << 8)

	)

68 
	edh˛õ¡_°©e
 {

69 
	#DHCLIENT_STATE
(
NAME
, 
VALUE
Ë
S_
##NAME = VALUE,

	)

70 
	mDHCLIENT_STATES


71 #unde‡
DHCLIENT_STATE


74 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(60, 60);

77 
	$°©e_«me
(
dh˛õ¡_°©e
 
°©e
)

79 
°©e
) {

80 
	#DHCLIENT_STATE
(
NAME
, 
VALUE
Ë
S_
##NAME:  #NAME;

	)

81 
DHCLIENT_STATES


82 #unde‡
DHCLIENT_STATE


85 
	}
}

87 
	sdh˛õ¡
 {

89 
√tdev
 *
	m√tdev
;

91 (*
	mmodify_ªque°
)(
	mdh˝_msg
 *, *
	maux
);

92 
boﬁ
 (*
vÆid©e_of„r
)(c⁄° 
	mdh˝_msg
 *, *
	maux
);

93 *
	maux
;

96 
dh˛õ¡_°©e
 
	m°©e
;

97 
	m°©e_íãªd
;

98 
uöt32_t
 
	mxid
;

99 
uöt32_t
 
	mùaddr
, 
	m√tmask
, 
	mrouãr
;

100 
uöt32_t
 
	m£rvî_ù
;

101 
dh˝_msg
 *
	mbödög
;

102 
boﬁ
 
	mch™ged
;

104 
	mªå™smô
, 
	mdñay
;

105 
	mmax_timeout
;

107 
	möô_dñay
;

109 
time_t
 
	mÀa£_expú©i⁄
;

110 
	mbound_timeout
;

111 
	mª√wög_timeout
;

112 
	mªbödög_timeout
;

115 
	mmö_timeout
;

116 
	mª˚ived
;

119 
uöt32_t
 
	m£cs
;

121 
ds
 
	ms
;

125 
	#MIN_ACCEPTABLE_LEASE
 15

	)

127 
°©e_å™sôi⁄
(
dh˛õ¡
 *, 
dh˛õ¡_°©e
);

128 
ñ≠£d_ö_this_°©e
(c⁄° 
dh˛õ¡
 *
˛i
);

129 
boﬁ
 
timeout
(
dh˛õ¡
 *, 
£cs
);

131 
dh˛õ¡_msg_öô
(
dh˛õ¡
 *, 
dh˝_msg_ty≥
,

132 
dh˝_msg
 *);

133 
£nd_ªlübly
(
dh˛õ¡
 *
˛i
,

134 (*
make_∑ckë
)(
dh˛õ¡
 *,

135 
dh˝_msg
 *));

136 
boﬁ
 
	`do_ª˚ive_msg
(
dh˛õ¡
 *, 
dh˝_msg
 *);

137 
	`do_£nd_msg
(
dh˛õ¡
 *, c⁄° 
dh˝_msg
 *);

138 
boﬁ
 
	`ª˚ive_ack
(
dh˛õ¡
 *);

140 
	`fuzz
(
x
, 
max_fuzz
);

141 
	`ˇlc_t2
(
Àa£
);

142 
	`ˇlc_t1
(
Àa£
, 
t2
);

144 
	`˛amp
(
x
, 
mö
, 
max
);

164 
	`dh˛õ¡_¸óã
(c⁄° *
√tdev_«me
,

165 (*
modify_ªque°
)(
dh˝_msg
 *, *
aux
),

166 
	$boﬁ
 (*
vÆid©e_of„r
)(c⁄° 
dh˝_msg
 *, *
aux
),

167 *
aux
, 
dh˛õ¡
 **
˛i_
)

169 
dh˛õ¡
 *
˛i
;

170 
√tdev
 *netdev;

171 
îr‹
;

173 *
˛i_
 = 
NULL
;

175 
îr‹
 = 
	`√tdev_›í
(
√tdev_«me
, 
ETH_TYPE_IP
, &
√tdev
);

177 i‡(
îr‹
) {

178 
	`VLOG_ERR
(
LOG_MODULE
, "couldÇot open %sÇetwork device: %s",

179 
√tdev_«me
, 
	`°ªº‹
(
îr‹
));

180  
îr‹
;

183 
îr‹
 = 
	`√tdev_tu∫_Êags_⁄
(
√tdev
, 
NETDEV_UP
, 
Ál£
);

184 i‡(
îr‹
) {

185 
	`VLOG_ERR
(
LOG_MODULE
, "couldÇot bring %s device up: %s",

186 
√tdev_«me
, 
	`°ªº‹
(
îr‹
));

187 
	`√tdev_˛o£
(
√tdev
);

188  
îr‹
;

191 
˛i
 = 
	`xˇŒoc
(1,  *cli);

192 
˛i
->
modify_ªque°
 = modify_request;

193 
˛i
->
vÆid©e_of„r
 = validate_offer;

194 
˛i
->
aux
 =áux;

195 
˛i
->
√tdev
 =Çetdev;

196 
˛i
->
°©e
 = 
S_RELEASED
;

197 
˛i
->
°©e_íãªd
 = 
	`time_now
();

198 
˛i
->
xid
 = 
	`øndom_uöt32
();

199 
˛i
->
ùaddr
 = 0;

200 
˛i
->
£rvî_ù
 = 0;

201 
˛i
->
ªå™smô
 = cli->
dñay
 = 0;

202 
˛i
->
max_timeout
 = 64;

203 
˛i
->
mö_timeout
 = 1;

204 
	`ds_öô
(&
˛i
->
s
);

205 
˛i
->
ch™ged
 = 
åue
;

206 *
˛i_
 = 
˛i
;

208 
	}
}

214 
	$dh˛õ¡_£t_max_timeout
(
dh˛õ¡
 *
˛i
, 
max_timeout
)

216 
˛i
->
max_timeout
 = 
	`MAX
(2, max_timeout);

217 
	}
}

221 
	$dh˛õ¡_de°roy
(
dh˛õ¡
 *
˛i
)

223 i‡(
˛i
) {

224 
	`dh˝_msg_unöô
(
˛i
->
bödög
);

225 
	`‰ì
(
˛i
->
bödög
);

226 
	`√tdev_˛o£
(
˛i
->
√tdev
);

227 
	`ds_de°roy
(&
˛i
->
s
);

228 
	`‰ì
(
˛i
);

230 
	}
}

234 
√tdev
 *

235 
	$dh˛õ¡_gë_√tdev
(
dh˛õ¡
 *
˛i
)

237  
˛i
->
√tdev
;

238 
	}
}

245 
	$dh˛õ¡_öô
(
dh˛õ¡
 *
˛i
, 
uöt32_t
 
ªque°ed_ù
)

247 
	`°©e_å™sôi⁄
(
˛i
, 
ªque°ed_ù
 ? 
S_INIT_REBOOT
 : 
S_INIT
);

248 
˛i
->
ùaddr
 = 
ªque°ed_ù
;

249 
˛i
->
mö_timeout
 = 0;

250 
˛i
->
öô_dñay
 = 0;

251 
	}
}

256 
	$dh˛õ¡_ªÀa£
(
dh˛õ¡
 *
˛i
)

258 i‡(
	`dh˛õ¡_is_bound
(
˛i
)) {

259 
dh˝_msg
 
msg
;

260 
	`dh˛õ¡_msg_öô
(
˛i
, 
DHCPRELEASE
, &
msg
);

261 
msg
.
cüddr
 = 
˛i
->
ùaddr
;

262 
	`do_£nd_msg
(
˛i
, &
msg
);

263 
	`dh˝_msg_unöô
(&
msg
);

265 
	`°©e_å™sôi⁄
(
˛i
, 
S_RELEASED
);

266 
˛i
->
mö_timeout
 = 
UINT_MAX
;

267 
	}
}

270 
	$do_f‹˚_ª√w
(
dh˛õ¡
 *
˛i
, 
dódlöe
)

272 
time_t
 
now
 = 
	`time_now
();

273 
Àa£_À·
 = 
	`ßt_sub
(
˛i
->
Àa£_expú©i⁄
, 
now
);

274 i‡(
Àa£_À·
 <
dódlöe
) {

275 i‡(
˛i
->
°©e
 & (
S_RENEWING
 | 
S_REBINDING
)) {

278 
dódlöe
 = 
Àa£_À·
;

280 i‡(
˛i
->
°©e
 & (
S_BOUND
 | 
S_RENEWING
)) {

281 
	`°©e_å™sôi⁄
(
˛i
, 
S_RENEWING
);

282 
˛i
->
ª√wög_timeout
 = 
dódlöe
 * 3 / 4;

283 
˛i
->
ªbödög_timeout
 = 
dódlöe
 * 1 / 4;

285 
	`°©e_å™sôi⁄
(
˛i
, 
S_REBINDING
);

286 
˛i
->
ªbödög_timeout
 = 
dódlöe
;

288 
˛i
->
mö_timeout
 = 0;

289 
	}
}

295 
	$dh˛õ¡_f‹˚_ª√w
(
dh˛õ¡
 *
˛i
, 
dódlöe
)

299 
	`√tdev_døö
(
˛i
->
√tdev
);

301 
˛i
->
°©e
) {

302 
S_INIT
:

303 
S_INIT_REBOOT
:

304 
S_REBOOTING
:

305 
S_SELECTING
:

306 
S_REQUESTING
:

309 
S_BOUND
:

310 
S_RENEWING
:

311 
S_REBINDING
:

312 
	`do_f‹˚_ª√w
(
˛i
, 
dódlöe
);

315 
S_RELEASED
:

316 
	`dh˛õ¡_öô
(
˛i
, 0);

319 
	}
}

322 
boﬁ


323 
	$dh˛õ¡_is_bound
(c⁄° 
dh˛õ¡
 *
˛i
)

325  
˛i
->
°©e
 & (
S_BOUND
 | 
S_RENEWING
 | 
S_REBINDING
);

326 
	}
}

330 
boﬁ


331 
	$dh˛õ¡_ch™ged
(
dh˛õ¡
 *
˛i
)

333 
boﬁ
 
ch™ged
 = 
˛i
->changed;

334 
˛i
->
ch™ged
 = 0;

335  
ch™ged
;

336 
	}
}

341 
	$dh˛õ¡_gë_°©e
(c⁄° 
dh˛õ¡
 *
˛i
)

343  
	`°©e_«me
(
˛i
->
°©e
);

344 
	}
}

348 
	$dh˛õ¡_gë_°©e_ñ≠£d
(c⁄° 
dh˛õ¡
 *
˛i
)

350  
	`ñ≠£d_ö_this_°©e
(
˛i
);

351 
	}
}

356 
	$dh˛õ¡_gë_Àa£_ªmaöög
(c⁄° 
dh˛õ¡
 *
˛i
)

358 i‡(
	`dh˛õ¡_is_bound
(
˛i
)) {

359 
time_t
 
now
 = 
	`time_now
();

360  
˛i
->
Àa£_expú©i⁄
 > 
now
 ? cli->lease_expiration -Çow : 0;

364 
	}
}

368 
uöt32_t


369 
	$dh˛õ¡_gë_ù
(c⁄° 
dh˛õ¡
 *
˛i
)

371  
	`dh˛õ¡_is_bound
(
˛i
Ë? cli->
ùaddr
 : 0;

372 
	}
}

376 
uöt32_t


377 
	$dh˛õ¡_gë_√tmask
(c⁄° 
dh˛õ¡
 *
˛i
)

379  
	`dh˛õ¡_is_bound
(
˛i
Ë? cli->
√tmask
 : 0;

380 
	}
}

384 
uöt32_t


385 
	$dh˛õ¡_gë_rouãr
(c⁄° 
dh˛õ¡
 *
˛i
)

387  
	`dh˛õ¡_is_bound
(
˛i
Ë? cli->
rouãr
 : 0;

388 
	}
}

393 c⁄° 
dh˝_msg
 *

394 
	$dh˛õ¡_gë_c⁄fig
(c⁄° 
dh˛õ¡
 *
˛i
)

396  
	`dh˛õ¡_is_bound
(
˛i
Ë? cli->
bödög
 : 
NULL
;

397 
	}
}

414 
	$dh˛õ¡_c⁄figuª_√tdev
(
dh˛õ¡
 *
˛i
)

416 
ö_addr
 
addr
 = { 
	`dh˛õ¡_gë_ù
(
˛i
) };

417 
ö_addr
 
mask
 = { 
	`dh˛õ¡_gë_√tmask
(
˛i
) };

418 
ö_addr
 
rouãr
 = { 
	`dh˛õ¡_gë_rouãr
(
˛i
) };

419 
îr‹
;

421 
îr‹
 = 
	`√tdev_£t_ö4
(
˛i
->
√tdev
, 
addr
, 
mask
);

422 i‡(
îr‹
) {

423 
	`VLOG_ERR
(
LOG_MODULE
, "couldÇŸ së %†addªs†"
IP_FMT
"/"IP_FMT": %s",

424 
	`√tdev_gë_«me
(
˛i
->
√tdev
),

425 
	`IP_ARGS
(&
addr
.
s_addr
), IP_ARGS(&
mask
.s_addr),

426 
	`°ªº‹
(
îr‹
));

429 i‡(!
îr‹
 && 
rouãr
.
s_addr
) {

430 
îr‹
 = 
	`√tdev_add_rouãr
(
rouãr
);

431 i‡(
îr‹
) {

432 
	`VLOG_ERR
(
LOG_MODULE
, "ÁûedÅÿadd deÁu…ÑouãÅÿ"
IP_FMT
" on %s: %s",

433 
	`IP_ARGS
(&
rouãr
), 
	`√tdev_gë_«me
(
˛i
->
√tdev
),

434 
	`°ªº‹
(
îr‹
));

438  
îr‹
;

439 
	}
}

445 
	$dh˛õ¡_upd©e_ªsﬁv_c⁄f
(
dh˛õ¡
 *
˛i
)

447 
uöt32_t
 
dns_£rvî
;

448 *
domaö_«me
;

449 
boﬁ
 
has_domaö_«me
;

450 
√w_«me
[128];

451 
FILE
 *
ﬁd
, *
√w
;

452 
i
;

454 i‡(!
	`dh˛õ¡_is_bound
(
˛i
)) {

457 i‡(!
	`dh˝_msg_gë_ù
(
˛i
->
bödög
, 
DHCP_CODE_DNS_SERVER
, 0, &
dns_£rvî
)) {

458 
	`VLOG_DBG
(
LOG_MODULE
, "binding doesÇot includeány DNS servers");

462 
	`•rötf
(
√w_«me
, "/ëc/ªsﬁv.c⁄f.tmp%ld", (Ë
	`gëpid
());

463 
√w
 = 
	`f›í
(
√w_«me
, "w");

464 i‡(!
√w
) {

465 
	`VLOG_WARN
(
LOG_MODULE
, "%s: cª©e: %s", 
√w_«me
, 
	`°ªº‹
(
î∫o
));

466  
î∫o
;

469 
domaö_«me
 = 
	`dh˝_msg_gë_°rög
(
˛i
->
bödög
, 
DHCP_CODE_DOMAIN_NAME
);

470 
has_domaö_«me
 = 
domaö_«me
 !
NULL
;

471 i‡(
domaö_«me
) {

472 i‡(
	`°r•n
(
domaö_«me
, "-_.0123456789abcdefghijklmnopqrstuvwxyz"

473 "ABCDEFGHIJKLMNOPQRSTUVWXYZ"Ë=
	`°æí
(
domaö_«me
)) {

474 
	`Ârötf
(
√w
, "domaö %s\n", 
domaö_«me
);

476 
	`VLOG_WARN
(
LOG_MODULE
, "ign‹ög invÆid domaöÇamê%s", 
domaö_«me
);

477 
has_domaö_«me
 = 
Ál£
;

480 
	`VLOG_DBG
(
LOG_MODULE
, "binding doesÇot include domainÇame");

482 
	`‰ì
(
domaö_«me
);

484 
i
 = 0; 
	`dh˝_msg_gë_ù
(
˛i
->
bödög
, 
DHCP_CODE_DNS_SERVER
,

485 
i
, &
dns_£rvî
); i++) {

486 
	`Ârötf
(
√w
, "«me£rvî "
IP_FMT
"\n", 
	`IP_ARGS
(&
dns_£rvî
));

489 
ﬁd
 = 
	`f›í
("/etc/resolv.conf", "r");

490 i‡(
ﬁd
) {

491 
löe
[128];

493 
	`fgës
(
löe
, Üöe, 
ﬁd
)) {

494 *
kw
 = 
	`xmemdup0
(
löe
, 
	`°rc•n
(line, " \t\r\n"));

495 i‡(
	`°rcmp
(
kw
, "nameserver")

496 && (!
has_domaö_«me


497 || (
	`°rcmp
(
kw
, "domain") && strcmp(kw, "search")))) {

498 
	`Âuts
(
löe
, 
√w
);

500 
	`‰ì
(
kw
);

502 
	`f˛o£
(
ﬁd
);

504 
	`VLOG_DBG
(
LOG_MODULE
, "/ëc/ªsﬁv.c⁄f: o≥n: %s", 
	`°ªº‹
(
î∫o
));

507 i‡(
	`f˛o£
(
√w
) < 0) {

508 
	`VLOG_WARN
(
LOG_MODULE
, "%s: clo£: %s", 
√w_«me
, 
	`°ªº‹
(
î∫o
));

509  
î∫o
;

512 i‡(
	`ª«me
(
√w_«me
, "/etc/resolv.conf") < 0) {

513 
	`VLOG_WARN
(
LOG_MODULE
, "failedÅoÑename %sÅo /etc/resolv.conf: %s",

514 
√w_«me
, 
	`°ªº‹
(
î∫o
));

515  
î∫o
;

519 
	}
}

524 
	$make_dh˝discovî
(
dh˛õ¡
 *
˛i
, 
dh˝_msg
 *
msg
)

526 
˛i
->
£cs
 = 
	`ñ≠£d_ö_this_°©e
(cli);

527 
	`dh˛õ¡_msg_öô
(
˛i
, 
DHCPDISCOVER
, 
msg
);

528 i‡(
˛i
->
ùaddr
) {

529 
	`dh˝_msg_put_ù
(
msg
, 
DHCP_CODE_REQUESTED_IP
, 
˛i
->
ùaddr
);

531 
	}
}

534 
	$make_dh˝ªque°
(
dh˛õ¡
 *
˛i
, 
dh˝_msg
 *
msg
)

536 
	`dh˛õ¡_msg_öô
(
˛i
, 
DHCPREQUEST
, 
msg
);

537 
msg
->
cüddr
 = 
	`dh˛õ¡_gë_ù
(
˛i
);

538 i‡(
˛i
->
°©e
 =
S_REQUESTING
) {

539 
	`dh˝_msg_put_ù
(
msg
, 
DHCP_CODE_SERVER_IDENTIFIER
, 
˛i
->
£rvî_ù
);

541 
	`dh˝_msg_put_ù
(
msg
, 
DHCP_CODE_REQUESTED_IP
, 
˛i
->
ùaddr
);

542 
	}
}

545 
	$do_öô
(
dh˛õ¡
 *
˛i
, 
dh˛õ¡_°©e
 
√xt_°©e
)

547 i‡(!
˛i
->
öô_dñay
) {

548 
˛i
->
öô_dñay
 = 
	`fuzz
(2, 1);

550 i‡(
	`timeout
(
˛i
, cli->
öô_dñay
)) {

551 
	`°©e_å™sôi⁄
(
˛i
, 
√xt_°©e
);

553 
	}
}

556 
	$dh˛õ¡_run_INIT
(
dh˛õ¡
 *
˛i
)

558 
	`do_öô
(
˛i
, 
S_SELECTING
);

559 
	}
}

562 
	$dh˛õ¡_run_INIT_REBOOT
(
dh˛õ¡
 *
˛i
)

564 
	`do_öô
(
˛i
, 
S_REBOOTING
);

565 
	}
}

568 
	$dh˛õ¡_run_REBOOTING
(
dh˛õ¡
 *
˛i
)

570 
	`£nd_ªlübly
(
˛i
, 
make_dh˝ªque°
);

571 i‡(!
	`ª˚ive_ack
(
˛i
Ë&& 
	`timeout
(cli, 60)) {

572 
	`°©e_å™sôi⁄
(
˛i
, 
S_INIT
);

574 
	}
}

576 
boﬁ


577 
	$dh˝_ª˚ive
(
dh˛õ¡
 *
˛i
, 
msgs
, 
dh˝_msg
 *
msg
)

579 
	`do_ª˚ive_msg
(
˛i
, 
msg
)) {

580 i‡(
msg
->
ty≥
 > 31 || !((1u << msg->ty≥Ë& 
msgs
)) {

581 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "received unexpected %s in %s state: %s",

582 
	`dh˝_ty≥_«me
(
msg
->
ty≥
), 
	`°©e_«me
(
˛i
->
°©e
),

583 
	`dh˝_msg_to_°rög
(
msg
, 
Ál£
, &
˛i
->
s
));

584 } i‡(
msg
->
xid
 !
˛i
->xid) {

585 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
,

586 "ign‹ög %†wôh xid !%08"
PRIx32
" in %s state: %s",

587 
	`dh˝_ty≥_«me
(
msg
->
ty≥
), msg->
xid
,

588 
	`°©e_«me
(
˛i
->
°©e
),

589 
	`dh˝_msg_to_°rög
(
msg
, 
Ál£
, &
˛i
->
s
));

591  
åue
;

593 
	`dh˝_msg_unöô
(
msg
);

595  
Ál£
;

596 
	}
}

598 
boﬁ


599 
	$vÆid©e_of„ªd_›ti⁄s
(
dh˛õ¡
 *
˛i
, c⁄° 
dh˝_msg
 *
msg
)

601 
uöt32_t
 
Àa£
, 
√tmask
;

602 i‡(!
	`dh˝_msg_gë_£cs
(
msg
, 
DHCP_CODE_LEASE_TIME
, 0, &
Àa£
)) {

603 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "%†œck†Àa£Åime: %s", 
	`dh˝_ty≥_«me
(
msg
->
ty≥
),

604 
	`dh˝_msg_to_°rög
(
msg
, 
Ál£
, &
˛i
->
s
));

605 } i‡(!
	`dh˝_msg_gë_ù
(
msg
, 
DHCP_CODE_SUBNET_MASK
, 0, &
√tmask
)) {

606 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "%†œck†√tmask: %s", 
	`dh˝_ty≥_«me
(
msg
->
ty≥
),

607 
	`dh˝_msg_to_°rög
(
msg
, 
Ál£
, &
˛i
->
s
));

608 } i‡(
Àa£
 < 
MIN_ACCEPTABLE_LEASE
) {

609 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "Ign‹ög %†wôh %"
PRIu32
"-secondÜeaseÅime: %s",

610 
	`dh˝_ty≥_«me
(
msg
->
ty≥
), 
Àa£
,

611 
	`dh˝_msg_to_°rög
(
msg
, 
Ál£
, &
˛i
->
s
));

612 } i‡(
˛i
->
vÆid©e_of„r
 && !˛i->
	`vÆid©e_of„r
(
msg
, cli->
aux
)) {

613 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "client validation hookÑefused offer: %s",

614 
	`dh˝_msg_to_°rög
(
msg
, 
Ál£
, &
˛i
->
s
));

616  
åue
;

618  
Ál£
;

619 
	}
}

622 
	$dh˛õ¡_run_SELECTING
(
dh˛õ¡
 *
˛i
)

624 
dh˝_msg
 
msg
;

626 
	`£nd_ªlübly
(
˛i
, 
make_dh˝discovî
);

627 i‡(
˛i
->
£rvî_ù
 && 
	`timeout
(cli, 60)) {

628 
˛i
->
£rvî_ù
 = 0;

629 
	`°©e_å™sôi⁄
(
˛i
, 
S_INIT
);

631 ; 
	`dh˝_ª˚ive
(
˛i
, 1u << 
DHCPOFFER
, &
msg
); 
	`dh˝_msg_unöô
(&msg)) {

632 i‡(!
	`vÆid©e_of„ªd_›ti⁄s
(
˛i
, &
msg
)) {

635 i‡(!
	`dh˝_msg_gë_ù
(&
msg
, 
DHCP_CODE_SERVER_IDENTIFIER
,

636 0, &
˛i
->
£rvî_ù
)) {

637 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "DHCPOFFERÜacks server identifier: %s",

638 
	`dh˝_msg_to_°rög
(&
msg
, 
Ál£
, &
˛i
->
s
));

642 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "accepting DHCPOFFER: %s",

643 
	`dh˝_msg_to_°rög
(&
msg
, 
Ál£
, &
˛i
->
s
));

644 
˛i
->
ùaddr
 = 
msg
.
yüddr
;

645 
	`°©e_å™sôi⁄
(
˛i
, 
S_REQUESTING
);

648 
	}
}

650 
boﬁ


651 
	$ßme_bödög
(c⁄° 
dh˝_msg
 *
ﬁd
, c⁄° dh˝_msg *
√w
)

653 c⁄° 
codes
[] = {

654 
DHCP_CODE_SUBNET_MASK
,

655 
DHCP_CODE_ROUTER
,

656 
DHCP_CODE_DNS_SERVER
,

657 
DHCP_CODE_HOST_NAME
,

658 
DHCP_CODE_DOMAIN_NAME
,

659 
DHCP_CODE_IP_TTL
,

660 
DHCP_CODE_MTU
,

661 
DHCP_CODE_BROADCAST_ADDRESS
,

662 
DHCP_CODE_STATIC_ROUTE
,

663 
DHCP_CODE_ARP_CACHE_TIMEOUT
,

664 
DHCP_CODE_ETHERNET_ENCAPSULATION
,

665 
DHCP_CODE_TCP_TTL
,

666 
DHCP_CODE_SERVER_IDENTIFIER
,

667 
DHCP_CODE_OFP_CONTROLLER_VCONN
,

668 
DHCP_CODE_OFP_PKI_URI
,

670 
i
;

671 
boﬁ
 
ßme
 = 
åue
;

673 i‡(
ﬁd
->
yüddr
 !
√w
->yiaddr) {

674 
	`VLOG_WARN
(
LOG_MODULE
, "DHCP bödög ch™ged IPáddªs†‰om "
IP_FMT
"Åo "IP_FMT,

675 
	`IP_ARGS
(&
ﬁd
->
yüddr
), IP_ARGS(&
√w
->yiaddr));

676 
ßme
 = 
Ál£
;

678 
i
 = 0; i < 
	`ARRAY_SIZE
(
codes
); i++) {

679 
code
 = 
codes
[
i
];

680 c⁄° 
dh˝_›ti⁄
 *
ﬁd_›t
 = &
ﬁd
->
›ti⁄s
[
code
];

681 c⁄° 
dh˝_›ti⁄
 *
√w_›t
 = &
√w
->
›ti⁄s
[
code
];

682 i‡(!
	`dh˝_›ti⁄_equÆs
(
ﬁd_›t
, 
√w_›t
)) {

683 
ds
 
ﬁd_°rög
 = 
DS_EMPTY_INITIALIZER
;

684 
ds
 
√w_°rög
 = 
DS_EMPTY_INITIALIZER
;

685 
	`VLOG_WARN
(
LOG_MODULE
, "DHCP binding changed option from %sÅo %s",

686 
	`dh˝_›ti⁄_to_°rög
(
ﬁd_›t
, 
code
, &
ﬁd_°rög
),

687 
	`dh˝_›ti⁄_to_°rög
(
√w_›t
, 
code
, &
√w_°rög
));

688 
	`ds_de°roy
(&
ﬁd_°rög
);

689 
	`ds_de°roy
(&
√w_°rög
);

690 
ßme
 = 
Ál£
;

693  
ßme
;

694 
	}
}

696 
boﬁ


697 
	$ª˚ive_ack
(
dh˛õ¡
 *
˛i
)

699 
dh˝_msg
 
msg
;

701 i‡(!
	`dh˝_ª˚ive
(
˛i
, (1u << 
DHCPACK
Ë| (1u << 
DHCPNAK
), &
msg
)) {

702  
Ál£
;

703 } i‡(
msg
.
ty≥
 =
DHCPNAK
) {

704 
	`dh˝_msg_unöô
(&
msg
);

705 
	`°©e_å™sôi⁄
(
˛i
, 
S_INIT
);

706  
åue
;

707 } i‡(!
	`vÆid©e_of„ªd_›ti⁄s
(
˛i
, &
msg
)) {

708 
	`dh˝_msg_unöô
(&
msg
);

709  
Ál£
;

711 
uöt32_t
 
Àa£
 = 0, 
t1
 = 0, 
t2
 = 0;

713 i‡(
˛i
->
bödög
) {

714 i‡(!
	`ßme_bödög
(
˛i
->
bödög
, &
msg
)) {

715 
˛i
->
ch™ged
 = 
åue
;

717 
	`dh˝_msg_unöô
(
˛i
->
bödög
);

719 
˛i
->
bödög
 = 
	`xmÆloc
( *cli->binding);

721 
	`dh˝_msg_c›y
(
˛i
->
bödög
, &
msg
);

723 
	`dh˝_msg_gë_£cs
(&
msg
, 
DHCP_CODE_LEASE_TIME
, 0, &
Àa£
);

724 
	`dh˝_msg_gë_£cs
(&
msg
, 
DHCP_CODE_T1
, 0, &
t1
);

725 
	`dh˝_msg_gë_£cs
(&
msg
, 
DHCP_CODE_T2
, 0, &
t2
);

726 
	`as£π
(
Àa£
 >
MIN_ACCEPTABLE_LEASE
);

728 i‡(!
t2
 ||Å2 >
Àa£
) {

729 
t2
 = 
	`ˇlc_t2
(
Àa£
);

731 i‡(!
t1
 ||Å1 >
t2
) {

732 
t1
 = 
	`ˇlc_t1
(
Àa£
, 
t2
);

735 
˛i
->
Àa£_expú©i⁄
 = 
	`ßt_add
(
	`time_now
(), 
Àa£
);

736 
˛i
->
bound_timeout
 = 
t1
;

737 
˛i
->
ª√wög_timeout
 = 
t2
 - 
t1
;

738 
˛i
->
ªbödög_timeout
 = 
Àa£
 - 
t2
;

740 
˛i
->
ùaddr
 = 
msg
.
yüddr
;

741 
	`dh˝_msg_gë_ù
(&
msg
, 
DHCP_CODE_SUBNET_MASK
, 0, &
˛i
->
√tmask
);

742 i‡(!
	`dh˝_msg_gë_ù
(&
msg
, 
DHCP_CODE_ROUTER
, 0, &
˛i
->
rouãr
)) {

743 
˛i
->
rouãr
 = 
INADDR_ANY
;

745 
	`°©e_å™sôi⁄
(
˛i
, 
S_BOUND
);

746 
	`VLOG_DBG
(
LOG_MODULE
, "Bound: %s", 
	`dh˝_msg_to_°rög
(&
msg
, 
Ál£
, &
˛i
->
s
));

747  
åue
;

749 
	}
}

752 
	$dh˛õ¡_run_REQUESTING
(
dh˛õ¡
 *
˛i
)

754 
	`£nd_ªlübly
(
˛i
, 
make_dh˝ªque°
);

755 i‡(!
	`ª˚ive_ack
(
˛i
Ë&& 
	`timeout
(cli, 60)) {

756 
	`°©e_å™sôi⁄
(
˛i
, 
S_INIT
);

758 
	}
}

761 
	$dh˛õ¡_run_BOUND
(
dh˛õ¡
 *
˛i
)

763 i‡(
	`timeout
(
˛i
, cli->
bound_timeout
)) {

764 
	`°©e_å™sôi⁄
(
˛i
, 
S_RENEWING
);

766 
	}
}

769 
	$dh˛õ¡_run_RENEWING
(
dh˛õ¡
 *
˛i
)

771 
	`£nd_ªlübly
(
˛i
, 
make_dh˝ªque°
);

772 i‡(!
	`ª˚ive_ack
(
˛i
Ë&& 
	`timeout
(˛i, cli->
ª√wög_timeout
)) {

773 
	`°©e_å™sôi⁄
(
˛i
, 
S_REBINDING
);

775 
	}
}

778 
	$dh˛õ¡_run_REBINDING
(
dh˛õ¡
 *
˛i
)

780 
	`£nd_ªlübly
(
˛i
, 
make_dh˝ªque°
);

781 i‡(!
	`ª˚ive_ack
(
˛i
Ë&& 
	`timeout
(˛i, cli->
ªbödög_timeout
)) {

782 
	`°©e_å™sôi⁄
(
˛i
, 
S_INIT
);

784 
	}
}

787 
	$dh˛õ¡_run_RELEASED
(
dh˛õ¡
 *
˛i
 
UNUSED
)

790 
	}
}

794 
	$dh˛õ¡_run
(
dh˛õ¡
 *
˛i
)

796 
ﬁd_°©e
;

798 
ﬁd_°©e
 = 
˛i
->
°©e
;

799 
˛i
->
mö_timeout
 = 
UINT_MAX
;

800 
˛i
->
ª˚ived
 = 0;

801 
˛i
->
°©e
) {

802 
	#DHCLIENT_STATE
(
NAME
, 
VALUE
) \

803 
S_
##
NAME
: 
dh˛õ¡_run_
##
	`NAME
(
˛i
); ;

	)

804 
DHCLIENT_STATES


805 #unde‡
DHCLIENT_STATE


807 
	`NOT_REACHED
();

809 } 
˛i
->
°©e
 !
ﬁd_°©e
);

810 
	}
}

815 
	$dh˛õ¡_waô
(
dh˛õ¡
 *
˛i
)

817 i‡(
˛i
->
mö_timeout
 !
UINT_MAX
) {

818 
time_t
 
now
 = 
	`time_now
();

819 
wake
 = 
	`ßt_add
(
˛i
->
°©e_íãªd
, cli->
mö_timeout
);

820 i‡(
wake
 <
now
) {

821 
	`pﬁl_immedüã_wake
();

823 
	`pﬁl_timî_waô
(
	`ßt_mul
(
	`ßt_sub
(
wake
, 
now
), 1000));

830 
˛i
->
mö_timeout
 = 1;

832 i‡(
˛i
->
°©e
 & (
S_SELECTING
 | 
S_REQUESTING
 | 
S_RENEWING
 | 
S_REBINDING
)) {

833 
	`√tdev_ªcv_waô
(
˛i
->
√tdev
);

835 
	}
}

838 
	$°©e_å™sôi⁄
(
dh˛õ¡
 *
˛i
, 
dh˛õ¡_°©e
 
°©e
)

840 
boﬁ
 
was_bound
 = 
	`dh˛õ¡_is_bound
(
˛i
);

841 
boﬁ
 
am_bound
;

842 i‡(
˛i
->
°©e
 != state) {

843 
	`VLOG_DBG
(
LOG_MODULE
, "íãrög %s", 
	`°©e_«me
(
°©e
));

844 
˛i
->
°©e
 = state;

846 
˛i
->
°©e_íãªd
 = 
	`time_now
();

847 
˛i
->
ªå™smô
 = cli->
dñay
 = 0;

848 
am_bound
 = 
	`dh˛õ¡_is_bound
(
˛i
);

849 i‡(
was_bound
 !
am_bound
) {

850 
˛i
->
ch™ged
 = 
åue
;

851 i‡(
am_bound
) {

852 
	`as£π
(
˛i
->
bödög
 !
NULL
);

853 
	`VLOG_INFO
(
LOG_MODULE
, "%s: obèöedáddªs†"
IP_FMT
",Çetmask "IP_FMT,

854 
	`√tdev_gë_«me
(
˛i
->
√tdev
),

855 
	`IP_ARGS
(&
˛i
->
ùaddr
), IP_ARGS(&˛i->
√tmask
));

856 i‡(
˛i
->
rouãr
) {

857 
	`VLOG_INFO
(
LOG_MODULE
, "%s: obèöed deÁu… g©eway "
IP_FMT
,

858 
	`√tdev_gë_«me
(
˛i
->
√tdev
), 
	`IP_ARGS
(&˛i->
rouãr
));

861 
	`dh˝_msg_unöô
(
˛i
->
bödög
);

862 
	`‰ì
(
˛i
->
bödög
);

863 
˛i
->
bödög
 = 
NULL
;

865 
	`VLOG_INFO
(
LOG_MODULE
, "%s:Çetworkáddress unbound",

866 
	`√tdev_gë_«me
(
˛i
->
√tdev
));

869 i‡(
˛i
->
°©e
 & (
S_SELECTING
 | 
S_REQUESTING
 | 
S_REBOOTING
)) {

870 
	`√tdev_døö
(
˛i
->
√tdev
);

872 
	}
}

875 
£nd_ªlübly
(
dh˛õ¡
 *
˛i
,

876 (*
make_∑ckë
)(
dh˛õ¡
 *, 
dh˝_msg
 *))

878 i‡(
	`timeout
(
˛i
, cli->
ªå™smô
)) {

879 
dh˝_msg
 
msg
;

880 
	`make_∑ckë
(
˛i
, &
msg
);

881 i‡(
˛i
->
modify_ªque°
) {

882 
˛i
->
	`modify_ªque°
(&
msg
, cli->
aux
);

884 
	`do_£nd_msg
(
˛i
, &
msg
);

885 
˛i
->
dñay
 = 
	`MIN
(˛i->
max_timeout
, 
	`MAX
(4, cli->delay * 2));

886 
˛i
->
ªå™smô
 +
	`fuzz
(˛i->
dñay
, 1);

887 
	`timeout
(
˛i
, cli->
ªå™smô
);

888 
	`dh˝_msg_unöô
(&
msg
);

890 
	}
}

893 
	$dh˛õ¡_msg_öô
(
dh˛õ¡
 *
˛i
, 
dh˝_msg_ty≥
 
ty≥
,

894 
dh˝_msg
 *
msg
)

896 
	`dh˝_msg_öô
(
msg
);

897 
msg
->
›
 = 
DHCP_BOOTREQUEST
;

898 
msg
->
xid
 = 
˛i
->xid;

899 
msg
->
£cs
 = 
˛i
->secs;

900 
msg
->
ty≥
 =Åype;

901 
	`mem˝y
(
msg
->
chaddr
, 
	`√tdev_gë_ëhîaddr
(
˛i
->
√tdev
), 
ETH_ADDR_LEN
);

902 
	}
}

909 
	$ñ≠£d_ö_this_°©e
(c⁄° 
dh˛õ¡
 *
˛i
)

911  
	`time_now
(Ë- 
˛i
->
°©e_íãªd
;

912 
	}
}

914 
boﬁ


915 
	$timeout
(
dh˛õ¡
 *
˛i
, 
£cs
)

917 
˛i
->
mö_timeout
 = 
	`MIN
(˛i->mö_timeout, 
£cs
);

918  
	`time_now
(Ë>
	`ßt_add
(
˛i
->
°©e_íãªd
, 
£cs
);

919 
	}
}

921 
boﬁ


922 
	$do_ª˚ive_msg
(
dh˛õ¡
 *
˛i
, 
dh˝_msg
 *
msg
)

924 
oÂbuf
 
b
;

926 
	`oÂbuf_öô
(&
b
, 
	`√tdev_gë_mtu
(
˛i
->
√tdev
Ë+ 
VLAN_ETH_HEADER_LEN
);

927 ; 
˛i
->
ª˚ived
 < 50; cli->received++) {

928 c⁄° 
ù_hódî
 *
ù
;

929 c⁄° 
dh˝_hódî
 *
dh˝
;

931 
îr‹
;

933 
	`oÂbuf_˛ór
(&
b
);

934 
îr‹
 = 
	`√tdev_ªcv
(
˛i
->
√tdev
, &
b
);

935 i‡(
îr‹
) {

936 
døöed
;

949 
ù
 = 
b
.
l3
;

950 i‡(
	`IP_IS_FRAGMENT
(
ù
->
ù_‰ag_off
)) {

952 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "ignoring fragmented DHCP datagram");

956 
dh˝
 = 
b
.
l7
;

957 i‡(!
dh˝
) {

958 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "ignoring DHCP datagram with missingÖayload");

962 
	`oÂbuf_puŒ
(&
b
, (*)b.
l7
 - (*)b.
d©a
);

963 
îr‹
 = 
	`dh˝_∑r£
(
msg
, &
b
);

964 i‡(!
îr‹
) {

965 i‡(
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

966 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "received %s",

967 
	`dh˝_msg_to_°rög
(
msg
, 
Ál£
, &
˛i
->
s
));

969 
	`VLOG_INFO_RL
(
LOG_MODULE
, &
æ
, "ª˚ived %s", 
	`dh˝_ty≥_«me
(
msg
->
ty≥
));

971 
	`oÂbuf_unöô
(&
b
);

972  
åue
;

975 
	`√tdev_døö
(
˛i
->
√tdev
);

976 
døöed
:

977 
	`oÂbuf_unöô
(&
b
);

978  
Ál£
;

979 
	}
}

982 
	$do_£nd_msg
(
dh˛õ¡
 *
˛i
, c⁄° 
dh˝_msg
 *
msg
)

984 
oÂbuf
 
b
;

985 
ëh_hódî
 
eh
;

986 
ù_hódî
 
nh
;

987 
udp_hódî
 
th
;

988 
uöt32_t
 
udp_csum
;

989 
îr‹
;

991 
	`oÂbuf_öô
(&
b
, 
ETH_TOTAL_MAX
);

992 
	`oÂbuf_ª£rve
(&
b
, 
ETH_HEADER_LEN
 + 
IP_HEADER_LEN
 + 
UDP_HEADER_LEN
);

994 
	`dh˝_as£mbÀ
(
msg
, &
b
);

996 
	`mem˝y
(
eh
.
ëh_§c
, 
	`√tdev_gë_ëhîaddr
(
˛i
->
√tdev
), 
ETH_ADDR_LEN
);

997 
	`mem˝y
(
eh
.
ëh_d°
, 
ëh_addr_brﬂdˇ°
, 
ETH_ADDR_LEN
);

998 
eh
.
ëh_ty≥
 = 
	`ht⁄s
(
ETH_TYPE_IP
);

1000 
nh
.
ù_ihl_vî
 = 
	`IP_IHL_VER
(5, 
IP_VERSION
);

1001 
nh
.
ù_tos
 = 0;

1002 
nh
.
ù_tŸ_Àn
 = 
	`ht⁄s
(
IP_HEADER_LEN
 + 
UDP_HEADER_LEN
 + 
b
.
size
);

1007 
nh
.
ù_id
 = 0;

1008 
nh
.
ù_‰ag_off
 = 
	`ht⁄s
(
IP_DONT_FRAGMENT
);

1009 
nh
.
ù_âl
 = 64;

1010 
nh
.
ù_¥Ÿo
 = 
IP_TYPE_UDP
;

1011 
nh
.
ù_csum
 = 0;

1012 
nh
.
ù_§c
 = 
	`dh˛õ¡_gë_ù
(
˛i
);

1022 
nh
.
ù_d°
 = 
INADDR_BROADCAST
;

1023 
nh
.
ù_csum
 = 
	`csum
(&nh, Çh);

1025 
th
.
udp_§c
 = 
	`ht⁄s
(66);

1026 
th
.
udp_d°
 = 
	`ht⁄s
(67);

1027 
th
.
udp_Àn
 = 
	`ht⁄s
(
UDP_HEADER_LEN
 + 
b
.
size
);

1028 
th
.
udp_csum
 = 0;

1029 
udp_csum
 = 
	`csum_add32
(0, 
nh
.
ù_§c
);

1030 
udp_csum
 = 
	`csum_add32
(udp_csum, 
nh
.
ù_d°
);

1031 
udp_csum
 = 
	`csum_add16
(udp_csum, 
IP_TYPE_UDP
 << 8);

1032 
udp_csum
 = 
	`csum_add16
(udp_csum, 
th
.
udp_Àn
);

1033 
udp_csum
 = 
	`csum_c⁄töue
(udp_csum, &
th
, Åh);

1034 
th
.
udp_csum
 = 
	`csum_föish
(
	`csum_c⁄töue
(udp_csum, 
b
.
d©a
, b.
size
));

1036 
	`oÂbuf_push
(&
b
, &
th
, Åh);

1037 
	`oÂbuf_push
(&
b
, &
nh
, Çh);

1038 
	`oÂbuf_push
(&
b
, &
eh
, Éh);

1044 i‡(
b
.
size
 <
ETH_TOTAL_MAX
) {

1045 i‡(
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

1046 
	`VLOG_DBG
(
LOG_MODULE
, "£ndög %s", 
	`dh˝_msg_to_°rög
(
msg
, 
Ál£
, &
˛i
->
s
));

1048 
	`VLOG_INFO
(
LOG_MODULE
, "£ndög %s", 
	`dh˝_ty≥_«me
(
msg
->
ty≥
));

1050 
îr‹
 = 
	`√tdev_£nd
(
˛i
->
√tdev
, &
b
, 0);

1051 i‡(
îr‹
) {

1052 
	`VLOG_ERR
(
LOG_MODULE
, "send failed on %s: %s",

1053 
	`√tdev_gë_«me
(
˛i
->
√tdev
), 
	`°ªº‹
(
îr‹
));

1056 
	`VLOG_ERR
(
LOG_MODULE
, "ˇ¬Ÿ síd %zu-byã Ethî√à‰ame", 
b
.
size
);

1059 
	`oÂbuf_unöô
(&
b
);

1060 
	}
}

1063 
	$fuzz
(
x
, 
max_fuzz
)

1066 
fuzz
 = 
	`øndom_ønge
(
max_fuzz
 * 2 + 1) - max_fuzz;

1067 
y
 = 
x
 + 
fuzz
;

1068  
fuzz
 >0 ? (
y
 >
x
 ? y : 
UINT_MAX
) : (y <= x ? y : 0);

1069 
	}
}

1072 
	$˛amp
(
x
, 
mö
, 
max
)

1074  
x
 < 
mö
 ? mö : x > 
max
 ? max : x;

1075 
	}
}

1078 
	$ˇlc_t2
(
Àa£
)

1080 
ba£
 = 
Àa£
 * 0.875;

1081  
Àa£
 >60 ? 
	`˛amp
(
	`fuzz
(
ba£
, 10), 0,Üease - 1) : base;

1082 
	}
}

1085 
	$ˇlc_t1
(
Àa£
, 
t2
)

1087 
ba£
 = 
Àa£
 / 2;

1088  
Àa£
 >60 ? 
	`˛amp
(
	`fuzz
(
ba£
, 10), 0, 
t2
 - 1) : base;

1089 
	}
}

	@lib/dhcp-client.h

34 #i‚de‡
DHCP_CLIENT_H


35 
	#DHCP_CLIENT_H
 1

	)

37 
	~<°dboﬁ.h
>

38 
	~<°döt.h
>

40 
	gdh˛õ¡
;

41 
	gdh˝_msg
;

42 
	g√tdev
;

43 
dh˛õ¡_¸óã
(c⁄° *
√tdev
,

44 (*
modify_ªque°
)(
dh˝_msg
 *, *
aux
),

45 
	$boﬁ
 (*
vÆid©e_of„r
)(c⁄° 
dh˝_msg
 *, *
aux
),

46 *
aux
, 
dh˛õ¡
 **);

47 
	`dh˛õ¡_£t_max_timeout
(
dh˛õ¡
 *, 
max_timeout
);

48 
	`dh˛õ¡_de°roy
(
dh˛õ¡
 *);

50 
√tdev
 *
	`dh˛õ¡_gë_√tdev
(
dh˛õ¡
 *);

52 
	`dh˛õ¡_öô
(
dh˛õ¡
 *, 
uöt32_t
 
ªque°ed_ù
);

53 
	`dh˛õ¡_ªÀa£
(
dh˛õ¡
 *);

54 
	`dh˛õ¡_f‹˚_ª√w
(
dh˛õ¡
 *, 
dódlöe
);

55 
boﬁ
 
	`dh˛õ¡_is_bound
(c⁄° 
dh˛õ¡
 *);

56 
boﬁ
 
	`dh˛õ¡_ch™ged
(
dh˛õ¡
 *);

58 c⁄° *
	`dh˛õ¡_gë_°©e
(c⁄° 
dh˛õ¡
 *);

59 
	`dh˛õ¡_gë_°©e_ñ≠£d
(c⁄° 
dh˛õ¡
 *);

60 
	`dh˛õ¡_gë_Àa£_ªmaöög
(c⁄° 
dh˛õ¡
 *);

62 
uöt32_t
 
	`dh˛õ¡_gë_ù
(c⁄° 
dh˛õ¡
 *);

63 
uöt32_t
 
	`dh˛õ¡_gë_√tmask
(c⁄° 
dh˛õ¡
 *);

64 
uöt32_t
 
	`dh˛õ¡_gë_rouãr
(c⁄° 
dh˛õ¡
 *);

65 c⁄° 
dh˝_msg
 *
	`dh˛õ¡_gë_c⁄fig
(c⁄° 
dh˛õ¡
 *);

67 
	`dh˛õ¡_c⁄figuª_√tdev
(
dh˛õ¡
 *);

68 
	`dh˛õ¡_upd©e_ªsﬁv_c⁄f
(
dh˛õ¡
 *);

70 
	`dh˛õ¡_run
(
dh˛õ¡
 *);

71 
	`dh˛õ¡_waô
(
dh˛õ¡
 *);

	@lib/dhcp.c

34 
	~<c⁄fig.h
>

35 
	~"dh˝.h
"

36 
	~<¨∑/öë.h
>

37 
	~<as£π.h
>

38 
	~<˘y≥.h
>

39 
	~<î∫o.h
>

40 
	~<öây≥s.h
>

41 
	~<°dlib.h
>

42 
	~"dy«mic-°rög.h
"

43 
	~"oÂbuf.h
"

45 
	#LOG_MODULE
 
VLM_dh˝


	)

46 
	~"vlog.h
"

49 
	s¨g_ty≥
 {

50 c⁄° *
	m«me
;

51 
size_t
 
	msize
;

54 
¨g_ty≥
 
	gty≥s
[] = {

55 
	#DHCP_ARG
(
NAME
, 
SIZE
Ë[
DHCP_ARG_
##NAME] = {#NAME, SIZE},

	)

56 
DHCP_ARGS


57 #unde‡
DHCP_ARG


61 
	s›ti⁄_˛ass
 {

62 c⁄° *
	m«me
;

63 
dh˝_¨g_ty≥
 
	mty≥
;

64 
size_t
 
	mmö_¨gs
;

65 
size_t
 
	mmax_¨gs
;

68 c⁄° 
›ti⁄_˛ass
 *

69 
	$gë_›ti⁄_˛ass
(
code
)

71 
›ti⁄_˛ass
 
˛as£s
[
DHCP_N_OPTIONS
];

72 
boﬁ
 
öô
 = 
Ál£
;

73 i‡(!
öô
) {

74 
i
;

76 
öô
 = 
åue
;

77 
	#DHCP_OPT
(
NAME
, 
CODE
, 
TYPE
, 
MIN
, 
MAX
) \

78 
˛as£s
[
CODE
].
«me
 = #NAME; \

79 
˛as£s
[
CODE
].
ty≥
 = 
DHCP_ARG_
##
TYPE
; \

80 
˛as£s
[
CODE
].
mö_¨gs
 = 
MIN
; \

81 
˛as£s
[
CODE
].
max_¨gs
 = 
MAX
;

	)

82 
DHCP_OPTS


83 #unde‡
DHCP_OPT


85 
i
 = 0; i < 
DHCP_N_OPTIONS
; i++) {

86 i‡(!
˛as£s
[
i
].
«me
) {

87 
˛as£s
[
i
].
«me
 = 
	`xa•rötf
("option-%d", i);

88 
˛as£s
[
i
].
ty≥
 = 
DHCP_ARG_UINT8
;

89 
˛as£s
[
i
].
mö_¨gs
 = 0;

90 
˛as£s
[
i
].
max_¨gs
 = 
SIZE_MAX
;

94 
	`as£π
(
code
 >0 && codê< 
DHCP_N_OPTIONS
);

95  &
˛as£s
[
code
];

96 
	}
}

101 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(60, 600);

103 
c›y_d©a
(
dh˝_msg
 *);

106 
	$dh˝_ty≥_«me
(
dh˝_msg_ty≥
 
ty≥
)

108 
ty≥
) {

109 
	#DHCP_MSG
(
NAME
, 
VALUE
ËNAME:  #NAME;

	)

110 
DHCP_MSGS


111 #unde‡
DHCP_MSG


114 
	}
}

119 
	$dh˝_msg_öô
(
dh˝_msg
 *
msg
)

121 
	`mem£t
(
msg
, 0,  *msg);

122 
	}
}

127 
	$dh˝_msg_unöô
(
dh˝_msg
 *
msg
)

129 i‡(
msg
) {

130 
	`‰ì
(
msg
->
d©a
);

132 
	}
}

137 
	$dh˝_msg_c›y
(
dh˝_msg
 *
d°
, c⁄° dh˝_msg *
§c
)

139 *
d°
 = *
§c
;

140 
d°
->
d©a_Æloˇãd
 = 
§c
->
d©a_u£d
;

141 
d°
->
d©a_u£d
 = 0;

142 
d°
->
d©a
 = 
	`xmÆloc
(d°->
d©a_Æloˇãd
);

143 
	`c›y_d©a
(
d°
);

144 
	}
}

147 
	$¥óŒoc_d©a
(
dh˝_msg
 *
msg
, 
size_t
 
n
)

149 
size_t
 
√eded
 = 
msg
->
d©a_u£d
 + 
n
;

150 i‡(
√eded
 > 
msg
->
d©a_Æloˇãd
) {

151 
uöt8_t
 *
ﬁd_d©a
 = 
msg
->
d©a
;

152 
msg
->
d©a_Æloˇãd
 = 
	`MAX
(
√eded
 * 2, 64);

153 
msg
->
d©a
 = 
	`xmÆloc
(msg->
d©a_Æloˇãd
);

154 i‡(
ﬁd_d©a
) {

155 
	`c›y_d©a
(
msg
);

156 
	`‰ì
(
ﬁd_d©a
);

159 
	}
}

162 
	$≠≥nd_d©a
(
dh˝_msg
 *
msg
, c⁄° *
d©a
, 
size_t
 
n
)

164 
uöt8_t
 *
p
 = &
msg
->
d©a
[msg->
d©a_u£d
];

165 
	`mem˝y
(
p
, 
d©a
, 
n
);

166 
msg
->
d©a_u£d
 +
n
;

167  
p
;

168 
	}
}

171 
	$c›y_d©a
(
dh˝_msg
 *
msg
)

173 
code
;

175 
msg
->
d©a_u£d
 = 0;

176 
code
 = 0; codê< 
DHCP_N_OPTIONS
; code++) {

177 
dh˝_›ti⁄
 *
›t
 = &
msg
->
›ti⁄s
[
code
];

178 i‡(
›t
->
d©a
) {

179 
	`as£π
(
msg
->
d©a_u£d
 + 
›t
->
n
 <msg->
d©a_Æloˇãd
);

180 
›t
->
d©a
 = 
	`≠≥nd_d©a
(
msg
, o±->d©a, o±->
n
);

183 
	}
}

188 
	$dh˝_msg_put
(
dh˝_msg
 *
msg
, 
code
,

189 c⁄° *
d©a
, 
size_t
 
n
)

191 
dh˝_›ti⁄
 *
›t
;

192 i‡(
code
 =
DHCP_CODE_PAD
 || codê=
DHCP_CODE_END
) {

196 
›t
 = &
msg
->
›ti⁄s
[
code
];

197 
	`¥óŒoc_d©a
(
msg
, 
n
 + 
›t
->n);

198 i‡(
›t
->
n
) {

199 i‡(&
msg
->
d©a
[msg->
d©a_u£d
 - 
›t
->
n
] != opt->data) {

200 
›t
->
d©a
 = 
	`≠≥nd_d©a
(
msg
, o±->d©a, o±->
n
);

202 
	`≠≥nd_d©a
(
msg
, 
d©a
, 
n
);

204 
›t
->
d©a
 = 
	`≠≥nd_d©a
(
msg
, d©a, 
n
);

206 
›t
->
n
 +=Ç;

207 
	}
}

213 
	$dh˝_msg_put_boﬁ
(
dh˝_msg
 *
msg
, 
code
, 
boﬁ
 
b_
)

215 
b
 = !!
b_
;

216 
	`dh˝_msg_put
(
msg
, 
code
, &
b
, 1);

217 
	}
}

223 
	$dh˝_msg_put_£cs
(
dh˝_msg
 *
msg
, 
code
, 
uöt32_t
 
£cs_
)

225 
uöt32_t
 
£cs
 = 
	`ht⁄l
(
£cs_
);

226 
	`dh˝_msg_put
(
msg
, 
code
, &
£cs
,  secs);

227 
	}
}

233 
	$dh˝_msg_put_ù
(
dh˝_msg
 *
msg
, 
code
, 
uöt32_t
 
ù
)

235 
	`dh˝_msg_put
(
msg
, 
code
, &
ù
,  ip);

236 
	}
}

241 
	$dh˝_msg_put_°rög
(
dh˝_msg
 *
msg
, 
code
, c⁄° *
°rög
)

243 
	`dh˝_msg_put
(
msg
, 
code
, 
°rög
, 
	`°æí
(string));

244 
	}
}

249 
	$dh˝_msg_put_uöt8
(
dh˝_msg
 *
msg
, 
code
, 
uöt8_t
 
x
)

251 
	`dh˝_msg_put
(
msg
, 
code
, &
x
,  x);

252 
	}
}

256 
	$dh˝_msg_put_uöt8_¨øy
(
dh˝_msg
 *
msg
, 
code
,

257 c⁄° 
uöt8_t
 
d©a
[], 
size_t
 
n
)

259 
	`dh˝_msg_put
(
msg
, 
code
, 
d©a
, 
n
);

260 
	}
}

266 
	$dh˝_msg_put_uöt16
(
dh˝_msg
 *
msg
, 
code
, 
uöt16_t
 
x_
)

268 
uöt16_t
 
x
 = 
	`ht⁄s
(
x_
);

269 
	`dh˝_msg_put
(
msg
, 
code
, &
x
,  x);

270 
	}
}

277 
	$dh˝_msg_put_uöt16_¨øy
(
dh˝_msg
 *
msg
, 
code
,

278 c⁄° 
uöt16_t
 
d©a
[], 
size_t
 
n
)

280 
size_t
 
i
;

282 
i
 = 0; i < 
n
; i++) {

283 
	`dh˝_msg_put_uöt16
(
msg
, 
code
, 
d©a
[
i
]);

285 
	}
}

292 
	$dh˝_msg_gë
(c⁄° 
dh˝_msg
 *
msg
, 
code
,

293 
size_t
 
off£t
, size_à
size
)

295 c⁄° 
dh˝_›ti⁄
 *
›t
 = &
msg
->
›ti⁄s
[
code
];

296  
off£t
 + 
size
 <
›t
->
n
 ? (c⁄° *Ë›t->
d©a
 + off£à: 
NULL
;

297 
	}
}

303 
boﬁ


304 
	$dh˝_msg_gë_boﬁ
(c⁄° 
dh˝_msg
 *
msg
, 
code
, 
size_t
 
off£t
,

305 
boﬁ
 *
out
)

307 c⁄° 
uöt8_t
 *
uöt8
 = 
	`dh˝_msg_gë
(
msg
, 
code
, 
off£t
,  *uint8);

308 i‡(
uöt8
) {

309 *
out
 = *
uöt8
 != 0;

310  
åue
;

312  
Ál£
;

314 
	}
}

321 
boﬁ


322 
	$dh˝_msg_gë_£cs
(c⁄° 
dh˝_msg
 *
msg
, 
code
, 
size_t
 
off£t
,

323 
uöt32_t
 *
out
)

325 c⁄° 
uöt32_t
 *
uöt32
 = 
	`dh˝_msg_gë
(
msg
, 
code
, 
off£t
 *  *uint32,

326  *
uöt32
);

327 i‡(
uöt32
) {

328 *
out
 = 
	`¡ohl
(*
uöt32
);

329  
åue
;

331  
Ál£
;

333 
	}
}

340 
boﬁ


341 
	$dh˝_msg_gë_ù
(c⁄° 
dh˝_msg
 *
msg
, 
code
,

342 
size_t
 
off£t
, 
uöt32_t
 *
out
)

344 c⁄° 
uöt32_t
 *
uöt32
 = 
	`dh˝_msg_gë
(
msg
, 
code
, 
off£t
 *  *uint32,

345  *
uöt32
);

346 i‡(
uöt32
) {

347 *
out
 = *
uöt32
;

348  
åue
;

350  
Ál£
;

352 
	}
}

362 
	$dh˝_msg_gë_°rög
(c⁄° 
dh˝_msg
 *
msg
, 
code
)

364 c⁄° 
dh˝_›ti⁄
 *
›t
 = &
msg
->
›ti⁄s
[
code
];

365  
›t
->
d©a
 ? 
	`xmemdup0
(›t->d©a, o±->
n
Ë: 
NULL
;

366 
	}
}

372 
boﬁ


373 
	$dh˝_msg_gë_uöt8
(c⁄° 
dh˝_msg
 *
msg
, 
code
,

374 
size_t
 
off£t
, 
uöt8_t
 *
out
)

376 c⁄° 
uöt8_t
 *
uöt8
 = 
	`dh˝_msg_gë
(
msg
, 
code
, 
off£t
,  *uint8);

377 i‡(
uöt8
) {

378 *
out
 = *
uöt8
;

379  
åue
;

381  
Ál£
;

383 
	}
}

390 
boﬁ


391 
	$dh˝_msg_gë_uöt16
(c⁄° 
dh˝_msg
 *
msg
, 
code
,

392 
size_t
 
off£t
, 
uöt16_t
 *
out
)

394 c⁄° 
uöt16_t
 *
uöt16
 = 
	`dh˝_msg_gë
(
msg
, 
code
, 
off£t
 *  *uint16,

395  *
uöt16
);

396 i‡(
uöt16
) {

397 *
out
 = 
	`¡ohs
(*
uöt16
);

398  
åue
;

400  
Ál£
;

402 
	}
}

406 
	$put_duøti⁄
(
ds
 *ds, 
duøti⁄
)

408 i‡(
duøti⁄
) {

409 i‡(
duøti⁄
 >= 86400) {

410 
	`ds_put_f‹m©
(
ds
, "%ud", 
duøti⁄
 / 86400);

411 
duøti⁄
 %= 86400;

413 i‡(
duøti⁄
 >= 3600) {

414 
	`ds_put_f‹m©
(
ds
, "%uh", 
duøti⁄
 / 3600);

415 
duøti⁄
 %= 3600;

417 i‡(
duøti⁄
 >= 60) {

418 
	`ds_put_f‹m©
(
ds
, "%umö", 
duøti⁄
 / 60);

419 
duøti⁄
 %= 60;

421 i‡(
duøti⁄
 > 0) {

422 
	`ds_put_f‹m©
(
ds
, "%us", 
duøti⁄
);

425 
	`ds_put_c°r
(
ds
, "0s");

427 
	}
}

432 
	$dh˝_›ti⁄_to_°rög
(c⁄° 
dh˝_›ti⁄
 *
›t
, 
code
, 
ds
 *ds)

434 c⁄° 
›ti⁄_˛ass
 *
˛ass
 = 
	`gë_›ti⁄_˛ass
(
code
);

435 c⁄° 
¨g_ty≥
 *
ty≥
 = &
ty≥s
[
˛ass
->type];

436 
size_t
 
off£t
;

437 c⁄° *
˝
;

439 
˝
 = 
˛ass
->
«me
; *cp; cp++) {

440 
c
 = *
˝
;

441 
	`ds_put_ch¨
(
ds
, 
c
 ='_' ? '-' : 
	`tﬁowî
(c));

443 
	`ds_put_ch¨
(
ds
, '=');

445 i‡(!
›t
->
d©a
 || !›t->
n
) {

446 
	`ds_put_c°r
(
ds
, 
›t
->
d©a
 ? "empty" : "null");

447  
	`ds_c°r
(
ds
);

450 i‡(
˛ass
->
ty≥
 =
DHCP_ARG_STRING
) {

451 
	`ds_put_ch¨
(
ds
, '"');

452 
	`ds_put_¥öèbÀ
(
ds
, 
›t
->
d©a
, o±->
n
);

453 
	`ds_put_ch¨
(
ds
, '"');

454  
	`ds_c°r
(
ds
);

456 
off£t
 = 0; off£à+ 
ty≥
->
size
 <
›t
->
n
; offset +=Åype->size) {

457 c⁄° *
p
 = (c⁄° *Ë
›t
->
d©a
 + 
off£t
;

458 c⁄° 
uöt8_t
 *
uöt8
 = 
p
;

459 c⁄° 
uöt32_t
 *
uöt32
 = 
p
;

460 c⁄° 
uöt16_t
 *
uöt16
 = 
p
;

462 i‡(
off£t
 && 
˛ass
->
ty≥
 !
DHCP_ARG_STRING
) {

463 
	`ds_put_c°r
(
ds
, 
˛ass
->
ty≥
 =
DHCP_ARG_UINT8
 ? ":" : ", ");

465 
˛ass
->
ty≥
) {

466 
DHCP_ARG_FIXED
:

467 
	`NOT_REACHED
();

468 
DHCP_ARG_IP
:

469 
	`ds_put_f‹m©
(
ds
, 
IP_FMT
, 
	`IP_ARGS
(
uöt32
));

471 
DHCP_ARG_UINT8
:

472 
	`ds_put_f‹m©
(
ds
, "%02"
PRIx8
, *
uöt8
);

474 
DHCP_ARG_UINT16
:

475 
	`ds_put_f‹m©
(
ds
, "%"
PRIu16
, 
	`¡ohs
(*
uöt16
));

477 
DHCP_ARG_UINT32
:

478 
	`ds_put_f‹m©
(
ds
, "%"
PRIu32
, 
	`¡ohl
(*
uöt32
));

480 
DHCP_ARG_SECS
:

481 
	`put_duøti⁄
(
ds
, 
	`¡ohl
(*
uöt32
));

483 
DHCP_ARG_STRING
:

484 
	`NOT_REACHED
();

485 
DHCP_ARG_BOOLEAN
:

486 i‡(*
uöt8
 == 0) {

487 
	`ds_put_c°r
(
ds
, "false");

488 } i‡(*
uöt8
 == 1) {

489 
	`ds_put_c°r
(
ds
, "true");

491 
	`ds_put_f‹m©
(
ds
, "**%"
PRIu8
"**", *
uöt8
);

496 i‡(
off£t
 !
›t
->
n
) {

497 i‡(
off£t
) {

498 
	`ds_put_c°r
(
ds
, ", ");

500 
	`ds_put_c°r
(
ds
, "**leftovers:");

501 ; 
off£t
 < 
›t
->
n
; offset++) {

502 c⁄° *
p
 = (c⁄° *Ë
›t
->
d©a
 + 
off£t
;

503 c⁄° 
uöt8_t
 *
uöt8
 = 
p
;

504 
	`ds_put_f‹m©
(
ds
, " %"
PRIu8
, *
uöt8
);

506 
	`ds_put_c°r
(
ds
, "**");

508  
	`ds_c°r
(
ds
);

509 
	}
}

512 
boﬁ


513 
	$dh˝_›ti⁄_equÆs
(c⁄° 
dh˝_›ti⁄
 *
a
, c⁄° dh˝_›ti⁄ *
b
)

515  ((
a
->
d©a
 !
NULL
Ë=(
b
->data != NULL)

516 && 
a
->
n
 =
b
->n

517 && !
	`memcmp
(
a
->
d©a
, 
b
->d©a,á->
n
));

518 
	}
}

524 
	$dh˝_msg_to_°rög
(c⁄° 
dh˝_msg
 *
msg
, 
boﬁ
 
mu…ûöe
, 
ds
 *ds)

526 
£∑øt‹
 = 
mu…ûöe
 ? '\n' : ' ';

527 
code
;

529 
	`ds_˛ór
(
ds
);

530 
	`ds_put_f‹m©
(
ds
, "op=%s",

531 (
msg
->
›
 =
DHCP_BOOTREQUEST
 ? "request"

532 : 
msg
->
›
 =
DHCP_BOOTREPLY
 ? "reply"

534 
	`ds_put_f‹m©
(
ds
, "%˘y≥=%s", 
£∑øt‹
, 
	`dh˝_ty≥_«me
(
msg
->
ty≥
));

535 
	`ds_put_f‹m©
(
ds
, "%cxid=0x%08"
PRIx32
, 
£∑øt‹
, 
msg
->
xid
);

536 
	`ds_put_f‹m©
(
ds
, "%c£cs=", 
£∑øt‹
);

537 
	`put_duøti⁄
(
ds
, 
msg
->
£cs
);

538 i‡(
msg
->
Êags
) {

539 
	`ds_put_f‹m©
(
ds
, "%cÊags=", 
£∑øt‹
);

540 i‡(
msg
->
Êags
 & 
DHCP_FLAGS_BROADCAST
) {

541 
	`ds_put_c°r
(
ds
, "[BROADCAST]");

543 i‡(
msg
->
Êags
 & 
DHCP_FLAGS_MBZ
) {

544 
	`ds_put_f‹m©
(
ds
, "[0x%04"
PRIx16
"]", 
msg
->
Êags
 & 
DHCP_FLAGS_MBZ
);

547 i‡(
msg
->
cüddr
) {

548 
	`ds_put_f‹m©
(
ds
, "%ccüddr="
IP_FMT
, 
£∑øt‹
, 
	`IP_ARGS
(&
msg
->
cüddr
));

550 i‡(
msg
->
yüddr
) {

551 
	`ds_put_f‹m©
(
ds
, "%cyüddr="
IP_FMT
, 
£∑øt‹
, 
	`IP_ARGS
(&
msg
->
yüddr
));

553 i‡(
msg
->
süddr
) {

554 
	`ds_put_f‹m©
(
ds
, "%csüddr="
IP_FMT
, 
£∑øt‹
, 
	`IP_ARGS
(&
msg
->
süddr
));

556 i‡(
msg
->
güddr
) {

557 
	`ds_put_f‹m©
(
ds
, "%cgüddr="
IP_FMT
, 
£∑øt‹
, 
	`IP_ARGS
(&
msg
->
güddr
));

559 
	`ds_put_f‹m©
(
ds
, "%cchaddr="
ETH_ADDR_FMT
,

560 
£∑øt‹
, 
	`ETH_ADDR_ARGS
(
msg
->
chaddr
));

562 
code
 = 0; codê< 
DHCP_N_OPTIONS
; code++) {

563 c⁄° 
dh˝_›ti⁄
 *
›t
 = &
msg
->
›ti⁄s
[
code
];

564 i‡(
›t
->
d©a
) {

565 
	`ds_put_ch¨
(
ds
, 
£∑øt‹
);

566 
	`dh˝_›ti⁄_to_°rög
(
›t
, 
code
, 
ds
);

569 i‡(
mu…ûöe
) {

570 
	`ds_put_ch¨
(
ds
, 
£∑øt‹
);

572  
	`ds_c°r
(
ds
);

573 
	}
}

576 
	$∑r£_›ti⁄s
(
dh˝_msg
 *
msg
, c⁄° *
«me
, *
d©a
, 
size_t
 
size
,

577 
›ti⁄_off£t
)

579 
oÂbuf
 
b
;

581 
b
.
d©a
 = data;

582 
b
.
size
 = size;

584 
uöt8_t
 *
code
, *
Àn
;

585 *
∑ylﬂd
;

587 
code
 = 
	`oÂbuf_åy_puŒ
(&
b
, 1);

588 i‡(!
code
 || *codê=
DHCP_CODE_END
) {

590 } i‡(*
code
 =
DHCP_CODE_PAD
) {

594 
Àn
 = 
	`oÂbuf_åy_puŒ
(&
b
, 1);

595 i‡(!
Àn
) {

596 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "ªachedÉnd o‡%†ex≥˘ögÜígth byã", 
«me
);

600 
∑ylﬂd
 = 
	`oÂbuf_åy_puŒ
(&
b
, *
Àn
);

601 i‡(!
∑ylﬂd
) {

602 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "ex≥˘ed %"
PRIu8
" bytes of option-%"PRIu8" "

604 *
Àn
, *
code
, 
b
.
size
, 
«me
);

607 
	`dh˝_msg_put
(
msg
, *
code
 + 
›ti⁄_off£t
, 
∑ylﬂd
, *
Àn
);

609 
	}
}

612 
	$vÆid©e_›ti⁄s
(
dh˝_msg
 *
msg
)

614 
code
;

616 
code
 = 0; codê< 
DHCP_N_OPTIONS
; code++) {

617 
dh˝_›ti⁄
 *
›t
 = &
msg
->
›ti⁄s
[
code
];

618 c⁄° 
›ti⁄_˛ass
 *
˛ass
 = 
	`gë_›ti⁄_˛ass
(
code
);

619 
¨g_ty≥
 *
ty≥
 = &
ty≥s
[
˛ass
->type];

620 i‡(
›t
->
d©a
) {

621 
size_t
 
n_ñems
 = 
›t
->
n
 / 
ty≥
->
size
;

622 
size_t
 
ªmaödî
 = 
›t
->
n
 % 
ty≥
->
size
;

623 
boﬁ
 
ok
 = 
åue
;

624 i‡(
ªmaödî
) {

625 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "%s option has %zu %zu-byte %sárguments "

627 
˛ass
->
«me
, 
n_ñems
, 
ty≥
->
size
,

628 
ty≥
->
«me
, 
ªmaödî
);

629 
ok
 = 
Ál£
;

631 i‡(
n_ñems
 < 
˛ass
->
mö_¨gs
 ||Ç_ñem†> cœss->
max_¨gs
) {

632 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "%s option has %zu %zu-byte %sárguments but "

634 
˛ass
->
«me
, 
n_ñems
, 
ty≥
->
size
,Åype->name,

635 
˛ass
->
mö_¨gs
, cœss->
max_¨gs
);

636 
ok
 = 
Ál£
;

638 i‡(!
ok
) {

639 
ds
 d†
DS_EMPTY_INITIALIZER
;

640 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "%†›ti⁄ c⁄èös: %s", 
˛ass
->
«me
,

641 
	`dh˝_›ti⁄_to_°rög
(
›t
, 
code
, &
ds
));

642 
	`ds_de°roy
(&
ds
);

644 
›t
->
n
 = 0;

645 
›t
->
d©a
 = 
NULL
;

649 
	}
}

655 
	$dh˝_∑r£
(
dh˝_msg
 *
msg
, c⁄° 
oÂbuf
 *
b_
)

657 
oÂbuf
 
b
 = *
b_
;

658 
dh˝_hódî
 *
dh˝
;

659 
uöt32_t
 *
cookõ
;

660 
uöt8_t
 
ty≥
;

661 *
víd‹_˛ass
;

663 
dh˝
 = 
	`oÂbuf_åy_puŒ
(&
b
,  *dhcp);

664 i‡(!
dh˝
) {

665 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "bufferÅoo small for DHCP header (%zu bytes)",

666 
b
.
size
);

667 
îr‹
;

670 i‡(
dh˝
->
›
 !
DHCP_BOOTREPLY
 && dh˝->› !
DHCP_BOOTREQUEST
) {

671 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "övÆid DHCP o∞(%"
PRIu8
")", 
dh˝
->
›
);

672 
îr‹
;

674 i‡(
dh˝
->
hty≥
 !
ARP_HRD_ETHERNET
) {

675 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "övÆid DHCP hty≥ (%"
PRIu8
")", 
dh˝
->
hty≥
);

676 
îr‹
;

678 i‡(
dh˝
->
hÀn
 !
ETH_ADDR_LEN
) {

679 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "övÆid DHCP hÀ¿(%"
PRIu8
")", 
dh˝
->
hÀn
);

680 
îr‹
;

683 
	`dh˝_msg_öô
(
msg
);

684 
msg
->
›
 = 
dh˝
->op;

685 
msg
->
xid
 = 
	`¡ohl
(
dh˝
->xid);

686 
msg
->
£cs
 = 
	`¡ohs
(
dh˝
->secs);

687 
msg
->
Êags
 = 
	`¡ohs
(
dh˝
->flags);

688 
msg
->
cüddr
 = 
dh˝
->ciaddr;

689 
msg
->
yüddr
 = 
dh˝
->yiaddr;

690 
msg
->
süddr
 = 
dh˝
->siaddr;

691 
msg
->
güddr
 = 
dh˝
->giaddr;

692 
	`mem˝y
(
msg
->
chaddr
, 
dh˝
->chaddr, 
ETH_ADDR_LEN
);

694 
cookõ
 = 
	`oÂbuf_åy_puŒ
(&
b
,  cookie);

695 i‡(
cookõ
) {

696 i‡(
	`¡ohl
(*
cookõ
Ë=
DHCP_OPTS_COOKIE
) {

697 
uöt8_t
 
ovîlﬂd
;

699 
	`∑r£_›ti⁄s
(
msg
, "›ti⁄s", 
b
.
d©a
, b.
size
, 0);

700 i‡(
	`dh˝_msg_gë_uöt8
(
msg
, 
DHCP_CODE_OPTION_OVERLOAD
,

701 0, &
ovîlﬂd
)) {

702 i‡(
ovîlﬂd
 & 1) {

703 
	`∑r£_›ti⁄s
(
msg
, "fûe", 
dh˝
->
fûe
,  dhcp->file,

706 i‡(
ovîlﬂd
 & 2) {

707 
	`∑r£_›ti⁄s
(
msg
, "sname",

708 
dh˝
->
¢ame
,  dhcp->sname, 0);

712 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "bad DHCP o±i⁄†cookõ: %08"
PRIx32
,

713 
	`¡ohl
(*
cookõ
));

716 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "DHCPÖacket hasÇo options");

719 
víd‹_˛ass
 = 
	`dh˝_msg_gë_°rög
(
msg
, 
DHCP_CODE_VENDOR_CLASS
);

720 i‡(
víd‹_˛ass
 && !
	`°rcmp
(vendor_class, "OpenFlow")) {

721 
	`∑r£_›ti⁄s
(
msg
, "vendor-specific",

722 
msg
->
›ti⁄s
[
DHCP_CODE_VENDOR_SPECIFIC
].
d©a
,

723 
msg
->
›ti⁄s
[
DHCP_CODE_VENDOR_SPECIFIC
].
n
,

724 
DHCP_VENDOR_OFS
);

726 
	`‰ì
(
víd‹_˛ass
);

728 
	`vÆid©e_›ti⁄s
(
msg
);

729 i‡(!
	`dh˝_msg_gë_uöt8
(
msg
, 
DHCP_CODE_DHCP_MSG_TYPE
, 0, &
ty≥
)) {

730 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "missing DHCP messageÅype");

731 
	`dh˝_msg_unöô
(
msg
);

732 
îr‹
;

734 
msg
->
ty≥
 =Åype;

737 
îr‹
:

738 i‡(
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

739 
ds
 ds;

741 
	`ds_öô
(&
ds
);

742 
	`ds_put_hex_dump
(&
ds
, 
b_
->
d©a
, b_->
size
, 0, 
åue
);

743 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "övÆid DHCP mesßgêdump:\n%s", 
	`ds_c°r
(&
ds
));

745 
	`ds_˛ór
(&
ds
);

746 
	`dh˝_msg_to_°rög
(
msg
, 
Ál£
, &
ds
);

747 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "∑πüŒy dis£˘ed DHCP mesßge: %s", 
	`ds_c°r
(&
ds
));

749 
	`ds_de°roy
(&
ds
);

751  
EPROTO
;

752 
	}
}

755 
	$put_›ti⁄_chunk
(
oÂbuf
 *
b
, 
uöt8_t
 
code
, *
d©a
, 
size_t
 
n
)

757 
uöt8_t
 
hódî
[2];

759 
	`as£π
(
n
 < 256);

760 
hódî
[0] = 
code
;

761 
hódî
[1] = 
n
;

762 
	`oÂbuf_put
(
b
, 
hódî
,  header);

763 
	`oÂbuf_put
(
b
, 
d©a
, 
n
);

764 
	}
}

767 
	$put_›ti⁄
(
oÂbuf
 *
b
, 
uöt8_t
 
code
, *
d©a
, 
size_t
 
n
)

769 i‡(
d©a
) {

770 i‡(
n
) {

775 
uöt8_t
 *
p
 = 
d©a
;

776 
n
) {

777 
size_t
 
chunk
 = 
n
 > 255 ? 248 :Ç;

778 
	`put_›ti⁄_chunk
(
b
, 
code
, 
p
, 
chunk
);

779 
p
 +
chunk
;

780 
n
 -
chunk
;

784 
	`put_›ti⁄_chunk
(
b
, 
code
, 
NULL
, 0);

787 
	}
}

791 
	$dh˝_as£mbÀ
(c⁄° 
dh˝_msg
 *
msg
, 
oÂbuf
 *
b
)

793 c⁄° 
uöt8_t
 
íd
 = 
DHCP_CODE_END
;

794 
uöt32_t
 
cookõ
 = 
	`ht⁄l
(
DHCP_OPTS_COOKIE
);

795 
oÂbuf
 
vnd_d©a
;

796 
dh˝_hódî
 
dh˝
;

797 
i
;

799 
	`mem£t
(&
dh˝
, 0,  dhcp);

800 
dh˝
.
›
 = 
msg
->op;

801 
dh˝
.
hty≥
 = 
ARP_HRD_ETHERNET
;

802 
dh˝
.
hÀn
 = 
ETH_ADDR_LEN
;

803 
dh˝
.
h›s
 = 0;

804 
dh˝
.
xid
 = 
	`ht⁄l
(
msg
->xid);

805 
dh˝
.
£cs
 = 
	`ht⁄s
(
msg
->secs);

806 
dh˝
.
Êags
 = 
	`ht⁄s
(
msg
->flags);

807 
dh˝
.
cüddr
 = 
msg
->ciaddr;

808 
dh˝
.
yüddr
 = 
msg
->yiaddr;

809 
dh˝
.
süddr
 = 
msg
->siaddr;

810 
dh˝
.
güddr
 = 
msg
->giaddr;

811 
	`mem˝y
(
dh˝
.
chaddr
, 
msg
->chaddr, 
ETH_ADDR_LEN
);

812 
	`oÂbuf_put
(
b
, &
dh˝
,  dhcp);

813 
	`oÂbuf_put
(
b
, &
cookõ
,  cookie);

817 i‡(
msg
->
ty≥
) {

818 
uöt8_t
 
ty≥
 = 
msg
->type;

819 
	`put_›ti⁄
(
b
, 
DHCP_CODE_DHCP_MSG_TYPE
, &
ty≥
, 1);

823 
i
 = 0; i < 
DHCP_VENDOR_OFS
; i++) {

824 c⁄° 
dh˝_›ti⁄
 *
›ti⁄
 = &
msg
->
›ti⁄s
[
i
];

825 
	`put_›ti⁄
(
b
, 
i
, 
›ti⁄
->
d©a
, o±i⁄->
n
);

829 
	`oÂbuf_öô
(&
vnd_d©a
, 0);

830 
i
 = 
DHCP_VENDOR_OFS
; i < 
DHCP_N_OPTIONS
; i++) {

831 c⁄° 
dh˝_›ti⁄
 *
›ti⁄
 = &
msg
->
›ti⁄s
[
i
];

832 
	`put_›ti⁄
(&
vnd_d©a
, 
i
 - 
DHCP_VENDOR_OFS
, 
›ti⁄
->
d©a
, o±i⁄->
n
);

834 i‡(
vnd_d©a
.
size
) {

835 
	`put_›ti⁄
(
b
, 
DHCP_CODE_VENDOR_SPECIFIC
, 
vnd_d©a
.
d©a
, vnd_d©a.
size
);

837 
	`oÂbuf_unöô
(&
vnd_d©a
);

840 
	`oÂbuf_put
(
b
, &
íd
, Énd);

841 
	}
}

	@lib/dhcp.h

34 #i‚de‡
DHCP_H


35 
	#DHCP_H
 1

	)

37 
	~<°döt.h
>

38 
	~"∑ckës.h
"

39 
	~"utû.h
"

41 
	gds
;

42 
	goÂbuf
;

45 
	#DHCP_BOOTREQUEST
 1

	)

46 
	#DHCP_BOOTREPLY
 2

	)

49 
	#DHCP_FLAGS_BROADCAST
 0x8000

	)

50 
	#DHCP_FLAGS_MBZ
 0x7ff‡

	)

53 
	#DHCP_OPTS_COOKIE
 0x63825363

	)

55 
	#DHCP_HEADER_LEN
 236

	)

56 
	sdh˝_hódî
 {

57 
uöt8_t
 
	m›
;

58 
uöt8_t
 
	mhty≥
;

59 
uöt8_t
 
	mhÀn
;

60 
uöt8_t
 
	mh›s
;

61 
uöt32_t
 
	mxid
;

62 
uöt16_t
 
	m£cs
;

63 
uöt16_t
 
	mÊags
;

64 
uöt32_t
 
	mcüddr
;

65 
uöt32_t
 
	myüddr
;

66 
uöt32_t
 
	msüddr
;

67 
uöt32_t
 
	mgüddr
;

68 
uöt8_t
 
	mchaddr
[16];

69 
	m¢ame
[64];

70 
	mfûe
[128];

73 
BUILD_ASSERT_DECL
(
DHCP_HEADER_LEN
 =(
dh˝_hódî
));

75 
	#DHCP_ARGS
 \

76 
	`DHCP_ARG
(
FIXED
, 0) \

77 
	`DHCP_ARG
(
IP
, 4) \

78 
	`DHCP_ARG
(
SECS
, 4) \

79 
	`DHCP_ARG
(
STRING
, 1) \

80 
	`DHCP_ARG
(
UINT8
, 1) \

81 
	`DHCP_ARG
(
UINT16
, 2) \

82 
	`DHCP_ARG
(
UINT32
, 4) \

83 
	`DHCP_ARG
(
BOOLEAN
, 1Ë

	)

86 
	edh˝_¨g_ty≥
 {

87 
	#DHCP_ARG
(
NAME
, 
SIZE
Ë
DHCP_ARG_
##NAME,

	)

88 
	mDHCP_ARGS


89 #unde‡
DHCP_ARG


92 
	#DHCP_MSGS
 \

93 
	`DHCP_MSG
(
DHCPDISCOVER
, 1) \

94 
	`DHCP_MSG
(
DHCPOFFER
, 2) \

95 
	`DHCP_MSG
(
DHCPREQUEST
, 3) \

96 
	`DHCP_MSG
(
DHCPDECLINE
, 4) \

97 
	`DHCP_MSG
(
DHCPACK
, 5) \

98 
	`DHCP_MSG
(
DHCPNAK
, 6) \

99 
	`DHCP_MSG
(
DHCPRELEASE
, 7) \

100 
	`DHCP_MSG
(
DCHPINFORM
, 8Ë

	)

103 
	edh˝_msg_ty≥
 {

104 
	#DHCP_MSG
(
NAME
, 
VALUE
ËNAME = VALUE,

	)

105 
	mDHCP_MSGS


106 #unde‡
DHCP_MSG


108 c⁄° *
dh˝_ty≥_«me
(
dh˝_msg_ty≥
);

113 
	#DHCP_N_OPTIONS
 512

	)

114 
	#DHCP_VENDOR_OFS
 256

	)

117 
	#DHCP_OPTS
 \

120 
	`DHCP_OPT
(
PAD
, 0, 
FIXED
, 0, 0) \

121 
	`DHCP_OPT
(
END
, 255, 
FIXED
, 0, 0) \

122 
	`DHCP_OPT
(
SUBNET_MASK
, 1, 
IP
, 1, 1) \

123 
	`DHCP_OPT
(
TIME_OFFSET
, 2, 
SECS
, 1, 1) \

124 
	`DHCP_OPT
(
ROUTER
, 3, 
IP
, 1, 
SIZE_MAX
) \

127 
	`DHCP_OPT
(
DNS_SERVER
, 6, 
IP
, 1, 
SIZE_MAX
) \

130 
	`DHCP_OPT
(
LPR_SERVER
, 9, 
IP
, 1, 
SIZE_MAX
) \

133 
	`DHCP_OPT
(
HOST_NAME
, 12, 
STRING
, 1, 
SIZE_MAX
) \

134 
	`DHCP_OPT
(
BOOT_FILE_SIZE
, 13, 
UINT16
, 1, 1) \

136 
	`DHCP_OPT
(
DOMAIN_NAME
, 15, 
STRING
, 1, 
SIZE_MAX
) \

138 
	`DHCP_OPT
(
ROOT_PATH
, 17, 
STRING
, 1, 
SIZE_MAX
) \

139 
	`DHCP_OPT
(
EXTENSIONS_PATH
, 18, 
STRING
, 1, 
SIZE_MAX
) \

140 
	`DHCP_OPT
(
IP_FORWARDING
, 19, 
BOOLEAN
, 1, 1) \

141 
	`DHCP_OPT
(
SOURCE_ROUTING
, 20, 
BOOLEAN
, 1, 1) \

142 
	`DHCP_OPT
(
POLICY_FILTER
, 21, 
IP
, 2, 
SIZE_MAX
) \

143 
	`DHCP_OPT
(
MAX_DGRAM_REASSEMBLY
, 22, 
UINT16
, 1, 1) \

144 
	`DHCP_OPT
(
IP_TTL
, 23, 
UINT8
, 1, 1) \

145 
	`DHCP_OPT
(
PATH_MTU_TIMEOUT
, 24, 
SECS
, 1, 1) \

146 
	`DHCP_OPT
(
PATH_MTU_PLATEAU
, 25, 
UINT16
, 2, 
SIZE_MAX
) \

147 
	`DHCP_OPT
(
MTU
, 26, 
UINT16
, 1, 1) \

148 
	`DHCP_OPT
(
ALL_SUBNETS_ARE_LOCAL
, 27, 
BOOLEAN
, 1, 1) \

149 
	`DHCP_OPT
(
BROADCAST_ADDRESS
, 28, 
IP
, 1, 1) \

150 
	`DHCP_OPT
(
PERFORM_MASK_DISCOVERY
, 29, 
BOOLEAN
, 1, 1) \

151 
	`DHCP_OPT
(
MASK_SUPPLIER
, 30, 
BOOLEAN
, 1, 1) \

152 
	`DHCP_OPT
(
PERFORM_ROUTER_DISCOVERY
, 31, 
BOOLEAN
, 1, 1) \

153 
	`DHCP_OPT
(
ROUTER_SOLICITATION
, 32, 
IP
, 1, 1) \

154 
	`DHCP_OPT
(
STATIC_ROUTE
, 33, 
IP
, 2, 
SIZE_MAX
) \

156 
	`DHCP_OPT
(
ARP_CACHE_TIMEOUT
, 35, 
SECS
, 1, 1) \

157 
	`DHCP_OPT
(
ETHERNET_ENCAPSULATION
, 36, 
BOOLEAN
, 1, 1) \

158 
	`DHCP_OPT
(
TCP_TTL
, 37, 
UINT8
, 1, 1) \

159 
	`DHCP_OPT
(
TCP_KEEPALIVE_INTERVAL
, 38, 
SECS
, 1, 1) \

160 
	`DHCP_OPT
(
TCP_KEEPALIVE_GARBAGE
, 39, 
BOOLEAN
, 1, 1) \

161 
	`DHCP_OPT
(
NIS_DOMAIN
, 40, 
STRING
, 1, 
SIZE_MAX
) \

162 
	`DHCP_OPT
(
NIS_SERVERS
, 41, 
IP
, 1, 
SIZE_MAX
) \

163 
	`DHCP_OPT
(
NTP_SERVERS
, 42, 
IP
, 1, 
SIZE_MAX
) \

164 
	`DHCP_OPT
(
VENDOR_SPECIFIC
, 43, 
UINT8
, 1, 
SIZE_MAX
) \

165 
	`DHCP_OPT
(
NETBIOS_NS
, 44, 
IP
, 1, 
SIZE_MAX
) \

166 
	`DHCP_OPT
(
NETBIOS_DDS
, 45, 
IP
, 1, 
SIZE_MAX
) \

167 
	`DHCP_OPT
(
NETBIOS_NODE_TYPE
, 46, 
UINT8
, 1, 1) \

168 
	`DHCP_OPT
(
NETBIOS_SCOPE
, 47, 
STRING
, 1, 
SIZE_MAX
) \

169 
	`DHCP_OPT
(
X_FONT_SERVER
, 48, 
IP
, 1, 
SIZE_MAX
) \

170 
	`DHCP_OPT
(
XDM
, 49, 
IP
, 1, 
SIZE_MAX
) \

171 
	`DHCP_OPT
(
NISPLUS_DOMAIN
, 64, 
STRING
, 1, 
SIZE_MAX
) \

172 
	`DHCP_OPT
(
NISPLUS_SERVERS
, 65, 
IP
, 1, 
SIZE_MAX
) \

173 
	`DHCP_OPT
(
MOBILE_IP_HOME_AGENT
, 68, 
IP
, 0, 
SIZE_MAX
) \

174 
	`DHCP_OPT
(
SMTP_SERVER
, 69, 
IP
, 1, 
SIZE_MAX
) \

175 
	`DHCP_OPT
(
POP3_SERVER
, 70, 
IP
, 1, 
SIZE_MAX
) \

176 
	`DHCP_OPT
(
NNTP_SERVER
, 71, 
IP
, 1, 
SIZE_MAX
) \

177 
	`DHCP_OPT
(
WWW_SERVER
, 72, 
IP
, 1, 
SIZE_MAX
) \

178 
	`DHCP_OPT
(
FINGER_SERVER
, 73, 
IP
, 1, 
SIZE_MAX
) \

179 
	`DHCP_OPT
(
IRC_SERVER
, 74, 
IP
, 1, 
SIZE_MAX
) \

182 
	`DHCP_OPT
(
REQUESTED_IP
, 50, 
IP
, 1, 1) \

183 
	`DHCP_OPT
(
LEASE_TIME
, 51, 
SECS
, 1, 1) \

184 
	`DHCP_OPT
(
OPTION_OVERLOAD
, 52, 
UINT8
, 1, 1) \

185 
	`DHCP_OPT
(
TFTP_SERVER
, 66, 
STRING
, 1, 
SIZE_MAX
) \

186 
	`DHCP_OPT
(
BOOTFILE_NAME
, 67, 
STRING
, 1, 
SIZE_MAX
) \

187 
	`DHCP_OPT
(
DHCP_MSG_TYPE
, 53, 
UINT8
, 1, 1) \

188 
	`DHCP_OPT
(
SERVER_IDENTIFIER
, 54, 
IP
, 1, 1) \

189 
	`DHCP_OPT
(
PARAMETER_REQUEST_LIST
, 55, 
UINT8
, 1, 
SIZE_MAX
) \

190 
	`DHCP_OPT
(
MESSAGE
, 56, 
STRING
, 1, 
SIZE_MAX
) \

191 
	`DHCP_OPT
(
MAX_DHCP_MSG_SIZE
, 57, 
UINT16
, 1, 1) \

192 
	`DHCP_OPT
(
T1
, 58, 
SECS
, 1, 1) \

193 
	`DHCP_OPT
(
T2
, 59, 
SECS
, 1, 1) \

194 
	`DHCP_OPT
(
VENDOR_CLASS
, 60, 
STRING
, 1, 
SIZE_MAX
) \

195 
	`DHCP_OPT
(
CLIENT_ID
, 61, 
UINT8
, 2, 
SIZE_MAX
) \

196 
	`DHCP_VNDOPT
(
OFP_CONTROLLER_VCONN
, 1, 
STRING
, 1, 
SIZE_MAX
) \

197 
	`DHCP_VNDOPT
(
OFP_PKI_URI
, 2, 
STRING
, 1, 
SIZE_MAX
)

	)

200 
	#DHCP_VNDOPT
(
NAME
, 
CODE
, 
ARG
, 
MIN
, 
MAX
) \

201 
	`DHCP_OPT
(
NAME
, (
CODE
Ë+ 
DHCP_VENDOR_OFS
, 
ARG
, 
MIN
, 
MAX
)

	)

205 
	#DHCP_OPT
(
NAME
, 
VALUE
, 
ARGTYPE
, 
MIN_ARGS
, 
MAX_ARGS
) \

206 
DHCP_CODE_
##
NAME
 = 
VALUE
,

	)

207 
	mDHCP_OPTS


208 #unde‡
DHCP_OPT


216 
	sdh˝_›ti⁄
 {

217 
size_t
 
	mn
;

218 *
	md©a
;

221 c⁄° *
dh˝_›ti⁄_to_°rög
(c⁄° 
dh˝_›ti⁄
 *, 
code
,

222 
ds
 *);

223 
boﬁ
 
dh˝_›ti⁄_equÆs
(c⁄° 
dh˝_›ti⁄
 *,

224 c⁄° 
dh˝_›ti⁄
 *);

228 
	sdh˝_msg
 {

230 
uöt8_t
 
	m›
;

231 
uöt32_t
 
	mxid
;

232 
uöt16_t
 
	m£cs
;

233 
uöt16_t
 
	mÊags
;

234 
uöt32_t
 
	mcüddr
;

235 
uöt32_t
 
	myüddr
;

236 
uöt32_t
 
	msüddr
;

237 
uöt32_t
 
	mgüddr
;

238 
uöt8_t
 
	mchaddr
[
ETH_ADDR_LEN
];

239 
dh˝_msg_ty≥
 
	mty≥
;

240 
dh˝_›ti⁄
 
	m›ti⁄s
[
DHCP_N_OPTIONS
];

243 
uöt8_t
 *
	md©a
;

244 
size_t
 
	md©a_u£d
, 
	md©a_Æloˇãd
;

247 
dh˝_msg_öô
(
dh˝_msg
 *);

248 
dh˝_msg_unöô
(
dh˝_msg
 *);

249 
dh˝_msg_c›y
(
dh˝_msg
 *, const dhcp_msg *);

250 
dh˝_msg_put
(
dh˝_msg
 *, 
code
, c⁄° *, 
size_t
);

251 
dh˝_msg_put_boﬁ
(
dh˝_msg
 *, 
code
, 
boﬁ
);

252 
dh˝_msg_put_£cs
(
dh˝_msg
 *, 
code
, 
uöt32_t
);

253 
dh˝_msg_put_ù
(
dh˝_msg
 *, 
code
, 
uöt32_t
);

254 
dh˝_msg_put_°rög
(
dh˝_msg
 *, 
code
, const *);

255 
dh˝_msg_put_uöt8
(
dh˝_msg
 *, 
code
, 
uöt8_t
);

256 
dh˝_msg_put_uöt8_¨øy
(
dh˝_msg
 *, 
code
,

257 c⁄° 
uöt8_t
[], 
size_t
 
n
);

258 
dh˝_msg_put_uöt16
(
dh˝_msg
 *, 
code
, 
uöt16_t
);

259 
dh˝_msg_put_uöt16_¨øy
(
dh˝_msg
 *, 
code
,

260 c⁄° 
uöt16_t
[], 
size_t
 
n
);

261 c⁄° *
dh˝_msg_gë
(c⁄° 
dh˝_msg
 *, 
code
, 
size_t
 
off£t
,

262 
size_t
 
size
);

263 
boﬁ
 
dh˝_msg_gë_boﬁ
(c⁄° 
dh˝_msg
 *, 
code
,

264 
size_t
 
off£t
, 
boﬁ
 *);

265 
boﬁ
 
dh˝_msg_gë_£cs
(c⁄° 
dh˝_msg
 *, 
code
,

266 
size_t
 
off£t
, 
uöt32_t
 *);

267 
boﬁ
 
dh˝_msg_gë_ù
(c⁄° 
dh˝_msg
 *, 
code
,

268 
size_t
 
off£t
, 
uöt32_t
 *);

269 *
dh˝_msg_gë_°rög
(c⁄° 
dh˝_msg
 *, 
code
);

270 
boﬁ
 
dh˝_msg_gë_uöt8
(c⁄° 
dh˝_msg
 *, 
code
,

271 
size_t
 
off£t
, 
uöt8_t
 *);

272 
boﬁ
 
dh˝_msg_gë_uöt16
(c⁄° 
dh˝_msg
 *, 
code
,

273 
size_t
 
off£t
, 
uöt16_t
 *);

274 c⁄° *
dh˝_msg_to_°rög
(c⁄° 
dh˝_msg
 *, 
boﬁ
 
mu…ûöe
,

275 
ds
 *);

276 
dh˝_∑r£
(
dh˝_msg
 *, c⁄° 
oÂbuf
 *);

277 
dh˝_as£mbÀ
(c⁄° 
dh˝_msg
 *, 
oÂbuf
 *);

	@lib/dhparams.h

1 #i‚de‡
DHPARAMS_H


2 
	#DHPARAMS_H
 1

	)

4 
	~<›ís¶/dh.h
>

6 
DH
 *
gë_dh1024
();

7 
DH
 *
gë_dh2048
();

8 
DH
 *
gë_dh4096
();

	@lib/dirs.c

2 c⁄° 
	goÂ_pkgd©adú
[] = "/usr/local/share/openflow";

3 c⁄° 
	goÂ_rundú
[] = "/usr/local/var/run";

4 c⁄° 
	goÂ_logdú
[] = "/usr/local/var/log/openflow";

	@lib/dirs.h

34 #i‚de‡
DIRS_H


35 
	#DIRS_H
 1

	)

37 c⁄° 
oÂ_pkgd©adú
[];

38 c⁄° 
oÂ_rundú
[];

39 c⁄° 
oÂ_logdú
[];

	@lib/dpif.c

34 
	~<c⁄fig.h
>

35 
	~"dpif.h
"

37 
	~<as£π.h
>

38 
	~<˘y≥.h
>

39 
	~<î∫o.h
>

40 
	~<öây≥s.h
>

41 
	~<√töë/ö.h
>

42 
	~<°dlib.h
>

43 
	~<°rög.h
>

45 
	~"√éök.h
"

46 
	~"√éök-¥Ÿocﬁ.h
"

47 
	~"oÂbuf.h
"

48 
	~"›íÊow/›íÊow-√éök.h
"

49 
	~"›íÊow/›íÊow.h
"

50 
	~"∑ckës.h
"

51 
	~"utû.h
"

52 
	~"xtoxŒ.h
"

54 
	~"vlog.h
"

55 
	#LOG_MODULE
 
VLM_dpif


	)

58 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(5, 60);

61 
	g›íÊow_Ámûy
;

63 
lookup_›íÊow_mu…iˇ°_group
(
dp_idx
, *
mu…iˇ°_group
);

64 
£nd_mgmt_comm™d
(
dpif
 *, 
dp_idx
, 
comm™d
,

65 c⁄° *
√tdev
);

72 
	$dpif_›í
(
subs¸ibe_dp_idx
, 
dpif
 *
dp
)

74 
∆_sock
 *
sock
;

75 
mu…iˇ°_group
 = 0;

76 
ªtvÆ
;

78 
ªtvÆ
 = 
	`∆_lookup_gíl_Ámûy
(
DP_GENL_FAMILY_NAME
, &
›íÊow_Ámûy
);

79 i‡(
ªtvÆ
) {

80  
ªtvÆ
;

83 i‡(
subs¸ibe_dp_idx
 >= 0) {

84 
ªtvÆ
 = 
	`lookup_›íÊow_mu…iˇ°_group
(
subs¸ibe_dp_idx
,

85 &
mu…iˇ°_group
);

86 i‡(
ªtvÆ
) {

87  
ªtvÆ
;

93 
ªtvÆ
 = 
	`∆_sock_¸óã
(
NETLINK_GENERIC
, 
mu…iˇ°_group
, 0,

94 4 * 1024u * 1024, &
sock
);

95 i‡(
ªtvÆ
) {

96  
ªtvÆ
;

99 
dp
->
sock
 = sock;

101 
	}
}

105 
	$dpif_˛o£
(
dpif
 *
dp
)

107 i‡(
dp
) {

108 
	`∆_sock_de°roy
(
dp
->
sock
);

110 
	}
}

112 c⁄° 
∆_pﬁicy
 
	g›íÊow_pﬁicy
[] = {

113 [
DP_GENL_A_DP_IDX
] = { .
ty≥
 = 
NL_A_U32
,

114 .
	g›ti⁄Æ
 = 
Ál£
 },

115 [
DP_GENL_A_OPENFLOW
] = { .
ty≥
 = 
NL_A_UNSPEC
,

116 .
	gmö_Àn
 = (
oÂ_hódî
),

117 .
	gmax_Àn
 = 65535,

118 .
	g›ti⁄Æ
 = 
Ál£
 },

133 
	$dpif_ªcv_›íÊow
(
dpif
 *
dp
, 
dp_idx
, 
oÂbuf
 **
buf„Ω
,

134 
boﬁ
 
waô
)

136 
∆©å
 *
©ås
[
	`ARRAY_SIZE
(
›íÊow_pﬁicy
)];

137 
oÂbuf
 *
buf„r
;

138 
oÂ_hódî
 *
oh
;

139 
uöt16_t
 
oÂ_Àn
;

141 
buf„r
 = *
buf„Ω
 = 
NULL
;

143 
ªtvÆ
;

146 
	`oÂbuf_dñëe
(
buf„r
);

147 
ªtvÆ
 = 
	`∆_sock_ªcv
(
dp
->
sock
, &
buf„r
, 
waô
);

148 } 
ªtvÆ
 =
ENOBUFS


149 || (!
ªtvÆ


150 && (
	`∆_msg_∆msghdr
(
buf„r
)->
∆msg_ty≥
 =
NLMSG_DONE


151 || 
	`∆_msg_∆msgîr
(
buf„r
, 
NULL
))));

152 i‡(
ªtvÆ
) {

153 i‡(
ªtvÆ
 !
EAGAIN
) {

154 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "dpif_ªcv_›íÊow: %s", 
	`°ªº‹
(
ªtvÆ
));

156  
ªtvÆ
;

159 i‡(
	`∆_msg_gílmsghdr
(
buf„r
Ë=
NULL
) {

160 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "receivedÖacketÅoo short for Generic Netlink");

161 
îr‹
;

163 i‡(
	`∆_msg_∆msghdr
(
buf„r
)->
∆msg_ty≥
 !
›íÊow_Ámûy
) {

164 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
,

165 "ª˚ivedÅy≥ (%"
PRIu16
") != openflow family (%d)",

166 
	`∆_msg_∆msghdr
(
buf„r
)->
∆msg_ty≥
, 
›íÊow_Ámûy
);

167 
îr‹
;

170 i‡(!
	`∆_pﬁicy_∑r£
(
buf„r
, 
NLMSG_HDRLEN
 + 
GENL_HDRLEN
,

171 
›íÊow_pﬁicy
, 
©ås
,

172 
	`ARRAY_SIZE
(
›íÊow_pﬁicy
))) {

173 
îr‹
;

175 } 
	`∆_©å_gë_u32
(
©ås
[
DP_GENL_A_DP_IDX
]Ë!
dp_idx
);

177 
oh
 = 
buf„r
->
d©a
 = (*Ë
	`∆_©å_gë
(
©ås
[
DP_GENL_A_OPENFLOW
]);

178 
buf„r
->
size
 = 
	`∆_©å_gë_size
(
©ås
[
DP_GENL_A_OPENFLOW
]);

179 
oÂ_Àn
 = 
	`¡ohs
(
oh
->
Àngth
);

180 i‡(
oÂ_Àn
 !
buf„r
->
size
) {

181 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
,

182 "oÂ_hódî.Àngth %"
PRIu16
" !=áttributeÜength %zu\n",

183 
oÂ_Àn
, 
buf„r
->
size
);

184 
buf„r
->
size
 = 
	`MIN
(
oÂ_Àn
, buffer->size);

186 *
buf„Ω
 = 
buf„r
;

189 
îr‹
:

190 
	`oÂbuf_dñëe
(
buf„r
);

191  
EPROTO
;

192 
	}
}

206 
	$dpif_£nd_›íÊow
(
dpif
 *
dp
, 
dp_idx
, 
oÂbuf
 *
buf„r
)

208 
oÂ_hódî
 *
oh
;

209 
dump_Êag
;

210 
oÂbuf
 
hdr
;

211 
∆©å
 *
∆a
;

212 
uöt32_t
 
fixed_buf„r
[64 / 4];

213 
iovec
 
iov
[3];

214 
∑d_byãs
;

215 
n_iov
;

216 
ªtvÆ
;

220 
oh
 = 
	`oÂbuf_©_as£π
(
buf„r
, 0,  *oh);

221 
dump_Êag
 = 
oh
->
ty≥
 =
OFPT_MULTIPART_REQUEST
 ? 
NLM_F_DUMP
 : 0;

223 
	`oÂbuf_u£
(&
hdr
, 
fixed_buf„r
,  fixed_buffer);

224 
	`∆_msg_put_gílmsghdr
(&
hdr
, 
dp
->
sock
, 32, 
›íÊow_Ámûy
,

225 
NLM_F_REQUEST
 | 
dump_Êag
, 
DP_GENL_C_OPENFLOW
, 1);

226 
	`∆_msg_put_u32
(&
hdr
, 
DP_GENL_A_DP_IDX
, 
dp_idx
);

227 
∆a
 = 
	`oÂbuf_put_unöô
(&
hdr
,  *nla);

228 
∆a
->
∆a_Àn
 =  *∆®+ 
buf„r
->
size
;

229 
∆a
->
∆a_ty≥
 = 
DP_GENL_A_OPENFLOW
;

230 
∑d_byãs
 = 
	`NLA_ALIGN
(
∆a
->
∆a_Àn
) -Çla->nla_len;

231 
	`∆_msg_∆msghdr
(&
hdr
)->
∆msg_Àn
 = hdr.
size
 + 
buf„r
->sizê+ 
∑d_byãs
;

232 
n_iov
 = 2;

233 
iov
[0].
iov_ba£
 = 
hdr
.
d©a
;

234 
iov
[0].
iov_Àn
 = 
hdr
.
size
;

235 
iov
[1].
iov_ba£
 = 
buf„r
->
d©a
;

236 
iov
[1].
iov_Àn
 = 
buf„r
->
size
;

237 i‡(
∑d_byãs
) {

238 
zîos
[
NLA_ALIGNTO
];

239 
n_iov
++;

240 
iov
[2].
iov_ba£
 = 
zîos
;

241 
iov
[2].
iov_Àn
 = 
∑d_byãs
;

243 
ªtvÆ
 = 
	`∆_sock_£ndv
(
dp
->
sock
, 
iov
, 
n_iov
, 
Ál£
);

244 i‡(
ªtvÆ
 &&ÑëvÆ !
EAGAIN
) {

245 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "dpif_£nd_›íÊow: %s", 
	`°ªº‹
(
ªtvÆ
));

247  
ªtvÆ
;

248 
	}
}

256 
	$dpif_add_dp
(
dpif
 *
dp
, 
dp_idx
, c⁄° *
dp_«me
)

258  
	`£nd_mgmt_comm™d
(
dp
, 
dp_idx
, 
DP_GENL_C_ADD_DP
, 
dp_«me
);

259 
	}
}

266 
	$dpif_dñ_dp
(
dpif
 *
dp
, 
dp_idx
, c⁄° *
dp_«me
)

268  
	`£nd_mgmt_comm™d
(
dp
, 
dp_idx
, 
DP_GENL_C_DEL_DP
, 
dp_«me
);

269 
	}
}

274 
	$dpif_add_p‹t
(
dpif
 *
dp
, 
dp_idx
, c⁄° *
√tdev
)

276  
	`£nd_mgmt_comm™d
(
dp
, 
dp_idx
, 
DP_GENL_C_ADD_PORT
, 
√tdev
);

277 
	}
}

282 
	$dpif_dñ_p‹t
(
dpif
 *
dp
, 
dp_idx
, c⁄° *
√tdev
)

284  
	`£nd_mgmt_comm™d
(
dp
, 
dp_idx
, 
DP_GENL_C_DEL_PORT
, 
√tdev
);

285 
	}
}

287 c⁄° 
∆_pﬁicy
 
	g›íÊow_mu…iˇ°_pﬁicy
[] = {

288 [
DP_GENL_A_DP_IDX
] = { .
ty≥
 = 
NL_A_U32
 },

289 [
DP_GENL_A_DP_NAME
] = { .
ty≥
 = 
NL_A_STRING
 },

290 [
DP_GENL_A_MC_GROUP
] = { .
ty≥
 = 
NL_A_U32
 },

299 
	$quîy_d©≠©h
(*
dp_idx
, *
mu…iˇ°_group
, c⁄° *
dp_«me
)

301 
∆_sock
 *
sock
;

302 
oÂbuf
 
ªque°
, *
ª∂y
;

303 
∆©å
 *
©ås
[
	`ARRAY_SIZE
(
›íÊow_mu…iˇ°_pﬁicy
)];

304 
ªtvÆ
;

306 
ªtvÆ
 = 
	`∆_sock_¸óã
(
NETLINK_GENERIC
, 0, 0, 0, &
sock
);

307 i‡(
ªtvÆ
) {

308  
ªtvÆ
;

310 
	`oÂbuf_öô
(&
ªque°
, 0);

311 
	`∆_msg_put_gílmsghdr
(&
ªque°
, 
sock
, 0, 
›íÊow_Ámûy
, 
NLM_F_REQUEST
,

312 
DP_GENL_C_QUERY_DP
, 1);

313 i‡(*
dp_idx
 != -1) {

314 
	`∆_msg_put_u32
(&
ªque°
, 
DP_GENL_A_DP_IDX
, *
dp_idx
);

316 i‡(
dp_«me
) {

317 
	`∆_msg_put_°rög
(&
ªque°
, 
DP_GENL_A_DP_NAME
, 
dp_«me
);

319 
ªtvÆ
 = 
	`∆_sock_å™ß˘
(
sock
, &
ªque°
, &
ª∂y
);

320 
	`oÂbuf_unöô
(&
ªque°
);

321 i‡(
ªtvÆ
) {

322 
	`∆_sock_de°roy
(
sock
);

323  
ªtvÆ
;

325 i‡(!
	`∆_pﬁicy_∑r£
(
ª∂y
, 
NLMSG_HDRLEN
 + 
GENL_HDRLEN
,

326 
›íÊow_mu…iˇ°_pﬁicy
, 
©ås
,

327 
	`ARRAY_SIZE
(
›íÊow_mu…iˇ°_pﬁicy
))) {

328 
	`∆_sock_de°roy
(
sock
);

329 
	`oÂbuf_dñëe
(
ª∂y
);

330  
EPROTO
;

332 *
dp_idx
 = 
	`∆_©å_gë_u32
(
©ås
[
DP_GENL_A_DP_IDX
]);

333 *
mu…iˇ°_group
 = 
	`∆_©å_gë_u32
(
©ås
[
DP_GENL_A_MC_GROUP
]);

334 
	`∆_sock_de°roy
(
sock
);

335 
	`oÂbuf_dñëe
(
ª∂y
);

338 
	}
}

344 
	$lookup_›íÊow_mu…iˇ°_group
(
dp_idx
, *
mu…iˇ°_group
)

346  
	`quîy_d©≠©h
(&
dp_idx
, 
mu…iˇ°_group
, 
NULL
);

347 
	}
}

352 
	$dpif_gë_idx
(c⁄° *
«me
)

354 
dp_idx
 = -1;

355 
mc_group
 = 0;

357 i‡(
	`quîy_d©≠©h
(&
dp_idx
, &
mc_group
, 
«me
)) {

361  
dp_idx
;

362 
	}
}

369 
	$£nd_mgmt_comm™d
(
dpif
 *
dp
, 
dp_idx
, 
comm™d
, c⁄° *
¨g
)

371 
oÂbuf
 
ªque°
, *
ª∂y
;

372 
ªtvÆ
;

374 
	`oÂbuf_öô
(&
ªque°
, 0);

375 
	`∆_msg_put_gílmsghdr
(&
ªque°
, 
dp
->
sock
, 32, 
›íÊow_Ámûy
,

376 
NLM_F_REQUEST
 | 
NLM_F_ACK
, 
comm™d
, 1);

377 i‡(
dp_idx
 != -1) {

378 
	`∆_msg_put_u32
(&
ªque°
, 
DP_GENL_A_DP_IDX
, 
dp_idx
);

380 i‡(
¨g
) {

381 i‡((
comm™d
 =
DP_GENL_C_ADD_DP
Ë|| (comm™d =
DP_GENL_C_DEL_DP
)) {

382 
	`∆_msg_put_°rög
(&
ªque°
, 
DP_GENL_A_DP_NAME
, 
¨g
);

384 
	`∆_msg_put_°rög
(&
ªque°
, 
DP_GENL_A_PORTNAME
, 
¨g
);

387 
ªtvÆ
 = 
	`∆_sock_å™ß˘
(
dp
->
sock
, &
ªque°
, &
ª∂y
);

388 
	`oÂbuf_unöô
(&
ªque°
);

389 
	`oÂbuf_dñëe
(
ª∂y
);

391  
ªtvÆ
;

392 
	}
}

	@lib/dpif.h

35 #i‚de‡
DPIF_H


36 
	#DPIF_H
 1

	)

42 
	~<°dboﬁ.h
>

43 
	~<°döt.h
>

45 
	goÂbuf
;

46 
	goÂ_m©ch
;

49 
	sdpif


51 
∆_sock
 *
	msock
;

54 
dpif_›í
(
subs¸ibe_dp_idx
, 
dpif
 *);

55 
dpif_˛o£
(
dpif
 *);

58 
dpif_ªcv_›íÊow
(
dpif
 *, 
dp_idx
, 
oÂbuf
 **, 
boﬁ
 
waô
);

59 
dpif_£nd_›íÊow
(
dpif
 *, 
dp_idx
, 
oÂbuf
 *);

62 
dpif_add_dp
(
dpif
 *, 
dp_idx
, c⁄° *
dp_«me
);

63 
dpif_dñ_dp
(
dpif
 *, 
dp_idx
, c⁄° *
dp_«me
);

64 
dpif_add_p‹t
(
dpif
 *, 
dp_idx
, c⁄° *
√tdev
);

65 
dpif_dñ_p‹t
(
dpif
 *, 
dp_idx
, c⁄° *
√tdev
);

66 
dpif_gë_idx
(c⁄° *
dp_«me
);

	@lib/dynamic-string.c

34 
	~<c⁄fig.h
>

35 
	~"dy«mic-°rög.h
"

36 
	~<as£π.h
>

37 
	~<°dlib.h
>

38 
	~<°rög.h
>

39 
	~<time.h
>

40 
	~"timevÆ.h
"

41 
	~"utû.h
"

44 
	$ds_öô
(
ds
 *ds)

46 
ds
->
°rög
 = 
NULL
;

47 
ds
->
Àngth
 = 0;

48 
ds
->
Æloˇãd
 = 0;

49 
	}
}

52 
	$ds_˛ór
(
ds
 *ds)

54 
ds
->
Àngth
 = 0;

55 
	}
}

58 
	$ds_åunˇã
(
ds
 *ds, 
size_t
 
√w_Àngth
)

60 i‡(
ds
->
Àngth
 > 
√w_Àngth
) {

61 
ds
->
Àngth
 = 
√w_Àngth
;

62 
ds
->
°rög
[
√w_Àngth
] = '\0';

64 
	}
}

67 
	$ds_ª£rve
(
ds
 *ds, 
size_t
 
mö_Àngth
)

69 i‡(
mö_Àngth
 > 
ds
->
Æloˇãd
 || !ds->
°rög
) {

70 
ds
->
Æloˇãd
 +
	`MAX
(
mö_Àngth
, ds->allocated);

71 
ds
->
Æloˇãd
 = 
	`MAX
(8, ds->allocated);

72 
ds
->
°rög
 = 
	`xªÆloc
(ds->°rög, ds->
Æloˇãd
 + 1);

74 
	}
}

77 
	$ds_put_unöô
(
ds
 *ds, 
size_t
 
n
)

79 
	`ds_ª£rve
(
ds
, ds->
Àngth
 + 
n
);

80 
ds
->
Àngth
 +
n
;

81 
ds
->
°rög
[ds->
Àngth
] = '\0';

82  &
ds
->
°rög
[ds->
Àngth
 - 
n
];

83 
	}
}

86 
	$ds_put_ch¨
(
ds
 *ds, 
c
)

88 *
	`ds_put_unöô
(
ds
, 1Ë
c
;

89 
	}
}

92 
	$ds_put_ch¨_mu…ùÀ
(
ds
 *ds, 
c
, 
size_t
 
n
)

94 
	`mem£t
(
	`ds_put_unöô
(
ds
, 
n
), 
c
,Ç);

95 
	}
}

98 
	$ds_put_buf„r
(
ds
 *ds, c⁄° *
s
, 
size_t
 
n
)

100 
	`mem˝y
(
	`ds_put_unöô
(
ds
, 
n
), 
s
,Ç);

101 
	}
}

104 
	$ds_put_c°r
(
ds
 *ds, c⁄° *
s
)

106 
size_t
 
s_Àn
 = 
	`°æí
(
s
);

107 
	`mem˝y
(
	`ds_put_unöô
(
ds
, 
s_Àn
), 
s
, s_len);

108 
	}
}

111 
	$ds_put_f‹m©
(
ds
 *ds, c⁄° *
f‹m©
, ...)

113 
va_li°
 
¨gs
;

115 
	`va_°¨t
(
¨gs
, 
f‹m©
);

116 
	`ds_put_f‹m©_vÆi°
(
ds
, 
f‹m©
, 
¨gs
);

117 
	`va_íd
(
¨gs
);

118 
	}
}

121 
	$ds_put_f‹m©_vÆi°
(
ds
 *ds, c⁄° *
f‹m©
, 
va_li°
 
¨gs_
)

123 
va_li°
 
¨gs
;

124 
size_t
 
avaûabÀ
;

125 
√eded
;

127 
	`va_c›y
(
¨gs
, 
¨gs_
);

128 
avaûabÀ
 = 
ds
->
°rög
 ? ds->
Æloˇãd
 - ds->
Àngth
 + 1 : 0;

129 
√eded
 = 
	`v¢¥ötf
(&
ds
->
°rög
[ds->
Àngth
], 
avaûabÀ
, 
f‹m©
, 
¨gs
);

130 
	`va_íd
(
¨gs
);

132 i‡(
√eded
 < 
avaûabÀ
) {

133 
ds
->
Àngth
 +
√eded
;

135 
size_t
 
avaûabÀ
;

137 
	`ds_ª£rve
(
ds
, ds->
Àngth
 + 
√eded
);

139 
	`va_c›y
(
¨gs
, 
¨gs_
);

140 
avaûabÀ
 = 
ds
->
Æloˇãd
 - ds->
Àngth
 + 1;

141 
√eded
 = 
	`v¢¥ötf
(&
ds
->
°rög
[ds->
Àngth
], 
avaûabÀ
, 
f‹m©
, 
¨gs
);

142 
	`va_íd
(
¨gs
);

144 
	`as£π
(
√eded
 < 
avaûabÀ
);

145 
ds
->
Àngth
 +
√eded
;

147 
	}
}

150 
	$ds_put_¥öèbÀ
(
ds
 *ds, c⁄° *
s
, 
size_t
 
n
)

152 
	`ds_ª£rve
(
ds
, ds->
Àngth
 + 
n
);

153 
n
-- > 0) {

154 
c
 = *
s
++;

155 i‡(
c
 < 0x20 || c > 0x7e || c == '\\' || c == '"') {

156 
	`ds_put_f‹m©
(
ds
, "\\%03o", (Ë
c
);

158 
	`ds_put_ch¨
(
ds
, 
c
);

161 
	}
}

164 
	$ds_put_°r·ime
(
ds
 *ds, c⁄° *
ãm∂©e
, c⁄° 
tm
 *tm)

166 i‡(!
tm
) {

167 
time_t
 
now
 = 
	`time_now
();

168 
tm
 = 
	`loˇ…ime
(&
now
);

171 
size_t
 
avaû
 = 
ds
->
°rög
 ? ds->
Æloˇãd
 - ds->
Àngth
 + 1 : 0;

172 
size_t
 
u£d
 = 
	`°r·ime
(&
ds
->
°rög
[ds->
Àngth
], 
avaû
, 
ãm∂©e
, 
tm
);

173 i‡(
u£d
) {

174 
ds
->
Àngth
 +
u£d
;

177 
	`ds_ª£rve
(
ds
, ds->
Àngth
 + (
avaû
 < 32 ? 64 : 2 *ávail));

179 
	}
}

182 
	$ds_gë_löe
(
ds
 *ds, 
FILE
 *
fûe
)

184 
	`ds_˛ór
(
ds
);

186 
c
 = 
	`gëc
(
fûe
);

187 i‡(
c
 =
EOF
) {

188  
ds
->
Àngth
 ? 0 : 
EOF
;

189 } i‡(
c
 == '\n') {

192 
	`ds_put_ch¨
(
ds
, 
c
);

195 
	}
}

198 
	$ds_c°r
(
ds
 *ds)

200 i‡(!
ds
->
°rög
) {

201 
	`ds_ª£rve
(
ds
, 0);

203 
ds
->
°rög
[ds->
Àngth
] = '\0';

204  
ds
->
°rög
;

205 
	}
}

208 
	$ds_de°roy
(
ds
 *ds)

210 
	`‰ì
(
ds
->
°rög
);

211 
	}
}

218 
	$ds_put_hex_dump
(
ds
 *ds, c⁄° *
buf_
, 
size_t
 
size
,

219 
uöçå_t
 
ofs
, 
boﬁ
 
ascii
)

221 c⁄° 
uöt8_t
 *
buf
 = 
buf_
;

222 c⁄° 
size_t
 
≥r_löe
 = 16;

224 
size
 > 0)

226 
size_t
 
°¨t
, 
íd
, 
n
;

227 
size_t
 
i
;

230 
°¨t
 = 
ofs
 % 
≥r_löe
;

231 
íd
 = 
≥r_löe
;

232 i‡(
íd
 - 
°¨t
 > 
size
)

233 
íd
 = 
°¨t
 + 
size
;

234 
n
 = 
íd
 - 
°¨t
;

237 
	`ds_put_f‹m©
(
ds
, "%08jx ", (
uötmax_t
Ë
	`ROUND_DOWN
(
ofs
, 
≥r_löe
));

238 
i
 = 0; i < 
°¨t
; i++)

239 
	`ds_put_f‹m©
(
ds
, " ");

240 ; 
i
 < 
íd
; i++)

241 
	`ds_put_f‹m©
(
ds
, "%02hhx%c",

242 
buf
[
i
 - 
°¨t
], i =
≥r_löe
 / 2 - 1? '-' : ' ');

243 i‡(
ascii
)

245 ; 
i
 < 
≥r_löe
; i++)

246 
	`ds_put_f‹m©
(
ds
, " ");

247 
	`ds_put_f‹m©
(
ds
, "|");

248 
i
 = 0; i < 
°¨t
; i++)

249 
	`ds_put_f‹m©
(
ds
, " ");

250 ; 
i
 < 
íd
; i++) {

251 
c
 = 
buf
[
i
 - 
°¨t
];

252 
	`ds_put_ch¨
(
ds
, 
c
 >= 32 && c < 127 ? c : '.');

254 ; 
i
 < 
≥r_löe
; i++)

255 
	`ds_put_f‹m©
(
ds
, " ");

256 
	`ds_put_f‹m©
(
ds
, "|");

258 
	`ds_put_f‹m©
(
ds
, "\n");

260 
ofs
 +
n
;

261 
buf
 +
n
;

262 
size
 -
n
;

264 
	}
}

267 
	$ds_œ°
(c⁄° 
ds
 *ds)

269  
ds
->
Àngth
 > 0 ? (Ëds->
°rög
[ds->Àngth - 1] : 
EOF
;

270 
	}
}

273 
	$ds_chomp
(
ds
 *ds, 
c
)

275 i‡(
ds
->
Àngth
 > 0 && ds->
°rög
[ds->Àngth - 1] =(Ë
c
) {

276 
ds
->
°rög
[--ds->
Àngth
] = '\0';

278 
	}
}

	@lib/dynamic-string.h

34 #i‚de‡
DYNAMIC_STRING_H


35 
	#DYNAMIC_STRING_H
 1

	)

37 
	~<°d¨g.h
>

38 
	~<°dboﬁ.h
>

39 
	~<°ddef.h
>

40 
	~<°döt.h
>

41 
	~<°dio.h
>

42 
	~"compûî.h
"

44 
	gtm
;

46 
	sds
 {

47 *
	m°rög
;

48 
size_t
 
	mÀngth
;

49 
size_t
 
	mÆloˇãd
;

52 
	#DS_EMPTY_INITIALIZER
 { 
NULL
, 0, 0 }

	)

54 
ds_öô
(
ds
 *);

55 
ds_˛ór
(
ds
 *);

56 
ds_åunˇã
(
ds
 *, 
size_t
 
√w_Àngth
);

57 
ds_ª£rve
(
ds
 *, 
size_t
 
mö_Àngth
);

58 *
ds_put_unöô
(
ds
 *, 
size_t
 
n
);

59 
ds_put_ch¨
(
ds
 *, );

60 
ds_put_ch¨_mu…ùÀ
(
ds
 *, , 
size_t
 
n
);

61 
ds_put_buf„r
(
ds
 *, c⁄° *, 
size_t
 
n
);

62 
ds_put_c°r
(
ds
 *, const *);

63 
	$ds_put_f‹m©
(
ds
 *, c⁄° *, ...Ë
	`PRINTF_FORMAT
(2, 3);

64 
	$ds_put_f‹m©_vÆi°
(
ds
 *, c⁄° *, 
va_li°
)

65 
	`PRINTF_FORMAT
(2, 0);

66 
	`ds_put_¥öèbÀ
(
ds
 *, c⁄° *, 
size_t
);

67 
	$ds_put_°r·ime
(
ds
 *, c⁄° *, c⁄° 
tm
 *)

68 
	`STRFTIME_FORMAT
(2);

69 
	`ds_put_hex_dump
(
ds
 *ds, c⁄° *
buf_
, 
size_t
 
size
,

70 
uöçå_t
 
ofs
, 
boﬁ
 
ascii
);

71 
	`ds_gë_löe
(
ds
 *, 
FILE
 *);

73 *
	`ds_c°r
(
ds
 *);

74 
	`ds_de°roy
(
ds
 *);

76 
	`ds_œ°
(c⁄° 
ds
 *);

77 
	`ds_chomp
(
ds
 *, 
c
);

	@lib/fatal-signal.c

33 
	~<c⁄fig.h
>

34 
	~"Áèl-sig«l.h
"

35 
	~<as£π.h
>

36 
	~<î∫o.h
>

37 
	~<sig«l.h
>

38 
	~<°dboﬁ.h
>

39 
	~<°dio.h
>

40 
	~<°dlib.h
>

41 
	~<°rög.h
>

42 
	~<uni°d.h
>

43 
	~"utû.h
"

46 c⁄° 
	gÁèl_sig«ls
[] = { 
SIGTERM
, 
SIGINT
, 
SIGHUP
, 
SIGALRM
 };

49 
sig£t_t
 
	gÁèl_sig«l_£t
;

52 
	shook
 {

53 (*
	mfunc
)(*
	maux
);

54 *
	maux
;

55 
boﬁ
 
	mrun_©_exô
;

57 
	#MAX_HOOKS
 32

	)

58 
hook
 
	ghooks
[
MAX_HOOKS
];

59 
size_t
 
	gn_hooks
;

62 
	gblock_Àvñ
 = 0;

65 
sig£t_t
 
	gßved_sig«l_mask
;

68 
boﬁ
 
	gdißbÀd
;

70 
ˇŒ_sig¥ocmask
(
how
, 
sig£t_t
* 
√w_£t
, sig£t_t* 
ﬁd_£t
);

71 
©exô_h™dÀr
();

72 
ˇŒ_hooks
(
sig_ƒ
);

78 
Áèl_sig«l_add_hook
((*
func
)(*
aux
), *aux, 
boﬁ
 
run_©_exô
)

80 
	`Áèl_sig«l_block
();

81 
	`as£π
(
n_hooks
 < 
MAX_HOOKS
);

82 
hooks
[
n_hooks
].
func
 = func;

83 
hooks
[
n_hooks
].
aux
 =áux;

84 
hooks
[
n_hooks
].
run_©_exô
 =Ñun_at_exit;

85 
n_hooks
++;

86 
	`Áèl_sig«l_unblock
();

87 
	}
}

97 
	$Áèl_sig«l_block
()

99 
boﬁ
 
öôed
 = 
Ál£
;

100 i‡(!
öôed
) {

101 
size_t
 
i
;

103 
öôed
 = 
åue
;

104 
	`sigem±y£t
(&
Áèl_sig«l_£t
);

105 
i
 = 0; i < 
	`ARRAY_SIZE
(
Áèl_sig«ls
); i++) {

106 
sig_ƒ
 = 
Áèl_sig«ls
[
i
];

107 
siga˘i⁄
 
ﬁd_ß
;

109 
	`sigadd£t
(&
Áèl_sig«l_£t
, 
sig_ƒ
);

110 i‡(
	`siga˘i⁄
(
sig_ƒ
, 
NULL
, &
ﬁd_ß
)) {

111 
	`oÂ_Áèl
(
î∫o
, "sigaction");

113 i‡(
ﬁd_ß
.
ß_h™dÀr
 =
SIG_DFL


114 && 
	`sig«l
(
sig_ƒ
, 
Áèl_sig«l_h™dÀr
Ë=
SIG_ERR
) {

115 
	`oÂ_Áèl
(
î∫o
, "signal");

118 
	`©exô
(
©exô_h™dÀr
);

121 i‡(++
block_Àvñ
 == 1) {

122 
	`ˇŒ_sig¥ocmask
(
SIG_BLOCK
, &
Áèl_sig«l_£t
, &
ßved_sig«l_mask
);

124 
	}
}

131 
	$Áèl_sig«l_unblock
()

133 
	`as£π
(
block_Àvñ
 > 0);

134 i‡(--
block_Àvñ
 == 0) {

135 
	`ˇŒ_sig¥ocmask
(
SIG_SETMASK
, &
ßved_sig«l_mask
, 
NULL
);

137 
	}
}

149 
	$Áèl_sig«l_h™dÀr
(
sig_ƒ
)

151 
	`ˇŒ_hooks
(
sig_ƒ
);

155 
	`sig«l
(
sig_ƒ
, 
SIG_DFL
);

156 
	`øi£
(
sig_ƒ
);

157 
	}
}

160 
	$©exô_h™dÀr
()

162 i‡(!
dißbÀd
) {

163 
	`ˇŒ_hooks
(0);

165 
	}
}

168 
	$ˇŒ_hooks
(
sig_ƒ
)

170 vﬁ©ûê
sig_©omic_t
 
ªcur£
 = 0;

171 i‡(!
ªcur£
) {

172 
size_t
 
i
;

174 
ªcur£
 = 1;

176 
i
 = 0; i < 
n_hooks
; i++) {

177 
hook
 *
h
 = &
hooks
[
i
];

178 i‡(
sig_ƒ
 || 
h
->
run_©_exô
) {

179 
h
->
	`func
(h->
aux
);

183 
	}
}

185 **
	gfûes
;

186 
size_t
 
	gn_fûes
, 
	gmax_fûes
;

188 
u∆ök_fûes
(*
aux
);

189 
do_u∆ök_fûes
();

194 
	$Áèl_sig«l_add_fûe_to_u∆ök
(c⁄° *
fûe
)

196 
boﬁ
 
added_hook
 = 
Ál£
;

197 i‡(!
added_hook
) {

198 
added_hook
 = 
åue
;

199 
	`Áèl_sig«l_add_hook
(
u∆ök_fûes
, 
NULL
, 
åue
);

202 
	`Áèl_sig«l_block
();

203 i‡(
n_fûes
 >
max_fûes
) {

204 
fûes
 = 
	`x2ƒóŒoc
(fûes, &
max_fûes
,  *files);

206 
fûes
[
n_fûes
++] = 
	`x°rdup
(
fûe
);

207 
	`Áèl_sig«l_unblock
();

208 
	}
}

213 
	$Áèl_sig«l_ªmove_fûe_to_u∆ök
(c⁄° *
fûe
)

215 
size_t
 
i
;

217 
	`Áèl_sig«l_block
();

218 
i
 = 0; i < 
n_fûes
; i++) {

219 i‡(!
	`°rcmp
(
fûes
[
i
], 
fûe
)) {

220 
	`‰ì
(
fûes
[
i
]);

221 
fûes
[
i
] = fûes[--
n_fûes
];

225 
	`Áèl_sig«l_unblock
();

226 
	}
}

229 
	$u∆ök_fûes
(*
aux
 
UNUSED
)

231 
	`do_u∆ök_fûes
();

232 
	}
}

235 
	$do_u∆ök_fûes
()

237 
size_t
 
i
;

239 
i
 = 0; i < 
n_fûes
; i++) {

240 
	`u∆ök
(
fûes
[
i
]);

242 
	}
}

249 
	$Áèl_sig«l_f‹k
()

251 
size_t
 
i
;

253 
dißbÀd
 = 
åue
;

255 
i
 = 0; i < 
	`ARRAY_SIZE
(
Áèl_sig«ls
); i++) {

256 
sig_ƒ
 = 
Áèl_sig«ls
[
i
];

257 i‡(
	`sig«l
(
sig_ƒ
, 
SIG_DFL
Ë=
SIG_IGN
) {

258 
	`sig«l
(
sig_ƒ
, 
SIG_IGN
);

261 
	}
}

264 
	$ˇŒ_sig¥ocmask
(
how
, 
sig£t_t
* 
√w_£t
, sig£t_t* 
ﬁd_£t
)

266 
îr‹
 = 
	`sig¥ocmask
(
how
, 
√w_£t
, 
ﬁd_£t
);

267 i‡(
îr‹
) {

268 
	`Ârötf
(
°dîr
, "sig¥ocmask: %s\n", 
	`°ªº‹
(
î∫o
));

270 
	}
}

	@lib/fatal-signal.h

34 #i‚de‡
FATAL_SIGNAL_H


35 
	#FATAL_SIGNAL_H
 1

	)

37 
	~<°dboﬁ.h
>

40 
Áèl_sig«l_add_hook
((*)(*
aux
), *aux, 
boﬁ
 
run_©_exô
);

41 
	`Áèl_sig«l_block
();

42 
	`Áèl_sig«l_unblock
();

43 
	`Áèl_sig«l_f‹k
();

49 
	`Áèl_sig«l_add_fûe_to_u∆ök
(const *);

50 
	`Áèl_sig«l_ªmove_fûe_to_u∆ök
(const *);

54 
	`Áèl_sig«l_h™dÀr
(
sig_ƒ
);

	@lib/fault.c

34 
	~<c⁄fig.h
>

35 
	~"Áu….h
"

36 
	~<dlf˙.h
>

37 
	~<öây≥s.h
>

38 
	~<°dio.h
>

39 
	~<°dlib.h
>

40 
	~<°rög.h
>

41 
	~<sig«l.h
>

42 
	~"utû.h
"

44 
	~"vlog.h
"

45 
	#LOG_MODULE
 
VLM_Áu…


	)

48 
	$Áu…_h™dÀr
(
sig_ƒ
)

50 
	`VLOG_EMER
(
LOG_MODULE
, "Caughàsig«»%d.", 
sig_ƒ
);

51 
	`log_backåa˚
();

52 
	`fÊush
(
°dout
);

53 
	`fÊush
(
°dîr
);

55 
	`sig«l
(
sig_ƒ
, 
SIG_DFL
);

56 
	`øi£
(
sig_ƒ
);

57 
	}
}

60 
	$log_backåa˚
()

66 **
‰ame
;

67 
	#STACK_DEPTH_LIMIT
 128

	)

68 
°ack_dïth
 = 0;

69 
‰ame
 = 
	`__buûtö_‰ame_addªss
(0);

70 
‰ame
 !
NULL
 && frame[0] != NULL

71 && 
°ack_dïth
 < 
STACK_DEPTH_LIMIT
;

72 
‰ame
 = føme[0], ++
°ack_dïth
) {

73 
Dl_öfo
 
addröfo
;

74 i‡(!
	`dœddr
(
‰ame
[1], &
addröfo
Ë|| !addröfo.
dli_¢ame
) {

75 
	`Ârötf
(
°dîr
, " 0x%08"
PRIxPTR
"\n", (
uöçå_t
Ë
‰ame
[1]);

77 
	`Ârötf
(
°dîr
, " 0x%08"
PRIxPTR
" (%s+%zu)\n",

78 (
uöçå_t
Ë
‰ame
[1], 
addröfo
.
dli_¢ame
,

79 (*Ë
‰ame
[1] - (*Ë
addröfo
.
dli_ßddr
);

82 
	`fÊush
(
°dîr
);

83 
	}
}

86 
	$ªgi°î_Áu…_h™dÀrs
()

88 
	`sig«l
(
SIGABRT
, 
Áu…_h™dÀr
);

89 
	`sig«l
(
SIGBUS
, 
Áu…_h™dÀr
);

90 
	`sig«l
(
SIGFPE
, 
Áu…_h™dÀr
);

91 
	`sig«l
(
SIGILL
, 
Áu…_h™dÀr
);

92 
	`sig«l
(
SIGSEGV
, 
Áu…_h™dÀr
);

93 
	}
}

	@lib/fault.h

34 #i‚de‡
FAULT_H


35 
	#FAULT_H
 1

	)

37 
ªgi°î_Áu…_h™dÀrs
();

38 
log_backåa˚
();

	@lib/flow.c

33 
	~<c⁄fig.h
>

34 
	~<sys/ty≥s.h
>

35 
	~"Êow.h
"

36 
	~<öây≥s.h
>

37 
	~<√töë/ö.h
>

38 
	~<°rög.h
>

39 
	~"compûî.h
"

40 
	~"hash.h
"

41 
	~"oÂbuf.h
"

42 
	~"›íÊow/›íÊow.h
"

43 
	~"∑ckës.h
"

45 
	~"vlog.h
"

46 
	#THIS_MODULE
 
VLM_Êow


	)

48 
¨p_ëh_hódî
 *

49 
	$puŒ_¨p
(
oÂbuf
 *
∑ckë
)

51 i‡(
∑ckë
->
size
 >
ARP_ETH_HEADER_LEN
) {

52  
	`oÂbuf_puŒ
(
∑ckë
, 
ARP_ETH_HEADER_LEN
);

54  
NULL
;

55 
	}
}

57 
ù_hódî
 *

58 
	$puŒ_ù
(
oÂbuf
 *
∑ckë
)

60 i‡(
∑ckë
->
size
 >
IP_HEADER_LEN
) {

61 
ù_hódî
 *
ù
 = 
∑ckë
->
d©a
;

62 
ù_Àn
 = 
	`IP_IHL
(
ù
->
ù_ihl_vî
) * 4;

63 i‡(
ù_Àn
 >
IP_HEADER_LEN
 && 
∑ckë
->
size
 >= ip_len) {

64  
	`oÂbuf_puŒ
(
∑ckë
, 
ù_Àn
);

67  
NULL
;

68 
	}
}

70 
t˝_hódî
 *

71 
	$puŒ_t˝
(
oÂbuf
 *
∑ckë
)

73 i‡(
∑ckë
->
size
 >
TCP_HEADER_LEN
) {

74 
t˝_hódî
 *
t˝
 = 
∑ckë
->
d©a
;

75 
t˝_Àn
 = 
	`TCP_OFFSET
(
t˝
->
t˝_˘l
) * 4;

76 i‡(
t˝_Àn
 >
TCP_HEADER_LEN
 && 
∑ckë
->
size
 >=Åcp_len) {

77  
	`oÂbuf_puŒ
(
∑ckë
, 
t˝_Àn
);

80  
NULL
;

81 
	}
}

83 
udp_hódî
 *

84 
	$puŒ_udp
(
oÂbuf
 *
∑ckë
)

86  
	`oÂbuf_åy_puŒ
(
∑ckë
, 
UDP_HEADER_LEN
);

87 
	}
}

89 
icmp_hódî
 *

90 
	$puŒ_icmp
(
oÂbuf
 *
∑ckë
)

92  
	`oÂbuf_åy_puŒ
(
∑ckë
, 
ICMP_HEADER_LEN
);

93 
	}
}

95 
ëh_hódî
 *

96 
	$puŒ_ëh
(
oÂbuf
 *
∑ckë
)

98  
	`oÂbuf_åy_puŒ
(
∑ckë
, 
ETH_HEADER_LEN
);

99 
	}
}

101 
vœn_hódî
 *

102 
	$puŒ_vœn
(
oÂbuf
 *
∑ckë
)

104  
	`oÂbuf_åy_puŒ
(
∑ckë
, 
VLAN_HEADER_LEN
);

105 
	}
}

109 
	$Êow_exåa˘
(
oÂbuf
 *
∑ckë
, 
uöt32_t
 
ö_p‹t
, 
Êow
 *flow)

111 
oÂbuf
 
b
 = *
∑ckë
;

112 
ëh_hódî
 *
ëh
;

113 
ªtvÆ
 = 0;

115 
	`mem£t
(
Êow
, 0,  *flow);

116 
Êow
->
dl_vœn
 = 
	`ht⁄s
(
OFPVID_NONE
);

117 
Êow
->
ö_p‹t
 = 
	`ht⁄l
(in_port);

119 
∑ckë
->
l2
 = 
b
.
d©a
;

120 
∑ckë
->
l3
 = 
NULL
;

121 
∑ckë
->
l4
 = 
NULL
;

122 
∑ckë
->
l7
 = 
NULL
;

124 
ëh
 = 
	`puŒ_ëh
(&
b
);

125 i‡(
ëh
) {

126 i‡(
	`¡ohs
(
ëh
->
ëh_ty≥
) >= 0x600) {

128 
Êow
->
dl_ty≥
 = 
ëh
->
ëh_ty≥
;

131 
Œc_hódî
 *
Œc
 = 
	`oÂbuf_©
(&
b
, 0,  *llc);

132 
¢≠_hódî
 *
¢≠
 = 
	`oÂbuf_©
(&
b
,  *
Œc
,

133  *
¢≠
);

134 i‡(
Œc
 =
NULL
) {

137 i‡(
¢≠


138 && 
Œc
->
Œc_dßp
 =
LLC_DSAP_SNAP


139 && 
Œc
->
Œc_sßp
 =
LLC_SSAP_SNAP


140 && 
Œc
->
Œc_˙é
 =
LLC_CNTL_SNAP


141 && !
	`memcmp
(
¢≠
->
¢≠_‹g
, 
SNAP_ORG_ETHERNET
,

142  
¢≠
->
¢≠_‹g
)) {

143 
Êow
->
dl_ty≥
 = 
¢≠
->
¢≠_ty≥
;

144 
	`oÂbuf_puŒ
(&
b
, 
LLC_SNAP_HEADER_LEN
);

146 
Êow
->
dl_ty≥
 = 
	`ht⁄s
(0x05ff);

147 
	`oÂbuf_puŒ
(&
b
, (
Œc_hódî
));

152 i‡(
Êow
->
dl_ty≥
 =
	`ht⁄s
(
ETH_TYPE_VLAN
)) {

153 
vœn_hódî
 *
vh
 = 
	`puŒ_vœn
(&
b
);

154 i‡(
vh
) {

155 
Êow
->
dl_ty≥
 = 
vh
->
vœn_√xt_ty≥
;

156 
Êow
->
dl_vœn
 = 
vh
->
vœn_tci
 & 
	`ht⁄s
(
VLAN_VID_MASK
);

157 
Êow
->
dl_vœn_p˝
 = (
uöt8_t
)((
	`¡ohs
(
vh
->
vœn_tci
Ë>> 
VLAN_PCP_SHIFT
)

158 & 
VLAN_PCP_BITMASK
);

161 
	`mem˝y
(
Êow
->
dl_§c
, 
ëh
->
ëh_§c
, 
ETH_ADDR_LEN
);

162 
	`mem˝y
(
Êow
->
dl_d°
, 
ëh
->
ëh_d°
, 
ETH_ADDR_LEN
);

164 
∑ckë
->
l3
 = 
b
.
d©a
;

165 i‡(
Êow
->
dl_ty≥
 =
	`ht⁄s
(
ETH_TYPE_IP
)) {

166 c⁄° 
ù_hódî
 *
nh
 = 
	`puŒ_ù
(&
b
);

167 i‡(
nh
) {

168 
Êow
->
nw_tos
 = 
nh
->
ù_tos
 & 0xfc;

169 
Êow
->
nw_¥Ÿo
 = 
nh
->
ù_¥Ÿo
;

170 
Êow
->
nw_§c
 = 
nh
->
ù_§c
;

171 
Êow
->
nw_d°
 = 
nh
->
ù_d°
;

172 
∑ckë
->
l4
 = 
b
.
d©a
;

173 i‡(!
	`IP_IS_FRAGMENT
(
nh
->
ù_‰ag_off
)) {

174 i‡(
Êow
->
nw_¥Ÿo
 =
IP_TYPE_TCP
) {

175 c⁄° 
t˝_hódî
 *
t˝
 = 
	`puŒ_t˝
(&
b
);

176 i‡(
t˝
) {

177 
Êow
->
ç_§c
 = 
t˝
->
t˝_§c
;

178 
Êow
->
ç_d°
 = 
t˝
->
t˝_d°
;

179 
∑ckë
->
l7
 = 
b
.
d©a
;

183 
Êow
->
nw_¥Ÿo
 = 0;

185 } i‡(
Êow
->
nw_¥Ÿo
 =
IP_TYPE_UDP
) {

186 c⁄° 
udp_hódî
 *
udp
 = 
	`puŒ_udp
(&
b
);

187 i‡(
udp
) {

188 
Êow
->
ç_§c
 = 
udp
->
udp_§c
;

189 
Êow
->
ç_d°
 = 
udp
->
udp_d°
;

190 
∑ckë
->
l7
 = 
b
.
d©a
;

194 
Êow
->
nw_¥Ÿo
 = 0;

196 } i‡(
Êow
->
nw_¥Ÿo
 =
IP_TYPE_ICMP
) {

197 c⁄° 
icmp_hódî
 *
icmp
 = 
	`puŒ_icmp
(&
b
);

198 i‡(
icmp
) {

199 
Êow
->
ç_§c
 = 
	`ht⁄s
(
icmp
->
icmp_ty≥
);

200 
Êow
->
ç_d°
 = 
	`ht⁄s
(
icmp
->
icmp_code
);

201 
∑ckë
->
l7
 = 
b
.
d©a
;

205 
Êow
->
nw_¥Ÿo
 = 0;

209 
ªtvÆ
 = 1;

212 } i‡(
Êow
->
dl_ty≥
 =
	`ht⁄s
(
ETH_TYPE_ARP
)) {

213 
¨p_ëh_hódî
 *
¨p
 = 
	`puŒ_¨p
(&
b
);

214 i‡(
¨p
) {

215 i‡(
¨p
->
¨_¥o
 =
	`ht⁄s
(
ARP_PRO_IP
Ë&&áΩ->
¨_∂n
 =
IP_ADDR_LEN
) {

216 
Êow
->
nw_§c
 = 
¨p
->
¨_•a
;

217 
Êow
->
nw_d°
 = 
¨p
->
¨_ça
;

219 
Êow
->
nw_¥Ÿo
 = 
	`¡ohs
(
¨p
->
¨_›
) & 0xff;

223  
ªtvÆ
;

224 
	}
}

227 
	$Êow_¥öt
(
FILE
 *
°ªam
, c⁄° 
Êow
 *flow)

229 
	`Ârötf
(
°ªam
,

230 "p‹à%04x vœn-vid %04x vœn-p˝ %02x src-ma¯"
ETH_ADDR_FMT
" "

231 "d°-ma¯"
ETH_ADDR_FMT
" frm-type %04x ip-tos %02x ip-proto %02x "

232 "§c-ù "
IP_FMT
" dst-ip "IP_FMT"Åp-src %dÅp-dst %d",

233 
	`¡ohs
(
Êow
->
ö_p‹t
),Çtohs(Êow->
dl_vœn
), flow->
dl_vœn_p˝
,

234 
	`ETH_ADDR_ARGS
(
Êow
->
dl_§c
), ETH_ADDR_ARGS(Êow->
dl_d°
),

235 
	`¡ohs
(
Êow
->
dl_ty≥
),

236 
Êow
->
nw_tos
, flow->
nw_¥Ÿo
,

237 
	`IP_ARGS
(&
Êow
->
nw_§c
), IP_ARGS(&Êow->
nw_d°
),

238 
	`¡ohs
(
Êow
->
ç_§c
),Çtohs(Êow->
ç_d°
));

239 
	}
}

	@lib/flow.h

33 #i‚de‡
FLOW_H


34 
	#FLOW_H
 1

	)

36 
	~<°dboﬁ.h
>

37 
	~<°döt.h
>

38 
	~<°rög.h
>

39 
	~"hash.h
"

40 
	~"utû.h
"

42 
	goÂ_m©ch
;

43 
	goÂbuf
;

49 
	sÊow
 {

50 
uöt32_t
 
	mnw_§c
;

51 
uöt32_t
 
	mnw_d°
;

52 
uöt32_t
 
	mö_p‹t
;

53 
uöt16_t
 
	mdl_vœn
;

54 
uöt16_t
 
	mdl_ty≥
;

55 
uöt16_t
 
	mç_§c
;

56 
uöt16_t
 
	mç_d°
;

57 
uöt8_t
 
	mdl_§c
[6];

58 
uöt8_t
 
	mdl_d°
[6];

59 
uöt8_t
 
	mdl_vœn_p˝
;

60 
uöt8_t
 
	mnw_tos
;

61 
uöt8_t
 
	mnw_¥Ÿo
;

62 
uöt8_t
 
	m∑d
[5];

64 
BUILD_ASSERT_DECL
((
Êow
) == 40);

66 
Êow_exåa˘
(
oÂbuf
 *, 
uöt32_t
 
ö_p‹t
, 
Êow
 *);

68 
Êow_¥öt
(
FILE
 *, c⁄° 
Êow
 *);

69 
ölöe
 
Êow_com∑ª
(c⁄° 
Êow
 *, const flow *);

70 
ölöe
 
boﬁ
 
Êow_equÆ
(c⁄° 
Êow
 *, const flow *);

71 
ölöe
 
size_t
 
Êow_hash
(c⁄° 
Êow
 *, 
uöt32_t
 
basis
);

73 
ölöe
 

74 
	$Êow_com∑ª
(c⁄° 
Êow
 *
a
, c⁄° Êow *
b
)

76  
	`memcmp
(
a
, 
b
,  *a);

77 
	}
}

79 
ölöe
 
boﬁ


80 
	$Êow_equÆ
(c⁄° 
Êow
 *
a
, c⁄° Êow *
b
)

82  !
	`Êow_com∑ª
(
a
, 
b
);

83 
	}
}

85 
ölöe
 
size_t


86 
	$Êow_hash
(c⁄° 
Êow
 *Êow, 
uöt32_t
 
basis
)

88 
	`BUILD_ASSERT_DECL
(!( *
Êow
 % (
uöt32_t
)));

89  
	`hash_w‹ds
((c⁄° 
uöt32_t
 *Ë
Êow
,

90  *
Êow
 / (
uöt32_t
), 
basis
);

91 
	}
}

	@lib/hash.c

16 
	~"hash.h
"

17 
	~<°rög.h
>

21 
uöt32_t


22 
	$hash_w‹ds
(c⁄° 
uöt32_t
 *
p
, 
size_t
 
n
, uöt32_à
basis
)

24 
uöt32_t
 
a
, 
b
, 
c
;

26 
a
 = 
b
 = 
c
 = 0xdódbì‡+ (((
uöt32_t
Ë
n
Ë<< 2Ë+ 
basis
;

28 
n
 > 3) {

29 
a
 +
p
[0];

30 
b
 +
p
[1];

31 
c
 +
p
[2];

32 
	`HASH_MIX
(
a
, 
b
, 
c
);

33 
n
 -= 3;

34 
p
 += 3;

37 
n
) {

39 
c
 +
p
[2];

42 
b
 +
p
[1];

45 
a
 +
p
[0];

46 
	`HASH_FINAL
(
a
, 
b
, 
c
);

51  
c
;

52 
	}
}

55 
uöt32_t


56 
	$hash_3w‹ds
(
uöt32_t
 
a
, uöt32_à
b
, uöt32_à
c
)

58 
a
 += 0xdeadbeef;

59 
b
 += 0xdeadbeef;

60 
c
 += 0xdeadbeef;

61 
	`HASH_FINAL
(
a
, 
b
, 
c
);

62  
c
;

63 
	}
}

66 
uöt32_t


67 
	$hash_2w‹ds
(
uöt32_t
 
a
, uöt32_à
b
)

69  
	`hash_3w‹ds
(
a
, 
b
, 0);

70 
	}
}

73 
uöt32_t


74 
	$hash_byãs
(c⁄° *
p_
, 
size_t
 
n
, 
uöt32_t
 
basis
)

76 c⁄° 
uöt8_t
 *
p
 = 
p_
;

77 
uöt32_t
 
a
, 
b
, 
c
;

78 
uöt32_t
 
tmp
[3];

80 
a
 = 
b
 = 
c
 = 0xdódbì‡+ 
n
 + 
basis
;

82 
n
 > 
tmp
) {

83 
	`mem˝y
(
tmp
, 
p
, Åmp);

84 
a
 +
tmp
[0];

85 
b
 +
tmp
[1];

86 
c
 +
tmp
[2];

87 
	`HASH_MIX
(
a
, 
b
, 
c
);

88 
n
 - 
tmp
;

89 
p
 + 
tmp
;

92 i‡(
n
) {

93 
tmp
[0] =Åmp[1] =Åmp[2] = 0;

94 
	`mem˝y
(
tmp
, 
p
, 
n
);

95 
a
 +
tmp
[0];

96 
b
 +
tmp
[1];

97 
c
 +
tmp
[2];

98 
	`HASH_FINAL
(
a
, 
b
, 
c
);

101  
c
;

102 
	}
}

	@lib/hash.h

16 #i‚de‡
HASH_H


17 
	#HASH_H
 1

	)

19 
	~<°dboﬁ.h
>

20 
	~<°ddef.h
>

21 
	~<°döt.h
>

22 
	~<°rög.h
>

23 
	~"utû.h
"

28 
	#HASH_ROT
(
x
, 
k
Ë(((xË<< (k)Ë| ((xË>> (32 - (k))))

	)

30 
	#HASH_MIX
(
a
, 
b
, 
c
) \

32 
a
 -
c
;á ^
	`HASH_ROT
(c, 4); c +
b
; \

33 
b
 -
a
; b ^
	`HASH_ROT
◊, 6);á +
c
; \

34 
c
 -
b
; c ^
	`HASH_ROT
(b, 8); b +
a
; \

35 
a
 -
c
;á ^
	`HASH_ROT
(c, 16); c +
b
; \

36 
b
 -
a
; b ^
	`HASH_ROT
◊, 19);á +
c
; \

37 
c
 -
b
; c ^
	`HASH_ROT
(b, 4); b +
a
; \

38 } 0)

	)

40 
	#HASH_FINAL
(
a
, 
b
, 
c
) \

42 
c
 ^
b
; c -
	`HASH_ROT
(b, 14); \

43 
a
 ^
c
;á -
	`HASH_ROT
(c, 11); \

44 
b
 ^
a
; b -
	`HASH_ROT
(a, 25); \

45 
c
 ^
b
; c -
	`HASH_ROT
(b, 16); \

46 
a
 ^
c
;á -
	`HASH_ROT
(c, 4); \

47 
b
 ^
a
; b -
	`HASH_ROT
(a, 14); \

48 
c
 ^
b
; c -
	`HASH_ROT
(b, 24); \

49 } 0)

	)

51 
uöt32_t
 
hash_w‹ds
(c⁄° uöt32_à*, 
size_t
 
n_w‹d
, uöt32_à
basis
);

52 
uöt32_t
 
hash_2w‹ds
(uint32_t, uint32_t);

53 
uöt32_t
 
hash_3w‹ds
(uint32_t, uint32_t, uint32_t);

54 
uöt32_t
 
hash_byãs
(c⁄° *, 
size_t
 
n_byãs
, uöt32_à
basis
);

56 
ölöe
 
uöt32_t
 
	$hash_°rög
(c⁄° *
s
, 
uöt32_t
 
basis
)

58  
	`hash_byãs
(
s
, 
	`°æí
(s), 
basis
);

59 
	}
}

67 
ölöe
 
uöt32_t
 
	$hash_öt
(
uöt32_t
 
x
, uöt32_à
basis
)

69 
x
 -= x << 6;

70 
x
 ^= x >> 17;

71 
x
 -= x << 9;

72 
x
 ^= x << 4;

73 
x
 +
basis
;

74 
x
 -= x << 3;

75 
x
 ^= x << 10;

76 
x
 ^= x >> 15;

77  
x
;

78 
	}
}

80 
ölöe
 
uöt32_t
 
	$hash_doubÀ
(
x
, 
uöt32_t
 
basis
)

82 
uöt32_t
 
vÆue
[2];

83 
	`BUILD_ASSERT_DECL
( 
x
 = 
vÆue
);

85 
	`mem˝y
(
vÆue
, &
x
,  value);

86  
	`hash_3w‹ds
(
vÆue
[0], vÆue[1], 
basis
);

87 
	}
}

89 
ölöe
 
uöt32_t
 
	$hash_poöãr
(c⁄° *
p
, 
uöt32_t
 
basis
)

99  
	`hash_öt
((
uöt32_t
Ë(
uöçå_t
Ë
p
, 
basis
);

100 
	}
}

	@lib/hmap.c

34 
	~<c⁄fig.h
>

35 
	~"hm≠.h
"

36 
	~<as£π.h
>

37 
	~<°döt.h
>

38 
	~"utû.h
"

42 
	$hm≠_öô
(
hm≠
 *hmap)

44 
hm≠
->
buckës
 = &hm≠->
⁄e
;

45 
hm≠
->
⁄e
 = 
NULL
;

46 
hm≠
->
mask
 = 0;

47 
hm≠
->
n
 = 0;

48 
	}
}

53 
	$hm≠_de°roy
(
hm≠
 *hmap)

55 i‡(
hm≠
 && hm≠->
buckës
 !&hm≠->
⁄e
) {

56 
	`‰ì
(
hm≠
->
buckës
);

58 
	}
}

62 
	$hm≠_sw≠
(
hm≠
 *
a
, hm≠ *
b
)

64 
hm≠
 
tmp
 = *
a
;

65 *
a
 = *
b
;

66 *
b
 = 
tmp
;

67 i‡(
a
->
buckës
 =&
b
->
⁄e
) {

68 
a
->
buckës
 = &a->
⁄e
;

70 i‡(
b
->
buckës
 =&
a
->
⁄e
) {

71 
b
->
buckës
 = &b->
⁄e
;

73 
	}
}

76 
	$ªsize
(
hm≠
 *hm≠, 
size_t
 
√w_mask
)

78 
hm≠
 
tmp
;

79 
size_t
 
i
;

81 
	`as£π
(!(
√w_mask
 & (new_mask + 1)));

82 
	`as£π
(
√w_mask
 !
SIZE_MAX
);

84 
	`hm≠_öô
(&
tmp
);

85 i‡(
√w_mask
) {

86 
tmp
.
buckës
 = 
	`xmÆloc
( *tmp.buckë†* (
√w_mask
 + 1));

87 
tmp
.
mask
 = 
√w_mask
;

88 
i
 = 0; i <
tmp
.
mask
; i++) {

89 
tmp
.
buckës
[
i
] = 
NULL
;

92 
i
 = 0; i <
hm≠
->
mask
; i++) {

93 
hm≠_node
 *
node
, *
√xt
;

94 
node
 = 
hm≠
->
buckës
[
i
];Çode;Çodê
√xt
) {

95 
√xt
 = 
node
->next;

96 
	`hm≠_ö£π_Á°
(&
tmp
, 
node
,Çode->
hash
);

99 
	`hm≠_sw≠
(
hm≠
, &
tmp
);

100 
	`hm≠_de°roy
(&
tmp
);

101 
	}
}

103 
size_t


104 
	$ˇlc_mask
(
size_t
 
ˇ∑côy
)

106 
size_t
 
mask
 = 
ˇ∑côy
 / 2;

107 
mask
 |= mask >> 1;

108 
mask
 |= mask >> 2;

109 
mask
 |= mask >> 4;

110 
mask
 |= mask >> 8;

111 
mask
 |= mask >> 16;

112 #i‡
SIZE_MAX
 > 
UINT32_MAX


113 
mask
 |= mask >> 32;

118 
mask
 |= (mask & 1) << 1;

120  
mask
;

121 
	}
}

125 
	$hm≠_ex∑nd
(
hm≠
 *hmap)

127 
size_t
 
√w_mask
 = 
	`ˇlc_mask
(
hm≠
->
n
);

128 i‡(
√w_mask
 > 
hm≠
->
mask
) {

129 
	`ªsize
(
hm≠
, 
√w_mask
);

131 
	}
}

135 
	$hm≠_shrök
(
hm≠
 *hmap)

137 
size_t
 
√w_mask
 = 
	`ˇlc_mask
(
hm≠
->
n
);

138 i‡(
√w_mask
 < 
hm≠
->
mask
) {

139 
	`ªsize
(
hm≠
, 
√w_mask
);

141 
	}
}

143 
	$hm≠_ªmove_™d_shrök
(
hm≠
 *hm≠, 
hm≠_node
 *
node
){

144 
	`hm≠_ªmove
(
hm≠
, 
node
);

146 
	}
}

152 
	$hm≠_ª£rve
(
hm≠
 *hm≠, 
size_t
 
n
)

154 
size_t
 
√w_mask
 = 
	`ˇlc_mask
(
n
);

155 i‡(
√w_mask
 > 
hm≠
->
mask
) {

156 
	`ªsize
(
hm≠
, 
√w_mask
);

158 
	}
}

	@lib/hmap.h

34 #i‚de‡
HMAP_H


35 
	#HMAP_H
 1

	)

37 
	~<°dboﬁ.h
>

38 
	~<°dlib.h
>

39 
	~"utû.h
"

42 
	shm≠_node
 {

43 
size_t
 
	mhash
;

44 
hm≠_node
 *
	m√xt
;

48 
ölöe
 
size_t
 
	$hm≠_node_hash
(c⁄° 
hm≠_node
 *
node
)

50  
node
->
hash
;

51 
	}
}

54 
	shm≠
 {

55 
hm≠_node
 **
	mbuckës
;

56 
hm≠_node
 *
	m⁄e
;

57 
size_t
 
	mmask
;

58 
size_t
 
	mn
;

62 
	#HMAP_INITIALIZER
(
HMAP
Ë{ &(HMAP)->
⁄e
, 
NULL
, 0, 0 }

	)

64 
	#HMAP_NODE_NULL
 ((
hm≠_node
 *Ë1)

	)

65 
	#HMAP_NODE_NULL_INITIALIZER
 { 0, 
HMAP_NODE_NULL
 }

	)

69 
hm≠_öô
(
hm≠
 *);

70 
hm≠_de°roy
(
hm≠
 *);

71 
hm≠_sw≠
(
hm≠
 *
a
, hm≠ *
b
);

72 
ölöe
 
size_t
 
hm≠_cou¡
(c⁄° 
hm≠
 *);

73 
ölöe
 
boﬁ
 
hm≠_is_em±y
(c⁄° 
hm≠
 *);

76 
hm≠_ex∑nd
(
hm≠
 *);

77 
hm≠_shrök
(
hm≠
 *);

78 
hm≠_ª£rve
(
hm≠
 *, 
size_t
 
ˇ∑côy
);

81 
ölöe
 
hm≠_ö£π_Á°
(
hm≠
 *,

82 
hm≠_node
 *, 
size_t
 
hash
);

83 
ölöe
 
hm≠_ö£π
(
hm≠
 *, 
hm≠_node
 *, 
size_t
 
hash
);

84 
ölöe
 
hm≠_ªmove
(
hm≠
 *, 
hm≠_node
 *);

85 
hm≠_ªmove_™d_shrök
(
hm≠
 *hm≠, 
hm≠_node
 *
node
);

88 
	#HMAP_FOR_EACH_WITH_HASH
(
NODE
, 
STRUCT
, 
MEMBER
, 
HASH
, 
HMAP
) \

89 (
NODE
Ë
	`CONTAINER_OF
(
	`hm≠_fú°_wôh_hash
(
HMAP
, 
HASH
), \

90 
STRUCT
, 
MEMBER
); \

91 &(
NODE
)->
MEMBER
 !
NULL
; \

92 (
NODE
Ë
	`CONTAINER_OF
(
	`hm≠_√xt_wôh_hash
(&(NODE)->
MEMBER
), \

93 
STRUCT
, 
MEMBER
))

	)

95 
ölöe
 
hm≠_node
 *
hm≠_fú°_wôh_hash
(c⁄° 
hm≠
 *,

96 
size_t
 
hash
);

97 
ölöe
 
hm≠_node
 *
hm≠_√xt_wôh_hash
(const hmap_node *);

104 
	#HMAP_FOR_EACH
(
NODE
, 
STRUCT
, 
MEMBER
, 
HMAP
) \

105 (
NODE
Ë
	`CONTAINER_OF
(
	`hm≠_fú°
(
HMAP
), 
STRUCT
, 
MEMBER
); \

106 &(
NODE
)->
MEMBER
 !
NULL
; \

107 (
NODE
Ë
	`CONTAINER_OF
(
	`hm≠_√xt
(
HMAP
, &(NODE)->
MEMBER
), \

108 
STRUCT
, 
MEMBER
))

	)

110 
	#HMAP_FOR_EACH_SAFE
(
NODE
, 
NEXT
, 
STRUCT
, 
MEMBER
, 
HMAP
) \

111 (
NODE
Ë
	`CONTAINER_OF
(
	`hm≠_fú°
(
HMAP
), 
STRUCT
, 
MEMBER
); \

112 (&(
NODE
)->
MEMBER
 !
NULL
 \

113 ? (
NEXT
Ë
	`CONTAINER_OF
(
	`hm≠_√xt
(
HMAP
, &(
NODE
)->
MEMBER
), \

114 
STRUCT
, 
MEMBER
), 1 \

116 (
NODE
Ë(
NEXT
))

	)

118 
ölöe
 
hm≠_node
 *
hm≠_fú°
(c⁄° 
hm≠
 *);

119 
ölöe
 
hm≠_node
 *
hm≠_√xt
(c⁄° 
hm≠
 *,

120 c⁄° 
hm≠_node
 *);

123 
ölöe
 
size_t


124 
	$hm≠_cou¡
(c⁄° 
hm≠
 *hmap)

126  
hm≠
->
n
;

127 
	}
}

131 
ölöe
 
boﬁ


132 
	$hm≠_is_em±y
(c⁄° 
hm≠
 *hmap)

134  
hm≠
->
n
 == 0;

135 
	}
}

139 
ölöe
 

140 
	$hm≠_ö£π_Á°
(
hm≠
 *hm≠, 
hm≠_node
 *
node
, 
size_t
 
hash
)

142 
hm≠_node
 **
buckë
 = &
hm≠
->
buckës
[
hash
 & hm≠->
mask
];

143 
node
->
hash
 = hash;

144 
node
->
√xt
 = *
buckë
;

145 *
buckë
 = 
node
;

146 
hm≠
->
n
++;

147 
	}
}

151 
ölöe
 

152 
	$hm≠_ö£π
(
hm≠
 *hm≠, 
hm≠_node
 *
node
, 
size_t
 
hash
)

154 
	`hm≠_ö£π_Á°
(
hm≠
, 
node
, 
hash
);

155 i‡(
hm≠
->
n
 / 2 > hm≠->
mask
) {

156 
	`hm≠_ex∑nd
(
hm≠
);

158 
	}
}

162 
ölöe
 

163 
	$hm≠_ªmove
(
hm≠
 *hm≠, 
hm≠_node
 *
node
)

165 
hm≠_node
 **
buckë
 = &
hm≠
->
buckës
[
node
->
hash
 & hm≠->
mask
];

166 *
buckë
 !
node
) {

167 
buckë
 = &(*buckë)->
√xt
;

169 *
buckë
 = 
node
->
√xt
;

170 
hm≠
->
n
--;

171 
	}
}

173 
ölöe
 
hm≠_node
 *

174 
	$hm≠_√xt_wôh_hash__
(c⁄° 
hm≠_node
 *
node
, 
size_t
 
hash
)

176 
node
 !
NULL
 &&Çode->
hash
 != hash) {

177 
node
 =Çode->
√xt
;

179  (
hm≠_node
 *Ë
node
;

180 
	}
}

184 
ölöe
 
hm≠_node
 *

185 
	$hm≠_fú°_wôh_hash
(c⁄° 
hm≠
 *hm≠, 
size_t
 
hash
)

187  
	`hm≠_√xt_wôh_hash__
(
hm≠
->
buckës
[
hash
 & hm≠->
mask
], hash);

188 
	}
}

198 
ölöe
 
hm≠_node
 *

199 
	$hm≠_√xt_wôh_hash
(c⁄° 
hm≠_node
 *
node
)

201  
	`hm≠_√xt_wôh_hash__
(
node
->
√xt
,Çode->
hash
);

202 
	}
}

204 
ölöe
 
hm≠_node
 *

205 
	$hm≠_√xt__
(c⁄° 
hm≠
 *hm≠, 
size_t
 
°¨t
)

207 
size_t
 
i
;

208 
i
 = 
°¨t
; i <
hm≠
->
mask
; i++) {

209 
hm≠_node
 *
node
 = 
hm≠
->
buckës
[
i
];

210 i‡(
node
) {

211  
node
;

214  
NULL
;

215 
	}
}

219 
ölöe
 
hm≠_node
 *

220 
	$hm≠_fú°
(c⁄° 
hm≠
 *hmap)

222  
	`hm≠_√xt__
(
hm≠
, 0);

223 
	}
}

232 
ölöe
 
hm≠_node
 *

233 
	$hm≠_√xt
(c⁄° 
hm≠
 *hm≠, c⁄° 
hm≠_node
 *
node
)

235  (
node
->
√xt


236 ? 
node
->
√xt


237 : 
	`hm≠_√xt__
(
hm≠
, (
node
->
hash
 & hm≠->
mask
) + 1));

238 
	}
}

	@lib/ipv6_util.c

1 
	~"ùv6_utû.h
"

3 c⁄° 
ö6_addr
 
	gö6addr_exa˘
 = 
IN6ADDR_EXACT_INIT
;

5 c⁄° 
ö6_addr
 
	gö6addr_zîo
 = 
IN6ADDR_ZERO_INIT
;

11 
	$lookup_ùv6
(c⁄° *
ho°_«me
, 
ö6_addr
 *
addr
)

13 i‡(
	`öë_±⁄
(
AF_INET6
, 
ho°_«me
, 
addr
) != 1) {

14 
	`¥ötf
("%†i†nŸá vÆid IPv6áddªs†\n", 
ho°_«me
);

15  
ENOENT
;

18 
	}
}

23 
ö6_addr


24 
	$ùv6_¸óã_mask
(
mask
)

26 
ö6_addr
 
√tmask
;

27 
uöt8_t
 *
√tmaskp
 = &
√tmask
.
s6_addr
[0];

29 
	`mem£t
(&
√tmask
, 0, Çetmask);

30 
mask
 > 8) {

31 *
√tmaskp
 = 0xff;

32 
√tmaskp
++;

33 
mask
 -= 8;

36 i‡(
mask
) {

37 *
√tmaskp
 = 0xf‡<< (8 - 
mask
);

40  
√tmask
;

41 
	}
}

44 
ö6_addr
 
	$ùv6_addr_bô™d
(c⁄° 
ö6_addr
 *
a
,

45 c⁄° 
ö6_addr
 *
b
)

47 
i
;

48 
ö6_addr
 
d°
;

50 #ifde‡
s6_addr32


51 
i
=0; i<4; i++) {

52 
d°
.
s6_addr32
[
i
] = 
a
->s6_addr32[i] & 
b
->s6_addr32[i];

55 
i
=0; i<16; i++) {

56 
d°
.
s6_addr
[
i
] = 
a
->s6_addr[i] & 
b
->s6_addr[i];

60  
d°
;

61 
	}
}

65 
	$°r_to_ùv6
(c⁄° *
°r_
, 
ö6_addr
 *
addΩ
, ö6_add∏*
maskp
)

68 *
°r
 = 
	`x°rdup
(
°r_
);

69 *
ßve_±r
 = 
NULL
;

70 c⁄° *
«me
, *
√tmask
;

71 
ö6_addr
 
addr
;

72 
ªtvÆ
;

74 
«me
 = 
	`°πok_r
(
°r
, "/", &
ßve_±r
);

75 
ªtvÆ
 = 
«me
 ? 
	`lookup_ùv6
“ame, &
addr
Ë: 
EINVAL
;

76 i‡(
ªtvÆ
) {

77 
	`¥ötf
("%s: couldÇŸ c⁄vîàtÿIPv6áddªss\n", 
°r
);

81 
√tmask
 = 
	`°πok_r
(
NULL
, "/", &
ßve_±r
);

82 i‡(
√tmask
) {

83 
¥efix
 = 
	`©oi
(
√tmask
);

84 i‡(
¥efix
 <= 0 ||Örefix > 128) {

85 
	`¥ötf
("%s:ÇetworkÖrefix bitsÇot between 1ánd 128\n",

86 
°r
);

89 *
maskp
 = 
	`ùv6_¸óã_mask
(
¥efix
);

90 *
addΩ
 = 
	`ùv6_addr_bô™d
(&
addr
, &
ö6addr_exa˘
);

94 *
maskp
 = 
ö6addr_zîo
 ;

95 *
addΩ
 = 
	`ùv6_addr_bô™d
(&
addr
, &
ö6addr_exa˘
);

98 
	`‰ì
(
°r
);

100 
	}
}

	@lib/ipv6_util.h

1 #i‚de‡
IPV6_UTIL_H


2 
	#IPV6_UTIL_H
 1

	)

4 
	~<¨∑/öë.h
>

5 
	~<î∫o.h
>

6 
	~<f˙é.h
>

7 
	~<√tdb.h
>

8 
	~<°dio.h
>

9 
	~<°dlib.h
>

10 
	~<°rög.h
>

11 
	~<sys/ªsour˚.h
>

12 
	~<sys/sockë.h
>

13 
	~<sys/°©.h
>

14 
	~<sys/un.h
>

15 
	~"utû.h
"

16 
	~<uni°d.h
>

19 
	#IN6ADDR_EXACT_INIT
 { { { 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff, \

20 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf‡} } }

	)

22 
	#IN6ADDR_ZERO_INIT
 { { { 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, \

23 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 } } }

	)

25 c⁄° 
ö6_addr
 
ö6addr_exa˘
;

27 
ölöe
 
boﬁ
 
	$ùv6_addr_equÆs
(c⁄° 
ö6_addr
 *
a
,

28 c⁄° 
ö6_addr
 *
b
)

30 #ifde‡
IN6_ARE_ADDR_EQUAL


31  
	`IN6_ARE_ADDR_EQUAL
(
a
, 
b
);

33  !
	`memcmp
(
a
, 
b
, (*a));

35 
	}
}

37 
ölöe
 
boﬁ
 
	$ùv6_mask_is_exa˘
(c⁄° 
ö6_addr
 *
mask
) {

38  
	`ùv6_addr_equÆs
(
mask
, &
ö6addr_exa˘
);

39 
	}
}

42 
°r_to_ùv6
(c⁄° *
°r_
, 
ö6_addr
 *
addΩ
, ö6_add∏*
maskp
);

	@lib/leak-checker.c

34 
	~<c⁄fig.h
>

35 
	~"Àak-checkî.h
"

36 
	~<öây≥s.h
>

37 
	~"backåa˚.h
"

39 
	#LOG_MODULE
 
VLM_Àak_checkî


	)

40 
	~"vlog.h
"

42 #i‚de‡
HAVE_MALLOC_HOOKS


44 
	$Àak_checkî_°¨t
(c⁄° *
fûe_«me
 
UNUSED
)

46 
	`VLOG_WARN
(
LOG_MODULE
, "notÉnablingÜeak checker becauseÅheÜibc in use doesÇot "

48 
	}
}

51 
	$Àak_checkî_£t_limô
(
off_t
 
max_size
 
UNUSED
)

53 
	}
}

56 
	$Àak_checkî_˛aim
(c⁄° *
p
 
UNUSED
)

58 
	}
}

61 
	$Àak_checkî_ußge
()

63 
	`¥ötf
(" --check-leaks=FILE (accepted but ignored inÅhis build)\n");

64 
	}
}

66 
	~<î∫o.h
>

67 
	~<f˙é.h
>

68 
	~<mÆloc.h
>

69 
	~<sys/°©.h
>

71 *
	tmÆloc_hook_ty≥
(
	tsize_t
, const *);

72 *
	tªÆloc_hook_ty≥
(*, 
	tsize_t
, const *);

73 
	t‰ì_hook_ty≥
(*, const *);

75 
	shooks
 {

76 
mÆloc_hook_ty≥
 *
	mmÆloc_hook_func
;

77 
ªÆloc_hook_ty≥
 *
	mªÆloc_hook_func
;

78 
‰ì_hook_ty≥
 *
	m‰ì_hook_func
;

81 
mÆloc_hook_ty≥
 
	ghook_mÆloc
;

82 
ªÆloc_hook_ty≥
 
	ghook_ªÆloc
;

83 
‰ì_hook_ty≥
 
	ghook_‰ì
;

85 
hooks
 
	glibc_hooks
;

86 c⁄° 
hooks
 
	gour_hooks
 = { 
hook_mÆloc
, 
hook_ªÆloc
, 
hook_‰ì
 };

88 
FILE
 *
	gfûe
;

89 
off_t
 
	glimô
 = 10 * 1000 * 1000;

92 
	$gë_hooks
(
hooks
 *hooks)

94 
hooks
->
mÆloc_hook_func
 = 
__mÆloc_hook
;

95 
hooks
->
ªÆloc_hook_func
 = 
__ªÆloc_hook
;

96 
hooks
->
‰ì_hook_func
 = 
__‰ì_hook
;

97 
	}
}

100 
	$£t_hooks
(c⁄° 
hooks
 *hooks)

102 
__mÆloc_hook
 = 
hooks
->
mÆloc_hook_func
;

103 
__ªÆloc_hook
 = 
hooks
->
ªÆloc_hook_func
;

104 
__‰ì_hook
 = 
hooks
->
‰ì_hook_func
;

105 
	}
}

108 
	$Àak_checkî_°¨t
(c⁄° *
fûe_«me
)

110 i‡(!
fûe
) {

111 
fûe
 = 
	`f›í
(
fûe_«me
, "w");

112 i‡(!
fûe
) {

113 
	`VLOG_WARN
(
LOG_MODULE
, "failedÅo create \"%s\": %s",

114 
fûe_«me
, 
	`°ªº‹
(
î∫o
));

117 
	`£tvbuf
(
fûe
, 
NULL
, 
_IONBF
, 0);

118 
	`VLOG_WARN
(
LOG_MODULE
, "íabÀd mem‹yÜókÜoggögÅÿ\"%s\"", 
fûe_«me
);

119 
	`gë_hooks
(&
libc_hooks
);

120 
	`£t_hooks
(&
our_hooks
);

122 
	}
}

125 
	$Àak_checkî_°›
()

127 i‡(
fûe
) {

128 
	`f˛o£
(
fûe
);

129 
fûe
 = 
NULL
;

130 
	`£t_hooks
(&
libc_hooks
);

131 
	`VLOG_WARN
(
LOG_MODULE
, "disabled memoryÜeakÜogging");

133 
	}
}

136 
	$Àak_checkî_£t_limô
(
off_t
 
limô_
)

138 
limô
 = 
limô_
;

139 
	}
}

142 
	$Àak_checkî_ußge
()

144 
	`¥ötf
(" --check-leaks=FILEÜog mallocánd free callsÅo FILE\n");

145 
	}
}

147 
	$PRINTF_FORMAT
(1, 2)

148 
	$log_ˇŒîs
(c⁄° *
f‹m©
, ...)

150 
backåa˚
 backtrace;

151 
va_li°
 
¨gs
;

152 
i
;

154 
	`va_°¨t
(
¨gs
, 
f‹m©
);

155 
	`vÂrötf
(
fûe
, 
f‹m©
, 
¨gs
);

156 
	`va_íd
(
¨gs
);

158 
	`putc
(':', 
fûe
);

159 
	`backåa˚_ˇ±uª
(&
backåa˚
);

160 
i
 = 0; i < 
backåa˚
.
n_‰ames
; i++) {

161 
	`Ârötf
(
fûe
, " 0x%"
PRIxPTR
"", 
backåa˚
.
‰ames
[
i
]);

163 
	`putc
('\n', 
fûe
);

164 
	}
}

167 
	$ª£t_hooks
()

169 
cou¡
;

171 i‡(
cou¡
++ >100 && 
limô
 && 
fûe
) {

172 
°©
 
s
;

173 
cou¡
 = 0;

174 i‡(
	`f°©
(
	`fûío
(
fûe
), &
s
) < 0) {

175 
	`VLOG_WARN
(
LOG_MODULE
, "cannot fstatÜeak checkerÜog file: %s",

176 
	`°ªº‹
(
î∫o
));

179 i‡(
s
.
°_size
 > 
limô
) {

180 
	`VLOG_WARN
(
LOG_MODULE
, "leak checkerÜog file sizeÉxceededÜimit");

181 
	`Àak_checkî_°›
();

185 i‡(
fûe
) {

186 
	`£t_hooks
(&
our_hooks
);

188 
	}
}

191 
	$hook_mÆloc
(
size_t
 
size
, c⁄° *
ˇŒî
 
UNUSED
)

193 *
p
;

195 
	`£t_hooks
(&
libc_hooks
);

196 
p
 = 
	`mÆloc
(
size
);

197 
	`gë_hooks
(&
libc_hooks
);

199 
	`log_ˇŒîs
("mÆloc(%zuË-> %p", 
size
, 
p
);

201 
	`ª£t_hooks
();

202  
p
;

203 
	}
}

206 
	$Àak_checkî_˛aim
(c⁄° *
p
)

208 i‡(!
fûe
) {

212 i‡(
p
) {

213 
	`£t_hooks
(&
libc_hooks
);

214 
	`log_ˇŒîs
("˛aim(%p)", 
p
);

215 
	`ª£t_hooks
();

217 
	}
}

220 
	$hook_‰ì
(*
p
, c⁄° *
ˇŒî
 
UNUSED
)

222 i‡(!
p
) {

226 
	`£t_hooks
(&
libc_hooks
);

227 
	`‰ì
(
p
);

228 
	`gë_hooks
(&
libc_hooks
);

230 
	`log_ˇŒîs
("‰ì(%p)", 
p
);

232 
	`ª£t_hooks
();

233 
	}
}

236 
	$hook_ªÆloc
(*
p
, 
size_t
 
size
, c⁄° *
ˇŒî
 
UNUSED
)

238 *
q
;

240 
	`£t_hooks
(&
libc_hooks
);

241 
q
 = 
	`ªÆloc
(
p
, 
size
);

242 
	`gë_hooks
(&
libc_hooks
);

244 i‡(
p
 !
q
) {

245 
	`log_ˇŒîs
("ªÆloc(%p, %zuË-> %p", 
p
, 
size
, 
q
);

248 
	`ª£t_hooks
();

250  
q
;

251 
	}
}

	@lib/leak-checker.h

34 #i‚de‡
LEAK_CHECKER_H


35 
	#LEAK_CHECKER_H
 1

	)

37 
	~<sys/ty≥s.h
>

39 
	#LEAK_CHECKER_OPTION_ENUMS
 \

40 
OPT_CHECK_LEAKS
, \

41 
OPT_LEAK_LIMIT


	)

42 
	#LEAK_CHECKER_LONG_OPTIONS
 \

43 {"check-Àaks", 
ªquúed_¨gumít
, 0, 
OPT_CHECK_LEAKS
}, \

44 {"Àak-limô", 
ªquúed_¨gumít
, 0, 
OPT_LEAK_LIMIT
}

	)

45 
	#LEAK_CHECKER_OPTION_HANDLERS
 \

46 
OPT_CHECK_LEAKS
: \

47 
	`Àak_checkî_°¨t
(
›èrg
); \

49 
OPT_LEAK_LIMIT
: \

50 
	`Àak_checkî_£t_limô
(
	`©ﬁ
(
›èrg
)); \

51 ;

	)

52 
Àak_checkî_°¨t
(c⁄° *
fûe_«me
);

53 
Àak_checkî_£t_limô
(
off_t
 
limô
);

54 
Àak_checkî_°›
();

55 
Àak_checkî_˛aim
(const *);

56 
Àak_checkî_ußge
();

	@lib/list.c

33 
	~<c⁄fig.h
>

34 
	~"li°.h
"

35 
	~<as£π.h
>

39 
	$li°_öô
(
li°
 *list)

41 
li°
->
√xt
 =Üi°->
¥ev
 =Üist;

42 
	}
}

46 
	$li°_ö£π
(
li°
 *
bef‹e
, li° *
ñem
)

48 
ñem
->
¥ev
 = 
bef‹e
->prev;

49 
ñem
->
√xt
 = 
bef‹e
;

50 
bef‹e
->
¥ev
->
√xt
 = 
ñem
;

51 
bef‹e
->
¥ev
 = 
ñem
;

52 
	}
}

57 
	$li°_•li˚
(
li°
 *
bef‹e
, li° *
fú°
, li° *
œ°
)

59 i‡(
fú°
 =
œ°
)

61 
œ°
 =Üa°->
¥ev
;

64 
fú°
->
¥ev
->
√xt
 = 
œ°
->next;

65 
œ°
->
√xt
->
¥ev
 = 
fú°
->prev;

68 
fú°
->
¥ev
 = 
bef‹e
->prev;

69 
œ°
->
√xt
 = 
bef‹e
;

70 
bef‹e
->
¥ev
->
√xt
 = 
fú°
;

71 
bef‹e
->
¥ev
 = 
œ°
;

72 
	}
}

77 
	$li°_push_‰⁄t
(
li°
 *li°, li° *
ñem
)

79 
	`li°_ö£π
(
li°
->
√xt
, 
ñem
);

80 
	}
}

85 
	$li°_push_back
(
li°
 *li°, li° *
ñem
)

87 
	`li°_ö£π
(
li°
, 
ñem
);

88 
	}
}

93 
	$li°_ª∂a˚
(
li°
 *
ñemít
, c⁄° li° *
posôi⁄
)

95 
ñemít
->
√xt
 = 
posôi⁄
->next;

96 
ñemít
->
√xt
->
¥ev
 =Élement;

97 
ñemít
->
¥ev
 = 
posôi⁄
->prev;

98 
ñemít
->
¥ev
->
√xt
 =Élement;

99 
	}
}

103 
li°
 *

104 
	$li°_ªmove
(
li°
 *
ñem
)

106 
ñem
->
¥ev
->
√xt
 =Élem->next;

107 
ñem
->
√xt
->
¥ev
 =Élem->prev;

108  
ñem
->
√xt
;

109 
	}
}

113 
li°
 *

114 
	$li°_p›_‰⁄t
(
li°
 *list)

116 
li°
 *
‰⁄t
 =Üi°->
√xt
;

117 
	`li°_ªmove
(
‰⁄t
);

118  
‰⁄t
;

119 
	}
}

123 
li°
 *

124 
	$li°_p›_back
(
li°
 *list)

126 
li°
 *
back
 =Üi°->
¥ev
;

127 
	`li°_ªmove
(
back
);

128  
back
;

129 
	}
}

133 
li°
 *

134 
	$li°_‰⁄t
(
li°
 *list)

136 
	`as£π
(!
	`li°_is_em±y
(
li°
));

137  
li°
->
√xt
;

138 
	}
}

142 
li°
 *

143 
	$li°_back
(
li°
 *list)

145 
	`as£π
(!
	`li°_is_em±y
(
li°
));

146  
li°
->
¥ev
;

147 
	}
}

151 
size_t


152 
	$li°_size
(c⁄° 
li°
 *list)

154 c⁄° 
li°
 *
e
;

155 
size_t
 
˙t
 = 0;

157 
e
 = 
li°
->
√xt
;É !=Üist;É =É->next)

158 
˙t
++;

159  
˙t
;

160 
	}
}

163 
boﬁ


164 
	$li°_is_em±y
(c⁄° 
li°
 *list)

166  
li°
->
√xt
 ==Üist;

167 
	}
}

	@lib/list.h

33 #i‚de‡
LIST_H


34 
	#LIST_H
 1

	)

38 
	~<°dboﬁ.h
>

39 
	~<°ddef.h
>

40 
	~"utû.h
"

43 
	sli°


45 
li°
 *
	m¥ev
;

46 
li°
 *
	m√xt
;

49 
	#LIST_INITIALIZER
(
LIST
Ë{ LIST, LIST }

	)

51 
li°_öô
(
li°
 *);

54 
li°_ö£π
(
li°
 *, list *);

55 
li°_•li˚
(
li°
 *
bef‹e
, li° *
fú°
, li° *
œ°
);

56 
li°_push_‰⁄t
(
li°
 *, list *);

57 
li°_push_back
(
li°
 *, list *);

58 
li°_ª∂a˚
(
li°
 *, const list *);

61 
li°
 *
li°_ªmove
(list *);

62 
li°
 *
li°_p›_‰⁄t
(list *);

63 
li°
 *
li°_p›_back
(list *);

66 
li°
 *
li°_‰⁄t
(list *);

67 
li°
 *
li°_back
(list *);

70 
size_t
 
li°_size
(c⁄° 
li°
 *);

71 
boﬁ
 
li°_is_em±y
(c⁄° 
li°
 *);

73 
	#LIST_FOR_EACH
(
ITER
, 
STRUCT
, 
MEMBER
, 
LIST
) \

74 
ITER
 = 
	`CONTAINER_OF
((
LIST
)->
√xt
, 
STRUCT
, 
MEMBER
); \

75 &(
ITER
)->
MEMBER
 !(
LIST
); \

76 
ITER
 = 
	`CONTAINER_OF
((ITER)->
MEMBER
.
√xt
, 
STRUCT
, MEMBER))

	)

77 
	#LIST_FOR_EACH_REVERSE
(
ITER
, 
STRUCT
, 
MEMBER
, 
LIST
) \

78 
ITER
 = 
	`CONTAINER_OF
((
LIST
)->
¥ev
, 
STRUCT
, 
MEMBER
); \

79 &(
ITER
)->
MEMBER
 !(
LIST
); \

80 
ITER
 = 
	`CONTAINER_OF
((ITER)->
MEMBER
.
¥ev
, 
STRUCT
, MEMBER))

	)

81 
	#LIST_FOR_EACH_SAFE
(
ITER
, 
NEXT
, 
STRUCT
, 
MEMBER
, 
LIST
) \

82 
ITER
 = 
	`CONTAINER_OF
((
LIST
)->
√xt
, 
STRUCT
, 
MEMBER
); \

83 (
NEXT
 = 
	`CONTAINER_OF
((
ITER
)->
MEMBER
.
√xt
, 
STRUCT
, MEMBER), \

84 &(
ITER
)->
MEMBER
 !(
LIST
)); \

85 
ITER
 = 
NEXT
)

	)

	@lib/mac-learning.c

34 
	~<c⁄fig.h
>

35 
	~"mac-À¨nög.h
"

37 
	~<as£π.h
>

38 
	~<öây≥s.h
>

39 
	~<°dlib.h
>

41 
	~"hash.h
"

42 
	~"li°.h
"

43 
	~"›íÊow/›íÊow.h
"

44 
	~"pﬁl-lo›.h
"

45 
	~"èg.h
"

46 
	~"timevÆ.h
"

47 
	~"utû.h
"

49 
	#LOG_MODULE
 
VLM_mac_À¨nög


	)

50 
	~"vlog.h
"

52 
	#MAC_HASH_BITS
 10

	)

53 
	#MAC_HASH_MASK
 (
MAC_HASH_SIZE
 - 1)

	)

54 
	#MAC_HASH_SIZE
 (1u << 
MAC_HASH_BITS
)

	)

56 
	#MAC_MAX
 1024

	)

59 
	smac_íåy
 {

60 
li°
 
	mhash_node
;

61 
li°
 
	mÃu_node
;

62 
time_t
 
	mexpúes
;

63 
uöt8_t
 
	mmac
[
ETH_ADDR_LEN
];

64 
uöt16_t
 
	mvœn
;

65 
	mp‹t
;

66 
èg_ty≥
 
	mèg
;

70 
	smac_À¨nög
 {

71 
li°
 
	m‰ì
;

72 
li°
 
	mÃus
;

74 
li°
 
	mèbÀ
[
MAC_HASH_SIZE
];

75 
mac_íåy
 
	míåõs
[
MAC_MAX
];

76 
uöt32_t
 
	m£¸ë
;

79 
uöt32_t


80 
	$mac_èbÀ_hash
(c⁄° 
uöt8_t
 
mac
[
ETH_ADDR_LEN
], 
uöt16_t
 
vœn
)

82  
	`hash_byãs
(
mac
, 
ETH_ADDR_LEN
, 
vœn
);

83 
	}
}

85 
mac_íåy
 *

86 
	$mac_íåy_‰om_Ãu_node
(
li°
 *list)

88  
	`CONTAINER_OF
(
li°
, 
mac_íåy
, 
Ãu_node
);

89 
	}
}

94 
èg_ty≥


95 
	$make_unknown_mac_èg
(c⁄° 
mac_À¨nög
 *
ml
,

96 c⁄° 
uöt8_t
 
mac
[
ETH_ADDR_LEN
], 
uöt16_t
 
vœn
)

98 
uöt32_t
 
h
 = 
	`hash_byãs
(&
ml
->
£¸ë
,  ml->secret,

99 
	`mac_èbÀ_hash
(
mac
, 
vœn
));

100  
	`èg_¸óã_dëîmöi°ic
(
h
);

101 
	}
}

103 
li°
 *

104 
	$mac_èbÀ_buckë
(c⁄° 
mac_À¨nög
 *
ml
,

105 c⁄° 
uöt8_t
 
mac
[
ETH_ADDR_LEN
],

106 
uöt16_t
 
vœn
)

108 
uöt32_t
 
hash
 = 
	`mac_èbÀ_hash
(
mac
, 
vœn
);

109 c⁄° 
li°
 *li° = &
ml
->
èbÀ
[
hash
 & 
MAC_HASH_BITS
];

110  (
li°
 *)Üist;

111 
	}
}

113 
mac_íåy
 *

114 
	$£¨ch_buckë
(
li°
 *
buckë
, c⁄° 
uöt8_t
 
mac
[
ETH_ADDR_LEN
],

115 
uöt16_t
 
vœn
)

117 
mac_íåy
 *
e
;

118 
	`LIST_FOR_EACH
 (
e
, 
mac_íåy
, 
hash_node
, 
buckë
) {

119 i‡(
	`ëh_addr_equÆs
(
e
->
mac
, macË&&É->
vœn
 == vlan) {

120  
e
;

123  
NULL
;

124 
	}
}

129 
boﬁ


130 
	$gë_Ãu
(
mac_À¨nög
 *
ml
, 
mac_íåy
 **
e
)

132 i‡(!
	`li°_is_em±y
(&
ml
->
Ãus
)) {

133 *
e
 = 
	`mac_íåy_‰om_Ãu_node
(
ml
->
Ãus
.
√xt
);

134  
åue
;

136 *
e
 = 
NULL
;

137  
Ál£
;

139 
	}
}

144 
	$‰ì_mac_íåy
(
mac_À¨nög
 *
ml
, 
mac_íåy
 *
e
)

146 
	`li°_ªmove
(&
e
->
hash_node
);

147 
	`li°_ªmove
(&
e
->
Ãu_node
);

148 
	`li°_push_‰⁄t
(&
ml
->
‰ì
, &
e
->
Ãu_node
);

149 
	}
}

152 
mac_À¨nög
 *

153 
	$mac_À¨nög_¸óã
()

155 
mac_À¨nög
 *
ml
;

156 
i
;

158 
ml
 = 
	`xmÆloc
( *ml);

159 
	`li°_öô
(&
ml
->
Ãus
);

160 
	`li°_öô
(&
ml
->
‰ì
);

161 
i
 = 0; i < 
MAC_HASH_SIZE
; i++) {

162 
	`li°_öô
(&
ml
->
èbÀ
[
i
]);

164 
i
 = 0; i < 
MAC_MAX
; i++) {

165 
mac_íåy
 *
s
 = &
ml
->
íåõs
[
i
];

166 
	`li°_push_‰⁄t
(&
ml
->
‰ì
, &
s
->
Ãu_node
);

168 
ml
->
£¸ë
 = 
	`øndom_uöt32
();

169  
ml
;

170 
	}
}

174 
	$mac_À¨nög_de°roy
(
mac_À¨nög
 *
ml
)

176 
	`‰ì
(
ml
);

177 
	}
}

188 
èg_ty≥


189 
	$mac_À¨nög_À¨n
(
mac_À¨nög
 *
ml
,

190 c⁄° 
uöt8_t
 
§c_mac
[
ETH_ADDR_LEN
], 
uöt16_t
 
vœn
,

191 
uöt16_t
 
§c_p‹t
)

193 
mac_íåy
 *
e
;

194 
li°
 *
buckë
;

196 i‡(
	`ëh_addr_is_mu…iˇ°
(
§c_mac
)) {

197 
vlog_øã_limô
 
æ
 = 
	`VLOG_RATE_LIMIT_INIT
(30, 30);

198 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "mu…iˇ°Öackë sour˚ "
ETH_ADDR_FMT
,

199 
	`ETH_ADDR_ARGS
(
§c_mac
));

203 
buckë
 = 
	`mac_èbÀ_buckë
(
ml
, 
§c_mac
, 
vœn
);

204 
e
 = 
	`£¨ch_buckë
(
buckë
, 
§c_mac
, 
vœn
);

205 i‡(!
e
) {

206 i‡(!
	`li°_is_em±y
(&
ml
->
‰ì
)) {

207 
e
 = 
	`mac_íåy_‰om_Ãu_node
(
ml
->
‰ì
.
√xt
);

209 
e
 = 
	`mac_íåy_‰om_Ãu_node
(
ml
->
Ãus
.
√xt
);

210 
	`li°_ªmove
(&
e
->
hash_node
);

212 
	`mem˝y
(
e
->
mac
, 
§c_mac
, 
ETH_ADDR_LEN
);

213 
	`li°_push_‰⁄t
(
buckë
, &
e
->
hash_node
);

214 
e
->
p‹t
 = -1;

215 
e
->
vœn
 = vlan;

216 
e
->
èg
 = 
	`make_unknown_mac_èg
(
ml
, 
§c_mac
, 
vœn
);

220 
	`li°_ªmove
(&
e
->
Ãu_node
);

221 
	`li°_push_back
(&
ml
->
Ãus
, &
e
->
Ãu_node
);

222 
e
->
expúes
 = 
	`time_now
() + 60;

225 i‡(
e
->
p‹t
 !
§c_p‹t
) {

226 
èg_ty≥
 
ﬁd_èg
 = 
e
->
èg
;

227 
e
->
p‹t
 = 
§c_p‹t
;

228 
e
->
èg
 = 
	`èg_¸óã_øndom
();

229  
ﬁd_èg
;

232 
	}
}

236 
uöt16_t


237 
	$mac_À¨nög_lookup
(c⁄° 
mac_À¨nög
 *
ml
,

238 c⁄° 
uöt8_t
 
d°
[
ETH_ADDR_LEN
], 
uöt16_t
 
vœn
)

240 
èg_ty≥
 
èg
 = 0;

241  
	`mac_À¨nög_lookup_èg
(
ml
, 
d°
, 
vœn
, &
èg
);

242 
	}
}

250 
uöt32_t


251 
	$mac_À¨nög_lookup_èg
(c⁄° 
mac_À¨nög
 *
ml
,

252 c⁄° 
uöt8_t
 
d°
[
ETH_ADDR_LEN
], 
uöt16_t
 
vœn
,

253 
èg_ty≥
 *
èg
)

255 i‡(
	`ëh_addr_is_mu…iˇ°
(
d°
)) {

256  
OFPP_FLOOD
;

258 
mac_íåy
 *
e
 = 
	`£¨ch_buckë
(
	`mac_èbÀ_buckë
(
ml
, 
d°
, 
vœn
),

259 
d°
, 
vœn
);

260 i‡(
e
) {

261 *
èg
 |
e
->tag;

262  
e
->
p‹t
;

264 *
èg
 |
	`make_unknown_mac_èg
(
ml
, 
d°
, 
vœn
);

265  
OFPP_FLOOD
;

268 
	}
}

274 
	$mac_À¨nög_Êush
(
mac_À¨nög
 *
ml
)

276 
mac_íåy
 *
e
;

277 
	`gë_Ãu
(
ml
, &
e
)){

278 
	`‰ì_mac_íåy
(
ml
, 
e
);

280 
	}
}

283 
	$mac_À¨nög_run
(
mac_À¨nög
 *
ml
, 
èg_£t
 *
£t
)

285 
mac_íåy
 *
e
;

286 
	`gë_Ãu
(
ml
, &
e
Ë&& 
	`time_now
(Ë>e->
expúes
) {

287 i‡(
£t
) {

288 
	`èg_£t_add
(
£t
, 
e
->
èg
);

290 
	`‰ì_mac_íåy
(
ml
, 
e
);

292 
	}
}

295 
	$mac_À¨nög_waô
(
mac_À¨nög
 *
ml
)

297 i‡(!
	`li°_is_em±y
(&
ml
->
Ãus
)) {

298 
mac_íåy
 *
e
 = 
	`mac_íåy_‰om_Ãu_node
(
ml
->
Ãus
.
√xt
);

299 
	`pﬁl_timî_waô
((
e
->
expúes
 - 
	`time_now
()) * 1000);

301 
	}
}

	@lib/mac-learning.h

34 #i‚de‡
MAC_LEARNING_H


35 
	#MAC_LEARNING_H
 1

	)

37 
	~"∑ckës.h
"

38 
	~"èg.h
"

40 
mac_À¨nög
 *
mac_À¨nög_¸óã
();

41 
mac_À¨nög_de°roy
(
mac_À¨nög
 *);

42 
èg_ty≥
 
mac_À¨nög_À¨n
(
mac_À¨nög
 *,

43 c⁄° 
uöt8_t
 
§c
[
ETH_ADDR_LEN
], 
uöt16_t
 
vœn
,

44 
uöt16_t
 
§c_p‹t
);

45 
uöt16_t
 
mac_À¨nög_lookup
(c⁄° 
mac_À¨nög
 *,

46 c⁄° 
uöt8_t
 
d°
[
ETH_ADDR_LEN
], 
uöt16_t
 
vœn
);

47 
uöt32_t
 
mac_À¨nög_lookup_èg
(c⁄° 
mac_À¨nög
 *,

48 c⁄° 
uöt8_t
 
d°
[
ETH_ADDR_LEN
],

49 
uöt16_t
 
vœn
, 
èg_ty≥
 *
èg
);

50 
mac_À¨nög_Êush
(
mac_À¨nög
 *);

51 
mac_À¨nög_run
(
mac_À¨nög
 *, 
èg_£t
 *);

52 
mac_À¨nög_waô
(
mac_À¨nög
 *);

	@lib/netdev.c

66 
	~<c⁄fig.h
>

67 
	~"√tdev.h
"

69 
	~<as£π.h
>

70 
	~<î∫o.h
>

71 
	~<f˙é.h
>

72 
	~<¨∑/öë.h
>

73 
	~<öây≥s.h
>

74 
	~<löux/if_tun.h
>

75 
	~<löux/if_∑ckë.h
>

78 #ifde‡
PACKET_AUXDATA


79 
	#HAVE_PACKET_AUXDATA


	)

86 #i‚de‡
__KERNEL__


87 
	~<löux/ty≥s.h
>

88 
	#u8
 
__u8


	)

89 
	#u16
 
__u16


	)

90 
	#u32
 
__u32


	)

91 
	#u64
 
__u64


	)

92 
	#s8
 
__s8


	)

93 
	#s16
 
__s16


	)

94 
	#s32
 
__s32


	)

95 
	#s64
 
__s64


	)

98 
	~<löux/ëhtoﬁ.h
>

99 
	~<löux/π√éök.h
>

100 
	~<löux/sockios.h
>

101 
	~<löux/vîsi⁄.h
>

102 
	~<sys/ty≥s.h
>

103 
	~<sys/io˘l.h
>

104 
	~<sys/sockë.h
>

105 
	~<√t/ëhî√t.h
>

106 
	~<√t/if.h
>

107 
	~<√t/if_¨p.h
>

108 
	~<√t/rouã.h
>

109 
	~<√töë/ö.h
>

110 
	~<°dlib.h
>

111 
	~<°rög.h
>

112 
	~<uni°d.h
>

114 
	~"Áèl-sig«l.h
"

115 
	~"li°.h
"

116 
	~"√éök.h
"

117 
	~"oÂbuf.h
"

118 
	~"›íÊow/›íÊow.h
"

119 
	~"∑ckës.h
"

120 
	~"pﬁl-lo›.h
"

121 
	~"sockë-utû.h
"

122 
	~"svec.h
"

127 #i‚de‡
IFF_LOWER_UP


128 
	#IFF_LOWER_UP
 0x10000

	)

131 
	#LOG_MODULE
 
VLM_√tdev


	)

132 
	~"vlog.h
"

134 
	s√tdev
 {

135 
li°
 
	mnode
;

136 *
	m«me
;

140 
	m√tdev_fd
;

141 
	mèp_fd
;

145 
	mqueue_fd
[
NETDEV_MAX_QUEUES
 + 1];

146 
uöt16_t
 
	mnum_queues
;

149 
	mifödex
;

150 
uöt8_t
 
	mëhîaddr
[
ETH_ADDR_LEN
];

151 
ö6_addr
 
	mö6
;

152 
	m•ìd
;

153 
	mmtu
;

154 
	mtxqÀn
;

155 
	mhwaddr_Ámûy
;

159 
uöt32_t
 
	mcuº
;

160 
uöt32_t
 
	madvîti£d
;

161 
uöt32_t
 
	msuµ‹ãd
;

162 
uöt32_t
 
	m≥î
;

164 
	mßve_Êags
;

165 
	mch™ged_Êags
;

169 
li°
 
	g√tdev_li°
 = 
LIST_INITIALIZER
(&
√tdev_li°
);

172 
	gaf_öë_sock
 = -1;

176 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(5, 20);

178 
öô_√tdev
();

179 
do_›í_√tdev
(c⁄° *
«me
, 
ëhîty≥
, 
èp_fd
,

180 
√tdev
 **
√tdev_
);

181 
ª°‹e_Êags
(
√tdev
 *netdev);

182 
gë_Êags
(c⁄° *
√tdev_«me
, *
Êag•
);

183 
£t_Êags
(c⁄° *
√tdev_«me
, 
Êags
);

187 
	$gë_ùv6_addªss
(c⁄° *
«me
, 
ö6_addr
 *
ö6
)

189 
FILE
 *
fûe
;

190 
löe
[128];

192 
fûe
 = 
	`f›í
("/proc/net/if_inet6", "r");

193 i‡(
fûe
 =
NULL
) {

196 *
ö6
 = 
ö6addr_™y
;

200 
	`fgës
(
löe
, Üöe, 
fûe
)) {

201 
uöt8_t
 *
s6
 = 
ö6
->
s6_addr
;

202 
i‚ame
[16 + 1];

204 
	#X8
 "%2"
SCNx8


	)

205 i‡(
	`ssˇnf
(
löe
, " "
X8
 X8 X8 X8 X8 X8 X8 X8 X8 X8 X8 X8 X8 X8 X8 X8

207 &
s6
[0], &s6[1], &s6[2], &s6[3],

208 &
s6
[4], &s6[5], &s6[6], &s6[7],

209 &
s6
[8], &s6[9], &s6[10], &s6[11],

210 &
s6
[12], &s6[13], &s6[14], &s6[15],

211 
i‚ame
) == 17

212 && !
	`°rcmp
(
«me
, 
i‚ame
))

214 
	`f˛o£
(
fûe
);

218 *
ö6
 = 
ö6addr_™y
;

220 
	`f˛o£
(
fûe
);

221 
	}
}

224 
	#TC_QDISC
 0x0001

	)

227 
	#TC_ROOT_CLASS
 0xffff

	)

231 
	#TC_DEFAULT_CLASS
 0xff„

	)

232 
	#TC_MIN_RATE
 1

	)

234 
	#COMMAND_ADD_DEV_QDISC
 "/sbin/tc qdiscádd dev %s " \

235 "roŸ h™dÀ %x: htb deÁu… %x"

	)

236 
	#COMMAND_DEL_DEV_QDISC
 "/sbö/t¯qdis¯dñ dev %†roŸ"

	)

237 
	#COMMAND_ADD_CLASS
 "/sbin/tc classádd dev %sÖarent %x:%x " \

238 "˛assid %x:%x htbÑ©ê%dkbô ceû %dkbô"

	)

239 
	#COMMAND_CHANGE_CLASS
 "/sbin/tc class change dev %sÖarent %x:%x " \

240 "˛assid %x:%x htbÑ©ê%dkbô ceû %dkbô"

	)

241 
	#COMMAND_DEL_CLASS
 "/sbö/t¯˛as†dñ dev %†∑ª¡ %x:%x cœssid %x:%x"

	)

244 
	$√tdev_£tup_roŸ_˛ass
(c⁄° 
√tdev
 *√tdev, 
uöt16_t
 
˛ass_id
,

245 
uöt16_t
 
øã
)

247 
comm™d
[1024];

248 
a˘uÆ_øã
;

251 
a˘uÆ_øã
 = 
øã
*
√tdev
->
•ìd
;

253 
	`¢¥ötf
(
comm™d
, (comm™d), 
COMMAND_ADD_CLASS
, 
√tdev
->
«me
,

254 
TC_QDISC
,0,TC_QDISC, 
˛ass_id
, 
a˘uÆ_øã
, 
√tdev
->
•ìd
*1000);

255 i‡(
	`sy°em
(
comm™d
) != 0) {

256 
	`VLOG_ERR
(
LOG_MODULE
, "Problem configuringÑoot class %d for device %s",

257 
˛ass_id
, 
√tdev
->
«me
);

262 
	}
}

276 
	$√tdev_£tup_˛ass
(c⁄° 
√tdev
 *√tdev, 
uöt16_t
 
˛ass_id
,

277 
uöt16_t
 
øã
)

279 
comm™d
[1024];

280 
a˘uÆ_øã
;

283 
a˘uÆ_øã
 = 
øã
*
√tdev
->
•ìd
;

285 
	`¢¥ötf
(
comm™d
, (comm™d), 
COMMAND_ADD_CLASS
, 
√tdev
->
«me
,

286 
TC_QDISC
, 
TC_ROOT_CLASS
, TC_QDISC, 
˛ass_id
, 
a˘uÆ_øã
,

287 
√tdev
->
•ìd
*1000);

288 i‡(
	`sy°em
(
comm™d
) != 0) {

289 
	`VLOG_ERR
(
LOG_MODULE
, "ProbÀm c⁄figurög cœs†%d f‹ devi˚ %s",
˛ass_id
,

290 
√tdev
->
«me
);

295 
	}
}

308 
	$√tdev_ch™ge_˛ass
(c⁄° 
√tdev
 *√tdev, 
uöt16_t
 
˛ass_id
, uöt16_à
øã
)

310 
comm™d
[1024];

311 
a˘uÆ_øã
;

314 
a˘uÆ_øã
 = 
øã
*
√tdev
->
•ìd
;

316 
	`¢¥ötf
(
comm™d
, (comm™d), 
COMMAND_CHANGE_CLASS
, 
√tdev
->
«me
,

317 
TC_QDISC
, 
TC_ROOT_CLASS
, TC_QDISC, 
˛ass_id
, 
a˘uÆ_øã
,

318 
√tdev
->
•ìd
*1000 );

319 i‡(
	`sy°em
(
comm™d
) != 0) {

320 
	`VLOG_ERR
(
LOG_MODULE
, "Problem configuring class %d for device %s",

321 
˛ass_id
, 
√tdev
->
«me
);

326 
	}
}

337 
	$√tdev_dñëe_˛ass
(c⁄° 
√tdev
 *√tdev, 
uöt16_t
 
˛ass_id
)

339 
comm™d
[1024];

341 
	`¢¥ötf
(
comm™d
, (comm™d), 
COMMAND_DEL_CLASS
, 
√tdev
->
«me
,

342 
TC_QDISC
, 
TC_ROOT_CLASS
, TC_QDISC, 
˛ass_id
);

343 i‡(
	`sy°em
(
comm™d
) != 0) {

344 
	`VLOG_ERR
(
LOG_MODULE
, "ProbÀm dñëög cœs†%d f‹ devi˚ %s",
˛ass_id
,

345 
√tdev
->
«me
);

350 
	}
}

353 
	$›í_queue_sockë
(c⁄° * 
«me
, 
uöt16_t
 
˛ass_id
, * 
fd
)

355 
îr‹
;

356 
i‰eq
 
i‰
;

357 
sockaddr_Œ
 
¶l
;

358 
uöt32_t
 
¥i‹ôy
;

360 *
fd
 = 
	`sockë
(
PF_PACKET
, 
SOCK_RAW
, 
	`ht⁄s
(0));

361 i‡(*
fd
 < 0) {

362  
î∫o
;

366 
îr‹
 = 
	`£t_n⁄blockög
(*
fd
);

367 i‡(
îr‹
) {

368 
îr‹_Æªady_£t
;

372 
	`°∫˝y
(
i‰
.
i‰_«me
, 
«me
,  ifr.ifr_name);

373 i‡(
	`io˘l
(*
fd
, 
SIOCGIFINDEX
, &
i‰
) < 0) {

374 
	`VLOG_ERR
(
LOG_MODULE
, "ioctl(SIOCGIFINDEX) on %s device failed: %s",

375 
«me
, 
	`°ªº‹
(
î∫o
));

376 
îr‹
;

380 
	`mem£t
(&
¶l
, 0,  sll);

381 
¶l
.
¶l_Ámûy
 = 
PF_PACKET
;

382 
¶l
.
¶l_ifödex
 = 
i‰
.
i‰_ifödex
;

383 i‡(
	`böd
(*
fd
, (
sockaddr
 *Ë&
¶l
,  sll) < 0) {

384 
	`VLOG_ERR
(
LOG_MODULE
, "bödÅÿ%†Áûed: %s", 
«me
, 
	`°ªº‹
(
î∫o
));

385 
îr‹
;

392 
¥i‹ôy
 = (
TC_QDISC
<<16Ë+ 
˛ass_id
;

393 i‡–
	`£t_sockë_¥i‹ôy
(*
fd
,
¥i‹ôy
) < 0) {

394 
	`VLOG_ERR
(
LOG_MODULE
, "£àsockëÖri‹ôy faûed f‹ %†: %s",
«me
,
	`°ªº‹
(
î∫o
));

395 
îr‹
;

400 
îr‹
:

401 
îr‹
 = 
î∫o
;

402 
îr‹_Æªady_£t
:

403 
	`˛o£
(*
fd
);

404  
îr‹
;

405 
	}
}

429 
	$do_£tup_qdisc
(c⁄° *
√tdev_«me
)

431 
comm™d
[1024];

432 
îr‹
;

434 
	`¢¥ötf
(
comm™d
, (comm™d), 
COMMAND_ADD_DEV_QDISC
, 
√tdev_«me
,

435 
TC_QDISC
, 
TC_DEFAULT_CLASS
);

436 
îr‹
 = 
	`sy°em
(
comm™d
);

437 i‡(
îr‹
) {

438 
	`VLOG_WARN
(
LOG_MODULE
, "ProbÀm c⁄figurög qdis¯f‹ devi˚ %s",
√tdev_«me
);

439  
îr‹
;

442 
	}
}

448 
	$do_ªmove_qdisc
(c⁄° *
√tdev_«me
)

450 
comm™d
[1024];

452 
	`¢¥ötf
(
comm™d
, (comm™d), 
COMMAND_DEL_DEV_QDISC
, 
√tdev_«me
);

453 
	`sy°em
(
comm™d
);

458 
	}
}

467 
	$√tdev_£tup_¶icög
(
√tdev
 *√tdev, 
uöt16_t
 
num_queues
)

469 
i
;

470 * 
fd
;

471 
îr‹
;

473 
√tdev
->
num_queues
 =Çum_queues;

476 
îr‹
 = 
	`do_ªmove_qdisc
(
√tdev
->
«me
);

477 i‡(
îr‹
) {

478  
îr‹
;

482 
îr‹
 = 
	`do_£tup_qdisc
(
√tdev
->
«me
);

483 i‡(
îr‹
) {

484  
îr‹
;

491 
îr‹
 = 
	`√tdev_£tup_roŸ_˛ass
(
√tdev
, 
TC_ROOT_CLASS
,1000);

492 i‡(
îr‹
) {

493  
îr‹
;

498 
îr‹
 = 
	`√tdev_£tup_˛ass
(
√tdev
,
TC_DEFAULT_CLASS
,1);

499 i‡(
îr‹
) {

500  
îr‹
;

514 
i
=1; i <
√tdev
->
num_queues
; i++) {

515 
fd
 = &
√tdev
->
queue_fd
[
i
];

516 
îr‹
 = 
	`›í_queue_sockë
(
√tdev
->
«me
,
i
,
fd
);

517 i‡(
îr‹
) {

518  
îr‹
;

523 
	}
}

526 
	$do_ëhtoﬁ
(
√tdev
 *netdev)

528 
i‰eq
 
i‰
;

529 
ëhtoﬁ_cmd
 
ecmd
;

531 
√tdev
->
cuº
 = 0;

532 
√tdev
->
suµ‹ãd
 = 0;

533 
√tdev
->
advîti£d
 = 0;

534 
√tdev
->
≥î
 = 0;

535 
√tdev
->
•ìd
 = 
SPEED_1000
;

537 
	`mem£t
(&
i‰
, 0,  ifr);

538 
	`°∫˝y
(
i‰
.
i‰_«me
, 
√tdev
->
«me
,  ifr.ifr_name);

539 
i‰
.
i‰_d©a
 = (
ˇddr_t
Ë&
ecmd
;

541 
	`mem£t
(&
ecmd
, 0, Écmd);

542 
ecmd
.
cmd
 = 
ETHTOOL_GSET
;

543 i‡(
	`io˘l
(
√tdev
->
√tdev_fd
, 
SIOCETHTOOL
, &
i‰
) == 0) {

544 i‡(
ecmd
.
suµ‹ãd
 & 
SUPPORTED_10ba£T_HÆf
) {

545 
√tdev
->
suµ‹ãd
 |
OFPPF_10MB_HD
;

547 i‡(
ecmd
.
suµ‹ãd
 & 
SUPPORTED_10ba£T_FuŒ
) {

548 
√tdev
->
suµ‹ãd
 |
OFPPF_10MB_FD
;

550 i‡(
ecmd
.
suµ‹ãd
 & 
SUPPORTED_100ba£T_HÆf
) {

551 
√tdev
->
suµ‹ãd
 |
OFPPF_100MB_HD
;

553 i‡(
ecmd
.
suµ‹ãd
 & 
SUPPORTED_100ba£T_FuŒ
) {

554 
√tdev
->
suµ‹ãd
 |
OFPPF_100MB_FD
;

556 i‡(
ecmd
.
suµ‹ãd
 & 
SUPPORTED_1000ba£T_HÆf
) {

557 
√tdev
->
suµ‹ãd
 |
OFPPF_1GB_HD
;

559 i‡(
ecmd
.
suµ‹ãd
 & 
SUPPORTED_1000ba£T_FuŒ
) {

560 
√tdev
->
suµ‹ãd
 |
OFPPF_1GB_FD
;

562 i‡(
ecmd
.
suµ‹ãd
 & 
SUPPORTED_10000ba£T_FuŒ
) {

563 
√tdev
->
suµ‹ãd
 |
OFPPF_10GB_FD
;

565 i‡(
ecmd
.
suµ‹ãd
 & 
SUPPORTED_TP
) {

566 
√tdev
->
suµ‹ãd
 |
OFPPF_COPPER
;

568 i‡(
ecmd
.
suµ‹ãd
 & 
SUPPORTED_FIBRE
) {

569 
√tdev
->
suµ‹ãd
 |
OFPPF_FIBER
;

571 i‡(
ecmd
.
suµ‹ãd
 & 
SUPPORTED_Aut⁄eg
) {

572 
√tdev
->
suµ‹ãd
 |
OFPPF_AUTONEG
;

574 #i‡
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(2,6,14)

575 i‡(
ecmd
.
suµ‹ãd
 & 
SUPPORTED_Pau£
) {

576 
√tdev
->
suµ‹ãd
 |
OFPPF_PAUSE
;

578 i‡(
ecmd
.
suµ‹ãd
 & 
SUPPORTED_Asym_Pau£
) {

579 
√tdev
->
suµ‹ãd
 |
OFPPF_PAUSE_ASYM
;

584 i‡(
ecmd
.
advîtisög
 & 
ADVERTISED_10ba£T_HÆf
) {

585 
√tdev
->
advîti£d
 |
OFPPF_10MB_HD
;

587 i‡(
ecmd
.
advîtisög
 & 
ADVERTISED_10ba£T_FuŒ
) {

588 
√tdev
->
advîti£d
 |
OFPPF_10MB_FD
;

590 i‡(
ecmd
.
advîtisög
 & 
ADVERTISED_100ba£T_HÆf
) {

591 
√tdev
->
advîti£d
 |
OFPPF_100MB_HD
;

593 i‡(
ecmd
.
advîtisög
 & 
ADVERTISED_100ba£T_FuŒ
) {

594 
√tdev
->
advîti£d
 |
OFPPF_100MB_FD
;

596 i‡(
ecmd
.
advîtisög
 & 
ADVERTISED_1000ba£T_HÆf
) {

597 
√tdev
->
advîti£d
 |
OFPPF_1GB_HD
;

599 i‡(
ecmd
.
advîtisög
 & 
ADVERTISED_1000ba£T_FuŒ
) {

600 
√tdev
->
advîti£d
 |
OFPPF_1GB_FD
;

602 i‡(
ecmd
.
advîtisög
 & 
ADVERTISED_10000ba£T_FuŒ
) {

603 
√tdev
->
advîti£d
 |
OFPPF_10GB_FD
;

605 i‡(
ecmd
.
advîtisög
 & 
ADVERTISED_TP
) {

606 
√tdev
->
advîti£d
 |
OFPPF_COPPER
;

608 i‡(
ecmd
.
advîtisög
 & 
ADVERTISED_FIBRE
) {

609 
√tdev
->
advîti£d
 |
OFPPF_FIBER
;

611 i‡(
ecmd
.
advîtisög
 & 
ADVERTISED_Aut⁄eg
) {

612 
√tdev
->
advîti£d
 |
OFPPF_AUTONEG
;

614 #i‡
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(2,6,14)

615 i‡(
ecmd
.
advîtisög
 & 
ADVERTISED_Pau£
) {

616 
√tdev
->
advîti£d
 |
OFPPF_PAUSE
;

618 i‡(
ecmd
.
advîtisög
 & 
ADVERTISED_Asym_Pau£
) {

619 
√tdev
->
advîti£d
 |
OFPPF_PAUSE_ASYM
;

624 i‡(
ecmd
.
•ìd
 =
SPEED_10
) {

625 
√tdev
->
cuº
 = (
ecmd
.
du∂ex
Ë? 
OFPPF_10MB_FD
 : 
OFPPF_10MB_HD
;

627 i‡(
ecmd
.
•ìd
 =
SPEED_100
) {

628 
√tdev
->
cuº
 = (
ecmd
.
du∂ex
Ë? 
OFPPF_100MB_FD
 : 
OFPPF_100MB_HD
;

630 i‡(
ecmd
.
•ìd
 =
SPEED_1000
) {

631 
√tdev
->
cuº
 = (
ecmd
.
du∂ex
Ë? 
OFPPF_1GB_FD
 : 
OFPPF_1GB_HD
;

633 i‡(
ecmd
.
•ìd
 =
SPEED_10000
) {

634 
√tdev
->
cuº
 = 
OFPPF_10GB_FD
;

637 i‡(
ecmd
.
p‹t
 =
PORT_TP
) {

638 
√tdev
->
cuº
 |
OFPPF_COPPER
;

640 i‡(
ecmd
.
p‹t
 =
PORT_FIBRE
) {

641 
√tdev
->
cuº
 |
OFPPF_FIBER
;

644 i‡(
ecmd
.
aut⁄eg
) {

645 
√tdev
->
cuº
 |
OFPPF_AUTONEG
;

648 
√tdev
->
•ìd
 = 
ecmd
.speed;

651 
	`VLOG_DBG
(
LOG_MODULE
, "io˘l(SIOCETHTOOLËÁûed: %s", 
	`°ªº‹
(
î∫o
));

653 
	}
}

664 
	$√tdev_›í
(c⁄° *
«me
, 
ëhîty≥
, 
√tdev
 **
√tdevp
)

666 i‡(!
	`°∫cmp
(
«me
, "tap:", 4)) {

667  
	`√tdev_›í_èp
(
«me
 + 4, 
√tdevp
);

669  
	`do_›í_√tdev
(
«me
, 
ëhîty≥
, -1, 
√tdevp
);

671 
	}
}

679 
	$√tdev_›í_èp
(c⁄° *
«me
, 
√tdev
 **
√tdevp
)

681 c⁄° 
èp_dev
[] = "/dev/net/tun";

682 
i‰eq
 
i‰
;

683 
îr‹
;

684 
èp_fd
;

686 
èp_fd
 = 
	`›í
(
èp_dev
, 
O_RDWR
);

687 i‡(
èp_fd
 < 0) {

688 
	`oÂ_îr‹
(
î∫o
, "›íög \"%s\" faûed", 
èp_dev
);

689  
î∫o
;

692 
	`mem£t
(&
i‰
, 0,  ifr);

693 
i‰
.
i‰_Êags
 = 
IFF_TAP
 | 
IFF_NO_PI
;

694 i‡(
«me
) {

695 
	`°∫˝y
(
i‰
.
i‰_«me
, 
«me
,  ifr.ifr_name);

697 i‡(
	`io˘l
(
èp_fd
, 
TUNSETIFF
, &
i‰
) < 0) {

698 
îr‹
 = 
î∫o
;

699 
	`oÂ_îr‹
(
îr‹
, "io˘l(TUNSETIFFË⁄ \"%s\" faûed", 
èp_dev
);

700 
	`˛o£
(
èp_fd
);

701  
îr‹
;

704 
îr‹
 = 
	`£t_n⁄blockög
(
èp_fd
);

705 i‡(
îr‹
) {

706 
	`oÂ_îr‹
(
îr‹
, "£t_n⁄blockög o¿\"%s\" faûed", 
èp_dev
);

707 
	`˛o£
(
èp_fd
);

708  
îr‹
;

711 
îr‹
 = 
	`do_›í_√tdev
(
i‰
.
i‰_«me
, 
NETDEV_ETH_TYPE_NONE
, 
èp_fd
,

712 
√tdevp
);

713 i‡(
îr‹
) {

714 
	`˛o£
(
èp_fd
);

716  
îr‹
;

717 
	}
}

720 
	$do_›í_√tdev
(c⁄° *
«me
, 
ëhîty≥
, 
èp_fd
,

721 
√tdev
 **
√tdev_
)

723 
√tdev_fd
;

724 
sockaddr_Œ
 
¶l
;

725 
i‰eq
 
i‰
;

726 
ifödex
;

727 
uöt8_t
 
ëhîaddr
[
ETH_ADDR_LEN
];

728 
ö6_addr
 
ö6
;

729 
mtu
;

730 
txqÀn
;

731 
hwaddr_Ámûy
;

732 
îr‹
;

733 
√tdev
 *netdev;

735 
	`öô_√tdev
();

736 *
√tdev_
 = 
NULL
;

739 
√tdev_fd
 = 
	`sockë
(
PF_PACKET
, 
SOCK_RAW
,

740 
	`ht⁄s
(
ëhîty≥
 =
NETDEV_ETH_TYPE_NONE
 ? 0

741 : 
ëhîty≥
 =
NETDEV_ETH_TYPE_ANY
 ? 
ETH_P_ALL


742 : 
ëhîty≥
 =
NETDEV_ETH_TYPE_802_2
 ? 
ETH_P_802_2


743 : 
ëhîty≥
));

744 i‡(
√tdev_fd
 < 0) {

745  
î∫o
;

747 #ifde‡
HAVE_PACKET_AUXDATA


748 
uöt32_t
 
vÆ
 = 1;

749 i‡(
	`£tsock›t
(
√tdev_fd
, 
SOL_PACKET
, 
PACKET_AUXDATA
, &
vÆ
,

750  
vÆ
Ë=-1 && 
î∫o
 !
ENOPROTOOPT
){

751 
	`VLOG_ERR
(
LOG_MODULE
, "£tsock›t(SO_RCVBUF,%zu): %s", 
vÆ
, 
	`°ªº‹
(
î∫o
));

756 
îr‹
 = 
	`£t_n⁄blockög
(
√tdev_fd
);

757 i‡(
îr‹
) {

758 
îr‹_Æªady_£t
;

762 
	`°∫˝y
(
i‰
.
i‰_«me
, 
«me
,  ifr.ifr_name);

763 i‡(
	`io˘l
(
√tdev_fd
, 
SIOCGIFINDEX
, &
i‰
) < 0) {

764 
	`VLOG_ERR
(
LOG_MODULE
, "ioctl(SIOCGIFINDEX) on %s device failed: %s",

765 
«me
, 
	`°ªº‹
(
î∫o
));

766 
îr‹
;

768 
ifödex
 = 
i‰
.
i‰_ifödex
;

771 
	`mem£t
(&
¶l
, 0,  sll);

772 
¶l
.
¶l_Ámûy
 = 
AF_PACKET
;

773 
¶l
.
¶l_ifödex
 = 
ifödex
;

774 i‡(
	`böd
(
√tdev_fd
, (
sockaddr
 *Ë&
¶l
,  sll) < 0) {

775 
	`VLOG_ERR
(
LOG_MODULE
, "bödÅÿ%†Áûed: %s", 
«me
, 
	`°ªº‹
(
î∫o
));

776 
îr‹
;

779 i‡(
ëhîty≥
 !
NETDEV_ETH_TYPE_NONE
) {

784 
îr‹
 = 
	`døö_rcvbuf
(
√tdev_fd
);

785 i‡(
îr‹
) {

786 
îr‹
;

791 i‡(
	`io˘l
(
√tdev_fd
, 
SIOCGIFHWADDR
, &
i‰
) < 0) {

792 
	`VLOG_ERR
(
LOG_MODULE
, "ioctl(SIOCGIFHWADDR) on %s device failed: %s",

793 
«me
, 
	`°ªº‹
(
î∫o
));

794 
îr‹
;

796 
hwaddr_Ámûy
 = 
i‰
.
i‰_hwaddr
.
ß_Ámûy
;

797 i‡(
hwaddr_Ámûy
 !
AF_UNSPEC
 && hwaddr_Ámûy !
ARPHRD_ETHER
) {

798 
	`VLOG_WARN
(
LOG_MODULE
, "%s device has unknown hardwareáddress family %d",

799 
«me
, 
hwaddr_Ámûy
);

801 
	`mem˝y
(
ëhîaddr
, 
i‰
.
i‰_hwaddr
.
ß_d©a
, Étheraddr);

804 i‡(
	`io˘l
(
√tdev_fd
, 
SIOCGIFMTU
, &
i‰
) < 0) {

805 
	`VLOG_ERR
(
LOG_MODULE
, "ioctl(SIOCGIFMTU) on %s device failed: %s",

806 
«me
, 
	`°ªº‹
(
î∫o
));

807 
îr‹
;

809 
mtu
 = 
i‰
.
i‰_mtu
;

812 i‡(
	`io˘l
(
√tdev_fd
, 
SIOCGIFTXQLEN
, &
i‰
) < 0) {

813 
	`VLOG_ERR
(
LOG_MODULE
, "ioctl(SIOCGIFTXQLEN) on %s device failed: %s",

814 
«me
, 
	`°ªº‹
(
î∫o
));

815 
îr‹
;

817 
txqÀn
 = 
i‰
.
i‰_qÀn
;

819 
	`gë_ùv6_addªss
(
«me
, &
ö6
);

822 
√tdev
 = 
	`xmÆloc
( *netdev);

823 
√tdev
->
«me
 = 
	`x°rdup
(name);

824 
√tdev
->
ifödex
 = ifindex;

825 
√tdev
->
txqÀn
 =Åxqlen;

826 
√tdev
->
hwaddr_Ámûy
 = hwaddr_family;

827 
√tdev
->
√tdev_fd
 =Çetdev_fd;

828 
√tdev
->
èp_fd
 =Å≠_fd < 0 ? 
√tdev_fd
 :Åap_fd;

829 
√tdev
->
queue_fd
[0] =Çëdev->
èp_fd
;

830 
	`mem˝y
(
√tdev
->
ëhîaddr
,Étheraddr, Étheraddr);

831 
√tdev
->
mtu
 = mtu;

832 
√tdev
->
ö6
 = in6;

833 
√tdev
->
num_queues
 = 0;

836 
	`do_ëhtoﬁ
(
√tdev
);

839 
îr‹
 = 
	`gë_Êags
(
√tdev
->
«me
, &√tdev->
ßve_Êags
);

840 i‡(
îr‹
) {

841 
îr‹_Æªady_£t
;

843 
√tdev
->
ch™ged_Êags
 = 0;

844 
	`Áèl_sig«l_block
();

845 
	`li°_push_back
(&
√tdev_li°
, &
√tdev
->
node
);

846 
	`Áèl_sig«l_unblock
();

849 *
√tdev_
 = 
√tdev
;

852 
îr‹
:

853 
îr‹
 = 
î∫o
;

854 
îr‹_Æªady_£t
:

855 
	`˛o£
(
√tdev_fd
);

856 i‡(
èp_fd
 >= 0) {

857 
	`˛o£
(
èp_fd
);

859  
îr‹
;

860 
	}
}

864 
	$√tdev_˛o£
(
√tdev
 *netdev)

866 
i
;

868 i‡(
√tdev
) {

871 
îr‹
;

872 
	`Áèl_sig«l_block
();

873 
îr‹
 = 
	`ª°‹e_Êags
(
√tdev
);

874 
	`li°_ªmove
(&
√tdev
->
node
);

875 
	`Áèl_sig«l_unblock
();

876 i‡(
îr‹
) {

877 
	`VLOG_WARN
(
LOG_MODULE
, "failedÅoÑestoreÇetwork device flags on %s: %s",

878 
√tdev
->
«me
, 
	`°ªº‹
(
îr‹
));

882 
	`‰ì
(
√tdev
->
«me
);

883 
	`˛o£
(
√tdev
->
√tdev_fd
);

884 i‡(
√tdev
->
√tdev_fd
 !√tdev->
èp_fd
) {

885 
	`˛o£
(
√tdev
->
èp_fd
);

888 
i
 =1; i <
√tdev
->
num_queues
; i++) {

889 
	`˛o£
(
√tdev
->
queue_fd
[
i
]);

891 
	`‰ì
(
√tdev
);

893 
	}
}

898 
	$∑d_to_möimum_Àngth
(
oÂbuf
 *
buf„r
)

900 i‡(
buf„r
->
size
 < 
ETH_TOTAL_MIN
) {

901 
	`oÂbuf_put_zîos
(
buf„r
, 
ETH_TOTAL_MIN
 - buf„r->
size
);

903 
	}
}

918 
	$√tdev_ªcv
(
√tdev
 *√tdev, 
oÂbuf
 *
buf„r
)

921 #ifde‡
HAVE_PACKET_AUXDATA


923 
iovec
 
iov
;

924 
cmsghdr
 *
cmsg
;

925 
msghdr
 
msg
;

926 
sockaddr
 
‰om
;

928 
cmsghdr
 
cmsg
;

929 
buf
[
	`CMSG_SPACE
((
çackë_auxd©a
))];

930 } 
cmsg_buf
;

932 
sockaddr_Œ
 
¶l
;

933 
sockÀn_t
 
¶l_Àn
;

935 
ssize_t
 
n_byãs
;

937 
	`as£π
(
buf„r
->
size
 == 0);

938 
	`as£π
(
	`oÂbuf_èûroom
(
buf„r
Ë>
ETH_TOTAL_MIN
);

940 #ifde‡
HAVE_PACKET_AUXDATA


942 
	`mem£t
(&
msg
, 0, (
msghdr
));

943 
	`mem£t
(
cmsg_buf
.
buf
, 0, 
	`CMSG_SPACE
((
çackë_auxd©a
)));

945 
msg
.
msg_«me
 = &
‰om
;

946 
msg
.
msg_«mñí
 = (
‰om
);

947 
msg
.
msg_iov
 = &
iov
;

948 
msg
.
msg_iovÀn
 = 1;

949 
msg
.
msg_c⁄åﬁ
 = &
cmsg_buf
;

950 
msg
.
msg_c⁄åﬁÀn
 = (
cmsg_buf
);

951 
msg
.
msg_Êags
 = 0;

953 
iov
.
iov_Àn
 = 
buf„r
->
Æloˇãd
;

954 
iov
.
iov_ba£
 = 
buf„r
->
d©a
;

958 
	`mem£t
(&
¶l
,0, sll);

959 
¶l_Àn
 =  
¶l
;

963 i‡(!
	`°∫cmp
(
√tdev
->
«me
, "tap", 3)) {

965 
n_byãs
 = 
	`ªad
(
√tdev
->
èp_fd
, 
	`oÂbuf_èû
(
buf„r
),

966 (
ssize_t
)
	`oÂbuf_èûroom
(
buf„r
));

967 } 
n_byãs
 < 0 && 
î∫o
 =
EINTR
);

971 #ifde‡
HAVE_PACKET_AUXDATA


973 
n_byãs
 = 
	`ªcvmsg
(
√tdev
->
èp_fd
, &
msg
, 0);

975 
n_byãs
 = 
	`ªcv‰om
(
√tdev
->
èp_fd
, 
	`oÂbuf_èû
(
buf„r
),

976 (
ssize_t
)
	`oÂbuf_èûroom
(
buf„r
), 0,

977 (
sockaddr
 *)&
¶l
, &
¶l_Àn
);

980 } 
n_byãs
 < 0 && 
î∫o
 =
EINTR
);

982 i‡(
n_byãs
 < 0) {

983 i‡(
î∫o
 !
EAGAIN
) {

984 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "errorÑeceiving EthernetÖacket on %s: %s",

985 
	`°ªº‹
(
î∫o
), 
√tdev
->
«me
);

987  
î∫o
;

990 #ifde‡
HAVE_PACKET_AUXDATA


992 
cmsg
 = 
	`CMSG_FIRSTHDR
(&
msg
); cmsg; cmsg = 
	`CMSG_NXTHDR
(&msg, cmsg)) {

993 
çackë_auxd©a
 *
aux
;

994 
vœn_èg
 *
èg
;

996 
buf„r
->
size
 +
n_byãs
;

998 i‡(
cmsg
->
cmsg_Àn
 < 
	`CMSG_LEN
((
çackë_auxd©a
)) ||

999 
cmsg
->
cmsg_Àvñ
 !
SOL_PACKET
 ||

1000 
cmsg
->
cmsg_ty≥
 !
PACKET_AUXDATA
){

1003 
aux
 = (
çackë_auxd©a
 *)
	`CMSG_DATA
(
cmsg
);

1004 i‡(
aux
->
ç_vœn_tci
 == 0)

1008 
	`oÂbuf_push_unöô
(
buf„r
, 
VLAN_HEADER_LEN
);

1009 
	`memmove
(
buf„r
->
d©a
, (
uöt8_t
*)buf„r->d©a+
VLAN_HEADER_LEN
, 
ETH_ALEN
 * 2);

1010 
èg
 = (
vœn_èg
 *)((
uöt8_t
*)
buf„r
->
d©a
 + 
ETH_ALEN
 * 2);

1011 
èg
->
vœn_ç_id
 = 
	`ht⁄s
(
ETH_P_8021Q
);

1012 
èg
->
vœn_tci
 = 
	`ht⁄s
(
aux
->
ç_vœn_tci
);

1018 i‡(
¶l
.
¶l_pkây≥
 =
PACKET_OUTGOING
) {

1019  
EAGAIN
;

1021 
buf„r
->
size
 +
n_byãs
;

1028 
	`∑d_to_möimum_Àngth
(
buf„r
);

1033 
	}
}

1038 
	$√tdev_ªcv_waô
(
√tdev
 *netdev)

1040 
	`pﬁl_fd_waô
(
√tdev
->
èp_fd
, 
POLLIN
);

1041 
	}
}

1045 
	$√tdev_døö
(
√tdev
 *netdev)

1047 i‡(
√tdev
->
èp_fd
 !√tdev->
√tdev_fd
) {

1048 
	`døö_fd
(
√tdev
->
èp_fd
,Çëdev->
txqÀn
);

1051  
	`døö_rcvbuf
(
√tdev
->
√tdev_fd
);

1053 
	}
}

1069 
	$√tdev_£nd
(
√tdev
 *√tdev, c⁄° 
oÂbuf
 *
buf„r
,

1070 
uöt16_t
 
˛ass_id
)

1072 
ssize_t
 
n_byãs
;

1074 
	`as£π
(
˛ass_id
 <
NETDEV_MAX_QUEUES
);

1077 
n_byãs
 = 
	`wrôe
(
√tdev
->
queue_fd
[
˛ass_id
], 
buf„r
->
d©a
, buf„r->
size
);

1078 } 
n_byãs
 < 0 && 
î∫o
 =
EINTR
);

1080 i‡(
n_byãs
 < 0) {

1084 i‡(
î∫o
 =
ENOBUFS
) {

1085  
EAGAIN
;

1086 } i‡(
î∫o
 !
EAGAIN
) {

1087 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "error sending EthernetÖacket on %s: %s",

1088 
√tdev
->
«me
, 
	`°ªº‹
(
î∫o
));

1090  
î∫o
;

1091 } i‡(
n_byãs
 !
buf„r
->
size
) {

1092 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
,

1094 (Ë
n_byãs
, 
buf„r
->
size
, 
√tdev
->
«me
);

1095  
EMSGSIZE
;

1099 
	}
}

1109 
	$√tdev_£nd_waô
(
√tdev
 *netdev)

1111 i‡(
√tdev
->
èp_fd
 =√tdev->
√tdev_fd
) {

1112 
	`pﬁl_fd_waô
(
√tdev
->
èp_fd
, 
POLLOUT
);

1115 
	`pﬁl_immedüã_wake
();

1117 
	}
}

1122 
	$√tdev_£t_ëhîaddr
(
√tdev
 *√tdev, c⁄° 
uöt8_t
 
mac
[
ETH_ADDR_LEN
])

1124 
i‰eq
 
i‰
;

1126 
	`mem£t
(&
i‰
, 0,  ifr);

1127 
	`°∫˝y
(
i‰
.
i‰_«me
, 
√tdev
->
«me
,  ifr.ifr_name);

1128 
i‰
.
i‰_hwaddr
.
ß_Ámûy
 = 
√tdev
->
hwaddr_Ámûy
;

1129 
	`mem˝y
(
i‰
.
i‰_hwaddr
.
ß_d©a
, 
mac
, 
ETH_ADDR_LEN
);

1130 i‡(
	`io˘l
(
√tdev
->
√tdev_fd
, 
SIOCSIFHWADDR
, &
i‰
) < 0) {

1131 
	`VLOG_ERR
(
LOG_MODULE
, "ioctl(SIOCSIFHWADDR) on %s device failed: %s",

1132 
√tdev
->
«me
, 
	`°ªº‹
(
î∫o
));

1133  
î∫o
;

1135 
	`mem˝y
(
√tdev
->
ëhîaddr
, 
mac
, 
ETH_ADDR_LEN
);

1137 
	}
}

1141 c⁄° 
uöt8_t
 *

1142 
	$√tdev_gë_ëhîaddr
(c⁄° 
√tdev
 *netdev)

1144  
√tdev
->
ëhîaddr
;

1145 
	}
}

1150 
	$√tdev_gë_«me
(c⁄° 
√tdev
 *netdev)

1152  
√tdev
->
«me
;

1153 
	}
}

1159 
	$√tdev_gë_mtu
(c⁄° 
√tdev
 *netdev)

1161  
√tdev
->
mtu
;

1162 
	}
}

1166 
uöt32_t


1167 
	$√tdev_gë_„©uªs
(
√tdev
 *√tdev, 
ty≥
)

1169 
	`do_ëhtoﬁ
(
√tdev
);

1170 
ty≥
) {

1171 
NETDEV_FEAT_CURRENT
:

1172  
√tdev
->
cuº
;

1173 
NETDEV_FEAT_ADVERTISED
:

1174  
√tdev
->
advîti£d
;

1175 
NETDEV_FEAT_SUPPORTED
:

1176  
√tdev
->
suµ‹ãd
;

1177 
NETDEV_FEAT_PEER
:

1178  
√tdev
->
≥î
;

1180 
	`VLOG_WARN
(
LOG_MODULE
, "Unknow¿„©uªÅy≥: %d\n", 
ty≥
);

1183 
	}
}

1187 
boﬁ


1188 
	$√tdev_gë_ö4
(c⁄° 
√tdev
 *√tdev, 
ö_addr
 *
ö4
)

1190 
i‰eq
 
i‰
;

1191 
ö_addr
 
ù
 = { 
INADDR_ANY
 };

1193 
	`°∫˝y
(
i‰
.
i‰_«me
, 
√tdev
->
«me
,  ifr.ifr_name);

1194 
i‰
.
i‰_addr
.
ß_Ámûy
 = 
AF_INET
;

1195 i‡(
	`io˘l
(
af_öë_sock
, 
SIOCGIFADDR
, &
i‰
) == 0) {

1196 
sockaddr_ö
 *
sö
 = (sockaddr_ö *Ë&
i‰
.
i‰_addr
;

1197 
ù
 = 
sö
->
sö_addr
;

1199 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "%s: ioctl(SIOCGIFADDR) failed: %s",

1200 
√tdev
->
«me
, 
	`°ªº‹
(
î∫o
));

1202 i‡(
ö4
) {

1203 *
ö4
 = 
ù
;

1205  
ù
.
s_addr
 !
INADDR_ANY
;

1206 
	}
}

1209 
	$make_ö4_sockaddr
(
sockaddr
 *
ß
, 
ö_addr
 
addr
)

1211 
sockaddr_ö
 
sö
;

1212 
	`mem£t
(&
sö
, 0,  sin);

1213 
sö
.
sö_Ámûy
 = 
AF_INET
;

1214 
sö
.
sö_addr
 = 
addr
;

1215 
sö
.
sö_p‹t
 = 0;

1217 
	`mem£t
(
ß
, 0,  *sa);

1218 
	`mem˝y
(
ß
, &
sö
,  sin);

1219 
	}
}

1222 
	$do_£t_addr
(
√tdev
 *√tdev, 
sock
,

1223 
io˘l_ƒ
, c⁄° *
io˘l_«me
, 
ö_addr
 
addr
)

1225 
i‰eq
 
i‰
;

1226 
îr‹
;

1228 
	`°∫˝y
(
i‰
.
i‰_«me
, 
√tdev
->
«me
,  ifr.ifr_name);

1229 
	`make_ö4_sockaddr
(&
i‰
.
i‰_addr
, 
addr
);

1230 
îr‹
 = 
	`io˘l
(
sock
, 
io˘l_ƒ
, &
i‰
Ë< 0 ? 
î∫o
 : 0;

1231 i‡(
îr‹
) {

1232 
	`VLOG_WARN
(
LOG_MODULE
, "io˘l(%s): %s", 
io˘l_«me
, 
	`°ªº‹
(
îr‹
));

1234  
îr‹
;

1235 
	}
}

1241 
	$√tdev_£t_ö4
(
√tdev
 *√tdev, 
ö_addr
 
addr
, ö_add∏
mask
)

1243 
îr‹
;

1245 
îr‹
 = 
	`do_£t_addr
(
√tdev
, 
af_öë_sock
,

1246 
SIOCSIFADDR
, "SIOCSIFADDR", 
addr
);

1247 i‡(!
îr‹
 && 
addr
.
s_addr
 !
INADDR_ANY
) {

1248 
îr‹
 = 
	`do_£t_addr
(
√tdev
, 
af_öë_sock
,

1249 
SIOCSIFNETMASK
, "SIOCSIFNETMASK", 
mask
);

1251  
îr‹
;

1252 
	}
}

1256 
	$√tdev_add_rouãr
(
ö_addr
 
rouãr
)

1258 
ö_addr
 
™y
 = { 
INADDR_ANY
 };

1259 
πíåy
 
π
;

1260 
îr‹
;

1262 
	`mem£t
(&
π
, 0, Ñt);

1263 
	`make_ö4_sockaddr
(&
π
.
π_d°
, 
™y
);

1264 
	`make_ö4_sockaddr
(&
π
.
π_g©eway
, 
rouãr
);

1265 
	`make_ö4_sockaddr
(&
π
.
π_gímask
, 
™y
);

1266 
π
.
π_Êags
 = 
RTF_UP
 | 
RTF_GATEWAY
;

1267 
îr‹
 = 
	`io˘l
(
af_öë_sock
, 
SIOCADDRT
, &
π
Ë< 0 ? 
î∫o
 : 0;

1268 i‡(
îr‹
) {

1269 
	`VLOG_WARN
(
LOG_MODULE
, "io˘l(SIOCADDRT): %s", 
	`°ªº‹
(
îr‹
));

1271  
îr‹
;

1272 
	}
}

1276 
boﬁ


1277 
	$√tdev_gë_ö6
(c⁄° 
√tdev
 *√tdev, 
ö6_addr
 *
ö6
)

1279 i‡(
ö6
) {

1280 *
ö6
 = 
√tdev
->in6;

1282  
	`memcmp
(&
√tdev
->
ö6
, &
ö6addr_™y
, Çetdev->in6) != 0;

1283 
	}
}

1288 
	$√tdev_gë_Êags
(c⁄° 
√tdev
 *√tdev, 
√tdev_Êags
 *
Êag•
)

1290  
	`√tdev_nodev_gë_Êags
(
√tdev
->
«me
, 
Êag•
);

1291 
	}
}

1294 
	$nd_to_iff_Êags
(
√tdev_Êags
 
nd
)

1296 
iff
 = 0;

1297 i‡(
nd
 & 
NETDEV_UP
) {

1298 
iff
 |
IFF_UP
;

1300 i‡(
nd
 & 
NETDEV_PROMISC
) {

1301 
iff
 |
IFF_PROMISC
;

1303  
iff
;

1304 
	}
}

1311 
	$do_upd©e_Êags
(
√tdev
 *√tdev, 
√tdev_Êags
 
off
,

1312 
√tdev_Êags
 
⁄
, 
boﬁ
 
≥rm™ít
)

1314 
ﬁd_Êags
, 
√w_Êags
;

1315 
îr‹
;

1317 
îr‹
 = 
	`gë_Êags
(
√tdev
->
«me
, &
ﬁd_Êags
);

1318 i‡(
îr‹
) {

1319  
îr‹
;

1322 
√w_Êags
 = (
ﬁd_Êags
 & ~
	`nd_to_iff_Êags
(
off
)Ë|Çd_to_iff_Êags(
⁄
);

1323 i‡(!
≥rm™ít
) {

1324 
√tdev
->
ch™ged_Êags
 |
√w_Êags
 ^ 
ﬁd_Êags
;

1326 i‡(
√w_Êags
 !
ﬁd_Êags
) {

1327 
îr‹
 = 
	`£t_Êags
(
√tdev
->
«me
, 
√w_Êags
);

1329  
îr‹
;

1330 
	}
}

1337 
	$√tdev_£t_Êags
(
√tdev
 *√tdev, 
√tdev_Êags
 
Êags
,

1338 
boﬁ
 
≥rm™ít
)

1340  
	`do_upd©e_Êags
(
√tdev
, -1, 
Êags
, 
≥rm™ít
);

1341 
	}
}

1348 
	$√tdev_tu∫_Êags_⁄
(
√tdev
 *√tdev, 
√tdev_Êags
 
Êags
,

1349 
boﬁ
 
≥rm™ít
)

1351  
	`do_upd©e_Êags
(
√tdev
, 0, 
Êags
, 
≥rm™ít
);

1352 
	}
}

1359 
	$√tdev_tu∫_Êags_off
(
√tdev
 *√tdev, 
√tdev_Êags
 
Êags
,

1360 
boﬁ
 
≥rm™ít
)

1362  
	`do_upd©e_Êags
(
√tdev
, 
Êags
, 0, 
≥rm™ít
);

1363 
	}
}

1370 
	$√tdev_¨p_lookup
(c⁄° 
√tdev
 *netdev,

1371 
uöt32_t
 
ù
, 
uöt8_t
 
mac
[
ETH_ADDR_LEN
])

1373 
¨¥eq
 
r
;

1374 
sockaddr_ö
 *
∑
;

1375 
ªtvÆ
;

1377 
	`mem£t
(&
r
, 0, Ñ);

1378 
∑
 = (
sockaddr_ö
 *Ë&
r
.
¨p_∑
;

1379 
∑
->
sö_Ámûy
 = 
AF_INET
;

1380 
∑
->
sö_addr
.
s_addr
 = 
ù
;

1381 
∑
->
sö_p‹t
 = 0;

1382 
r
.
¨p_ha
.
ß_Ámûy
 = 
ARPHRD_ETHER
;

1383 
r
.
¨p_Êags
 = 0;

1384 
	`°∫˝y
(
r
.
¨p_dev
, 
√tdev
->
«me
, Ñ.arp_dev);

1385 
ªtvÆ
 = 
	`io˘l
(
af_öë_sock
, 
SIOCGARP
, &
r
Ë< 0 ? 
î∫o
 : 0;

1386 i‡(!
ªtvÆ
) {

1387 
	`mem˝y
(
mac
, 
r
.
¨p_ha
.
ß_d©a
, 
ETH_ADDR_LEN
);

1388 } i‡(
ªtvÆ
 !
ENXIO
) {

1389 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "%s: couldÇŸÜook u∞ARPÉ¡ry f‹ "
IP_FMT
": %s",

1390 
√tdev
->
«me
, 
	`IP_ARGS
(&
ù
), 
	`°ªº‹
(
ªtvÆ
));

1392  
ªtvÆ
;

1393 
	}
}

1397 
	$√tdev_íumî©e
(
svec
 *svec)

1399 
if_«meödex
 *
«mes
;

1401 
	`svec_öô
(
svec
);

1402 
«mes
 = 
	`if_«meödex
();

1403 i‡(
«mes
) {

1404 
size_t
 
i
;

1406 
i
 = 0; 
«mes
[i].
if_«me
 !
NULL
; i++) {

1407 
	`svec_add
(
svec
, 
«mes
[
i
].
if_«me
);

1409 
	`if_‰ì«meödex
(
«mes
);

1411 
	`VLOG_WARN
(
LOG_MODULE
, "couldÇot obtainÜist ofÇetwork deviceÇames: %s",

1412 
	`°ªº‹
(
î∫o
));

1414 
	}
}

1423 
	$√tdev_nodev_gë_Êags
(c⁄° *
√tdev_«me
, 
√tdev_Êags
 *
Êag•
)

1425 
îr‹
, 
Êags
;

1427 
	`öô_√tdev
();

1429 
îr‹
 = 
	`gë_Êags
(
√tdev_«me
, &
Êags
);

1430 i‡(
îr‹
) {

1431  
îr‹
;

1434 *
Êag•
 = 0;

1435 i‡(
Êags
 & 
IFF_UP
) {

1436 *
Êag•
 |
NETDEV_UP
;

1438 i‡(
Êags
 & 
IFF_PROMISC
) {

1439 *
Êag•
 |
NETDEV_PROMISC
;

1441 i‡(
Êags
 & 
IFF_LOWER_UP
) {

1442 *
Êag•
 |
NETDEV_CARRIER
;

1445 
	}
}

1447 
	s√tdev_m⁄ô‹
 {

1448 
∆_sock
 *
	msock
;

1449 
svec
 
	m√tdevs
;

1450 
svec
 
	mch™ged
;

1457 c⁄° 
∆_pﬁicy
 
	gπ∆gΩ_lök_pﬁicy
[] = {

1458 [
IFLA_IFNAME
] = { .
ty≥
 = 
NL_A_STRING
, .
	g›ti⁄Æ
 = 
Ál£
 },

1461 c⁄° *
lookup_√tdev
(c⁄° 
√tdev_m⁄ô‹
 *, const *);

1462 c⁄° *
p›_ch™ged
(
√tdev_m⁄ô‹
 *);

1463 c⁄° *
Æl_√tdevs_ch™ged
(
√tdev_m⁄ô‹
 *);

1470 
	$√tdev_m⁄ô‹_¸óã
(
√tdev_m⁄ô‹
 **
m⁄p
)

1472 
√tdev_m⁄ô‹
 *
m⁄
;

1473 
∆_sock
 *
sock
;

1474 
îr‹
;

1476 *
m⁄p
 = 
NULL
;

1477 
îr‹
 = 
	`∆_sock_¸óã
(
NETLINK_ROUTE
, 
RTNLGRP_LINK
, 0, 0, &
sock
);

1478 i‡(
îr‹
) {

1481 
	`VLOG_WARN
(
LOG_MODULE
, "couldÇŸ cª©êπ√éök sockë: %s", 
	`°ªº‹
(
îr‹
));

1482  
îr‹
;

1485 
m⁄
 = *
m⁄p
 = 
	`xmÆloc
( *mon);

1486 
m⁄
->
sock
 = sock;

1487 
	`svec_öô
(&
m⁄
->
√tdevs
);

1488 
	`svec_öô
(&
m⁄
->
ch™ged
);

1490 
	}
}

1493 
	$√tdev_m⁄ô‹_de°roy
(
√tdev_m⁄ô‹
 *
m⁄
)

1495 i‡(
m⁄
) {

1496 
	`∆_sock_de°roy
(
m⁄
->
sock
);

1497 
	`svec_de°roy
(&
m⁄
->
√tdevs
);

1498 
	`svec_de°roy
(&
m⁄
->
ch™ged
);

1499 
	`‰ì
(
m⁄
);

1501 
	}
}

1507 
	$√tdev_m⁄ô‹_£t_devi˚s
(
√tdev_m⁄ô‹
 *
m⁄
,

1508 **
√tdevs
, 
size_t
 
n_√tdevs
)

1510 
size_t
 
i
;

1512 
	`svec_˛ór
(&
m⁄
->
√tdevs
);

1513 
i
 = 0; i < 
n_√tdevs
; i++) {

1514 
	`svec_add
(&
m⁄
->
√tdevs
,Çëdevs[
i
]);

1516 
	`svec_s‹t
(&
m⁄
->
√tdevs
);

1517 
	}
}

1527 
	$√tdev_m⁄ô‹_pﬁl
(
√tdev_m⁄ô‹
 *
m⁄
)

1529 
vlog_øã_limô
 
¶ow_æ
 = 
	`VLOG_RATE_LIMIT_INIT
(1, 5);

1530 c⁄° *
ch™ged_«me
;

1532 
ch™ged_«me
 = 
	`p›_ch™ged
(
m⁄
);

1533 i‡(
ch™ged_«me
) {

1534  
ch™ged_«me
;

1538 
oÂbuf
 *
buf
;

1539 
ªtvÆ
;

1541 
ªtvÆ
 = 
	`∆_sock_ªcv
(
m⁄
->
sock
, &
buf
, 
Ál£
);

1542 i‡(
ªtvÆ
 =
EAGAIN
) {

1543  
NULL
;

1544 } i‡(
ªtvÆ
 =
ENOBUFS
) {

1545 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
¶ow_æ
, "network monitor socket overflowed");

1546  
	`Æl_√tdevs_ch™ged
(
m⁄
);

1547 } i‡(
ªtvÆ
) {

1548 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
¶ow_æ
, "error onÇetwork monitor socket: %s",

1549 
	`°ªº‹
(
ªtvÆ
));

1550  
NULL
;

1552 
∆©å
 *
©ås
[
	`ARRAY_SIZE
(
π∆gΩ_lök_pﬁicy
)];

1553 c⁄° *
«me
;

1555 i‡(!
	`∆_pﬁicy_∑r£
(
buf
, 
NLMSG_HDRLEN
 + (
iföfomsg
),

1556 
π∆gΩ_lök_pﬁicy
,

1557 
©ås
, 
	`ARRAY_SIZE
(
π∆gΩ_lök_pﬁicy
))) {

1558 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
¶ow_æ
, "received badÑtnl message");

1559  
	`Æl_√tdevs_ch™ged
(
m⁄
);

1561 
«me
 = 
	`lookup_√tdev
(
m⁄
, 
	`∆_©å_gë_°rög
(
©ås
[
IFLA_IFNAME
]));

1562 
	`oÂbuf_dñëe
(
buf
);

1563 i‡(
«me
) {

1566  
«me
;

1570 
	}
}

1573 
	$√tdev_m⁄ô‹_run
(
√tdev_m⁄ô‹
 *
m⁄
 
UNUSED
)

1576 
	}
}

1579 
	$√tdev_m⁄ô‹_waô
(
√tdev_m⁄ô‹
 *
m⁄
)

1581 
	`∆_sock_waô
(
m⁄
->
sock
, 
POLLIN
);

1582 
	}
}

1585 
	$lookup_√tdev
(c⁄° 
√tdev_m⁄ô‹
 *
m⁄
, c⁄° *
«me
)

1587 
size_t
 
idx
 = 
	`svec_föd
(&
m⁄
->
√tdevs
, 
«me
);

1588  
idx
 !
SIZE_MAX
 ? 
m⁄
->
√tdevs
.
«mes
[idx] : 
NULL
;

1589 
	}
}

1592 
	$p›_ch™ged
(
√tdev_m⁄ô‹
 *
m⁄
)

1594 
m⁄
->
ch™ged
.
n
) {

1595 c⁄° *
«me
 = 
	`lookup_√tdev
(
m⁄
, 
	`svec_back
(&m⁄->
ch™ged
));

1596 
	`svec_p›_back
(&
m⁄
->
ch™ged
);

1597 i‡(
«me
) {

1598  
«me
;

1601  
NULL
;

1602 
	}
}

1605 
	$Æl_√tdevs_ch™ged
(
√tdev_m⁄ô‹
 *
m⁄
)

1607 
	`svec_˛ór
(&
m⁄
->
ch™ged
);

1608 
	`svec_≠≥nd
(&
m⁄
->
ch™ged
, &m⁄->
√tdevs
);

1609  
	`p›_ch™ged
(
m⁄
);

1610 
	}
}

1612 
ª°‹e_Æl_Êags
(*
aux
);

1617 
	$öô_√tdev
()

1619 
boﬁ
 
öôed
;

1620 i‡(!
öôed
) {

1621 
öôed
 = 
åue
;

1622 
	`Áèl_sig«l_add_hook
(
ª°‹e_Æl_Êags
, 
NULL
, 
åue
);

1623 
af_öë_sock
 = 
	`sockë
(
AF_INET
, 
SOCK_DGRAM
, 0);

1624 i‡(
af_öë_sock
 < 0) {

1625 
	`oÂ_Áèl
(
î∫o
, "socket(AF_INET)");

1628 
	}
}

1636 
	$ª°‹e_Êags
(
√tdev
 *netdev)

1638 
i‰eq
 
i‰
;

1639 
ª°‹e_Êags
;

1642 
	`°∫˝y
(
i‰
.
i‰_«me
, 
√tdev
->
«me
,  ifr.ifr_name);

1643 i‡(
	`io˘l
(
√tdev
->
√tdev_fd
, 
SIOCGIFFLAGS
, &
i‰
) < 0) {

1644  
î∫o
;

1648 
ª°‹e_Êags
 = 
√tdev
->
ch™ged_Êags
 & (
IFF_PROMISC
 | 
IFF_UP
);

1649 i‡((
i‰
.
i‰_Êags
 ^ 
√tdev
->
ßve_Êags
Ë& 
ª°‹e_Êags
) {

1650 
i‰
.
i‰_Êags
 &~
ª°‹e_Êags
;

1651 
i‰
.
i‰_Êags
 |
√tdev
->
ßve_Êags
 & 
ª°‹e_Êags
;

1652 i‡(
	`io˘l
(
√tdev
->
√tdev_fd
, 
SIOCSIFFLAGS
, &
i‰
) < 0) {

1653  
î∫o
;

1658 
	}
}

1663 
	$ª°‹e_Æl_Êags
(*
aux
 
UNUSED
)

1665 
√tdev
 *netdev;

1666 
	`LIST_FOR_EACH
 (
√tdev
, √tdev, 
node
, &
√tdev_li°
) {

1667 
	`ª°‹e_Êags
(
√tdev
);

1669 
	}
}

1672 
	$gë_Êags
(c⁄° *
√tdev_«me
, *
Êags
)

1674 
i‰eq
 
i‰
;

1675 
	`°∫˝y
(
i‰
.
i‰_«me
, 
√tdev_«me
,  ifr.ifr_name);

1676 i‡(
	`io˘l
(
af_öë_sock
, 
SIOCGIFFLAGS
, &
i‰
) < 0) {

1677 
	`VLOG_ERR
(
LOG_MODULE
, "ioctl(SIOCGIFFLAGS) on %s device failed: %s",

1678 
√tdev_«me
, 
	`°ªº‹
(
î∫o
));

1679  
î∫o
;

1681 *
Êags
 = 
i‰
.
i‰_Êags
;

1683 
	}
}

1686 
	$£t_Êags
(c⁄° *
√tdev_«me
, 
Êags
)

1688 
i‰eq
 
i‰
;

1689 
	`°∫˝y
(
i‰
.
i‰_«me
, 
√tdev_«me
,  ifr.ifr_name);

1690 
i‰
.
i‰_Êags
 = 
Êags
;

1691 i‡(
	`io˘l
(
af_öë_sock
, 
SIOCSIFFLAGS
, &
i‰
) < 0) {

1692 
	`VLOG_ERR
(
LOG_MODULE
, "ioctl(SIOCSIFFLAGS) on %s device failed: %s",

1693 
√tdev_«me
, 
	`°ªº‹
(
î∫o
));

1694  
î∫o
;

1697 
	}
}

	@lib/netdev.h

34 #i‚de‡
NETDEV_H


35 
	#NETDEV_H
 1

	)

37 
	~<°dboﬁ.h
>

38 
	~<°ddef.h
>

39 
	~<°döt.h
>

47 
	goÂbuf
;

48 
	gö_addr
;

49 
	gö6_addr
;

50 
	gsvec
;

52 
	e√tdev_„©uª_ty≥
 {

53 
	mNETDEV_FEAT_CURRENT
,

54 
	mNETDEV_FEAT_ADVERTISED
,

55 
	mNETDEV_FEAT_SUPPORTED
,

56 
	mNETDEV_FEAT_PEER


59 
	e√tdev_Êags
 {

60 
	mNETDEV_UP
 = 0x0001,

61 
	mNETDEV_PROMISC
 = 0x0002,

62 
	mNETDEV_CARRIER
 = 0x0004

65 
	e√tdev_p£udo_ëhîty≥
 {

66 
	mNETDEV_ETH_TYPE_NONE
 = -128,

67 
	mNETDEV_ETH_TYPE_ANY
,

68 
	mNETDEV_ETH_TYPE_802_2


71 
	#NETDEV_MAX_QUEUES
 8

	)

73 
	g√tdev
;

75 
√tdev_›í
(c⁄° *
«me
, 
ëhîty≥
, 
√tdev
 **);

76 
√tdev_›í_èp
(c⁄° *
«me
, 
√tdev
 **);

77 
√tdev_˛o£
(
√tdev
 *);

79 
√tdev_ªcv
(
√tdev
 *, 
oÂbuf
 *);

80 
√tdev_ªcv_waô
(
√tdev
 *);

81 
√tdev_døö
(
√tdev
 *);

82 
√tdev_£nd
(
√tdev
 *, c⁄° 
oÂbuf
 *, 
uöt16_t
 
˛ass_id
);

83 
√tdev_£nd_waô
(
√tdev
 *);

84 
√tdev_£t_ëhîaddr
(
√tdev
 *, c⁄° 
uöt8_t
 
mac
[6]);

85 c⁄° 
uöt8_t
 *
√tdev_gë_ëhîaddr
(c⁄° 
√tdev
 *);

86 c⁄° *
√tdev_gë_«me
(c⁄° 
√tdev
 *);

87 
√tdev_gë_mtu
(c⁄° 
√tdev
 *);

88 
uöt32_t
 
√tdev_gë_„©uªs
(
√tdev
 *, );

89 
boﬁ
 
√tdev_gë_ö4
(c⁄° 
√tdev
 *, 
ö_addr
 *);

90 
√tdev_£t_ö4
(
√tdev
 *, 
ö_addr
 
addr
, ö_add∏
mask
);

91 
√tdev_add_rouãr
(
ö_addr
 
rouãr
);

92 
boﬁ
 
√tdev_gë_ö6
(c⁄° 
√tdev
 *, 
ö6_addr
 *);

93 
√tdev_gë_Êags
(c⁄° 
√tdev
 *, 
√tdev_Êags
 *);

94 
√tdev_£t_Êags
(
√tdev
 *, 
√tdev_Êags
, 
boﬁ
 
≥rm™ít
);

95 
√tdev_tu∫_Êags_⁄
(
√tdev
 *, 
√tdev_Êags
, 
boﬁ
 
≥rm™ít
);

96 
√tdev_tu∫_Êags_off
(
√tdev
 *, 
√tdev_Êags
, 
boﬁ
 
≥rm™ít
);

97 
√tdev_¨p_lookup
(c⁄° 
√tdev
 *, 
uöt32_t
 
ù
, 
uöt8_t
 
mac
[6]);

98 
√tdev_£tup_¶icög
(
√tdev
 *, 
uöt16_t
);

99 
√tdev_£tup_˛ass
(c⁄° 
√tdev
 *, 
uöt16_t
 , uint16_t);

100 
√tdev_ch™ge_˛ass
(c⁄° 
√tdev
 *, 
uöt16_t
 , uint16_t);

101 
√tdev_dñëe_˛ass
(c⁄° 
√tdev
 *, 
uöt16_t
);

103 
√tdev_íumî©e
(
svec
 *);

104 
√tdev_nodev_gë_Êags
(c⁄° *
√tdev_«me
, 
√tdev_Êags
 *);

112 
	g√tdev_m⁄ô‹
;

113 
√tdev_m⁄ô‹_¸óã
(
√tdev_m⁄ô‹
 **);

114 
√tdev_m⁄ô‹_de°roy
(
√tdev_m⁄ô‹
 *);

115 
√tdev_m⁄ô‹_£t_devi˚s
(
√tdev_m⁄ô‹
 *, **, 
size_t
);

116 c⁄° *
√tdev_m⁄ô‹_pﬁl
(
√tdev_m⁄ô‹
 *);

117 
√tdev_m⁄ô‹_run
(
√tdev_m⁄ô‹
 *);

118 
√tdev_m⁄ô‹_waô
(
√tdev_m⁄ô‹
 *);

	@lib/netlink-protocol.h

34 #i‚de‡
NETLINK_PROTOCOL_H


35 
	#NETLINK_PROTOCOL_H
 1

	)

42 
	~<°döt.h
>

43 
	~<sys/sockë.h
>

44 
	~"utû.h
"

46 
	#NETLINK_GENERIC
 16

	)

48 
	ssockaddr_∆
 {

49 
ß_Ámûy_t
 
	m∆_Ámûy
;

50 
	m∆_∑d
;

51 
uöt32_t
 
	m∆_pid
;

52 
uöt32_t
 
	m∆_groups
;

54 
BUILD_ASSERT_DECL
((
sockaddr_∆
) == 12);

57 
	#NLM_F_REQUEST
 0x001

	)

58 
	#NLM_F_MULTI
 0x002

	)

59 
	#NLM_F_ACK
 0x004

	)

60 
	#NLM_F_ECHO
 0x008

	)

62 
	#NLM_F_ROOT
 0x100

	)

63 
	#NLM_F_MATCH
 0x200

	)

64 
	#NLM_F_ATOMIC
 0x400

	)

65 
	#NLM_F_DUMP
 (
NLM_F_ROOT
 | 
NLM_F_MATCH
)

	)

68 
	#NLMSG_NOOP
 1

	)

69 
	#NLMSG_ERROR
 2

	)

70 
	#NLMSG_DONE
 3

	)

71 
	#NLMSG_OVERRUN
 4

	)

73 
	#NLMSG_MIN_TYPE
 0x10

	)

75 
	s∆msghdr
 {

76 
uöt32_t
 
	m∆msg_Àn
;

77 
uöt16_t
 
	m∆msg_ty≥
;

78 
uöt16_t
 
	m∆msg_Êags
;

79 
uöt32_t
 
	m∆msg_£q
;

80 
uöt32_t
 
	m∆msg_pid
;

82 
BUILD_ASSERT_DECL
((
∆msghdr
) == 16);

84 
	#NLMSG_ALIGNTO
 4

	)

85 
	#NLMSG_ALIGN
(
SIZE
Ë
	`ROUND_UP
(SIZE, 
NLMSG_ALIGNTO
)

	)

86 
	#NLMSG_HDRLEN
 ((Ë
	`NLMSG_ALIGN
((
∆msghdr
)))

	)

88 
	s∆msgîr


90 
	mîr‹
;

91 
∆msghdr
 
	mmsg
;

93 
BUILD_ASSERT_DECL
((
∆msgîr
) == 20);

95 
	#NETLINK_ADD_MEMBERSHIP
 1

	)

96 
	#NETLINK_DROP_MEMBERSHIP
 2

	)

97 
	#NETLINK_PKTINFO
 3

	)

99 
	sgílmsghdr
 {

100 
uöt8_t
 
	mcmd
;

101 
uöt8_t
 
	mvîsi⁄
;

102 
uöt16_t
 
	mª£rved
;

104 
BUILD_ASSERT_DECL
((
gílmsghdr
) == 4);

106 
	#GENL_HDRLEN
 
	`NLMSG_ALIGN
((
gílmsghdr
))

	)

108 
	s∆©å
 {

109 
uöt16_t
 
	m∆a_Àn
;

110 
uöt16_t
 
	m∆a_ty≥
;

112 
BUILD_ASSERT_DECL
((
∆©å
) == 4);

114 
	#NLA_ALIGNTO
 4

	)

115 
	#NLA_ALIGN
(
SIZE
Ë
	`ROUND_UP
(SIZE, 
NLA_ALIGNTO
)

	)

116 
	#NLA_HDRLEN
 ((Ë
	`NLA_ALIGN
((
∆©å
)))

	)

118 
	#GENL_MIN_ID
 
NLMSG_MIN_TYPE


	)

119 
	#GENL_MAX_ID
 1023

	)

121 
	#GENL_ID_CTRL
 
NLMSG_MIN_TYPE


	)

124 
	mCTRL_CMD_UNSPEC
,

125 
	mCTRL_CMD_NEWFAMILY
,

126 
	mCTRL_CMD_DELFAMILY
,

127 
	mCTRL_CMD_GETFAMILY
,

128 
	mCTRL_CMD_NEWOPS
,

129 
	mCTRL_CMD_DELOPS
,

130 
	mCTRL_CMD_GETOPS
,

131 
	m__CTRL_CMD_MAX
,

134 
	#CTRL_CMD_MAX
 (
__CTRL_CMD_MAX
 - 1)

	)

137 
	mCTRL_ATTR_UNSPEC
,

138 
	mCTRL_ATTR_FAMILY_ID
,

139 
	mCTRL_ATTR_FAMILY_NAME
,

140 
	mCTRL_ATTR_VERSION
,

141 
	mCTRL_ATTR_HDRSIZE
,

142 
	mCTRL_ATTR_MAXATTR
,

143 
	mCTRL_ATTR_OPS
,

144 
	m__CTRL_ATTR_MAX
,

147 
	#CTRL_ATTR_MAX
 (
__CTRL_ATTR_MAX
 - 1)

	)

150 
	mCTRL_ATTR_OP_UNSPEC
,

151 
	mCTRL_ATTR_OP_ID
,

152 
	mCTRL_ATTR_OP_FLAGS
,

153 
	m__CTRL_ATTR_OP_MAX
,

156 
	#CTRL_ATTR_OP_MAX
 (
__CTRL_ATTR_OP_MAX
 - 1)

	)

	@lib/netlink.c

34 
	~<c⁄fig.h
>

35 
	~"√éök.h
"

36 
	~<as£π.h
>

37 
	~<î∫o.h
>

38 
	~<öây≥s.h
>

39 
	~<°dio.h
>

40 
	~<°dlib.h
>

41 
	~<°rög.h
>

42 
	~<time.h
>

43 
	~<uni°d.h
>

44 
	~"dy«mic-°rög.h
"

45 
	~"√éök-¥Ÿocﬁ.h
"

46 
	~"oÂbuf.h
"

47 
	~"pﬁl-lo›.h
"

48 
	~"timevÆ.h
"

49 
	~"utû.h
"

51 
	~"vlog.h
"

52 
	#LOG_MODULE
 
VLM_√éök


	)

55 #i‚de‡
SOL_NETLINK


56 
	#SOL_NETLINK
 270

	)

62 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(60, 600);

64 
log_∆msg
(c⁄° *
fun˘i⁄
, 
îr‹
,

65 c⁄° *
mesßge
, 
size_t
 
size
);

69 
	s∆_sock


71 
	mfd
;

72 
uöt32_t
 
	mpid
;

83 
uöt32_t
 
	g√xt_£q
;

85 
Æloc_pid
(
uöt32_t
 *);

86 
‰ì_pid
(
uöt32_t
);

100 
	$∆_sock_¸óã
(
¥Ÿocﬁ
, 
mu…iˇ°_group
,

101 
size_t
 
so_¢dbuf
, size_à
so_rcvbuf
, 
∆_sock
 **
sockp
)

103 
∆_sock
 *
sock
;

104 
sockaddr_∆
 
loˇl
, 
ªmŸe
;

105 
ªtvÆ
 = 0;

107 i‡(
√xt_£q
 == 0) {

109 
√xt_£q
 = 
	`gëpid
(Ë^ 
	`time_now
();

112 *
sockp
 = 
NULL
;

113 
sock
 = 
	`mÆloc
( *sock);

114 i‡(
sock
 =
NULL
) {

115  
ENOMEM
;

118 
sock
->
fd
 = 
	`sockë
(
AF_NETLINK
, 
SOCK_RAW
, 
¥Ÿocﬁ
);

119 i‡(
sock
->
fd
 < 0) {

120 
	`VLOG_ERR
(
LOG_MODULE
, "f˙é: %s", 
	`°ªº‹
(
î∫o
));

121 
îr‹
;

124 
ªtvÆ
 = 
	`Æloc_pid
(&
sock
->
pid
);

125 i‡(
ªtvÆ
) {

126 
îr‹
;

129 i‡(
so_¢dbuf
 != 0

130 && 
	`£tsock›t
(
sock
->
fd
, 
SOL_SOCKET
, 
SO_SNDBUF
,

131 &
so_¢dbuf
,  so_sndbuf) < 0) {

132 
	`VLOG_ERR
(
LOG_MODULE
, "£tsock›t(SO_SNDBUF,%zu): %s", 
so_¢dbuf
, 
	`°ªº‹
(
î∫o
));

133 
îr‹_‰ì_pid
;

136 i‡(
so_rcvbuf
 != 0

137 && 
	`£tsock›t
(
sock
->
fd
, 
SOL_SOCKET
, 
SO_RCVBUF
,

138 &
so_rcvbuf
,  so_rcvbuf) < 0) {

139 
	`VLOG_ERR
(
LOG_MODULE
, "£tsock›t(SO_RCVBUF,%zu): %s", 
so_rcvbuf
, 
	`°ªº‹
(
î∫o
));

140 
îr‹_‰ì_pid
;

144 
	`mem£t
(&
loˇl
, 0, Üocal);

145 
loˇl
.
∆_Ámûy
 = 
AF_NETLINK
;

146 
loˇl
.
∆_pid
 = 
sock
->
pid
;

147 i‡(
mu…iˇ°_group
 > 0 && multicast_group <= 32) {

150 
loˇl
.
∆_groups
 |1u»<< (
mu…iˇ°_group
 - 1);

152 i‡(
	`böd
(
sock
->
fd
, (
sockaddr
 *Ë&
loˇl
, Üocal) < 0) {

153 
	`VLOG_ERR
(
LOG_MODULE
, "böd(%"
PRIu32
"): %s", 
sock
->
pid
, 
	`°ªº‹
(
î∫o
));

154 
îr‹_‰ì_pid
;

158 
	`mem£t
(&
ªmŸe
, 0, Ñemote);

159 
ªmŸe
.
∆_Ámûy
 = 
AF_NETLINK
;

160 
ªmŸe
.
∆_pid
 = 0;

161 i‡(
	`c⁄√˘
(
sock
->
fd
, (
sockaddr
 *Ë&
ªmŸe
, Ñemote) < 0) {

162 
	`VLOG_ERR
(
LOG_MODULE
, "c⁄√˘(0): %s", 
	`°ªº‹
(
î∫o
));

163 
îr‹_‰ì_pid
;

169 #i‚de‡
NETLINK_ADD_MEMBERSHIP


170 
	#NETLINK_ADD_MEMBERSHIP
 1

	)

175 i‡(
mu…iˇ°_group
 > 32

176 && 
	`£tsock›t
(
sock
->
fd
, 
SOL_NETLINK
, 
NETLINK_ADD_MEMBERSHIP
,

177 &
mu…iˇ°_group
,  multicast_group) < 0) {

178 
	`VLOG_ERR
(
LOG_MODULE
, "setsockopt(NETLINK_ADD_MEMBERSHIP,%d): %s",

179 
mu…iˇ°_group
, 
	`°ªº‹
(
î∫o
));

180 
îr‹_‰ì_pid
;

183 *
sockp
 = 
sock
;

186 
îr‹_‰ì_pid
:

187 
	`‰ì_pid
(
sock
->
pid
);

188 
îr‹
:

189 i‡(
ªtvÆ
 == 0) {

190 
ªtvÆ
 = 
î∫o
;

191 i‡(
ªtvÆ
 == 0) {

192 
ªtvÆ
 = 
EINVAL
;

195 i‡(
sock
->
fd
 >= 0) {

196 
	`˛o£
(
sock
->
fd
);

198 
	`‰ì
(
sock
);

199  
ªtvÆ
;

200 
	}
}

204 
	$∆_sock_de°roy
(
∆_sock
 *
sock
)

206 i‡(
sock
) {

207 
	`˛o£
(
sock
->
fd
);

208 
	`‰ì_pid
(
sock
->
pid
);

209 
	`‰ì
(
sock
);

211 
	}
}

221 
	$∆_sock_£nd
(
∆_sock
 *
sock
, c⁄° 
oÂbuf
 *
msg
, 
boﬁ
 
waô
)

223 
îr‹
;

225 
	`∆_msg_∆msghdr
(
msg
)->
∆msg_Àn
 = msg->
size
;

227 
ªtvÆ
;

228 
ªtvÆ
 = 
	`£nd
(
sock
->
fd
, 
msg
->
d©a
, msg->
size
, 
waô
 ? 0 : 
MSG_DONTWAIT
);

229 
îr‹
 = 
ªtvÆ
 < 0 ? 
î∫o
 : 0;

230 } 
îr‹
 =
EINTR
);

231 
	`log_∆msg
(
__func__
, 
îr‹
, 
msg
->
d©a
, msg->
size
);

232  
îr‹
;

233 
	}
}

243 
	$∆_sock_£ndv
(
∆_sock
 *
sock
, c⁄° 
iovec
 
iov
[], 
size_t
 
n_iov
,

244 
boﬁ
 
waô
)

246 
msghdr
 
msg
;

247 
îr‹
;

249 
	`mem£t
(&
msg
, 0,  msg);

250 
msg
.
msg_iov
 = (
iovec
 *Ë
iov
;

251 
msg
.
msg_iovÀn
 = 
n_iov
;

253 
ªtvÆ
;

254 
ªtvÆ
 = 
	`£ndmsg
(
sock
->
fd
, &
msg
, 
waô
 ? 0 : 
MSG_DONTWAIT
);

255 
îr‹
 = 
ªtvÆ
 < 0 ? 
î∫o
 : 0;

256 } 
îr‹
 =
EINTR
);

257 i‡(
îr‹
 !
EAGAIN
) {

258 
	`log_∆msg
(
__func__
, 
îr‹
, 
iov
[0].
iov_ba£
, iov[0].
iov_Àn
);

260  
îr‹
;

261 
	}
}

272 
	$∆_sock_ªcv
(
∆_sock
 *
sock
, 
oÂbuf
 **
buÂ
, 
boﬁ
 
waô
)

274 
uöt8_t
 
tmp
;

275 
ssize_t
 
bufsize
 = 2048;

276 
ssize_t
 
nbyãs
, 
nbyãs2
;

277 
oÂbuf
 *
buf
;

278 
∆msghdr
 *nlmsghdr;

279 
iovec
 
iov
;

280 
msghdr
 
msg
 = {

281 .
msg_«me
 = 
NULL
,

282 .
msg_«mñí
 = 0,

283 .
msg_iov
 = &
iov
,

284 .
msg_iovÀn
 = 1,

285 .
msg_c⁄åﬁ
 = 
NULL
,

286 .
msg_c⁄åﬁÀn
 = 0,

287 .
msg_Êags
 = 0

290 
buf
 = 
	`oÂbuf_√w
(
bufsize
);

291 *
buÂ
 = 
NULL
;

293 
åy_agaö
:

298 
∆msghdr
 = 
	`oÂbuf_put_unöô
(
buf
, 
bufsize
);

299 
iov
.
iov_ba£
 = 
∆msghdr
;

300 
iov
.
iov_Àn
 = 
bufsize
;

302 
nbyãs
 = 
	`ªcvmsg
(
sock
->
fd
, &
msg
, (
waô
 ? 0 : 
MSG_DONTWAIT
Ë| 
MSG_PEEK
);

303 } 
nbyãs
 < 0 && 
î∫o
 =
EINTR
);

304 i‡(
nbyãs
 < 0) {

305 
	`oÂbuf_dñëe
(
buf
);

306  
î∫o
;

308 i‡(
msg
.
msg_Êags
 & 
MSG_TRUNC
) {

309 
bufsize
 *= 2;

310 
	`oÂbuf_ªöô
(
buf
, 
bufsize
);

311 
åy_agaö
;

313 
buf
->
size
 = 
nbyãs
;

316 
iov
.
iov_ba£
 = &
tmp
;

317 
iov
.
iov_Àn
 = 1;

319 
nbyãs2
 = 
	`ªcvmsg
(
sock
->
fd
, &
msg
, 
MSG_DONTWAIT
);

320 } 
nbyãs2
 < 0 && 
î∫o
 =
EINTR
);

321 i‡(
nbyãs2
 < 0) {

322 i‡(
î∫o
 =
ENOBUFS
) {

327 
	`oÂbuf_dñëe
(
buf
);

328  
ENOBUFS
;

330 
	`VLOG_ERR_RL
(
LOG_MODULE
, &
æ
, "failedÅoÑemoveÇlmsg from socket: %s\n",

331 
	`°ªº‹
(
î∫o
));

334 i‡(
nbyãs
 <  *
∆msghdr


335 || 
∆msghdr
->
∆msg_Àn
 <  *nlmsghdr

336 || 
∆msghdr
->
∆msg_Àn
 > 
nbyãs
) {

337 
	`VLOG_ERR_RL
(
LOG_MODULE
, &
æ
, "received invalidÇlmsg (%zd bytes < %d)",

338 
bufsize
, 
NLMSG_HDRLEN
);

339 
	`oÂbuf_dñëe
(
buf
);

340  
EPROTO
;

342 *
buÂ
 = 
buf
;

343 
	`log_∆msg
(
__func__
, 0, 
buf
->
d©a
, buf->
size
);

345 
	}
}

379 
	$∆_sock_å™ß˘
(
∆_sock
 *
sock
,

380 c⁄° 
oÂbuf
 *
ªque°
, oÂbu‡**
ª∂yp
)

382 
uöt32_t
 
£q
 = 
	`∆_msg_∆msghdr
(
ªque°
)->
∆msg_£q
;

383 
∆msghdr
 *nlmsghdr;

384 
oÂbuf
 *
ª∂y
;

385 
ªtvÆ
;

387 *
ª∂yp
 = 
NULL
;

391 
	`∆_msg_∆msghdr
(
ªque°
)->
∆msg_Êags
 |
NLM_F_ACK
;

393 
£nd
:

394 
ªtvÆ
 = 
	`∆_sock_£nd
(
sock
, 
ªque°
, 
åue
);

395 i‡(
ªtvÆ
) {

396  
ªtvÆ
;

399 
ªcv
:

400 
ªtvÆ
 = 
	`∆_sock_ªcv
(
sock
, &
ª∂y
, 
åue
);

401 i‡(
ªtvÆ
) {

402 i‡(
ªtvÆ
 =
ENOBUFS
) {

403 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "receive buffer overflow,ÑesendingÑequest");

404 
£nd
;

406  
ªtvÆ
;

409 
∆msghdr
 = 
	`∆_msg_∆msghdr
(
ª∂y
);

410 i‡(
£q
 !
∆msghdr
->
∆msg_£q
) {

411 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "ign‹ög seq %"
PRIu32
" !=Éxpected %"PRIu32,

412 
	`∆_msg_∆msghdr
(
ª∂y
)->
∆msg_£q
, 
£q
);

413 
	`oÂbuf_dñëe
(
ª∂y
);

414 
ªcv
;

416 i‡(
	`∆_msg_∆msgîr
(
ª∂y
, &
ªtvÆ
)) {

417 
	`oÂbuf_dñëe
(
ª∂y
);

418 i‡(
ªtvÆ
) {

419 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "received NAKÉrror=%d (%s)",

420 
ªtvÆ
, 
	`°ªº‹
(retval));

422  
ªtvÆ
 !
EAGAIN
 ?ÑëvÆ : 
EPROTO
;

425 *
ª∂yp
 = 
ª∂y
;

427 
	}
}

432 
	$∆_sock_waô
(c⁄° 
∆_sock
 *
sock
, 
evíts
)

434 
	`pﬁl_fd_waô
(
sock
->
fd
, 
evíts
);

435 
	}
}

442 
∆msghdr
 *

443 
	$∆_msg_∆msghdr
(c⁄° 
oÂbuf
 *
msg
)

445  
	`oÂbuf_©_as£π
(
msg
, 0, 
NLMSG_HDRLEN
);

446 
	}
}

452 
gílmsghdr
 *

453 
	$∆_msg_gílmsghdr
(c⁄° 
oÂbuf
 *
msg
)

455  
	`oÂbuf_©
(
msg
, 
NLMSG_HDRLEN
, 
GENL_HDRLEN
);

456 
	}
}

463 
boﬁ


464 
	$∆_msg_∆msgîr
(c⁄° 
oÂbuf
 *
msg
, *
îr‹p
)

466 i‡(
	`∆_msg_∆msghdr
(
msg
)->
∆msg_ty≥
 =
NLMSG_ERROR
) {

467 
∆msgîr
 *
îr
 = 
	`oÂbuf_©
(
msg
, 
NLMSG_HDRLEN
,  *err);

468 
code
 = 
EPROTO
;

469 i‡(!
îr
) {

470 
	`VLOG_ERR_RL
(
LOG_MODULE
, &
æ
, "received invalidÇlmsgerr (%zd bytes < %zd)",

471 
msg
->
size
, 
NLMSG_HDRLEN
 +  *
îr
);

472 } i‡(
îr
->
îr‹
 <0 &&Éº->îr‹ > 
INT_MIN
) {

473 
code
 = -
îr
->
îr‹
;

475 i‡(
îr‹p
) {

476 *
îr‹p
 = 
code
;

478  
åue
;

480  
Ál£
;

482 
	}
}

487 
	$∆_msg_ª£rve
(
oÂbuf
 *
msg
, 
size_t
 
size
)

489 
	`oÂbuf_¥óŒoc_èûroom
(
msg
, 
	`NLMSG_ALIGN
(
size
));

490 
	}
}

509 
	$∆_msg_put_∆msghdr
(
oÂbuf
 *
msg
, 
∆_sock
 *
sock
,

510 
size_t
 
ex≥˘ed_∑ylﬂd
, 
uöt32_t
 
ty≥
, uöt32_à
Êags
)

512 
∆msghdr
 *nlmsghdr;

514 
	`as£π
(
msg
->
size
 == 0);

516 
	`∆_msg_ª£rve
(
msg
, 
NLMSG_HDRLEN
 + 
ex≥˘ed_∑ylﬂd
);

517 
∆msghdr
 = 
	`∆_msg_put_unöô
(
msg
, 
NLMSG_HDRLEN
);

518 
∆msghdr
->
∆msg_Àn
 = 0;

519 
∆msghdr
->
∆msg_ty≥
 = 
ty≥
;

520 
∆msghdr
->
∆msg_Êags
 = 
Êags
;

521 
∆msghdr
->
∆msg_£q
 = ++
√xt_£q
;

522 
∆msghdr
->
∆msg_pid
 = 
sock
->
pid
;

523 
	}
}

545 
	$∆_msg_put_gílmsghdr
(
oÂbuf
 *
msg
, 
∆_sock
 *
sock
,

546 
size_t
 
ex≥˘ed_∑ylﬂd
, 
Ámûy
, 
uöt32_t
 
Êags
,

547 
uöt8_t
 
cmd
, uöt8_à
vîsi⁄
)

549 
gílmsghdr
 *genlmsghdr;

551 
	`∆_msg_put_∆msghdr
(
msg
, 
sock
, 
GENL_HDRLEN
 + 
ex≥˘ed_∑ylﬂd
,

552 
Ámûy
, 
Êags
);

553 
	`as£π
(
msg
->
size
 =
NLMSG_HDRLEN
);

554 
gílmsghdr
 = 
	`∆_msg_put_unöô
(
msg
, 
GENL_HDRLEN
);

555 
gílmsghdr
->
cmd
 = cmd;

556 
gílmsghdr
->
vîsi⁄
 = version;

557 
gílmsghdr
->
ª£rved
 = 0;

558 
	}
}

564 
	$∆_msg_put
(
oÂbuf
 *
msg
, c⁄° *
d©a
, 
size_t
 
size
)

566 
	`mem˝y
(
	`∆_msg_put_unöô
(
msg
, 
size
), 
d©a
, size);

567 
	}
}

573 
	$∆_msg_put_unöô
(
oÂbuf
 *
msg
, 
size_t
 
size
)

575 
size_t
 
∑d
 = 
	`NLMSG_ALIGN
(
size
) - size;

576 *
p
 = 
	`oÂbuf_put_unöô
(
msg
, 
size
 + 
∑d
);

577 i‡(
∑d
) {

578 
	`mem£t
(
p
 + 
size
, 0, 
∑d
);

580  
p
;

581 
	}
}

588 
	$∆_msg_put_un•ec_unöô
(
oÂbuf
 *
msg
, 
uöt16_t
 
ty≥
, 
size_t
 
size
)

590 
size_t
 
tŸÆ_size
 = 
NLA_HDRLEN
 + 
size
;

591 
∆©å
* 
∆a
 = 
	`∆_msg_put_unöô
(
msg
, 
tŸÆ_size
);

592 
	`as£π
(
	`NLA_ALIGN
(
tŸÆ_size
Ë<
UINT16_MAX
);

593 
∆a
->
∆a_Àn
 = 
tŸÆ_size
;

594 
∆a
->
∆a_ty≥
 = 
ty≥
;

595  
∆a
 + 1;

596 
	}
}

603 
	$∆_msg_put_un•ec
(
oÂbuf
 *
msg
, 
uöt16_t
 
ty≥
,

604 c⁄° *
d©a
, 
size_t
 
size
)

606 
	`mem˝y
(
	`∆_msg_put_un•ec_unöô
(
msg
, 
ty≥
, 
size
), 
d©a
, size);

607 
	}
}

613 
	$∆_msg_put_Êag
(
oÂbuf
 *
msg
, 
uöt16_t
 
ty≥
)

615 
	`∆_msg_put_un•ec
(
msg
, 
ty≥
, 
NULL
, 0);

616 
	}
}

621 
	$∆_msg_put_u8
(
oÂbuf
 *
msg
, 
uöt16_t
 
ty≥
, 
uöt8_t
 
vÆue
)

623 
	`∆_msg_put_un•ec
(
msg
, 
ty≥
, &
vÆue
,  value);

624 
	}
}

629 
	$∆_msg_put_u16
(
oÂbuf
 *
msg
, 
uöt16_t
 
ty≥
, uöt16_à
vÆue
)

631 
	`∆_msg_put_un•ec
(
msg
, 
ty≥
, &
vÆue
,  value);

632 
	}
}

637 
	$∆_msg_put_u32
(
oÂbuf
 *
msg
, 
uöt16_t
 
ty≥
, 
uöt32_t
 
vÆue
)

639 
	`∆_msg_put_un•ec
(
msg
, 
ty≥
, &
vÆue
,  value);

640 
	}
}

645 
	$∆_msg_put_u64
(
oÂbuf
 *
msg
, 
uöt16_t
 
ty≥
, 
uöt64_t
 
vÆue
)

647 
	`∆_msg_put_un•ec
(
msg
, 
ty≥
, &
vÆue
,  value);

648 
	}
}

653 
	$∆_msg_put_°rög
(
oÂbuf
 *
msg
, 
uöt16_t
 
ty≥
, c⁄° *
vÆue
)

655 
	`∆_msg_put_un•ec
(
msg
, 
ty≥
, 
vÆue
, 
	`°æí
(value) + 1);

656 
	}
}

662 
	$∆_msg_put_√°ed
(
oÂbuf
 *
msg
,

663 
uöt16_t
 
ty≥
, 
oÂbuf
 *
√°ed_msg
)

665 
	`∆_msg_∆msghdr
(
√°ed_msg
)->
∆msg_Àn
 =Çe°ed_msg->
size
;

666 
	`∆_msg_put_un•ec
(
msg
, 
ty≥
, 
√°ed_msg
->
d©a
,Çe°ed_msg->
size
);

667 
	}
}

671 
	$∆_©å_gë
(c⁄° 
∆©å
 *
∆a
)

673 
	`as£π
(
∆a
->
∆a_Àn
 >
NLA_HDRLEN
);

674  
∆a
 + 1;

675 
	}
}

678 
size_t


679 
	$∆_©å_gë_size
(c⁄° 
∆©å
 *
∆a
)

681 
	`as£π
(
∆a
->
∆a_Àn
 >
NLA_HDRLEN
);

682  
∆a
->
∆a_Àn
 - 
NLA_HDRLEN
;

683 
	}
}

688 
	$∆_©å_gë_un•ec
(c⁄° 
∆©å
 *
∆a
, 
size_t
 
size
)

690 
	`as£π
(
∆a
->
∆a_Àn
 >
NLA_HDRLEN
 + 
size
);

691  
∆a
 + 1;

692 
	}
}

696 
boﬁ


697 
	$∆_©å_gë_Êag
(c⁄° 
∆©å
 *
∆a
)

699  
∆a
 !
NULL
;

700 
	}
}

702 
	#NL_ATTR_GET_AS
(
NLA
, 
TYPE
) \

703 (*(
TYPE
*Ë
	`∆_©å_gë_un•ec
(
∆a
, (TYPE)))

	)

708 
uöt8_t


709 
	$∆_©å_gë_u8
(c⁄° 
∆©å
 *
∆a
)

711  
	`NL_ATTR_GET_AS
(
∆a
, 
uöt8_t
);

712 
	}
}

717 
uöt16_t


718 
	$∆_©å_gë_u16
(c⁄° 
∆©å
 *
∆a
)

720  
	`NL_ATTR_GET_AS
(
∆a
, 
uöt16_t
);

721 
	}
}

726 
uöt32_t


727 
	$∆_©å_gë_u32
(c⁄° 
∆©å
 *
∆a
)

729  
	`NL_ATTR_GET_AS
(
∆a
, 
uöt32_t
);

730 
	}
}

735 
uöt64_t


736 
	$∆_©å_gë_u64
(c⁄° 
∆©å
 *
∆a
)

738  
	`NL_ATTR_GET_AS
(
∆a
, 
uöt64_t
);

739 
	}
}

745 
	$∆_©å_gë_°rög
(c⁄° 
∆©å
 *
∆a
)

747 
	`as£π
(
∆a
->
∆a_Àn
 > 
NLA_HDRLEN
);

748 
	`as£π
(
	`memchr
(
	`∆_©å_gë
(
∆a
), '\0',Çœ->
∆a_Àn
 - 
NLA_HDRLEN
Ë!
NULL
);

749  
	`∆_©å_gë
(
∆a
);

750 
	}
}

753 c⁄° 
size_t
 
	g©å_Àn_ønge
[][2] = {

754 [0 ... 
N_NL_ATTR_TYPES
 - 1] = { 0, 
SIZE_MAX
 },

755 [
NL_A_U8
] = { 1, 1 },

756 [
NL_A_U16
] = { 2, 2 },

757 [
NL_A_U32
] = { 4, 4 },

758 [
NL_A_U64
] = { 8, 8 },

759 [
NL_A_STRING
] = { 1, 
SIZE_MAX
 },

760 [
NL_A_FLAG
] = { 0, 
SIZE_MAX
 },

761 [
NL_A_NESTED
] = { 
NLMSG_HDRLEN
, 
SIZE_MAX
 },

771 
boﬁ


772 
	$∆_pﬁicy_∑r£
(c⁄° 
oÂbuf
 *
msg
, 
size_t
 
∆a_off£t
,

773 c⁄° 
∆_pﬁicy
 
pﬁicy
[],

774 
∆©å
 *
©ås
[], 
size_t
 
n_©ås
)

776 *
p
, *
èû
;

777 
size_t
 
n_ªquúed
;

778 
size_t
 
i
;

780 
n_ªquúed
 = 0;

781 
i
 = 0; i < 
n_©ås
; i++) {

782 
©ås
[
i
] = 
NULL
;

784 
	`as£π
(
pﬁicy
[
i
].
ty≥
 < 
N_NL_ATTR_TYPES
);

785 i‡(
pﬁicy
[
i
].
ty≥
 !
NL_A_NO_ATTR


786 && 
pﬁicy
[
i
].
ty≥
 !
NL_A_FLAG


787 && !
pﬁicy
[
i
].
›ti⁄Æ
) {

788 
n_ªquúed
++;

792 
p
 = 
	`oÂbuf_©
(
msg
, 
∆a_off£t
, 0);

793 i‡(
p
 =
NULL
) {

794 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "missing headers inÇl_policy_parse");

795  
Ál£
;

797 
èû
 = 
	`oÂbuf_èû
(
msg
);

799 
p
 < 
èû
) {

800 
size_t
 
off£t
 = (*)
p
 - (*)
msg
->
d©a
;

801 
∆©å
 *
∆a
 = 
p
;

802 
size_t
 
Àn
, 
Æig√d_Àn
;

803 
uöt16_t
 
ty≥
;

806 i‡(
∆a
->
∆a_Àn
 < 
NLA_HDRLEN
) {

807 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "%zu:áâ∏sh‹ã∏th™ NLA_HDRLEN (%"
PRIu16
")",

808 
off£t
, 
∆a
->
∆a_Àn
);

809  
Ál£
;

811 
Àn
 = 
∆a
->
∆a_Àn
 - 
NLA_HDRLEN
;

812 
Æig√d_Àn
 = 
	`NLA_ALIGN
(
Àn
);

813 i‡(
Æig√d_Àn
 > (*)
èû
 - (*)
p
) {

814 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "%zu:áâ∏%"
PRIu16
"áligned dataÜen (%zu) "

816 
off£t
, 
∆a
->
∆a_ty≥
, 
Æig√d_Àn
,

817 (*)
èû
 - (*)
p
);

818  
Ál£
;

821 
ty≥
 = 
∆a
->
∆a_ty≥
;

822 i‡(
ty≥
 < 
n_©ås
 && 
pﬁicy
[ty≥].ty≥ !
NL_A_NO_ATTR
) {

823 c⁄° 
∆_pﬁicy
 *
p
 = &
pﬁicy
[
ty≥
];

824 
size_t
 
mö_Àn
, 
max_Àn
;

827 
mö_Àn
 = 
p
->mö_À¿?Ö->mö_À¿: 
©å_Àn_ønge
[p->
ty≥
][0];

828 
max_Àn
 = 
p
->max_À¿?Ö->max_À¿: 
©å_Àn_ønge
[p->
ty≥
][1];

829 i‡(
Àn
 < 
mö_Àn
 ||Üí > 
max_Àn
) {

830 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "%zu:áâ∏%"
PRIu16
"Üength %zuÇot in "

832 
off£t
, 
ty≥
, 
Àn
, 
mö_Àn
, 
max_Àn
);

833  
Ál£
;

835 i‡(
p
->
ty≥
 =
NL_A_STRING
) {

836 i‡(((*Ë
∆a
)[∆a->
∆a_Àn
 - 1]) {

837 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "%zu:áâ∏%"
PRIu16
"ÜacksÇullátÉnd",

838 
off£t
, 
ty≥
);

839  
Ál£
;

841 i‡(
	`memchr
(
∆a
 + 1, '\0', 
Àn
 - 1Ë!
NULL
) {

842 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "%zu:áâ∏%"
PRIu16
" has badÜength",

843 
off£t
, 
ty≥
);

844  
Ál£
;

847 i‡(!
p
->
›ti⁄Æ
 && 
©ås
[
ty≥
] =
NULL
) {

848 
	`as£π
(
n_ªquúed
 > 0);

849 --
n_ªquúed
;

851 
©ås
[
ty≥
] = 
∆a
;

855 
p
 = (*Ì + 
	`NLA_ALIGN
(
∆a
->
∆a_Àn
);

857 i‡(
n_ªquúed
) {

858 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "%zuÑequúedáâr†missög", 
n_ªquúed
);

859  
Ál£
;

861  
åue
;

862 
	}
}

866 c⁄° 
∆_pﬁicy
 
	gÁmûy_pﬁicy
[
CTRL_ATTR_MAX
 + 1] = {

867 [
CTRL_ATTR_FAMILY_ID
] = {.
ty≥
 = 
NL_A_U16
},

870 
	$do_lookup_gíl_Ámûy
(c⁄° *
«me
)

872 
∆_sock
 *
sock
;

873 
oÂbuf
 
ªque°
, *
ª∂y
;

874 
∆©å
 *
©ås
[
	`ARRAY_SIZE
(
Ámûy_pﬁicy
)];

875 
ªtvÆ
;

877 
ªtvÆ
 = 
	`∆_sock_¸óã
(
NETLINK_GENERIC
, 0, 0, 0, &
sock
);

878 i‡(
ªtvÆ
) {

879  -
ªtvÆ
;

882 
	`oÂbuf_öô
(&
ªque°
, 0);

883 
	`∆_msg_put_gílmsghdr
(&
ªque°
, 
sock
, 0, 
GENL_ID_CTRL
, 
NLM_F_REQUEST
,

884 
CTRL_CMD_GETFAMILY
, 1);

885 
	`∆_msg_put_°rög
(&
ªque°
, 
CTRL_ATTR_FAMILY_NAME
, 
«me
);

886 
ªtvÆ
 = 
	`∆_sock_å™ß˘
(
sock
, &
ªque°
, &
ª∂y
);

887 
	`oÂbuf_unöô
(&
ªque°
);

888 i‡(
ªtvÆ
) {

889 
	`∆_sock_de°roy
(
sock
);

890  -
ªtvÆ
;

893 i‡(!
	`∆_pﬁicy_∑r£
(
ª∂y
, 
NLMSG_HDRLEN
 + 
GENL_HDRLEN
,

894 
Ámûy_pﬁicy
, 
©ås
, 
	`ARRAY_SIZE
(family_policy))) {

895 
	`∆_sock_de°roy
(
sock
);

896 
	`oÂbuf_dñëe
(
ª∂y
);

897  -
EPROTO
;

900 
ªtvÆ
 = 
	`∆_©å_gë_u16
(
©ås
[
CTRL_ATTR_FAMILY_ID
]);

901 i‡(
ªtvÆ
 == 0) {

902 
ªtvÆ
 = -
EPROTO
;

904 
	`∆_sock_de°roy
(
sock
);

905 
	`oÂbuf_dñëe
(
ª∂y
);

906  
ªtvÆ
;

907 
	}
}

914 
	$∆_lookup_gíl_Ámûy
(c⁄° *
«me
, *
numbî
)

916 i‡(*
numbî
 == 0) {

917 *
numbî
 = 
	`do_lookup_gíl_Ámûy
(
«me
);

918 
	`as£π
(*
numbî
 != 0);

920  *
numbî
 > 0 ? 0 : -*number;

921 
	}
}

935 
	#SOCKET_BITS
 10

	)

936 
	#MAX_SOCKETS
 (1u << 
SOCKET_BITS
)

	)

938 
	#PROCESS_BITS
 (32 - 
SOCKET_BITS
)

	)

939 
	#MAX_PROCESSES
 (1u << 
PROCESS_BITS
)

	)

940 
	#PROCESS_MASK
 ((
uöt32_t
Ë(
MAX_PROCESSES
 - 1))

	)

943 
uöt32_t
 
	gavaû_sockës
[
ROUND_UP
(
MAX_SOCKETS
, 32)];

947 
	$Æloc_pid
(
uöt32_t
 *
pid
)

949 
i
;

951 
i
 = 0; i < 
MAX_SOCKETS
; i++) {

952 i‡((
avaû_sockës
[
i
 / 32] & (1u << (i % 32))) == 0) {

953 
avaû_sockës
[
i
 / 32] |= 1u << (i % 32);

954 *
pid
 = (
	`gëpid
(Ë& 
PROCESS_MASK
Ë| (
i
 << 
PROCESS_BITS
);

958 
	`VLOG_ERR
(
LOG_MODULE
, "netlinkÖid spaceÉxhausted");

959  
ENOBUFS
;

960 
	}
}

964 
	$‰ì_pid
(
uöt32_t
 
pid
)

966 
sock
 = 
pid
 >> 
PROCESS_BITS
;

967 
	`as£π
(
avaû_sockës
[
sock
 / 32] & (1u << (sock % 32)));

968 
avaû_sockës
[
sock
 / 32] &= ~(1u << (sock % 32));

969 
	}
}

972 
	$∆msghdr_to_°rög
(c⁄° 
∆msghdr
 *
h
, 
ds
 *ds)

974 
	s∆msg_Êag
 {

975 
bôs
;

976 c⁄° *
«me
;

978 c⁄° 
∆msg_Êag
 
Êags
[] = {

979 { 
NLM_F_REQUEST
, "REQUEST" },

980 { 
NLM_F_MULTI
, "MULTI" },

981 { 
NLM_F_ACK
, "ACK" },

982 { 
NLM_F_ECHO
, "ECHO" },

983 { 
NLM_F_DUMP
, "DUMP" },

984 { 
NLM_F_ROOT
, "ROOT" },

985 { 
NLM_F_MATCH
, "MATCH" },

986 { 
NLM_F_ATOMIC
, "ATOMIC" },

988 c⁄° 
∆msg_Êag
 *
Êag
;

989 
uöt16_t
 
Êags_À·
;

991 
	`ds_put_f‹m©
(
ds
, "∆÷í:%"
PRIu32
",Åy≥=%"
PRIu16
,

992 
h
->
∆msg_Àn
, h->
∆msg_ty≥
);

993 i‡(
h
->
∆msg_ty≥
 =
NLMSG_NOOP
) {

994 
	`ds_put_c°r
(
ds
, "(no-op)");

995 } i‡(
h
->
∆msg_ty≥
 =
NLMSG_ERROR
) {

996 
	`ds_put_c°r
(
ds
, "(error)");

997 } i‡(
h
->
∆msg_ty≥
 =
NLMSG_DONE
) {

998 
	`ds_put_c°r
(
ds
, "(done)");

999 } i‡(
h
->
∆msg_ty≥
 =
NLMSG_OVERRUN
) {

1000 
	`ds_put_c°r
(
ds
, "(overrun)");

1001 } i‡(
h
->
∆msg_ty≥
 < 
NLMSG_MIN_TYPE
) {

1002 
	`ds_put_c°r
(
ds
, "(reserved)");

1004 
	`ds_put_c°r
(
ds
, "(family-defined)");

1006 
	`ds_put_f‹m©
(
ds
, ", fœgs=%"
PRIx16
, 
h
->
∆msg_Êags
);

1007 
Êags_À·
 = 
h
->
∆msg_Êags
;

1008 
Êag
 = 
Êags
; fœg < &Êags[
	`ARRAY_SIZE
(flags)]; flag++) {

1009 i‡((
Êags_À·
 & 
Êag
->
bôs
) == flag->bits) {

1010 
	`ds_put_f‹m©
(
ds
, "[%s]", 
Êag
->
«me
);

1011 
Êags_À·
 &~
Êag
->
bôs
;

1014 i‡(
Êags_À·
) {

1015 
	`ds_put_f‹m©
(
ds
, "[OTHER:%"
PRIx16
"]", 
Êags_À·
);

1017 
	`ds_put_f‹m©
(
ds
, ", seq=%"
PRIx32
",Öid=%"
PRIu32
"(%d:%d))",

1018 
h
->
∆msg_£q
, h->
∆msg_pid
,

1019 (Ë(
h
->
∆msg_pid
 & 
PROCESS_MASK
),

1020 (Ë(
h
->
∆msg_pid
 >> 
PROCESS_BITS
));

1021 
	}
}

1024 
	$∆msg_to_°rög
(c⁄° 
oÂbuf
 *
buf„r
)

1026 
ds
 d†
DS_EMPTY_INITIALIZER
;

1027 c⁄° 
∆msghdr
 *
h
 = 
	`oÂbuf_©
(
buf„r
, 0, 
NLMSG_HDRLEN
);

1028 i‡(
h
) {

1029 
	`∆msghdr_to_°rög
(
h
, &
ds
);

1030 i‡(
h
->
∆msg_ty≥
 =
NLMSG_ERROR
) {

1031 c⁄° 
∆msgîr
 *
e
;

1032 
e
 = 
	`oÂbuf_©
(
buf„r
, 
NLMSG_HDRLEN
,

1033 
	`NLMSG_ALIGN
((
∆msgîr
)));

1034 i‡(
e
) {

1035 
	`ds_put_f‹m©
(&
ds
, "Éº‹(%d", 
e
->
îr‹
);

1036 i‡(
e
->
îr‹
 < 0) {

1037 
	`ds_put_f‹m©
(&
ds
, "(%s)", 
	`°ªº‹
(-
e
->
îr‹
));

1039 
	`ds_put_c°r
(&
ds
, ", in-reply-to(");

1040 
	`∆msghdr_to_°rög
(&
e
->
msg
, &
ds
);

1041 
	`ds_put_c°r
(&
ds
, "))");

1043 
	`ds_put_c°r
(&
ds
, "Érror(truncated)");

1045 } i‡(
h
->
∆msg_ty≥
 =
NLMSG_DONE
) {

1046 *
îr‹
 = 
	`oÂbuf_©
(
buf„r
, 
NLMSG_HDRLEN
,  *error);

1047 i‡(
îr‹
) {

1048 
	`ds_put_f‹m©
(&
ds
, " d⁄e(%d", *
îr‹
);

1049 i‡(*
îr‹
 < 0) {

1050 
	`ds_put_f‹m©
(&
ds
, "(%s)", 
	`°ªº‹
(-*
îr‹
));

1052 
	`ds_put_c°r
(&
ds
, ")");

1054 
	`ds_put_c°r
(&
ds
, " done(truncated)");

1058 
	`ds_put_c°r
(&
ds
, "nl(truncated)");

1060  
ds
.
°rög
;

1061 
	}
}

1064 
	$log_∆msg
(c⁄° *
fun˘i⁄
, 
îr‹
,

1065 c⁄° *
mesßge
, 
size_t
 
size
)

1067 
oÂbuf
 
buf„r
;

1068 *
∆msg
;

1070 i‡(!
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

1074 
buf„r
.
d©a
 = (*Ë
mesßge
;

1075 
buf„r
.
size
 = size;

1076 
∆msg
 = 
	`∆msg_to_°rög
(&
buf„r
);

1077 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "%†(%s): %s", 
fun˘i⁄
, 
	`°ªº‹
(
îr‹
), 
∆msg
);

1078 
	`‰ì
(
∆msg
);

1079 
	}
}

	@lib/netlink.h

34 #i‚de‡
NETLINK_H


35 
	#NETLINK_H
 1

	)

46 
	~<°dboﬁ.h
>

47 
	~<sys/uio.h
>

48 
	~<°döt.h
>

50 
	goÂbuf
;

51 
	g∆_sock
;

52 
	g∆©å
;

56 
∆_sock_¸óã
(
¥Ÿocﬁ
, 
mu…iˇ°_group
,

57 
size_t
 
so_¢dbuf
, size_à
so_rcvbuf
,

58 
∆_sock
 **);

59 
∆_sock_de°roy
(
∆_sock
 *);

61 
∆_sock_£nd
(
∆_sock
 *, c⁄° 
oÂbuf
 *, 
boﬁ
 
waô
);

62 
∆_sock_£ndv
(
∆_sock
 *
sock
, c⁄° 
iovec
 
iov
[], 
size_t
 
n_iov
,

63 
boﬁ
 
waô
);

64 
∆_sock_ªcv
(
∆_sock
 *, 
oÂbuf
 **, 
boﬁ
 
waô
);

65 
∆_sock_å™ß˘
(
∆_sock
 *, c⁄° 
oÂbuf
 *
ªque°
,

66 
oÂbuf
 **
ª∂y
);

68 
∆_sock_waô
(c⁄° 
∆_sock
 *, 
evíts
);

73 
∆msghdr
 *
∆_msg_∆msghdr
(c⁄° 
oÂbuf
 *);

74 
gílmsghdr
 *
∆_msg_gílmsghdr
(c⁄° 
oÂbuf
 *);

75 
boﬁ
 
∆_msg_∆msgîr
(c⁄° 
oÂbuf
 *, *
îr‹
);

76 
∆_msg_ª£rve
(
oÂbuf
 *, 
size_t
);

79 
∆_msg_put_∆msghdr
(
oÂbuf
 *, 
∆_sock
 *,

80 
size_t
 
ex≥˘ed_∑ylﬂd
,

81 
uöt32_t
 
ty≥
, uöt32_à
Êags
);

82 
∆_msg_put_gílmsghdr
(
oÂbuf
 *, 
∆_sock
 *,

83 
size_t
 
ex≥˘ed_∑ylﬂd
, 
Ámûy
, 
uöt32_t
 
Êags
,

84 
uöt8_t
 
cmd
, uöt8_à
vîsi⁄
);

85 
∆_msg_put
(
oÂbuf
 *, c⁄° *, 
size_t
);

86 *
∆_msg_put_unöô
(
oÂbuf
 *, 
size_t
);

89 *
∆_msg_put_un•ec_unöô
(
oÂbuf
 *, 
uöt16_t
 
ty≥
, 
size_t
);

90 
∆_msg_put_un•ec
(
oÂbuf
 *, 
uöt16_t
 
ty≥
, c⁄° *, 
size_t
);

91 
∆_msg_put_Êag
(
oÂbuf
 *, 
uöt16_t
 
ty≥
);

92 
∆_msg_put_u8
(
oÂbuf
 *, 
uöt16_t
 
ty≥
, 
uöt8_t
 
vÆue
);

93 
∆_msg_put_u16
(
oÂbuf
 *, 
uöt16_t
 
ty≥
, uöt16_à
vÆue
);

94 
∆_msg_put_u32
(
oÂbuf
 *, 
uöt16_t
 
ty≥
, 
uöt32_t
 
vÆue
);

95 
∆_msg_put_u64
(
oÂbuf
 *, 
uöt16_t
 
ty≥
, 
uöt64_t
 
vÆue
);

96 
∆_msg_put_°rög
(
oÂbuf
 *, 
uöt16_t
 
ty≥
, c⁄° *
vÆue
);

97 
∆_msg_put_√°ed
(
oÂbuf
 *, 
uöt16_t
 
ty≥
, ofpbuf *);

100 
	e∆_©å_ty≥


102 
	mNL_A_NO_ATTR
 = 0,

103 
	mNL_A_UNSPEC
,

104 
	mNL_A_U8
,

105 
	mNL_A_U16
,

106 
	mNL_A_U32
,

107 
	mNL_A_U64
,

108 
	mNL_A_STRING
,

109 
	mNL_A_FLAG
,

110 
	mNL_A_NESTED
,

111 
	mN_NL_ATTR_TYPES


115 c⁄° *
∆_©å_gë
(c⁄° 
∆©å
 *);

116 
size_t
 
∆_©å_gë_size
(c⁄° 
∆©å
 *);

117 c⁄° *
∆_©å_gë_un•ec
(c⁄° 
∆©å
 *, 
size_t
 
size
);

118 
boﬁ
 
∆_©å_gë_Êag
(c⁄° 
∆©å
 *);

119 
uöt8_t
 
∆_©å_gë_u8
(c⁄° 
∆©å
 *);

120 
uöt16_t
 
∆_©å_gë_u16
(c⁄° 
∆©å
 *);

121 
uöt32_t
 
∆_©å_gë_u32
(c⁄° 
∆©å
 *);

122 
uöt64_t
 
∆_©å_gë_u64
(c⁄° 
∆©å
 *);

123 c⁄° *
∆_©å_gë_°rög
(c⁄° 
∆©å
 *);

129 
	s∆_pﬁicy


131 
∆_©å_ty≥
 
	mty≥
;

132 
size_t
 
	mmö_Àn
, 
	mmax_Àn
;

133 
boﬁ
 
	m›ti⁄Æ
;

136 
boﬁ
 
∆_pﬁicy_∑r£
(c⁄° 
oÂbuf
 *, 
size_t
 
off£t
,

137 c⁄° 
∆_pﬁicy
[],

138 
∆©å
 *[], 
size_t
 
n_©ås
);

142 
∆_lookup_gíl_Ámûy
(c⁄° *
«me
, *
numbî
);

	@lib/ofp.c

55 
	~<c⁄fig.h
>

56 
	~<as£π.h
>

57 
	~<î∫o.h
>

58 
	~<öây≥s.h
>

59 
	~<√töë/ö.h
>

60 
	~<°dlib.h
>

61 
	~"oÂ.h
"

62 
	~"oÂbuf.h
"

63 
	~"›íÊow/›íÊow.h
"

64 
	~"›íÊow/nicúa-ext.h
"

65 
	~"∑ckës.h
"

66 
	~"øndom.h
"

67 
	~"utû.h
"

69 
	#LOG_MODULE
 
VLM_oÂ


	)

70 
	~"vlog.h
"

74 
ölöe
 
uöt32_t


75 
	$Æloc_xid
()

77  
	`øndom_uöt32
();

78 
	}
}

94 
	$make_›íÊow
(
size_t
 
›íÊow_Àn
, 
uöt8_t
 
ty≥
, 
oÂbuf
 **
buf„Ω
)

96 *
buf„Ω
 = 
	`oÂbuf_√w
(
›íÊow_Àn
);

97  
	`put_›íÊow_xid
(
›íÊow_Àn
, 
ty≥
, 
	`Æloc_xid
(), *
buf„Ω
);

98 
	}
}

116 
	$make_›íÊow_xid
(
size_t
 
›íÊow_Àn
, 
uöt8_t
 
ty≥
, 
uöt32_t
 
xid
,

117 
oÂbuf
 **
buf„Ω
)

119 *
buf„Ω
 = 
	`oÂbuf_√w
(
›íÊow_Àn
);

120  
	`put_›íÊow_xid
(
›íÊow_Àn
, 
ty≥
, 
xid
, *
buf„Ω
);

121 
	}
}

133 
	$put_›íÊow
(
size_t
 
›íÊow_Àn
, 
uöt8_t
 
ty≥
, 
oÂbuf
 *
buf„r
)

135  
	`put_›íÊow_xid
(
›íÊow_Àn
, 
ty≥
, 
	`Æloc_xid
(), 
buf„r
);

136 
	}
}

148 
	$put_›íÊow_xid
(
size_t
 
›íÊow_Àn
, 
uöt8_t
 
ty≥
, 
uöt32_t
 
xid
,

149 
oÂbuf
 *
buf„r
)

151 
oÂ_hódî
 *
oh
;

153 
	`as£π
(
›íÊow_Àn
 > *
oh
);

154 
	`as£π
(
›íÊow_Àn
 <
UINT16_MAX
);

156 
oh
 = 
	`oÂbuf_put_unöô
(
buf„r
, 
›íÊow_Àn
);

157 
oh
->
vîsi⁄
 = 
OFP_VERSION
;

158 
oh
->
ty≥
 =Åype;

159 
oh
->
Àngth
 = 
	`ht⁄s
(
›íÊow_Àn
);

160 
oh
->
xid
 = xid;

161 
	`mem£t
(
oh
 + 1, 0, 
›íÊow_Àn
 -  *oh);

162  
oh
;

163 
	}
}

168 
	$upd©e_›íÊow_Àngth
(
oÂbuf
 *
buf„r
)

170 
oÂ_hódî
 *
oh
 = 
	`oÂbuf_©_as£π
(
buf„r
, 0,  *oh);

171 
oh
->
Àngth
 = 
	`ht⁄s
(
buf„r
->
size
);

172 
	}
}

177 
	$upd©e_ö°ru˘i⁄_Àngth
(
oÂbuf
 *
buf„r
, 
size_t
 
oü_off£t
)

179 
oÂ_hódî
 *
oh
 = 
	`oÂbuf_©_as£π
(
buf„r
, 0,  *oh);

180 
oÂ_ö°ru˘i⁄
 *
ih
 = 
	`oÂbuf_©_as£π
(
buf„r
, 
oü_off£t
,

181  *
ih
);

182 
ih
->
Àn
 = 
	`ht⁄s
(
buf„r
->
size
 - 
oü_off£t
);

183 
	}
}

185 
oÂbuf
 *

186 
	$make_Êow_mod
(
uöt8_t
 
comm™d
, uöt8_à
èbÀ_id
,

187 c⁄° 
Êow
 *Êow, 
size_t
 
a˘i⁄s_Àn
)

189 
oÂ_Êow_mod
 *
ofm
;

190 
size_t
 
size
 =  *
ofm
 + 
a˘i⁄s_Àn
;

191 
oÂbuf
 *
out
 = 
	`oÂbuf_√w
(
size
);

192 
ofm
 = 
	`oÂbuf_put_zîos
(
out
,  *ofm);

193 
ofm
->
hódî
.
vîsi⁄
 = 
OFP_VERSION
;

194 
ofm
->
hódî
.
ty≥
 = 
OFPT_FLOW_MOD
;

195 
ofm
->
hódî
.
Àngth
 = 
	`ht⁄s
(
size
);

196 
ofm
->
cookõ
 = 0;

210 
ofm
->
comm™d
 = command;

211 
ofm
->
èbÀ_id
 =Åable_id;

213  
out
;

214 
	}
}

216 
oÂbuf
 *

217 
	$make_add_Êow
(c⁄° 
Êow
 *Êow, 
uöt32_t
 
buf„r_id
, 
uöt8_t
 
èbÀ_id
,

218 
uöt16_t
 
idÀ_timeout
, 
size_t
 
a˘i⁄s_Àn
)

220 
oÂ_ö°ru˘i⁄_a˘i⁄s
 *
oü
;

221 
size_t
 
ö°ru˘i⁄_Àn
 =  *
oü
 + 
a˘i⁄s_Àn
;

222 
oÂbuf
 *
out
 = 
	`make_Êow_mod
(
OFPFC_ADD
, 
èbÀ_id
,

223 
Êow
, 
ö°ru˘i⁄_Àn
);

224 
oÂ_Êow_mod
 *
ofm
 = 
out
->
d©a
;

225 
ofm
->
idÀ_timeout
 = 
	`ht⁄s
(idle_timeout);

226 
ofm
->
h¨d_timeout
 = 
	`ht⁄s
(
OFP_FLOW_PERMANENT
);

227 
ofm
->
buf„r_id
 = 
	`ht⁄l
(buffer_id);

229 
oü
 = 
	`oÂbuf_put_zîos
(
out
,  *oia);

230 
oü
->
ty≥
 = 
	`ht⁄s
(
OFPIT_APPLY_ACTIONS
);

231 
oü
->
Àn
 = 
	`ht⁄s
(
ö°ru˘i⁄_Àn
);

232  
out
;

233 
	}
}

237 
oÂbuf
 *

238 
	$make_dñ_Êow
(c⁄° 
Êow
 *Êow, 
uöt8_t
 
èbÀ_id
)

240 
oÂbuf
 *
out
 = 
	`make_Êow_mod
(
OFPFC_DELETE_STRICT
, 
èbÀ_id
, 
Êow
, 0);

241 
oÂ_Êow_mod
 *
ofm
 = 
out
->
d©a
;

242 
ofm
->
out_p‹t
 = 
	`ht⁄l
(
OFPP_ANY
);

243  
out
;

244 
	}
}

247 
oÂbuf
 *

248 
	$make_add_sim∂e_Êow
(c⁄° 
Êow
 *flow,

249 
uöt32_t
 
buf„r_id
, uöt32_à
out_p‹t
,

250 
uöt16_t
 
idÀ_timeout
)

252 i‡(
out_p‹t
 !
OFPP_ANY
) {

253 
oÂ_a˘i⁄_ouçut
 *
ﬂo
;

254 
oÂbuf
 *
buf„r
;

256 
buf„r
 = 
	`make_add_Êow
(
Êow
, 
buf„r_id
, 0x00, 
idÀ_timeout
,  *
ﬂo
);

257 
ﬂo
 = 
	`oÂbuf_put_zîos
(
buf„r
,  *oao);

258 
ﬂo
->
ty≥
 = 
	`ht⁄s
(
OFPAT_OUTPUT
);

259 
ﬂo
->
Àn
 = 
	`ht⁄s
( *oao);

260 
ﬂo
->
p‹t
 = 
	`ht⁄l
(
out_p‹t
);

261  
buf„r
;

263  
	`make_add_Êow
(
Êow
, 
buf„r_id
, 0, 
idÀ_timeout
, 0);

265 
	}
}

267 
oÂbuf
 *

268 
	$make_p‹t_desc_ªque°
(){

270 
oÂ_mu…ù¨t_ªque°
 *
desc
;

271 
oÂbuf
 *
out
 = 
	`oÂbuf_√w
( *
desc
);

272 
desc
 = 
	`oÂbuf_put_unöô
(
out
,  *desc);

273 
desc
->
hódî
.
vîsi⁄
 = 
OFP_VERSION
;

274 
desc
->
hódî
.
ty≥
 = 
OFPT_MULTIPART_REQUEST
;

275 
desc
->
hódî
.
Àngth
 = 
	`ht⁄s
( *desc);

276 
desc
->
hódî
.
xid
 = 
	`Æloc_xid
();

277 
desc
->
ty≥
 = 
	`ht⁄s
(
OFPMP_PORT_DESC
);

278 
desc
->
Êags
 = 0x0000;

279 
	`mem£t
(
desc
->
∑d
, 0x0, 4);

280  
out
;

282 
	}
}

284 
oÂbuf
 *

285 
	$make_∑ckë_out
(c⁄° 
oÂbuf
 *
∑ckë
, 
uöt32_t
 
buf„r_id
,

286 
uöt32_t
 
ö_p‹t
,

287 c⁄° 
oÂ_a˘i⁄_hódî
 *
a˘i⁄s
, 
size_t
 
n_a˘i⁄s
)

289 
size_t
 
a˘i⁄s_Àn
 = 
n_a˘i⁄s
 *  *
a˘i⁄s
;

290 
oÂ_∑ckë_out
 *
›o
;

291 
size_t
 
size
 =  *
›o
 + 
a˘i⁄s_Àn
 + (
∑ckë
 ?Öacket->size : 0);

292 
oÂbuf
 *
out
 = 
	`oÂbuf_√w
(
size
);

294 
›o
 = 
	`oÂbuf_put_unöô
(
out
,  *opo);

295 
›o
->
hódî
.
vîsi⁄
 = 
OFP_VERSION
;

296 
›o
->
hódî
.
ty≥
 = 
OFPT_PACKET_OUT
;

297 
›o
->
hódî
.
Àngth
 = 
	`ht⁄s
(
size
);

298 
›o
->
hódî
.
xid
 = 
	`ht⁄l
(0);

299 
›o
->
buf„r_id
 = 
	`ht⁄l
(buffer_id);

300 
›o
->
ö_p‹t
 = 
	`ht⁄l
(in_port);

301 
›o
->
a˘i⁄s_Àn
 = 
	`ht⁄s
(actions_len);

302 
	`oÂbuf_put
(
out
, 
a˘i⁄s
, 
a˘i⁄s_Àn
);

303 i‡(
∑ckë
) {

304 
	`oÂbuf_put
(
out
, 
∑ckë
->
d©a
,Öackë->
size
);

306  
out
;

307 
	}
}

310 
oÂbuf
 *

311 
	$make_unbuf„ªd_∑ckë_out
(c⁄° 
oÂbuf
 *
∑ckë
,

312 
uöt32_t
 
ö_p‹t
, uöt32_à
out_p‹t
)

314 
oÂ_a˘i⁄_ouçut
 
a˘i⁄
;

315 
a˘i⁄
.
ty≥
 = 
	`ht⁄s
(
OFPAT_OUTPUT
);

316 
a˘i⁄
.
Àn
 = 
	`ht⁄s
(áction);

317 
a˘i⁄
.
p‹t
 = 
	`ht⁄l
(
out_p‹t
);

318  
	`make_∑ckë_out
(
∑ckë
, 
UINT32_MAX
, 
ö_p‹t
,

319 (
oÂ_a˘i⁄_hódî
 *Ë&
a˘i⁄
, 1);

320 
	}
}

322 
oÂbuf
 *

323 
	$make_buf„ªd_∑ckë_out
(
uöt32_t
 
buf„r_id
,

324 
uöt32_t
 
ö_p‹t
, uöt32_à
out_p‹t
)

326 i‡(
out_p‹t
 !
OFPP_ANY
) {

327 
oÂ_a˘i⁄_ouçut
 
a˘i⁄
;

328 
a˘i⁄
.
ty≥
 = 
	`ht⁄s
(
OFPAT_OUTPUT
);

329 
a˘i⁄
.
Àn
 = 
	`ht⁄s
(áction);

330 
a˘i⁄
.
p‹t
 = 
	`ht⁄l
(
out_p‹t
);

331  
	`make_∑ckë_out
(
NULL
, 
buf„r_id
, 
ö_p‹t
,

332 (
oÂ_a˘i⁄_hódî
 *Ë&
a˘i⁄
, 1);

334  
	`make_∑ckë_out
(
NULL
, 
buf„r_id
, 
ö_p‹t
, NULL, 0);

336 
	}
}

340 
oÂbuf
 *

341 
	$make_echo_ªque°
()

343 
oÂ_hódî
 *
rq
;

344 
oÂbuf
 *
out
 = 
	`oÂbuf_√w
( *
rq
);

345 
rq
 = 
	`oÂbuf_put_unöô
(
out
,  *rq);

346 
rq
->
vîsi⁄
 = 
OFP_VERSION
;

347 
rq
->
ty≥
 = 
OFPT_ECHO_REQUEST
;

348 
rq
->
Àngth
 = 
	`ht⁄s
( *rq);

349 
rq
->
xid
 = 
	`Æloc_xid
();

350  
out
;

351 
	}
}

355 
oÂbuf
 *

356 
	$make_echo_ª∂y
(c⁄° 
oÂ_hódî
 *
rq
)

358 
size_t
 
size
 = 
	`¡ohs
(
rq
->
Àngth
);

359 
oÂbuf
 *
out
 = 
	`oÂbuf_√w
(
size
);

360 
oÂ_hódî
 *
ª∂y
 = 
	`oÂbuf_put
(
out
, 
rq
, 
size
);

361 
ª∂y
->
ty≥
 = 
OFPT_ECHO_REPLY
;

362  
out
;

363 
	}
}

367 
	$check_mesßge_ty≥
(
uöt8_t
 
gŸ_ty≥
, uöt8_à
w™t_ty≥
)

369 i‡(
gŸ_ty≥
 !
w™t_ty≥
) {

370 
	`VLOG_WARN
(
LOG_MODULE
, "received bad messageÅype %d (expected %d)",

371 
gŸ_ty≥
, 
w™t_ty≥
);

372  
	`oÂ_mkîr
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_TYPE
);;

375 
	}
}

381 
	$check_oÂ_mesßge
(c⁄° 
oÂ_hódî
 *
msg
, 
uöt8_t
 
ty≥
, 
size_t
 
size
)

383 
size_t
 
gŸ_size
;

384 
îr‹
;

386 
îr‹
 = 
	`check_mesßge_ty≥
(
msg
->
ty≥
,Åype);

387 i‡(
îr‹
) {

388  
îr‹
;

391 
gŸ_size
 = 
	`¡ohs
(
msg
->
Àngth
);

392 i‡(
gŸ_size
 !
size
) {

393 
	`VLOG_WARN
(
LOG_MODULE
, "received %d message ofÜength %zu (expected %zu)",

394 
ty≥
, 
gŸ_size
, 
size
);

395  
	`oÂ_mkîr
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

399 
	}
}

410 
	$check_oÂ_ö°ru˘i⁄_¨øy
(c⁄° 
oÂ_ö°ru˘i⁄
 *
ö°
, 
uöt8_t
 
ty≥
,

411 
size_t
 
mö_size
, size_à
¨øy_ñt_size
,

412 
size_t
 *
n_¨øy_ñts
)

414 
size_t
 
gŸ_size
;

416 
	`as£π
(
¨øy_ñt_size
);

418 i‡(
	`¡ohs
(
ö°
->
ty≥
) !=Åype) {

419 
	`VLOG_WARN
(
LOG_MODULE
, "received bad instructionÅype %X (expected %X)",

420 
	`¡ohs
(
ö°
->
ty≥
),Åype);

421  
	`oÂ_mkîr
(
OFPET_BAD_INSTRUCTION
, 
OFPBIC_UNSUP_INST
);

424 
gŸ_size
 = 
	`¡ohs
(
ö°
->
Àn
);

425 i‡(
gŸ_size
 < 
mö_size
) {

426 
	`VLOG_WARN
(
LOG_MODULE
, "received %X instruction ofÜength %zu "

428 
ty≥
, 
gŸ_size
, 
mö_size
);

429  
	`oÂ_mkîr
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

431 i‡((
gŸ_size
 - 
mö_size
Ë% 
¨øy_ñt_size
) {

432 
	`VLOG_WARN
(
LOG_MODULE
, "received %X message of badÜength %zu:Åhe "

435 
ty≥
, 
gŸ_size
, 
mö_size
, got_size - min_size,

436 
¨øy_ñt_size
, (
gŸ_size
 - 
mö_size
) %árray_elt_size);

437  
	`oÂ_mkîr
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);;

439 i‡(
n_¨øy_ñts
) {

440 *
n_¨øy_ñts
 = (
gŸ_size
 - 
mö_size
Ë/ 
¨øy_ñt_size
;

443 
	}
}

455 
	$check_oÂ_mesßge_¨øy
(c⁄° 
oÂ_hódî
 *
msg
, 
uöt8_t
 
ty≥
,

456 
size_t
 
mö_size
, size_à
¨øy_ñt_size
,

457 
size_t
 *
n_¨øy_ñts
)

459 
size_t
 
gŸ_size
;

460 
îr‹
;

462 
	`as£π
(
¨øy_ñt_size
);

464 
îr‹
 = 
	`check_mesßge_ty≥
(
msg
->
ty≥
,Åype);

465 i‡(
îr‹
) {

466  
îr‹
;

469 
gŸ_size
 = 
	`¡ohs
(
msg
->
Àngth
);

470 i‡(
gŸ_size
 < 
mö_size
) {

471 
	`VLOG_WARN
(
LOG_MODULE
, "received %d message ofÜength %zu "

473 
ty≥
, 
gŸ_size
, 
mö_size
);

474  
	`oÂ_mkîr
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

476 i‡((
gŸ_size
 - 
mö_size
Ë% 
¨øy_ñt_size
) {

477 
	`VLOG_WARN
(
LOG_MODULE
,

481 
ty≥
, 
gŸ_size
, 
mö_size
, got_size - min_size,

482 
¨øy_ñt_size
, (
gŸ_size
 - 
mö_size
) %árray_elt_size);

483  
	`oÂ_mkîr
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

485 i‡(
n_¨øy_ñts
) {

486 *
n_¨øy_ñts
 = (
gŸ_size
 - 
mö_size
Ë/ 
¨øy_ñt_size
;

489 
	}
}

493 
	$check_oÂ_∑ckë_out
(c⁄° 
oÂ_hódî
 *
oh
, 
oÂbuf
 *
d©a
,

494 *
n_a˘i⁄•
, 
max_p‹ts
)

496 c⁄° 
oÂ_∑ckë_out
 *
›o
;

497 
a˘i⁄s_Àn
, 
n_a˘i⁄s
;

498 
size_t
 
exåa
;

499 
îr‹
;

501 *
n_a˘i⁄•
 = 0;

502 
îr‹
 = 
	`check_oÂ_mesßge_¨øy
(
oh
, 
OFPT_PACKET_OUT
,

503  *
›o
, 1, &
exåa
);

504 i‡(
îr‹
) {

505  
îr‹
;

507 
›o
 = (c⁄° 
oÂ_∑ckë_out
 *Ë
oh
;

509 
a˘i⁄s_Àn
 = 
	`¡ohs
(
›o
->actions_len);

510 i‡(
a˘i⁄s_Àn
 > 
exåa
) {

511 
	`VLOG_WARN
(
LOG_MODULE
, "packet-out claims %u bytes ofáctions "

513 
a˘i⁄s_Àn
, 
exåa
);

514  
	`oÂ_mkîr
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

516 i‡(
a˘i⁄s_Àn
 % (
oÂ_a˘i⁄
)) {

517 
	`VLOG_WARN
(
LOG_MODULE
, "packet-out claims %u bytes ofáctions, "

519 
a˘i⁄s_Àn
, (
oÂ_a˘i⁄
));

520  
	`oÂ_mkîr
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

523 
n_a˘i⁄s
 = 
a˘i⁄s_Àn
 / (
oÂ_a˘i⁄
);

524 
îr‹
 = 
	`vÆid©e_a˘i⁄s
((c⁄° 
oÂ_a˘i⁄
 *Ë
›o
->
a˘i⁄s
,

525 
n_a˘i⁄s
, 
max_p‹ts
, 
åue
);

526 i‡(
îr‹
) {

527  
îr‹
;

530 
d©a
->d©®(*Ë&
›o
->
a˘i⁄s
[
n_a˘i⁄s
];

531 
d©a
->
size
 = 
exåa
 - 
a˘i⁄s_Àn
;

532 *
n_a˘i⁄•
 = 
n_a˘i⁄s
;

534 
	}
}

537 c⁄° 
oÂ_Êow_°©s
 *

538 
	$Êow_°©s_fú°
(
Êow_°©s_ôî©‹
 *
ôî
,

539 c⁄° 
oÂ_mu…ù¨t_ª∂y
 *
o§
)

541 
ôî
->
pos
 = 
o§
->
body
;

542 
ôî
->
íd
 = 
o§
->
body
 + (
	`¡ohs
(o§->
hódî
.
Àngth
)

543 - 
	`off£tof
(
oÂ_mu…ù¨t_ª∂y
, 
body
));

544  
	`Êow_°©s_√xt
(
ôî
);

545 
	}
}

548 c⁄° 
oÂ_Êow_°©s
 *

549 
	$Êow_°©s_√xt
(
Êow_°©s_ôî©‹
 *
ôî
)

551 
vlog_øã_limô
 
æ
 = 
	`VLOG_RATE_LIMIT_INIT
(1, 5);

552 
±rdiff_t
 
byãs_À·
 = 
ôî
->
íd
 - iãr->
pos
;

553 c⁄° 
oÂ_Êow_°©s
 *
fs
;

554 
size_t
 
Àngth
;

556 i‡(
byãs_À·
 <  *
fs
) {

557 i‡(
byãs_À·
 != 0) {

558 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "%tdÜeftover bytes in flow statsÑeply",

559 
byãs_À·
);

561  
NULL
;

564 
fs
 = (c⁄° *Ë
ôî
->
pos
;

565 
Àngth
 = 
	`¡ohs
(
fs
->length);

566 i‡(
Àngth
 <  *
fs
) {

567 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "flow statsÜength %zu is shorterÅhan min %zu",

568 
Àngth
,  *
fs
);

569  
NULL
;

570 } i‡(
Àngth
 > 
byãs_À·
) {

571 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "flow statsÜength %zu but only %td bytesÜeft",

572 
Àngth
, 
byãs_À·
);

573  
NULL
;

582 
ôî
->
pos
 +
Àngth
;

583  
fs
;

584 
	}
}

587 
	#ACTION_ALIGNMENT
 8

	)

591 
	$check_a˘i⁄_exa˘_Àn
(c⁄° 
oÂ_a˘i⁄
 *
a
, 
Àn
,

592 
ªquúed_Àn
)

594 i‡(
Àn
 !
ªquúed_Àn
) {

595 
	`VLOG_DBG
(
LOG_MODULE
, "a˘i⁄ %u ha†övÆidÜígth %"
PRIu16
" (must be %u)\n",

596 
a
->
ty≥
, 
	`¡ohs
◊->
hódî
.
Àn
), 
ªquúed_Àn
);

597  
	`oÂ_mkîr
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

600 
	}
}

606 
	$check_ouçut_p‹t
(
uöt32_t
 
p‹t
, 
max_p‹ts
, 
boﬁ
 
èbÀ_Ælowed
)

608 
p‹t
) {

609 
OFPP_IN_PORT
:

610 
OFPP_NORMAL
:

611 
OFPP_FLOOD
:

612 
OFPP_ALL
:

613 
OFPP_CONTROLLER
:

614 
OFPP_LOCAL
:

617 
OFPP_TABLE
:

618 i‡(
èbÀ_Ælowed
) {

621  
	`oÂ_mkîr
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_OUT_PORT
);

625 i‡(
p‹t
 < 
max_p‹ts
) {

628 
	`VLOG_WARN
(
LOG_MODULE
, "unknow¿ouçuàp‹à%x", 
p‹t
);

629  
	`oÂ_mkîr
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_OUT_PORT
);;

631 
	}
}

637 
	$check_£tqueue_a˘i⁄
(c⁄° 
oÂ_a˘i⁄
 *
a
, 
Àn
)

639 c⁄° 
oÂ_a˘i⁄_£t_queue
 *
ﬂq
;

640 
îr‹
;

642 
îr‹
 = 
	`check_a˘i⁄_exa˘_Àn
(
a
, 
Àn
, 8);

643 i‡(
îr‹
) {

644  
îr‹
;

647 
ﬂq
 = (c⁄° 
oÂ_a˘i⁄_£t_queue
 *Ë
a
;

649 
	}
}

652 
	$check_nicúa_a˘i⁄
(c⁄° 
oÂ_a˘i⁄
 *
a
, 
Àn
)

654 c⁄° 
nx_a˘i⁄_hódî
 *
«h
;

656 i‡(
Àn
 < 16) {

657 
	`VLOG_DBG
(
LOG_MODULE
, "Nicú®víd‹á˘i⁄ o∆y %u byãs", 
Àn
);

658  
	`oÂ_mkîr
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);;

660 
«h
 = (c⁄° 
nx_a˘i⁄_hódî
 *Ë
a
;

662 
	`¡ohs
(
«h
->
subty≥
)) {

663 
NXAST_RESUBMIT
:

664 
NXAST_SET_TUNNEL
:

665  
	`check_a˘i⁄_exa˘_Àn
(
a
, 
Àn
, 16);

667  
	`oÂ_mkîr
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_EXPERIMENTER
);

669 
	}
}

672 
	$check_a˘i⁄
(c⁄° 
oÂ_a˘i⁄
 *
a
, 
Àn
, 
max_p‹ts
,

673 
boﬁ
 
is_∑ckë_out
)

675 
îr‹
;

677 
	`¡ohs
(
a
->
ty≥
)) {

678 
OFPAT_OUTPUT
: {

679 c⁄° 
oÂ_a˘i⁄_ouçut
 *
ﬂo
;

680 
îr‹
 = 
	`check_a˘i⁄_exa˘_Àn
(
a
, 
Àn
, 16);

681 i‡(
îr‹
) {

682  
îr‹
;

684 
ﬂo
 = (c⁄° 
oÂ_a˘i⁄_ouçut
 *Ë
a
;

685  
	`check_ouçut_p‹t
(
	`¡ohl
(
ﬂo
->
p‹t
), 
max_p‹ts
, 
is_∑ckë_out
);

689 
OFPAT_EXPERIMENTER
:

690  (
a
->
ex≥rimíãr
.ex≥rimíã∏=
	`ht⁄l
(
NX_VENDOR_ID
)

691 ? 
	`check_nicúa_a˘i⁄
(
a
, 
Àn
)

692 : 
	`oÂ_mkîr
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_EXPERIMENTER
));

694 
OFPAT_SET_QUEUE
:

695  
	`check_£tqueue_a˘i⁄
(
a
, 
Àn
);

698 
	`VLOG_WARN
(
LOG_MODULE
, "unknow¿a˘i⁄Åy≥ %"
PRIu16
,

699 
	`¡ohs
(
a
->
ty≥
));

700  
	`oÂ_mkîr
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_TYPE
);

702 
	}
}

705 
	$vÆid©e_a˘i⁄s
(c⁄° 
oÂ_a˘i⁄
 *
a˘i⁄s
, 
size_t
 
n_a˘i⁄s
,

706 
max_p‹ts
, 
boﬁ
 
is_∑ckë_out
)

708 c⁄° 
oÂ_a˘i⁄
 *
a
;

710 
a
 = 
a˘i⁄s
;á < &a˘i⁄s[
n_a˘i⁄s
]; ) {

711 
Àn
 = 
	`¡ohs
(
a
->
hódî
.len);

712 
n_¶Ÿs
 = 
Àn
 / 
ACTION_ALIGNMENT
;

713 
¶Ÿs_À·
 = &
a˘i⁄s
[
n_a˘i⁄s
] - 
a
;

714 
îr‹
;

716 i‡(
n_¶Ÿs
 > 
¶Ÿs_À·
) {

717 
	`VLOG_DBG
(
LOG_MODULE
,

719 
n_¶Ÿs
, 
¶Ÿs_À·
);

720  
	`oÂ_mkîr
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

721 } i‡(!
Àn
) {

722 
	`VLOG_DBG
(
LOG_MODULE
, "action has invalidÜength 0");

723  
	`oÂ_mkîr
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

724 } i‡(
Àn
 % 
ACTION_ALIGNMENT
) {

725 
	`VLOG_DBG
(
LOG_MODULE
, "actionÜength %u isÇotá multiple "

726 "o‡%d", 
Àn
, 
ACTION_ALIGNMENT
);

727  
	`oÂ_mkîr
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

730 
îr‹
 = 
	`check_a˘i⁄
(
a
, 
Àn
, 
max_p‹ts
, 
is_∑ckë_out
);

731 i‡(
îr‹
) {

732  
îr‹
;

734 
a
 +
n_¶Ÿs
;

737 
	}
}

741 
boﬁ


742 
	$a˘i⁄_ouçuts_to_p‹t
(c⁄° 
oÂ_a˘i⁄
 *
a˘i⁄
, 
uöt32_t
 
p‹t
)

744 
	`¡ohs
(
a˘i⁄
->
ty≥
)) {

745 
OFPAT_OUTPUT
: {

746 c⁄° 
oÂ_a˘i⁄_ouçut
 *
ﬂo
;

747 
ﬂo
 = (c⁄° 
oÂ_a˘i⁄_ouçut
 *Ë
a˘i⁄
;

748  
ﬂo
->
p‹t
 ==Öort;

751  
Ál£
;

753 
	}
}

757 c⁄° 
oÂ_a˘i⁄
 *

758 
	$a˘i⁄s_fú°
(
a˘i⁄s_ôî©‹
 *
ôî
,

759 c⁄° 
oÂ_a˘i⁄
 *
ﬂ
, 
size_t
 
n_a˘i⁄s
)

761 
ôî
->
pos
 = 
ﬂ
;

762 
ôî
->
íd
 = 
ﬂ
 + 
n_a˘i⁄s
;

763  
	`a˘i⁄s_√xt
(
ôî
);

764 
	}
}

766 c⁄° 
oÂ_a˘i⁄
 *

767 
	$a˘i⁄s_√xt
(
a˘i⁄s_ôî©‹
 *
ôî
)

769 i‡(
ôî
->
pos
 < iãr->
íd
) {

770 c⁄° 
oÂ_a˘i⁄
 *
a
 = 
ôî
->
pos
;

771 
Àn
 = 
	`¡ohs
(
a
->
hódî
.len);

772 
ôî
->
pos
 +
Àn
 / 
ACTION_ALIGNMENT
;

773  
a
;

775  
NULL
;

777 
	}
}

	@lib/ofp.h

56 #i‚de‡
OFP_H


57 
	#OFP_H
 1

	)

59 
	~<as£π.h
>

60 
	~<°dboﬁ.h
>

61 
	~<°ddef.h
>

62 
	~<°döt.h
>

63 
	~"oÂbuf.h
"

64 
	~"Êow.h
"

65 
	~"../ö˛ude/›íÊow/›íÊow.h
"

68 *
make_›íÊow
(
size_t
 
›íÊow_Àn
, 
uöt8_t
 
ty≥
, 
oÂbuf
 **);

69 *
make_›íÊow_xid
(
size_t
 
›íÊow_Àn
, 
uöt8_t
 
ty≥
,

70 
uöt32_t
 
xid
, 
oÂbuf
 **);

71 *
put_›íÊow
(
size_t
 
›íÊow_Àn
, 
uöt8_t
 
ty≥
, 
oÂbuf
 *);

72 *
put_›íÊow_xid
(
size_t
 
›íÊow_Àn
, 
uöt8_t
 
ty≥
, 
uöt32_t
 
xid
,

73 
oÂbuf
 *);

74 
upd©e_›íÊow_Àngth
(
oÂbuf
 *);

75 
upd©e_ö°ru˘i⁄_Àngth
(
oÂbuf
 *, 
size_t
 
oü_off£t
);

76 
oÂbuf
 *
make_Êow_mod
(
uöt8_t
 
comm™d
, uöt8_à
èbÀ_id
,

77 c⁄° 
Êow
 *, 
size_t
 
a˘i⁄s_Àn
);

78 
oÂbuf
 *
make_add_Êow
(c⁄° 
Êow
 *, 
uöt32_t
 
buf„r_id
,

79 
uöt8_t
 
èbÀ_id
,

80 
uöt16_t
 
max_idÀ
, 
size_t
 
a˘i⁄s_Àn
);

81 
oÂbuf
 *
make_dñ_Êow
(c⁄° 
Êow
 *, 
uöt8_t
 
èbÀ_id
);

82 
oÂbuf
 *
make_add_sim∂e_Êow
(c⁄° 
Êow
 *,

83 
uöt32_t
 
buf„r_id
, uöt32_à
out_p‹t
,

84 
uöt16_t
 
max_idÀ
);

86 
oÂbuf
 * 
make_p‹t_desc_ªque°
();

88 
oÂbuf
 *
make_∑ckë_out
(c⁄° oÂbu‡*
∑ckë
, 
uöt32_t
 
buf„r_id
,

89 
uöt32_t
 
ö_p‹t
,

90 c⁄° 
oÂ_a˘i⁄_hódî
 *,

91 
size_t
 
n_a˘i⁄s
);

92 
oÂbuf
 *
make_buf„ªd_∑ckë_out
(
uöt32_t
 
buf„r_id
,

93 
uöt32_t
 
ö_p‹t
, uöt32_à
out_p‹t
);

94 
oÂbuf
 *
make_unbuf„ªd_∑ckë_out
(c⁄° oÂbu‡*
∑ckë
,

95 
uöt32_t
 
ö_p‹t
, uöt32_à
out_p‹t
);

96 
oÂbuf
 *
make_echo_ªque°
();

97 
oÂbuf
 *
make_echo_ª∂y
(c⁄° 
oÂ_hódî
 *
rq
);

98 
check_oÂ_mesßge
(c⁄° 
oÂ_hódî
 *, 
uöt8_t
 
ty≥
, 
size_t
 
size
);

99 
check_oÂ_ö°ru˘i⁄_¨øy
(c⁄° 
oÂ_ö°ru˘i⁄
 *, 
uöt8_t
 
ty≥
,

100 
size_t
 
size
, size_à
¨øy_ñt_size
,

101 
size_t
 *
n_¨øy_ñts
);

102 
check_oÂ_mesßge_¨øy
(c⁄° 
oÂ_hódî
 *, 
uöt8_t
 
ty≥
,

103 
size_t
 
size
, size_à
¨øy_ñt_size
,

104 
size_t
 *
n_¨øy_ñts
);

105 
check_oÂ_∑ckë_out
(c⁄° 
oÂ_hódî
 *, 
oÂbuf
 *
d©a
,

106 *
n_a˘i⁄s
, 
max_p‹ts
);

108 
	sÊow_°©s_ôî©‹
 {

109 c⁄° 
uöt8_t
 *
	mpos
, *
	míd
;

111 c⁄° 
oÂ_Êow_°©s
 *
Êow_°©s_fú°
(
Êow_°©s_ôî©‹
 *,

112 c⁄° 
oÂ_mu…ù¨t_ª∂y
 *);

113 c⁄° 
oÂ_Êow_°©s
 *
Êow_°©s_√xt
(
Êow_°©s_ôî©‹
 *);

115 
	sa˘i⁄s_ôî©‹
 {

116 c⁄° 
oÂ_a˘i⁄
 *
	mpos
, *
	míd
;

118 c⁄° 
oÂ_a˘i⁄
 *
a˘i⁄s_fú°
(
a˘i⁄s_ôî©‹
 *,

119 c⁄° 
oÂ_a˘i⁄
 *,

120 
size_t
 
n_a˘i⁄s
);

121 c⁄° 
oÂ_a˘i⁄
 *
a˘i⁄s_√xt
(
a˘i⁄s_ôî©‹
 *);

122 
vÆid©e_a˘i⁄s
(c⁄° 
oÂ_a˘i⁄
 *, 
size_t
 
n_a˘i⁄s
,

123 
max_p‹ts
, 
boﬁ
 
is_∑ckë_out
);

124 
boﬁ
 
a˘i⁄_ouçuts_to_p‹t
(c⁄° 
oÂ_a˘i⁄
 *, 
uöt32_t
 
p‹t
);

127 
ölöe
 

128 
	$oÂ_mkîr
(
uöt16_t
 
ty≥
, uöt16_à
code
)

130 
	`as£π
(
ty≥
 > 0 &&Åype <= 0x7fff);

131  (
ty≥
 << 16Ë| 
code
;

132 
	}
}

135 
	uoÂ_a˘i⁄
 {

136 
uöt16_t
 
	mty≥
;

137 
oÂ_a˘i⁄_hódî
 
	mhódî
;

138 
oÂ_a˘i⁄_ex≥rimíãr_hódî
 
	mex≥rimíãr
;

140 
OFP_ASSERT
((
oÂ_a˘i⁄
) == 8);

	@lib/ofpbuf.c

34 
	~"oÂbuf.h
"

35 
	~<as£π.h
>

36 
	~<°dlib.h
>

37 
	~<°rög.h
>

38 
	~"dy«mic-°rög.h
"

39 
	~"utû.h
"

49 
	$oÂbuf_u£
(
oÂbuf
 *
b
, *
ba£
, 
size_t
 
Æloˇãd
)

51 
b
->
ba£
 = b->
d©a
 = base;

52 
b
->
Æloˇãd
 =állocated;

53 
b
->
size
 = 0;

54 
b
->
l2
 = b->
l3
 = b->
l4
 = b->
l7
 = 
NULL
;

55 
b
->
√xt
 = 
NULL
;

56 
b
->
¥iv©e_p
 = 
NULL
;

57 
	}
}

62 
	$oÂbuf_öô
(
oÂbuf
 *
b
, 
size_t
 
size
)

64 
	`oÂbuf_u£
(
b
, 
size
 ? 
	`xmÆloc
(sizeË: 
NULL
, size);

65 
	}
}

69 
	$oÂbuf_unöô
(
oÂbuf
 *
b
)

71 i‡(
b
) {

72 
	`‰ì
(
b
->
ba£
);

74 
	}
}

78 
	$oÂbuf_ªöô
(
oÂbuf
 *
b
, 
size_t
 
size
)

80 
	`oÂbuf_unöô
(
b
);

81 
	`oÂbuf_öô
(
b
, 
size
);

82 
	}
}

86 
oÂbuf
 *

87 
	$oÂbuf_√w
(
size_t
 
size
)

89 
oÂbuf
 *
b
 = 
	`xmÆloc
( *b);

90 
	`oÂbuf_öô
(
b
, 
size
);

91  
b
;

92 
	}
}

96 
oÂbuf
 *

97 
	$oÂbuf_√w_wôh_hódroom
(
size_t
 
size
, size_à
hódroom
)

99 
oÂbuf
 *
b
 = 
	`oÂbuf_√w
(
size
 + 
hódroom
);

100 
	`oÂbuf_ª£rve
(
b
, 
hódroom
);

101  
b
;

102 
	}
}

104 
oÂbuf
 *

105 
	$oÂbuf_˛⁄e
(c⁄° 
oÂbuf
 *
buf„r
)

107  
	`oÂbuf_˛⁄e_d©a
(
buf„r
->
d©a
, buf„r->
size
);

108 
	}
}

112 
oÂbuf
 *

113 
	$oÂbuf_˛⁄e_wôh_hódroom
(c⁄° 
oÂbuf
 *
buf„r
, 
size_t
 
hódroom
)

115 
oÂbuf
 *
b
 = 
	`oÂbuf_√w_wôh_hódroom
(
buf„r
->
size
, 
hódroom
);

116 
	`oÂbuf_put
(
b
, 
buf„r
->
d©a
, buf„r->
size
);

117  
b
;

118 
	}
}

120 
oÂbuf
 *

121 
	$oÂbuf_˛⁄e_d©a
(c⁄° *
d©a
, 
size_t
 
size
)

123 
oÂbuf
 *
b
 = 
	`oÂbuf_√w
(
size
);

124 
	`oÂbuf_put
(
b
, 
d©a
, 
size
);

125  
b
;

126 
	}
}

130 
	$oÂbuf_dñëe
(
oÂbuf
 *
b
)

132 i‡(
b
) {

133 
	`oÂbuf_unöô
(
b
);

134 
	`‰ì
(
b
);

136 
	}
}

142 
size_t


143 
	$oÂbuf_hódroom
(c⁄° 
oÂbuf
 *
b
)

145  (*)
b
->
d©a
 - (*)b->
ba£
;

146 
	}
}

150 
size_t


151 
	$oÂbuf_èûroom
(c⁄° 
oÂbuf
 *
b
)

153  (*)
	`oÂbuf_íd
(
b
Ë- (*)
	`oÂbuf_èû
(b);

154 
	}
}

159 
	$oÂbuf_ªba£__
(
oÂbuf
 *
b
, *
√w_ba£
)

161 i‡(
b
->
ba£
 !
√w_ba£
) {

162 
uöçå_t
 
ba£_dñè
 = (*)
√w_ba£
 - (*)
b
->
ba£
;

163 
b
->
ba£
 = 
√w_ba£
;

164 
b
->
d©a
 = (*)b->d©®+ 
ba£_dñè
;

165 i‡(
b
->
l2
) {

166 
b
->
l2
 = (*)b->l2 + 
ba£_dñè
;

168 i‡(
b
->
l3
) {

169 
b
->
l3
 = (*)b->l3 + 
ba£_dñè
;

171 i‡(
b
->
l4
) {

172 
b
->
l4
 = (*)b->l4 + 
ba£_dñè
;

174 i‡(
b
->
l7
) {

175 
b
->
l7
 = (*)b->l7 + 
ba£_dñè
;

178 
	}
}

182 
	$oÂbuf_ªsize_èûroom__
(
oÂbuf
 *
b
, 
size_t
 
√w_èûroom
)

184 
b
->
Æloˇãd
 = 
	`oÂbuf_hódroom
(bË+ b->
size
 + 
√w_èûroom
;

185 
	`oÂbuf_ªba£__
(
b
, 
	`xªÆloc
(b->
ba£
, b->
Æloˇãd
));

186 
	}
}

192 
	$oÂbuf_¥óŒoc_èûroom
(
oÂbuf
 *
b
, 
size_t
 
size
)

194 i‡(
size
 > 
	`oÂbuf_èûroom
(
b
)) {

195 
	`oÂbuf_ªsize_èûroom__
(
b
, 
	`MAX
(
size
, 64));

197 
	}
}

200 
	$oÂbuf_¥óŒoc_hódroom
(
oÂbuf
 *
b
, 
size_t
 
size
)

202 
	`as£π
(
size
 <
	`oÂbuf_hódroom
(
b
));

203 
	}
}

208 
	$oÂbuf_åim
(
oÂbuf
 *
b
)

210 i‡(
	`oÂbuf_èûroom
(
b
) > 0) {

211 
	`oÂbuf_ªsize_èûroom__
(
b
, 0);

213 
	}
}

219 
	$oÂbuf_put_unöô
(
oÂbuf
 *
b
, 
size_t
 
size
)

221 *
p
;

222 
	`oÂbuf_¥óŒoc_èûroom
(
b
, 
size
);

223 
p
 = 
	`oÂbuf_èû
(
b
);

224 
b
->
size
 += size;

225  
p
;

226 
	}
}

232 
	$oÂbuf_put_zîos
(
oÂbuf
 *
b
, 
size_t
 
size
)

234 *
d°
 = 
	`oÂbuf_put_unöô
(
b
, 
size
);

235 
	`mem£t
(
d°
, 0, 
size
);

236  
d°
;

237 
	}
}

243 
	$oÂbuf_put
(
oÂbuf
 *
b
, c⁄° *
p
, 
size_t
 
size
)

245 *
d°
 = 
	`oÂbuf_put_unöô
(
b
, 
size
);

246 
	`mem˝y
(
d°
, 
p
, 
size
);

247  
d°
;

248 
	}
}

253 
	$oÂbuf_ª£rve
(
oÂbuf
 *
b
, 
size_t
 
size
)

255 
	`as£π
(!
b
->
size
);

256 
	`oÂbuf_¥óŒoc_èûroom
(
b
, 
size
);

257 
b
->
d©a
 = (*)b->d©®+ 
size
;

258 
	}
}

261 
	$oÂbuf_push_unöô
(
oÂbuf
 *
b
, 
size_t
 
size
)

263 
	`oÂbuf_¥óŒoc_hódroom
(
b
, 
size
);

264 
b
->
d©a
 = (*)b->d©®- 
size
;

265 
b
->
size
 += size;

266  
b
->
d©a
;

267 
	}
}

273 
	$oÂbuf_push_zîos
(
oÂbuf
 *
b
, 
size_t
 
size
)

275 *
d°
 = 
	`oÂbuf_push_unöô
(
b
, 
size
);

276 
	`mem£t
(
d°
, 0, 
size
);

277  
d°
;

278 
	}
}

281 
	$oÂbuf_push
(
oÂbuf
 *
b
, c⁄° *
p
, 
size_t
 
size
)

283 *
d°
 = 
	`oÂbuf_push_unöô
(
b
, 
size
);

284 
	`mem˝y
(
d°
, 
p
, 
size
);

285  
d°
;

286 
	}
}

291 
	$oÂbuf_©
(c⁄° 
oÂbuf
 *
b
, 
size_t
 
off£t
, size_à
size
)

293  
off£t
 + 
size
 <
b
->sizê? (*Ëb->
d©a
 + off£à: 
NULL
;

294 
	}
}

299 
	$oÂbuf_©_as£π
(c⁄° 
oÂbuf
 *
b
, 
size_t
 
off£t
, size_à
size
)

301 
	`as£π
(
off£t
 + 
size
 <
b
->size);

302  ((*Ë
b
->
d©a
Ë+ 
off£t
;

303 
	}
}

307 
	$oÂbuf_èû
(c⁄° 
oÂbuf
 *
b
)

309  (*Ë
b
->
d©a
 + b->
size
;

310 
	}
}

315 
	$oÂbuf_íd
(c⁄° 
oÂbuf
 *
b
)

317  (*Ë
b
->
ba£
 + b->
Æloˇãd
;

318 
	}
}

322 
	$oÂbuf_˛ór
(
oÂbuf
 *
b
)

324 
b
->
d©a
 = b->
ba£
;

325 
b
->
size
 = 0;

326 
	}
}

331 
	$oÂbuf_puŒ
(
oÂbuf
 *
b
, 
size_t
 
size
)

333 *
d©a
 = 
b
->data;

334 
	`as£π
(
b
->
size
 >= size);

335 
b
->
d©a
 = (*)b->d©®+ 
size
;

336 
b
->
size
 -= size;

337  
d©a
;

338 
	}
}

344 
	$oÂbuf_åy_puŒ
(
oÂbuf
 *
b
, 
size_t
 
size
)

346  
b
->
size
 >sizê? 
	`oÂbuf_puŒ
(b, sizeË: 
NULL
;

347 
	}
}

	@lib/ofpbuf.h

34 #i‚de‡
OFPBUF_H


35 
	#OFPBUF_H
 1

	)

37 
	~<°ddef.h
>

38 
	~<°döt.h
>

42 
	soÂbuf
 {

43 *
	mba£
;

44 
size_t
 
	mÆloˇãd
;

46 
uöt8_t
 
	mc⁄n_id
;

49 *
	md©a
;

50 
size_t
 
	msize
;

52 *
	ml2
;

53 *
	ml3
;

54 *
	ml4
;

55 *
	ml7
;

57 
oÂbuf
 *
	m√xt
;

58 *
	m¥iv©e_p
;

61 
oÂbuf_u£
(
oÂbuf
 *, *, 
size_t
);

63 
oÂbuf_öô
(
oÂbuf
 *, 
size_t
);

64 
oÂbuf_unöô
(
oÂbuf
 *);

65 
oÂbuf_ªöô
(
oÂbuf
 *, 
size_t
);

67 
oÂbuf
 *
oÂbuf_√w
(
size_t
);

68 
oÂbuf
 *
oÂbuf_√w_wôh_hódroom
(
size_t
, size_à
hódroom
);

69 
oÂbuf
 *
oÂbuf_˛⁄e
(const ofpbuf *);

70 
oÂbuf
 *
oÂbuf_˛⁄e_wôh_hódroom
(const ofpbuf *,

71 
size_t
 
hódroom
);

72 
oÂbuf
 *
oÂbuf_˛⁄e_d©a
(c⁄° *, 
size_t
);

73 
oÂbuf_dñëe
(
oÂbuf
 *);

75 *
oÂbuf_©
(c⁄° 
oÂbuf
 *, 
size_t
 
off£t
, size_à
size
);

76 *
oÂbuf_©_as£π
(c⁄° 
oÂbuf
 *, 
size_t
 
off£t
, size_à
size
);

77 *
oÂbuf_èû
(c⁄° 
oÂbuf
 *);

78 *
oÂbuf_íd
(c⁄° 
oÂbuf
 *);

80 *
oÂbuf_put_unöô
(
oÂbuf
 *, 
size_t
);

81 *
oÂbuf_put_zîos
(
oÂbuf
 *, 
size_t
);

82 *
oÂbuf_put
(
oÂbuf
 *, c⁄° *, 
size_t
);

83 
oÂbuf_ª£rve
(
oÂbuf
 *, 
size_t
);

84 *
oÂbuf_push_unöô
(
oÂbuf
 *
b
, 
size_t
);

85 *
oÂbuf_push_zîos
(
oÂbuf
 *, 
size_t
);

86 *
oÂbuf_push
(
oÂbuf
 *
b
, c⁄° *, 
size_t
);

88 
size_t
 
oÂbuf_hódroom
(c⁄° 
oÂbuf
 *);

89 
size_t
 
oÂbuf_èûroom
(c⁄° 
oÂbuf
 *);

90 
oÂbuf_¥óŒoc_hódroom
(
oÂbuf
 *, 
size_t
);

91 
oÂbuf_¥óŒoc_èûroom
(
oÂbuf
 *, 
size_t
);

92 
oÂbuf_åim
(
oÂbuf
 *);

94 
oÂbuf_˛ór
(
oÂbuf
 *);

95 *
oÂbuf_puŒ
(
oÂbuf
 *, 
size_t
);

96 *
oÂbuf_åy_puŒ
(
oÂbuf
 *, 
size_t
);

	@lib/ofpstat.c

33 
	~<c⁄fig.h
>

34 
	~<√töë/ö.h
>

36 
	~"›íÊow/›íÊow.h
"

37 
	~"oÂ°©.h
"

39 
	#INC_IFP_STAT
(
iÂs
, 
èg
Ëdÿ{++(iÂs)->èg;} 0)

	)

41 
öc_¥Ÿocﬁ_mesßge
(
oÂ°©
 *, 
oÂ_hódî
 *);

42 
öc_îr‹_nŸifiˇti⁄
(
oÂ°©
 *, 
oÂ_hódî
 *);

43 
öc_Êow_m™ùuœti⁄
(
oÂ°©
 *, 
oÂ_hódî
 *);

46 
	$öc_¥Ÿocﬁ_mesßge
(
oÂ°©
 *
iÂs
, 
oÂ_hódî
 *
hdr
)

48 
hdr
->
ty≥
) {

49 
OFPT_HELLO
:

50 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_hñlo
);

52 
OFPT_ERROR
:

53 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹
);

55 
OFPT_ECHO_REQUEST
:

56 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_echo_ªque°
);

58 
OFPT_ECHO_REPLY
:

59 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_echo_ª∂y
);

61 
OFPT_VENDOR
:

62 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_víd‹
);

64 
OFPT_FEATURES_REQUEST
:

65 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_„©s_ªque°
);

67 
OFPT_FEATURES_REPLY
:

68 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_„©s_ª∂y
);

70 
OFPT_GET_CONFIG_REQUEST
:

71 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_gë_c⁄fig_ªque°
);

73 
OFPT_GET_CONFIG_REPLY
:

74 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_gë_c⁄fig_ª∂y
);

76 
OFPT_SET_CONFIG
:

77 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_£t_c⁄fig
);

79 
OFPT_PACKET_IN
:

80 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_∑ckë_ö
);

82 
OFPT_FLOW_REMOVED
:

83 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_Êow_ªmoved
);

85 
OFPT_PORT_STATUS
:

86 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_p‹t_°©us
);

88 
OFPT_PACKET_OUT
:

89 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_∑ckë_out
);

91 
OFPT_FLOW_MOD
:

92 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_Êow_mod
);

94 
OFPT_PORT_MOD
:

95 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_p‹t_mod
);

97 
OFPT_MULTIPART_REQUEST
:

98 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_°©s_ªque°
);

100 
OFPT_MULTIPART_REPLY
:

101 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_°©s_ª∂y
);

103 
OFPT_BARRIER_REQUEST
:

104 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_b¨rõr_ªque°
);

106 
OFPT_BARRIER_REPLY
:

107 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_b¨rõr_ª∂y
);

110 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_unknown
);

113 
	}
}

116 
	$öc_îr‹_nŸifiˇti⁄
(
oÂ°©
 *
iÂs
, 
oÂ_hódî
 *
hdr
)

118 
oÂ_îr‹_msg
 *
îrmsg
 = (oÂ_îr‹_msg *)
hdr
;

119 
uöt16_t
 
îπy≥
 = 
	`¡ohs
(
îrmsg
->
ty≥
);

120 
uöt16_t
 
îrcode
 = 
	`¡ohs
(
îrmsg
->
code
);

122 
îπy≥
) {

123 
OFPET_HELLO_FAILED
:

124 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_ty≥
.
hñlo_Áû
);

125 
îrcode
) {

126 
OFPHFC_INCOMPATIBLE
:

127 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_code
.
hf_öcom∑t
);

129 
OFPHFC_EPERM
:

130 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_code
.
hf_ïîm
);

133 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_code
.
unknown
);

137 
OFPET_BAD_REQUEST
:

138 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_ty≥
.
bad_ªque°
);

139 
îrcode
) {

140 
OFPBRC_BAD_VERSION
:

141 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_code
.
br_bad_vîsi⁄
);

143 
OFPBRC_BAD_TYPE
:

144 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_code
.
br_bad_ty≥
);

146 
OFPBRC_BAD_MULTIPART
:

147 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_code
.
br_bad_°©
);

149 
OFPBRC_BAD_VENDOR
:

150 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_code
.
br_bad_víd‹
);

152 
OFPBRC_EPERM
:

153 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_code
.
br_ïîm
);

156 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_code
.
unknown
);

160 
OFPET_BAD_ACTION
:

161 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_ty≥
.
bad_a˘i⁄
);

162 
îrcode
) {

163 
OFPBAC_BAD_TYPE
:

164 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_code
.
ba_bad_ty≥
);

166 
OFPBAC_BAD_LEN
:

167 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_code
.
ba_bad_Àn
);

169 
OFPBAC_BAD_VENDOR
:

170 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_code
.
ba_bad_víd‹
);

172 
OFPBAC_BAD_VENDOR_TYPE
:

173 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_code
.
ba_bad_víd‹_ty≥
);

175 
OFPBAC_BAD_OUT_PORT
:

176 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_code
.
ba_bad_out_p‹t
);

178 
OFPBAC_BAD_ARGUMENT
:

179 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_code
.
ba_bad_¨gumít
);

181 
OFPBAC_EPERM
:

182 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_code
.
ba_ïîm
);

185 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_code
.
unknown
);

189 
OFPET_FLOW_MOD_FAILED
:

190 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_ty≥
.
Êow_mod_Áû
);

191 
îrcode
) {

192 
OFPFMFC_ALL_TABLES_FULL
:

193 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_code
.
fmf_Æl_èbÀs_fuŒ
);

195 
OFPFMFC_OVERLAP
:

196 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_code
.
fmf_ovîœp
);

198 
OFPFMFC_EPERM
:

199 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_code
.
fmf_ïîm
);

201 
OFPFMFC_BAD_EMERG_TIMEOUT
:

202 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_code
.
fmf_emîg
);

205 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_code
.
unknown
);

210 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_îr‹_ty≥
.
unknown
);

213 
	}
}

216 
	$öc_Êow_m™ùuœti⁄
(
oÂ°©
 *
iÂs
, 
oÂ_hódî
 *
hdr
)

218 
oÂ_Êow_mod
 *
Êowmodmsg
 = (oÂ_Êow_mod *)
hdr
;

219 
uöt16_t
 
Êowmod›s
 = 
	`¡ohs
(
Êowmodmsg
->
comm™d
);

221 
Êowmod›s
) {

222 
OFPFC_ADD
:

223 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_Êow_mod_›s
.
add
);

225 
OFPFC_MODIFY
:

226 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_Êow_mod_›s
.
modify
);

228 
OFPFC_MODIFY_STRICT
:

229 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_Êow_mod_›s
.
modify_°ri˘
);

231 
OFPFC_DELETE
:

232 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_Êow_mod_›s
.
dñëe
);

234 
OFPFC_DELETE_STRICT
:

235 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_Êow_mod_›s
.
dñëe_°ri˘
);

238 
	`INC_IFP_STAT
(
iÂs
, 
oÂs_Êow_mod_›s
.
unknown
);

241 
	}
}

244 
	$oÂ°©_öc_¥Ÿocﬁ_°©
(
oÂ°©
 *
iÂs
, 
oÂ_hódî
 *
hdr
)

246 ++
iÂs
->
oÂs_tŸÆ
;

247 
	`öc_¥Ÿocﬁ_mesßge
(
iÂs
, 
hdr
);

249 
hdr
->
ty≥
) {

250 
OFPT_ERROR
:

251 
	`öc_îr‹_nŸifiˇti⁄
(
iÂs
, 
hdr
);

253 
OFPT_FLOW_MOD
:

254 
	`öc_Êow_m™ùuœti⁄
(
iÂs
, 
hdr
);

259 
	}
}

	@lib/ofpstat.h

33 #i‚de‡
OFPSTAT_H_


34 
	#OFPSTAT_H_


	)

36 
	goÂ_hódî
;

38 
	soÂ°©
 {

39 
uöt64_t
 
	moÂs_tŸÆ
;

40 
uöt64_t
 
	moÂs_unknown
;

42 
uöt64_t
 
	moÂs_hñlo
;

43 
uöt64_t
 
	moÂs_îr‹
;

45 
uöt64_t
 
	mhñlo_Áû
;

46 
uöt64_t
 
	mbad_ªque°
;

47 
uöt64_t
 
	mbad_a˘i⁄
;

48 
uöt64_t
 
	mÊow_mod_Áû
;

49 
uöt64_t
 
	munknown
;

50 } 
	moÂs_îr‹_ty≥
;

52 
uöt64_t
 
	mhf_öcom∑t
;

53 
uöt64_t
 
	mhf_ïîm
;

54 
uöt64_t
 
	mbr_bad_vîsi⁄
;

55 
uöt64_t
 
	mbr_bad_ty≥
;

56 
uöt64_t
 
	mbr_bad_°©
;

57 
uöt64_t
 
	mbr_bad_víd‹
;

58 
uöt64_t
 
	mbr_ïîm
;

59 
uöt64_t
 
	mba_bad_ty≥
;

60 
uöt64_t
 
	mba_bad_Àn
;

61 
uöt64_t
 
	mba_bad_víd‹
;

62 
uöt64_t
 
	mba_bad_víd‹_ty≥
;

63 
uöt64_t
 
	mba_bad_out_p‹t
;

64 
uöt64_t
 
	mba_bad_¨gumít
;

65 
uöt64_t
 
	mba_ïîm
;

66 
uöt64_t
 
	mfmf_Æl_èbÀs_fuŒ
;

67 
uöt64_t
 
	mfmf_ovîœp
;

68 
uöt64_t
 
	mfmf_ïîm
;

69 
uöt64_t
 
	mfmf_emîg
;

70 
uöt64_t
 
	munknown
;

71 } 
	moÂs_îr‹_code
;

72 
uöt64_t
 
	moÂs_echo_ªque°
;

73 
uöt64_t
 
	moÂs_echo_ª∂y
;

74 
uöt64_t
 
	moÂs_víd‹
;

75 
uöt64_t
 
	moÂs_„©s_ªque°
;

76 
uöt64_t
 
	moÂs_„©s_ª∂y
;

77 
uöt64_t
 
	moÂs_gë_c⁄fig_ªque°
;

78 
uöt64_t
 
	moÂs_gë_c⁄fig_ª∂y
;

79 
uöt64_t
 
	moÂs_£t_c⁄fig
;

80 
uöt64_t
 
	moÂs_∑ckë_ö
;

81 
uöt64_t
 
	moÂs_Êow_ªmoved
;

82 
uöt64_t
 
	moÂs_p‹t_°©us
;

83 
uöt64_t
 
	moÂs_∑ckë_out
;

84 
uöt64_t
 
	moÂs_Êow_mod
;

86 
uöt64_t
 
	madd
;

87 
uöt64_t
 
	mmodify
;

88 
uöt64_t
 
	mmodify_°ri˘
;

89 
uöt64_t
 
	mdñëe
;

90 
uöt64_t
 
	mdñëe_°ri˘
;

91 
uöt64_t
 
	munknown
;

92 } 
	moÂs_Êow_mod_›s
;

93 
uöt64_t
 
	moÂs_p‹t_mod
;

94 
uöt64_t
 
	moÂs_°©s_ªque°
;

95 
uöt64_t
 
	moÂs_°©s_ª∂y
;

96 
uöt64_t
 
	moÂs_b¨rõr_ªque°
;

97 
uöt64_t
 
	moÂs_b¨rõr_ª∂y
;

100 
oÂ°©_öc_¥Ÿocﬁ_°©
(
oÂ°©
 *, 
oÂ_hódî
 *);

	@lib/packets.h

33 #i‚de‡
PACKETS_H


34 
	#PACKETS_H
 1

	)

36 
	~<°döt.h
>

37 
	~<°rög.h
>

38 
	~<öây≥s.h
>

39 
	~<√töë/ö.h
>

40 
	~"compûî.h
"

41 
	~"øndom.h
"

42 
	~"utû.h
"

44 
	#ETH_ADDR_LEN
 6

	)

46 c⁄° 
uöt8_t
 
	gëh_addr_brﬂdˇ°
[
ETH_ADDR_LEN
] 
	gUNUSED


49 
ölöe
 
boﬁ
 
	$ëh_addr_is_brﬂdˇ°
(c⁄° 
uöt8_t
 
ó
[6])

51  (
ó
[0] &Éa[1] &Éa[2] &Éa[3] &Éa[4] &Éa[5]) == 0xff;

52 
	}
}

53 
ölöe
 
boﬁ
 
	$ëh_addr_is_mu…iˇ°
(c⁄° 
uöt8_t
 
ó
[6])

55  
ó
[0] & 1;

56 
	}
}

57 
ölöe
 
boﬁ
 
	$ëh_addr_is_loˇl
(c⁄° 
uöt8_t
 
ó
[6])

59  
ó
[0] & 2;

60 
	}
}

61 
ölöe
 
boﬁ
 
	$ëh_addr_is_zîo
(c⁄° 
uöt8_t
 
ó
[6])

63  !(
ó
[0] |Éa[1] |Éa[2] |Éa[3] |Éa[4] |Éa[5]);

64 
	}
}

65 
ölöe
 
boﬁ
 
	$ëh_addr_equÆs
(c⁄° 
uöt8_t
 
a
[
ETH_ADDR_LEN
],

66 c⁄° 
uöt8_t
 
b
[
ETH_ADDR_LEN
])

68  !
	`memcmp
(
a
, 
b
, 
ETH_ADDR_LEN
);

69 
	}
}

70 
ölöe
 
uöt64_t
 
	$ëh_addr_to_uöt64
(c⁄° 
uöt8_t
 
ó
[
ETH_ADDR_LEN
])

72  (((
uöt64_t
Ë
ó
[0] << 40)

73 | ((
uöt64_t
Ë
ó
[1] << 32)

74 | ((
uöt64_t
Ë
ó
[2] << 24)

75 | ((
uöt64_t
Ë
ó
[3] << 16)

76 | ((
uöt64_t
Ë
ó
[4] << 8)

77 | 
ó
[5]);

78 
	}
}

79 
ölöe
 
	$ëh_addr_‰om_uöt64
(
uöt64_t
 
x
, 
uöt8_t
 
ó
[
ETH_ADDR_LEN
])

81 
ó
[0] = 
x
 >> 40;

82 
ó
[1] = 
x
 >> 32;

83 
ó
[2] = 
x
 >> 24;

84 
ó
[3] = 
x
 >> 16;

85 
ó
[4] = 
x
 >> 8;

86 
ó
[5] = 
x
;

87 
	}
}

88 
ölöe
 
	$ëh_addr_øndom
(
uöt8_t
 
ó
[
ETH_ADDR_LEN
])

90 
	`øndom_byãs
(
ó
, 
ETH_ADDR_LEN
);

91 
ó
[0] &= ~1;

92 
ó
[0] |= 2;

93 
	}
}

96 
ölöe
 
boﬁ
 
	$ëh_addr_is_ª£rved
(c⁄° 
uöt8_t
 
ó
[
ETH_ADDR_LEN
])

98  (
ó
[0] == 0x01

99 && 
ó
[1] == 0x80

100 && 
ó
[2] == 0xc2

101 && 
ó
[3] == 0x00

102 && 
ó
[4] == 0x00

103 && (
ó
[5] & 0xf0) == 0x00);

104 
	}
}

106 
	#ETH_ADDR_FMT
 \

107 "%02"
PRIx8
":%02"PRIx8":%02"PRIx8":%02"PRIx8":%02"PRIx8":%02"
	)
PRIx8

108 
	#ETH_ADDR_ARGS
(
ó
) \

109 (
ó
)[0], (ó)[1], (ó)[2], (ó)[3], (ó)[4], (ó)[5]

	)

112 
	#ETH_TYPE_II_START
 0x0600

	)

113 
	#ETH_TYPE_IP
 0x0800

	)

114 
	#ETH_TYPE_IPV6
 0x86dd

	)

115 
	#ETH_TYPE_ARP
 0x0806

	)

116 
	#ETH_TYPE_VLAN
 0x8100

	)

117 
	#ETH_TYPE_SVLAN
 0x9200

	)

118 
	#ETH_TYPE_VLAN_QöQ
 0x9100

	)

119 
	#ETH_TYPE_VLAN_PBB_B
 0x88a8

	)

120 
	#ETH_TYPE_VLAN_PBB_S
 0x88e7

	)

121 
	#ETH_TYPE_MPLS
 0x8847

	)

122 
	#ETH_TYPE_MPLS_MCAST
 0x8848

	)

124 
	#ETH_HEADER_LEN
 14

	)

125 
	#ETH_PAYLOAD_MIN
 46

	)

126 
	#ETH_PAYLOAD_MAX
 1500

	)

127 
	#ETH_TOTAL_MIN
 (
ETH_HEADER_LEN
 + 
ETH_PAYLOAD_MIN
)

	)

128 
	#ETH_TOTAL_MAX
 (
ETH_HEADER_LEN
 + 
ETH_PAYLOAD_MAX
)

	)

129 
	#ETH_VLAN_TOTAL_MAX
 (
ETH_HEADER_LEN
 + 
VLAN_HEADER_LEN
 + 
ETH_PAYLOAD_MAX
)

	)

130 
	sëh_hódî
 {

131 
uöt8_t
 
	mëh_d°
[
ETH_ADDR_LEN
];

132 
uöt8_t
 
	mëh_§c
[
ETH_ADDR_LEN
];

133 
uöt16_t
 
	mëh_ty≥
;

134 } 
__©åibuã__
((
∑cked
));

135 
BUILD_ASSERT_DECL
(
ETH_HEADER_LEN
 =(
ëh_hódî
));

137 
	#LLC_DSAP_SNAP
 0xØ

	)

138 
	#LLC_SSAP_SNAP
 0xØ

	)

139 
	#LLC_CNTL_SNAP
 3

	)

141 
	#LLC_HEADER_LEN
 3

	)

142 
	sŒc_hódî
 {

143 
uöt8_t
 
	mŒc_dßp
;

144 
uöt8_t
 
	mŒc_sßp
;

145 
uöt8_t
 
	mŒc_˙é
;

146 } 
__©åibuã__
((
∑cked
));

147 
BUILD_ASSERT_DECL
(
LLC_HEADER_LEN
 =(
Œc_hódî
));

149 
	#SNAP_ORG_ETHERNET
 "\0\0"

	)

151 
	#SNAP_HEADER_LEN
 5

	)

152 
	s¢≠_hódî
 {

153 
uöt8_t
 
	m¢≠_‹g
[3];

154 
uöt16_t
 
	m¢≠_ty≥
;

155 } 
__©åibuã__
((
∑cked
));

156 
BUILD_ASSERT_DECL
(
SNAP_HEADER_LEN
 =(
¢≠_hódî
));

158 
	#LLC_SNAP_HEADER_LEN
 (
LLC_HEADER_LEN
 + 
SNAP_HEADER_LEN
)

	)

159 
	sŒc_¢≠_hódî
 {

160 
Œc_hódî
 
	mŒc
;

161 
¢≠_hódî
 
	m¢≠
;

162 } 
__©åibuã__
((
∑cked
));

163 
BUILD_ASSERT_DECL
(
LLC_SNAP_HEADER_LEN
 =(
Œc_¢≠_hódî
));

165 
	#VLAN_VID_MASK
 0x0fff

	)

166 
	#VLAN_VID_SHIFT
 0

	)

167 
	#VLAN_PCP_MASK
 0xe000

	)

168 
	#VLAN_PCP_SHIFT
 13

	)

169 
	#VLAN_PCP_BITMASK
 0x0007

	)

171 
	#VLAN_VID_MAX
 4095

	)

172 
	#VLAN_PCP_MAX
 7

	)

174 
	#VLAN_HEADER_LEN
 4

	)

175 
	svœn_hódî
 {

176 
uöt16_t
 
	mvœn_tci
;

177 
uöt16_t
 
	mvœn_√xt_ty≥
;

179 
BUILD_ASSERT_DECL
(
VLAN_HEADER_LEN
 =(
vœn_hódî
));

182 
	svœn_èg
 {

183 
uöt16_t
 
	mvœn_ç_id
;

184 
uöt16_t
 
	mvœn_tci
;

187 
	#VLAN_ETH_HEADER_LEN
 (
ETH_HEADER_LEN
 + 
VLAN_HEADER_LEN
)

	)

188 
	svœn_ëh_hódî
 {

189 
uöt8_t
 
	mvëh_d°
[
ETH_ADDR_LEN
];

190 
uöt8_t
 
	mvëh_§c
[
ETH_ADDR_LEN
];

191 
uöt16_t
 
	mvëh_ty≥
;

192 
uöt16_t
 
	mvëh_tci
;

193 
uöt16_t
 
	mvëh_√xt_ty≥
;

194 } 
__©åibuã__
((
∑cked
));

195 
BUILD_ASSERT_DECL
(
VLAN_ETH_HEADER_LEN
 =(
vœn_ëh_hódî
));

201 
	#IP_FMT
 "%"
PRIu8
".%"PRIu8".%"PRIu8".%"
	)
PRIu8

202 
	#IP_ARGS
(
ù
) \

203 ((Ë(
ù
)[0], ((
uöt8_t
 *) ip)[0]), \

204 ((
uöt8_t
 *Ë
ù
)[1], \

205 ((
uöt8_t
 *Ë
ù
)[2], \

206 ((
uöt8_t
 *Ë
ù
)[3]

	)

208 
	#IP_VER
(
ù_ihl_vî
Ë((ù_ihl_vîË>> 4)

	)

209 
	#IP_IHL
(
ù_ihl_vî
Ë((ù_ihl_vîË& 15)

	)

210 
	#IP_IHL_VER
(
ihl
, 
vî
Ë(((vîË<< 4Ë| (ihl))

	)

213 
	#IP_ECN_MASK
 0x03

	)

214 
	#IP_DSCP_MASK
 0xfc

	)

217 
	#IP_TYPE_ICMP
 1

	)

218 
	#IP_TYPE_TCP
 6

	)

219 
	#IP_TYPE_UDP
 17

	)

220 
	#IP_TYPE_SCTP
 132

	)

224 
	#IP_VERSION
 4

	)

226 
	#IP_DONT_FRAGMENT
 0x4000

	)

227 
	#IP_MORE_FRAGMENTS
 0x2000

	)

228 
	#IP_FRAG_OFF_MASK
 0x1ff‡

	)

229 
	#IP_IS_FRAGMENT
(
ù_‰ag_off
) \

230 ((
ù_‰ag_off
Ë& 
	`ht⁄s
(
IP_MORE_FRAGMENTS
 | 
IP_FRAG_OFF_MASK
))

	)

232 
	#IP_ADDR_LEN
 4

	)

234 
	#IP_HEADER_LEN
 20

	)

235 
	sù_hódî
 {

236 
uöt8_t
 
	mù_ihl_vî
;

237 
uöt8_t
 
	mù_tos
;

238 
uöt16_t
 
	mù_tŸ_Àn
;

239 
uöt16_t
 
	mù_id
;

240 
uöt16_t
 
	mù_‰ag_off
;

241 
uöt8_t
 
	mù_âl
;

242 
uöt8_t
 
	mù_¥Ÿo
;

243 
uöt16_t
 
	mù_csum
;

244 
uöt32_t
 
	mù_§c
;

245 
uöt32_t
 
	mù_d°
;

247 
BUILD_ASSERT_DECL
(
IP_HEADER_LEN
 =(
ù_hódî
));

249 
	#IPV6_TYPE_HBH
 0

	)

250 
	#IPV6_TYPE_DOH
 60

	)

251 
	#IPV6_TYPE_RH
 43

	)

252 
	#IPV6_TYPE_FH
 44

	)

253 
	#IPV6_TYPE_AH
 51

	)

254 
	#IPV6_TYPE_ESP
 50

	)

255 
	#IPV6_TYPE_ICMPV6
 58

	)

256 
	#IPV6_NO_NEXT_HEADER
 59

	)

258 
	#IPV6_VER
(
ùv6_vî_tc_Ê
Ë((ùv6_vî_tc_ÊË>> 28)

	)

259 
	#IPV6_TC
(
ùv6_vî_tc_Ê
Ë((ùv6_vî_tc_ÊË& 0xff00000)

	)

260 
	#IPV6_FLABEL
(
ùv6_vî_tc_Ê
Ë((ùv6_vî_tc_ÊË& 0xffff)

	)

262 
	#IPV6_FLABEL_MASK
 0xfffff

	)

264 
	#IPV6_HEADER_LEN
 40

	)

265 
	sùv6_hódî
 {

266 
uöt32_t
 
	mùv6_vî_tc_Ê
;

267 
uöt16_t
 
	mùv6_∑y_Àn
;

268 
uöt8_t
 
	mùv6_√xt_hd
;

269 
uöt8_t
 
	mùv6_h›_limô
;

270 
ö6_addr
 
	mùv6_§c
;

271 
ö6_addr
 
	mùv6_d°
;

273 
BUILD_ASSERT_DECL
(
IPV6_HEADER_LEN
 =(
ùv6_hódî
));

275 
	eùv6_ext_hdr_‹dî_T1
 {

276 
	mHBH
 = 1 << 0,

277 
	mDESTINATION
 = 1 << 1,

278 
	mROUTING
 = 1 << 2,

279 
	mFRAGMENT
 = 1 << 3,

280 
	mAUTHENTICATION
 = 1 << 4,

281 
	mESP
 = 1 << 5,

284 
	#ICMPV6_NEIGHSOL
 135

	)

285 
	#ICMPV6_NEIGHADV
 136

	)

287 
	#ICMP_HEADER_LEN
 4

	)

288 
	sicmp_hódî
 {

289 
uöt8_t
 
	micmp_ty≥
;

290 
uöt8_t
 
	micmp_code
;

291 
uöt16_t
 
	micmp_csum
;

293 
BUILD_ASSERT_DECL
(
ICMP_HEADER_LEN
 =(
icmp_hódî
));

296 
	#ND_OPT_SLL
 1

	)

297 
	#ND_OPT_TLL
 2

	)

299 
	#IPV6_ND_HEADER_LEN
 20

	)

300 
	sùv6_nd_hódî
{

301 
uöt32_t
 
	mª£rved
;

302 
ö6_addr
 
	mèrgë_addr
;

305 
	#IPV6_ND_OPT_HD_LEN
 2

	)

306 
	sùv6_nd_›ti⁄s_hd
{

307 
uöt8_t
 
	mty≥
;

308 
uöt8_t
 
	mÀngth
;

311 
	#UDP_HEADER_LEN
 8

	)

312 
	sudp_hódî
 {

313 
uöt16_t
 
	mudp_§c
;

314 
uöt16_t
 
	mudp_d°
;

315 
uöt16_t
 
	mudp_Àn
;

316 
uöt16_t
 
	mudp_csum
;

318 
BUILD_ASSERT_DECL
(
UDP_HEADER_LEN
 =(
udp_hódî
));

320 
	#TCP_FIN
 0x01

	)

321 
	#TCP_SYN
 0x02

	)

322 
	#TCP_RST
 0x04

	)

323 
	#TCP_PSH
 0x08

	)

324 
	#TCP_ACK
 0x10

	)

325 
	#TCP_URG
 0x20

	)

327 
	#TCP_FLAGS
(
t˝_˘l
Ë(
	`ht⁄s
—˝_˘lË& 0x003f)

	)

328 
	#TCP_OFFSET
(
t˝_˘l
Ë(
	`ht⁄s
—˝_˘lË>> 12)

	)

330 
	#TCP_HEADER_LEN
 20

	)

331 
	st˝_hódî
 {

332 
uöt16_t
 
	mt˝_§c
;

333 
uöt16_t
 
	mt˝_d°
;

334 
uöt32_t
 
	mt˝_£q
;

335 
uöt32_t
 
	mt˝_ack
;

336 
uöt16_t
 
	mt˝_˘l
;

337 
uöt16_t
 
	mt˝_wösz
;

338 
uöt16_t
 
	mt˝_csum
;

339 
uöt16_t
 
	mt˝_urg
;

341 
BUILD_ASSERT_DECL
(
TCP_HEADER_LEN
 =(
t˝_hódî
));

343 
	#SCTP_HEADER_LEN
 12

	)

344 
	ss˘p_hódî
 {

345 
uöt16_t
 
	ms˘p_§c
;

346 
uöt16_t
 
	ms˘p_d°
;

347 
uöt32_t
 
	ms˘p_vîif
;

348 
uöt32_t
 
	ms˘p_csum
;

350 
BUILD_ASSERT_DECL
(
SCTP_HEADER_LEN
 =(
s˘p_hódî
));

352 
	#ARP_HRD_ETHERNET
 1

	)

353 
	#ARP_PRO_IP
 0x0800

	)

354 
	#ARP_OP_REQUEST
 1

	)

355 
	#ARP_OP_REPLY
 2

	)

357 
	#ARP_ETH_HEADER_LEN
 28

	)

358 
	s¨p_ëh_hódî
 {

360 
uöt16_t
 
	m¨_hrd
;

361 
uöt16_t
 
	m¨_¥o
;

362 
uöt8_t
 
	m¨_h 
;

363 
uöt8_t
 
	m¨_∂n
;

364 
uöt16_t
 
	m¨_›
;

367 
uöt8_t
 
	m¨_sha
[
ETH_ADDR_LEN
];

368 
uöt32_t
 
	m¨_•a
;

369 
uöt8_t
 
	m¨_tha
[
ETH_ADDR_LEN
];

370 
uöt32_t
 
	m¨_ça
;

371 } 
__©åibuã__
((
∑cked
));

372 
BUILD_ASSERT_DECL
(
ARP_ETH_HEADER_LEN
 =(
¨p_ëh_hódî
));

374 
	sqèg_¥efix
 {

375 
uöt16_t
 
	mëh_ty≥
;

376 
uöt16_t
 
	mtci
;

379 
	#PBB_HEADER_LEN
 18

	)

380 
	#PBB_ISID_MASK
 0xffffff

	)

382 
	spbb_hódî
 {

383 
uöt32_t
 
	mid
;

384 
uöt8_t
 
	mc_ëh_d°
[
ETH_ADDR_LEN
];

385 
uöt8_t
 
	mc_ëh_§c
[
ETH_ADDR_LEN
];

386 
uöt16_t
 
	mpbb_√xt_ty≥
;

389 
	#MPLS_LABEL_MAX
 1048575

	)

390 
	#MPLS_TC_MAX
 7

	)

392 
	#MPLS_HEADER_LEN
 4

	)

393 
	sm∂s_hódî
 {

394 
uöt32_t
 
	mfõlds
;

397 
	#MPLS_TTL_MASK
 0x000000ff

	)

398 
	#MPLS_TTL_SHIFT
 0

	)

399 
	#MPLS_S_MASK
 0x00000100

	)

400 
	#MPLS_S_SHIFT
 8

	)

401 
	#MPLS_TC_MASK
 0x00000e00

	)

402 
	#MPLS_TC_SHIFT
 9

	)

403 
	#MPLS_LABEL_MASK
 0xfffff000

	)

404 
	#MPLS_LABEL_SHIFT
 12

	)

406 
BUILD_ASSERT_DECL
(
MPLS_HEADER_LEN
 =(
m∂s_hódî
));

408 
	s¥Ÿocﬁs_°d
 {

409 
ëh_hódî
 * 
	mëh
;

410 
¢≠_hódî
 * 
	mëh_¢≠
;

411 
vœn_hódî
 * 
	mvœn
;

412 
vœn_hódî
 * 
	mvœn_œ°
;

413 
m∂s_hódî
 * 
	mm∂s
;

414 
pbb_hódî
 * 
	mpbb
;

415 
ù_hódî
 * 
	mùv4
;

416 
ùv6_hódî
 * 
	mùv6
;

417 
¨p_ëh_hódî
 * 
	m¨p
;

418 
t˝_hódî
 * 
	mt˝
;

419 
udp_hódî
 * 
	mudp
;

420 
s˘p_hódî
 * 
	ms˘p
;

421 
icmp_hódî
 * 
	micmp
;

424 
ölöe
 

425 
	$¥Ÿocﬁ_ª£t
(
¥Ÿocﬁs_°d
 *
¥Ÿo
) {

426 
¥Ÿo
->
ëh
 = 
NULL
;

427 
¥Ÿo
->
ëh_¢≠
 = 
NULL
;

428 
¥Ÿo
->
vœn
 = 
NULL
;

429 
¥Ÿo
->
vœn_œ°
 = 
NULL
;

430 
¥Ÿo
->
m∂s
 = 
NULL
;

431 
¥Ÿo
->
ùv4
 = 
NULL
;

432 
¥Ÿo
->
ùv6
 = 
NULL
;

433 
¥Ÿo
->
¨p
 = 
NULL
;

434 
¥Ÿo
->
t˝
 = 
NULL
;

435 
¥Ÿo
->
udp
 = 
NULL
;

436 
¥Ÿo
->
s˘p
 = 
NULL
;

437 
¥Ÿo
->
icmp
 = 
NULL
;

438 
¥Ÿo
->
pbb
 = 
NULL
;

439 
	}
}

	@lib/pcap.c

34 
	~<c⁄fig.h
>

35 
	~"pˇp.h
"

36 
	~<as£π.h
>

37 
	~<î∫o.h
>

38 
	~<öây≥s.h
>

39 
	~<°rög.h
>

40 
	~"compûî.h
"

41 
	~"oÂbuf.h
"

43 
	#LOG_MODULE
 
VLM_pˇp


	)

44 
	~"vlog.h
"

46 
	spˇp_hdr
 {

47 
uöt32_t
 
	mmagic_numbî
;

48 
uöt16_t
 
	mvîsi⁄_maj‹
;

49 
uöt16_t
 
	mvîsi⁄_mö‹
;

50 
öt32_t
 
	mthisz⁄e
;

51 
uöt32_t
 
	msigfigs
;

52 
uöt32_t
 
	m¢≠Àn
;

53 
uöt32_t
 
	m√tw‹k
;

54 } 
	gPACKED
;

56 
	spˇ¥ec_hdr
 {

57 
uöt32_t
 
	mts_£c
;

58 
uöt32_t
 
	mts_u£c
;

59 
uöt32_t
 
	mö˛_Àn
;

60 
uöt32_t
 
	m‹ig_Àn
;

61 } 
	gPACKED
;

63 
FILE
 *

64 
	$pˇp_›í
(c⁄° *
fûe_«me
, c⁄° *
mode
)

66 
FILE
 *
fûe
;

68 
	`as£π
(!
	`°rcmp
(
mode
, "rb") || !strcmp(mode, "wb"));

70 
fûe
 = 
	`f›í
(
fûe_«me
, 
mode
);

71 i‡(
fûe
 =
NULL
) {

72 
	`VLOG_WARN
(
LOG_MODULE
, "%s: failedÅo openÖcap file for %s",

73 
fûe_«me
, 
mode
[0] == 'r' ? "reading" : "writing");

74  
NULL
;

77 i‡(
mode
[0] == 'r') {

78 i‡(!
	`pˇp_ªad_hódî
(
fûe
)) {

79 
	`f˛o£
(
fûe
);

80  
NULL
;

83 
	`pˇp_wrôe_hódî
(
fûe
);

85  
fûe
;

86 
	}
}

89 
	$pˇp_ªad_hódî
(
FILE
 *
fûe
)

91 
pˇp_hdr
 
ph
;

92 i‡(
	`‰ód
(&
ph
, Öh, 1, 
fûe
) != 1) {

93 
îr‹
 = 
	`„º‹
(
fûe
Ë? 
î∫o
 : 
EOF
;

94 
	`VLOG_WARN
(
LOG_MODULE
, "failedÅoÑeadÖcap header: %s",

95 
îr‹
 > 0 ? 
	`°ªº‹
(error) : "end of file");

96  
îr‹
;

98 i‡(
ph
.
magic_numbî
 != 0xa1b2c3d4 &&Öh.magic_number != 0xd4c3b2a1) {

99 
	`VLOG_WARN
(
LOG_MODULE
, "bad magi¯0x%08"
PRIx32
"ÑeadingÖcap file "

100 "”x≥˘ed 0xa1b2c3d4 o∏0xd4c3b2a1)", 
ph
.
magic_numbî
);

101  
EPROTO
;

104 
	}
}

107 
	$pˇp_wrôe_hódî
(
FILE
 *
fûe
)

111 
pˇp_hdr
 
ph
;

112 
ph
.
magic_numbî
 = 0xa1b2c3d4;

113 
ph
.
vîsi⁄_maj‹
 = 2;

114 
ph
.
vîsi⁄_mö‹
 = 4;

115 
ph
.
thisz⁄e
 = 0;

116 
ph
.
sigfigs
 = 0;

117 
ph
.
¢≠Àn
 = 1518;

118 
ph
.
√tw‹k
 = 1;

119 
	`fwrôe
(&
ph
, Öh, 1, 
fûe
);

120 
	}
}

123 
	$pˇp_ªad
(
FILE
 *
fûe
, 
oÂbuf
 **
buÂ
)

125 
pˇ¥ec_hdr
 
¥h
;

126 
oÂbuf
 *
buf
;

127 *
d©a
;

128 
size_t
 
Àn
;

130 *
buÂ
 = 
NULL
;

133 i‡(
	`‰ód
(&
¥h
, Örh, 1, 
fûe
) != 1) {

134 
îr‹
 = 
	`„º‹
(
fûe
Ë? 
î∫o
 : 
EOF
;

135 
	`VLOG_WARN
(
LOG_MODULE
, "failedÅoÑeadÖcapÑecord header: %s",

136 
îr‹
 > 0 ? 
	`°ªº‹
(error) : "end of file");

137  
îr‹
;

141 
Àn
 = 
¥h
.
ö˛_Àn
;

142 i‡(
Àn
 > 0xffff) {

143 
uöt32_t
 
sw≠≥d_Àn
 = (((
Àn
 & 0xff000000) >> 24) |

144 ((
Àn
 & 0x00ff0000) >> 8) |

145 ((
Àn
 & 0x0000ff00) << 8) |

146 ((
Àn
 & 0x000000ff) << 24));

147 i‡(
sw≠≥d_Àn
 > 0xffff) {

148 
	`VLOG_WARN
(
LOG_MODULE
, "badÖackëÜígth %zu o∏%"
PRIu32
" "

150 
Àn
, 
sw≠≥d_Àn
);

151  
EPROTO
;

153 
Àn
 = 
sw≠≥d_Àn
;

157 
buf
 = 
	`oÂbuf_√w
(
Àn
);

158 
d©a
 = 
	`oÂbuf_put_unöô
(
buf
, 
Àn
);

159 i‡(
	`‰ód
(
d©a
, 
Àn
, 1, 
fûe
) != 1) {

160 
îr‹
 = 
	`„º‹
(
fûe
Ë? 
î∫o
 : 
EOF
;

161 
	`VLOG_WARN
(
LOG_MODULE
, "failedÅoÑeadÖcapÖacket: %s",

162 
îr‹
 > 0 ? 
	`°ªº‹
(error) : "end of file");

163 
	`oÂbuf_dñëe
(
buf
);

164  
îr‹
;

166 *
buÂ
 = 
buf
;

168 
	}
}

171 
	$pˇp_wrôe
(
FILE
 *
fûe
, 
oÂbuf
 *
buf
)

173 
pˇ¥ec_hdr
 
¥h
;

174 
¥h
.
ts_£c
 = 0;

175 
¥h
.
ts_u£c
 = 0;

176 
¥h
.
ö˛_Àn
 = 
buf
->
size
;

177 
¥h
.
‹ig_Àn
 = 
buf
->
size
;

178 
	`fwrôe
(&
¥h
, Örh, 1, 
fûe
);

179 
	`fwrôe
(
buf
->
d©a
, buf->
size
, 1, 
fûe
);

180 
	}
}

	@lib/pcap.h

34 #i‚de‡
PCAP_H


35 
	#PCAP_H
 1

	)

37 
	~<°dio.h
>

39 
	goÂbuf
;

41 
FILE
 *
pˇp_›í
(c⁄° *
fûe_«me
, c⁄° *
mode
);

42 
pˇp_ªad_hódî
(
FILE
 *);

43 
pˇp_wrôe_hódî
(
FILE
 *);

44 
pˇp_ªad
(
FILE
 *, 
oÂbuf
 **);

45 
pˇp_wrôe
(
FILE
 *, 
oÂbuf
 *);

	@lib/poll-loop.c

34 
	~<c⁄fig.h
>

35 
	~"pﬁl-lo›.h
"

36 
	~<as£π.h
>

37 
	~<î∫o.h
>

38 
	~<pﬁl.h
>

39 
	~<°dlib.h
>

40 
	~<°rög.h
>

41 
	~<öây≥s.h
>

42 
	~"backåa˚.h
"

43 
	~"dy«mic-°rög.h
"

44 
	~"li°.h
"

45 
	~"timevÆ.h
"

47 
	#LOG_MODULE
 
VLM_pﬁl_lo›


	)

48 
	~"vlog.h
"

51 
	spﬁl_waôî
 {

53 
li°
 
	mnode
;

54 
	mfd
;

55 
	mevíts
;

56 
pﬁl_fd_func
 *
	mfun˘i⁄
;

57 *
	maux
;

58 
backåa˚
 *
	mbackåa˚
;

61 
pﬁlfd
 *
	mpﬁlfd
;

66 
li°
 
	gwaôîs
 = 
LIST_INITIALIZER
(&
waôîs
);

69 
size_t
 
	gn_waôîs
;

73 
	gtimeout
 = -1;

76 
backåa˚
 
	gtimeout_backåa˚
;

80 #i‚de‡
NDEBUG


81 
pﬁl_waôî
 *
	gru¬ög_cb
;

84 
pﬁl_waôî
 *
√w_waôî
(
fd
, 
evíts
);

93 
pﬁl_waôî
 *

94 
	$pﬁl_fd_waô
(
fd
, 
evíts
)

96  
	`√w_waôî
(
fd
, 
evíts
);

97 
	}
}

107 
	$pﬁl_timî_waô
(
m£c
)

109 i‡(
timeout
 < 0 || 
m£c
 <Åimeout) {

110 
timeout
 = 
	`MAX
(0, 
m£c
);

111 i‡(
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

112 
	`backåa˚_ˇ±uª
(&
timeout_backåa˚
);

115 
	}
}

120 
	$pﬁl_immedüã_wake
()

122 
	`pﬁl_timî_waô
(0);

123 
	}
}

125 
	$PRINTF_FORMAT
(2, 3)

126 
	$log_wakeup
(c⁄° 
backåa˚
 *backåa˚, c⁄° *
f‹m©
, ...)

128 
ds
 ds;

129 
va_li°
 
¨gs
;

131 
	`ds_öô
(&
ds
);

132 
	`va_°¨t
(
¨gs
, 
f‹m©
);

133 
	`ds_put_f‹m©_vÆi°
(&
ds
, 
f‹m©
, 
¨gs
);

134 
	`va_íd
(
¨gs
);

136 i‡(
backåa˚
) {

137 
i
;

139 
	`ds_put_ch¨
(&
ds
, ':');

140 
i
 = 0; i < 
backåa˚
->
n_‰ames
; i++) {

141 
	`ds_put_f‹m©
(&
ds
, " 0x%"
PRIxPTR
"", 
backåa˚
->
‰ames
[
i
]);

144 
	`VLOG_DBG
(
LOG_MODULE
, "%s", 
	`ds_c°r
(&
ds
));

145 
	`ds_de°roy
(&
ds
);

146 
	}
}

155 
	$pﬁl_block
()

157 
pﬁlfd
 *
pﬁlfds
;

158 
size_t
 
max_pﬁlfds
;

160 
pﬁl_waôî
 *
pw
;

161 
li°
 *
node
;

162 
n_pﬁlfds
;

163 
ªtvÆ
;

165 
	`as£π
(!
ru¬ög_cb
);

166 i‡(
max_pﬁlfds
 < 
n_waôîs
) {

167 
max_pﬁlfds
 = 
n_waôîs
;

168 
pﬁlfds
 = 
	`xªÆloc
’ﬁlfds, 
max_pﬁlfds
 *  *pollfds);

171 
n_pﬁlfds
 = 0;

172 
	`LIST_FOR_EACH
 (
pw
, 
pﬁl_waôî
, 
node
, &
waôîs
) {

173 
pw
->
pﬁlfd
 = &
pﬁlfds
[
n_pﬁlfds
];

174 
pﬁlfds
[
n_pﬁlfds
].
fd
 = 
pw
->fd;

175 
pﬁlfds
[
n_pﬁlfds
].
evíts
 = 
pw
->events;

176 
pﬁlfds
[
n_pﬁlfds
].
ªvíts
 = 0;

177 
n_pﬁlfds
++;

180 
ªtvÆ
 = 
	`time_pﬁl
(
pﬁlfds
, 
n_pﬁlfds
, 
timeout
);

181 i‡(
ªtvÆ
 < 0) {

182 
vlog_øã_limô
 
æ
 = 
	`VLOG_RATE_LIMIT_INIT
(1, 5);

183 
	`VLOG_ERR_RL
(
LOG_MODULE
, &
æ
, "pﬁl: %s", 
	`°ªº‹
(-
ªtvÆ
));

184 } i‡(!
ªtvÆ
 && 
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

185 
	`log_wakeup
(&
timeout_backåa˚
, "%d-m†timeout", 
timeout
);

188 
node
 = 
waôîs
.
√xt
;Çode != &waiters; ) {

189 
pw
 = 
	`CONTAINER_OF
(
node
, 
pﬁl_waôî
,Çode);

190 i‡(!
pw
->
pﬁlfd
 || !pw->pﬁlfd->
ªvíts
) {

191 i‡(
pw
->
fun˘i⁄
) {

192 
node
 =Çode->
√xt
;

196 i‡(
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

197 
	`log_wakeup
(
pw
->
backåa˚
, "%s%s%s%s%s on fd %d",

198 
pw
->
pﬁlfd
->
ªvíts
 & 
POLLIN
 ? "[POLLIN]" : "",

199 
pw
->
pﬁlfd
->
ªvíts
 & 
POLLOUT
 ? "[POLLOUT]" : "",

200 
pw
->
pﬁlfd
->
ªvíts
 & 
POLLERR
 ? "[POLLERR]" : "",

201 
pw
->
pﬁlfd
->
ªvíts
 & 
POLLHUP
 ? "[POLLHUP]" : "",

202 
pw
->
pﬁlfd
->
ªvíts
 & 
POLLNVAL
 ? "[POLLNVAL]" : "",

203 
pw
->
fd
);

206 i‡(
pw
->
fun˘i⁄
) {

207 #i‚de‡
NDEBUG


208 
ru¬ög_cb
 = 
pw
;

210 
pw
->
	`fun˘i⁄
’w->
fd
,Öw->
pﬁlfd
->
ªvíts
,Öw->
aux
);

211 #i‚de‡
NDEBUG


212 
ru¬ög_cb
 = 
NULL
;

216 
node
 =Çode->
√xt
;

217 
	`pﬁl_ˇn˚l
(
pw
);

220 
timeout
 = -1;

221 
timeout_backåa˚
.
n_‰ames
 = 0;

222 
	}
}

232 
pﬁl_waôî
 *

233 
	$pﬁl_fd_ˇŒback
(
fd
, 
evíts
, 
pﬁl_fd_func
 *
fun˘i⁄
, *
aux
)

235 
pﬁl_waôî
 *
pw
 = 
	`√w_waôî
(
fd
, 
evíts
);

236 
pw
->
fun˘i⁄
 = function;

237 
pw
->
aux
 =áux;

238  
pw
;

239 
	}
}

254 
	$pﬁl_ˇn˚l
(
pﬁl_waôî
 *
pw
)

256 i‡(
pw
) {

257 
	`as£π
(
pw
 !
ru¬ög_cb
);

258 
	`li°_ªmove
(&
pw
->
node
);

259 
	`‰ì
(
pw
->
backåa˚
);

260 
	`‰ì
(
pw
);

261 
n_waôîs
--;

263 
	}
}

266 
pﬁl_waôî
 *

267 
	$√w_waôî
(
fd
, 
evíts
)

269 
pﬁl_waôî
 *
waôî
 = 
	`xˇŒoc
(1,  *waiter);

270 
	`as£π
(
fd
 >= 0);

271 
waôî
->
fd
 = fd;

272 
waôî
->
evíts
 =Évents;

273 i‡(
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

274 
waôî
->
backåa˚
 = 
	`xmÆloc
( *waiter->backtrace);

275 
	`backåa˚_ˇ±uª
(
waôî
->
backåa˚
);

277 
	`li°_push_back
(&
waôîs
, &
waôî
->
node
);

278 
n_waôîs
++;

279  
waôî
;

280 
	}
}

	@lib/poll-loop.h

49 #i‚de‡
POLL_LOOP_H


50 
	#POLL_LOOP_H
 1

	)

52 
	~<pﬁl.h
>

54 
	gpﬁl_waôî
;

57 
pﬁl_waôî
 *
pﬁl_fd_waô
(
fd
, 
evíts
);

58 
pﬁl_timî_waô
(
m£c
);

59 
pﬁl_immedüã_wake
();

62 
pﬁl_block
();

65 
	tpﬁl_fd_func
(
	tfd
, 
	tªvíts
, *
	taux
);

66 
pﬁl_waôî
 *
pﬁl_fd_ˇŒback
(
fd
, 
evíts
,

67 
pﬁl_fd_func
 *, *
aux
);

70 
pﬁl_ˇn˚l
(
pﬁl_waôî
 *);

	@lib/port-array.c

34 
	~<c⁄fig.h
>

35 
	~"p‹t-¨øy.h
"

36 
	~<°dlib.h
>

38 
p‹t_¨øy_l2
 
	gl2_£¡öñ
;

39 
p‹t_¨øy_l3
 
	gl3_£¡öñ
;

40 
boﬁ
 
	göôed
;

44 
	$p‹t_¨øy_öô
(
p‹t_¨øy
 *
∑
)

46 
size_t
 
i
;

47 i‡(!
öôed
) {

48 
öôed
 = 
åue
;

49 
i
 = 0; i < 
PORT_ARRAY_L2_SIZE
; i++) {

50 
l2_£¡öñ
.
l2
[
i
] = &
l3_£¡öñ
;

53 
i
 = 0; i < 
PORT_ARRAY_L1_SIZE
; i++) {

54 
∑
->
l1
[
i
] = &
l2_£¡öñ
;

56 
	}
}

61 
	$p‹t_¨øy_de°roy
(
p‹t_¨øy
 *
∑
)

63 
l1_idx
;

65 
l1_idx
 = 0;Ü1_idx < 
PORT_ARRAY_L1_SIZE
;Ü1_idx++) {

66 
p‹t_¨øy_l2
 *
l2
 = 
∑
->
l1
[
l1_idx
];

68 i‡(
l2
 !&
l2_£¡öñ
) {

69 
l2_idx
;

71 
l2_idx
 = 0;Ü2_idx < 
PORT_ARRAY_L2_SIZE
;Ü2_idx++) {

72 
p‹t_¨øy_l3
 *
l3
 = 
l2
->l2[
l2_idx
];

73 i‡(
l3
 !&
l3_£¡öñ
) {

74 
	`‰ì
(
l3
);

77 
	`‰ì
(
l2
);

80 
	}
}

84 
	$p‹t_¨øy_˛ór
(
p‹t_¨øy
 *
∑
)

86 
	`p‹t_¨øy_de°roy
(
∑
);

87 
	`p‹t_¨øy_öô
(
∑
);

88 
	}
}

92 
	$p‹t_¨øy_£t
(
p‹t_¨øy
 *
∑
, 
uöt16_t
 
idx
, *
p
)

94 
p‹t_¨øy_l2
 **
l2p
, *
l2
;

95 
p‹t_¨øy_l3
 **
l3p
, *
l3
;

98 
l2p
 = &
∑
->
l1
[
	`PORT_ARRAY_L1
(
idx
)];

99 i‡(*
l2p
 =&
l2_£¡öñ
) {

100 *
l2p
 = 
	`xmemdup
(&
l2_£¡öñ
, Ü2_sentinel);

102 
l2
 = *
l2p
;

105 
l3p
 = &
l2
->l2[
	`PORT_ARRAY_L2
(
idx
)];

106 i‡(*
l3p
 =&
l3_£¡öñ
) {

107 *
l3p
 = 
	`xmemdup
(&
l3_£¡öñ
, Ü3_sentinel);

109 
l3
 = *
l3p
;

112 
l3
->l3[
	`PORT_ARRAY_L3
(
idx
)] = 
p
;

113 
	}
}

116 
	$√xt
(c⁄° 
p‹t_¨øy
 *
∑
, *
idxp
)

118 
idx
 = *
idxp
;

123 
l1_idx
 = 
idx
 >> 
PORT_ARRAY_L1_SHIFT
;

124 
l2_idx
 = 
	`PORT_ARRAY_L2
(
idx
);

125 
l3_idx
 = 
	`PORT_ARRAY_L3
(
idx
);

126 
l1_idx
 < 
PORT_ARRAY_L1_SIZE
) {

127 
p‹t_¨øy_l2
 *
l2
 = 
∑
->
l1
[
l1_idx
];

128 i‡(
l2
 !&
l2_£¡öñ
) {

129 
l2_idx
 < 
PORT_ARRAY_L2_SIZE
) {

130 
p‹t_¨øy_l3
 *
l3
 = 
l2
->l2[
l2_idx
];

131 i‡(
l3
 !&
l3_£¡öñ
) {

132 
l3_idx
 < 
PORT_ARRAY_L3_SIZE
) {

133 *
p
 = 
l3
->l3[
l3_idx
];

134 i‡(
p
) {

135 *
idxp
 = ((
l1_idx
 << 
PORT_ARRAY_L1_SHIFT
)

136 | (
l2_idx
 << 
PORT_ARRAY_L2_SHIFT
)

137 | (
l3_idx
 << 
PORT_ARRAY_L3_SHIFT
));

138  
p
;

140 
l3_idx
++;

143 
l2_idx
++;

144 
l3_idx
 = 0;

147 
l1_idx
++;

148 
l2_idx
 = 0;

149 
l3_idx
 = 0;

151 *
idxp
 = 
PORT_ARRAY_SIZE
;

152  
NULL
;

153 
	}
}

159 
	$p‹t_¨øy_fú°
(c⁄° 
p‹t_¨øy
 *
∑
, *
idxp
)

161 *
idxp
 = 0;

162  
	`√xt
(
∑
, 
idxp
);

163 
	}
}

170 
	$p‹t_¨øy_√xt
(c⁄° 
p‹t_¨øy
 *
∑
, *
idxp
)

172 ++*
idxp
;

173  
	`√xt
(
∑
, 
idxp
);

174 
	}
}

	@lib/port-array.h

34 #i‚de‡
PORT_ARRAY_H


35 
	#PORT_ARRAY_H
 1

	)

37 
	~<as£π.h
>

38 
	~"›íÊow/›íÊow.h
"

39 
	~"utû.h
"

41 
ölöe
 
uöt16_t


42 
	$p‹t_¨øy_exåa˘_bôs__
(
uöt16_t
 
d©a
, 
°¨t
, 
cou¡
)

44  (
d©a
 >> 
°¨t
Ë& ((1u << 
cou¡
) - 1);

45 
	}
}

48 
	#PORT_ARRAY_L1_BITS
 5

	)

49 
	#PORT_ARRAY_L1_SHIFT
 (
PORT_ARRAY_L3_BITS
 + 
PORT_ARRAY_L2_BITS
)

	)

50 
	#PORT_ARRAY_L1_SIZE
 (1u << 
PORT_ARRAY_L1_BITS
)

	)

51 
	#PORT_ARRAY_L1
(
IDX
) \

52 
	`p‹t_¨øy_exåa˘_bôs__
(
IDX
, 
PORT_ARRAY_L1_SHIFT
, 
PORT_ARRAY_L1_BITS
)

	)

55 
	#PORT_ARRAY_L2_BITS
 5

	)

56 
	#PORT_ARRAY_L2_SHIFT
 
PORT_ARRAY_L3_BITS


	)

57 
	#PORT_ARRAY_L2_SIZE
 (1u << 
PORT_ARRAY_L2_BITS
)

	)

58 
	#PORT_ARRAY_L2
(
IDX
) \

59 
	`p‹t_¨øy_exåa˘_bôs__
(
IDX
, 
PORT_ARRAY_L2_SHIFT
, 
PORT_ARRAY_L2_BITS
)

	)

62 
	#PORT_ARRAY_L3_BITS
 6

	)

63 
	#PORT_ARRAY_L3_SHIFT
 0

	)

64 
	#PORT_ARRAY_L3_SIZE
 (1u << 
PORT_ARRAY_L3_BITS
)

	)

65 
	#PORT_ARRAY_L3
(
IDX
) \

66 
	`p‹t_¨øy_exåa˘_bôs__
(
IDX
, 
PORT_ARRAY_L3_SHIFT
, 
PORT_ARRAY_L3_BITS
)

	)

68 
	#PORT_ARRAY_SIZE
 (1u << (
PORT_ARRAY_L1_BITS
 \

69 + 
PORT_ARRAY_L2_BITS
 \

70 + 
PORT_ARRAY_L3_BITS
))

	)

72 
BUILD_ASSERT_DECL
(
PORT_ARRAY_SIZE
 > 0xffff);

77 
	sp‹t_¨øy
 {

78 
p‹t_¨øy_l2
 *
	ml1
[1u << 
PORT_ARRAY_L1_BITS
];

81 
	sp‹t_¨øy_l2
 {

82 
p‹t_¨øy_l3
 *
	ml2
[1u << 
PORT_ARRAY_L2_BITS
];

85 
	sp‹t_¨øy_l3
 {

86 *
	ml3
[1u << 
PORT_ARRAY_L3_BITS
];

91 
ölöe
 *

92 
	$p‹t_¨øy_gë
(c⁄° 
p‹t_¨øy
 *
∑
, 
uöt16_t
 
idx
)

94 
l1_idx
 = 
	`PORT_ARRAY_L1
(
idx
);

95 
l2_idx
 = 
	`PORT_ARRAY_L2
(
idx
);

96 
l3_idx
 = 
	`PORT_ARRAY_L3
(
idx
);

97  
∑
->
l1
[
l1_idx
]->
l2
[
l2_idx
]->
l3
[
l3_idx
];

98 
	}
}

100 
p‹t_¨øy_öô
(
p‹t_¨øy
 *);

101 
p‹t_¨øy_de°roy
(
p‹t_¨øy
 *);

102 
p‹t_¨øy_˛ór
(
p‹t_¨øy
 *);

103 
p‹t_¨øy_£t
(
p‹t_¨øy
 *, 
uöt16_t
 
idx
, *);

104 *
p‹t_¨øy_fú°
(c⁄° 
p‹t_¨øy
 *, *);

105 *
p‹t_¨øy_√xt
(c⁄° 
p‹t_¨øy
 *, *);

	@lib/process.c

34 
	~<c⁄fig.h
>

35 
	~"¥o˚ss.h
"

36 
	~<as£π.h
>

37 
	~<î∫o.h
>

38 
	~<f˙é.h
>

39 
	~<sig«l.h
>

40 
	~<°dlib.h
>

41 
	~<°rög.h
>

42 
	~<sys/°©.h
>

43 
	~<sys/waô.h
>

44 
	~<uni°d.h
>

45 
	~"dy«mic-°rög.h
"

46 
	~"li°.h
"

47 
	~"pﬁl-lo›.h
"

48 
	~"sockë-utû.h
"

49 
	~"utû.h
"

51 
	#LOG_MODULE
 
VLM_¥o˚ss


	)

52 
	~"vlog.h
"

54 
	s¥o˚ss
 {

55 
li°
 
	mnode
;

56 *
	m«me
;

57 
pid_t
 
	mpid
;

60 vﬁ©ûê
boﬁ
 
	mexôed
;

61 vﬁ©ûê
	m°©us
;

65 
	gfds
[2];

68 
li°
 
	gÆl_¥o˚s£s
 = 
LIST_INITIALIZER
(&
Æl_¥o˚s£s
);

70 
block_sigchld
(
sig£t_t
 *);

71 
unblock_sigchld
(c⁄° 
sig£t_t
 *);

72 
sigchld_h™dÀr
(
sigƒ
 
UNUSED
);

73 
boﬁ
 
is_membî
(
x
, c⁄° *
¨øy
, 
size_t
);

74 
boﬁ
 
föd_ö_∑th
(c⁄° *
«me
);

83 
	$¥o˚ss_öô
()

85 
boﬁ
 
öôed
;

86 
siga˘i⁄
 
ß
;

88 i‡(
öôed
) {

91 
öôed
 = 
åue
;

94 i‡(
	`pùe
(
fds
)) {

95 
	`oÂ_Áèl
(
î∫o
, "couldÇot createÖipe");

97 
	`£t_n⁄blockög
(
fds
[0]);

98 
	`£t_n⁄blockög
(
fds
[1]);

101 
	`mem£t
(&
ß
, 0,  sa);

102 
ß
.
ß_h™dÀr
 = 
sigchld_h™dÀr
;

103 
	`sigem±y£t
(&
ß
.
ß_mask
);

104 
ß
.
ß_Êags
 = 
SA_NOCLDSTOP
 | 
SA_RESTART
;

105 i‡(
	`siga˘i⁄
(
SIGCHLD
, &
ß
, 
NULL
)) {

106 
	`oÂ_Áèl
(
î∫o
, "sigaction(SIGCHLD) failed");

108 
	}
}

111 
	$¥o˚ss_esˇ≥_¨gs
(**
¨gv
)

113 
ds
 d†
DS_EMPTY_INITIALIZER
;

114 **
¨gp
;

115 
¨gp
 = 
¨gv
; *argp;árgp++) {

116 c⁄° *
¨g
 = *
¨gp
;

117 c⁄° *
p
;

118 i‡(
¨gp
 !
¨gv
) {

119 
	`ds_put_ch¨
(&
ds
, ' ');

121 i‡(
¨g
[
	`°rc•n
(arg, " \t\r\n\v\\")]) {

122 
	`ds_put_ch¨
(&
ds
, '"');

123 
p
 = 
¨g
; *p;Ö++) {

124 i‡(*
p
 == '\\' || *p == '\"') {

125 
	`ds_put_ch¨
(&
ds
, '\\');

127 
	`ds_put_ch¨
(&
ds
, *
p
);

129 
	`ds_put_ch¨
(&
ds
, '"');

131 
	`ds_put_c°r
(&
ds
, 
¨g
);

134  
	`ds_c°r
(&
ds
);

135 
	}
}

149 
	$¥o˚ss_°¨t
(**
¨gv
,

150 c⁄° 
kìp_fds
[], 
size_t
 
n_kìp_fds
,

151 c⁄° 
nuŒ_fds
[], 
size_t
 
n_nuŒ_fds
,

152 
¥o˚ss
 **
µ
)

154 
sig£t_t
 
ﬁdsigs
;

155 
pid_t
 
pid
;

157 *
µ
 = 
NULL
;

158 
	`¥o˚ss_öô
();

160 i‡(
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

161 *
¨gs
 = 
	`¥o˚ss_esˇ≥_¨gs
(
¨gv
);

162 
	`VLOG_DBG
(
LOG_MODULE
, "°¨tög sub¥o˚ss: %s", 
¨gs
);

163 
	`‰ì
(
¨gs
);

168 i‡(!
	`föd_ö_∑th
(
¨gv
[0])) {

169 
	`VLOG_ERR
(
LOG_MODULE
, "%†nŸ found i¿PATH", 
¨gv
[0]);

170  
ENOENT
;

173 
	`block_sigchld
(&
ﬁdsigs
);

174 
pid
 = 
	`f‹k
();

175 i‡(
pid
 < 0) {

176 
	`unblock_sigchld
(&
ﬁdsigs
);

177 
	`VLOG_WARN
(
LOG_MODULE
, "f‹k faûed: %s", 
	`°ªº‹
(
î∫o
));

178  
î∫o
;

179 } i‡(
pid
) {

181 
¥o˚ss
 *
p
;

182 c⁄° *
¶ash
;

184 
p
 = 
	`xˇŒoc
(1,  *p);

185 
p
->
pid
 =Öid;

186 
¶ash
 = 
	`°ºchr
(
¨gv
[0], '/');

187 
p
->
«me
 = 
	`x°rdup
(
¶ash
 ? sœsh + 1 : 
¨gv
[0]);

188 
p
->
exôed
 = 
Ál£
;

190 
	`li°_push_back
(&
Æl_¥o˚s£s
, &
p
->
node
);

191 
	`unblock_sigchld
(&
ﬁdsigs
);

193 *
µ
 = 
p
;

197 
fd_max
 = 
	`gë_max_fds
();

198 
fd
;

200 
	`unblock_sigchld
(&
ﬁdsigs
);

201 
fd
 = 0; fd < 
fd_max
; fd++) {

202 i‡(
	`is_membî
(
fd
, 
nuŒ_fds
, 
n_nuŒ_fds
)) {

203 
nuŒfd
 = 
	`›í
("/dev/nuŒ", 
O_RDWR
);

204 
	`dup2
(
nuŒfd
, 
fd
);

205 
	`˛o£
(
nuŒfd
);

206 } i‡(
fd
 >3 && !
	`is_membî
(fd, 
kìp_fds
, 
n_kìp_fds
)) {

207 
	`˛o£
(
fd
);

210 
	`execvp
(
¨gv
[0],árgv);

211 
	`Ârötf
(
°dîr
, "execvp(\"%s\") failed: %s\n",

212 
¨gv
[0], 
	`°ªº‹
(
î∫o
));

213 
	`_exô
(1);

215 
	}
}

219 
	$¥o˚ss_de°roy
(
¥o˚ss
 *
p
)

221 i‡(
p
) {

222 
sig£t_t
 
ﬁdsigs
;

224 
	`block_sigchld
(&
ﬁdsigs
);

225 
	`li°_ªmove
(&
p
->
node
);

226 
	`unblock_sigchld
(&
ﬁdsigs
);

228 
	`‰ì
(
p
->
«me
);

229 
	`‰ì
(
p
);

231 
	}
}

236 
	$¥o˚ss_kûl
(c⁄° 
¥o˚ss
 *
p
, 
sigƒ
)

238  (
p
->
exôed
 ? 
ESRCH


239 : !
	`kûl
(
p
->
pid
, 
sigƒ
) ? 0

240 : 
î∫o
);

241 
	}
}

244 
pid_t


245 
	$¥o˚ss_pid
(c⁄° 
¥o˚ss
 *
p
)

247  
p
->
pid
;

248 
	}
}

253 
	$¥o˚ss_«me
(c⁄° 
¥o˚ss
 *
p
)

255  
p
->
«me
;

256 
	}
}

259 
boﬁ


260 
	$¥o˚ss_exôed
(
¥o˚ss
 *
p
)

262 i‡(
p
->
exôed
) {

263  
åue
;

265 
buf
[
_POSIX_PIPE_BUF
];

266 
	`ªad
(
fds
[0], 
buf
,  buf);

267  
Ál£
;

269 
	}
}

275 
	$¥o˚ss_°©us
(c⁄° 
¥o˚ss
 *
p
)

277 
	`as£π
(
p
->
exôed
);

278  
p
->
°©us
;

279 
	}
}

282 
	$¥o˚ss_run
(**
¨gv
,

283 c⁄° 
kìp_fds
[], 
size_t
 
n_kìp_fds
,

284 c⁄° 
nuŒ_fds
[], 
size_t
 
n_nuŒ_fds
,

285 *
°©us
)

287 
¥o˚ss
 *
p
;

288 
ªtvÆ
;

290 
ªtvÆ
 = 
	`¥o˚ss_°¨t
(
¨gv
, 
kìp_fds
, 
n_kìp_fds
, 
nuŒ_fds
, 
n_nuŒ_fds
,

291 &
p
);

292 i‡(
ªtvÆ
) {

293 *
°©us
 = 0;

294  
ªtvÆ
;

297 !
	`¥o˚ss_exôed
(
p
)) {

298 
	`¥o˚ss_waô
(
p
);

299 
	`pﬁl_block
();

301 *
°©us
 = 
	`¥o˚ss_°©us
(
p
);

302 
	`¥o˚ss_de°roy
(
p
);

304 
	}
}

311 
	$¥o˚ss_°©us_msg
(
°©us
)

313 
ds
 d†
DS_EMPTY_INITIALIZER
;

314 i‡(
	`WIFEXITED
(
°©us
)) {

315 
	`ds_put_f‹m©
(&
ds
, "exô sètu†%d", 
	`WEXITSTATUS
(
°©us
));

316 } i‡(
	`WIFSIGNALED
(
°©us
Ë|| 
	`WIFSTOPPED
(status)) {

317 
sigƒ
 = 
	`WIFSIGNALED
(
°©us
Ë? 
	`WTERMSIG
(°©usË: 
	`WSTOPSIG
(status);

318 c⁄° *
«me
 = 
NULL
;

319 #ifde‡
HAVE_STRSIGNAL


320 
«me
 = 
	`°rsig«l
(
sigƒ
);

322 
	`ds_put_f‹m©
(&
ds
, "%s by signal %d",

323 
	`WIFSIGNALED
(
°©us
Ë? "kûÀd" : "°›≥d", 
sigƒ
);

324 i‡(
«me
) {

325 
	`ds_put_f‹m©
(&
ds
, " (%s)", 
«me
);

328 
	`ds_put_f‹m©
(&
ds
, "ãrmö©edábn‹mÆly (%x)", 
°©us
);

330 i‡(
	`WCOREDUMP
(
°©us
)) {

331 
	`ds_put_c°r
(&
ds
, ", core dumped");

333  
	`ds_c°r
(&
ds
);

334 
	}
}

339 
	$¥o˚ss_waô
(
¥o˚ss
 *
p
)

341 i‡(
p
->
exôed
) {

342 
	`pﬁl_immedüã_wake
();

344 
	`pﬁl_fd_waô
(
fds
[0], 
POLLIN
);

346 
	}
}

349 
	$sigchld_h™dÀr
(
sigƒ
 
UNUSED
)

351 
¥o˚ss
 *
p
;

353 
	`LIST_FOR_EACH
 (
p
, 
¥o˚ss
, 
node
, &
Æl_¥o˚s£s
) {

354 i‡(!
p
->
exôed
) {

355 
ªtvÆ
, 
°©us
;

357 
ªtvÆ
 = 
	`waôpid
(
p
->
pid
, &
°©us
, 
WNOHANG
);

358 } 
ªtvÆ
 =-1 && 
î∫o
 =
EINTR
);

359 i‡(
ªtvÆ
 =
p
->
pid
) {

360 
p
->
exôed
 = 
åue
;

361 
p
->
°©us
 = status;

362 } i‡(
ªtvÆ
 < 0) {

365 
p
->
exôed
 = 
åue
;

366 
p
->
°©us
 = -1;

370 
	`wrôe
(
fds
[1], "", 1);

371 
	}
}

373 
boﬁ


374 
	$is_membî
(
x
, c⁄° *
¨øy
, 
size_t
 
n
)

376 
size_t
 
i
;

378 
i
 = 0; i < 
n
; i++) {

379 i‡(
¨øy
[
i
] =
x
) {

380  
åue
;

383  
Ál£
;

384 
	}
}

387 
	$block_sigchld
(
sig£t_t
 *
ﬁdsigs
)

389 
sig£t_t
 
sigchld
;

390 
	`sigem±y£t
(&
sigchld
);

391 
	`sigadd£t
(&
sigchld
, 
SIGCHLD
);

392 i‡(
	`sig¥ocmask
(
SIG_BLOCK
, &
sigchld
, 
ﬁdsigs
)) {

393 
	`oÂ_Áèl
(
î∫o
, "sigprocmask");

395 
	}
}

398 
	$unblock_sigchld
(c⁄° 
sig£t_t
 *
ﬁdsigs
)

400 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, 
ﬁdsigs
, 
NULL
)) {

401 
	`oÂ_Áèl
(
î∫o
, "sigprocmask");

403 
	}
}

405 
boﬁ


406 
	$föd_ö_∑th
(c⁄° *
«me
)

408 *
ßve_±r
 = 
NULL
;

409 *
∑th
, *
dú
;

410 
°©
 
s
;

412 i‡(
	`°rchr
(
«me
, '/'Ë|| !
	`gëív
("PATH")) {

413  
	`°©
(
«me
, &
s
) == 0;

416 
∑th
 = 
	`x°rdup
(
	`gëív
("PATH"));

417 
dú
 = 
	`°πok_r
(
∑th
, ":", &
ßve_±r
); dir;

418 
dú
 = 
	`°πok_r
(
NULL
, ":", &
ßve_±r
)) {

419 *
fûe
 = 
	`xa•rötf
("%s/%s", 
dú
, 
«me
);

420 i‡(
	`°©
(
fûe
, &
s
) == 0) {

421 
	`‰ì
(
fûe
);

422 
	`‰ì
(
∑th
);

423  
åue
;

425 
	`‰ì
(
fûe
);

427 
	`‰ì
(
∑th
);

428  
Ál£
;

429 
	}
}

	@lib/process.h

34 #i‚de‡
PROCESS_H


35 
	#PROCESS_H
 1

	)

37 
	~<°dboﬁ.h
>

38 
	~<sys/ty≥s.h
>

40 
	g¥o˚ss
;

41 
¥o˚ss_öô
();

42 *
¥o˚ss_esˇ≥_¨gs
(**
¨gv
);

43 
¥o˚ss_°¨t
(**
¨gv
,

44 c⁄° *
kìp_fds
, 
size_t
 
n_kìp_fds
,

45 c⁄° *
nuŒ_fds
, 
size_t
 
n_nuŒ_fds
,

46 
¥o˚ss
 **);

47 
¥o˚ss_de°roy
(
¥o˚ss
 *);

48 
¥o˚ss_kûl
(c⁄° 
¥o˚ss
 *, 
sigƒ
);

50 
¥o˚ss_run
(**
¨gv
,

51 c⁄° *
kìp_fds
, 
size_t
 
n_kìp_fds
,

52 c⁄° *
nuŒ_fds
, 
size_t
 
n_nuŒ_fds
,

53 *
°©us
);

55 
pid_t
 
¥o˚ss_pid
(c⁄° 
¥o˚ss
 *);

56 c⁄° *
¥o˚ss_«me
(c⁄° 
¥o˚ss
 *);

57 
boﬁ
 
¥o˚ss_exôed
(
¥o˚ss
 *);

58 
¥o˚ss_°©us
(c⁄° 
¥o˚ss
 *);

59 *
¥o˚ss_°©us_msg
();

61 
¥o˚ss_waô
(
¥o˚ss
 *);

	@lib/queue.c

34 
	~<c⁄fig.h
>

35 
	~"queue.h
"

36 
	~<as£π.h
>

37 
	~"compûî.h
"

38 
	~"Àak-checkî.h
"

39 
	~"oÂbuf.h
"

41 
check_queue
(
oÂ_queue
 *
q
);

45 
	$queue_öô
(
oÂ_queue
 *
q
)

47 
q
->
n
 = 0;

48 
q
->
hód
 = 
NULL
;

49 
q
->
èû
 = 
NULL
;

50 
	}
}

54 
	$queue_de°roy
(
oÂ_queue
 *
q
)

56 
oÂbuf
 *
cur
, *
√xt
;

57 
cur
 = 
q
->
hód
; cu∏!
NULL
; cu∏
√xt
) {

58 
√xt
 = 
cur
->next;

59 
	`oÂbuf_dñëe
(
cur
);

61 
	}
}

65 
	$queue_˛ór
(
oÂ_queue
 *
q
)

67 
	`queue_de°roy
(
q
);

68 
	`queue_öô
(
q
);

69 
	}
}

78 
	$queue_adv™˚_hód
(
oÂ_queue
 *
q
, 
oÂbuf
 *
√xt
)

80 
	`as£π
(
q
->
n
);

81 
	`as£π
(
q
->
hód
);

82 
q
->
hód
 = 
√xt
;

83 i‡(
q
->
hód
 =
NULL
) {

84 
q
->
èû
 = 
NULL
;

86 
q
->
n
--;

87 
	}
}

91 
	$queue_push_èû
(
oÂ_queue
 *
q
, 
oÂbuf
 *
b
)

93 
	`check_queue
(
q
);

94 
	`Àak_checkî_˛aim
(
b
);

96 
b
->
√xt
 = 
NULL
;

97 i‡(
q
->
n
++) {

98 
q
->
èû
->
√xt
 = 
b
;

100 
q
->
hód
 = 
b
;

102 
q
->
èû
 = 
b
;

104 
	`check_queue
(
q
);

105 
	}
}

110 
oÂbuf
 *

111 
	$queue_p›_hód
(
oÂ_queue
 *
q
)

113 
oÂbuf
 *
hód
 = 
q
->head;

114 
	`queue_adv™˚_hód
(
q
, 
hód
->
√xt
);

115  
hód
;

116 
	}
}

120 
	$check_queue
(
oÂ_queue
 *
q
 
UNUSED
)

123 
oÂbuf
 *
ôî
;

124 
size_t
 
n
;

126 
	`as£π
(
q
->
n
 == 0

127 ? 
q
->
hód
 =
NULL
 && q->
èû
 == NULL

128 : 
q
->
hód
 !
NULL
 && q->
èû
 != NULL);

130 
n
 = 0;

131 
ôî
 = 
q
->
hód
; iã∏!
NULL
; iã∏ôî->
√xt
) {

132 
n
++;

133 
	`as£π
((
ôî
->
√xt
 !
NULL
Ë=(ôî !
q
->
èû
));

135 
	`as£π
(
n
 =
q
->n);

137 
	}
}

	@lib/queue.h

34 #i‚de‡
QUEUE_H


35 
	#QUEUE_H
 1

	)

38 
	soÂ_queue
 {

39 
	mn
;

40 
oÂbuf
 *
	mhód
;

41 
oÂbuf
 *
	mèû
;

44 
queue_öô
(
oÂ_queue
 *);

45 
queue_de°roy
(
oÂ_queue
 *);

46 
queue_˛ór
(
oÂ_queue
 *);

47 
queue_adv™˚_hód
(
oÂ_queue
 *, 
oÂbuf
 *
√xt
);

48 
queue_push_èû
(
oÂ_queue
 *, 
oÂbuf
 *);

49 
oÂbuf
 *
queue_p›_hód
(
oÂ_queue
 *);

	@lib/random.c

34 
	~<c⁄fig.h
>

35 
	~"øndom.h
"

37 
	~<î∫o.h
>

38 
	~<°dlib.h
>

39 
	~<sys/time.h
>

41 
	~"utû.h
"

44 
	$øndom_öô
()

46 
boﬁ
 
öôed
 = 
Ál£
;

47 i‡(!
öôed
) {

48 
timevÆ
 
tv
;

49 
öôed
 = 
åue
;

50 i‡(
	`gëtimeofday
(&
tv
, 
NULL
) < 0) {

51 
	`oÂ_Áèl
(
î∫o
, "gettimeofday");

53 
	`§™d
(
tv
.
tv_£c
 ^Åv.
tv_u£c
);

55 
	}
}

58 
	$øndom_byãs
(*
p_
, 
size_t
 
n
)

60 
uöt8_t
 *
p
 = 
p_
;

61 
	`øndom_öô
();

62 
n
--) {

63 *
p
++ = 
	`ønd
();

65 
	}
}

67 
uöt8_t


68 
	$øndom_uöt8
()

70 
	`øndom_öô
();

71  
	`ønd
();

72 
	}
}

74 
uöt16_t


75 
	$øndom_uöt16
()

77 i‡(
RAND_MAX
 >
UINT16_MAX
) {

78 
	`øndom_öô
();

79  
	`ønd
();

81 
uöt16_t
 
x
;

82 
	`øndom_byãs
(&
x
,  x);

83  
x
;

85 
	}
}

87 
uöt32_t


88 
	$øndom_uöt32
()

90 i‡(
RAND_MAX
 >
UINT32_MAX
) {

91 
	`øndom_öô
();

92  
	`ønd
();

93 } i‡(
RAND_MAX
 =
INT32_MAX
) {

94 
	`øndom_öô
();

95  
	`ønd
() | ((rand() & 1u) << 31);

97 
uöt32_t
 
x
;

98 
	`øndom_byãs
(&
x
,  x);

99  
x
;

101 
	}
}

104 
	$øndom_ønge
(
max
)

106  
	`øndom_uöt32
(Ë% 
max
;

107 
	}
}

	@lib/random.h

34 #i‚de‡
RANDOM_H


35 
	#RANDOM_H
 1

	)

37 
	~<°ddef.h
>

38 
	~<°döt.h
>

40 
øndom_öô
();

41 
øndom_byãs
(*, 
size_t
);

42 
uöt8_t
 
øndom_uöt8
();

43 
uöt16_t
 
øndom_uöt16
();

44 
uöt32_t
 
øndom_uöt32
();

45 
øndom_ønge
(
max
);

	@lib/rconn.c

34 
	~<c⁄fig.h
>

35 
	~"rc⁄n.h
"

36 
	~<as£π.h
>

37 
	~<î∫o.h
>

38 
	~<limôs.h
>

39 
	~<°dlib.h
>

40 
	~<°rög.h
>

41 
	~"oÂ.h
"

42 
	~"oÂbuf.h
"

43 
	~"›íÊow/›íÊow.h
"

44 
	~"pﬁl-lo›.h
"

45 
	~"ßt-m©h.h
"

46 
	~"timevÆ.h
"

47 
	~"utû.h
"

48 
	~"vc⁄n.h
"

49 
	~"vc⁄n-¥ovidî.h
"

51 
	#LOG_MODULE
 
VLM_rc⁄n


	)

52 
	~"vlog.h
"

54 
	#STATES
 \

55 
	`STATE
(
VOID
, 1 << 0) \

56 
	`STATE
(
BACKOFF
, 1 << 1) \

57 
	`STATE
(
CONNECTING
, 1 << 2) \

58 
	`STATE
(
ACTIVE
, 1 << 3) \

59 
	`STATE
(
IDLE
, 1 << 4)

	)

60 
	e°©e
 {

61 
	#STATE
(
NAME
, 
VALUE
Ë
S_
##NAME = VALUE,

	)

62 
	mSTATES


63 #unde‡
STATE


67 
	$°©e_«me
(
°©e
 state)

69 
°©e
) {

70 
	#STATE
(
NAME
, 
VALUE
Ë
S_
##NAME:  #NAME;

	)

71 
STATES


72 #unde‡
STATE


75 
	}
}

80 
	src⁄n
 {

81 
°©e
 
	m°©e
;

82 
time_t
 
	m°©e_íãªd
;

84 
vc⁄n
 *
	mvc⁄n
;

85 *
	m«me
;

86 
boﬁ
 
	mªlübÀ
;

88 
oÂ_queue
 
	mtxq
;

90 
	mbackoff
;

91 
	mmax_backoff
;

92 
time_t
 
	mbackoff_dódlöe
;

93 
time_t
 
	mœ°_ª˚ived
;

94 
time_t
 
	mœ°_c⁄√˘ed
;

95 
	m∑ckës_£¡
;

96 
	m£qno
;

106 
boﬁ
 
	m¥obably_admôãd
;

107 
time_t
 
	mœ°_admôãd
;

111 
	m∑ckës_ª˚ived
;

112 
	mn_©ãm±ed_c⁄√˘i⁄s
, 
	mn_suc˚ssful_c⁄√˘i⁄s
;

113 
time_t
 
	m¸óti⁄_time
;

114 
	mtŸÆ_time_c⁄√˘ed
;

123 
boﬁ
 
	mque°i⁄abÀ_c⁄√˘ivôy
;

124 
time_t
 
	mœ°_que°i⁄ed
;

130 
	m¥obe_öãrvÆ
;

133 
	#MAX_MONITORS
 8

	)

134 
vc⁄n
 *
	mm⁄ô‹s
[8];

135 
size_t
 
	mn_m⁄ô‹s
;

144 
uöt32_t
 
	midÀ_echo_xid
;

147 
ñ≠£d_ö_this_°©e
(c⁄° 
rc⁄n
 *);

148 
timeout
(c⁄° 
rc⁄n
 *);

149 
boﬁ
 
timed_out
(c⁄° 
rc⁄n
 *);

150 
°©e_å™sôi⁄
(
rc⁄n
 *, 
°©e
);

151 
åy_£nd
(
rc⁄n
 *);

152 
ªc⁄√˘
(
rc⁄n
 *);

153 
disc⁄√˘
(
rc⁄n
 *, 
îr‹
);

154 
Êush_queue
(
rc⁄n
 *);

155 
que°i⁄_c⁄√˘ivôy
(
rc⁄n
 *);

156 
c›y_to_m⁄ô‹
(
rc⁄n
 *, c⁄° 
oÂbuf
 *);

157 
boﬁ
 
is_c⁄√˘ed_°©e
(
°©e
);

158 
boﬁ
 
is_admôãd_msg
(c⁄° 
oÂbuf
 *);

161 
rc⁄n
 *

162 
	$rc⁄n_√w
(c⁄° *
«me
, 
öa˘ivôy_¥obe_öãrvÆ
, 
max_backoff
)

164 
rc⁄n
 *
rc
 = 
	`rc⁄n_¸óã
(
öa˘ivôy_¥obe_öãrvÆ
, 
max_backoff
);

165 
	`rc⁄n_c⁄√˘
(
rc
, 
«me
);

166  
rc
;

167 
	}
}

170 
rc⁄n
 *

171 
	$rc⁄n_√w_‰om_vc⁄n
(c⁄° *
«me
, 
vc⁄n
 *vconn)

173 
rc⁄n
 *
rc
 = 
	`rc⁄n_¸óã
(60, 0);

174 
	`rc⁄n_c⁄√˘_uƒñübly
(
rc
, 
«me
, 
vc⁄n
);

175  
rc
;

176 
	}
}

190 
rc⁄n
 *

191 
	$rc⁄n_¸óã
(
¥obe_öãrvÆ
, 
max_backoff
)

193 
rc⁄n
 *
rc
 = 
	`xˇŒoc
(1,  *rc);

195 
rc
->
°©e
 = 
S_VOID
;

196 
rc
->
°©e_íãªd
 = 
	`time_now
();

198 
rc
->
vc⁄n
 = 
NULL
;

199 
rc
->
«me
 = 
	`x°rdup
("void");

200 
rc
->
ªlübÀ
 = 
Ál£
;

202 
	`queue_öô
(&
rc
->
txq
);

204 
rc
->
backoff
 = 0;

205 
rc
->
max_backoff
 = max_backoff ? max_backoff : 60;

206 
rc
->
backoff_dódlöe
 = 
TIME_MIN
;

207 
rc
->
œ°_ª˚ived
 = 
	`time_now
();

208 
rc
->
œ°_c⁄√˘ed
 = 
	`time_now
();

209 
rc
->
£qno
 = 0;

211 
rc
->
∑ckës_£¡
 = 0;

213 
rc
->
¥obably_admôãd
 = 
Ál£
;

214 
rc
->
œ°_admôãd
 = 
	`time_now
();

216 
rc
->
∑ckës_ª˚ived
 = 0;

217 
rc
->
n_©ãm±ed_c⁄√˘i⁄s
 = 0;

218 
rc
->
n_suc˚ssful_c⁄√˘i⁄s
 = 0;

219 
rc
->
¸óti⁄_time
 = 
	`time_now
();

220 
rc
->
tŸÆ_time_c⁄√˘ed
 = 0;

222 
rc
->
que°i⁄abÀ_c⁄√˘ivôy
 = 
Ál£
;

223 
rc
->
œ°_que°i⁄ed
 = 
	`time_now
();

225 
rc
->
¥obe_öãrvÆ
 =Örobe_öãrvÆ ? 
	`MAX
(1,Örobe_interval) : 0;

227 
rc
->
n_m⁄ô‹s
 = 0;

235 
rc
->
idÀ_echo_xid
 = 0;

237  
rc
;

238 
	}
}

241 
	$rc⁄n_c⁄√˘
(
rc⁄n
 *
rc
, c⁄° *
«me
)

243 
	`rc⁄n_disc⁄√˘
(
rc
);

244 
	`‰ì
(
rc
->
«me
);

245 
rc
->
«me
 = 
	`x°rdup
(name);

246 
rc
->
ªlübÀ
 = 
åue
;

247  
	`ªc⁄√˘
(
rc
);

248 
	}
}

251 
	$rc⁄n_c⁄√˘_uƒñübly
(
rc⁄n
 *
rc
,

252 c⁄° *
«me
, 
vc⁄n
 *vconn)

254 
	`as£π
(
vc⁄n
 !
NULL
);

255 
	`rc⁄n_disc⁄√˘
(
rc
);

256 
	`‰ì
(
rc
->
«me
);

257 
rc
->
«me
 = 
	`x°rdup
(name);

258 
rc
->
ªlübÀ
 = 
Ál£
;

259 
rc
->
vc⁄n
 = vconn;

260 
rc
->
œ°_c⁄√˘ed
 = 
	`time_now
();

261 
	`°©e_å™sôi⁄
(
rc
, 
S_ACTIVE
);

262 
	}
}

265 
	$rc⁄n_disc⁄√˘
(
rc⁄n
 *
rc
)

267 i‡(
rc
->
°©e
 !
S_VOID
) {

268 i‡(
rc
->
vc⁄n
) {

269 
	`vc⁄n_˛o£
(
rc
->
vc⁄n
);

270 
rc
->
vc⁄n
 = 
NULL
;

272 
	`‰ì
(
rc
->
«me
);

273 
rc
->
«me
 = 
	`x°rdup
("void");

274 
rc
->
ªlübÀ
 = 
Ál£
;

276 
rc
->
backoff
 = 0;

277 
rc
->
backoff_dódlöe
 = 
TIME_MIN
;

279 
	`°©e_å™sôi⁄
(
rc
, 
S_VOID
);

281 
	}
}

285 
	$rc⁄n_de°roy
(
rc⁄n
 *
rc
)

287 i‡(
rc
) {

288 
size_t
 
i
;

290 
	`‰ì
(
rc
->
«me
);

291 
	`vc⁄n_˛o£
(
rc
->
vc⁄n
);

292 
	`Êush_queue
(
rc
);

293 
	`queue_de°roy
(&
rc
->
txq
);

294 
i
 = 0; i < 
rc
->
n_m⁄ô‹s
; i++) {

295 
	`vc⁄n_˛o£
(
rc
->
m⁄ô‹s
[
i
]);

297 
	`‰ì
(
rc
);

299 
	}
}

302 
	$timeout_VOID
(c⁄° 
rc⁄n
 *
rc
 
UNUSED
)

304  
UINT_MAX
;

305 
	}
}

308 
	$run_VOID
(
rc⁄n
 *
rc
 
UNUSED
)

311 
	}
}

314 
	$ªc⁄√˘
(
rc⁄n
 *
rc
)

316 
ªtvÆ
;

318 
	`VLOG_INFO
(
LOG_MODULE
, "%s: c⁄√˘ög...", 
rc
->
«me
);

319 
rc
->
n_©ãm±ed_c⁄√˘i⁄s
++;

320 
ªtvÆ
 = 
	`vc⁄n_›í
(
rc
->
«me
, 
OFP_VERSION
, &rc->
vc⁄n
);

321 i‡(!
ªtvÆ
) {

322 i‡(!
	`vc⁄n_is_ªc⁄√˘abÀ
(
rc
->
vc⁄n
)) {

323 
rc
->
ªlübÀ
 = 
Ál£
;

325 
rc
->
backoff_dódlöe
 = 
	`time_now
(Ë+Ñc->
backoff
;

326 
	`°©e_å™sôi⁄
(
rc
, 
S_CONNECTING
);

328 
	`VLOG_WARN
(
LOG_MODULE
, "%s: c⁄√˘i⁄ faûed (%s)", 
rc
->
«me
, 
	`°ªº‹
(
ªtvÆ
));

329 
rc
->
backoff_dódlöe
 = 
TIME_MAX
;

330 
	`disc⁄√˘
(
rc
, 0);

332  
ªtvÆ
;

333 
	}
}

336 
	$timeout_BACKOFF
(c⁄° 
rc⁄n
 *
rc
)

338  
rc
->
backoff
;

339 
	}
}

342 
	$run_BACKOFF
(
rc⁄n
 *
rc
)

344 i‡(
	`timed_out
(
rc
)) {

345 
	`ªc⁄√˘
(
rc
);

347 
	}
}

350 
	$timeout_CONNECTING
(c⁄° 
rc⁄n
 *
rc
)

352  
	`MAX
(1, 
rc
->
backoff
);

353 
	}
}

356 
	$run_CONNECTING
(
rc⁄n
 *
rc
)

358 
ªtvÆ
 = 
	`vc⁄n_c⁄√˘
(
rc
->
vc⁄n
);

359 i‡(!
ªtvÆ
) {

360 
	`VLOG_INFO
(
LOG_MODULE
, "%s: c⁄√˘ed", 
rc
->
«me
);

361 
rc
->
n_suc˚ssful_c⁄√˘i⁄s
++;

362 
	`°©e_å™sôi⁄
(
rc
, 
S_ACTIVE
);

363 
rc
->
œ°_c⁄√˘ed
 =Ñc->
°©e_íãªd
;

364 } i‡(
ªtvÆ
 !
EAGAIN
) {

365 
	`VLOG_INFO
(
LOG_MODULE
, "%s: c⁄√˘i⁄ faûed (%s)", 
rc
->
«me
, 
	`°ªº‹
(
ªtvÆ
));

366 
	`disc⁄√˘
(
rc
, 
ªtvÆ
);

367 } i‡(
	`timed_out
(
rc
)) {

368 
	`VLOG_INFO
(
LOG_MODULE
, "%s: c⁄√˘i⁄Åimed out", 
rc
->
«me
);

369 
rc
->
backoff_dódlöe
 = 
TIME_MAX
;

370 
	`disc⁄√˘
(
rc
, 0);

372 
	}
}

375 
	$do_tx_w‹k
(
rc⁄n
 *
rc
)

377 i‡(!
rc
->
txq
.
n
) {

380 
rc
->
txq
.
n
 > 0) {

381 
îr‹
 = 
	`åy_£nd
(
rc
);

382 i‡(
îr‹
) {

386 i‡(!
rc
->
txq
.
n
) {

387 
	`pﬁl_immedüã_wake
();

389 
	}
}

392 
	$timeout_ACTIVE
(c⁄° 
rc⁄n
 *
rc
)

394 i‡(
rc
->
¥obe_öãrvÆ
) {

395 
ba£
 = 
	`MAX
(
rc
->
œ°_ª˚ived
,Ñc->
°©e_íãªd
);

396 
¨g
 = 
ba£
 + 
rc
->
¥obe_öãrvÆ
 -Ñc->
°©e_íãªd
;

397  
¨g
;

399  
UINT_MAX
;

400 
	}
}

403 
	$run_ACTIVE
(
rc⁄n
 *
rc
)

405 i‡(
	`timed_out
(
rc
)) {

406 
ba£
 = 
	`MAX
(
rc
->
œ°_ª˚ived
,Ñc->
°©e_íãªd
);

407 
	`VLOG_DBG
(
LOG_MODULE
, "%s: idle %u seconds, sending inactivityÖrobe",

408 
rc
->
«me
, (Ë(
	`time_now
(Ë- 
ba£
));

413 
	`°©e_å™sôi⁄
(
rc
, 
S_IDLE
);

414 
	`rc⁄n_£nd
(
rc
, 
	`make_echo_ªque°
(), 
NULL
);

418 
	`do_tx_w‹k
(
rc
);

419 
	}
}

422 
	$timeout_IDLE
(c⁄° 
rc⁄n
 *
rc
)

424  
rc
->
¥obe_öãrvÆ
;

425 
	}
}

428 
	$run_IDLE
(
rc⁄n
 *
rc
)

430 i‡(
	`timed_out
(
rc
)) {

431 
	`que°i⁄_c⁄√˘ivôy
(
rc
);

432 
	`VLOG_ERR
(
LOG_MODULE
, "%s:ÇoÑesponseÅo inactivityÖrobeáfter %u "

434 
rc
->
«me
, 
	`ñ≠£d_ö_this_°©e
(rc));

435 
	`disc⁄√˘
(
rc
, 0);

437 
	`do_tx_w‹k
(
rc
);

439 
	}
}

445 
	$rc⁄n_run
(
rc⁄n
 *
rc
)

447 
ﬁd_°©e
;

449 
ﬁd_°©e
 = 
rc
->
°©e
;

450 
rc
->
°©e
) {

451 
	#STATE
(
NAME
, 
VALUE
Ë
S_
##NAME: 
run_
##
	`NAME
(
rc
); ;

	)

452 
STATES


453 #unde‡
STATE


455 
	`NOT_REACHED
();

457 } 
rc
->
°©e
 !
ﬁd_°©e
);

458 
	}
}

463 
	$rc⁄n_run_waô
(
rc⁄n
 *
rc
)

465 
timeo
 = 
	`timeout
(
rc
);

466 i‡(
timeo
 !
UINT_MAX
) {

467 
expúes
 = 
	`ßt_add
(
rc
->
°©e_íãªd
, 
timeo
);

468 
ªmaöög
 = 
	`ßt_sub
(
expúes
, 
	`time_now
());

469 
	`pﬁl_timî_waô
(
	`ßt_mul
(
ªmaöög
, 1000));

472 i‡((
rc
->
°©e
 & (
S_ACTIVE
 | 
S_IDLE
)Ë&&Ñc->
txq
.
n
) {

473 
	`vc⁄n_waô
(
rc
->
vc⁄n
, 
WAIT_SEND
);

475 
	}
}

480 
oÂbuf
 *

481 
	$rc⁄n_ªcv
(
rc⁄n
 *
rc
)

483 i‡(
rc
->
°©e
 & (
S_ACTIVE
 | 
S_IDLE
)) {

484 
oÂbuf
 *
buf„r
;

485 
îr‹
 = 
	`vc⁄n_ªcv
(
rc
->
vc⁄n
, &
buf„r
);

486 i‡(!
îr‹
) {

487 
oÂ_hódî
 *
h
 = 
buf„r
->
d©a
;

488 
	`c›y_to_m⁄ô‹
(
rc
, 
buf„r
);

489 i‡(
	`is_admôãd_msg
(
buf„r
)

490 || 
	`time_now
(Ë- 
rc
->
œ°_c⁄√˘ed
 >= 30) {

491 
rc
->
¥obably_admôãd
 = 
åue
;

492 
rc
->
œ°_admôãd
 = 
	`time_now
();

494 
rc
->
œ°_ª˚ived
 = 
	`time_now
();

495 
rc
->
∑ckës_ª˚ived
++;

498 i‡(
rc
->
°©e
 =
S_IDLE
) {

500 i‡(
h
->
ty≥
 =
OFPT_ECHO_REPLY
) {

501 i‡(
rc
->
idÀ_echo_xid
 == 0) {

502 
	`°©e_å™sôi⁄
(
rc
, 
S_ACTIVE
);

504 i‡(
rc
->
idÀ_echo_xid
 =
h
->
xid
)

505 
	`°©e_å™sôi⁄
(
rc
, 
S_ACTIVE
);

506 
rc
->
idÀ_echo_xid
 = 0;

509 
	`°©e_å™sôi⁄
(
rc
, 
S_ACTIVE
);

512  
buf„r
;

513 } i‡(
îr‹
 !
EAGAIN
) {

514 
	`disc⁄√˘
(
rc
, 
îr‹
);

517  
NULL
;

518 
	}
}

523 
	$rc⁄n_ªcv_waô
(
rc⁄n
 *
rc
)

525 i‡(
rc
->
vc⁄n
) {

526 
	`vc⁄n_waô
(
rc
->
vc⁄n
, 
WAIT_RECV
);

528 
	}
}

544 
	$rc⁄n_£nd
(
rc⁄n
 *
rc
, 
oÂbuf
 *
b
, *
n_queued
)

546 i‡(
	`rc⁄n_is_c⁄√˘ed
(
rc
)) {

547 
	`c›y_to_m⁄ô‹
(
rc
, 
b
);

548 
b
->
¥iv©e_p
 = 
n_queued
;

549 i‡(
n_queued
) {

550 ++*
n_queued
;

552 
	`queue_push_èû
(&
rc
->
txq
, 
b
);

558 i‡(
rc
->
txq
.
n
 == 1) {

559 
	`åy_£nd
(
rc
);

563  
ENOTCONN
;

565 
	}
}

580 
	$rc⁄n_£nd_wôh_limô
(
rc⁄n
 *
rc
, 
oÂbuf
 *
b
,

581 *
n_queued
, 
queue_limô
)

583 
ªtvÆ
;

584 
ªtvÆ
 = *
n_queued
 >
queue_limô
 ? 
EAGAIN
 : 
	`rc⁄n_£nd
(
rc
, 
b
,Ç_queued);

585 i‡(
ªtvÆ
) {

586 
	`oÂbuf_dñëe
(
b
);

588  
ªtvÆ
;

589 
	}
}

595 
	$rc⁄n_∑ckës_£¡
(c⁄° 
rc⁄n
 *
rc
)

597  
rc
->
∑ckës_£¡
;

598 
	}
}

603 
	$rc⁄n_add_m⁄ô‹
(
rc⁄n
 *
rc
, 
vc⁄n
 *vconn)

605 i‡(
rc
->
n_m⁄ô‹s
 < 
	`ARRAY_SIZE
‘c->
m⁄ô‹s
)) {

606 
	`VLOG_INFO
(
LOG_MODULE
, "√w m⁄ô‹ c⁄√˘i⁄ from %s", 
	`vc⁄n_gë_«me
(
vc⁄n
));

607 
rc
->
m⁄ô‹s
[rc->
n_m⁄ô‹s
++] = 
vc⁄n
;

609 
	`VLOG_DBG
(
LOG_MODULE
, "too many monitor connections, discarding %s",

610 
	`vc⁄n_gë_«me
(
vc⁄n
));

611 
	`vc⁄n_˛o£
(
vc⁄n
);

613 
	}
}

617 
	$rc⁄n_gë_«me
(c⁄° 
rc⁄n
 *
rc
)

619  
rc
->
«me
;

620 
	}
}

624 
boﬁ


625 
	$rc⁄n_is_Æive
(c⁄° 
rc⁄n
 *rconn)

627  
rc⁄n
->
°©e
 !
S_VOID
;

628 
	}
}

631 
boﬁ


632 
	$rc⁄n_is_c⁄√˘ed
(c⁄° 
rc⁄n
 *rconn)

634  
	`is_c⁄√˘ed_°©e
(
rc⁄n
->
°©e
);

635 
	}
}

643 
	$rc⁄n_Áûuª_duøti⁄
(c⁄° 
rc⁄n
 *rconn)

645  
	`rc⁄n_is_c⁄√˘ed
(
rc⁄n
Ë? 0 : 
	`time_now
(Ë-Ñc⁄n->
œ°_admôãd
;

646 
	}
}

650 
uöt32_t


651 
	$rc⁄n_gë_ù
(c⁄° 
rc⁄n
 *rconn)

653  
rc⁄n
->
vc⁄n
 ? 
	`vc⁄n_gë_ù
(rconn->vconn) : 0;

654 
	}
}

664 
boﬁ


665 
	$rc⁄n_is_c⁄√˘ivôy_que°i⁄abÀ
(
rc⁄n
 *rconn)

667 
boﬁ
 
que°i⁄abÀ
 = 
rc⁄n
->
que°i⁄abÀ_c⁄√˘ivôy
;

668 
rc⁄n
->
que°i⁄abÀ_c⁄√˘ivôy
 = 
Ál£
;

669  
que°i⁄abÀ
;

670 
	}
}

675 
	$rc⁄n_∑ckës_ª˚ived
(c⁄° 
rc⁄n
 *
rc
)

677  
rc
->
∑ckës_ª˚ived
;

678 
	}
}

683 
	$rc⁄n_gë_°©e
(c⁄° 
rc⁄n
 *
rc
)

685  
	`°©e_«me
(
rc
->
°©e
);

686 
	}
}

691 
	$rc⁄n_gë_©ãm±ed_c⁄√˘i⁄s
(c⁄° 
rc⁄n
 *
rc
)

693  
rc
->
n_©ãm±ed_c⁄√˘i⁄s
;

694 
	}
}

698 
	$rc⁄n_gë_suc˚ssful_c⁄√˘i⁄s
(c⁄° 
rc⁄n
 *
rc
)

700  
rc
->
n_suc˚ssful_c⁄√˘i⁄s
;

701 
	}
}

705 
time_t


706 
	$rc⁄n_gë_œ°_c⁄√˘i⁄
(c⁄° 
rc⁄n
 *
rc
)

708  
rc
->
œ°_c⁄√˘ed
;

709 
	}
}

712 
time_t


713 
	$rc⁄n_gë_¸óti⁄_time
(c⁄° 
rc⁄n
 *
rc
)

715  
rc
->
¸óti⁄_time
;

716 
	}
}

720 
	$rc⁄n_gë_tŸÆ_time_c⁄√˘ed
(c⁄° 
rc⁄n
 *
rc
)

722  (
rc
->
tŸÆ_time_c⁄√˘ed


723 + (
	`rc⁄n_is_c⁄√˘ed
(
rc
Ë? 
	`ñ≠£d_ö_this_°©e
(rc) : 0));

724 
	}
}

729 
	$rc⁄n_gë_backoff
(c⁄° 
rc⁄n
 *
rc
)

731  
rc
->
backoff
;

732 
	}
}

736 
	$rc⁄n_gë_°©e_ñ≠£d
(c⁄° 
rc⁄n
 *
rc
)

738  
	`ñ≠£d_ö_this_°©e
(
rc
);

739 
	}
}

744 
	$rc⁄n_gë_c⁄√˘i⁄_£qno
(c⁄° 
rc⁄n
 *
rc
)

746  
rc
->
£qno
;

747 
	}
}

788 
	$åy_£nd
(
rc⁄n
 *
rc
)

790 
ªtvÆ
 = 0;

791 
oÂbuf
 *
√xt
 = 
rc
->
txq
.
hód
->next;

792 
oÂ_hódî
 *
h
 = 
rc
->
txq
.
hód
->
d©a
;

793 *
n_queued
 = 
rc
->
txq
.
hód
->
¥iv©e_p
;

796 
rc
->
idÀ_echo_xid
 = 
h
->
xid
;

797 
ªtvÆ
 = 
	`vc⁄n_£nd
(
rc
->
vc⁄n
,Ñc->
txq
.
hód
);

798 i‡(
ªtvÆ
) {

799 
rc
->
idÀ_echo_xid
 = 0;

800 i‡(
ªtvÆ
 !
EAGAIN
) {

801 
	`disc⁄√˘
(
rc
, 
ªtvÆ
);

803  
ªtvÆ
;

805 
rc
->
∑ckës_£¡
++;

806 i‡(
n_queued
) {

807 --*
n_queued
;

809 
	`queue_adv™˚_hód
(&
rc
->
txq
, 
√xt
);

811 
	}
}

817 
	$disc⁄√˘
(
rc⁄n
 *
rc
, 
îr‹
)

819 i‡(
rc
->
ªlübÀ
) {

820 
time_t
 
now
 = 
	`time_now
();

822 i‡(
rc
->
°©e
 & (
S_CONNECTING
 | 
S_ACTIVE
 | 
S_IDLE
)) {

823 i‡(
îr‹
 > 0) {

824 
	`VLOG_WARN
(
LOG_MODULE
, "%s: connection dropped (%s)",

825 
rc
->
«me
, 
	`°ªº‹
(
îr‹
));

826 } i‡(
îr‹
 =
EOF
) {

827 i‡(
rc
->
ªlübÀ
) {

828 
	`VLOG_INFO
(
LOG_MODULE
, "%s: c⁄√˘i⁄ clo£d byÖìr", 
rc
->
«me
);

831 
	`VLOG_INFO
(
LOG_MODULE
, "%s: c⁄√˘i⁄ dr›≥d", 
rc
->
«me
);

833 
	`vc⁄n_˛o£
(
rc
->
vc⁄n
);

834 
rc
->
vc⁄n
 = 
NULL
;

835 
	`Êush_queue
(
rc
);

838 i‡(
now
 >
rc
->
backoff_dódlöe
) {

839 
rc
->
backoff
 = 1;

841 
rc
->
backoff
 = 
	`MIN
‘c->
max_backoff
, 
	`MAX
(1, 2 *Ñc->backoff));

842 
	`VLOG_INFO
(
LOG_MODULE
, "%s: waiting %d seconds beforeÑeconnect",

843 
rc
->
«me
,Ñc->
backoff
);

845 
rc
->
backoff_dódlöe
 = 
now
 +Ñc->
backoff
;

846 
	`°©e_å™sôi⁄
(
rc
, 
S_BACKOFF
);

847 i‡(
now
 - 
rc
->
œ°_c⁄√˘ed
 > 60) {

848 
	`que°i⁄_c⁄√˘ivôy
(
rc
);

851 
	`rc⁄n_disc⁄√˘
(
rc
);

853 
	}
}

858 
	$Êush_queue
(
rc⁄n
 *
rc
)

860 i‡(!
rc
->
txq
.
n
) {

863 
rc
->
txq
.
n
 > 0) {

864 
oÂbuf
 *
b
 = 
	`queue_p›_hód
(&
rc
->
txq
);

865 *
n_queued
 = 
b
->
¥iv©e_p
;

866 i‡(
n_queued
) {

867 --*
n_queued
;

869 
	`oÂbuf_dñëe
(
b
);

871 
	`pﬁl_immedüã_wake
();

872 
	}
}

875 
	$ñ≠£d_ö_this_°©e
(c⁄° 
rc⁄n
 *
rc
)

877  
	`time_now
(Ë- 
rc
->
°©e_íãªd
;

878 
	}
}

881 
	$timeout
(c⁄° 
rc⁄n
 *
rc
)

883 
rc
->
°©e
) {

884 
	#STATE
(
NAME
, 
VALUE
Ë
S_
##NAME:  
timeout_
##
	`NAME
(
rc
);

	)

885 
STATES


886 #unde‡
STATE


888 
	`NOT_REACHED
();

890 
	}
}

892 
boﬁ


893 
	$timed_out
(c⁄° 
rc⁄n
 *
rc
)

895  
	`time_now
(Ë>
	`ßt_add
(
rc
->
°©e_íãªd
, 
	`timeout
(rc));

896 
	}
}

899 
	$°©e_å™sôi⁄
(
rc⁄n
 *
rc
, 
°©e
 state)

901 
rc
->
£qno
 +‘c->
°©e
 =
S_ACTIVE
) != (state == S_ACTIVE);

902 i‡(
	`is_c⁄√˘ed_°©e
(
°©e
Ë&& !is_c⁄√˘ed_°©e(
rc
->state)) {

903 
rc
->
¥obably_admôãd
 = 
Ál£
;

905 i‡(
	`rc⁄n_is_c⁄√˘ed
(
rc
)) {

906 
rc
->
tŸÆ_time_c⁄√˘ed
 +
	`ñ≠£d_ö_this_°©e
(rc);

908 
	`VLOG_DBG
(
LOG_MODULE
, "%s:É¡îög %s", 
rc
->
«me
, 
	`°©e_«me
(
°©e
));

909 
rc
->
°©e
 = state;

910 
rc
->
°©e_íãªd
 = 
	`time_now
();

911 
	}
}

914 
	$que°i⁄_c⁄√˘ivôy
(
rc⁄n
 *
rc
)

916 
time_t
 
now
 = 
	`time_now
();

917 i‡(
now
 - 
rc
->
œ°_que°i⁄ed
 > 60) {

918 
rc
->
que°i⁄abÀ_c⁄√˘ivôy
 = 
åue
;

919 
rc
->
œ°_que°i⁄ed
 = 
now
;

921 
	}
}

924 
	$c›y_to_m⁄ô‹
(
rc⁄n
 *
rc
, c⁄° 
oÂbuf
 *
b
)

926 
oÂbuf
 *
˛⁄e
 = 
NULL
;

927 
ªtvÆ
;

928 
size_t
 
i
;

930 
i
 = 0; i < 
rc
->
n_m⁄ô‹s
; ) {

931 
vc⁄n
 *vc⁄¿
rc
->
m⁄ô‹s
[
i
];

933 i‡(!
˛⁄e
) {

934 
˛⁄e
 = 
	`oÂbuf_˛⁄e
(
b
);

936 
ªtvÆ
 = 
	`vc⁄n_£nd
(
vc⁄n
, 
˛⁄e
);

937 i‡(!
ªtvÆ
) {

938 
˛⁄e
 = 
NULL
;

939 } i‡(
ªtvÆ
 !
EAGAIN
) {

940 
	`VLOG_DBG
(
LOG_MODULE
, "%s: closing monitor connectionÅo %s: %s",

941 
	`rc⁄n_gë_«me
(
rc
), 
	`vc⁄n_gë_«me
(
vc⁄n
),

942 
	`°ªº‹
(
ªtvÆ
));

943 
rc
->
m⁄ô‹s
[
i
] =Ñc->m⁄ô‹s[--rc->
n_m⁄ô‹s
];

946 
i
++;

948 
	`oÂbuf_dñëe
(
˛⁄e
);

949 
	}
}

951 
boﬁ


952 
	$is_c⁄√˘ed_°©e
(
°©e
 state)

954  (
°©e
 & (
S_ACTIVE
 | 
S_IDLE
)) != 0;

955 
	}
}

957 
boﬁ


958 
	$is_admôãd_msg
(c⁄° 
oÂbuf
 *
b
)

960 
oÂ_hódî
 *
oh
 = 
b
->
d©a
;

962 
oh
->
ty≥
) {

963 
OFPT_HELLO
 :

964 
OFPT_ECHO_REQUEST
 :

965 
OFPT_ECHO_REPLY
 :

966 
OFPT_EXPERIMENTER
 :

967 
OFPT_FEATURES_REQUEST
 :

968 
OFPT_GET_CONFIG_REQUEST
 :

969 
OFPT_SET_CONFIG
 :

970 
OFPT_FLOW_REMOVED
 :

971 
OFPT_PACKET_OUT
 :

972 
OFPT_FLOW_MOD
 :

973 
OFPT_GROUP_MOD
 :

974 
OFPT_PORT_MOD
 :

975 
OFPT_TABLE_MOD
 :

976 
OFPT_MULTIPART_REQUEST
 :

977 
OFPT_BARRIER_REQUEST
 :

978 
OFPT_QUEUE_GET_CONFIG_REQUEST
 : {

979  
åue
;

982  
Ál£
;

985 
	}
}

	@lib/rconn.h

34 #i‚de‡
RCONN_H


35 
	#RCONN_H
 1

	)

37 
	~"queue.h
"

38 
	~<°dboﬁ.h
>

39 
	~<°döt.h
>

40 
	~<time.h
>

54 
	gvc⁄n
;

58 
rc⁄n
 *
rc⁄n_√w
(c⁄° *
«me
,

59 
öa˘ivôy_¥obe_öãrvÆ
, 
max_backoff
);

60 
rc⁄n
 *
rc⁄n_√w_‰om_vc⁄n
(c⁄° *
«me
, 
vc⁄n
 *);

61 
rc⁄n
 *
rc⁄n_¸óã
(
öa˘ivôy_¥obe_öãrvÆ
, 
max_backoff
);

62 
rc⁄n_c⁄√˘
(
rc⁄n
 *, c⁄° *
«me
);

63 
rc⁄n_c⁄√˘_uƒñübly
(
rc⁄n
 *,

64 c⁄° *
«me
, 
vc⁄n
 *vconn);

65 
rc⁄n_disc⁄√˘
(
rc⁄n
 *);

66 
rc⁄n_de°roy
(
rc⁄n
 *);

68 
rc⁄n_run
(
rc⁄n
 *);

69 
rc⁄n_run_waô
(
rc⁄n
 *);

70 
oÂbuf
 *
rc⁄n_ªcv
(
rc⁄n
 *);

71 
rc⁄n_ªcv_waô
(
rc⁄n
 *);

72 
rc⁄n_£nd
(
rc⁄n
 *, 
oÂbuf
 *, *
n_queued
);

73 
rc⁄n_£nd_wôh_limô
(
rc⁄n
 *, 
oÂbuf
 *,

74 *
n_queued
, 
queue_limô
);

75 
rc⁄n_∑ckës_£¡
(c⁄° 
rc⁄n
 *);

76 
rc⁄n_∑ckës_ª˚ived
(c⁄° 
rc⁄n
 *);

78 
rc⁄n_add_m⁄ô‹
(
rc⁄n
 *, 
vc⁄n
 *);

80 c⁄° *
rc⁄n_gë_«me
(c⁄° 
rc⁄n
 *);

81 
boﬁ
 
rc⁄n_is_Æive
(c⁄° 
rc⁄n
 *);

82 
boﬁ
 
rc⁄n_is_c⁄√˘ed
(c⁄° 
rc⁄n
 *);

83 
rc⁄n_Áûuª_duøti⁄
(c⁄° 
rc⁄n
 *);

84 
boﬁ
 
rc⁄n_is_c⁄√˘ivôy_que°i⁄abÀ
(
rc⁄n
 *);

86 
uöt32_t
 
rc⁄n_gë_ù
(c⁄° 
rc⁄n
 *);

88 c⁄° *
rc⁄n_gë_°©e
(c⁄° 
rc⁄n
 *);

89 
rc⁄n_gë_©ãm±ed_c⁄√˘i⁄s
(c⁄° 
rc⁄n
 *);

90 
rc⁄n_gë_suc˚ssful_c⁄√˘i⁄s
(c⁄° 
rc⁄n
 *);

91 
time_t
 
rc⁄n_gë_œ°_c⁄√˘i⁄
(c⁄° 
rc⁄n
 *);

92 
time_t
 
rc⁄n_gë_¸óti⁄_time
(c⁄° 
rc⁄n
 *);

93 
rc⁄n_gë_tŸÆ_time_c⁄√˘ed
(c⁄° 
rc⁄n
 *);

94 
rc⁄n_gë_backoff
(c⁄° 
rc⁄n
 *);

95 
rc⁄n_gë_°©e_ñ≠£d
(c⁄° 
rc⁄n
 *);

96 
rc⁄n_gë_c⁄√˘i⁄_£qno
(c⁄° 
rc⁄n
 *);

	@lib/sat-math.h

34 #i‚de‡
SAT_MATH_H


35 
	#SAT_MATH_H
 1

	)

37 
	~<as£π.h
>

38 
	~<limôs.h
>

41 
ölöe
 

42 
	$ßt_add
(
x
, 
y
)

44  
x
 + 
y
 >x ? x + y : 
UINT_MAX
;

45 
	}
}

48 
ölöe
 

49 
	$ßt_sub
(
x
, 
y
)

51  
x
 >
y
 ? x - y : 0;

52 
	}
}

55 
ölöe
 

56 
	$ßt_mul
(
x
, 
y
)

58  (!
y
 ? 0

59 : 
x
 <
UINT_MAX
 / 
y
 ? x * y

60 : 
UINT_MAX
);

61 
	}
}

	@lib/shash.c

34 
	~<c⁄fig.h
>

35 
	~"shash.h
"

36 
	~<as£π.h
>

37 
	~"hash.h
"

39 
size_t


40 
	$hash_«me
(c⁄° *
«me
)

42  
	`hash_byãs
(
«me
, 
	`°æí
(name), 0);

43 
	}
}

46 
	$shash_öô
(
shash
 *
sh
)

48 
	`hm≠_öô
(&
sh
->
m≠
);

49 
	}
}

52 
	$shash_de°roy
(
shash
 *
sh
)

54 i‡(
sh
) {

55 
	`shash_˛ór
(
sh
);

56 
	`‰ì
(
sh
);

58 
	}
}

61 
	$shash_˛ór
(
shash
 *
sh
)

63 
shash_node
 *
node
, *
√xt
;

65 
	`HMAP_FOR_EACH_SAFE
 (
node
, 
√xt
, 
shash_node
,Çode, &
sh
->
m≠
) {

66 
	`hm≠_ªmove
(&
sh
->
m≠
, &
node
->node);

67 
	`‰ì
(
node
->
«me
);

68 
	`‰ì
(
node
);

70 
	}
}

75 
	$shash_add
(
shash
 *
sh
, c⁄° *
«me
, *
d©a
)

77 
shash_node
 *
node
 = 
	`xmÆloc
( *node);

78 
node
->
«me
 = 
	`x°rdup
(name);

79 
node
->
d©a
 = data;

80 
	`hm≠_ö£π
(&
sh
->
m≠
, &
node
->node, 
	`hash_«me
(
«me
));

81 
	}
}

84 
	$shash_dñëe
(
shash
 *
sh
, 
shash_node
 *
node
)

86 
	`hm≠_ªmove
(&
sh
->
m≠
, &
node
->node);

87 
	`‰ì
(
node
->
«me
);

88 
	`‰ì
(
node
);

89 
	}
}

92 
shash_node
 *

93 
	$shash_föd
(c⁄° 
shash
 *
sh
, c⁄° *
«me
)

95 
shash_node
 *
node
;

97 
	`HMAP_FOR_EACH_WITH_HASH
 (
node
, 
shash_node
,Çode,

98 
	`hash_«me
(
«me
), &
sh
->
m≠
) {

99 i‡(!
	`°rcmp
(
node
->
«me
,Çame)) {

100  
node
;

103  
NULL
;

104 
	}
}

107 
	$shash_föd_d©a
(c⁄° 
shash
 *
sh
, c⁄° *
«me
)

109 
shash_node
 *
node
 = 
	`shash_föd
(
sh
, 
«me
);

110  
node
 ?Çode->
d©a
 : 
NULL
;

111 
	}
}

	@lib/shash.h

34 #i‚de‡
SHASH_H


35 
	#SHASH_H
 1

	)

37 
	~"hm≠.h
"

39 
	sshash_node
 {

40 
hm≠_node
 
	mnode
;

41 *
	m«me
;

42 *
	md©a
;

45 
	sshash
 {

46 
hm≠
 
	mm≠
;

49 
	#SHASH_INITIALIZER
(
SHASH
Ë{ 
	`HMAP_INITIALIZER
(&(SHASH)->
m≠
Ë}

	)

51 
shash_öô
(
shash
 *);

52 
shash_de°roy
(
shash
 *);

53 
shash_˛ór
(
shash
 *);

54 
shash_add
(
shash
 *, const *, *);

55 
shash_dñëe
(
shash
 *, 
shash_node
 *);

56 
shash_node
 *
shash_föd
(c⁄° 
shash
 *, const *);

57 *
shash_föd_d©a
(c⁄° 
shash
 *, const *);

	@lib/signals.c

34 
	~<c⁄fig.h
>

35 
	~"sig«ls.h
"

36 
	~<as£π.h
>

37 
	~<î∫o.h
>

38 
	~<limôs.h
>

39 
	~<sig«l.h
>

40 
	~<uni°d.h
>

41 
	~"pﬁl-lo›.h
"

42 
	~"sockë-utû.h
"

43 
	~"utû.h
"

45 #i‡
deföed
(
_NSIG
)

46 
	#N_SIGNALS
 
_NSIG


	)

47 #ñi‡
deföed
(
NSIG
)

48 
	#N_SIGNALS
 
NSIG


	)

52 
	#N_SIGNALS
 32

	)

55 
	ssig«l
 {

56 
	msigƒ
;

59 vﬁ©ûê
sig_©omic_t
 
	gsig«Àd
[
N_SIGNALS
];

61 
	gfds
[2];

63 
sig«l_h™dÀr
(
sigƒ
);

72 
	$sig«l_öô
()

74 
boﬁ
 
öôed
;

75 i‡(!
öôed
) {

76 
öôed
 = 
åue
;

77 i‡(
	`pùe
(
fds
)) {

78 
	`oÂ_Áèl
(
î∫o
, "couldÇot createÖipe");

80 
	`£t_n⁄blockög
(
fds
[0]);

81 
	`£t_n⁄blockög
(
fds
[1]);

83 
	}
}

88 
sig«l
 *

89 
	$sig«l_ªgi°î
(
sigƒ
)

91 
siga˘i⁄
 
ß
;

92 
sig«l
 *
s
;

94 
	`sig«l_öô
();

97 
	`as£π
(
sigƒ
 >1 && sigƒ < 
N_SIGNALS
);

98 
	`mem£t
(&
ß
, 0,  sa);

99 
ß
.
ß_h™dÀr
 = 
sig«l_h™dÀr
;

100 
	`sigem±y£t
(&
ß
.
ß_mask
);

101 
ß
.
ß_Êags
 = 
SA_RESTART
;

102 i‡(
	`siga˘i⁄
(
sigƒ
, &
ß
, 
NULL
)) {

103 
	`oÂ_Áèl
(
î∫o
, "siga˘i⁄(%dËÁûed", 
sigƒ
);

107 
s
 = 
	`xmÆloc
( *s);

108 
s
->
sigƒ
 = signr;

109  
s
;

110 
	}
}

114 
boﬁ


115 
	$sig«l_pﬁl
(
sig«l
 *
s
)

117 
buf
[
_POSIX_PIPE_BUF
];

118 
	`ªad
(
fds
[0], 
buf
,  buf);

119 i‡(
sig«Àd
[
s
->
sigƒ
]) {

120 
sig«Àd
[
s
->
sigƒ
] = 0;

121  
åue
;

123  
Ál£
;

124 
	}
}

129 
	$sig«l_waô
(
sig«l
 *
s
)

131 i‡(
sig«Àd
[
s
->
sigƒ
]) {

132 
	`pﬁl_immedüã_wake
();

134 
	`pﬁl_fd_waô
(
fds
[0], 
POLLIN
);

136 
	}
}

139 
	$sig«l_h™dÀr
(
sigƒ
)

141 i‡(
sigƒ
 >1 && sigƒ < 
N_SIGNALS
) {

142 
	`wrôe
(
fds
[1], "", 1);

143 
sig«Àd
[
sigƒ
] = 
åue
;

145 
	}
}

	@lib/signals.h

34 #i‚de‡
SIGNALS_H


35 
	#SIGNALS_H
 1

	)

37 
	~<°dboﬁ.h
>

39 
sig«l_öô
();

40 
sig«l
 *
sig«l_ªgi°î
(
sigƒ
);

41 
boﬁ
 
sig«l_pﬁl
(
sig«l
 *);

42 
sig«l_waô
(
sig«l
 *);

	@lib/socket-util.c

34 
	~<c⁄fig.h
>

35 
	~"sockë-utû.h
"

36 
	~<¨∑/öë.h
>

37 
	~<î∫o.h
>

38 
	~<f˙é.h
>

39 
	~<√tdb.h
>

40 
	~<pﬁl.h
>

41 
	~<°ddef.h
>

42 
	~<°dio.h
>

43 
	~<°rög.h
>

44 
	~<sys/ªsour˚.h
>

45 
	~<sys/°©.h
>

46 
	~<sys/un.h
>

47 
	~<uni°d.h
>

48 
	~"Áèl-sig«l.h
"

49 
	~"utû.h
"

51 
	~"vlog.h
"

52 
	#LOG_MODULE
 
VLM_sockë_utû


	)

57 
	$£t_n⁄blockög
(
fd
)

59 
Êags
 = 
	`f˙é
(
fd
, 
F_GETFL
, 0);

60 i‡(
Êags
 != -1) {

61 i‡(
	`f˙é
(
fd
, 
F_SETFL
, 
Êags
 | 
O_NONBLOCK
) != -1) {

64 
	`VLOG_ERR
(
LOG_MODULE
, "f˙é(F_SETFLËÁûed: %s", 
	`°ªº‹
(
î∫o
));

65  
î∫o
;

68 
	`VLOG_ERR
(
LOG_MODULE
, "f˙é(F_GETFLËÁûed: %s", 
	`°ªº‹
(
î∫o
));

69  
î∫o
;

71 
	}
}

76 
	$£t_sockë_¥i‹ôy
(
fd
, 
¥i‹ôy
)

78 
¥io
 = 
¥i‹ôy
;

79  
	`£tsock›t
(
fd
, 
SOL_SOCKET
, 
SO_PRIORITY
, (*)&
¥io
, (prio));

80 
	}
}

84 
	$gë_max_fds
()

86 
max_fds
 = -1;

87 i‡(
max_fds
 < 0) {

88 
æimô
 
r
;

89 i‡(!
	`gëæimô
(
RLIMIT_NOFILE
, &
r
)

90 && 
r
.
æim_cur
 !
RLIM_INFINITY


91 && 
r
.
æim_cur
 !
RLIM_SAVED_MAX


92 && 
r
.
æim_cur
 !
RLIM_SAVED_CUR
) {

93 
max_fds
 = 
r
.
æim_cur
;

95 
	`VLOG_WARN
(
LOG_MODULE
, "failedÅo obtain fdÜimit, defaultingÅo 1024");

96 
max_fds
 = 1024;

99  
max_fds
;

100 
	}
}

106 
	$lookup_ù
(c⁄° *
ho°_«me
, 
ö_addr
 *
addr
)

108 i‡(!
	`öë_©⁄
(
ho°_«me
, 
addr
)) {

109 
ho°ít
 *
he
 = 
	`gëho°by«me
(
ho°_«me
);

110 i‡(
he
 =
NULL
) {

111 
vlog_øã_limô
 
æ
 = 
	`VLOG_RATE_LIMIT_INIT
(1, 5);

112 
	`VLOG_ERR_RL
(
LOG_MODULE
, &
æ
, "gëho°by«me(%s): %s", 
ho°_«me
,

113 (
h_î∫o
 =
HOST_NOT_FOUND
 ? "hostÇot found"

114 : 
h_î∫o
 =
TRY_AGAIN
 ? "tryágain"

115 : 
h_î∫o
 =
NO_RECOVERY
 ? "non-recoverableÉrror"

116 : 
h_î∫o
 =
NO_ADDRESS
 ? "noáddress"

118  
ENOENT
;

120 
addr
->
s_addr
 = *(
uöt32_t
 *Ë
he
->
h_addr
;

123 
	}
}

128 
	$gë_sockë_îr‹
(
fd
)

130 
îr‹
;

131 
sockÀn_t
 
Àn
 = (
îr‹
);

132 i‡(
	`gësock›t
(
fd
, 
SOL_SOCKET
, 
SO_ERROR
, &
îr‹
, &
Àn
) < 0) {

133 
vlog_øã_limô
 
æ
 = 
	`VLOG_RATE_LIMIT_INIT
(5, 10);

134 
îr‹
 = 
î∫o
;

135 
	`VLOG_ERR_RL
(
LOG_MODULE
, &
æ
, "gësock›t(SO_ERROR): %s", 
	`°ªº‹
(
îr‹
));

137  
îr‹
;

138 
	}
}

141 
	$check_c⁄√˘i⁄_com∂ëi⁄
(
fd
)

143 
pﬁlfd
 
pfd
;

144 
ªtvÆ
;

146 
pfd
.
fd
 = fd;

147 
pfd
.
evíts
 = 
POLLOUT
;

149 
ªtvÆ
 = 
	`pﬁl
(&
pfd
, 1, 0);

150 } 
ªtvÆ
 < 0 && 
î∫o
 =
EINTR
);

151 i‡(
ªtvÆ
 == 1) {

152  
	`gë_sockë_îr‹
(
fd
);

153 } i‡(
ªtvÆ
 < 0) {

154 
vlog_øã_limô
 
æ
 = 
	`VLOG_RATE_LIMIT_INIT
(5, 10);

155 
	`VLOG_ERR_RL
(
LOG_MODULE
, &
æ
, "pﬁl: %s", 
	`°ªº‹
(
î∫o
));

156  
î∫o
;

158  
EAGAIN
;

160 
	}
}

168 
	$døö_rcvbuf
(
fd
)

170 
sockÀn_t
 
rcvbuf_Àn
;

171 
size_t
 
rcvbuf
;

173 
rcvbuf_Àn
 =  
rcvbuf
;

174 i‡(
	`gësock›t
(
fd
, 
SOL_SOCKET
, 
SO_RCVBUF
, &
rcvbuf
, &
rcvbuf_Àn
) < 0) {

175 
vlog_øã_limô
 
æ
 = 
	`VLOG_RATE_LIMIT_INIT
(5, 10);

176 
	`VLOG_ERR_RL
(
LOG_MODULE
, &
æ
, "gësock›t(SO_RCVBUFËÁûed: %s", 
	`°ªº‹
(
î∫o
));

177  
î∫o
;

179 
rcvbuf
 > 0) {

188 #ifde‡
__löux__


189 
	#BUFFER_SIZE
 1

	)

191 
	#BUFFER_SIZE
 2048

	)

193 
buf„r
[
BUFFER_SIZE
];

194 
ssize_t
 
n_byãs
 = 
	`ªcv
(
fd
, 
buf„r
,  buffer,

195 
MSG_TRUNC
 | 
MSG_DONTWAIT
);

196 i‡(
n_byãs
 <0 ||Ç_byã†>
rcvbuf
) {

199 
rcvbuf
 -
n_byãs
;

202 
	}
}

208 
	$døö_fd
(
fd
, 
size_t
 
n_∑ckës
)

210 ; 
n_∑ckës
 > 0;Ç_packets--) {

215 
buf„r
[128];

216 i‡(
	`ªad
(
fd
, 
buf„r
,  buffer) <= 0) {

220 
	}
}

225 
	$make_sockaddr_un
(c⁄° *
«me
, 
sockaddr_un
* 
un
, 
sockÀn_t
 *
un_Àn
)

227 
un
->
sun_Ámûy
 = 
AF_UNIX
;

228 
	`°∫˝y
(
un
->
sun_∑th
, 
«me
,  un->sun_path);

229 
un
->
sun_∑th
[ un->sun_path - 1] = '\0';

230 *
un_Àn
 = (
	`off£tof
(
sockaddr_un
, 
sun_∑th
)

231 + 
	`°æí
 (
un
->
sun_∑th
) + 1);

232 
	}
}

242 
	$make_unix_sockë
(
°yÀ
, 
boﬁ
 
n⁄block
, boﬁ 
∑ss¸ed
 
UNUSED
,

243 c⁄° *
böd_∑th
, c⁄° *
c⁄√˘_∑th
)

245 
îr‹
;

246 
fd
;

248 
fd
 = 
	`sockë
(
PF_UNIX
, 
°yÀ
, 0);

249 i‡(
fd
 < 0) {

250  -
î∫o
;

257 i‡(
n⁄block
) {

258 
Êags
 = 
	`f˙é
(
fd
, 
F_GETFL
, 0);

259 i‡(
Êags
 == -1) {

260 
îr‹
;

262 i‡(
	`f˙é
(
fd
, 
F_SETFL
, 
Êags
 | 
O_NONBLOCK
) == -1) {

263 
îr‹
;

267 i‡(
böd_∑th
) {

268 
sockaddr_un
 
un
;

269 
sockÀn_t
 
un_Àn
;

270 
	`make_sockaddr_un
(
böd_∑th
, &
un
, &
un_Àn
);

271 i‡(
	`u∆ök
(
un
.
sun_∑th
Ë&& 
î∫o
 !
ENOENT
) {

272 
	`VLOG_WARN
(
LOG_MODULE
, "u∆ökög \"%s\": %s\n", 
un
.
sun_∑th
, 
	`°ªº‹
(
î∫o
));

274 
	`Áèl_sig«l_add_fûe_to_u∆ök
(
böd_∑th
);

275 i‡(
	`böd
(
fd
, (
sockaddr
*Ë&
un
, 
un_Àn
)

276 || 
	`fchmod
(
fd
, 
S_IRWXU
)) {

277 
îr‹
;

281 i‡(
c⁄√˘_∑th
) {

282 
sockaddr_un
 
un
;

283 
sockÀn_t
 
un_Àn
;

284 
	`make_sockaddr_un
(
c⁄√˘_∑th
, &
un
, &
un_Àn
);

285 i‡(
	`c⁄√˘
(
fd
, (
sockaddr
*Ë&
un
, 
un_Àn
)

286 && 
î∫o
 !
EINPROGRESS
) {

287 
îr‹
;

291 #ifde‡
SCM_CREDENTIALS


292 i‡(
∑ss¸ed
) {

293 
íabÀ
 = 1;

294 i‡(
	`£tsock›t
(
fd
, 
SOL_SOCKET
, 
SO_PASSCRED
, &
íabÀ
, (enable))) {

295 
îr‹
;

300  
fd
;

302 
îr‹
:

303 i‡(
böd_∑th
) {

304 
	`Áèl_sig«l_ªmove_fûe_to_u∆ök
(
böd_∑th
);

306 
îr‹
 = 
î∫o
;

307 
	`˛o£
(
fd
);

308  -
îr‹
;

309 
	}
}

312 
	$gë_unix_«me_Àn
(
sockÀn_t
 
sun_Àn
)

314  (
sun_Àn
 >
	`off£tof
(
sockaddr_un
, 
sun_∑th
)

315 ? 
sun_Àn
 - 
	`off£tof
(
sockaddr_un
, 
sun_∑th
)

317 
	}
}

	@lib/socket-util.h

34 #i‚de‡
SOCKET_UTIL_H


35 
	#SOCKET_UTIL_H
 1

	)

37 
	~<sys/ty≥s.h
>

38 
	~<√töë/ö.h
>

39 
	~<°dboﬁ.h
>

41 
£t_n⁄blockög
(
fd
);

42 
£t_sockë_¥i‹ôy
(
fd
, 
¥i‹ôy
);

43 
gë_max_fds
();

44 
lookup_ù
(c⁄° *
ho°_«me
, 
ö_addr
 *
addªss
);

45 
gë_sockë_îr‹
(
sock
);

46 
check_c⁄√˘i⁄_com∂ëi⁄
(
fd
);

47 
døö_rcvbuf
(
fd
);

48 
døö_fd
(
fd
, 
size_t
 
n_∑ckës
);

49 
make_unix_sockë
(
°yÀ
, 
boﬁ
 
n⁄block
, boﬁ 
∑ss¸ed
,

50 c⁄° *
böd_∑th
, c⁄° *
c⁄√˘_∑th
);

51 
gë_unix_«me_Àn
(
sockÀn_t
 
sun_Àn
);

	@lib/stp.c

37 
	~"°p.h
"

38 
	~<¨∑/öë.h
>

39 
	~<as£π.h
>

40 
	~<öây≥s.h
>

41 
	~<°dlib.h
>

42 
	~"oÂbuf.h
"

43 
	~"∑ckës.h
"

44 
	~"utû.h
"

45 
	~"xtoxŒ.h
"

47 
	~"vlog.h
"

48 
	#LOG_MODULE
 
VLM_°p


	)

51 c⁄° 
uöt8_t
 
	g°p_ëh_addr
[
ETH_ADDR_LEN
]

54 
	#STP_PROTOCOL_ID
 0x0000

	)

55 
	#STP_PROTOCOL_VERSION
 0x00

	)

56 
	#STP_TYPE_CONFIG
 0x00

	)

57 
	#STP_TYPE_TCN
 0x80

	)

59 
	s°p_bpdu_hódî
 {

60 
uöt16_t
 
	m¥Ÿocﬁ_id
;

61 
uöt8_t
 
	m¥Ÿocﬁ_vîsi⁄
;

62 
uöt8_t
 
	mbpdu_ty≥
;

63 } 
__©åibuã__
((
∑cked
));

64 
BUILD_ASSERT_DECL
((
°p_bpdu_hódî
) == 4);

66 
	e°p_c⁄fig_bpdu_Êags
 {

67 
	mSTP_CONFIG_TOPOLOGY_CHANGE_ACK
 = 0x80,

68 
	mSTP_CONFIG_TOPOLOGY_CHANGE
 = 0x01

71 
	s°p_c⁄fig_bpdu
 {

72 
°p_bpdu_hódî
 
	mhódî
;

73 
uöt8_t
 
	mÊags
;

74 
uöt64_t
 
	mroŸ_id
;

75 
uöt32_t
 
	mroŸ_∑th_co°
;

76 
uöt64_t
 
	mbridge_id
;

77 
uöt16_t
 
	mp‹t_id
;

78 
uöt16_t
 
	mmesßge_age
;

79 
uöt16_t
 
	mmax_age
;

80 
uöt16_t
 
	mhñlo_time
;

81 
uöt16_t
 
	mf‹w¨d_dñay
;

82 } 
__©åibuã__
((
∑cked
));

83 
BUILD_ASSERT_DECL
((
°p_c⁄fig_bpdu
) == 35);

85 
	s°p_t˙_bpdu
 {

86 
°p_bpdu_hódî
 
	mhódî
;

87 } 
__©åibuã__
((
∑cked
));

88 
BUILD_ASSERT_DECL
((
°p_t˙_bpdu
) == 4);

90 
	s°p_timî
 {

91 
boﬁ
 
	ma˘ive
;

92 
	mvÆue
;

95 
	s°p_p‹t
 {

96 
°p
 *
	m°p
;

97 
	mp‹t_id
;

98 
°p_°©e
 
	m°©e
;

99 
	m∑th_co°
;

100 
°p_idítifõr
 
	mdesig«ãd_roŸ
;

101 
	mdesig«ãd_co°
;

102 
°p_idítifõr
 
	mdesig«ãd_bridge
;

103 
	mdesig«ãd_p‹t
;

104 
boﬁ
 
	mt›ﬁogy_ch™ge_ack
;

105 
boﬁ
 
	mc⁄fig_≥ndög
;

106 
boﬁ
 
	mch™ge_dëe˘i⁄_íabÀd
;

108 
°p_timî
 
	mmesßge_age_timî
;

109 
°p_timî
 
	mf‹w¨d_dñay_timî
;

110 
°p_timî
 
	mhﬁd_timî
;

112 
boﬁ
 
	m°©e_ch™ged
;

115 
	s°p
 {

117 *
	m«me
;

118 
°p_idítifõr
 
	mbridge_id
;

119 
	mmax_age
;

120 
	mhñlo_time
;

121 
	mf‹w¨d_dñay
;

122 
	mbridge_max_age
;

123 
	mbridge_hñlo_time
;

124 
	mbridge_f‹w¨d_dñay
;

125 
	mrq_max_age
;

126 
	mrq_hñlo_time
;

127 
	mrq_f‹w¨d_dñay
;

128 
	mñ≠£d_ªmaödî
;

131 
°p_idítifõr
 
	mdesig«ãd_roŸ
;

132 
	mroŸ_∑th_co°
;

133 
°p_p‹t
 *
	mroŸ_p‹t
;

134 
boﬁ
 
	mt›ﬁogy_ch™ge_dëe˘ed
;

135 
boﬁ
 
	mt›ﬁogy_ch™ge
;

138 
°p_timî
 
	mhñlo_timî
;

139 
°p_timî
 
	mt˙_timî
;

140 
°p_timî
 
	mt›ﬁogy_ch™ge_timî
;

143 
°p_p‹t
 
	mp‹ts
[
STP_MAX_PORTS
];

146 
°p_p‹t
 *
	mfú°_ch™ged_p‹t
;

147 (*
	m£nd_bpdu
)(
oÂbuf
 *
	mbpdu
, 
	mp‹t_no
, *
	maux
);

148 *
	maux
;

151 
	#FOR_EACH_ENABLED_PORT
(
PORT
, 
STP
) \

152 (
PORT
Ë
	`°p_√xt_íabÀd_p‹t
((
STP
), (STP)->
p‹ts
); \

153 (
PORT
); \

154 (
PORT
Ë
	`°p_√xt_íabÀd_p‹t
((
STP
), (PORTË+ 1))

	)

155 
°p_p‹t
 *

156 
	$°p_√xt_íabÀd_p‹t
(c⁄° 
°p
 *°p, c⁄° 
°p_p‹t
 *
p‹t
)

158 ; 
p‹t
 < &
°p
->
p‹ts
[
	`ARRAY_SIZE
(stp->ports)];Öort++) {

159 i‡(
p‹t
->
°©e
 !
STP_DISABLED
) {

160  (
°p_p‹t
 *Ë
p‹t
;

163  
NULL
;

164 
	}
}

166 
	#MESSAGE_AGE_INCREMENT
 1

	)

168 
°p_å™smô_c⁄fig
(
°p_p‹t
 *);

169 
boﬁ
 
°p_su≥r£des_p‹t_öfo
(c⁄° 
°p_p‹t
 *,

170 c⁄° 
°p_c⁄fig_bpdu
 *);

171 
°p_ªc‹d_c⁄fig_öf‹m©i⁄
(
°p_p‹t
 *,

172 c⁄° 
°p_c⁄fig_bpdu
 *);

173 
°p_ªc‹d_c⁄fig_timeout_vÆues
(
°p
 *,

174 c⁄° 
°p_c⁄fig_bpdu
 *);

175 
boﬁ
 
°p_is_desig«ãd_p‹t
(c⁄° 
°p_p‹t
 *);

176 
°p_c⁄fig_bpdu_gíî©i⁄
(
°p
 *);

177 
°p_å™smô_t˙
(
°p
 *);

178 
°p_c⁄figuøti⁄_upd©e
(
°p
 *);

179 
boﬁ
 
°p_su≥r£des_roŸ
(c⁄° 
°p_p‹t
 *
roŸ
,

180 c⁄° 
°p_p‹t
 *);

181 
°p_roŸ_£À˘i⁄
(
°p
 *);

182 
°p_desig«ãd_p‹t_£À˘i⁄
(
°p
 *);

183 
°p_become_desig«ãd_p‹t
(
°p_p‹t
 *);

184 
°p_p‹t_°©e_£À˘i⁄
(
°p
 *);

185 
°p_make_f‹w¨dög
(
°p_p‹t
 *);

186 
°p_make_blockög
(
°p_p‹t
 *);

187 
°p_£t_p‹t_°©e
(
°p_p‹t
 *, 
°p_°©e
);

188 
°p_t›ﬁogy_ch™ge_dëe˘i⁄
(
°p
 *);

189 
°p_t›ﬁogy_ch™ge_acknowÀdged
(
°p
 *);

190 
°p_acknowÀdge_t›ﬁogy_ch™ge
(
°p_p‹t
 *);

191 
°p_ª˚ived_c⁄fig_bpdu
(
°p
 *, 
°p_p‹t
 *,

192 c⁄° 
°p_c⁄fig_bpdu
 *);

193 
°p_ª˚ived_t˙_bpdu
(
°p
 *, 
°p_p‹t
 *);

194 
°p_hñlo_timî_expúy
(
°p
 *);

195 
°p_mesßge_age_timî_expúy
(
°p_p‹t
 *);

196 
boﬁ
 
°p_is_desig«ãd_f‹_some_p‹t
(c⁄° 
°p
 *);

197 
°p_f‹w¨d_dñay_timî_expúy
(
°p_p‹t
 *);

198 
°p_t˙_timî_expúy
(
°p
 *);

199 
°p_t›ﬁogy_ch™ge_timî_expúy
(
°p
 *);

200 
°p_hﬁd_timî_expúy
(
°p_p‹t
 *);

201 
°p_öôülize_p‹t
(
°p_p‹t
 *, 
°p_°©e
);

202 
°p_become_roŸ_bridge
(
°p
 *);

203 
°p_upd©e_bridge_timîs
(
°p
 *);

205 
˛amp
(
x
, 
mö
, 
max
);

206 
ms_to_timî
(
ms
);

207 
ms_to_timî_ªmaödî
(
ms
);

208 
timî_to_ms
(
timî
);

209 
°p_°¨t_timî
(
°p_timî
 *, 
vÆue
);

210 
°p_°›_timî
(
°p_timî
 *);

211 
boﬁ
 
°p_timî_expúed
(
°p_timî
 *, 
ñ≠£d
, 
timeout
);

213 
°p_£nd_bpdu
(
°p_p‹t
 *, c⁄° *, 
size_t
);

226 
°p
 *

227 
°p_¸óã
(c⁄° *
«me
, 
°p_idítifõr
 
bridge_id
,

228 (*
£nd_bpdu
)(
oÂbuf
 *
bpdu
, 
p‹t_no
, *
aux
),

229 *
aux
)

231 
°p
 *stp;

232 
°p_p‹t
 *
p
;

234 
°p
 = 
	`xˇŒoc
(1,  *stp);

235 
°p
->
«me
 = 
	`x°rdup
(name);

236 
°p
->
bridge_id
 = bridge_id;

237 i‡(!(
°p
->
bridge_id
 >> 48)) {

238 
°p
->
bridge_id
 |(
uöt64_t
Ë
STP_DEFAULT_BRIDGE_PRIORITY
 << 48;

241 
°p
->
rq_max_age
 = 6000;

242 
°p
->
rq_hñlo_time
 = 2000;

243 
°p
->
rq_f‹w¨d_dñay
 = 4000;

244 
	`°p_upd©e_bridge_timîs
(
°p
);

245 
°p
->
max_age
 = sç->
bridge_max_age
;

246 
°p
->
hñlo_time
 = sç->
bridge_hñlo_time
;

247 
°p
->
f‹w¨d_dñay
 = sç->
bridge_f‹w¨d_dñay
;

249 
°p
->
desig«ãd_roŸ
 = sç->
bridge_id
;

250 
°p
->
roŸ_∑th_co°
 = 0;

251 
°p
->
roŸ_p‹t
 = 
NULL
;

252 
°p
->
t›ﬁogy_ch™ge_dëe˘ed
 = 
Ál£
;

253 
°p
->
t›ﬁogy_ch™ge
 = 
Ál£
;

255 
	`°p_°›_timî
(&
°p
->
t˙_timî
);

256 
	`°p_°›_timî
(&
°p
->
t›ﬁogy_ch™ge_timî
);

257 
	`°p_°¨t_timî
(&
°p
->
hñlo_timî
, 0);

259 
°p
->
£nd_bpdu
 = send_bpdu;

260 
°p
->
aux
 =áux;

262 
°p
->
fú°_ch™ged_p‹t
 = &°p->
p‹ts
[
	`ARRAY_SIZE
(stp->ports)];

263 
p
 = 
°p
->
p‹ts
;Ö < &°p->p‹ts[
	`ARRAY_SIZE
(stp->ports)];Ö++) {

264 
p
->
°p
 = stp;

265 
p
->
p‹t_id
 = (
	`°p_p‹t_no
’Ë+ 1Ë| (
STP_DEFAULT_PORT_PRIORITY
 << 8);

266 
p
->
∑th_co°
 = 19;

267 
	`°p_öôülize_p‹t
(
p
, 
STP_DISABLED
);

269  
°p
;

270 
	}
}

274 
	$°p_de°roy
(
°p
 *stp)

276 
	`‰ì
(
°p
);

277 
	}
}

281 
	$°p_tick
(
°p
 *°p, 
ms
)

283 
°p_p‹t
 *
p
;

284 
ñ≠£d
;

289 
ms
 = 
	`˛amp
(ms, 0, 
INT_MAX
 - 1000Ë+ 
°p
->
ñ≠£d_ªmaödî
;

290 
ñ≠£d
 = 
	`ms_to_timî
(
ms
);

291 
°p
->
ñ≠£d_ªmaödî
 = 
	`ms_to_timî_ªmaödî
(
ms
);

292 i‡(!
ñ≠£d
) {

296 i‡(
	`°p_timî_expúed
(&
°p
->
hñlo_timî
, 
ñ≠£d
, sç->
hñlo_time
)) {

297 
	`°p_hñlo_timî_expúy
(
°p
);

299 i‡(
	`°p_timî_expúed
(&
°p
->
t˙_timî
, 
ñ≠£d
, sç->
bridge_hñlo_time
)) {

300 
	`°p_t˙_timî_expúy
(
°p
);

302 i‡(
	`°p_timî_expúed
(&
°p
->
t›ﬁogy_ch™ge_timî
, 
ñ≠£d
,

303 
°p
->
max_age
 + sç->
f‹w¨d_dñay
)) {

304 
	`°p_t›ﬁogy_ch™ge_timî_expúy
(
°p
);

306 
	`FOR_EACH_ENABLED_PORT
 (
p
, 
°p
) {

307 i‡(
	`°p_timî_expúed
(&
p
->
mesßge_age_timî
, 
ñ≠£d
, 
°p
->
max_age
)) {

308 
	`°p_mesßge_age_timî_expúy
(
p
);

311 
	`FOR_EACH_ENABLED_PORT
 (
p
, 
°p
) {

312 i‡(
	`°p_timî_expúed
(&
p
->
f‹w¨d_dñay_timî
, 
ñ≠£d
,

313 
°p
->
f‹w¨d_dñay
)) {

314 
	`°p_f‹w¨d_dñay_timî_expúy
(
p
);

316 i‡(
	`°p_timî_expúed
(&
p
->
hﬁd_timî
, 
ñ≠£d
, 
	`ms_to_timî
(1000))) {

317 
	`°p_hﬁd_timî_expúy
(
p
);

320 
	}
}

323 
	$£t_bridge_id
(
°p
 *°p, 
°p_idítifõr
 
√w_bridge_id
)

325 i‡(
√w_bridge_id
 !
°p
->
bridge_id
) {

326 
boﬁ
 
roŸ
;

327 
°p_p‹t
 *
p
;

329 
roŸ
 = 
	`°p_is_roŸ_bridge
(
°p
);

330 
	`FOR_EACH_ENABLED_PORT
 (
p
, 
°p
) {

331 i‡(
	`°p_is_desig«ãd_p‹t
(
p
)) {

332 
p
->
desig«ãd_bridge
 = 
√w_bridge_id
;

335 
°p
->
bridge_id
 = 
√w_bridge_id
;

336 
	`°p_c⁄figuøti⁄_upd©e
(
°p
);

337 
	`°p_p‹t_°©e_£À˘i⁄
(
°p
);

338 i‡(
	`°p_is_roŸ_bridge
(
°p
Ë&& !
roŸ
) {

339 
	`°p_become_roŸ_bridge
(
°p
);

342 
	}
}

345 
	$°p_£t_bridge_id
(
°p
 *°p, 
°p_idítifõr
 
bridge_id
)

347 c⁄° 
uöt64_t
 
mac_bôs
 = (
	`UINT64_C
(1) << 48) - 1;

348 c⁄° 
uöt64_t
 
¥i_bôs
 = ~
mac_bôs
;

349 
	`£t_bridge_id
(
°p
, (°p->
bridge_id
 & 
¥i_bôs
Ë| (bridge_id & 
mac_bôs
));

350 
	}
}

353 
	$°p_£t_bridge_¥i‹ôy
(
°p
 *°p, 
uöt16_t
 
√w_¥i‹ôy
)

355 c⁄° 
uöt64_t
 
mac_bôs
 = (
	`UINT64_C
(1) << 48) - 1;

356 
	`£t_bridge_id
(
°p
, ((°p->
bridge_id
 & 
mac_bôs
)

357 | ((
uöt64_t
Ë
√w_¥i‹ôy
 << 48)));

358 
	}
}

365 
	$°p_£t_hñlo_time
(
°p
 *°p, 
ms
)

367 
°p
->
rq_hñlo_time
 = 
ms
;

368 
	`°p_upd©e_bridge_timîs
(
°p
);

369 
	}
}

377 
	$°p_£t_max_age
(
°p
 *°p, 
ms
)

379 
°p
->
rq_max_age
 = 
ms
;

380 
	`°p_upd©e_bridge_timîs
(
°p
);

381 
	}
}

388 
	$°p_£t_f‹w¨d_dñay
(
°p
 *°p, 
ms
)

390 
°p
->
rq_f‹w¨d_dñay
 = 
ms
;

391 
	`°p_upd©e_bridge_timîs
(
°p
);

392 
	}
}

396 
	$°p_gë_«me
(c⁄° 
°p
 *stp)

398  
°p
->
«me
;

399 
	}
}

402 
°p_idítifõr


403 
	$°p_gë_bridge_id
(c⁄° 
°p
 *stp)

405  
°p
->
bridge_id
;

406 
	}
}

409 
°p_idítifõr


410 
	$°p_gë_desig«ãd_roŸ
(c⁄° 
°p
 *stp)

412  
°p
->
desig«ãd_roŸ
;

413 
	}
}

417 
boﬁ


418 
	$°p_is_roŸ_bridge
(c⁄° 
°p
 *stp)

420  
°p
->
bridge_id
 =°p->
desig«ãd_roŸ
;

421 
	}
}

425 
	$°p_gë_roŸ_∑th_co°
(c⁄° 
°p
 *stp)

427  
°p
->
roŸ_∑th_co°
;

428 
	}
}

434 
	$°p_gë_hñlo_time
(c⁄° 
°p
 *stp)

436  
	`timî_to_ms
(
°p
->
bridge_hñlo_time
);

437 
	}
}

444 
	$°p_gë_max_age
(c⁄° 
°p
 *stp)

446  
	`timî_to_ms
(
°p
->
bridge_max_age
);

447 
	}
}

454 
	$°p_gë_f‹w¨d_dñay
(c⁄° 
°p
 *stp)

456  
	`timî_to_ms
(
°p
->
bridge_f‹w¨d_dñay
);

457 
	}
}

461 
°p_p‹t
 *

462 
	$°p_gë_p‹t
(
°p
 *°p, 
p‹t_no
)

464 
	`as£π
(
p‹t_no
 >0 &&Ö‹t_nÿ< 
	`ARRAY_SIZE
(
°p
->
p‹ts
));

465  &
°p
->
p‹ts
[
p‹t_no
];

466 
	}
}

470 
°p_p‹t
 *

471 
	$°p_gë_roŸ_p‹t
(
°p
 *stp)

473  
°p
->
roŸ_p‹t
;

474 
	}
}

479 
boﬁ


480 
	$°p_gë_ch™ged_p‹t
(
°p
 *°p, 
°p_p‹t
 **
p‹ç
)

482 
°p_p‹t
 *
íd
 = &
°p
->
p‹ts
[
	`ARRAY_SIZE
(stp->ports)];

483 
°p_p‹t
 *
p
;

485 
p
 = 
°p
->
fú°_ch™ged_p‹t
;Ö < 
íd
;Ö++) {

486 i‡(
p
->
°©e_ch™ged
) {

487 
p
->
°©e_ch™ged
 = 
Ál£
;

488 
°p
->
fú°_ch™ged_p‹t
 = 
p
 + 1;

489 *
p‹ç
 = 
p
;

490  
åue
;

493 
°p
->
fú°_ch™ged_p‹t
 = 
íd
;

494 *
p‹ç
 = 
NULL
;

495  
Ál£
;

496 
	}
}

501 
	$°p_°©e_«me
(
°p_°©e
 
°©e
)

503 
°©e
) {

504 
STP_DISABLED
:

506 
STP_LISTENING
:

508 
STP_LEARNING
:

510 
STP_FORWARDING
:

512 
STP_BLOCKING
:

515 
	`NOT_REACHED
();

517 
	}
}

524 
boﬁ


525 
	$°p_f‹w¨d_ö_°©e
(
°p_°©e
 
°©e
)

527  (
°©e
 & (
STP_DISABLED
 | 
STP_FORWARDING
)) != 0;

528 
	}
}

535 
boﬁ


536 
	$°p_À¨n_ö_°©e
(
°p_°©e
 
°©e
)

538  (
°©e
 & (
STP_DISABLED
 | 
STP_LEARNING
 | 
STP_FORWARDING
)) != 0;

539 
	}
}

546 
	$°p_ª˚ived_bpdu
(
°p_p‹t
 *
p
, c⁄° *
bpdu
, 
size_t
 
bpdu_size
)

548 
°p
 *°∞
p
->stp;

549 c⁄° 
°p_bpdu_hódî
 *
hódî
;

551 i‡(
p
->
°©e
 =
STP_DISABLED
) {

555 i‡(
bpdu_size
 < (
°p_bpdu_hódî
)) {

556 
	`VLOG_WARN
(
LOG_MODULE
, "%s:Ñe˚ivedÑu¡ %zu-byã BPDU", 
°p
->
«me
, 
bpdu_size
);

560 
hódî
 = 
bpdu
;

561 i‡(
hódî
->
¥Ÿocﬁ_id
 !
	`ht⁄s
(
STP_PROTOCOL_ID
)) {

562 
	`VLOG_WARN
(
LOG_MODULE
, "%s:Ñe˚ived BPDU wôh u√x≥˘edÖrŸocﬁ ID %"
PRIu16
,

563 
°p
->
«me
, 
	`¡ohs
(
hódî
->
¥Ÿocﬁ_id
));

566 i‡(
hódî
->
¥Ÿocﬁ_vîsi⁄
 !
STP_PROTOCOL_VERSION
) {

567 
	`VLOG_DBG
(
LOG_MODULE
, "%s:Ñe˚ived BPDU wôh u√x≥˘edÖrŸocﬁ vîsi⁄ %"
PRIu8
,

568 
°p
->
«me
, 
hódî
->
¥Ÿocﬁ_vîsi⁄
);

571 
hódî
->
bpdu_ty≥
) {

572 
STP_TYPE_CONFIG
:

573 i‡(
bpdu_size
 < (
°p_c⁄fig_bpdu
)) {

574 
	`VLOG_WARN
(
LOG_MODULE
, "%s:Ñeceived config BPDU with invalid size %zu",

575 
°p
->
«me
, 
bpdu_size
);

578 
	`°p_ª˚ived_c⁄fig_bpdu
(
°p
, 
p
, 
bpdu
);

581 
STP_TYPE_TCN
:

582 i‡(
bpdu_size
 !(
°p_t˙_bpdu
)) {

583 
	`VLOG_WARN
(
LOG_MODULE
, "%s:Ñeceived TCN BPDU with invalid size %zu",

584 
°p
->
«me
, 
bpdu_size
);

587 
	`°p_ª˚ived_t˙_bpdu
(
°p
, 
p
);

591 
	`VLOG_WARN
(
LOG_MODULE
, "%s:Ñe˚ived BPDU o‡u√x≥˘edÅy≥ %"
PRIu8
,

592 
°p
->
«me
, 
hódî
->
bpdu_ty≥
);

595 
	}
}

598 
°p
 *

599 
	$°p_p‹t_gë_°p
(
°p_p‹t
 *
p
)

601  
p
->
°p
;

602 
	}
}

606 
	$°p_p‹t_no
(c⁄° 
°p_p‹t
 *
p
)

608 
°p
 *°∞
p
->stp;

609 
	`as£π
(
p
 >
°p
->
p‹ts
 &&Ö < &°p->p‹ts[
	`ARRAY_SIZE
(stp->ports)]);

610  
p
 - 
°p
->
p‹ts
;

611 
	}
}

614 
°p_°©e


615 
	$°p_p‹t_gë_°©e
(c⁄° 
°p_p‹t
 *
p
)

617  
p
->
°©e
;

618 
	}
}

622 
	$°p_p‹t_dißbÀ
(
°p_p‹t
 *
p
)

624 
°p
 *°∞
p
->stp;

625 i‡(
p
->
°©e
 !
STP_DISABLED
) {

626 
boﬁ
 
roŸ
 = 
	`°p_is_roŸ_bridge
(
°p
);

627 
	`°p_become_desig«ãd_p‹t
(
p
);

628 
	`°p_£t_p‹t_°©e
(
p
, 
STP_DISABLED
);

629 
p
->
t›ﬁogy_ch™ge_ack
 = 
Ál£
;

630 
p
->
c⁄fig_≥ndög
 = 
Ál£
;

631 
	`°p_°›_timî
(&
p
->
mesßge_age_timî
);

632 
	`°p_°›_timî
(&
p
->
f‹w¨d_dñay_timî
);

633 
	`°p_c⁄figuøti⁄_upd©e
(
°p
);

634 
	`°p_p‹t_°©e_£À˘i⁄
(
°p
);

635 i‡(
	`°p_is_roŸ_bridge
(
°p
Ë&& !
roŸ
) {

636 
	`°p_become_roŸ_bridge
(
°p
);

639 
	}
}

643 
	$°p_p‹t_íabÀ
(
°p_p‹t
 *
p
)

645 i‡(
p
->
°©e
 =
STP_DISABLED
) {

646 
	`°p_öôülize_p‹t
(
p
, 
STP_BLOCKING
);

647 
	`°p_p‹t_°©e_£À˘i⁄
(
p
->
°p
);

649 
	}
}

654 
	$°p_p‹t_£t_¥i‹ôy
(
°p_p‹t
 *
p
, 
uöt8_t
 
√w_¥i‹ôy
)

656 
uöt16_t
 
√w_p‹t_id
 = (
p
->
p‹t_id
 & 0xffË| (
√w_¥i‹ôy
 << 8);

657 i‡(
p
->
p‹t_id
 !
√w_p‹t_id
) {

658 
°p
 *°∞
p
->stp;

659 i‡(
	`°p_is_desig«ãd_p‹t
(
p
)) {

660 
p
->
desig«ãd_p‹t
 = 
√w_p‹t_id
;

662 
p
->
p‹t_id
 = 
√w_p‹t_id
;

663 i‡(
°p
->
bridge_id
 =
p
->
desig«ãd_bridge


664 && 
p
->
p‹t_id
 <Ö->
desig«ãd_p‹t
) {

665 
	`°p_become_desig«ãd_p‹t
(
p
);

666 
	`°p_p‹t_°©e_£À˘i⁄
(
°p
);

669 
	}
}

675 
	$°p_p‹t_£t_∑th_co°
(
°p_p‹t
 *
p
, 
uöt16_t
 
∑th_co°
)

677 i‡(
p
->
∑th_co°
 !=Öath_cost) {

678 
°p
 *°∞
p
->stp;

679 
p
->
∑th_co°
 =Öath_cost;

680 
	`°p_c⁄figuøti⁄_upd©e
(
°p
);

681 
	`°p_p‹t_°©e_£À˘i⁄
(
°p
);

683 
	}
}

687 
	$°p_p‹t_£t_•ìd
(
°p_p‹t
 *
p
, 
•ìd
)

689 
	`°p_p‹t_£t_∑th_co°
(
p
, (
•ìd
 >= 10000 ? 2

690 : 
•ìd
 >= 1000 ? 4

691 : 
•ìd
 >= 100 ? 19

692 : 
•ìd
 >= 16 ? 62

693 : 
•ìd
 >= 10 ? 100

694 : 
•ìd
 >= 4 ? 250

696 
	}
}

700 
	$°p_p‹t_íabÀ_ch™ge_dëe˘i⁄
(
°p_p‹t
 *
p
)

702 
p
->
ch™ge_dëe˘i⁄_íabÀd
 = 
åue
;

703 
	}
}

707 
	$°p_p‹t_dißbÀ_ch™ge_dëe˘i⁄
(
°p_p‹t
 *
p
)

709 
p
->
ch™ge_dëe˘i⁄_íabÀd
 = 
Ál£
;

710 
	}
}

713 
	$°p_å™smô_c⁄fig
(
°p_p‹t
 *
p
)

715 
°p
 *°∞
p
->stp;

716 
boﬁ
 
roŸ
 = 
	`°p_is_roŸ_bridge
(
°p
);

717 i‡(!
roŸ
 && !
°p
->
roŸ_p‹t
) {

720 i‡(
p
->
hﬁd_timî
.
a˘ive
) {

721 
p
->
c⁄fig_≥ndög
 = 
åue
;

723 
°p_c⁄fig_bpdu
 
c⁄fig
;

724 
	`mem£t
(&
c⁄fig
, 0,  config);

725 
c⁄fig
.
hódî
.
¥Ÿocﬁ_id
 = 
	`ht⁄s
(
STP_PROTOCOL_ID
);

726 
c⁄fig
.
hódî
.
¥Ÿocﬁ_vîsi⁄
 = 
STP_PROTOCOL_VERSION
;

727 
c⁄fig
.
hódî
.
bpdu_ty≥
 = 
STP_TYPE_CONFIG
;

728 
c⁄fig
.
Êags
 = 0;

729 i‡(
p
->
t›ﬁogy_ch™ge_ack
) {

730 
c⁄fig
.
Êags
 |
	`ht⁄s
(
STP_CONFIG_TOPOLOGY_CHANGE_ACK
);

732 i‡(
°p
->
t›ﬁogy_ch™ge
) {

733 
c⁄fig
.
Êags
 |
	`ht⁄s
(
STP_CONFIG_TOPOLOGY_CHANGE
);

735 
c⁄fig
.
roŸ_id
 = 
	`ht⁄Œ
(
°p
->
desig«ãd_roŸ
);

736 
c⁄fig
.
roŸ_∑th_co°
 = 
	`ht⁄l
(
°p
->root_path_cost);

737 
c⁄fig
.
bridge_id
 = 
	`ht⁄Œ
(
°p
->bridge_id);

738 
c⁄fig
.
p‹t_id
 = 
	`ht⁄s
(
p
->port_id);

739 i‡(
roŸ
) {

740 
c⁄fig
.
mesßge_age
 = 
	`ht⁄s
(0);

742 
c⁄fig
.
mesßge_age
 = 
	`ht⁄s
(
°p
->
roŸ_p‹t
->
mesßge_age_timî
.
vÆue


743 + 
MESSAGE_AGE_INCREMENT
);

745 
c⁄fig
.
max_age
 = 
	`ht⁄s
(
°p
->max_age);

746 
c⁄fig
.
hñlo_time
 = 
	`ht⁄s
(
°p
->hello_time);

747 
c⁄fig
.
f‹w¨d_dñay
 = 
	`ht⁄s
(
°p
->forward_delay);

748 i‡(
	`¡ohs
(
c⁄fig
.
mesßge_age
Ë< 
°p
->
max_age
) {

749 
p
->
t›ﬁogy_ch™ge_ack
 = 
Ál£
;

750 
p
->
c⁄fig_≥ndög
 = 
Ál£
;

751 
	`°p_£nd_bpdu
(
p
, &
c⁄fig
,  config);

752 
	`°p_°¨t_timî
(&
p
->
hﬁd_timî
, 0);

755 
	}
}

757 
boﬁ


758 
	$°p_su≥r£des_p‹t_öfo
(c⁄° 
°p_p‹t
 *
p
,

759 c⁄° 
°p_c⁄fig_bpdu
 *
c⁄fig
)

761 i‡(
	`¡ohŒ
(
c⁄fig
->
roŸ_id
Ë!
p
->
desig«ãd_roŸ
) {

762  
	`¡ohŒ
(
c⁄fig
->
roŸ_id
Ë< 
p
->
desig«ãd_roŸ
;

763 } i‡(
	`¡ohl
(
c⁄fig
->
roŸ_∑th_co°
Ë!
p
->
desig«ãd_co°
) {

764  
	`¡ohl
(
c⁄fig
->
roŸ_∑th_co°
Ë< 
p
->
desig«ãd_co°
;

765 } i‡(
	`¡ohŒ
(
c⁄fig
->
bridge_id
Ë!
p
->
desig«ãd_bridge
) {

766  
	`¡ohŒ
(
c⁄fig
->
bridge_id
Ë< 
p
->
desig«ãd_bridge
;

768  (
	`¡ohŒ
(
c⁄fig
->
bridge_id
Ë!
p
->
°p
->bridge_id

769 || 
	`¡ohs
(
c⁄fig
->
p‹t_id
Ë<
p
->
desig«ãd_p‹t
);

771 
	}
}

774 
	$°p_ªc‹d_c⁄fig_öf‹m©i⁄
(
°p_p‹t
 *
p
,

775 c⁄° 
°p_c⁄fig_bpdu
 *
c⁄fig
)

777 
p
->
desig«ãd_roŸ
 = 
	`¡ohŒ
(
c⁄fig
->
roŸ_id
);

778 
p
->
desig«ãd_co°
 = 
	`¡ohl
(
c⁄fig
->
roŸ_∑th_co°
);

779 
p
->
desig«ãd_bridge
 = 
	`¡ohŒ
(
c⁄fig
->
bridge_id
);

780 
p
->
desig«ãd_p‹t
 = 
	`¡ohs
(
c⁄fig
->
p‹t_id
);

781 
	`°p_°¨t_timî
(&
p
->
mesßge_age_timî
, 
	`¡ohs
(
c⁄fig
->
mesßge_age
));

782 
	}
}

785 
	$°p_ªc‹d_c⁄fig_timeout_vÆues
(
°p
 *stp,

786 c⁄° 
°p_c⁄fig_bpdu
 *
c⁄fig
)

788 
°p
->
max_age
 = 
	`¡ohs
(
c⁄fig
->max_age);

789 
°p
->
hñlo_time
 = 
	`¡ohs
(
c⁄fig
->hello_time);

790 
°p
->
f‹w¨d_dñay
 = 
	`¡ohs
(
c⁄fig
->forward_delay);

791 
°p
->
t›ﬁogy_ch™ge
 = 
c⁄fig
->
Êags
 & 
	`ht⁄s
(
STP_CONFIG_TOPOLOGY_CHANGE
);

792 
	}
}

794 
boﬁ


795 
	$°p_is_desig«ãd_p‹t
(c⁄° 
°p_p‹t
 *
p
)

797  (
p
->
desig«ãd_bridge
 =p->
°p
->
bridge_id


798 && 
p
->
desig«ãd_p‹t
 =p->
p‹t_id
);

799 
	}
}

802 
	$°p_c⁄fig_bpdu_gíî©i⁄
(
°p
 *stp)

804 
°p_p‹t
 *
p
;

806 
	`FOR_EACH_ENABLED_PORT
 (
p
, 
°p
) {

807 i‡(
	`°p_is_desig«ãd_p‹t
(
p
)) {

808 
	`°p_å™smô_c⁄fig
(
p
);

811 
	}
}

814 
	$°p_å™smô_t˙
(
°p
 *stp)

816 
°p_p‹t
 *
p
 = 
°p
->
roŸ_p‹t
;

817 
°p_t˙_bpdu
 
t˙_bpdu
;

818 i‡(!
p
) {

821 
t˙_bpdu
.
hódî
.
¥Ÿocﬁ_id
 = 
	`ht⁄s
(
STP_PROTOCOL_ID
);

822 
t˙_bpdu
.
hódî
.
¥Ÿocﬁ_vîsi⁄
 = 
STP_PROTOCOL_VERSION
;

823 
t˙_bpdu
.
hódî
.
bpdu_ty≥
 = 
STP_TYPE_TCN
;

824 
	`°p_£nd_bpdu
(
p
, &
t˙_bpdu
, Åcn_bpdu);

825 
	}
}

828 
	$°p_c⁄figuøti⁄_upd©e
(
°p
 *stp)

830 
	`°p_roŸ_£À˘i⁄
(
°p
);

831 
	`°p_desig«ãd_p‹t_£À˘i⁄
(
°p
);

832 
	}
}

834 
boﬁ


835 
	$°p_su≥r£des_roŸ
(c⁄° 
°p_p‹t
 *
roŸ
, c⁄° °p_p‹à*
p
)

837 
p_co°
 = 
p
->
desig«ãd_co°
 +Ö->
∑th_co°
;

838 
roŸ_co°
 = 
roŸ
->
desig«ãd_co°
 +ÑoŸ->
∑th_co°
;

840 i‡(
p
->
desig«ãd_roŸ
 !
roŸ
->designated_root) {

841  
p
->
desig«ãd_roŸ
 < 
roŸ
->designated_root;

842 } i‡(
p_co°
 !
roŸ_co°
) {

843  
p_co°
 < 
roŸ_co°
;

844 } i‡(
p
->
desig«ãd_bridge
 !
roŸ
->designated_bridge) {

845  
p
->
desig«ãd_bridge
 < 
roŸ
->designated_bridge;

846 } i‡(
p
->
desig«ãd_p‹t
 !
roŸ
->designated_port) {

847  
p
->
desig«ãd_p‹t
 < 
roŸ
->designated_port;

849  
p
->
p‹t_id
 < 
roŸ
->port_id;

851 
	}
}

854 
	$°p_roŸ_£À˘i⁄
(
°p
 *stp)

856 
°p_p‹t
 *
p
, *
roŸ
;

858 
roŸ
 = 
NULL
;

859 
	`FOR_EACH_ENABLED_PORT
 (
p
, 
°p
) {

860 i‡(
	`°p_is_desig«ãd_p‹t
(
p
)

861 || 
p
->
desig«ãd_roŸ
 >
°p
->
bridge_id
) {

864 i‡(
roŸ
 && !
	`°p_su≥r£des_roŸ
‘oŸ, 
p
)) {

867 
roŸ
 = 
p
;

869 
°p
->
roŸ_p‹t
 = 
roŸ
;

870 i‡(!
roŸ
) {

871 
°p
->
desig«ãd_roŸ
 = sç->
bridge_id
;

872 
°p
->
roŸ_∑th_co°
 = 0;

874 
°p
->
desig«ãd_roŸ
 = 
roŸ
->designated_root;

875 
°p
->
roŸ_∑th_co°
 = 
roŸ
->
desig«ãd_co°
 +ÑoŸ->
∑th_co°
;

877 
	}
}

880 
	$°p_desig«ãd_p‹t_£À˘i⁄
(
°p
 *stp)

882 
°p_p‹t
 *
p
;

884 
	`FOR_EACH_ENABLED_PORT
 (
p
, 
°p
) {

885 i‡(
	`°p_is_desig«ãd_p‹t
(
p
)

886 || 
p
->
desig«ãd_roŸ
 !
°p
->designated_root

887 || 
°p
->
roŸ_∑th_co°
 < 
p
->
desig«ãd_co°


888 || (
°p
->
roŸ_∑th_co°
 =
p
->
desig«ãd_co°


889 && (
°p
->
bridge_id
 < 
p
->
desig«ãd_bridge


890 || (
°p
->
bridge_id
 =
p
->
desig«ãd_bridge


891 && 
p
->
p‹t_id
 <p->
desig«ãd_p‹t
))))

893 
	`°p_become_desig«ãd_p‹t
(
p
);

896 
	}
}

899 
	$°p_become_desig«ãd_p‹t
(
°p_p‹t
 *
p
)

901 
°p
 *°∞
p
->stp;

902 
p
->
desig«ãd_roŸ
 = 
°p
->designated_root;

903 
p
->
desig«ãd_co°
 = 
°p
->
roŸ_∑th_co°
;

904 
p
->
desig«ãd_bridge
 = 
°p
->
bridge_id
;

905 
p
->
desig«ãd_p‹t
 =Ö->
p‹t_id
;

906 
	}
}

909 
	$°p_p‹t_°©e_£À˘i⁄
(
°p
 *stp)

911 
°p_p‹t
 *
p
;

913 
	`FOR_EACH_ENABLED_PORT
 (
p
, 
°p
) {

914 i‡(
p
 =
°p
->
roŸ_p‹t
) {

915 
p
->
c⁄fig_≥ndög
 = 
Ál£
;

916 
p
->
t›ﬁogy_ch™ge_ack
 = 
Ál£
;

917 
	`°p_make_f‹w¨dög
(
p
);

918 } i‡(
	`°p_is_desig«ãd_p‹t
(
p
)) {

919 
	`°p_°›_timî
(&
p
->
mesßge_age_timî
);

920 
	`°p_make_f‹w¨dög
(
p
);

922 
p
->
c⁄fig_≥ndög
 = 
Ál£
;

923 
p
->
t›ﬁogy_ch™ge_ack
 = 
Ál£
;

924 
	`°p_make_blockög
(
p
);

927 
	}
}

930 
	$°p_make_f‹w¨dög
(
°p_p‹t
 *
p
)

932 i‡(
p
->
°©e
 =
STP_BLOCKING
) {

933 
	`°p_£t_p‹t_°©e
(
p
, 
STP_LISTENING
);

934 
	`°p_°¨t_timî
(&
p
->
f‹w¨d_dñay_timî
, 0);

936 
	}
}

939 
	$°p_make_blockög
(
°p_p‹t
 *
p
)

941 i‡(!(
p
->
°©e
 & (
STP_DISABLED
 | 
STP_BLOCKING
))) {

942 i‡(
p
->
°©e
 & (
STP_FORWARDING
 | 
STP_LEARNING
)) {

943 i‡(
p
->
ch™ge_dëe˘i⁄_íabÀd
) {

944 
	`°p_t›ﬁogy_ch™ge_dëe˘i⁄
(
p
->
°p
);

947 
	`°p_£t_p‹t_°©e
(
p
, 
STP_BLOCKING
);

948 
	`°p_°›_timî
(&
p
->
f‹w¨d_dñay_timî
);

950 
	}
}

953 
	$°p_£t_p‹t_°©e
(
°p_p‹t
 *
p
, 
°p_°©e
 
°©e
)

955 i‡(
°©e
 !
p
->°©ê&& !p->
°©e_ch™ged
) {

956 
p
->
°©e_ch™ged
 = 
åue
;

957 i‡(
p
 <Ö->
°p
->
fú°_ch™ged_p‹t
) {

958 
p
->
°p
->
fú°_ch™ged_p‹t
 =Ö;

961 
p
->
°©e
 = state;

962 
	}
}

965 
	$°p_t›ﬁogy_ch™ge_dëe˘i⁄
(
°p
 *stp)

967 i‡(
	`°p_is_roŸ_bridge
(
°p
)) {

968 
°p
->
t›ﬁogy_ch™ge
 = 
åue
;

969 
	`°p_°¨t_timî
(&
°p
->
t›ﬁogy_ch™ge_timî
, 0);

970 } i‡(!
°p
->
t›ﬁogy_ch™ge_dëe˘ed
) {

971 
	`°p_å™smô_t˙
(
°p
);

972 
	`°p_°¨t_timî
(&
°p
->
t˙_timî
, 0);

974 
°p
->
t›ﬁogy_ch™ge_dëe˘ed
 = 
åue
;

975 
	}
}

978 
	$°p_t›ﬁogy_ch™ge_acknowÀdged
(
°p
 *stp)

980 
°p
->
t›ﬁogy_ch™ge_dëe˘ed
 = 
Ál£
;

981 
	`°p_°›_timî
(&
°p
->
t˙_timî
);

982 
	}
}

985 
	$°p_acknowÀdge_t›ﬁogy_ch™ge
(
°p_p‹t
 *
p
)

987 
p
->
t›ﬁogy_ch™ge_ack
 = 
åue
;

988 
	`°p_å™smô_c⁄fig
(
p
);

989 
	}
}

992 
	$°p_ª˚ived_c⁄fig_bpdu
(
°p
 *°p, 
°p_p‹t
 *
p
,

993 c⁄° 
°p_c⁄fig_bpdu
 *
c⁄fig
)

995 i‡(
	`¡ohs
(
c⁄fig
->
mesßge_age
Ë>¡ohs(c⁄fig->
max_age
)) {

996 
	`VLOG_WARN
(
LOG_MODULE
, "%s:Ñeceived config BPDU with messageáge (%u) greater "

998 
°p
->
«me
,

999 
	`¡ohs
(
c⁄fig
->
mesßge_age
),Çtohs(c⁄fig->
max_age
));

1002 i‡(
p
->
°©e
 !
STP_DISABLED
) {

1003 
boﬁ
 
roŸ
 = 
	`°p_is_roŸ_bridge
(
°p
);

1004 i‡(
	`°p_su≥r£des_p‹t_öfo
(
p
, 
c⁄fig
)) {

1005 
	`°p_ªc‹d_c⁄fig_öf‹m©i⁄
(
p
, 
c⁄fig
);

1006 
	`°p_c⁄figuøti⁄_upd©e
(
°p
);

1007 
	`°p_p‹t_°©e_£À˘i⁄
(
°p
);

1008 i‡(!
	`°p_is_roŸ_bridge
(
°p
Ë&& 
roŸ
) {

1009 
	`°p_°›_timî
(&
°p
->
hñlo_timî
);

1010 i‡(
°p
->
t›ﬁogy_ch™ge_dëe˘ed
) {

1011 
	`°p_°›_timî
(&
°p
->
t›ﬁogy_ch™ge_timî
);

1012 
	`°p_å™smô_t˙
(
°p
);

1013 
	`°p_°¨t_timî
(&
°p
->
t˙_timî
, 0);

1016 i‡(
p
 =
°p
->
roŸ_p‹t
) {

1017 
	`°p_ªc‹d_c⁄fig_timeout_vÆues
(
°p
, 
c⁄fig
);

1018 
	`°p_c⁄fig_bpdu_gíî©i⁄
(
°p
);

1019 i‡(
c⁄fig
->
Êags
 & 
	`ht⁄s
(
STP_CONFIG_TOPOLOGY_CHANGE_ACK
)) {

1020 
	`°p_t›ﬁogy_ch™ge_acknowÀdged
(
°p
);

1023 } i‡(
	`°p_is_desig«ãd_p‹t
(
p
)) {

1024 
	`°p_å™smô_c⁄fig
(
p
);

1027 
	}
}

1030 
	$°p_ª˚ived_t˙_bpdu
(
°p
 *°p, 
°p_p‹t
 *
p
)

1032 i‡(
p
->
°©e
 !
STP_DISABLED
) {

1033 i‡(
	`°p_is_desig«ãd_p‹t
(
p
)) {

1034 
	`°p_t›ﬁogy_ch™ge_dëe˘i⁄
(
°p
);

1035 
	`°p_acknowÀdge_t›ﬁogy_ch™ge
(
p
);

1038 
	}
}

1041 
	$°p_hñlo_timî_expúy
(
°p
 *stp)

1043 
	`°p_c⁄fig_bpdu_gíî©i⁄
(
°p
);

1044 
	`°p_°¨t_timî
(&
°p
->
hñlo_timî
, 0);

1045 
	}
}

1048 
	$°p_mesßge_age_timî_expúy
(
°p_p‹t
 *
p
)

1050 
°p
 *°∞
p
->stp;

1051 
boﬁ
 
roŸ
 = 
	`°p_is_roŸ_bridge
(
°p
);

1052 
	`°p_become_desig«ãd_p‹t
(
p
);

1053 
	`°p_c⁄figuøti⁄_upd©e
(
°p
);

1054 
	`°p_p‹t_°©e_£À˘i⁄
(
°p
);

1055 i‡(
	`°p_is_roŸ_bridge
(
°p
Ë&& !
roŸ
) {

1056 
°p
->
max_age
 = sç->
bridge_max_age
;

1057 
°p
->
hñlo_time
 = sç->
bridge_hñlo_time
;

1058 
°p
->
f‹w¨d_dñay
 = sç->
bridge_f‹w¨d_dñay
;

1059 
	`°p_t›ﬁogy_ch™ge_dëe˘i⁄
(
°p
);

1060 
	`°p_°›_timî
(&
°p
->
t˙_timî
);

1061 
	`°p_c⁄fig_bpdu_gíî©i⁄
(
°p
);

1062 
	`°p_°¨t_timî
(&
°p
->
hñlo_timî
, 0);

1064 
	}
}

1066 
boﬁ


1067 
	$°p_is_desig«ãd_f‹_some_p‹t
(c⁄° 
°p
 *stp)

1069 c⁄° 
°p_p‹t
 *
p
;

1071 
	`FOR_EACH_ENABLED_PORT
 (
p
, 
°p
) {

1072 i‡(
p
->
desig«ãd_bridge
 =
°p
->
bridge_id
) {

1073  
åue
;

1076  
Ál£
;

1077 
	}
}

1080 
	$°p_f‹w¨d_dñay_timî_expúy
(
°p_p‹t
 *
p
)

1082 i‡(
p
->
°©e
 =
STP_LISTENING
) {

1083 
	`°p_£t_p‹t_°©e
(
p
, 
STP_LEARNING
);

1084 
	`°p_°¨t_timî
(&
p
->
f‹w¨d_dñay_timî
, 0);

1085 } i‡(
p
->
°©e
 =
STP_LEARNING
) {

1086 
	`°p_£t_p‹t_°©e
(
p
, 
STP_FORWARDING
);

1087 i‡(
	`°p_is_desig«ãd_f‹_some_p‹t
(
p
->
°p
)) {

1088 i‡(
p
->
ch™ge_dëe˘i⁄_íabÀd
) {

1089 
	`°p_t›ﬁogy_ch™ge_dëe˘i⁄
(
p
->
°p
);

1093 
	}
}

1096 
	$°p_t˙_timî_expúy
(
°p
 *stp)

1098 
	`°p_å™smô_t˙
(
°p
);

1099 
	`°p_°¨t_timî
(&
°p
->
t˙_timî
, 0);

1100 
	}
}

1103 
	$°p_t›ﬁogy_ch™ge_timî_expúy
(
°p
 *stp)

1105 
°p
->
t›ﬁogy_ch™ge_dëe˘ed
 = 
Ál£
;

1106 
°p
->
t›ﬁogy_ch™ge
 = 
Ál£
;

1107 
	}
}

1110 
	$°p_hﬁd_timî_expúy
(
°p_p‹t
 *
p
)

1112 i‡(
p
->
c⁄fig_≥ndög
) {

1113 
	`°p_å™smô_c⁄fig
(
p
);

1115 
	}
}

1118 
	$°p_öôülize_p‹t
(
°p_p‹t
 *
p
, 
°p_°©e
 
°©e
)

1120 
	`as£π
(
°©e
 & (
STP_DISABLED
 | 
STP_BLOCKING
));

1121 
	`°p_become_desig«ãd_p‹t
(
p
);

1122 
	`°p_£t_p‹t_°©e
(
p
, 
°©e
);

1123 
p
->
t›ﬁogy_ch™ge_ack
 = 
Ál£
;

1124 
p
->
c⁄fig_≥ndög
 = 
Ál£
;

1125 
p
->
ch™ge_dëe˘i⁄_íabÀd
 = 
åue
;

1126 
	`°p_°›_timî
(&
p
->
mesßge_age_timî
);

1127 
	`°p_°›_timî
(&
p
->
f‹w¨d_dñay_timî
);

1128 
	`°p_°›_timî
(&
p
->
hﬁd_timî
);

1129 
	}
}

1132 
	$°p_become_roŸ_bridge
(
°p
 *stp)

1134 
°p
->
max_age
 = sç->
bridge_max_age
;

1135 
°p
->
hñlo_time
 = sç->
bridge_hñlo_time
;

1136 
°p
->
f‹w¨d_dñay
 = sç->
bridge_f‹w¨d_dñay
;

1137 
	`°p_t›ﬁogy_ch™ge_dëe˘i⁄
(
°p
);

1138 
	`°p_°›_timî
(&
°p
->
t˙_timî
);

1139 
	`°p_c⁄fig_bpdu_gíî©i⁄
(
°p
);

1140 
	`°p_°¨t_timî
(&
°p
->
hñlo_timî
, 0);

1141 
	}
}

1144 
	$°p_°¨t_timî
(
°p_timî
 *
timî
, 
vÆue
)

1146 
timî
->
vÆue
 = value;

1147 
timî
->
a˘ive
 = 
åue
;

1148 
	}
}

1151 
	$°p_°›_timî
(
°p_timî
 *
timî
)

1153 
timî
->
a˘ive
 = 
Ál£
;

1154 
	}
}

1156 
boﬁ


1157 
	$°p_timî_expúed
(
°p_timî
 *
timî
, 
ñ≠£d
, 
timeout
)

1159 i‡(
timî
->
a˘ive
) {

1160 
timî
->
vÆue
 +
ñ≠£d
;

1161 i‡(
timî
->
vÆue
 >
timeout
) {

1162 
timî
->
a˘ive
 = 
Ál£
;

1163  
åue
;

1166  
Ál£
;

1167 
	}
}

1172 
	$ms_to_timî
(
ms
)

1174  
ms
 * 0x100 / 1000;

1175 
	}
}

1180 
	$ms_to_timî_ªmaödî
(
ms
)

1182  
ms
 * 0x100 % 1000;

1183 
	}
}

1188 
	$timî_to_ms
(
timî
)

1190  
timî
 * 1000 / 0x100;

1191 
	}
}

1194 
	$˛amp
(
x
, 
mö
, 
max
)

1196  
x
 < 
mö
 ? mö : x > 
max
 ? max : x;

1197 
	}
}

1200 
	$°p_upd©e_bridge_timîs
(
°p
 *stp)

1202 
ht
, 
ma
, 
fd
;

1204 
ht
 = 
	`˛amp
(
°p
->
rq_hñlo_time
, 1000, 10000);

1205 
ma
 = 
	`˛amp
(
°p
->
rq_max_age
, 
	`MAX
(2 * (
ht
 + 1000), 6000), 40000);

1206 
fd
 = 
	`˛amp
(
°p
->
rq_f‹w¨d_dñay
, 
ma
 / 2 + 1000, 30000);

1208 
°p
->
bridge_hñlo_time
 = 
	`ms_to_timî
(
ht
);

1209 
°p
->
bridge_max_age
 = 
	`ms_to_timî
(
ma
);

1210 
°p
->
bridge_f‹w¨d_dñay
 = 
	`ms_to_timî
(
fd
);

1212 i‡(
	`°p_is_roŸ_bridge
(
°p
)) {

1213 
°p
->
max_age
 = sç->
bridge_max_age
;

1214 
°p
->
hñlo_time
 = sç->
bridge_hñlo_time
;

1215 
°p
->
f‹w¨d_dñay
 = sç->
bridge_f‹w¨d_dñay
;

1217 
	}
}

1220 
	$°p_£nd_bpdu
(
°p_p‹t
 *
p
, c⁄° *
bpdu
, 
size_t
 
bpdu_size
)

1222 
ëh_hódî
 *
ëh
;

1223 
Œc_hódî
 *
Œc
;

1224 
oÂbuf
 *
pkt
;

1227 
pkt
 = 
	`oÂbuf_√w
(
ETH_HEADER_LEN
 + 
LLC_HEADER_LEN
 + 
bpdu_size
);

1228 
pkt
->
l2
 = 
ëh
 = 
	`oÂbuf_put_zîos
(pkt,  *eth);

1229 
Œc
 = 
	`oÂbuf_put_zîos
(
pkt
,  *llc);

1230 
pkt
->
l3
 = 
	`oÂbuf_put
’kt, 
bpdu
, 
bpdu_size
);

1233 
	`mem˝y
(
ëh
->
ëh_d°
, 
°p_ëh_addr
, 
ETH_ADDR_LEN
);

1235 
ëh
->
ëh_ty≥
 = 
	`ht⁄s
(
pkt
->
size
 - 
ETH_HEADER_LEN
);

1238 
Œc
->
Œc_dßp
 = 
STP_LLC_DSAP
;

1239 
Œc
->
Œc_sßp
 = 
STP_LLC_SSAP
;

1240 
Œc
->
Œc_˙é
 = 
STP_LLC_CNTL
;

1242 
p
->
°p
->
	`£nd_bpdu
(
pkt
, 
	`°p_p‹t_no
’),Ö->°p->
aux
);

1243 
	}
}

	@lib/stp.h

34 #i‚de‡
STP_H


35 
	#STP_H
 1

	)

40 
	~<°dboﬁ.h
>

41 
	~<°döt.h
>

42 
	~"compûî.h
"

43 
	~"utû.h
"

45 
	goÂbuf
;

48 c⁄° 
uöt8_t
 
°p_ëh_addr
[6];

51 
	#STP_LLC_SSAP
 0x42

	)

52 
	#STP_LLC_DSAP
 0x42

	)

53 
	#STP_LLC_CNTL
 0x03

	)

56 
	#STP_DEFAULT_BRIDGE_PRIORITY
 32768

	)

57 
	#STP_DEFAULT_PORT_PRIORITY
 128

	)

61 
uöt64_t
 
	t°p_idítifõr
;

64 
	#STP_MAX_PORTS
 255

	)

65 
°p
 *
°p_¸óã
(c⁄° *
«me
, 
°p_idítifõr
 
bridge_id
,

66 (*
£nd_bpdu
)(
oÂbuf
 *
bpdu
, 
p‹t_no
,

67 *
aux
),

68 *
aux
);

69 
	`°p_de°roy
(
°p
 *);

70 
	`°p_tick
(
°p
 *, 
ms
);

71 
	`°p_£t_bridge_id
(
°p
 *, 
°p_idítifõr
 
bridge_id
);

72 
	`°p_£t_bridge_¥i‹ôy
(
°p
 *, 
uöt16_t
 
√w_¥i‹ôy
);

73 
	`°p_£t_hñlo_time
(
°p
 *, 
ms
);

74 
	`°p_£t_max_age
(
°p
 *, 
ms
);

75 
	`°p_£t_f‹w¨d_dñay
(
°p
 *, 
ms
);

78 c⁄° *
	`°p_gë_«me
(c⁄° 
°p
 *);

79 
°p_idítifõr
 
	`°p_gë_bridge_id
(c⁄° 
°p
 *);

80 
°p_idítifõr
 
	`°p_gë_desig«ãd_roŸ
(c⁄° 
°p
 *);

81 
boﬁ
 
	`°p_is_roŸ_bridge
(c⁄° 
°p
 *);

82 
	`°p_gë_roŸ_∑th_co°
(c⁄° 
°p
 *);

83 
	`°p_gë_hñlo_time
(c⁄° 
°p
 *);

84 
	`°p_gë_max_age
(c⁄° 
°p
 *);

85 
	`°p_gë_f‹w¨d_dñay
(c⁄° 
°p
 *);

88 
°p_p‹t
 *
	`°p_gë_p‹t
(
°p
 *, 
p‹t_no
);

89 
°p_p‹t
 *
	`°p_gë_roŸ_p‹t
(
°p
 *);

90 
boﬁ
 
	`°p_gë_ch™ged_p‹t
(
°p
 *, 
°p_p‹t
 **
p‹ç
);

96 
	e°p_°©e
 {

97 
STP_DISABLED
 = 1 << 0,

98 
STP_LISTENING
 = 1 << 1,

99 
STP_LEARNING
 = 1 << 2,

100 
STP_FORWARDING
 = 1 << 3,

101 
STP_BLOCKING
 = 1 << 4

103 c⁄° *
	`°p_°©e_«me
(
°p_°©e
);

104 
boﬁ
 
	`°p_f‹w¨d_ö_°©e
(
°p_°©e
);

105 
boﬁ
 
	`°p_À¨n_ö_°©e
(
°p_°©e
);

107 
	`°p_ª˚ived_bpdu
(
°p_p‹t
 *, c⁄° *
bpdu
, 
size_t
 
bpdu_size
);

109 
°p
 *
	`°p_p‹t_gë_°p
(
°p_p‹t
 *);

110 
	`°p_p‹t_no
(c⁄° 
°p_p‹t
 *);

111 
°p_°©e
 
	`°p_p‹t_gë_°©e
(c⁄° 
°p_p‹t
 *);

112 
	`°p_p‹t_íabÀ
(
°p_p‹t
 *);

113 
	`°p_p‹t_dißbÀ
(
°p_p‹t
 *);

114 
	`°p_p‹t_£t_¥i‹ôy
(
°p_p‹t
 *, 
uöt8_t
 
√w_¥i‹ôy
);

115 
	`°p_p‹t_£t_∑th_co°
(
°p_p‹t
 *, 
uöt16_t
 
∑th_co°
);

116 
	`°p_p‹t_£t_•ìd
(
°p_p‹t
 *, 
•ìd
);

117 
	`°p_p‹t_íabÀ_ch™ge_dëe˘i⁄
(
°p_p‹t
 *);

118 
	`°p_p‹t_dißbÀ_ch™ge_dëe˘i⁄
(
°p_p‹t
 *);

	@lib/svec.c

34 
	~<c⁄fig.h
>

35 
	~"svec.h
"

36 
	~<as£π.h
>

37 
	~<˘y≥.h
>

38 
	~<°dlib.h
>

39 
	~<°rög.h
>

40 
	~"dy«mic-°rög.h
"

41 
	~"utû.h
"

43 
	#LOG_MODULE
 
VLM_svec


	)

44 
	~"vlog.h
"

47 
	$svec_öô
(
svec
 *svec)

49 
svec
->
«mes
 = 
NULL
;

50 
svec
->
n
 = 0;

51 
svec
->
Æloˇãd
 = 0;

52 
	}
}

55 
	$svec_de°roy
(
svec
 *svec)

57 
	`svec_˛ór
(
svec
);

58 
	`‰ì
(
svec
->
«mes
);

59 
	}
}

62 
	$svec_˛ór
(
svec
 *svec)

64 
size_t
 
i
;

66 
i
 = 0; i < 
svec
->
n
; i++) {

67 
	`‰ì
(
svec
->
«mes
[
i
]);

69 
svec
->
n
 = 0;

70 
	}
}

73 
	$svec_add
(
svec
 *svec, c⁄° *
«me
)

75 
	`svec_add_noc›y
(
svec
, 
	`x°rdup
(
«me
));

76 
	}
}

79 
	$svec_ex∑nd
(
svec
 *svec)

81 i‡(
svec
->
n
 >svec->
Æloˇãd
) {

82 
svec
->
«mes
 = 
	`x2ƒóŒoc
(svec->«mes, &svec->
Æloˇãd
,

83  *
svec
->
«mes
);

85 
	}
}

88 
	$svec_add_noc›y
(
svec
 *svec, *
«me
)

90 
	`svec_ex∑nd
(
svec
);

91 
svec
->
«mes
[svec->
n
++] = 
«me
;

92 
	}
}

95 
	$svec_≠≥nd
(
svec
 *svec, c⁄° sve¯*
Ÿhî
)

97 
size_t
 
i
;

98 
i
 = 0; i < 
Ÿhî
->
n
; i++) {

99 
	`svec_add
(
svec
, 
Ÿhî
->
«mes
[
i
]);

101 
	}
}

104 
	$svec_ãrmö©e
(
svec
 *svec)

106 
	`svec_ex∑nd
(
svec
);

107 
svec
->
«mes
[svec->
n
] = 
NULL
;

108 
	}
}

111 
	$com∑ª_°rögs
(c⁄° *
a_
, c⁄° *
b_
)

113 *c⁄° *
a
 = 
a_
;

114 *c⁄° *
b
 = 
b_
;

115  
	`°rcmp
(*
a
, *
b
);

116 
	}
}

119 
	$svec_s‹t
(
svec
 *svec)

121 
	`qs‹t
(
svec
->
«mes
, svec->
n
,  *svec->«mes, 
com∑ª_°rögs
);

122 
	}
}

125 
	$svec_s‹t_unique
(
svec
 *svec)

127 
	`svec_s‹t
(
svec
);

128 
	`svec_unique
(
svec
);

129 
	}
}

132 
	$svec_unique
(
svec
 *svec)

134 
	`as£π
(
	`svec_is_s‹ãd
(
svec
));

135 i‡(
svec
->
n
 > 1) {

138 
svec
 
tmp
;

139 
size_t
 
i
;

141 
	`svec_öô
(&
tmp
);

142 
	`svec_add
(&
tmp
, 
svec
->
«mes
[0]);

143 
i
 = 1; i < 
svec
->
n
; i++) {

144 i‡(
	`°rcmp
(
svec
->
«mes
[
i
 - 1], svec->names[i])) {

145 
	`svec_add
(&
tmp
, 
svec
->
«mes
[
i
]);

148 
	`svec_sw≠
(&
tmp
, 
svec
);

149 
	`svec_de°roy
(&
tmp
);

151 
	}
}

154 
	$svec_diff
(c⁄° 
svec
 *
a
, c⁄° sve¯*
b
,

155 
svec
 *
a_⁄ly
, sve¯*
bŸh
, sve¯*
b_⁄ly
)

157 
size_t
 
i
, 
j
;

159 
	`as£π
(
	`svec_is_s‹ãd
(
a
));

160 
	`as£π
(
	`svec_is_s‹ãd
(
b
));

161 i‡(
a_⁄ly
) {

162 
	`svec_öô
(
a_⁄ly
);

164 i‡(
bŸh
) {

165 
	`svec_öô
(
bŸh
);

167 i‡(
b_⁄ly
) {

168 
	`svec_öô
(
b_⁄ly
);

170 
i
 = 
j
 = 0; i < 
a
->
n
 && j < 
b
->n; ) {

171 
cmp
 = 
	`°rcmp
(
a
->
«mes
[
i
], 
b
->«mes[
j
]);

172 i‡(
cmp
 < 0) {

173 i‡(
a_⁄ly
) {

174 
	`svec_add
(
a_⁄ly
, 
a
->
«mes
[
i
]);

176 
i
++;

177 } i‡(
cmp
 > 0) {

178 i‡(
b_⁄ly
) {

179 
	`svec_add
(
b_⁄ly
, 
b
->
«mes
[
j
]);

181 
j
++;

183 i‡(
bŸh
) {

184 
	`svec_add
(
bŸh
, 
a
->
«mes
[
i
]);

186 
i
++;

187 
j
++;

190 i‡(
a_⁄ly
) {

191 ; 
i
 < 
a
->
n
; i++) {

192 
	`svec_add
(
a_⁄ly
, 
a
->
«mes
[
i
]);

195 i‡(
b_⁄ly
) {

196 ; 
j
 < 
b
->
n
; j++) {

197 
	`svec_add
(
b_⁄ly
, 
b
->
«mes
[
j
]);

200 
	}
}

202 
boﬁ


203 
	$svec_c⁄èös
(c⁄° 
svec
 *svec, c⁄° *
«me
)

205  
	`svec_föd
(
svec
, 
«me
Ë!
SIZE_MAX
;

206 
	}
}

208 
size_t


209 
	$svec_föd
(c⁄° 
svec
 *svec, c⁄° *
«me
)

211 **
p
;

213 
	`as£π
(
	`svec_is_s‹ãd
(
svec
));

214 
p
 = 
	`b£¨ch
(&
«me
, 
svec
->
«mes
, svec->
n
,  *svec->names,

215 
com∑ª_°rögs
);

216  
p
 ?Ö - 
svec
->
«mes
 : 
SIZE_MAX
;

217 
	}
}

219 
boﬁ


220 
	$svec_is_s‹ãd
(c⁄° 
svec
 *svec)

222 
size_t
 
i
;

224 
i
 = 1; i < 
svec
->
n
; i++) {

225 i‡(
	`°rcmp
(
svec
->
«mes
[
i
 - 1], svec->names[i]) > 0) {

226  
Ál£
;

229  
åue
;

230 
	}
}

232 
boﬁ


233 
	$svec_is_unique
(c⁄° 
svec
 *svec)

235  
	`svec_gë_du∂iˇã
(
svec
Ë=
NULL
;

236 
	}
}

239 
	$svec_gë_du∂iˇã
(c⁄° 
svec
 *svec)

241 
	`as£π
(
	`svec_is_s‹ãd
(
svec
));

242 i‡(
svec
->
n
 > 1) {

243 
size_t
 
i
;

244 
i
 = 1; i < 
svec
->
n
; i++) {

245 i‡(!
	`°rcmp
(
svec
->
«mes
[
i
 - 1], svec->names[i])) {

246  
svec
->
«mes
[
i
];

250  
NULL
;

251 
	}
}

254 
	$svec_sw≠
(
svec
 *
a
, sve¯*
b
)

256 
svec
 
tmp
 = *
a
;

257 *
a
 = *
b
;

258 *
b
 = 
tmp
;

259 
	}
}

262 
	$svec_¥öt
(c⁄° 
svec
 *svec, c⁄° *
tôÀ
)

264 
size_t
 
i
;

266 
	`¥ötf
("%s:\n", 
tôÀ
);

267 
i
 = 0; i < 
svec
->
n
; i++) {

268 
	`¥ötf
("\"%s\"\n", 
svec
->
«mes
[
i
]);

270 
	}
}

275 
	$svec_∑r£_w‹ds
(
svec
 *svec, c⁄° *
w‹ds
)

277 
ds
 
w‹d
 = 
DS_EMPTY_INITIALIZER
;

278 c⁄° *
p
, *
q
;

280 
p
 = 
w‹ds
; *∞!'\0';Ö = 
q
) {

281 
quŸe
 = 0;

283 
	`is•a˚
((Ë*
p
)) {

284 
p
++;

286 i‡(*
p
 == '\0') {

290 
	`ds_˛ór
(&
w‹d
);

291 
q
 = 
p
; *q != '\0'; q++) {

292 i‡(*
q
 =
quŸe
) {

293 
quŸe
 = 0;

294 } i‡(*
q
 == '\'' || *q == '"') {

295 
quŸe
 = *
q
;

296 } i‡(*
q
 ='\\' && (!
quŸe
 || quote == '"')) {

297 
q
++;

298 i‡(*
q
 == '\0') {

299 
	`VLOG_WARN
(
LOG_MODULE
, "%s:Énd†öÅøûög back¶ash", 
w‹ds
);

302 
	`ds_put_ch¨
(&
w‹d
, *
q
);

303 } i‡(
	`is•a˚
((Ë*
q
Ë&& !
quŸe
) {

304 
q
++;

307 
	`ds_put_ch¨
(&
w‹d
, *
q
);

310 
	`svec_add
(
svec
, 
	`ds_c°r
(&
w‹d
));

311 i‡(
quŸe
) {

312 
	`VLOG_WARN
(
LOG_MODULE
, "%s: w‹dÉnd†ösidêquŸed såög", 
w‹ds
);

315 
	`ds_de°roy
(&
w‹d
);

316 
	}
}

318 
boﬁ


319 
	$svec_equÆ
(c⁄° 
svec
 *
a
, c⁄° sve¯*
b
)

321 
size_t
 
i
;

323 i‡(
a
->
n
 !
b
->n) {

324  
Ál£
;

326 
i
 = 0; i < 
a
->
n
; i++) {

327 i‡(
	`°rcmp
(
a
->
«mes
[
i
], 
b
->names[i])) {

328  
Ál£
;

331  
åue
;

332 
	}
}

335 
	$svec_joö
(c⁄° 
svec
 *svec, c⁄° *
dñimôî
)

337 
ds
 ds;

338 
size_t
 
i
;

340 
	`ds_öô
(&
ds
);

341 
i
 = 0; i < 
svec
->
n
; i++) {

342 i‡(
i
) {

343 
	`ds_put_c°r
(&
ds
, 
dñimôî
);

345 
	`ds_put_c°r
(&
ds
, 
svec
->
«mes
[
i
]);

347  
	`ds_c°r
(&
ds
);

348 
	}
}

351 
	$svec_back
(c⁄° 
svec
 *svec)

353 
	`as£π
(
svec
->
n
);

354  
svec
->
«mes
[svec->
n
 - 1];

355 
	}
}

358 
	$svec_p›_back
(
svec
 *svec)

360 
	`as£π
(
svec
->
n
);

361 
	`‰ì
(
svec
->
«mes
[--svec->
n
]);

362 
	}
}

	@lib/svec.h

34 #i‚de‡
SVEC_H


35 
	#SVEC_H
 1

	)

37 
	~<°dboﬁ.h
>

38 
	~<°ddef.h
>

40 
	ssvec
 {

41 **
	m«mes
;

42 
size_t
 
	mn
;

43 
size_t
 
	mÆloˇãd
;

46 
	#SVEC_EMPTY_INITIALIZER
 { 
NULL
, 0, 0 }

	)

48 
svec_öô
(
svec
 *);

49 
svec_de°roy
(
svec
 *);

50 
svec_˛ór
(
svec
 *);

51 
svec_add
(
svec
 *, const *);

52 
svec_add_noc›y
(
svec
 *, *);

53 
svec_≠≥nd
(
svec
 *, const svec *);

54 
svec_ãrmö©e
(
svec
 *);

55 
svec_s‹t
(
svec
 *);

56 
svec_s‹t_unique
(
svec
 *);

57 
svec_unique
(
svec
 *);

58 
svec_diff
(c⁄° 
svec
 *
a
, c⁄° sve¯*
b
,

59 
svec
 *
a_⁄ly
, sve¯*
bŸh
, sve¯*
b_⁄ly
);

60 
boﬁ
 
svec_c⁄èös
(c⁄° 
svec
 *, const *);

61 
size_t
 
svec_föd
(c⁄° 
svec
 *, const *);

62 
boﬁ
 
svec_is_s‹ãd
(c⁄° 
svec
 *);

63 
boﬁ
 
svec_is_unique
(c⁄° 
svec
 *);

64 c⁄° *
svec_gë_du∂iˇã
(c⁄° 
svec
 *);

65 
svec_sw≠
(
svec
 *
a
, sve¯*
b
);

66 
svec_¥öt
(c⁄° 
svec
 *svec, c⁄° *
tôÀ
);

67 
svec_∑r£_w‹ds
(
svec
 *svec, c⁄° *
w‹ds
);

68 
boﬁ
 
svec_equÆ
(c⁄° 
svec
 *, const svec *);

69 *
svec_joö
(c⁄° 
svec
 *, c⁄° *
dñimôî
);

70 c⁄° *
svec_back
(c⁄° 
svec
 *);

71 
svec_p›_back
(
svec
 *);

	@lib/tag.c

34 
	~<c⁄fig.h
>

35 
	~"èg.h
"

36 
	~<limôs.h
>

37 
	~"øndom.h
"

38 
	~"ty≥-¥›s.h
"

39 
	~"utû.h
"

41 
	#N_TAG_BITS
 (
CHAR_BIT
 * (
èg_ty≥
))

	)

42 
BUILD_ASSERT_DECL
(
IS_POW2
(
N_TAG_BITS
));

44 
	#LOG2_N_TAG_BITS
 (
N_TAG_BITS
 =32 ? 5 : N_TAG_BITS =64 ? 6 : 0)

	)

45 
BUILD_ASSERT_DECL
(
LOG2_N_TAG_BITS
 > 0);

48 
èg_ty≥


49 
	$èg_¸óã_øndom
()

51 
x
, 
y
;

53 
uöt16_t
 
r
 = 
	`øndom_uöt16
();

54 
x
 = 
r
 & (
N_TAG_BITS
 - 1);

55 
y
 = 
r
 >> (16 - 
LOG2_N_TAG_BITS
);

56 } 
x
 =
y
);

57  (1u << 
x
Ë| (1u << 
y
);

58 
	}
}

65 
èg_ty≥


66 
	$èg_¸óã_dëîmöi°ic
(
uöt32_t
 
£ed
)

68 
x
 = 
£ed
 & (
N_TAG_BITS
 - 1);

69 
y
 = (
£ed
 >> 
LOG2_N_TAG_BITS
) % 31;

70 
y
 +y >
x
;

71  (1u << 
x
Ë| (1u << 
y
);

72 
	}
}

76 
	$èg_£t_öô
(
èg_£t
 *
£t
)

78 
	`mem£t
(
£t
, 0,  *set);

79 
	}
}

83 
	$èg_£t_add
(
èg_£t
 *
£t
, 
èg_ty≥
 
èg
)

85 i‡(
èg
 && (!
	`èg_is_vÆid
—agË|| !
	`èg_£t_öãr£˘s
(
£t
,Åag))) {

90 
èg_ty≥
 *
t
 = &
£t
->
ègs
[£t->
n
++ % 
TAG_SET_SIZE
];

91 *
t
 |
èg
;

92 i‡(*
t
 =
	`TYPE_MAXIMUM
(
èg_ty≥
)) {

93 
£t
->
ègs
[0] = *
t
;

96 
£t
->
tŸÆ
 |
èg
;

98 
	}
}

	@lib/tag.h

34 #i‚de‡
TAG_H


35 
	#TAG_H
 1

	)

37 
	~<as£π.h
>

38 
	~<°dboﬁ.h
>

39 
	~<°döt.h
>

40 
	~"utû.h
"

87 
uöt32_t
 
	tèg_ty≥
;

89 
èg_ty≥
 
èg_¸óã_øndom
();

90 
èg_ty≥
 
èg_¸óã_dëîmöi°ic
(
uöt32_t
 
£ed
);

91 
ölöe
 
boﬁ
 
èg_öãr£˘s
(
èg_ty≥
,Åag_type);

92 
ölöe
 
boﬁ
 
èg_is_vÆid
(
èg_ty≥
);

96 
ölöe
 
boﬁ


97 
	$èg_öãr£˘s
(
èg_ty≥
 
a
,Åag_ty≥ 
b
)

99 
èg_ty≥
 
x
 = 
a
 & 
b
;

100  (
x
 & (x - 1)) != 0;

101 
	}
}

105 
ölöe
 
boﬁ


106 
	$èg_is_vÆid
(
èg_ty≥
 
èg
)

108 
èg_ty≥
 
x
 = 
èg
 & (tag - 1);

109 
èg_ty≥
 
y
 = 
x
 & (x - 1);

110  
x
 && !
y
;

111 
	}
}

118 
	#TAG_SET_SIZE
 4

	)

119 
	sèg_£t
 {

120 
èg_ty≥
 
	mtŸÆ
;

121 
èg_ty≥
 
	mègs
[
TAG_SET_SIZE
];

122 
	mn
;

125 
èg_£t_öô
(
èg_£t
 *);

126 
èg_£t_add
(
èg_£t
 *, 
èg_ty≥
);

127 
ölöe
 
boﬁ
 
èg_£t_is_em±y
(c⁄° 
èg_£t
 *);

128 
ölöe
 
boﬁ
 
èg_£t_öãr£˘s
(c⁄° 
èg_£t
 *, 
èg_ty≥
);

132 
ölöe
 
boﬁ


133 
	$èg_£t_is_em±y
(c⁄° 
èg_£t
 *
£t
)

135  !
£t
->
n
;

136 
	}
}

140 
ölöe
 
boﬁ


141 
	$èg_£t_öãr£˘s
(c⁄° 
èg_£t
 *
£t
, 
èg_ty≥
 
ègs
)

143 
	`BUILD_ASSERT_DECL
(
TAG_SET_SIZE
 == 4);

144  (
	`èg_öãr£˘s
(
£t
->
tŸÆ
, 
ègs
)

145 && (
	`èg_öãr£˘s
(
£t
->
ègs
[0],Åags)

146 || 
	`èg_öãr£˘s
(
£t
->
ègs
[1],Åags)

147 || 
	`èg_öãr£˘s
(
£t
->
ègs
[2],Åags)

148 || 
	`èg_öãr£˘s
(
£t
->
ègs
[3],Åags)));

149 
	}
}

	@lib/timeval.c

34 
	~<c⁄fig.h
>

35 
	~"timevÆ.h
"

36 
	~<as£π.h
>

37 
	~<î∫o.h
>

38 
	~<pﬁl.h
>

39 
	~<sig«l.h
>

40 
	~<°rög.h
>

41 
	~<sys/time.h
>

42 
	~"Áèl-sig«l.h
"

43 
	~"utû.h
"

46 
boﬁ
 
	göôed
;

49 vﬁ©ûê
sig_©omic_t
 
	gtick
;

52 
timevÆ
 
	gnow
;

55 
time_t
 
	gdódlöe
 = 
TIME_MIN
;

57 
sigÆrm_h™dÀr
();

58 
ª‰esh_if_ticked
();

59 
time_t
 
time_add
(time_t,Åime_t);

60 
block_sigÆrm
(
sig£t_t
 *);

61 
unblock_sigÆrm
(c⁄° 
sig£t_t
 *);

65 
	$time_öô
()

67 
siga˘i⁄
 
ß
;

68 
ôimîvÆ
 
ôimî
;

70 i‡(
öôed
) {

74 
öôed
 = 
åue
;

75 
	`gëtimeofday
(&
now
, 
NULL
);

76 
tick
 = 
Ál£
;

79 
	`mem£t
(&
ß
, 0,  sa);

80 
ß
.
ß_h™dÀr
 = 
sigÆrm_h™dÀr
;

81 
	`sigem±y£t
(&
ß
.
ß_mask
);

82 
ß
.
ß_Êags
 = 
SA_RESTART
;

83 i‡(
	`siga˘i⁄
(
SIGALRM
, &
ß
, 
NULL
)) {

84 
	`oÂ_Áèl
(
î∫o
, "sigaction(SIGALRM) failed");

88 
ôimî
.
ô_öãrvÆ
.
tv_£c
 = 0;

89 
ôimî
.
ô_öãrvÆ
.
tv_u£c
 = 
TIME_UPDATE_INTERVAL
 * 1000;

90 
ôimî
.
ô_vÆue
 = itimî.
ô_öãrvÆ
;

91 i‡(
	`£tôimî
(
ITIMER_REAL
, &
ôimî
, 
NULL
)) {

92 
	`oÂ_Áèl
(
î∫o
, "setitimer failed");

94 
	}
}

100 
	$time_ª‰esh
()

102 
	`gëtimeofday
(&
now
, 
NULL
);

103 
tick
 = 
Ál£
;

104 
	}
}

107 
time_t


108 
	$time_now
()

110 
	`ª‰esh_if_ticked
();

111  
now
.
tv_£c
;

112 
	}
}

116 
	$time_m£c
()

118 
	`ª‰esh_if_ticked
();

119  (Ë
now
.
tv_£c
 * 1000 +Çow.
tv_u£c
 / 1000;

120 
	}
}

125 
	$time_Æ¨m
(
£cs
)

127 
sig£t_t
 
ﬁdsigs
;

129 
	`time_öô
();

130 
	`block_sigÆrm
(&
ﬁdsigs
);

131 
dódlöe
 = 
£cs
 ? 
	`time_add
(
	`time_now
(), secsË: 
TIME_MIN
;

132 
	`unblock_sigÆrm
(&
ﬁdsigs
);

133 
	}
}

146 
	$time_pﬁl
(
pﬁlfd
 *
pﬁlfds
, 
n_pﬁlfds
, 
timeout
)

148 
°¨t
;

149 
sig£t_t
 
ﬁdsigs
;

150 
boﬁ
 
blocked
;

151 
ªtvÆ
;

153 
	`time_ª‰esh
();

154 
°¨t
 = 
	`time_m£c
();

155 
blocked
 = 
Ál£
;

157 
time_À·
;

158 i‡(
timeout
 > 0) {

159 
ñ≠£d
 = 
	`time_m£c
(Ë- 
°¨t
;

160 
time_À·
 = 
timeout
 >
ñ≠£d
 ?Åimeout -Élapsed : 0;

162 
time_À·
 = 
timeout
;

165 
ªtvÆ
 = 
	`pﬁl
(
pﬁlfds
, 
n_pﬁlfds
, 
time_À·
);

166 i‡(
ªtvÆ
 < 0) {

167 
ªtvÆ
 = -
î∫o
;

169 i‡(
ªtvÆ
 !-
EINTR
) {

173 i‡(!
blocked
 && 
dódlöe
 =
TIME_MIN
) {

174 
	`block_sigÆrm
(&
ﬁdsigs
);

175 
blocked
 = 
åue
;

177 
	`time_ª‰esh
();

179 i‡(
blocked
) {

180 
	`unblock_sigÆrm
(&
ﬁdsigs
);

182  
ªtvÆ
;

183 
	}
}

186 
time_t


187 
	$time_add
(
time_t
 
a
,Åime_à
b
)

189  (
a
 >= 0

190 ? (
b
 > 
TIME_MAX
 - 
a
 ? TIME_MAX :á + b)

191 : (
b
 < 
TIME_MIN
 - 
a
 ? TIME_MIN :á + b));

192 
	}
}

195 
	$sigÆrm_h™dÀr
(
sig_ƒ
)

197 
tick
 = 
åue
;

198 i‡(
dódlöe
 !
TIME_MIN
 && 
	`time
(0) > deadline) {

199 
	`Áèl_sig«l_h™dÀr
(
sig_ƒ
);

201 
	}
}

204 
	$ª‰esh_if_ticked
()

206 
	`as£π
(
öôed
);

207 i‡(
tick
) {

208 
	`time_ª‰esh
();

210 
	}
}

213 
	$block_sigÆrm
(
sig£t_t
 *
ﬁdsigs
)

215 
sig£t_t
 
sigÆrm
;

216 
	`sigem±y£t
(&
sigÆrm
);

217 
	`sigadd£t
(&
sigÆrm
, 
SIGALRM
);

218 i‡(
	`sig¥ocmask
(
SIG_BLOCK
, &
sigÆrm
, 
ﬁdsigs
)) {

219 
	`oÂ_Áèl
(
î∫o
, "sigprocmask");

221 
	}
}

224 
	$unblock_sigÆrm
(c⁄° 
sig£t_t
 *
ﬁdsigs
)

226 i‡(
	`sig¥ocmask
(
SIG_SETMASK
, 
ﬁdsigs
, 
NULL
)) {

227 
	`oÂ_Áèl
(
î∫o
, "sigprocmask");

229 
	}
}

	@lib/timeval.h

34 #i‚de‡
TIMEVAL_H


35 
	#TIMEVAL_H
 1

	)

37 
	~<time.h
>

38 
	~"ty≥-¥›s.h
"

39 
	~"utû.h
"

41 
	gpﬁlfd
;

44 
BUILD_ASSERT_DECL
(
TYPE_IS_INTEGER
(
time_t
));

48 
BUILD_ASSERT_DECL
(
TYPE_IS_SIGNED
(
time_t
));

50 
	#TIME_MAX
 
	`TYPE_MAXIMUM
(
time_t
)

	)

51 
	#TIME_MIN
 
	`TYPE_MINIMUM
(
time_t
)

	)

57 
	#TIME_UPDATE_INTERVAL
 100

	)

59 
time_öô
();

60 
time_ª‰esh
();

61 
time_t
 
time_now
();

62 
time_m£c
();

63 
time_Æ¨m
(
£cs
);

64 
time_pﬁl
(
pﬁlfd
 *, 
n_pﬁlfds
, 
timeout
);

	@lib/type-props.h

34 #i‚de‡
TYPE_PROPS_H


35 
	#TYPE_PROPS_H
 1

	)

37 
	~<limôs.h
>

39 
	#TYPE_IS_INTEGER
(
TYPE
Ë((TYPEË1.5 =(TYPEË1)

	)

40 
	#TYPE_IS_SIGNED
(
TYPE
Ë((TYPEË0 > (TYPEË-1)

	)

41 
	#TYPE_VALUE_BITS
(
TYPE
Ë((TYPEË* 
CHAR_BIT
 - 
	`TYPE_IS_SIGNED
(TYPE))

	)

42 
	#TYPE_MINIMUM
(
TYPE
Ë(
	`TYPE_IS_SIGNED
(TYPE) \

43 ? ~(
TYPE
)0 << 
	`TYPE_VALUE_BITS
(TYPE) \

44 : 0)

	)

45 
	#TYPE_MAXIMUM
(
TYPE
Ë(
	`TYPE_IS_SIGNED
(TYPE) \

46 ? ~(~(
TYPE
)0 << 
	`TYPE_VALUE_BITS
(TYPE)) \

47 : (
TYPE
)-1)

	)

	@lib/unaligned.h

17 #i‚de‡
UNALIGNED_H


18 
	#UNALIGNED_H
 1

	)

20 
	~<°döt.h
>

21 
	~"byã-‹dî.h
"

24 
ölöe
 
uöt16_t
 
gë_u«lig√d_u16
(const uint16_t *);

25 
ölöe
 
uöt32_t
 
gë_u«lig√d_u32
(const uint32_t *);

26 
ölöe
 
uöt64_t
 
gë_u«lig√d_u64
(const uint64_t *);

27 
ölöe
 
put_u«lig√d_u16
(
uöt16_t
 *, uint16_t);

28 
ölöe
 
put_u«lig√d_u32
(
uöt32_t
 *, uint32_t);

29 
ölöe
 
put_u«lig√d_u64
(
uöt64_t
 *, uint64_t);

33 
ölöe
 
uöt16_t
 
	$gë_u«lig√d_u16
(c⁄° 
uöt16_t
 *
p_
)

35 c⁄° 
uöt8_t
 *
p
 = (c⁄° uöt8_à*Ë
p_
;

36  
	`¡ohs
((
p
[0] << 8) |Ö[1]);

37 
	}
}

39 
ölöe
 
	$put_u«lig√d_u16
(
uöt16_t
 *
p_
, uöt16_à
x_
)

41 
uöt8_t
 *
p
 = (uöt8_à*Ë
p_
;

42 
uöt16_t
 
x
 = 
	`¡ohs
(
x_
);

44 
p
[0] = 
x
 >> 8;

45 
p
[1] = 
x
;

46 
	}
}

48 
ölöe
 
uöt32_t
 
	$gë_u«lig√d_u32
(c⁄° 
uöt32_t
 *
p_
)

50 c⁄° 
uöt8_t
 *
p
 = (c⁄° uöt8_à*Ë
p_
;

51  
	`¡ohl
((
p
[0] << 24) | (p[1] << 16) | (p[2] << 8) |Ö[3]);

52 
	}
}

54 
ölöe
 
	$put_u«lig√d_u32
(
uöt32_t
 *
p_
, uöt32_à
x_
)

56 
uöt8_t
 *
p
 = (uöt8_à*Ë
p_
;

57 
uöt32_t
 
x
 = 
	`¡ohl
(
x_
);

59 
p
[0] = 
x
 >> 24;

60 
p
[1] = 
x
 >> 16;

61 
p
[2] = 
x
 >> 8;

62 
p
[3] = 
x
;

63 
	}
}

65 
ölöe
 
uöt64_t
 
	$gë_u«lig√d_u64
(c⁄° 
uöt64_t
 *
p_
)

67 c⁄° 
uöt8_t
 *
p
 = (c⁄° uöt8_à*Ë
p_
;

68  
	`¡ohŒ
(((
uöt64_t
Ë
p
[0] << 56)

69 | ((
uöt64_t
Ë
p
[1] << 48)

70 | ((
uöt64_t
Ë
p
[2] << 40)

71 | ((
uöt64_t
Ë
p
[3] << 32)

72 | (
p
[4] << 24)

73 | (
p
[5] << 16)

74 | (
p
[6] << 8)

75 | 
p
[7]);

76 
	}
}

78 
ölöe
 
	$put_u«lig√d_u64
(
uöt64_t
 *
p_
, uöt64_à
x_
)

80 
uöt8_t
 *
p
 = (uöt8_à*Ë
p_
;

81 
uöt64_t
 
x
 = 
	`¡ohŒ
(
x_
);

83 
p
[0] = 
x
 >> 56;

84 
p
[1] = 
x
 >> 48;

85 
p
[2] = 
x
 >> 40;

86 
p
[3] = 
x
 >> 32;

87 
p
[4] = 
x
 >> 24;

88 
p
[5] = 
x
 >> 16;

89 
p
[6] = 
x
 >> 8;

90 
p
[7] = 
x
;

91 
	}
}

	@lib/util.c

34 
	~<c⁄fig.h
>

35 
	~"utû.h
"

36 
	~<î∫o.h
>

37 
	~<°d¨g.h
>

38 
	~<°dio.h
>

39 
	~<°dlib.h
>

40 
	~<°rög.h
>

42 c⁄° *
	g¥ogøm_«me
;

45 
	$out_of_mem‹y
()

47 
	`oÂ_Áèl
(0, "virtual memoryÉxhausted");

48 
	}
}

51 
	$xˇŒoc
(
size_t
 
cou¡
, size_à
size
)

53 *
p
 = 
cou¡
 && 
size
 ? 
	`ˇŒoc
(cou¡, sizeË: 
	`mÆloc
(1);

54 i‡(
p
 =
NULL
) {

55 
	`out_of_mem‹y
();

57  
p
;

58 
	}
}

61 
	$xmÆloc
(
size_t
 
size
)

63 *
p
 = 
	`mÆloc
(
size
 ? size : 1);

64 i‡(
p
 =
NULL
) {

65 
	`out_of_mem‹y
();

67  
p
;

68 
	}
}

71 
	$xªÆloc
(*
p
, 
size_t
 
size
)

73 
p
 = 
	`ªÆloc
’, 
size
 ? size : 1);

74 i‡(
p
 =
NULL
) {

75 
	`out_of_mem‹y
();

77  
p
;

78 
	}
}

81 
	$xmemdup
(c⁄° *
p_
, 
size_t
 
size
)

83 *
p
 = 
	`xmÆloc
(
size
);

84 
	`mem˝y
(
p
, 
p_
, 
size
);

85  
p
;

86 
	}
}

89 
	$xmemdup0
(c⁄° *
p_
, 
size_t
 
Àngth
)

91 *
p
 = 
	`xmÆloc
(
Àngth
 + 1);

92 
	`mem˝y
(
p
, 
p_
, 
Àngth
);

93 
p
[
Àngth
] = '\0';

94  
p
;

95 
	}
}

98 
	$x°rdup
(c⁄° *
s
)

100  
	`xmemdup0
(
s
, 
	`°æí
(s));

101 
	}
}

104 
	$xva•rötf
(c⁄° *
f‹m©
, 
va_li°
 
¨gs
)

106 
va_li°
 
¨gs2
;

107 
size_t
 
√eded
;

108 *
s
;

110 
	`va_c›y
(
¨gs2
, 
¨gs
);

111 
√eded
 = 
	`v¢¥ötf
(
NULL
, 0, 
f‹m©
, 
¨gs
);

113 
s
 = 
	`xmÆloc
(
√eded
 + 1);

115 
	`v¢¥ötf
(
s
, 
√eded
 + 1, 
f‹m©
, 
¨gs2
);

116 
	`va_íd
(
¨gs2
);

118  
s
;

119 
	}
}

122 
	$x2ƒóŒoc
(*
p
, 
size_t
 *
n
, size_à
s
)

124 *
n
 = *n == 0 ? 1 : 2 * *n;

125  
	`xªÆloc
(
p
, *
n
 * 
s
);

126 
	}
}

129 
	$xa•rötf
(c⁄° *
f‹m©
, ...)

131 
va_li°
 
¨gs
;

132 *
s
;

134 
	`va_°¨t
(
¨gs
, 
f‹m©
);

135 
s
 = 
	`xva•rötf
(
f‹m©
, 
¨gs
);

136 
	`va_íd
(
¨gs
);

138  
s
;

139 
	}
}

142 
	$°æ˝y
(*
d°
, c⁄° *
§c
, 
size_t
 
size
)

144 i‡(
size
 > 0) {

145 
size_t
 
n
 = 
	`°æí
(
§c
);

146 
size_t
 
n_c›y
 = 
	`MIN
(
n
, 
size
 - 1);

147 
	`mem˝y
(
d°
, 
§c
, 
n_c›y
);

148 
d°
[
n_c›y
] = '\0';

150 
	}
}

153 
	$oÂ_Áèl
(
îr_no
, c⁄° *
f‹m©
, ...)

155 
va_li°
 
¨gs
;

157 
	`Ârötf
(
°dîr
, "%s: ", 
¥ogøm_«me
);

158 
	`va_°¨t
(
¨gs
, 
f‹m©
);

159 
	`vÂrötf
(
°dîr
, 
f‹m©
, 
¨gs
);

160 
	`va_íd
(
¨gs
);

161 i‡(
îr_no
 != 0)

162 
	`Ârötf
(
°dîr
, " (%s)", 
	`°ªº‹
(
îr_no
));

163 
	`putc
('\n', 
°dîr
);

165 
	`exô
(
EXIT_FAILURE
);

166 
	}
}

169 
	$oÂ_îr‹
(
îr_no
, c⁄° *
f‹m©
, ...)

171 
ßve_î∫o
 = 
î∫o
;

172 
va_li°
 
¨gs
;

174 
	`Ârötf
(
°dîr
, "%s: ", 
¥ogøm_«me
);

175 
	`va_°¨t
(
¨gs
, 
f‹m©
);

176 
	`vÂrötf
(
°dîr
, 
f‹m©
, 
¨gs
);

177 
	`va_íd
(
¨gs
);

178 i‡(
îr_no
 != 0)

179 
	`Ârötf
(
°dîr
, " (%s)", 
	`°ªº‹
(
îr_no
));

180 
	`putc
('\n', 
°dîr
);

182 
î∫o
 = 
ßve_î∫o
;

183 
	}
}

187 
	$£t_¥ogøm_«me
(c⁄° *
¨gv0
)

189 c⁄° *
¶ash
 = 
	`°ºchr
(
¨gv0
, '/');

190 
¥ogøm_«me
 = 
¶ash
 ? sœsh + 1 : 
¨gv0
;

191 
	}
}

198 
	$oÂ_hex_dump
(
FILE
 *
°ªam
, c⁄° *
buf_
, 
size_t
 
size
,

199 
uöçå_t
 
ofs
, 
boﬁ
 
ascii
)

201 c⁄° 
uöt8_t
 *
buf
 = 
buf_
;

202 c⁄° 
size_t
 
≥r_löe
 = 16;

204 
size
 > 0)

206 
size_t
 
°¨t
, 
íd
, 
n
;

207 
size_t
 
i
;

210 
°¨t
 = 
ofs
 % 
≥r_löe
;

211 
íd
 = 
≥r_löe
;

212 i‡(
íd
 - 
°¨t
 > 
size
)

213 
íd
 = 
°¨t
 + 
size
;

214 
n
 = 
íd
 - 
°¨t
;

217 
	`Ârötf
(
°ªam
, "%08jx ", (
uötmax_t
Ë
	`ROUND_DOWN
(
ofs
, 
≥r_löe
));

218 
i
 = 0; i < 
°¨t
; i++)

219 
	`Ârötf
(
°ªam
, " ");

220 ; 
i
 < 
íd
; i++)

221 
	`Ârötf
(
°ªam
, "%02hhx%c",

222 
buf
[
i
 - 
°¨t
], i =
≥r_löe
 / 2 - 1? '-' : ' ');

223 i‡(
ascii
)

225 ; 
i
 < 
≥r_löe
; i++)

226 
	`Ârötf
(
°ªam
, " ");

227 
	`Ârötf
(
°ªam
, "|");

228 
i
 = 0; i < 
°¨t
; i++)

229 
	`Ârötf
(
°ªam
, " ");

230 ; 
i
 < 
íd
; i++) {

231 
c
 = 
buf
[
i
 - 
°¨t
];

232 
	`putc
(
c
 >32 && c < 127 ? c : '.', 
°ªam
);

234 ; 
i
 < 
≥r_löe
; i++)

235 
	`Ârötf
(
°ªam
, " ");

236 
	`Ârötf
(
°ªam
, "|");

238 
	`Ârötf
(
°ªam
, "\n");

240 
ofs
 +
n
;

241 
buf
 +
n
;

242 
size
 -
n
;

244 
	}
}

246 
boﬁ


247 
	$°r_to_öt
(c⁄° *
s
, 
ba£
, *
i
)

249 
Œ
;

250 
boﬁ
 
ok
 = 
	`°r_to_Œ⁄g
(
s
, 
ba£
, &
Œ
);

251 *
i
 = 
Œ
;

252  
ok
;

253 
	}
}

255 
boﬁ


256 
	$°r_to_l⁄g
(c⁄° *
s
, 
ba£
, *
li
)

258 
Œ
;

259 
boﬁ
 
ok
 = 
	`°r_to_Œ⁄g
(
s
, 
ba£
, &
Œ
);

260 *
li
 = 
Œ
;

261  
ok
;

262 
	}
}

264 
boﬁ


265 
	$°r_to_Œ⁄g
(c⁄° *
s
, 
ba£
, *
x
)

267 
ßve_î∫o
 = 
î∫o
;

268 *
èû
;

269 
î∫o
 = 0;

270 *
x
 = 
	`°πﬁl
(
s
, &
èû
, 
ba£
);

271 i‡(
î∫o
 =
EINVAL
 ||Éºnÿ=
ERANGE
 || 
èû
 =
s
 || *tail != '\0') {

272 
î∫o
 = 
ßve_î∫o
;

273 *
x
 = 0;

274  
Ál£
;

276 
î∫o
 = 
ßve_î∫o
;

277  
åue
;

279 
	}
}

281 
boﬁ


282 
	$°r_to_uöt
(c⁄° *
s
, 
ba£
, *
u
)

284  
	`°r_to_öt
(
s
, 
ba£
, (*Ë
u
);

285 
	}
}

287 
boﬁ


288 
	$°r_to_ul⁄g
(c⁄° *
s
, 
ba£
, *
ul
)

290  
	`°r_to_l⁄g
(
s
, 
ba£
, (*Ë
ul
);

291 
	}
}

293 
boﬁ


294 
	$°r_to_uŒ⁄g
(c⁄° *
s
, 
ba£
, *
uŒ
)

296  
	`°r_to_Œ⁄g
(
s
, 
ba£
, (*Ë
uŒ
);

297 
	}
}

	@lib/util.h

34 #i‚de‡
UTIL_H


35 
	#UTIL_H
 1

	)

37 
	~<°d¨g.h
>

38 
	~<°dboﬁ.h
>

39 
	~<°ddef.h
>

40 
	~<°döt.h
>

41 
	~<°dio.h
>

42 
	~<°rög.h
>

43 
	~"c⁄fig.h
"

44 
	~"compûî.h
"

46 #i‚de‡
va_c›y


47 #ifde‡
__va_c›y


48 
	#va_c›y
 
__va_c›y


	)

50 
	#va_c›y
(
d°
, 
§c
Ë((d°Ë(§c))

	)

54 #i‚de‡
__˝lu•lus


56 
	#BUILD_ASSERT
(
EXPR
) \

57 (°ru˘ { 
buûd_as£π_Áûed
 : (
EXPR
Ë? 1 : -1; })

	)

60 
	#BUILD_ASSERT_DECL
(
EXPR
) \

61 (*
	`buûd_as£π
())[
	`BUILD_ASSERT
(
EXPR
)]

	)

63 
	~<boo°/°©ic_as£π.hµ
>

64 
	#BUILD_ASSERT
 
BOOST_STATIC_ASSERT


	)

65 
	#BUILD_ASSERT_DECL
 
BOOST_STATIC_ASSERT


	)

68 c⁄° *
¥ogøm_«me
;

70 
	#ARRAY_SIZE
(
ARRAY
Ë( ARRAY /  *ARRAY)

	)

71 
	#ROUND_UP
(
X
, 
Y
Ë(((XË+ ((YË- 1)Ë/ (YË* (Y))

	)

72 
	#ROUND_DOWN
(
X
, 
Y
Ë((XË/ (YË* (Y))

	)

73 
	#IS_POW2
(
X
Ë((XË&& !((XË& ((XË- 1)))

	)

75 #i‚de‡
MIN


76 
	#MIN
(
X
, 
Y
Ë((XË< (YË? (XË: (Y))

	)

79 #i‚de‡
MAX


80 
	#MAX
(
X
, 
Y
Ë((XË> (YË? (XË: (Y))

	)

83 
	#NOT_REACHED
(Ë
	`ab‹t
()

	)

84 
	#NOT_IMPLEMENTED
(Ë
	`ab‹t
()

	)

85 
	#NOT_TESTED
(Ë((Ë0Ë

	)

89 
	#CONTAINER_OF
(
POINTER
, 
STRUCT
, 
MEMBER
) \

90 ((
STRUCT
 *Ë((*Ë(
POINTER
Ë- 
	`off£tof
 (STRUCT, 
MEMBER
)))

	)

92 #ifde‡ 
__˝lu•lus


96 
£t_¥ogøm_«me
(const *);

98 
out_of_mem‹y
(Ë
NO_RETURN
;

99 *
xmÆloc
(
size_t
Ë
MALLOC_LIKE
;

100 *
xˇŒoc
(
size_t
, size_tË
MALLOC_LIKE
;

101 *
xªÆloc
(*, 
size_t
);

102 *
xmemdup
(c⁄° *, 
size_t
Ë
MALLOC_LIKE
;

103 *
xmemdup0
(c⁄° *, 
size_t
Ë
MALLOC_LIKE
;

104 *
x°rdup
(c⁄° *Ë
MALLOC_LIKE
;

105 *
xa•rötf
(c⁄° *
f‹m©
, ...Ë
PRINTF_FORMAT
(1, 2Ë
MALLOC_LIKE
;

106 *
xva•rötf
(c⁄° *
f‹m©
, 
va_li°
Ë
PRINTF_FORMAT
(1, 0Ë
MALLOC_LIKE
;

107 *
x2ƒóŒoc
(*
p
, 
size_t
 *
n
, size_à
s
);

109 #i‚de‡
HAVE_STRLCPY


110 
°æ˝y
(*
d°
, c⁄° *
§c
, 
size_t
 
size
);

113 
oÂ_Áèl
(
îr_no
, c⁄° *
f‹m©
, ...)

114 
PRINTF_FORMAT
(2, 3Ë
NO_RETURN
;

115 
oÂ_îr‹
(
îr_no
, c⁄° *
f‹m©
, ...Ë
PRINTF_FORMAT
(2, 3);

116 
oÂ_hex_dump
(
FILE
 *, c⁄° *, 
size_t
, 
uöçå_t
 
off£t
, 
boﬁ
 
ascii
);

118 
boﬁ
 
°r_to_öt
(c⁄° *, 
ba£
, *);

119 
boﬁ
 
°r_to_l⁄g
(c⁄° *, 
ba£
, *);

120 
boﬁ
 
°r_to_Œ⁄g
(c⁄° *, 
ba£
, *);

121 
boﬁ
 
°r_to_uöt
(c⁄° *, 
ba£
, *);

122 
boﬁ
 
°r_to_ul⁄g
(c⁄° *, 
ba£
, *);

123 
boﬁ
 
°r_to_uŒ⁄g
(c⁄° *, 
ba£
, *);

125 #ifde‡ 
__˝lu•lus


	@lib/vconn-netlink.c

34 
	~<c⁄fig.h
>

35 
	~"vc⁄n.h
"

36 
	~<¨∑/öë.h
>

37 
	~<as£π.h
>

38 
	~<î∫o.h
>

39 
	~<√tdb.h
>

40 
	~<pﬁl.h
>

41 
	~<√töë/ö.h
>

42 
	~<√töë/t˝.h
>

43 
	~<°dlib.h
>

44 
	~<°rög.h
>

45 
	~<uni°d.h
>

46 
	~"dpif.h
"

47 
	~"√éök.h
"

48 
	~"oÂbuf.h
"

49 
	~"›íÊow/›íÊow-√éök.h
"

50 
	~"›íÊow/›íÊow.h
"

51 
	~"pﬁl-lo›.h
"

52 
	~"sockë-utû.h
"

53 
	~"utû.h
"

54 
	~"vc⁄n-¥ovidî.h
"

56 
	~"vlog.h
"

57 
	#THIS_MODULE
 
VLM_VCONN_NETLINK


	)

59 
	s√éök_vc⁄n


61 
vc⁄n
 
	mvc⁄n
;

62 
dpif
 
	mdp
;

63 
	mdp_idx
;

66 
√éök_vc⁄n
 *

67 
	$√éök_vc⁄n_ˇ°
(
vc⁄n
 *vconn)

69 
	`vc⁄n_as£π_˛ass
(
vc⁄n
, &
√éök_vc⁄n_˛ass
);

70  
	`CONTAINER_OF
(
vc⁄n
, 
√éök_vc⁄n
, vconn);

71 
	}
}

74 
	$√éök_›í
(c⁄° *
«me
, *
suffix
, 
vc⁄n
 **
vc⁄≈
)

76 
√éök_vc⁄n
 *
√éök
;

77 
subs¸ibe
;

78 
dp_idx
;

79 
ªtvÆ
;

81 
subs¸ibe
 = 1;

82 i‡(
	`ssˇnf
(
suffix
, "%d:%d", &
dp_idx
, &
subs¸ibe
) < 1) {

83 
	`oÂ_îr‹
(0, "%s: sy¡axÉº‹", 
«me
);

84  
EAFNOSUPPORT
;

87 
√éök
 = 
	`xmÆloc
( *netlink);

88 
	`vc⁄n_öô
(&
√éök
->
vc⁄n
, &
√éök_vc⁄n_˛ass
, 0, 0, 
«me
, 
åue
);

89 
ªtvÆ
 = 
	`dpif_›í
(
subs¸ibe
 ? 
dp_idx
 : -1, &
√éök
->
dp
);

90 
√éök
->
dp_idx
 = dp_idx;

91 i‡(
ªtvÆ
) {

92 
	`‰ì
(
√éök
);

93 *
vc⁄≈
 = 
NULL
;

94  
ªtvÆ
;

96 *
vc⁄≈
 = &
√éök
->
vc⁄n
;

98 
	}
}

101 
	$√éök_˛o£
(
vc⁄n
 *vconn)

103 
√éök_vc⁄n
 *
√éök
 = 
	`√éök_vc⁄n_ˇ°
(
vc⁄n
);

104 
	`dpif_˛o£
(&
√éök
->
dp
);

105 
	`‰ì
(
√éök
);

106 
	}
}

109 
	$√éök_ªcv
(
vc⁄n
 *vc⁄n, 
oÂbuf
 **
buf„Ω
)

111 
√éök_vc⁄n
 *
√éök
 = 
	`√éök_vc⁄n_ˇ°
(
vc⁄n
);

112  
	`dpif_ªcv_›íÊow
(&
√éök
->
dp
,Çëlök->
dp_idx
, 
buf„Ω
, 
Ál£
);

113 
	}
}

116 
	$√éök_£nd
(
vc⁄n
 *vc⁄n, 
oÂbuf
 *
buf„r
)

118 
√éök_vc⁄n
 *
√éök
 = 
	`√éök_vc⁄n_ˇ°
(
vc⁄n
);

119 
ªtvÆ
 = 
	`dpif_£nd_›íÊow
(&
√éök
->
dp
,Çëlök->
dp_idx
, 
buf„r
);

120 i‡(!
ªtvÆ
) {

121 
	`oÂbuf_dñëe
(
buf„r
);

123  
ªtvÆ
;

124 
	}
}

127 
	$√éök_waô
(
vc⁄n
 *vc⁄n, 
vc⁄n_waô_ty≥
 
waô
)

129 
√éök_vc⁄n
 *
√éök
 = 
	`√éök_vc⁄n_ˇ°
(
vc⁄n
);

130 
evíts
 = 0;

131 
waô
) {

132 
WAIT_CONNECT
:

133 
	`NOT_REACHED
();

135 
WAIT_RECV
:

136 
evíts
 = 
POLLIN
;

139 
WAIT_SEND
:

140 
evíts
 = 0;

144 
	`NOT_REACHED
();

146 
	`∆_sock_waô
(
√éök
->
dp
.
sock
, 
evíts
);

147 
	}
}

149 
vc⁄n_˛ass
 
	g√éök_vc⁄n_˛ass
 = {

151 
√éök_›í
,

152 
√éök_˛o£
,

153 
NULL
,

154 
√éök_ªcv
,

155 
√éök_£nd
,

156 
√éök_waô
,

	@lib/vconn-provider.h

34 #i‚de‡
VCONN_PROVIDER_H


35 
	#VCONN_PROVIDER_H
 1

	)

40 
	~<as£π.h
>

41 
	~<°döt.h
>

42 
	~"oÂ°©.h
"

43 
	~"vc⁄n.h
"

50 
	svc⁄n
 {

51 
vc⁄n_˛ass
 *
	m˛ass
;

52 
	m°©e
;

53 
	mîr‹
;

54 
	mmö_vîsi⁄
;

55 
	mvîsi⁄
;

56 
uöt32_t
 
	mù
;

57 *
	m«me
;

58 
boﬁ
 
	mªc⁄√˘abÀ
;

59 
oÂ°©
 
	moÂs_rcvd
;

60 
oÂ°©
 
	moÂs_£¡
;

63 
vc⁄n_öô
(
vc⁄n
 *, 
vc⁄n_˛ass
 *, 
c⁄√˘_°©us
,

64 
uöt32_t
 
ù
, c⁄° *
«me
, 
boﬁ
 
ªc⁄√˘abÀ
);

65 
ölöe
 
	$vc⁄n_as£π_˛ass
(c⁄° 
vc⁄n
 *vconn,

66 c⁄° 
vc⁄n_˛ass
 *
˛ass
)

68 
	`as£π
(
vc⁄n
->
˛ass
 == class);

69 
	}
}

71 
	svc⁄n_˛ass
 {

73 c⁄° *
	m«me
;

88 (*
	m›í
)(c⁄° *
	m«me
, *
	msuffix
, 
vc⁄n
 **
	mvc⁄≈
);

91 (*
	m˛o£
)(
vc⁄n
 *
	mvc⁄n
);

100 (*
	mc⁄√˘
)(
vc⁄n
 *
	mvc⁄n
);

112 (*
	mªcv
)(
vc⁄n
 *
	mvc⁄n
, 
oÂbuf
 **
	mmsgp
);

124 (*
	m£nd
)(
vc⁄n
 *
	mvc⁄n
, 
oÂbuf
 *
	mmsg
);

128 (*
	mwaô
)(
vc⁄n
 *
	mvc⁄n
, 
vc⁄n_waô_ty≥
 
	mty≥
);

134 
	spvc⁄n
 {

135 
pvc⁄n_˛ass
 *
	m˛ass
;

136 *
	m«me
;

139 
pvc⁄n_öô
(
pvc⁄n
 *, 
pvc⁄n_˛ass
 *, c⁄° *
«me
);

140 
ölöe
 
	$pvc⁄n_as£π_˛ass
(c⁄° 
pvc⁄n
 *pvconn,

141 c⁄° 
pvc⁄n_˛ass
 *
˛ass
)

143 
	`as£π
(
pvc⁄n
->
˛ass
 == class);

144 
	}
}

146 
	spvc⁄n_˛ass
 {

148 c⁄° *
	m«me
;

163 (*
	mli°í
)(c⁄° *
	m«me
, *
	msuffix
, 
pvc⁄n
 **
	mpvc⁄≈
);

166 (*
	m˛o£
)(
pvc⁄n
 *
	mpvc⁄n
);

174 (*
	mac˚±
)(
pvc⁄n
 *
	mpvc⁄n
, 
vc⁄n
 **
	m√w_vc⁄≈
);

178 (*
	mwaô
)(
pvc⁄n
 *
	mpvc⁄n
);

182 
vc⁄n_˛ass
 
t˝_vc⁄n_˛ass
;

183 
pvc⁄n_˛ass
 
±˝_pvc⁄n_˛ass
;

184 
vc⁄n_˛ass
 
unix_vc⁄n_˛ass
;

185 
pvc⁄n_˛ass
 
punix_pvc⁄n_˛ass
;

186 #ifde‡
HAVE_OPENSSL


187 
vc⁄n_˛ass
 
s¶_vc⁄n_˛ass
;

188 
pvc⁄n_˛ass
 
ps¶_pvc⁄n_˛ass
;

190 #ifde‡
HAVE_NETLINK


191 
vc⁄n_˛ass
 
√éök_vc⁄n_˛ass
;

	@lib/vconn-ssl.c

34 
	~<c⁄fig.h
>

35 
	~"vc⁄n-s¶.h
"

36 
	~"dh∑øms.h
"

37 
	~<as£π.h
>

38 
	~<˘y≥.h
>

39 
	~<î∫o.h
>

40 
	~<öây≥s.h
>

41 
	~<°rög.h
>

42 
	~<√töë/t˝.h
>

43 
	~<›ís¶/îr.h
>

44 
	~<›ís¶/s¶.h
>

45 
	~<›ís¶/x509v3.h
>

46 
	~<pﬁl.h
>

47 
	~<sys/f˙é.h
>

48 
	~<sys/°©.h
>

49 
	~<uni°d.h
>

50 
	~"dy«mic-°rög.h
"

51 
	~"Àak-checkî.h
"

52 
	~"oÂbuf.h
"

53 
	~"›íÊow/›íÊow.h
"

54 
	~"∑ckës.h
"

55 
	~"pﬁl-lo›.h
"

56 
	~"sockë-utû.h
"

57 
	~"sockë-utû.h
"

58 
	~"utû.h
"

59 
	~"vc⁄n-¥ovidî.h
"

60 
	~"vc⁄n.h
"

62 
	~"vlog.h
"

63 
	#THIS_MODULE
 
VLM_vc⁄n_s¶


	)

67 
	es¶_°©e
 {

68 
	mSTATE_TCP_CONNECTING
,

69 
	mSTATE_SSL_CONNECTING


72 
	e£ssi⁄_ty≥
 {

73 
	mCLIENT
,

74 
	mSERVER


77 
	ss¶_vc⁄n


79 
vc⁄n
 
	mvc⁄n
;

80 
s¶_°©e
 
	m°©e
;

81 
	mc⁄√˘_îr‹
;

82 
£ssi⁄_ty≥
 
	mty≥
;

83 
	mfd
;

84 
SSL
 *
	ms¶
;

85 
oÂbuf
 *
	mrxbuf
;

86 
oÂbuf
 *
	mtxbuf
;

87 
pﬁl_waôî
 *
	mtx_waôî
;

145 
	mrx_w™t
, 
	mtx_w™t
;

149 
SSL_CTX
 *
	g˘x
;

152 
boﬁ
 
	ghas_¥iv©e_key
, 
	ghas_˚πifiˇã
, 
	ghas_ˇ_˚π
;

163 
boﬁ
 
	gboŸ°øp_ˇ_˚π
;

164 *
	gˇ_˚π_fûe
;

168 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(10, 25);

170 
s¶_öô
();

171 
do_s¶_öô
();

172 
boﬁ
 
s¶_w™ts_io
(
s¶_îr‹
);

173 
s¶_˛o£
(
vc⁄n
 *);

174 
s¶_˛ór_txbuf
(
s¶_vc⁄n
 *);

175 
öãΩªt_s¶_îr‹
(c⁄° *
fun˘i⁄
, 
ªt
, 
îr‹
,

176 *
w™t
);

177 
s¶_tx_pﬁl_ˇŒback
(
fd
, 
ªvíts
, *
vc⁄n_
);

178 
DH
 *
tmp_dh_ˇŒback
(
SSL
 *
s¶
, 
is_exp‹t
 
UNUSED
, 
keyÀngth
);

179 
log_ˇ_˚π
(c⁄° *
fûe_«me
, 
X509
 *
˚π
);

182 
	$w™t_to_pﬁl_evíts
(
w™t
)

184 
w™t
) {

185 
SSL_NOTHING
:

186 
	`NOT_REACHED
();

188 
SSL_READING
:

189  
POLLIN
;

191 
SSL_WRITING
:

192  
POLLOUT
;

195 
	`NOT_REACHED
();

197 
	}
}

200 
	$√w_s¶_vc⁄n
(c⁄° *
«me
, 
fd
, 
£ssi⁄_ty≥
 
ty≥
,

201 
s¶_°©e
 
°©e
, c⁄° 
sockaddr_ö
 *
sö
,

202 
vc⁄n
 **
vc⁄≈
)

204 
s¶_vc⁄n
 *
s¶v
;

205 
SSL
 *
s¶
 = 
NULL
;

206 
⁄
 = 1;

207 
ªtvÆ
;

210 i‡(!
has_¥iv©e_key
) {

211 
	`VLOG_ERR
("Private key must be configuredÅo use SSL");

212 
îr‹
;

214 i‡(!
has_˚πifiˇã
) {

215 
	`VLOG_ERR
("Certificate must be configuredÅo use SSL");

216 
îr‹
;

218 i‡(!
has_ˇ_˚π
 && !
boŸ°øp_ˇ_˚π
) {

219 
	`VLOG_ERR
("CA certificate must be configuredÅo use SSL");

220 
îr‹
;

222 i‡(!
	`SSL_CTX_check_¥iv©e_key
(
˘x
)) {

223 
	`VLOG_ERR
("Private key doesÇot match certificateÖublic key: %s",

224 
	`ERR_îr‹_°rög
(
	`ERR_gë_îr‹
(), 
NULL
));

225 
îr‹
;

229 
ªtvÆ
 = 
	`£tsock›t
(
fd
, 
IPPROTO_TCP
, 
TCP_NODELAY
, &
⁄
,  on);

230 i‡(
ªtvÆ
) {

231 
	`VLOG_ERR
("%s: sësock›t(TCP_NODELAY): %s", 
«me
, 
	`°ªº‹
(
î∫o
));

232 
	`˛o£
(
fd
);

233  
î∫o
;

237 
s¶
 = 
	`SSL_√w
(
˘x
);

238 i‡(
s¶
 =
NULL
) {

239 
	`VLOG_ERR
("SSL_√w: %s", 
	`ERR_îr‹_°rög
(
	`ERR_gë_îr‹
(), 
NULL
));

240 
	`˛o£
(
fd
);

241  
ENOPROTOOPT
;

243 i‡(
	`SSL_£t_fd
(
s¶
, 
fd
) == 0) {

244 
	`VLOG_ERR
("SSL_£t_fd: %s", 
	`ERR_îr‹_°rög
(
	`ERR_gë_îr‹
(), 
NULL
));

245 
îr‹
;

247 i‡(
boŸ°øp_ˇ_˚π
 && 
ty≥
 =
CLIENT
) {

248 
	`SSL_£t_vîify
(
s¶
, 
SSL_VERIFY_NONE
, 
NULL
);

252 
s¶v
 = 
	`xmÆloc
( *sslv);

253 
	`vc⁄n_öô
(&
s¶v
->
vc⁄n
, &
s¶_vc⁄n_˛ass
, 
EAGAIN
, 
sö
->
sö_addr
.
s_addr
,

254 
«me
, 
åue
);

255 
s¶v
->
°©e
 = state;

256 
s¶v
->
ty≥
 =Åype;

257 
s¶v
->
fd
 = fd;

258 
s¶v
->
s¶
 = ssl;

259 
s¶v
->
rxbuf
 = 
NULL
;

260 
s¶v
->
txbuf
 = 
NULL
;

261 
s¶v
->
tx_waôî
 = 
NULL
;

262 
s¶v
->
rx_w™t
 = s¶v->
tx_w™t
 = 
SSL_NOTHING
;

263 *
vc⁄≈
 = &
s¶v
->
vc⁄n
;

266 
îr‹
:

267 i‡(
s¶
) {

268 
	`SSL_‰ì
(
s¶
);

270 
	`˛o£
(
fd
);

271  
ENOPROTOOPT
;

272 
	}
}

274 
s¶_vc⁄n
 *

275 
	$s¶_vc⁄n_ˇ°
(
vc⁄n
 *vconn)

277 
	`vc⁄n_as£π_˛ass
(
vc⁄n
, &
s¶_vc⁄n_˛ass
);

278  
	`CONTAINER_OF
(
vc⁄n
, 
s¶_vc⁄n
, vconn);

279 
	}
}

282 
	$s¶_›í
(c⁄° *
«me
, *
suffix
, 
vc⁄n
 **
vc⁄≈
)

284 *
ßve_±r
, *
ho°_«me
, *
p‹t_°rög
;

285 
sockaddr_ö
 
sö
;

286 
ªtvÆ
;

287 
fd
;

289 
ªtvÆ
 = 
	`s¶_öô
();

290 i‡(
ªtvÆ
) {

291  
ªtvÆ
;

298 
ho°_«me
 = 
	`°πok_r
(
suffix
, "::", &
ßve_±r
);

299 
p‹t_°rög
 = 
	`°πok_r
(
NULL
, "::", &
ßve_±r
);

300 i‡(!
ho°_«me
) {

301 
	`oÂ_îr‹
(0, "%s: badÖì∏«mêf‹m©", 
«me
);

302  
EAFNOSUPPORT
;

305 
	`mem£t
(&
sö
, 0,  sin);

306 
sö
.
sö_Ámûy
 = 
AF_INET
;

307 i‡(
	`lookup_ù
(
ho°_«me
, &
sö
.
sö_addr
)) {

308  
ENOENT
;

310 
sö
.
sö_p‹t
 = 
	`ht⁄s
(
p‹t_°rög
 && *p‹t_°rög ? 
	`©oi
(port_string)

311 : 
OFP_SSL_PORT
);

314 
fd
 = 
	`sockë
(
AF_INET
, 
SOCK_STREAM
, 0);

315 i‡(
fd
 < 0) {

316 
	`VLOG_ERR
("%s: sockë: %s", 
«me
, 
	`°ªº‹
(
î∫o
));

317  
î∫o
;

319 
ªtvÆ
 = 
	`£t_n⁄blockög
(
fd
);

320 i‡(
ªtvÆ
) {

321 
	`˛o£
(
fd
);

322  
ªtvÆ
;

326 
ªtvÆ
 = 
	`c⁄√˘
(
fd
, (
sockaddr
 *Ë&
sö
,  sin);

327 i‡(
ªtvÆ
 < 0) {

328 i‡(
î∫o
 =
EINPROGRESS
) {

329  
	`√w_s¶_vc⁄n
(
«me
, 
fd
, 
CLIENT
, 
STATE_TCP_CONNECTING
,

330 &
sö
, 
vc⁄≈
);

332 
îr‹
 = 
î∫o
;

333 
	`VLOG_ERR
("%s: c⁄√˘: %s", 
«me
, 
	`°ªº‹
(
îr‹
));

334 
	`˛o£
(
fd
);

335  
îr‹
;

338  
	`√w_s¶_vc⁄n
(
«me
, 
fd
, 
CLIENT
, 
STATE_SSL_CONNECTING
,

339 &
sö
, 
vc⁄≈
);

341 
	}
}

344 
	$do_ˇ_˚π_boŸ°øp
(
vc⁄n
 *vconn)

346 
s¶_vc⁄n
 *
s¶v
 = 
	`s¶_vc⁄n_ˇ°
(
vc⁄n
);

347 
	`STACK_OF
(
X509
Ë*
chaö
;

348 
X509
 *
ˇ_˚π
;

349 
FILE
 *
fûe
;

350 
îr‹
;

351 
fd
;

353 
chaö
 = 
	`SSL_gë_≥î_˚π_chaö
(
s¶v
->
s¶
);

354 i‡(!
chaö
 || !
	`sk_X509_num
(chain)) {

355 
	`VLOG_ERR
("couldÇot bootstrap CA cert:Ço certificateÖresented by "

357  
EPROTO
;

359 
ˇ_˚π
 = 
	`sk_X509_vÆue
(
chaö
, 
	`sk_X509_num
(chain) - 1);

363 
îr‹
 = 
	`X509_check_issued
(
ˇ_˚π
, ca_cert);

364 i‡(
îr‹
) {

365 
	`VLOG_ERR
("couldÇot bootstrap CA cert: obtained certificate is "

367 
	`X509_vîify_˚π_îr‹_°rög
(
îr‹
));

368 i‡(
	`sk_X509_num
(
chaö
) < 2) {

369 
	`VLOG_ERR
("only one certificate wasÑeceived, soÖrobablyÅheÖeer "

372  
EPROTO
;

375 
fd
 = 
	`›í
(
ˇ_˚π_fûe
, 
O_CREAT
 | 
O_EXCL
 | 
O_WRONLY
, 0444);

376 i‡(
fd
 < 0) {

377 
	`VLOG_ERR
("couldÇot bootstrap CA cert: creating %s failed: %s",

378 
ˇ_˚π_fûe
, 
	`°ªº‹
(
î∫o
));

379  
î∫o
;

382 
fûe
 = 
	`fd›í
(
fd
, "w");

383 i‡(!
fûe
) {

384 
îr‹
 = 
î∫o
;

385 
	`VLOG_ERR
("couldÇot bootstrap CA cert: fdopen failed: %s",

386 
	`°ªº‹
(
îr‹
));

387 
	`u∆ök
(
ˇ_˚π_fûe
);

388  
îr‹
;

391 i‡(!
	`PEM_wrôe_X509
(
fûe
, 
ˇ_˚π
)) {

392 
	`VLOG_ERR
("couldÇot bootstrap CA cert: PEM_write_X509Åo %s failed: "

393 "%s", 
ˇ_˚π_fûe
, 
	`ERR_îr‹_°rög
(
	`ERR_gë_îr‹
(), 
NULL
));

394 
	`f˛o£
(
fûe
);

395 
	`u∆ök
(
ˇ_˚π_fûe
);

396  
EIO
;

399 i‡(
	`f˛o£
(
fûe
)) {

400 
îr‹
 = 
î∫o
;

401 
	`VLOG_ERR
("couldÇot bootstrap CA cert: writing %s failed: %s",

402 
ˇ_˚π_fûe
, 
	`°ªº‹
(
îr‹
));

403 
	`u∆ök
(
ˇ_˚π_fûe
);

404  
îr‹
;

407 
	`VLOG_INFO
("suc˚ssfuŒy boŸ°øµed CA cîàtÿ%s", 
ˇ_˚π_fûe
);

408 
	`log_ˇ_˚π
(
ˇ_˚π_fûe
, 
ˇ_˚π
);

409 
boŸ°øp_ˇ_˚π
 = 
Ál£
;

410 
has_ˇ_˚π
 = 
åue
;

413 
	`SSL_CTX_add_˛õ¡_CA
(
˘x
, 
ˇ_˚π
);

417 
ˇ_˚π
 = 
	`X509_dup
(ca_cert);

418 i‡(!
ˇ_˚π
) {

419 
	`out_of_mem‹y
();

421 i‡(
	`SSL_CTX_lﬂd_vîify_loˇti⁄s
(
˘x
, 
ˇ_˚π_fûe
, 
NULL
) != 1) {

422 
	`VLOG_ERR
("SSL_CTX_load_verify_locations: %s",

423 
	`ERR_îr‹_°rög
(
	`ERR_gë_îr‹
(), 
NULL
));

424  
EPROTO
;

426 
	`VLOG_INFO
("killing successful connectionÅoÑetry using CA cert");

427  
EPROTO
;

428 
	}
}

431 
	$s¶_c⁄√˘
(
vc⁄n
 *vconn)

433 
s¶_vc⁄n
 *
s¶v
 = 
	`s¶_vc⁄n_ˇ°
(
vc⁄n
);

434 
ªtvÆ
;

436 
s¶v
->
°©e
) {

437 
STATE_TCP_CONNECTING
:

438 
ªtvÆ
 = 
	`check_c⁄√˘i⁄_com∂ëi⁄
(
s¶v
->
fd
);

439 i‡(
ªtvÆ
) {

440  
ªtvÆ
;

442 
s¶v
->
°©e
 = 
STATE_SSL_CONNECTING
;

445 
STATE_SSL_CONNECTING
:

446 
ªtvÆ
 = (
s¶v
->
ty≥
 =
CLIENT


447 ? 
	`SSL_c⁄√˘
(
s¶v
->
s¶
Ë: 
	`SSL_ac˚±
(sslv->ssl));

448 i‡(
ªtvÆ
 != 1) {

449 
îr‹
 = 
	`SSL_gë_îr‹
(
s¶v
->
s¶
, 
ªtvÆ
);

450 i‡(
ªtvÆ
 < 0 && 
	`s¶_w™ts_io
(
îr‹
)) {

451  
EAGAIN
;

453 
unu£d
;

454 
	`öãΩªt_s¶_îr‹
((
s¶v
->
ty≥
 =
CLIENT
 ? "SSL_connect"

455 : "SSL_ac˚±"), 
ªtvÆ
, 
îr‹
, &
unu£d
);

456 
	`shutdown
(
s¶v
->
fd
, 
SHUT_RDWR
);

457  
EPROTO
;

459 } i‡(
boŸ°øp_ˇ_˚π
) {

460  
	`do_ˇ_˚π_boŸ°øp
(
vc⁄n
);

461 } i‡((
	`SSL_gë_vîify_mode
(
s¶v
->
s¶
)

462 & (
SSL_VERIFY_NONE
 | 
SSL_VERIFY_PEER
))

463 !
SSL_VERIFY_PEER
) {

472 
	`VLOG_ERR
("rejecting SSL connection during bootstrapÑace window");

473  
EPROTO
;

479 
	`NOT_REACHED
();

480 
	}
}

483 
	$s¶_˛o£
(
vc⁄n
 *vconn)

485 
s¶_vc⁄n
 *
s¶v
 = 
	`s¶_vc⁄n_ˇ°
(
vc⁄n
);

486 
	`pﬁl_ˇn˚l
(
s¶v
->
tx_waôî
);

487 
	`s¶_˛ór_txbuf
(
s¶v
);

488 
	`oÂbuf_dñëe
(
s¶v
->
rxbuf
);

489 
	`SSL_‰ì
(
s¶v
->
s¶
);

490 
	`˛o£
(
s¶v
->
fd
);

491 
	`‰ì
(
s¶v
);

492 
	}
}

495 
	$öãΩªt_s¶_îr‹
(c⁄° *
fun˘i⁄
, 
ªt
, 
îr‹
,

496 *
w™t
)

498 *
w™t
 = 
SSL_NOTHING
;

500 
îr‹
) {

501 
SSL_ERROR_NONE
:

502 
	`VLOG_ERR_RL
(&
æ
, "%s: u√x≥˘ed SSL_ERROR_NONE", 
fun˘i⁄
);

505 
SSL_ERROR_ZERO_RETURN
:

506 
	`VLOG_ERR_RL
(&
æ
, "%s: u√x≥˘ed SSL_ERROR_ZERO_RETURN", 
fun˘i⁄
);

509 
SSL_ERROR_WANT_READ
:

510 *
w™t
 = 
SSL_READING
;

511  
EAGAIN
;

513 
SSL_ERROR_WANT_WRITE
:

514 *
w™t
 = 
SSL_WRITING
;

515  
EAGAIN
;

517 
SSL_ERROR_WANT_CONNECT
:

518 
	`VLOG_ERR_RL
(&
æ
, "%s: u√x≥˘ed SSL_ERROR_WANT_CONNECT", 
fun˘i⁄
);

521 
SSL_ERROR_WANT_ACCEPT
:

522 
	`VLOG_ERR_RL
(&
æ
, "%s: u√x≥˘ed SSL_ERROR_WANT_ACCEPT", 
fun˘i⁄
);

525 
SSL_ERROR_WANT_X509_LOOKUP
:

526 
	`VLOG_ERR_RL
(&
æ
, "%s: unexpected SSL_ERROR_WANT_X509_LOOKUP",

527 
fun˘i⁄
);

530 
SSL_ERROR_SYSCALL
: {

531 
queued_îr‹
 = 
	`ERR_gë_îr‹
();

532 i‡(
queued_îr‹
 == 0) {

533 i‡(
ªt
 < 0) {

534 
°©us
 = 
î∫o
;

535 
	`VLOG_WARN_RL
(&
æ
, "%s: systemÉrror (%s)",

536 
fun˘i⁄
, 
	`°ªº‹
(
°©us
));

537  
°©us
;

539 
	`VLOG_WARN_RL
(&
æ
, "%s: unexpected SSL connection close",

540 
fun˘i⁄
);

541  
EPROTO
;

544 
	`VLOG_WARN_RL
(&
æ
, "%s: %s",

545 
fun˘i⁄
, 
	`ERR_îr‹_°rög
(
queued_îr‹
, 
NULL
));

550 
SSL_ERROR_SSL
: {

551 
queued_îr‹
 = 
	`ERR_gë_îr‹
();

552 i‡(
queued_îr‹
 != 0) {

553 
	`VLOG_WARN_RL
(&
æ
, "%s: %s",

554 
fun˘i⁄
, 
	`ERR_îr‹_°rög
(
queued_îr‹
, 
NULL
));

556 
	`VLOG_ERR_RL
(&
æ
, "%s: SSL_ERROR_SSL without queuedÉrror",

557 
fun˘i⁄
);

563 
	`VLOG_ERR_RL
(&
æ
, "%s: bad SSLÉº‹ codê%d", 
fun˘i⁄
, 
îr‹
);

566  
EIO
;

567 
	}
}

570 
	$s¶_ªcv
(
vc⁄n
 *vc⁄n, 
oÂbuf
 **
buf„Ω
)

572 
s¶_vc⁄n
 *
s¶v
 = 
	`s¶_vc⁄n_ˇ°
(
vc⁄n
);

573 
oÂbuf
 *
rx
;

574 
size_t
 
w™t_byãs
;

575 
ﬁd_°©e
;

576 
ssize_t
 
ªt
;

578 i‡(
s¶v
->
rxbuf
 =
NULL
) {

579 
s¶v
->
rxbuf
 = 
	`oÂbuf_√w
(1564);

581 
rx
 = 
s¶v
->
rxbuf
;

583 
agaö
:

584 i‡((
oÂ_hódî
Ë> 
rx
->
size
) {

585 
w™t_byãs
 = (
oÂ_hódî
Ë- 
rx
->
size
;

587 
oÂ_hódî
 *
oh
 = 
rx
->
d©a
;

588 
size_t
 
Àngth
 = 
	`¡ohs
(
oh
->length);

589 i‡(
Àngth
 < (
oÂ_hódî
)) {

590 
	`VLOG_ERR_RL
(&
æ
, "receivedÅoo-short ofp_header (%zu bytes)",

591 
Àngth
);

592  
EPROTO
;

594 
w™t_byãs
 = 
Àngth
 - 
rx
->
size
;

595 i‡(!
w™t_byãs
) {

596 *
buf„Ω
 = 
rx
;

597 
s¶v
->
rxbuf
 = 
NULL
;

601 
	`oÂbuf_¥óŒoc_èûroom
(
rx
, 
w™t_byãs
);

604 
	`as£π
(
w™t_byãs
 > 0);

606 
ﬁd_°©e
 = 
	`SSL_gë_°©e
(
s¶v
->
s¶
);

607 
ªt
 = 
	`SSL_ªad
(
s¶v
->
s¶
, 
	`oÂbuf_èû
(
rx
), 
w™t_byãs
);

608 i‡(
ﬁd_°©e
 !
	`SSL_gë_°©e
(
s¶v
->
s¶
)) {

609 
s¶v
->
tx_w™t
 = 
SSL_NOTHING
;

610 i‡(
s¶v
->
tx_waôî
) {

611 
	`pﬁl_ˇn˚l
(
s¶v
->
tx_waôî
);

612 
	`s¶_tx_pﬁl_ˇŒback
(
s¶v
->
fd
, 
POLLIN
, 
vc⁄n
);

615 
s¶v
->
rx_w™t
 = 
SSL_NOTHING
;

617 i‡(
ªt
 > 0) {

618 
rx
->
size
 +
ªt
;

619 i‡(
ªt
 =
w™t_byãs
) {

620 i‡(
rx
->
size
 > (
oÂ_hódî
)) {

621 *
buf„Ω
 = 
rx
;

622 
s¶v
->
rxbuf
 = 
NULL
;

625 
agaö
;

628  
EAGAIN
;

630 
îr‹
 = 
	`SSL_gë_îr‹
(
s¶v
->
s¶
, 
ªt
);

631 i‡(
îr‹
 =
SSL_ERROR_ZERO_RETURN
) {

633 i‡(
rx
->
size
) {

634 
	`VLOG_WARN_RL
(&
æ
, "SSL_read: unexpected connection close");

635  
EPROTO
;

637  
EOF
;

640  
	`öãΩªt_s¶_îr‹
("SSL_ªad", 
ªt
, 
îr‹
, &
s¶v
->
rx_w™t
);

643 
	}
}

646 
	$s¶_˛ór_txbuf
(
s¶_vc⁄n
 *
s¶v
)

648 
	`oÂbuf_dñëe
(
s¶v
->
txbuf
);

649 
s¶v
->
txbuf
 = 
NULL
;

650 
s¶v
->
tx_waôî
 = 
NULL
;

651 
	}
}

654 
	$s¶_ªgi°î_tx_waôî
(
vc⁄n
 *vconn)

656 
s¶_vc⁄n
 *
s¶v
 = 
	`s¶_vc⁄n_ˇ°
(
vc⁄n
);

657 
s¶v
->
tx_waôî
 = 
	`pﬁl_fd_ˇŒback
(s¶v->
fd
,

658 
	`w™t_to_pﬁl_evíts
(
s¶v
->
tx_w™t
),

659 
s¶_tx_pﬁl_ˇŒback
, 
vc⁄n
);

660 
	}
}

663 
	$s¶_do_tx
(
vc⁄n
 *vconn)

665 
s¶_vc⁄n
 *
s¶v
 = 
	`s¶_vc⁄n_ˇ°
(
vc⁄n
);

668 
ﬁd_°©e
 = 
	`SSL_gë_°©e
(
s¶v
->
s¶
);

669 
ªt
 = 
	`SSL_wrôe
(
s¶v
->
s¶
, s¶v->
txbuf
->
d©a
, s¶v->txbuf->
size
);

670 i‡(
ﬁd_°©e
 !
	`SSL_gë_°©e
(
s¶v
->
s¶
)) {

671 
s¶v
->
rx_w™t
 = 
SSL_NOTHING
;

673 
s¶v
->
tx_w™t
 = 
SSL_NOTHING
;

674 i‡(
ªt
 > 0) {

675 
	`oÂbuf_puŒ
(
s¶v
->
txbuf
, 
ªt
);

676 i‡(
s¶v
->
txbuf
->
size
 == 0) {

680 
s¶_îr‹
 = 
	`SSL_gë_îr‹
(
s¶v
->
s¶
, 
ªt
);

681 i‡(
s¶_îr‹
 =
SSL_ERROR_ZERO_RETURN
) {

682 
	`VLOG_WARN_RL
(&
æ
, "SSL_write: connection closed");

683  
EPIPE
;

685  
	`öãΩªt_s¶_îr‹
("SSL_wrôe", 
ªt
, 
s¶_îr‹
,

686 &
s¶v
->
tx_w™t
);

690 
	}
}

693 
	$s¶_tx_pﬁl_ˇŒback
(
fd
 
UNUSED
, 
ªvíts
 UNUSED, *
vc⁄n_
)

695 
vc⁄n
 *vc⁄¿
vc⁄n_
;

696 
s¶_vc⁄n
 *
s¶v
 = 
	`s¶_vc⁄n_ˇ°
(
vc⁄n
);

697 
îr‹
 = 
	`s¶_do_tx
(
vc⁄n
);

698 i‡(
îr‹
 !
EAGAIN
) {

699 
	`s¶_˛ór_txbuf
(
s¶v
);

701 
	`s¶_ªgi°î_tx_waôî
(
vc⁄n
);

703 
	}
}

706 
	$s¶_£nd
(
vc⁄n
 *vc⁄n, 
oÂbuf
 *
buf„r
)

708 
s¶_vc⁄n
 *
s¶v
 = 
	`s¶_vc⁄n_ˇ°
(
vc⁄n
);

710 i‡(
s¶v
->
txbuf
) {

711  
EAGAIN
;

713 
îr‹
;

715 
s¶v
->
txbuf
 = 
buf„r
;

716 
îr‹
 = 
	`s¶_do_tx
(
vc⁄n
);

717 
îr‹
) {

719 
	`s¶_˛ór_txbuf
(
s¶v
);

721 
EAGAIN
:

722 
	`Àak_checkî_˛aim
(
buf„r
);

723 
	`s¶_ªgi°î_tx_waôî
(
vc⁄n
);

726 
s¶v
->
txbuf
 = 
NULL
;

727  
îr‹
;

730 
	}
}

733 
	$s¶_waô
(
vc⁄n
 *vc⁄n, 
vc⁄n_waô_ty≥
 
waô
)

735 
s¶_vc⁄n
 *
s¶v
 = 
	`s¶_vc⁄n_ˇ°
(
vc⁄n
);

737 
waô
) {

738 
WAIT_CONNECT
:

739 i‡(
	`vc⁄n_c⁄√˘
(
vc⁄n
Ë!
EAGAIN
) {

740 
	`pﬁl_immedüã_wake
();

742 
s¶v
->
°©e
) {

743 
STATE_TCP_CONNECTING
:

744 
	`pﬁl_fd_waô
(
s¶v
->
fd
, 
POLLOUT
);

747 
STATE_SSL_CONNECTING
:

750 
	`pﬁl_fd_waô
(
s¶v
->
fd
,

751 
	`w™t_to_pﬁl_evíts
(
	`SSL_w™t
(
s¶v
->
s¶
)));

755 
	`NOT_REACHED
();

760 
WAIT_RECV
:

761 i‡(
s¶v
->
rx_w™t
 !
SSL_NOTHING
) {

762 
	`pﬁl_fd_waô
(
s¶v
->
fd
, 
	`w™t_to_pﬁl_evíts
(s¶v->
rx_w™t
));

764 
	`pﬁl_immedüã_wake
();

768 
WAIT_SEND
:

769 i‡(!
s¶v
->
txbuf
) {

771 
	`pﬁl_immedüã_wake
();

778 
	`NOT_REACHED
();

780 
	}
}

782 
vc⁄n_˛ass
 
	gs¶_vc⁄n_˛ass
 = {

784 
s¶_›í
,

785 
s¶_˛o£
,

786 
s¶_c⁄√˘
,

787 
s¶_ªcv
,

788 
s¶_£nd
,

789 
s¶_waô
,

794 
	sps¶_pvc⁄n


796 
pvc⁄n
 
	mpvc⁄n
;

797 
	mfd
;

800 
pvc⁄n_˛ass
 
	gps¶_pvc⁄n_˛ass
;

802 
ps¶_pvc⁄n
 *

803 
	$ps¶_pvc⁄n_ˇ°
(
pvc⁄n
 *pvconn)

805 
	`pvc⁄n_as£π_˛ass
(
pvc⁄n
, &
ps¶_pvc⁄n_˛ass
);

806  
	`CONTAINER_OF
(
pvc⁄n
, 
ps¶_pvc⁄n
,Övconn);

807 
	}
}

810 
	$ps¶_›í
(c⁄° *
«me
, *
suffix
, 
pvc⁄n
 **
pvc⁄≈
)

812 
sockaddr_ö
 
sö
;

813 
ps¶_pvc⁄n
 *
ps¶
;

814 
ªtvÆ
;

815 
fd
;

816 
yes
 = 1;

818 
ªtvÆ
 = 
	`s¶_öô
();

819 i‡(
ªtvÆ
) {

820  
ªtvÆ
;

824 
fd
 = 
	`sockë
(
AF_INET
, 
SOCK_STREAM
, 0);

825 i‡(
fd
 < 0) {

826 
îr‹
 = 
î∫o
;

827 
	`VLOG_ERR
("%s: sockë: %s", 
«me
, 
	`°ªº‹
(
îr‹
));

828  
îr‹
;

831 i‡(
	`£tsock›t
(
fd
, 
SOL_SOCKET
, 
SO_REUSEADDR
, &
yes
,  yes) < 0) {

832 
îr‹
 = 
î∫o
;

833 
	`VLOG_ERR
("%s: sësock›t(SO_REUSEADDR): %s", 
«me
, 
	`°ªº‹
(
î∫o
));

834  
îr‹
;

837 
	`mem£t
(&
sö
, 0,  sin);

838 
sö
.
sö_Ámûy
 = 
AF_INET
;

839 
sö
.
sö_addr
.
s_addr
 = 
	`ht⁄l
(
INADDR_ANY
);

840 
sö
.
sö_p‹t
 = 
	`ht⁄s
(
	`©oi
(
suffix
Ë?átoi(suffixË: 
OFP_SSL_PORT
);

841 
ªtvÆ
 = 
	`böd
(
fd
, (
sockaddr
 *Ë&
sö
,  sin);

842 i‡(
ªtvÆ
 < 0) {

843 
îr‹
 = 
î∫o
;

844 
	`VLOG_ERR
("%s: böd: %s", 
«me
, 
	`°ªº‹
(
îr‹
));

845 
	`˛o£
(
fd
);

846  
îr‹
;

849 
ªtvÆ
 = 
	`li°í
(
fd
, 10);

850 i‡(
ªtvÆ
 < 0) {

851 
îr‹
 = 
î∫o
;

852 
	`VLOG_ERR
("%s:Üi°í: %s", 
«me
, 
	`°ªº‹
(
îr‹
));

853 
	`˛o£
(
fd
);

854  
îr‹
;

857 
ªtvÆ
 = 
	`£t_n⁄blockög
(
fd
);

858 i‡(
ªtvÆ
) {

859 
	`˛o£
(
fd
);

860  
ªtvÆ
;

863 
ps¶
 = 
	`xmÆloc
( *pssl);

864 
	`pvc⁄n_öô
(&
ps¶
->
pvc⁄n
, &
ps¶_pvc⁄n_˛ass
, 
«me
);

865 
ps¶
->
fd
 = fd;

866 *
pvc⁄≈
 = &
ps¶
->
pvc⁄n
;

868 
	}
}

871 
	$ps¶_˛o£
(
pvc⁄n
 *pvconn)

873 
ps¶_pvc⁄n
 *
ps¶
 = 
	`ps¶_pvc⁄n_ˇ°
(
pvc⁄n
);

874 
	`˛o£
(
ps¶
->
fd
);

875 
	`‰ì
(
ps¶
);

876 
	}
}

879 
	$ps¶_ac˚±
(
pvc⁄n
 *pvc⁄n, 
vc⁄n
 **
√w_vc⁄≈
)

881 
ps¶_pvc⁄n
 *
ps¶
 = 
	`ps¶_pvc⁄n_ˇ°
(
pvc⁄n
);

882 
sockaddr_ö
 
sö
;

883 
sockÀn_t
 
sö_Àn
 =  
sö
;

884 
«me
[128];

885 
√w_fd
;

886 
îr‹
;

888 
√w_fd
 = 
	`ac˚±
(
ps¶
->
fd
, &
sö
, &
sö_Àn
);

889 i‡(
√w_fd
 < 0) {

890 
îr‹
 = 
î∫o
;

891 i‡(
îr‹
 !
EAGAIN
) {

892 
	`VLOG_DBG_RL
(&
æ
, "ac˚±: %s", 
	`°ªº‹
(
îr‹
));

894  
îr‹
;

897 
îr‹
 = 
	`£t_n⁄blockög
(
√w_fd
);

898 i‡(
îr‹
) {

899 
	`˛o£
(
√w_fd
);

900  
îr‹
;

903 
	`•rötf
(
«me
, "s¶:"
IP_FMT
, 
	`IP_ARGS
(&
sö
.
sö_addr
));

904 i‡(
sö
.
sö_p‹t
 !
	`ht⁄s
(
OFP_SSL_PORT
)) {

905 
	`•rötf
(
	`°rchr
(
«me
, '\0'), ":%"
PRIu16
, 
	`¡ohs
(
sö
.
sö_p‹t
));

907  
	`√w_s¶_vc⁄n
(
«me
, 
√w_fd
, 
SERVER
, 
STATE_SSL_CONNECTING
, &
sö
,

908 
√w_vc⁄≈
);

909 
	}
}

912 
	$ps¶_waô
(
pvc⁄n
 *pvconn)

914 
ps¶_pvc⁄n
 *
ps¶
 = 
	`ps¶_pvc⁄n_ˇ°
(
pvc⁄n
);

915 
	`pﬁl_fd_waô
(
ps¶
->
fd
, 
POLLIN
);

916 
	}
}

918 
pvc⁄n_˛ass
 
	gps¶_pvc⁄n_˛ass
 = {

920 
ps¶_›í
,

921 
ps¶_˛o£
,

922 
ps¶_ac˚±
,

923 
ps¶_waô
,

931 
boﬁ


932 
	$s¶_w™ts_io
(
s¶_îr‹
)

934  (
s¶_îr‹
 =
SSL_ERROR_WANT_WRITE


935 || 
s¶_îr‹
 =
SSL_ERROR_WANT_READ
);

936 
	}
}

939 
	$s¶_öô
()

941 
öô_°©us
 = -1;

942 i‡(
öô_°©us
 < 0) {

943 
öô_°©us
 = 
	`do_s¶_öô
();

944 
	`as£π
(
öô_°©us
 >= 0);

946  
öô_°©us
;

947 
	}
}

950 
	$do_s¶_öô
()

952 
SSL_METHOD
 *
mëhod
;

954 
	`SSL_libøry_öô
();

955 
	`SSL_lﬂd_îr‹_°rögs
();

957 
mëhod
 = 
	`TLSv1_mëhod
();

958 i‡(
mëhod
 =
NULL
) {

959 
	`VLOG_ERR
("TLSv1_mëhod: %s", 
	`ERR_îr‹_°rög
(
	`ERR_gë_îr‹
(), 
NULL
));

960  
ENOPROTOOPT
;

963 
˘x
 = 
	`SSL_CTX_√w
(
mëhod
);

964 i‡(
˘x
 =
NULL
) {

965 
	`VLOG_ERR
("SSL_CTX_√w: %s", 
	`ERR_îr‹_°rög
(
	`ERR_gë_îr‹
(), 
NULL
));

966  
ENOPROTOOPT
;

968 
	`SSL_CTX_£t_›ti⁄s
(
˘x
, 
SSL_OP_NO_SSLv2
 | 
SSL_OP_NO_SSLv3
);

969 
	`SSL_CTX_£t_tmp_dh_ˇŒback
(
˘x
, 
tmp_dh_ˇŒback
);

970 
	`SSL_CTX_£t_mode
(
˘x
, 
SSL_MODE_ENABLE_PARTIAL_WRITE
);

971 
	`SSL_CTX_£t_mode
(
˘x
, 
SSL_MODE_ACCEPT_MOVING_WRITE_BUFFER
);

972 
	`SSL_CTX_£t_vîify
(
˘x
, 
SSL_VERIFY_PEER
 | 
SSL_VERIFY_FAIL_IF_NO_PEER_CERT
,

973 
NULL
);

976 
	}
}

978 
DH
 *

979 
	$tmp_dh_ˇŒback
(
SSL
 *
s¶
 
UNUSED
, 
is_exp‹t
 UNUSED, 
keyÀngth
)

981 
	sdh
 {

982 
keyÀngth
;

983 
DH
 *
dh
;

984 
DH
 *(*
c⁄°ru˘‹
)();

987 
dh
 
dh_èbÀ
[] = {

988 {1024, 
NULL
, 
gë_dh1024
},

989 {2048, 
NULL
, 
gë_dh2048
},

990 {4096, 
NULL
, 
gë_dh4096
},

993 
dh
 *dh;

995 
dh
 = 
dh_èbÀ
; dh < &dh_èbÀ[
	`ARRAY_SIZE
(dh_table)]; dh++) {

996 i‡(
dh
->
keyÀngth
 == keylength) {

997 i‡(!
dh
->dh) {

998 
dh
->dh = dh->
	`c⁄°ru˘‹
();

999 i‡(!
dh
->dh) {

1000 
	`oÂ_Áèl
(
ENOMEM
, "out of memory constructing "

1004  
dh
->dh;

1007 
	`VLOG_ERR_RL
(&
æ
, "no Diffie-HellmanÖarameters for keyÜength %d",

1008 
keyÀngth
);

1009  
NULL
;

1010 
	}
}

1013 
boﬁ


1014 
	$vc⁄n_s¶_is_c⁄figuªd
()

1016  
has_¥iv©e_key
 || 
has_˚πifiˇã
 || 
has_ˇ_˚π
;

1017 
	}
}

1020 
	$vc⁄n_s¶_£t_¥iv©e_key_fûe
(c⁄° *
fûe_«me
)

1022 i‡(
	`s¶_öô
()) {

1025 i‡(
	`SSL_CTX_u£_Priv©eKey_fûe
(
˘x
, 
fûe_«me
, 
SSL_FILETYPE_PEM
) != 1) {

1026 
	`VLOG_ERR
("SSL_use_PrivateKey_file: %s",

1027 
	`ERR_îr‹_°rög
(
	`ERR_gë_îr‹
(), 
NULL
));

1030 
has_¥iv©e_key
 = 
åue
;

1031 
	}
}

1034 
	$vc⁄n_s¶_£t_˚πifiˇã_fûe
(c⁄° *
fûe_«me
)

1036 i‡(
	`s¶_öô
()) {

1039 i‡(
	`SSL_CTX_u£_˚πifiˇã_chaö_fûe
(
˘x
, 
fûe_«me
) != 1) {

1040 
	`VLOG_ERR
("SSL_use_certificate_file: %s",

1041 
	`ERR_îr‹_°rög
(
	`ERR_gë_îr‹
(), 
NULL
));

1044 
has_˚πifiˇã
 = 
åue
;

1045 
	}
}

1055 
	$ªad_˚π_fûe
(c⁄° *
fûe_«me
, 
X509
 ***
˚πs
, 
size_t
 *
n_˚πs
)

1057 
FILE
 *
fûe
;

1058 
size_t
 
Æloˇãd_˚πs
 = 0;

1060 *
˚πs
 = 
NULL
;

1061 *
n_˚πs
 = 0;

1063 
fûe
 = 
	`f›í
(
fûe_«me
, "r");

1064 i‡(!
fûe
) {

1065 
	`VLOG_ERR
("failedÅo open %s forÑeading: %s",

1066 
fûe_«me
, 
	`°ªº‹
(
î∫o
));

1067  
î∫o
;

1071 
X509
 *
˚πifiˇã
;

1072 
c
;

1075 
˚πifiˇã
 = 
	`PEM_ªad_X509
(
fûe
, 
NULL
, NULL, NULL);

1076 i‡(!
˚πifiˇã
) {

1077 
size_t
 
i
;

1079 
	`VLOG_ERR
("PEM_read_X509 failedÑeading %s: %s",

1080 
fûe_«me
, 
	`ERR_îr‹_°rög
(
	`ERR_gë_îr‹
(), 
NULL
));

1081 
i
 = 0; i < *
n_˚πs
; i++) {

1082 
	`X509_‰ì
((*
˚πs
)[
i
]);

1084 
	`‰ì
(*
˚πs
);

1085 *
˚πs
 = 
NULL
;

1086 *
n_˚πs
 = 0;

1087  
EIO
;

1091 i‡(*
n_˚πs
 >
Æloˇãd_˚πs
) {

1092 *
˚πs
 = 
	`x2ƒóŒoc
(*˚πs, &
Æloˇãd_˚πs
,  **certs);

1094 (*
˚πs
)[(*
n_˚πs
)++] = 
˚πifiˇã
;

1098 
c
 = 
	`gëc
(
fûe
);

1099 } 
	`is•a˚
(
c
));

1100 i‡(
c
 =
EOF
) {

1103 
	`ungëc
(
c
, 
fûe
);

1105 
	`f˛o£
(
fûe
);

1107 
	}
}

1115 
	$vc⁄n_s¶_£t_≥î_ˇ_˚π_fûe
(c⁄° *
fûe_«me
)

1117 
X509
 **
˚πs
;

1118 
size_t
 
n_˚πs
;

1119 
size_t
 
i
;

1121 i‡(
	`s¶_öô
()) {

1125 i‡(!
	`ªad_˚π_fûe
(
fûe_«me
, &
˚πs
, &
n_˚πs
)) {

1126 
i
 = 0; i < 
n_˚πs
; i++) {

1127 i‡(
	`SSL_CTX_add_exåa_chaö_˚π
(
˘x
, 
˚πs
[
i
]) != 1) {

1128 
	`VLOG_ERR
("SSL_CTX_add_extra_chain_cert: %s",

1129 
	`ERR_îr‹_°rög
(
	`ERR_gë_îr‹
(), 
NULL
));

1132 
	`‰ì
(
˚πs
);

1134 
	}
}

1138 
	$log_ˇ_˚π
(c⁄° *
fûe_«me
, 
X509
 *
˚π
)

1140 
dige°
[
EVP_MAX_MD_SIZE
];

1141 
n_byãs
;

1142 
ds
 
Â
;

1143 *
subje˘
;

1145 
	`ds_öô
(&
Â
);

1146 i‡(!
	`X509_dige°
(
˚π
, 
	`EVP_sha1
(), 
dige°
, &
n_byãs
)) {

1147 
	`ds_put_c°r
(&
Â
, "<out of memory>");

1149 
i
;

1150 
i
 = 0; i < 
n_byãs
; i++) {

1151 i‡(
i
) {

1152 
	`ds_put_ch¨
(&
Â
, ':');

1154 
	`ds_put_f‹m©
(&
Â
, "%02hhx", 
dige°
[
i
]);

1157 
subje˘
 = 
	`X509_NAME_⁄ñöe
(
	`X509_gë_subje˘_«me
(
˚π
), 
NULL
, 0);

1158 
	`VLOG_INFO
("Tru°ög CA cîà‰om %†(%sË(fögî¥öà%s)", 
fûe_«me
,

1159 
subje˘
 ? subje˘ : "<ouào‡mem‹y>", 
	`ds_c°r
(&
Â
));

1160 
	`‰ì
(
subje˘
);

1161 
	`ds_de°roy
(&
Â
);

1162 
	}
}

1170 
	$vc⁄n_s¶_£t_ˇ_˚π_fûe
(c⁄° *
fûe_«me
, 
boﬁ
 
boŸ°øp
)

1172 
X509
 **
˚πs
;

1173 
size_t
 
n_˚πs
;

1174 
°©
 
s
;

1176 i‡(
	`s¶_öô
()) {

1180 i‡(
boŸ°øp
 && 
	`°©
(
fûe_«me
, &
s
Ë&& 
î∫o
 =
ENOENT
) {

1181 
boŸ°øp_ˇ_˚π
 = 
åue
;

1182 
ˇ_˚π_fûe
 = 
	`x°rdup
(
fûe_«me
);

1183 } i‡(!
	`ªad_˚π_fûe
(
fûe_«me
, &
˚πs
, &
n_˚πs
)) {

1184 
size_t
 
i
;

1187 
i
 = 0; i < 
n_˚πs
; i++) {

1189 i‡(
	`SSL_CTX_add_˛õ¡_CA
(
˘x
, 
˚πs
[
i
]) != 1) {

1190 
	`VLOG_ERR
("failedÅoádd client certificate %d from %s: %s",

1191 
i
, 
fûe_«me
,

1192 
	`ERR_îr‹_°rög
(
	`ERR_gë_îr‹
(), 
NULL
));

1194 
	`log_ˇ_˚π
(
fûe_«me
, 
˚πs
[
i
]);

1196 
	`X509_‰ì
(
˚πs
[
i
]);

1201 i‡(
	`SSL_CTX_lﬂd_vîify_loˇti⁄s
(
˘x
, 
fûe_«me
, 
NULL
) != 1) {

1202 
	`VLOG_ERR
("SSL_CTX_load_verify_locations: %s",

1203 
	`ERR_îr‹_°rög
(
	`ERR_gë_îr‹
(), 
NULL
));

1207 
has_ˇ_˚π
 = 
åue
;

1209 
	}
}

	@lib/vconn-ssl.h

33 #i‚de‡
VCONN_SSL_H


34 
	#VCONN_SSL_H
 1

	)

36 
	~<°dboﬁ.h
>

38 #ifde‡
HAVE_OPENSSL


39 
boﬁ
 
vc⁄n_s¶_is_c⁄figuªd
();

40 
vc⁄n_s¶_£t_¥iv©e_key_fûe
(c⁄° *
fûe_«me
);

41 
vc⁄n_s¶_£t_˚πifiˇã_fûe
(c⁄° *
fûe_«me
);

42 
vc⁄n_s¶_£t_ˇ_˚π_fûe
(c⁄° *
fûe_«me
, 
boﬁ
 
boŸ°øp
);

43 
vc⁄n_s¶_£t_≥î_ˇ_˚π_fûe
(c⁄° *
fûe_«me
);

45 
	#VCONN_SSL_LONG_OPTIONS
 \

46 {"¥iv©e-key", 
ªquúed_¨gumít
, 0, 'p'}, \

47 {"˚πifiˇã", 
ªquúed_¨gumít
, 0, 'c'}, \

48 {"ˇ-˚π", 
ªquúed_¨gumít
, 0, 'C'},

	)

50 
	#VCONN_SSL_OPTION_HANDLERS
 \

52 
	`vc⁄n_s¶_£t_¥iv©e_key_fûe
(
›èrg
); \

56 
	`vc⁄n_s¶_£t_˚πifiˇã_fûe
(
›èrg
); \

60 
	`vc⁄n_s¶_£t_ˇ_˚π_fûe
(
›èrg
, 
Ál£
); \

61 ;

	)

63 
ölöe
 
boﬁ
 
	$vc⁄n_s¶_is_c⁄figuªd
()

65  
Ál£
;

66 
	}
}

67 
	#VCONN_SSL_LONG_OPTIONS


	)

68 
	#VCONN_SSL_OPTION_HANDLERS


	)

	@lib/vconn-stream.c

34 
	~<c⁄fig.h
>

35 
	~"vc⁄n-°ªam.h
"

36 
	~<as£π.h
>

37 
	~<î∫o.h
>

38 
	~<pﬁl.h
>

39 
	~<°dlib.h
>

40 
	~<°rög.h
>

41 
	~<sys/ty≥s.h
>

42 
	~<uni°d.h
>

43 
	~"Àak-checkî.h
"

44 
	~"oÂbuf.h
"

45 
	~"›íÊow/›íÊow.h
"

46 
	~"pﬁl-lo›.h
"

47 
	~"sockë-utû.h
"

48 
	~"utû.h
"

49 
	~"vc⁄n-¥ovidî.h
"

50 
	~"vc⁄n.h
"

52 
	~"vlog.h
"

53 
	#LOG_MODULE
 
VLM_vc⁄n_°ªam


	)

57 
	s°ªam_vc⁄n


59 
vc⁄n
 
	mvc⁄n
;

60 
	mfd
;

61 
oÂbuf
 *
	mrxbuf
;

62 
oÂbuf
 *
	mtxbuf
;

63 
pﬁl_waôî
 *
	mtx_waôî
;

66 
vc⁄n_˛ass
 
	g°ªam_vc⁄n_˛ass
;

68 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(10, 25);

70 
°ªam_˛ór_txbuf
(
°ªam_vc⁄n
 *);

73 
	$√w_°ªam_vc⁄n
(c⁄° *
«me
, 
fd
, 
c⁄√˘_°©us
,

74 
uöt32_t
 
ù
, 
boﬁ
 
ªc⁄√˘abÀ
, 
vc⁄n
 **
vc⁄≈
)

76 
°ªam_vc⁄n
 *
s
;

78 
s
 = 
	`xmÆloc
( *s);

79 
	`vc⁄n_öô
(&
s
->
vc⁄n
, &
°ªam_vc⁄n_˛ass
, 
c⁄√˘_°©us
, 
ù
, 
«me
,

80 
ªc⁄√˘abÀ
);

81 
s
->
fd
 = fd;

82 
s
->
txbuf
 = 
NULL
;

83 
s
->
tx_waôî
 = 
NULL
;

84 
s
->
rxbuf
 = 
NULL
;

85 *
vc⁄≈
 = &
s
->
vc⁄n
;

87 
	}
}

89 
°ªam_vc⁄n
 *

90 
	$°ªam_vc⁄n_ˇ°
(
vc⁄n
 *vconn)

92 
	`vc⁄n_as£π_˛ass
(
vc⁄n
, &
°ªam_vc⁄n_˛ass
);

93  
	`CONTAINER_OF
(
vc⁄n
, 
°ªam_vc⁄n
, vconn);

94 
	}
}

97 
	$°ªam_˛o£
(
vc⁄n
 *vconn)

99 
°ªam_vc⁄n
 *
s
 = 
	`°ªam_vc⁄n_ˇ°
(
vc⁄n
);

100 
	`pﬁl_ˇn˚l
(
s
->
tx_waôî
);

101 
	`°ªam_˛ór_txbuf
(
s
);

102 
	`oÂbuf_dñëe
(
s
->
rxbuf
);

103 
	`˛o£
(
s
->
fd
);

104 
	`‰ì
(
s
);

105 
	}
}

108 
	$°ªam_c⁄√˘
(
vc⁄n
 *vconn)

110 
°ªam_vc⁄n
 *
s
 = 
	`°ªam_vc⁄n_ˇ°
(
vc⁄n
);

111  
	`check_c⁄√˘i⁄_com∂ëi⁄
(
s
->
fd
);

112 
	}
}

115 
	$°ªam_ªcv
(
vc⁄n
 *vc⁄n, 
oÂbuf
 **
buf„Ω
)

117 
°ªam_vc⁄n
 *
s
 = 
	`°ªam_vc⁄n_ˇ°
(
vc⁄n
);

118 
oÂbuf
 *
rx
;

119 
size_t
 
w™t_byãs
;

120 
ssize_t
 
ªtvÆ
;

122 i‡(
s
->
rxbuf
 =
NULL
) {

123 
s
->
rxbuf
 = 
	`oÂbuf_√w
(1564);

125 
rx
 = 
s
->
rxbuf
;

127 
agaö
:

128 i‡((
oÂ_hódî
Ë> 
rx
->
size
) {

129 
w™t_byãs
 = (
oÂ_hódî
Ë- 
rx
->
size
;

131 
oÂ_hódî
 *
oh
 = 
rx
->
d©a
;

132 
size_t
 
Àngth
 = 
	`¡ohs
(
oh
->length);

133 i‡(
Àngth
 < (
oÂ_hódî
)) {

134 
	`VLOG_ERR_RL
(
LOG_MODULE
, &
æ
, "receivedÅoo-short ofp_header (%zu bytes)",

135 
Àngth
);

136  
EPROTO
;

138 
w™t_byãs
 = 
Àngth
 - 
rx
->
size
;

139 i‡(!
w™t_byãs
) {

140 *
buf„Ω
 = 
rx
;

141 
s
->
rxbuf
 = 
NULL
;

145 
	`oÂbuf_¥óŒoc_èûroom
(
rx
, 
w™t_byãs
);

147 
ªtvÆ
 = 
	`ªad
(
s
->
fd
, 
	`oÂbuf_èû
(
rx
), 
w™t_byãs
);

148 i‡(
ªtvÆ
 > 0) {

149 
rx
->
size
 +
ªtvÆ
;

150 i‡(
ªtvÆ
 =
w™t_byãs
) {

151 i‡(
rx
->
size
 > (
oÂ_hódî
)) {

152 *
buf„Ω
 = 
rx
;

153 
s
->
rxbuf
 = 
NULL
;

156 
agaö
;

159  
EAGAIN
;

160 } i‡(
ªtvÆ
 == 0) {

161 i‡(
rx
->
size
) {

162 
	`VLOG_ERR_RL
(
LOG_MODULE
, &
æ
, "connection dropped mid-packet");

163  
EPROTO
;

165  
EOF
;

168  
î∫o
;

170 
	}
}

173 
	$°ªam_˛ór_txbuf
(
°ªam_vc⁄n
 *
s
)

175 
	`oÂbuf_dñëe
(
s
->
txbuf
);

176 
s
->
txbuf
 = 
NULL
;

177 
s
->
tx_waôî
 = 
NULL
;

178 
	}
}

181 
	$°ªam_do_tx
(
fd
 
UNUSED
, 
ªvíts
 UNUSED, *
vc⁄n_
)

183 
vc⁄n
 *vc⁄¿
vc⁄n_
;

184 
°ªam_vc⁄n
 *
s
 = 
	`°ªam_vc⁄n_ˇ°
(
vc⁄n
);

185 
ssize_t
 
n
 = 
	`wrôe
(
s
->
fd
, s->
txbuf
->
d©a
, s->txbuf->
size
);

186 i‡(
n
 < 0) {

187 i‡(
î∫o
 !
EAGAIN
) {

188 
	`VLOG_ERR_RL
(
LOG_MODULE
, &
æ
, "£nd: %s", 
	`°ªº‹
(
î∫o
));

189 
	`°ªam_˛ór_txbuf
(
s
);

192 } i‡(
n
 > 0) {

193 
	`oÂbuf_puŒ
(
s
->
txbuf
, 
n
);

194 i‡(!
s
->
txbuf
->
size
) {

195 
	`°ªam_˛ór_txbuf
(
s
);

199 
s
->
tx_waôî
 = 
	`pﬁl_fd_ˇŒback
(s->
fd
, 
POLLOUT
, 
°ªam_do_tx
, 
vc⁄n
);

200 
	}
}

203 
	$°ªam_£nd
(
vc⁄n
 *vc⁄n, 
oÂbuf
 *
buf„r
)

205 
°ªam_vc⁄n
 *
s
 = 
	`°ªam_vc⁄n_ˇ°
(
vc⁄n
);

206 
ssize_t
 
ªtvÆ
;

208 i‡(
s
->
txbuf
) {

209  
EAGAIN
;

212 
ªtvÆ
 = 
	`wrôe
(
s
->
fd
, 
buf„r
->
d©a
, buf„r->
size
);

213 i‡(
ªtvÆ
 =
buf„r
->
size
) {

214 
	`oÂbuf_dñëe
(
buf„r
);

216 } i‡(
ªtvÆ
 >0 || 
î∫o
 =
EAGAIN
) {

217 
	`Àak_checkî_˛aim
(
buf„r
);

218 
s
->
txbuf
 = 
buf„r
;

219 i‡(
ªtvÆ
 > 0) {

220 
	`oÂbuf_puŒ
(
buf„r
, 
ªtvÆ
);

222 
s
->
tx_waôî
 = 
	`pﬁl_fd_ˇŒback
(s->
fd
, 
POLLOUT
, 
°ªam_do_tx
, 
vc⁄n
);

225  
î∫o
;

227 
	}
}

230 
	$°ªam_waô
(
vc⁄n
 *vc⁄n, 
vc⁄n_waô_ty≥
 
waô
)

232 
°ªam_vc⁄n
 *
s
 = 
	`°ªam_vc⁄n_ˇ°
(
vc⁄n
);

233 
waô
) {

234 
WAIT_CONNECT
:

235 
	`pﬁl_fd_waô
(
s
->
fd
, 
POLLOUT
);

238 
WAIT_SEND
:

239 i‡(!
s
->
txbuf
) {

240 
	`pﬁl_fd_waô
(
s
->
fd
, 
POLLOUT
);

246 
WAIT_RECV
:

247 
	`pﬁl_fd_waô
(
s
->
fd
, 
POLLIN
);

251 
	`NOT_REACHED
();

253 
	}
}

255 
vc⁄n_˛ass
 
	g°ªam_vc⁄n_˛ass
 = {

257 
NULL
,

258 
°ªam_˛o£
,

259 
°ªam_c⁄√˘
,

260 
°ªam_ªcv
,

261 
°ªam_£nd
,

262 
°ªam_waô
,

267 
	sp°ªam_pvc⁄n


269 
pvc⁄n
 
	mpvc⁄n
;

270 
	mfd
;

271 (*
	mac˚±_cb
)(
	mfd
, c⁄° 
	msockaddr
 *, 
size_t
 
	mß_Àn
,

272 
	mvc⁄n
 **);

275 
pvc⁄n_˛ass
 
	gp°ªam_pvc⁄n_˛ass
;

277 
p°ªam_pvc⁄n
 *

278 
	$p°ªam_pvc⁄n_ˇ°
(
pvc⁄n
 *pvconn)

280 
	`pvc⁄n_as£π_˛ass
(
pvc⁄n
, &
p°ªam_pvc⁄n_˛ass
);

281  
	`CONTAINER_OF
(
pvc⁄n
, 
p°ªam_pvc⁄n
,Övconn);

282 
	}
}

285 
√w_p°ªam_pvc⁄n
(c⁄° *
«me
, 
fd
,

286 (*
ac˚±_cb
)(
fd
, c⁄° 
sockaddr
 *,

287 
size_t
 
ß_Àn
, 
vc⁄n
 **),

288 
pvc⁄n
 **
pvc⁄≈
)

290 
p°ªam_pvc⁄n
 *
ps
;

291 
ªtvÆ
;

293 
ªtvÆ
 = 
	`£t_n⁄blockög
(
fd
);

294 i‡(
ªtvÆ
) {

295 
	`˛o£
(
fd
);

296  
ªtvÆ
;

299 i‡(
	`li°í
(
fd
, 10) < 0) {

300 
îr‹
 = 
î∫o
;

301 
	`VLOG_ERR
(
LOG_MODULE
, "%s:Üi°í: %s", 
«me
, 
	`°ªº‹
(
îr‹
));

302 
	`˛o£
(
fd
);

303  
îr‹
;

306 
ps
 = 
	`xmÆloc
( *ps);

307 
	`pvc⁄n_öô
(&
ps
->
pvc⁄n
, &
p°ªam_pvc⁄n_˛ass
, 
«me
);

308 
ps
->
fd
 = fd;

309 
ps
->
ac˚±_cb
 =áccept_cb;

310 *
pvc⁄≈
 = &
ps
->
pvc⁄n
;

312 
	}
}

315 
	$p°ªam_˛o£
(
pvc⁄n
 *pvconn)

317 
p°ªam_pvc⁄n
 *
ps
 = 
	`p°ªam_pvc⁄n_ˇ°
(
pvc⁄n
);

318 
	`˛o£
(
ps
->
fd
);

319 
	`‰ì
(
ps
);

320 
	}
}

323 
	$p°ªam_ac˚±
(
pvc⁄n
 *pvc⁄n, 
vc⁄n
 **
√w_vc⁄≈
)

325 
p°ªam_pvc⁄n
 *
ps
 = 
	`p°ªam_pvc⁄n_ˇ°
(
pvc⁄n
);

326 
sockaddr_°‹age
 
ss
;

327 
sockÀn_t
 
ss_Àn
 =  
ss
;

328 
√w_fd
;

329 
ªtvÆ
;

331 
√w_fd
 = 
	`ac˚±
(
ps
->
fd
, (
sockaddr
 *Ë&
ss
, &
ss_Àn
);

332 i‡(
√w_fd
 < 0) {

333 
ªtvÆ
 = 
î∫o
;

334 i‡(
ªtvÆ
 !
EAGAIN
) {

335 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "ac˚±: %s", 
	`°ªº‹
(
ªtvÆ
));

337  
ªtvÆ
;

340 
ªtvÆ
 = 
	`£t_n⁄blockög
(
√w_fd
);

341 i‡(
ªtvÆ
) {

342 
	`˛o£
(
√w_fd
);

343  
ªtvÆ
;

346  
ps
->
	`ac˚±_cb
(
√w_fd
, (c⁄° 
sockaddr
 *Ë&
ss
, 
ss_Àn
,

347 
√w_vc⁄≈
);

348 
	}
}

351 
	$p°ªam_waô
(
pvc⁄n
 *pvconn)

353 
p°ªam_pvc⁄n
 *
ps
 = 
	`p°ªam_pvc⁄n_ˇ°
(
pvc⁄n
);

354 
	`pﬁl_fd_waô
(
ps
->
fd
, 
POLLIN
);

355 
	}
}

357 
pvc⁄n_˛ass
 
	gp°ªam_pvc⁄n_˛ass
 = {

359 
NULL
,

360 
p°ªam_˛o£
,

361 
p°ªam_ac˚±
,

362 
p°ªam_waô


	@lib/vconn-stream.h

34 #i‚de‡
VCONN_STREAM_H


35 
	#VCONN_STREAM_H
 1

	)

37 
	~<°dboﬁ.h
>

38 
	~<°ddef.h
>

39 
	~<°döt.h
>

41 
	gvc⁄n
;

42 
	gpvc⁄n
;

43 
	gsockaddr
;

45 
√w_°ªam_vc⁄n
(c⁄° *
«me
, 
fd
, 
c⁄√˘_°©us
,

46 
uöt32_t
 
ù
, 
boﬁ
 
ªc⁄√˘abÀ
, 
vc⁄n
 **
vc⁄≈
);

47 
√w_p°ªam_pvc⁄n
(c⁄° *
«me
, 
fd
,

48 (*
ac˚±_cb
)(
fd
, c⁄° 
sockaddr
 *,

49 
size_t
 
ß_Àn
, 
vc⁄n
 **),

50 
pvc⁄n
 **
pvc⁄≈
);

	@lib/vconn-tcp.c

34 
	~<c⁄fig.h
>

35 
	~"vc⁄n.h
"

36 
	~<î∫o.h
>

37 
	~<öây≥s.h
>

38 
	~<sys/ty≥s.h
>

39 
	~<√töë/ö.h
>

40 
	~<√töë/t˝.h
>

41 
	~<°dlib.h
>

42 
	~<°rög.h
>

43 
	~<uni°d.h
>

44 
	~"∑ckës.h
"

45 
	~"sockë-utû.h
"

46 
	~"utû.h
"

47 
	~"›íÊow/›íÊow.h
"

48 
	~"vc⁄n-¥ovidî.h
"

49 
	~"vc⁄n-°ªam.h
"

51 
	~"vlog.h
"

52 
	#LOG_MODULE
 
VLM_vc⁄n_t˝


	)

57 
	$√w_t˝_vc⁄n
(c⁄° *
«me
, 
fd
, 
c⁄√˘_°©us
,

58 c⁄° 
sockaddr_ö
 *
sö
, 
vc⁄n
 **
vc⁄≈
)

60 
⁄
 = 1;

61 
ªtvÆ
;

63 
ªtvÆ
 = 
	`£tsock›t
(
fd
, 
IPPROTO_TCP
, 
TCP_NODELAY
, &
⁄
,  on);

64 i‡(
ªtvÆ
) {

65 
	`VLOG_ERR
(
LOG_MODULE
, "%s: sësock›t(TCP_NODELAY): %s", 
«me
, 
	`°ªº‹
(
î∫o
));

66 
	`˛o£
(
fd
);

67  
î∫o
;

70  
	`√w_°ªam_vc⁄n
(
«me
, 
fd
, 
c⁄√˘_°©us
, 
sö
->
sö_addr
.
s_addr
,

71 
åue
, 
vc⁄≈
);

72 
	}
}

75 
	$t˝_›í
(c⁄° *
«me
, *
suffix
, 
vc⁄n
 **
vc⁄≈
)

77 *
ßve_±r
;

78 c⁄° *
ho°_«me
;

79 c⁄° *
p‹t_°rög
;

80 
sockaddr_ö
 
sö
;

81 
ªtvÆ
;

82 
fd
;

88 
ho°_«me
 = 
	`°πok_r
(
suffix
, "::", &
ßve_±r
);

89 
p‹t_°rög
 = 
	`°πok_r
(
NULL
, "::", &
ßve_±r
);

90 i‡(!
ho°_«me
) {

91 
	`oÂ_îr‹
(0, "%s: badÖì∏«mêf‹m©", 
«me
);

92  
EAFNOSUPPORT
;

95 
	`mem£t
(&
sö
, 0,  sin);

96 
sö
.
sö_Ámûy
 = 
AF_INET
;

97 i‡(
	`lookup_ù
(
ho°_«me
, &
sö
.
sö_addr
)) {

98  
ENOENT
;

100 
sö
.
sö_p‹t
 = 
	`ht⁄s
(
p‹t_°rög
 ? 
	`©oi
’‹t_°rögË: 
OFP_TCP_PORT
);

102 
fd
 = 
	`sockë
(
AF_INET
, 
SOCK_STREAM
, 0);

103 i‡(
fd
 < 0) {

104 
	`VLOG_ERR
(
LOG_MODULE
, "%s: sockë: %s", 
«me
, 
	`°ªº‹
(
î∫o
));

105  
î∫o
;

108 
ªtvÆ
 = 
	`£t_n⁄blockög
(
fd
);

109 i‡(
ªtvÆ
) {

110 
	`˛o£
(
fd
);

111  
ªtvÆ
;

114 
ªtvÆ
 = 
	`c⁄√˘
(
fd
, (
sockaddr
 *Ë&
sö
,  sin);

115 i‡(
ªtvÆ
 < 0) {

116 i‡(
î∫o
 =
EINPROGRESS
) {

117  
	`√w_t˝_vc⁄n
(
«me
, 
fd
, 
EAGAIN
, &
sö
, 
vc⁄≈
);

119 
îr‹
 = 
î∫o
;

120 
	`VLOG_ERR
(
LOG_MODULE
, "%s: c⁄√˘: %s", 
«me
, 
	`°ªº‹
(
îr‹
));

121 
	`˛o£
(
fd
);

122  
îr‹
;

125  
	`√w_t˝_vc⁄n
(
«me
, 
fd
, 0, &
sö
, 
vc⁄≈
);

127 
	}
}

129 
vc⁄n_˛ass
 
	gt˝_vc⁄n_˛ass
 = {

131 
t˝_›í
,

132 
NULL
,

133 
NULL
,

134 
NULL
,

135 
NULL
,

136 
NULL
,

141 
±˝_ac˚±
(
fd
, c⁄° 
sockaddr
 *
ß
, 
size_t
 
ß_Àn
,

142 
vc⁄n
 **
vc⁄≈
);

145 
	$±˝_›í
(c⁄° *
«me
, *
suffix
, 
pvc⁄n
 **
pvc⁄≈
)

147 
sockaddr_ö
 
sö
;

148 
ªtvÆ
;

149 
fd
;

150 
yes
 = 1;

152 
fd
 = 
	`sockë
(
AF_INET
, 
SOCK_STREAM
, 0);

153 i‡(
fd
 < 0) {

154 
	`VLOG_ERR
(
LOG_MODULE
, "%s: sockë: %s", 
«me
, 
	`°ªº‹
(
î∫o
));

155  
î∫o
;

158 i‡(
	`£tsock›t
(
fd
, 
SOL_SOCKET
, 
SO_REUSEADDR
, &
yes
,  yes) < 0) {

159 
	`VLOG_ERR
(
LOG_MODULE
, "%s: sësock›t(SO_REUSEADDR): %s", 
«me
, 
	`°ªº‹
(
î∫o
));

160  
î∫o
;

163 
	`mem£t
(&
sö
, 0,  sin);

164 
sö
.
sö_Ámûy
 = 
AF_INET
;

165 
sö
.
sö_addr
.
s_addr
 = 
	`ht⁄l
(
INADDR_ANY
);

166 
sö
.
sö_p‹t
 = 
	`ht⁄s
(
	`©oi
(
suffix
Ë?átoi(suffixË: 
OFP_TCP_PORT
);

167 
ªtvÆ
 = 
	`böd
(
fd
, (
sockaddr
 *Ë&
sö
,  sin);

168 i‡(
ªtvÆ
 < 0) {

169 
îr‹
 = 
î∫o
;

170 
	`VLOG_ERR
(
LOG_MODULE
, "%s: böd: %s", 
«me
, 
	`°ªº‹
(
îr‹
));

171 
	`˛o£
(
fd
);

172  
îr‹
;

175  
	`√w_p°ªam_pvc⁄n
("±˝", 
fd
, 
±˝_ac˚±
, 
pvc⁄≈
);

176 
	}
}

179 
	$±˝_ac˚±
(
fd
, c⁄° 
sockaddr
 *
ß
, 
size_t
 
ß_Àn
,

180 
vc⁄n
 **
vc⁄≈
)

182 c⁄° 
sockaddr_ö
 *
sö
 = (c⁄° sockaddr_ö *Ë
ß
;

183 
«me
[128];

185 i‡(
ß_Àn
 =(
sockaddr_ö
Ë&& 
sö
->
sö_Ámûy
 =
AF_INET
) {

186 
	`•rötf
(
«me
, "t˝:"
IP_FMT
, 
	`IP_ARGS
(&
sö
->
sö_addr
));

187 i‡(
sö
->
sö_p‹t
 !
	`ht⁄s
(
OFP_TCP_PORT
)) {

188 
	`•rötf
(
	`°rchr
(
«me
, '\0'), ":%"
PRIu16
, 
	`¡ohs
(
sö
->
sö_p‹t
));

191 
	`°r˝y
(
«me
, "tcp");

193  
	`√w_t˝_vc⁄n
(
«me
, 
fd
, 0, 
sö
, 
vc⁄≈
);

194 
	}
}

196 
pvc⁄n_˛ass
 
	g±˝_pvc⁄n_˛ass
 = {

198 
±˝_›í
,

199 
NULL
,

200 
NULL
,

201 
NULL


	@lib/vconn-unix.c

34 
	~<c⁄fig.h
>

35 
	~"vc⁄n.h
"

36 
	~<as£π.h
>

37 
	~<î∫o.h
>

38 
	~<öây≥s.h
>

39 
	~<√tdb.h
>

40 
	~<pﬁl.h
>

41 
	~<sys/ty≥s.h
>

42 
	~<sys/un.h
>

43 
	~<°dlib.h
>

44 
	~<°rög.h
>

45 
	~<uni°d.h
>

46 
	~"oÂbuf.h
"

47 
	~"›íÊow/›íÊow.h
"

48 
	~"∑ckës.h
"

49 
	~"pﬁl-lo›.h
"

50 
	~"sockë-utû.h
"

51 
	~"utû.h
"

52 
	~"vc⁄n-¥ovidî.h
"

53 
	~"vc⁄n-°ªam.h
"

55 
	~"vlog.h
"

56 
	#LOG_MODULE
 
VLM_vc⁄n_unix


	)

61 
	gn_unix_sockës
;

64 
	$unix_›í
(c⁄° *
«me
, *
suffix
, 
vc⁄n
 **
vc⁄≈
)

66 c⁄° *
c⁄√˘_∑th
 = 
suffix
;

67 
böd_∑th
[128];

68 
fd
;

70 
	`•rötf
(
böd_∑th
, "/tmp/vconn-unix.%ld.%d",

71 (Ë
	`gëpid
(), 
n_unix_sockës
++);

72 
fd
 = 
	`make_unix_sockë
(
SOCK_STREAM
, 
åue
, 
Ál£
, 
böd_∑th
, 
c⁄√˘_∑th
);

73 i‡(
fd
 < 0) {

74 
	`VLOG_ERR
(
LOG_MODULE
, "%s: connectionÅo %s failed: %s",

75 
böd_∑th
, 
c⁄√˘_∑th
, 
	`°ªº‹
(-
fd
));

76  -
fd
;

79  
	`√w_°ªam_vc⁄n
(
«me
, 
fd
, 
	`check_c⁄√˘i⁄_com∂ëi⁄
(fd),

80 0, 
åue
, 
vc⁄≈
);

81 
	}
}

83 
vc⁄n_˛ass
 
	gunix_vc⁄n_˛ass
 = {

85 
unix_›í
,

86 
NULL
,

87 
NULL
,

88 
NULL
,

89 
NULL
,

90 
NULL
,

95 
punix_ac˚±
(
fd
, c⁄° 
sockaddr
 *
ß
, 
size_t
 
ß_Àn
,

96 
vc⁄n
 **
vc⁄≈
);

99 
	$punix_›í
(c⁄° *
«me
 
UNUSED
, *
suffix
, 
pvc⁄n
 **
pvc⁄≈
)

101 
fd
;

103 
fd
 = 
	`make_unix_sockë
(
SOCK_STREAM
, 
åue
,Årue, 
suffix
, 
NULL
);

104 i‡(
fd
 < 0) {

105 
	`VLOG_ERR
(
LOG_MODULE
, "%s: bödög faûed: %s", 
suffix
, 
	`°ªº‹
(
î∫o
));

106  
î∫o
;

109  
	`√w_p°ªam_pvc⁄n
("punix", 
fd
, 
punix_ac˚±
, 
pvc⁄≈
);

110 
	}
}

113 
	$punix_ac˚±
(
fd
, c⁄° 
sockaddr
 *
ß
, 
size_t
 
ß_Àn
,

114 
vc⁄n
 **
vc⁄≈
)

116 c⁄° 
sockaddr_un
 *
sun
 = (c⁄° sockaddr_u¿*Ë
ß
;

117 
«me_Àn
 = 
	`gë_unix_«me_Àn
(
ß_Àn
);

118 
«me
[128];

120 i‡(
«me_Àn
 > 0) {

121 
	`¢¥ötf
(
«me
, Çame, "unix:%.*s", 
«me_Àn
, 
sun
->
sun_∑th
);

123 
	`°r˝y
(
«me
, "unix");

125  
	`√w_°ªam_vc⁄n
(
«me
, 
fd
, 0, 0, 
åue
, 
vc⁄≈
);

126 
	}
}

128 
pvc⁄n_˛ass
 
	gpunix_pvc⁄n_˛ass
 = {

130 
punix_›í
,

131 
NULL
,

132 
NULL
,

133 
NULL


	@lib/vconn.c

34 
	~<c⁄fig.h
>

35 
	~"vc⁄n-¥ovidî.h
"

36 
	~<as£π.h
>

37 
	~<î∫o.h
>

38 
	~<öây≥s.h
>

39 
	~<√töë/ö.h
>

40 
	~<pﬁl.h
>

41 
	~<°dlib.h
>

42 
	~<°rög.h
>

43 
	~"dy«mic-°rög.h
"

44 
	~"oÂ.h
"

45 
	~"oÂbuf.h
"

46 
	~"›íÊow/›íÊow.h
"

47 
	~"pﬁl-lo›.h
"

48 
	~"øndom.h
"

49 
	~"utû.h
"

50 
	~"oÊib/oÊ.h
"

51 
	~"oÊib/oÊ-mesßges.h
"

52 
	~"oÊib-exp/oÊ-exp.h
"

54 
	#LOG_MODULE
 
VLM_vc⁄n


	)

55 
	~"vlog.h
"

58 
	evc⁄n_°©e
 {

60 
	mVCS_CONNECTING
,

61 
	mVCS_SEND_HELLO
,

62 
	mVCS_RECV_HELLO
,

63 
	mVCS_CONNECTED
,

66 
	mVCS_SEND_ERROR
,

67 
	mVCS_DISCONNECTED


70 
oÊ_exp_msg
 
	goÊ_exp_msg
 =

71 {.
∑ck
 = 
oÊ_exp_msg_∑ck
,

72 .
	gu≈ack
 = 
oÊ_exp_msg_u≈ack
,

73 .
	g‰ì
 = 
oÊ_exp_msg_‰ì
,

74 .
	gto_°rög
 = 
oÊ_exp_msg_to_°rög
};

76 
oÊ_exp
 
	goÊ_exp
 =

77 {.
a˘
 = 
NULL
,

78 .
	gö°
 = 
NULL
,

79 .
	gm©ch
 = 
NULL
,

80 .
	g°©s
 = 
NULL
,

81 .
	gmsg
 = &
oÊ_exp_msg
};

83 
vc⁄n_˛ass
 *
	gvc⁄n_˛as£s
[] = {

84 &
t˝_vc⁄n_˛ass
,

85 &
unix_vc⁄n_˛ass
,

86 #ifde‡
HAVE_NETLINK


87 &
√éök_vc⁄n_˛ass
,

89 #ifde‡
HAVE_OPENSSL


90 &
s¶_vc⁄n_˛ass
,

94 
pvc⁄n_˛ass
 *
	gpvc⁄n_˛as£s
[] = {

95 &
±˝_pvc⁄n_˛ass
,

96 &
punix_pvc⁄n_˛ass
,

97 #ifde‡
HAVE_OPENSSL


98 &
ps¶_pvc⁄n_˛ass
,

105 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(600, 600);

107 
do_ªcv
(
vc⁄n
 *, 
oÂbuf
 **);

108 
do_£nd
(
vc⁄n
 *, 
oÂbuf
 *);

112 
	$check_vc⁄n_˛as£s
()

114 #i‚de‡
NDEBUG


115 
size_t
 
i
;

117 
i
 = 0; i < 
	`ARRAY_SIZE
(
vc⁄n_˛as£s
); i++) {

118 
vc⁄n_˛ass
 *
˛ass
 = 
vc⁄n_˛as£s
[
i
];

119 
	`as£π
(
˛ass
->
«me
 !
NULL
);

120 
	`as£π
(
˛ass
->
›í
 !
NULL
);

121 i‡(
˛ass
->
˛o£
 || cœss->
ªcv
 || cœss->
£nd
 || cœss->
waô
) {

122 
	`as£π
(
˛ass
->
˛o£
 !
NULL
);

123 
	`as£π
(
˛ass
->
ªcv
 !
NULL
);

124 
	`as£π
(
˛ass
->
£nd
 !
NULL
);

125 
	`as£π
(
˛ass
->
waô
 !
NULL
);

131 
i
 = 0; i < 
	`ARRAY_SIZE
(
pvc⁄n_˛as£s
); i++) {

132 
pvc⁄n_˛ass
 *
˛ass
 = 
pvc⁄n_˛as£s
[
i
];

133 
	`as£π
(
˛ass
->
«me
 !
NULL
);

134 
	`as£π
(
˛ass
->
li°í
 !
NULL
);

135 i‡(
˛ass
->
˛o£
 || cœss->
ac˚±
 || cœss->
waô
) {

136 
	`as£π
(
˛ass
->
˛o£
 !
NULL
);

137 
	`as£π
(
˛ass
->
ac˚±
 !
NULL
);

138 
	`as£π
(
˛ass
->
waô
 !
NULL
);

144 
	}
}

150 
	$vc⁄n_ußge
(
boﬁ
 
a˘ive
, boﬁ 
∑ssive
, boﬁ 
boŸ°øp
 
UNUSED
)

156 
	`¥ötf
("\n");

157 i‡(
a˘ive
) {

158 
	`¥ötf
("Active OpenFlow connection methods:\n");

159 
	`¥ötf
("Åcp:HOST[:PORT] "

160 "PORT (deÁu…: %dË⁄ÑemŸêTCP HOST\n", 
OFP_TCP_PORT
);

161 #ifde‡
HAVE_OPENSSL


162 
	`¥ötf
(" ssl:HOST[:PORT] "

163 "SSL PORT (deÁu…: %dË⁄ÑemŸêHOST\n", 
OFP_SSL_PORT
);

165 
	`¥ötf
(" unix:FILE Unix domain socketÇamed FILE\n");

166 
	`¥ötf
(" fd:N File descriptor N\n");

169 i‡(
∑ssive
) {

170 
	`¥ötf
("Passive OpenFlow connection methods:\n");

171 
	`¥ötf
("Ötcp:[PORT] "

173 
OFP_TCP_PORT
);

174 #ifde‡
HAVE_OPENSSL


175 
	`¥ötf
("Össl:[PORT] "

177 
OFP_SSL_PORT
);

179 
	`¥ötf
("Öunix:FILE "

183 #ifde‡
HAVE_OPENSSL


184 
	`¥ötf
("PKI configuration (requiredÅo use SSL):\n"

188 i‡(
boŸ°øp
) {

189 
	`¥ötf
(" --bootstrap-ca-cert=FILE file withÖeer CA certificate "

193 
	}
}

207 
	$vc⁄n_›í
(c⁄° *
«me
, 
mö_vîsi⁄
, 
vc⁄n
 **
vc⁄≈
)

209 
size_t
 
¥efix_Àn
;

210 
size_t
 
i
;

212 
	`check_vc⁄n_˛as£s
();

214 *
vc⁄≈
 = 
NULL
;

215 
¥efix_Àn
 = 
	`°rc•n
(
«me
, ":");

216 i‡(
¥efix_Àn
 =
	`°æí
(
«me
)) {

217  
EAFNOSUPPORT
;

219 
i
 = 0; i < 
	`ARRAY_SIZE
(
vc⁄n_˛as£s
); i++) {

220 
vc⁄n_˛ass
 *
˛ass
 = 
vc⁄n_˛as£s
[
i
];

221 i‡(
	`°æí
(
˛ass
->
«me
Ë=
¥efix_Àn


222 && !
	`memcmp
(
˛ass
->
«me
,Çame, 
¥efix_Àn
)) {

223 
vc⁄n
 *vconn;

224 *
suffix_c›y
 = 
	`x°rdup
(
«me
 + 
¥efix_Àn
 + 1);

225 
ªtvÆ
 = 
˛ass
->
	`›í
(
«me
, 
suffix_c›y
, &
vc⁄n
);

226 
	`‰ì
(
suffix_c›y
);

227 i‡(!
ªtvÆ
) {

228 
	`as£π
(
vc⁄n
->
°©e
 !
VCS_CONNECTING


229 || 
vc⁄n
->
˛ass
->
c⁄√˘
);

230 
vc⁄n
->
mö_vîsi⁄
 = min_version;

231 *
vc⁄≈
 = 
vc⁄n
;

233  
ªtvÆ
;

236  
EAFNOSUPPORT
;

237 
	}
}

240 
	$vc⁄n_›í_block
(c⁄° *
«me
, 
mö_vîsi⁄
, 
vc⁄n
 **
vc⁄≈
)

242 
vc⁄n
 *vconn;

243 
îr‹
;

245 
îr‹
 = 
	`vc⁄n_›í
(
«me
, 
mö_vîsi⁄
, &
vc⁄n
);

246 
îr‹
 =
EAGAIN
) {

247 
	`vc⁄n_c⁄√˘_waô
(
vc⁄n
);

248 
	`pﬁl_block
();

249 
îr‹
 = 
	`vc⁄n_c⁄√˘
(
vc⁄n
);

250 
	`as£π
(
îr‹
 !
EINPROGRESS
);

252 i‡(
îr‹
) {

253 
	`vc⁄n_˛o£
(
vc⁄n
);

254 *
vc⁄≈
 = 
NULL
;

256 *
vc⁄≈
 = 
vc⁄n
;

258  
îr‹
;

259 
	}
}

263 
	$vc⁄n_˛o£
(
vc⁄n
 *vconn)

265 i‡(
vc⁄n
 !
NULL
) {

266 *
«me
 = 
vc⁄n
->name;

267 (
vc⁄n
->
˛ass
->
˛o£
)(vconn);

268 
	`‰ì
(
«me
);

270 
	}
}

274 
	$vc⁄n_gë_«me
(c⁄° 
vc⁄n
 *vconn)

276  
vc⁄n
->
«me
;

277 
	}
}

281 
uöt32_t


282 
	$vc⁄n_gë_ù
(c⁄° 
vc⁄n
 *vconn)

284  
vc⁄n
->
ù
;

285 
	}
}

294 
boﬁ


295 
	$vc⁄n_is_ªc⁄√˘abÀ
(c⁄° 
vc⁄n
 *vconn)

297  
vc⁄n
->
ªc⁄√˘abÀ
;

298 
	}
}

301 
	$vcs_c⁄√˘ög
(
vc⁄n
 *vconn)

303 
ªtvÆ
 = (
vc⁄n
->
˛ass
->
c⁄√˘
)(vconn);

304 
	`as£π
(
ªtvÆ
 !
EINPROGRESS
);

305 i‡(!
ªtvÆ
) {

306 
vc⁄n
->
°©e
 = 
VCS_SEND_HELLO
;

307 } i‡(
ªtvÆ
 !
EAGAIN
) {

308 
vc⁄n
->
°©e
 = 
VCS_DISCONNECTED
;

309 
vc⁄n
->
îr‹
 = 
ªtvÆ
;

311 
	}
}

314 
	$vcs_£nd_hñlo
(
vc⁄n
 *vconn)

316 
oÂbuf
 *
b
;

317 
ªtvÆ
;

319 
	`make_›íÊow
((
oÂ_hódî
), 
OFPT_HELLO
, &
b
);

320 
ªtvÆ
 = 
	`do_£nd
(
vc⁄n
, 
b
);

321 i‡(!
ªtvÆ
) {

322 ++
vc⁄n
->
oÂs_£¡
.
oÂs_tŸÆ
;

323 ++
vc⁄n
->
oÂs_£¡
.
oÂs_hñlo
;

324 
vc⁄n
->
°©e
 = 
VCS_RECV_HELLO
;

326 
	`oÂbuf_dñëe
(
b
);

327 i‡(
ªtvÆ
 !
EAGAIN
) {

328 
vc⁄n
->
°©e
 = 
VCS_DISCONNECTED
;

329 
vc⁄n
->
îr‹
 = 
ªtvÆ
;

332 
	}
}

335 
	$vcs_ªcv_hñlo
(
vc⁄n
 *vconn)

337 
oÂbuf
 *
b
;

338 
ªtvÆ
;

340 
ªtvÆ
 = 
	`do_ªcv
(
vc⁄n
, &
b
);

341 i‡(!
ªtvÆ
) {

342 
oÂ_hódî
 *
oh
 = 
b
->
d©a
;

344 i‡(
oh
->
ty≥
 =
OFPT_HELLO
) {

345 i‡(
b
->
size
 >  *
oh
) {

346 
ds
 
msg
 = 
DS_EMPTY_INITIALIZER
;

347 
	`ds_put_f‹m©
(&
msg
, "%s:Éxåa-l⁄g hñlo:\n", 
vc⁄n
->
«me
);

348 
	`ds_put_hex_dump
(&
msg
, 
b
->
d©a
, b->
size
, 0, 
åue
);

349 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "%s", 
	`ds_c°r
(&
msg
));

350 
	`ds_de°roy
(&
msg
);

353 
vc⁄n
->
vîsi⁄
 = 
	`MIN
(
OFP_VERSION
, 
oh
->version);

354 i‡(
vc⁄n
->
vîsi⁄
 < vc⁄n->
mö_vîsi⁄
) {

355 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "%s: versionÇegotiation failed: we support "

357 "suµ‹t†nÿœã∏th™ vîsi⁄ 0x%02"
PRIx8
,

358 
vc⁄n
->
«me
, vc⁄n->
mö_vîsi⁄
, 
OFP_VERSION
,

359 
oh
->
vîsi⁄
);

360 
vc⁄n
->
°©e
 = 
VCS_SEND_ERROR
;

362 
	`VLOG_DBG
(
LOG_MODULE
, "%s:Çegotiated OpenFlow version 0x%02x "

364 "≥îÇÿœã∏th™ vîsi⁄ 0x%02"
PRIx8
")",

365 
vc⁄n
->
«me
, vc⁄n->
vîsi⁄
, vc⁄n->
mö_vîsi⁄
,

366 
OFP_VERSION
, 
oh
->
vîsi⁄
);

367 
vc⁄n
->
°©e
 = 
VCS_CONNECTED
;

369 ++
vc⁄n
->
oÂs_rcvd
.
oÂs_tŸÆ
;

370 ++
vc⁄n
->
oÂs_rcvd
.
oÂs_hñlo
;

371 
	`oÂbuf_dñëe
(
b
);

374 
oÊ_msg_hódî
 *
msg
;

375 *
°r
;

377 i‡(!
	`oÊ_msg_u≈ack
(
b
->
d©a
, b->
size
, &
msg
, 
NULL
 , &
oÊ_exp
)) {

378 
°r
 = 
	`oÊ_msg_to_°rög
(
msg
, &
oÊ_exp
);

379 
	`oÊ_msg_‰ì
(
msg
, &
oÊ_exp
);

381 
ds
 
°rög
 = 
DS_EMPTY_INITIALIZER
;

382 
	`ds_put_c°r
(&
°rög
, "\n");

383 
	`ds_put_hex_dump
(&
°rög
, 
b
->
d©a
, 
	`MIN
(b->
size
, 1024), 0, 
Ál£
);

384 
°r
 = 
	`ds_c°r
(&
°rög
);

386 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "%s:Ñeceived message whileÉxpecting hello: %s",

387 
vc⁄n
->
«me
, 
°r
);

389 
	`‰ì
(
°r
);

391 
ªtvÆ
 = 
EPROTO
;

392 
	`oÂbuf_dñëe
(
b
);

396 i‡(
ªtvÆ
 !
EAGAIN
) {

397 
vc⁄n
->
°©e
 = 
VCS_DISCONNECTED
;

398 
vc⁄n
->
îr‹
 = 
ªtvÆ
;

400 
	}
}

403 
	$vcs_£nd_îr‹
(
vc⁄n
 *vconn)

405 
oÂ_îr‹_msg
 *
îr‹
;

406 
oÂbuf
 *
b
;

407 
s
[128];

408 
ªtvÆ
;

410 
	`¢¥ötf
(
s
,  s, "We support versions 0x%02xÅo 0x%02x inclusive but "

411 "you suµ‹ànÿœã∏th™ vîsi⁄ 0x%02"
PRIx8
".",

412 
vc⁄n
->
mö_vîsi⁄
, 
OFP_VERSION
, vc⁄n->
vîsi⁄
);

413 
îr‹
 = 
	`make_›íÊow
( *îr‹, 
OFPT_ERROR
, &
b
);

414 
îr‹
->
ty≥
 = 
	`ht⁄s
(
OFPET_HELLO_FAILED
);

415 
îr‹
->
code
 = 
	`ht⁄s
(
OFPHFC_INCOMPATIBLE
);

416 
	`oÂbuf_put
(
b
, 
s
, 
	`°æí
(s));

417 
	`upd©e_›íÊow_Àngth
(
b
);

418 
ªtvÆ
 = 
	`do_£nd
(
vc⁄n
, 
b
);

419 i‡(
ªtvÆ
) {

420 ++
vc⁄n
->
oÂs_£¡
.
oÂs_tŸÆ
;

421 ++
vc⁄n
->
oÂs_£¡
.
oÂs_îr‹
;

422 ++
vc⁄n
->
oÂs_£¡
.
oÂs_îr‹_ty≥
.
hñlo_Áû
;

423 ++
vc⁄n
->
oÂs_£¡
.
oÂs_îr‹_code
.
hf_öcom∑t
;

424 
	`oÂbuf_dñëe
(
b
);

426 i‡(
ªtvÆ
 !
EAGAIN
) {

427 
vc⁄n
->
°©e
 = 
VCS_DISCONNECTED
;

428 
vc⁄n
->
îr‹
 = 
ªtvÆ
 ?ÑëvÆ : 
EPROTO
;

430 
	}
}

437 
	$vc⁄n_c⁄√˘
(
vc⁄n
 *vconn)

439 
vc⁄n_°©e
 
œ°_°©e
;

441 
	`as£π
(
vc⁄n
->
mö_vîsi⁄
 >= 0);

443 
œ°_°©e
 = 
vc⁄n
->
°©e
;

444 
vc⁄n
->
°©e
) {

445 
VCS_CONNECTING
:

446 
	`vcs_c⁄√˘ög
(
vc⁄n
);

449 
VCS_SEND_HELLO
:

450 
	`vcs_£nd_hñlo
(
vc⁄n
);

453 
VCS_RECV_HELLO
:

454 
	`vcs_ªcv_hñlo
(
vc⁄n
);

457 
VCS_CONNECTED
:

460 
VCS_SEND_ERROR
:

461 
	`vcs_£nd_îr‹
(
vc⁄n
);

464 
VCS_DISCONNECTED
:

465  
vc⁄n
->
îr‹
;

468 
	`NOT_REACHED
();

470 } 
vc⁄n
->
°©e
 !
œ°_°©e
);

472  
EAGAIN
;

473 
	}
}

484 
	$vc⁄n_ªcv
(
vc⁄n
 *vc⁄n, 
oÂbuf
 **
msgp
)

486 
ªtvÆ
 = 
	`vc⁄n_c⁄√˘
(
vc⁄n
);

487 i‡(!
ªtvÆ
) {

488 
ªtvÆ
 = 
	`do_ªcv
(
vc⁄n
, 
msgp
);

490  
ªtvÆ
;

491 
	}
}

494 
	$do_ªcv
(
vc⁄n
 *vc⁄n, 
oÂbuf
 **
msgp
)

496 
ªtvÆ
;

498 
agaö
:

499 
ªtvÆ
 = (
vc⁄n
->
˛ass
->
ªcv
)(vc⁄n, 
msgp
);

500 i‡(!
ªtvÆ
) {

501 
oÂ_hódî
 *
oh
;

503 i‡(
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

504 
oÊ_msg_hódî
 *
msg
;

505 *
°r
;

507 i‡(!
	`oÊ_msg_u≈ack
((*
msgp
)->
d©a
, (*msgp)->
size
, &
msg
, 
NULL
 , &
oÊ_exp
)) {

508 
°r
 = 
	`oÊ_msg_to_°rög
(
msg
, &
oÊ_exp
);

509 
	`oÊ_msg_‰ì
(
msg
, &
oÊ_exp
);

511 
ds
 
°rög
 = 
DS_EMPTY_INITIALIZER
;

512 
	`ds_put_c°r
(&
°rög
, "\n");

513 
	`ds_put_hex_dump
(&
°rög
, (*
msgp
)->
d©a
, 
	`MIN
((*msgp)->
size
, 1024), 0, 
Ál£
);

514 
°r
 = 
	`ds_c°r
(&
°rög
);

516 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "%s:Ñe˚ived: %.400s", 
vc⁄n
->
«me
, 
°r
);

518 
	`‰ì
(
°r
);

521 
oh
 = 
	`oÂbuf_©_as£π
(*
msgp
, 0,  *oh);

522 i‡(
oh
->
vîsi⁄
 !
vc⁄n
->version

523 && 
oh
->
ty≥
 !
OFPT_HELLO


524 && 
oh
->
ty≥
 !
OFPT_ERROR


525 && 
oh
->
ty≥
 !
OFPT_ECHO_REQUEST


526 && 
oh
->
ty≥
 !
OFPT_ECHO_REPLY


527 && 
oh
->
ty≥
 !
OFPT_EXPERIMENTER
)

529 i‡(
vc⁄n
->
vîsi⁄
 < 0) {

530 i‡(
oh
->
ty≥
 =
OFPT_PACKET_IN


531 || 
oh
->
ty≥
 =
OFPT_FLOW_REMOVED


532 || 
oh
->
ty≥
 =
OFPT_PORT_STATUS
) {

541 
	`oÂbuf_dñëe
(*
msgp
);

542 
agaö
;

544 
	`VLOG_ERR_RL
(
LOG_MODULE
, &
æ
, "%s:Ñe˚ived O≥nFlow mesßgêty≥ %"
PRIu8
" "

546 
vc⁄n
->
«me
, 
oh
->
ty≥
);

548 
	`VLOG_ERR_RL
(
LOG_MODULE
, &
æ
, "%s:Ñe˚ived O≥nFlow vîsi⁄ 0x%02"
PRIx8
" "

550 
vc⁄n
->
«me
, 
oh
->
vîsi⁄
, vconn->version);

552 
	`oÂbuf_dñëe
(*
msgp
);

553 
ªtvÆ
 = 
EPROTO
;

556 i‡(
ªtvÆ
) {

557 *
msgp
 = 
NULL
;

559  
ªtvÆ
;

560 
	}
}

574 
	$vc⁄n_£nd
(
vc⁄n
 *vc⁄n, 
oÂbuf
 *
msg
)

576 
ªtvÆ
 = 
	`vc⁄n_c⁄√˘
(
vc⁄n
);

577 i‡(!
ªtvÆ
) {

578 
ªtvÆ
 = 
	`do_£nd
(
vc⁄n
, 
msg
);

580  
ªtvÆ
;

581 
	}
}

584 
	$do_£nd
(
vc⁄n
 *vc⁄n, 
oÂbuf
 *
buf
)

586 
ªtvÆ
;

588 
	`as£π
(
buf
->
size
 >(
oÂ_hódî
));

589 
	`as£π
(((
oÂ_hódî
 *Ë
buf
->
d©a
)->
Àngth
 =
	`ht⁄s
(buf->
size
));

590 i‡(!
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

591 
ªtvÆ
 = (
vc⁄n
->
˛ass
->
£nd
)(vc⁄n, 
buf
);

593 
oÊ_msg_hódî
 *
msg
;

594 *
°r
;

596 i‡(!
	`oÊ_msg_u≈ack
(
buf
->
d©a
, buf->
size
, &
msg
, 
NULL
 , &
oÊ_exp
)) {

597 
°r
 = 
	`oÊ_msg_to_°rög
(
msg
, &
oÊ_exp
);

598 
	`oÊ_msg_‰ì
(
msg
, &
oÊ_exp
);

600 
ds
 
°rög
 = 
DS_EMPTY_INITIALIZER
;

601 
	`ds_put_c°r
(&
°rög
, "\n");

602 
	`ds_put_hex_dump
(&
°rög
, 
buf
->
d©a
, 
	`MIN
(buf->
size
, 1024), 0, 
Ál£
);

603 
°r
 = 
	`ds_c°r
(&
°rög
);

606 
ªtvÆ
 = (
vc⁄n
->
˛ass
->
£nd
)(vc⁄n, 
buf
);

607 i‡(
ªtvÆ
 !
EAGAIN
) {

608 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "%s: sent (%s): %.400s",

609 
vc⁄n
->
«me
, 
	`°ªº‹
(
ªtvÆ
), 
°r
);

612 
	`‰ì
(
°r
);

614  
ªtvÆ
;

615 
	}
}

619 
	$vc⁄n_£nd_block
(
vc⁄n
 *vc⁄n, 
oÂbuf
 *
msg
)

621 
ªtvÆ
;

622 (
ªtvÆ
 = 
	`vc⁄n_£nd
(
vc⁄n
, 
msg
)Ë=
EAGAIN
) {

623 
	`vc⁄n_£nd_waô
(
vc⁄n
);

624 
	`pﬁl_block
();

626  
ªtvÆ
;

627 
	}
}

631 
	$vc⁄n_ªcv_block
(
vc⁄n
 *vc⁄n, 
oÂbuf
 **
msgp
)

633 
ªtvÆ
;

634 (
ªtvÆ
 = 
	`vc⁄n_ªcv
(
vc⁄n
, 
msgp
)Ë=
EAGAIN
) {

635 
	`vc⁄n_ªcv_waô
(
vc⁄n
);

636 
	`pﬁl_block
();

638  
ªtvÆ
;

639 
	}
}

648 
	$vc⁄n_ªcv_xid
(
vc⁄n
 *vc⁄n, 
uöt32_t
 
xid
, 
oÂbuf
 **
ª∂yp
)

651 
uöt32_t
 
ªcv_xid
;

652 
uöt16_t
 
ª∂y_Êag
;

653 
uöt8_t
 
ty≥
;

654 
oÂbuf
 *
ª∂y
;

655 
îr‹
;

657 
îr‹
 = 
	`vc⁄n_ªcv_block
(
vc⁄n
, &
ª∂y
);

658 i‡(
îr‹
) {

659 *
ª∂yp
 = 
NULL
;

660  
îr‹
;

666 
ty≥
 = ((
oÂ_hódî
*Ë
ª∂y
->
d©a
)->type;

667 i‡(
ty≥
 =
OFPT_MULTIPART_REPLY
 ||Åy≥ =
OFPT_MULTIPART_REQUEST
){

668 
ª∂y_Êag
 = ((
oÂ_mu…ù¨t_ª∂y
 *Ë
ª∂y
->
d©a
)->
Êags
;

670 
	`¡ohs
(
ª∂y_Êag
Ë=
OFPMPF_REPLY_MORE
){

671 
îr‹
 = 
	`vc⁄n_ªcv_block
(
vc⁄n
, &
ª∂y
);

672 
ª∂y_Êag
 = ((
oÂ_mu…ù¨t_ª∂y
 *Ë
ª∂y
->
d©a
)->
Êags
;

675 
ªcv_xid
 = ((
oÂ_hódî
 *Ë
ª∂y
->
d©a
)->
xid
;

676 i‡(
xid
 =
ªcv_xid
) {

677 *
ª∂yp
 = 
ª∂y
;

681 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "%s:Ñe˚ivedÑïly wôh xid %08"
PRIx32
" !=Éxpected "

682 "%08"
PRIx32
, 
vc⁄n
->
«me
, 
ªcv_xid
, 
xid
);

683 
	`oÂbuf_dñëe
(
ª∂y
);

685 
	}
}

694 
	$vc⁄n_å™ß˘
(
vc⁄n
 *vc⁄n, 
oÂbuf
 *
ªque°
,

695 
oÂbuf
 **
ª∂yp
)

697 
uöt32_t
 
£nd_xid
 = ((
oÂ_hódî
 *Ë
ªque°
->
d©a
)->
xid
;

698 
îr‹
;

700 *
ª∂yp
 = 
NULL
;

701 
îr‹
 = 
	`vc⁄n_£nd_block
(
vc⁄n
, 
ªque°
);

702 i‡(
îr‹
) {

703 
	`oÂbuf_dñëe
(
ªque°
);

705  
îr‹
 ?Éº‹ : 
	`vc⁄n_ªcv_xid
(
vc⁄n
, 
£nd_xid
, 
ª∂yp
);

706 
	}
}

709 
	$vc⁄n_waô
(
vc⁄n
 *vc⁄n, 
vc⁄n_waô_ty≥
 
waô
)

711 
	`as£π
(
waô
 =
WAIT_CONNECT
 || waô =
WAIT_RECV
 || waô =
WAIT_SEND
);

713 
vc⁄n
->
°©e
) {

714 
VCS_CONNECTING
:

715 
waô
 = 
WAIT_CONNECT
;

718 
VCS_SEND_HELLO
:

719 
VCS_SEND_ERROR
:

720 
waô
 = 
WAIT_SEND
;

723 
VCS_RECV_HELLO
:

724 
waô
 = 
WAIT_RECV
;

727 
VCS_CONNECTED
:

730 
VCS_DISCONNECTED
:

731 
	`pﬁl_immedüã_wake
();

734 (
vc⁄n
->
˛ass
->
waô
)(vconn, wait);

735 
	}
}

738 
	$vc⁄n_c⁄√˘_waô
(
vc⁄n
 *vconn)

740 
	`vc⁄n_waô
(
vc⁄n
, 
WAIT_CONNECT
);

741 
	}
}

744 
	$vc⁄n_ªcv_waô
(
vc⁄n
 *vconn)

746 
	`vc⁄n_waô
(
vc⁄n
, 
WAIT_RECV
);

747 
	}
}

750 
	$vc⁄n_£nd_waô
(
vc⁄n
 *vconn)

752 
	`vc⁄n_waô
(
vc⁄n
, 
WAIT_SEND
);

753 
	}
}

763 
	$pvc⁄n_›í
(c⁄° *
«me
, 
pvc⁄n
 **
pvc⁄≈
)

765 
size_t
 
¥efix_Àn
;

766 
size_t
 
i
;

768 
	`check_vc⁄n_˛as£s
();

770 *
pvc⁄≈
 = 
NULL
;

771 
¥efix_Àn
 = 
	`°rc•n
(
«me
, ":");

772 i‡(
¥efix_Àn
 =
	`°æí
(
«me
)) {

773  
EAFNOSUPPORT
;

775 
i
 = 0; i < 
	`ARRAY_SIZE
(
pvc⁄n_˛as£s
); i++) {

776 
pvc⁄n_˛ass
 *
˛ass
 = 
pvc⁄n_˛as£s
[
i
];

777 i‡(
	`°æí
(
˛ass
->
«me
Ë=
¥efix_Àn


778 && !
	`memcmp
(
˛ass
->
«me
,Çame, 
¥efix_Àn
)) {

779 *
suffix_c›y
 = 
	`x°rdup
(
«me
 + 
¥efix_Àn
 + 1);

780 
ªtvÆ
 = 
˛ass
->
	`li°í
(
«me
, 
suffix_c›y
, 
pvc⁄≈
);

781 
	`‰ì
(
suffix_c›y
);

782 i‡(
ªtvÆ
) {

783 *
pvc⁄≈
 = 
NULL
;

785  
ªtvÆ
;

788  
EAFNOSUPPORT
;

789 
	}
}

793 
	$pvc⁄n_˛o£
(
pvc⁄n
 *pvconn)

795 i‡(
pvc⁄n
 !
NULL
) {

796 *
«me
 = 
pvc⁄n
->name;

797 (
pvc⁄n
->
˛ass
->
˛o£
)(pvconn);

798 
	`‰ì
(
«me
);

800 
	}
}

813 
	$pvc⁄n_ac˚±
(
pvc⁄n
 *pvc⁄n, 
mö_vîsi⁄
, 
vc⁄n
 **
√w_vc⁄n
)

815 
ªtvÆ
 = (
pvc⁄n
->
˛ass
->
ac˚±
)’vc⁄n, 
√w_vc⁄n
);

816 i‡(
ªtvÆ
) {

817 *
√w_vc⁄n
 = 
NULL
;

819 
	`as£π
((*
√w_vc⁄n
)->
°©e
 !
VCS_CONNECTING


820 || (*
√w_vc⁄n
)->
˛ass
->
c⁄√˘
);

821 (*
√w_vc⁄n
)->
mö_vîsi⁄
 = min_version;

823  
ªtvÆ
;

824 
	}
}

827 
	$pvc⁄n_waô
(
pvc⁄n
 *pvconn)

829 (
pvc⁄n
->
˛ass
->
waô
)(pvconn);

830 
	}
}

833 
	$vc⁄n_öô
(
vc⁄n
 *vc⁄n, 
vc⁄n_˛ass
 *
˛ass
, 
c⁄√˘_°©us
,

834 
uöt32_t
 
ù
, c⁄° *
«me
, 
boﬁ
 
ªc⁄√˘abÀ
)

836 
vc⁄n
->
˛ass
 = class;

837 
vc⁄n
->
°©e
 = (
c⁄√˘_°©us
 =
EAGAIN
 ? 
VCS_CONNECTING


838 : !
c⁄√˘_°©us
 ? 
VCS_SEND_HELLO


839 : 
VCS_DISCONNECTED
);

840 
vc⁄n
->
îr‹
 = 
c⁄√˘_°©us
;

841 
vc⁄n
->
vîsi⁄
 = -1;

842 
vc⁄n
->
mö_vîsi⁄
 = -1;

843 
vc⁄n
->
ù
 = ip;

844 
vc⁄n
->
«me
 = 
	`x°rdup
(name);

845 
vc⁄n
->
ªc⁄√˘abÀ
 =Ñeconnectable;

846 
	`mem£t
(&
vc⁄n
->
oÂs_rcvd
, 0, (vconn->ofps_rcvd));

847 
	`mem£t
(&
vc⁄n
->
oÂs_£¡
, 0, (vconn->ofps_sent));

848 
	}
}

851 
	$pvc⁄n_öô
(
pvc⁄n
 *pvc⁄n, 
pvc⁄n_˛ass
 *
˛ass
,

852 c⁄° *
«me
)

854 
pvc⁄n
->
˛ass
 = class;

855 
pvc⁄n
->
«me
 = 
	`x°rdup
(name);

856 
	}
}

	@lib/vconn.h

34 #i‚de‡
VCONN_H


35 
	#VCONN_H
 1

	)

37 
	~<°dboﬁ.h
>

38 
	~<°ddef.h
>

39 
	~<°döt.h
>

41 
	goÂbuf
;

42 
	gÊow
;

43 
	goÂ_hódî
;

44 
	goÂ_mu…ù¨t_ª∂y
;

45 
	gpvc⁄n
;

46 
	gvc⁄n
;

48 
vc⁄n_ußge
(
boﬁ
 
a˘ive
, boﬁ 
∑ssive
, boﬁ 
boŸ°øp
);

51 
vc⁄n_›í
(c⁄° *
«me
, 
mö_vîsi⁄
, 
vc⁄n
 **);

52 
vc⁄n_˛o£
(
vc⁄n
 *);

53 c⁄° *
vc⁄n_gë_«me
(c⁄° 
vc⁄n
 *);

54 
uöt32_t
 
vc⁄n_gë_ù
(c⁄° 
vc⁄n
 *);

55 
boﬁ
 
vc⁄n_is_ªc⁄√˘abÀ
(c⁄° 
vc⁄n
 *);

56 
vc⁄n_c⁄√˘
(
vc⁄n
 *);

57 
vc⁄n_ªcv
(
vc⁄n
 *, 
oÂbuf
 **);

58 
vc⁄n_£nd
(
vc⁄n
 *, 
oÂbuf
 *);

59 
vc⁄n_ªcv_xid
(
vc⁄n
 *, 
uöt32_t
 
xid
, 
oÂbuf
 **);

60 
vc⁄n_å™ß˘
(
vc⁄n
 *, 
oÂbuf
 *, ofpbuf **);

62 
vc⁄n_›í_block
(c⁄° *
«me
, 
mö_vîsi⁄
, 
vc⁄n
 **);

63 
vc⁄n_£nd_block
(
vc⁄n
 *, 
oÂbuf
 *);

64 
vc⁄n_ªcv_block
(
vc⁄n
 *, 
oÂbuf
 **);

66 
	evc⁄n_waô_ty≥
 {

67 
	mWAIT_CONNECT
,

68 
	mWAIT_RECV
,

69 
	mWAIT_SEND


71 
vc⁄n_waô
(
vc⁄n
 *, 
vc⁄n_waô_ty≥
);

72 
vc⁄n_c⁄√˘_waô
(
vc⁄n
 *);

73 
vc⁄n_ªcv_waô
(
vc⁄n
 *);

74 
vc⁄n_£nd_waô
(
vc⁄n
 *);

77 
pvc⁄n_›í
(c⁄° *
«me
, 
pvc⁄n
 **);

78 
pvc⁄n_˛o£
(
pvc⁄n
 *);

79 
pvc⁄n_ac˚±
(
pvc⁄n
 *, 
mö_vîsi⁄
, 
vc⁄n
 **);

80 
pvc⁄n_waô
(
pvc⁄n
 *);

	@lib/vlog-socket.c

34 
	~<c⁄fig.h
>

35 
	~"vlog-sockë.h
"

36 
	~<˘y≥.h
>

37 
	~<î∫o.h
>

38 
	~<sys/un.h
>

39 
	~<f˙é.h
>

40 
	~<pﬁl.h
>

41 
	~<°dlib.h
>

42 
	~<°rög.h
>

43 
	~<sys/sockë.h
>

44 
	~<sys/°©.h
>

45 
	~<sys/ty≥s.h
>

46 
	~<uni°d.h
>

47 
	~"d´m⁄.h
"

48 
	~"Áèl-sig«l.h
"

49 
	~"pﬁl-lo›.h
"

50 
	~"sockë-utû.h
"

51 
	~"timevÆ.h
"

52 
	~"utû.h
"

54 #i‚de‡
SCM_CREDENTIALS


55 
	~<time.h
>

58 
	#LOG_MODULE
 
VLM_vlog_sockë


	)

59 
	~"vlog.h
"

62 
	svlog_£rvî
 {

63 
pﬁl_waôî
 *
	mwaôî
;

64 *
	m∑th
;

65 
	mfd
;

68 
pﬁl_£rvî
(
fd
, 
evíts
, *
£rvî_
);

90 
	$vlog_£rvî_li°í
(c⁄° *
∑th
, 
vlog_£rvî
 **
£rvîp
)

92 
vlog_£rvî
 *
£rvî
 = 
	`xmÆloc
( *server);

94 i‡(
∑th
 &&Öath[0] == '/') {

95 
£rvî
->
∑th
 = 
	`x°rdup
(path);

97 
£rvî
->
∑th
 = 
	`xa•rötf
("/tmp/vlogs.%ld%s",

98 (Ë
	`gëpid
(), 
∑th
 ?Öath : "");

101 
£rvî
->
fd
 = 
	`make_unix_sockë
(
SOCK_DGRAM
, 
åue
,Årue, sîvî->
∑th
, 
NULL
);

102 i‡(
£rvî
->
fd
 < 0) {

103 
fd
 = 
£rvî
->fd;

104 
	`Ârötf
(
°dîr
, "CouldÇot initialize vlog configuration socket: %s\n",

105 
	`°ªº‹
(-
£rvî
->
fd
));

106 
	`‰ì
(
£rvî
->
∑th
);

107 
	`‰ì
(
£rvî
);

108 i‡(
£rvîp
) {

109 *
£rvîp
 = 
NULL
;

111  
fd
;

114 
£rvî
->
waôî
 = 
	`pﬁl_fd_ˇŒback
(£rvî->
fd
, 
POLLIN
, 
pﬁl_£rvî
, server);

116 i‡(
£rvîp
) {

117 *
£rvîp
 = 
£rvî
;

120 
	}
}

124 
	$vlog_£rvî_˛o£
(
vlog_£rvî
 *
£rvî
)

126 i‡(
£rvî
) {

127 
	`pﬁl_ˇn˚l
(
£rvî
->
waôî
);

128 
	`˛o£
(
£rvî
->
fd
);

129 
	`u∆ök
(
£rvî
->
∑th
);

130 
	`Áèl_sig«l_ªmove_fûe_to_u∆ök
(
£rvî
->
∑th
);

131 
	`‰ì
(
£rvî
->
∑th
);

132 
	`‰ì
(
£rvî
);

134 
	}
}

137 
	$ªcv_wôh_¸eds
(c⁄° 
vlog_£rvî
 *
£rvî
,

138 *
cmd_buf
, 
size_t
 
cmd_buf_size
,

139 
sockaddr_un
 *
un
, 
sockÀn_t
 *
un_Àn
)

141 #ifde‡
SCM_CREDENTIALS


143 
¸ed_buf
[
	`CMSG_SPACE
((
u¸ed
))];

144 
ssize_t
 
n
;

145 
iovec
 
iov
;

146 
msghdr
 
msg
;

147 
u¸ed
* 
¸ed
;

148 
cmsghdr
* 
cmsg
;

150 
iov
.
iov_ba£
 = 
cmd_buf
;

151 
iov
.
iov_Àn
 = 
cmd_buf_size
 - 1;

153 
	`mem£t
(&
msg
, 0,  msg);

154 
msg
.
msg_«me
 = 
un
;

155 
msg
.
msg_«mñí
 =  *
un
;

156 
msg
.
msg_iov
 = &
iov
;

157 
msg
.
msg_iovÀn
 = 1;

158 
msg
.
msg_c⁄åﬁ
 = 
¸ed_buf
;

159 
msg
.
msg_c⁄åﬁÀn
 =  
¸ed_buf
;

161 
n
 = 
	`ªcvmsg
(
£rvî
->
fd
, &
msg
, 0);

162 *
un_Àn
 = 
msg
.
msg_«mñí
;

163 i‡(
n
 < 0) {

164  
î∫o
;

166 
cmd_buf
[
n
] = '\0';

170 
¸ed
 = 
NULL
;

171 
cmsg
 = 
	`CMSG_FIRSTHDR
(&
msg
); cmsg !
NULL
;

172 
cmsg
 = 
	`CMSG_NXTHDR
(&
msg
, cmsg)) {

173 i‡(
cmsg
->
cmsg_Àvñ
 =
SOL_SOCKET


174 && 
cmsg
->
cmsg_ty≥
 =
SCM_CREDENTIALS
) {

175 
¸ed
 = (
u¸ed
 *Ë
	`CMSG_DATA
(
cmsg
);

176 } i‡(
cmsg
->
cmsg_Àvñ
 =
SOL_SOCKET


177 && 
cmsg
->
cmsg_ty≥
 =
SCM_RIGHTS
) {

180 * 
fds
 = (*Ë
	`CMSG_DATA
(
cmsg
);

181 
size_t
 
n_fds
 = (
cmsg
->
cmsg_Àn
 - 
	`CMSG_LEN
(0)Ë/  *
fds
;

182 
size_t
 
i
;

183 
i
 = 0; i < 
n_fds
; i++) {

184 
	`˛o£
(
fds
[
i
]);

188 i‡(!
¸ed
) {

189 
	`Ârötf
(
°dîr
, "vlog: config messageÜacks credentials\n");

191 } i‡(
¸ed
->
uid
 && cªd->uid !
	`gëuid
()) {

192 
	`Ârötf
(
°dîr
, "vlog: config message uid=%ld isÇot 0 or %ld\n",

193 (Ë
¸ed
->
uid
, (Ë
	`gëuid
());

199 
sockÀn_t
 
Àn
;

200 
ssize_t
 
n
;

201 
°©
 
s
;

202 
time_t
 
ª˚¡
;

205 
Àn
 =  *
un
;

206 
n
 = 
	`ªcv‰om
(
£rvî
->
fd
, 
cmd_buf
, 
cmd_buf_size
 - 1, 0,

207 (
sockaddr
 *Ë
un
, &
Àn
);

208 *
un_Àn
 = 
Àn
;

209 i‡(
n
 < 0) {

210  
î∫o
;

212 
cmd_buf
[
n
] = '\0';

214 
Àn
 -
	`off£tof
(
sockaddr_un
, 
sun_∑th
);

215 
un
->
sun_∑th
[
Àn
] = '\0';

216 i‡(
	`°©
(
un
->
sun_∑th
, &
s
) < 0) {

217 
	`Ârötf
(
°dîr
, "vlog: config message from inaccessible socket: %s\n",

218 
	`°ªº‹
(
î∫o
));

221 i‡(!
	`S_ISSOCK
(
s
.
°_mode
)) {

222 
	`Ârötf
(
°dîr
, "vlog: config messageÇot fromá socket\n");

225 
ª˚¡
 = 
	`time_now
() - 30;

226 i‡(
s
.
°_©ime
 < 
ª˚¡
 || s.
°_˘ime
 <Ñe˚¡ || s.
°_mtime
 <Ñecent) {

227 
	`Ârötf
(
°dîr
, "vlog: config socketÅoo old\n");

230 i‡(
s
.
°_uid
 && s.°_uid !
	`gëuid
()) {

231 
	`Ârötf
(
°dîr
, "vlog: config message uid=%ld isÇot 0 or %ld\n",

232 (Ë
s
.
°_uid
, (Ë
	`gëuid
());

237 
	}
}

241 
	$pﬁl_£rvî
(
fd
 
UNUSED
, 
evíts
 UNUSED, *
£rvî_
)

243 
vlog_£rvî
 *
£rvî
 = 
£rvî_
;

245 
cmd_buf
[512];

246 
sockaddr_un
 
un
;

247 
sockÀn_t
 
un_Àn
;

248 *
ª∂y
;

249 
îr‹
;

251 
îr‹
 = 
	`ªcv_wôh_¸eds
(
£rvî
, 
cmd_buf
,  cmd_buf, &
un
, &
un_Àn
);

252 i‡(
îr‹
 > 0) {

253 i‡(
îr‹
 !
EAGAIN
 &&Éº‹ !
EWOULDBLOCK
) {

254 
	`Ârötf
(
°dîr
, "vlog:Ñeading configuration socket: %s",

255 
	`°ªº‹
(
î∫o
));

258 } i‡(
îr‹
 < 0) {

263 i‡(!
	`°∫cmp
(
cmd_buf
, "set ", 4)) {

264 *
msg
 = 
	`vlog_£t_Àvñs_‰om_°rög
(
cmd_buf
 + 4);

265 
ª∂y
 = 
msg
 ? msg : 
	`x°rdup
("ack");

266 } i‡(!
	`°rcmp
(
cmd_buf
, "list")) {

267 
ª∂y
 = 
	`vlog_gë_Àvñs
();

268 } i‡(!
	`°rcmp
(
cmd_buf
, "reopen")) {

269 
îr‹
 = 
	`vlog_ª›í_log_fûe
();

270 
ª∂y
 = (
îr‹


271 ? 
	`xa•rötf
("couldÇotÑeopenÜog file \"%s\": %s",

272 
	`vlog_gë_log_fûe
(), 
	`°ªº‹
(
îr‹
))

273 : 
	`x°rdup
("ack"));

275 
ª∂y
 = 
	`x°rdup
("nak");

277 
	`£ndto
(
£rvî
->
fd
, 
ª∂y
, 
	`°æí
(reply), 0,

278 (
sockaddr
*Ë&
un
, 
un_Àn
);

279 
	`‰ì
(
ª∂y
);

281 
£rvî
->
waôî
 = 
	`pﬁl_fd_ˇŒback
(£rvî->
fd
, 
POLLIN
, 
pﬁl_£rvî
, server);

282 
	}
}

286 
	svlog_˛õ¡
 {

287 *
	mc⁄√˘_∑th
;

288 *
	mböd_∑th
;

289 
	mfd
;

308 
	$vlog_˛õ¡_c⁄√˘
(c⁄° *
∑th
, 
vlog_˛õ¡
 **
˛õ¡p
)

310 
cou¡î
;

311 
vlog_˛õ¡
 *
˛õ¡
;

312 
°©
 
s
;

313 
îr‹
;

315 
˛õ¡
 = 
	`xmÆloc
( *client);

316 i‡(
∑th
[0] == '/') {

317 
˛õ¡
->
c⁄√˘_∑th
 = 
	`x°rdup
(
∑th
);

318 } i‡(
	`isdigô
((Ë
∑th
[0])) {

319 
˛õ¡
->
c⁄√˘_∑th
 = 
	`xa•rötf
("/tmp/vlogs.%s", 
∑th
);

321 
˛õ¡
->
c⁄√˘_∑th
 = 
	`make_pidfûe_«me
(
∑th
);

323 
˛õ¡
->
böd_∑th
 = 
NULL
;

325 i‡(
	`°©
(
˛õ¡
->
c⁄√˘_∑th
, &
s
)) {

326 
îr‹
 = 
î∫o
;

327 
	`VLOG_WARN
(
LOG_MODULE
, "couldÇot stat \"%s\": %s",

328 
˛õ¡
->
c⁄√˘_∑th
, 
	`°ªº‹
(
îr‹
));

329 
îr‹
;

330 } i‡(
	`S_ISREG
(
s
.
°_mode
)) {

331 
pid_t
 
pid
 = 
	`ªad_pidfûe
(
˛õ¡
->
c⁄√˘_∑th
);

332 i‡(
pid
 < 0) {

333 
îr‹
 = -
pid
;

334 
	`VLOG_WARN
(
LOG_MODULE
, "couldÇotÑeadÖidfile \"%s\": %s",

335 
˛õ¡
->
c⁄√˘_∑th
, 
	`°ªº‹
(
îr‹
));

336 
îr‹
;

338 
	`‰ì
(
˛õ¡
->
c⁄√˘_∑th
);

339 
˛õ¡
->
c⁄√˘_∑th
 = 
	`xa•rötf
("/tmp/vlogs.%ld", (Ë
pid
);

341 
˛õ¡
->
böd_∑th
 = 
	`xa•rötf
("/tmp/vlog.%ld.%d",

342 (Ë
	`gëpid
(), 
cou¡î
++);

343 
˛õ¡
->
fd
 = 
	`make_unix_sockë
(
SOCK_DGRAM
, 
Ál£
, false,

344 
˛õ¡
->
böd_∑th
, clõ¡->
c⁄√˘_∑th
);

345 i‡(
˛õ¡
->
fd
 < 0) {

346 
îr‹
 = -
˛õ¡
->
fd
;

347 
îr‹
;

349 *
˛õ¡p
 = 
˛õ¡
;

352 
îr‹
:

353 
	`‰ì
(
˛õ¡
->
c⁄√˘_∑th
);

354 
	`‰ì
(
˛õ¡
->
böd_∑th
);

355 
	`‰ì
(
˛õ¡
);

356 *
˛õ¡p
 = 
NULL
;

357  
îr‹
;

358 
	}
}

362 
	$vlog_˛õ¡_˛o£
(
vlog_˛õ¡
 *
˛õ¡
)

364 i‡(
˛õ¡
) {

365 
	`u∆ök
(
˛õ¡
->
böd_∑th
);

366 
	`Áèl_sig«l_ªmove_fûe_to_u∆ök
(
˛õ¡
->
böd_∑th
);

367 
	`‰ì
(
˛õ¡
->
böd_∑th
);

368 
	`‰ì
(
˛õ¡
->
c⁄√˘_∑th
);

369 
	`˛o£
(
˛õ¡
->
fd
);

370 
	`‰ì
(
˛õ¡
);

372 
	}
}

377 
	$vlog_˛õ¡_£nd
(
vlog_˛õ¡
 *
˛õ¡
, c⁄° *
ªque°
)

379 #ifde‡
SCM_CREDENTIALS


380 
u¸ed
 
¸ed
;

381 
iovec
 
iov
;

382 
buf
[
	`CMSG_SPACE
( 
¸ed
)];

383 
msghdr
 
msg
;

384 
cmsghdr
* 
cmsg
;

385 
ssize_t
 
nbyãs
;

387 
¸ed
.
pid
 = 
	`gëpid
();

388 
¸ed
.
uid
 = 
	`gëuid
();

389 
¸ed
.
gid
 = 
	`gëgid
();

391 
iov
.
iov_ba£
 = (*Ë
ªque°
;

392 
iov
.
iov_Àn
 = 
	`°æí
(
ªque°
);

394 
	`mem£t
(&
msg
, 0,  msg);

395 
msg
.
msg_iov
 = &
iov
;

396 
msg
.
msg_iovÀn
 = 1;

397 
msg
.
msg_c⁄åﬁ
 = 
buf
;

398 
msg
.
msg_c⁄åﬁÀn
 =  
buf
;

400 
cmsg
 = 
	`CMSG_FIRSTHDR
(&
msg
);

401 
cmsg
->
cmsg_Àvñ
 = 
SOL_SOCKET
;

402 
cmsg
->
cmsg_ty≥
 = 
SCM_CREDENTIALS
;

403 
cmsg
->
cmsg_Àn
 = 
	`CMSG_LEN
( 
¸ed
);

404 
	`mem˝y
(
	`CMSG_DATA
(
cmsg
), &
¸ed
,  cred);

405 
msg
.
msg_c⁄åﬁÀn
 = 
cmsg
->
cmsg_Àn
;

407 
nbyãs
 = 
	`£ndmsg
(
˛õ¡
->
fd
, &
msg
, 0);

409 
ssize_t
 
nbyãs
 = 
	`£nd
(
˛õ¡
->
fd
, 
ªque°
, 
	`°æí
(request), 0);

411 i‡(
nbyãs
 > 0) {

412  
nbyãs
 =
	`°æí
(
ªque°
Ë? 0 : 
ENOBUFS
;

414  
î∫o
;

416 
	}
}

423 
	$vlog_˛õ¡_ªcv
(
vlog_˛õ¡
 *
˛õ¡
, **
ª∂y
)

425 
pﬁlfd
 
pfd
;

426 
nfds
;

427 
buf„r
[65536];

428 
ssize_t
 
nbyãs
;

430 *
ª∂y
 = 
NULL
;

432 
pfd
.
fd
 = 
˛õ¡
->fd;

433 
pfd
.
evíts
 = 
POLLIN
;

434 
nfds
 = 
	`time_pﬁl
(&
pfd
, 1, 1000);

435 i‡(
nfds
 == 0) {

436  
ETIMEDOUT
;

437 } i‡(
nfds
 < 0) {

438  -
nfds
;

441 
nbyãs
 = 
	`ªad
(
˛õ¡
->
fd
, 
buf„r
,  buffer - 1);

442 i‡(
nbyãs
 < 0) {

443  
î∫o
;

445 
buf„r
[
nbyãs
] = '\0';

446 *
ª∂y
 = 
	`x°rdup
(
buf„r
);

449 
	}
}

455 
	$vlog_˛õ¡_å™ß˘
(
vlog_˛õ¡
 *
˛õ¡
,

456 c⁄° *
ªque°
, **
ª∂y
)

458 
i
;

461 
i
 = 0; i < 3; ++i) {

462 
îr‹
 = 
	`vlog_˛õ¡_£nd
(
˛õ¡
, 
ªque°
);

463 i‡(
îr‹
) {

464 *
ª∂y
 = 
NULL
;

465  
îr‹
;

467 
îr‹
 = 
	`vlog_˛õ¡_ªcv
(
˛õ¡
, 
ª∂y
);

468 i‡(
îr‹
 !
ETIMEDOUT
) {

469  
îr‹
;

472 *
ª∂y
 = 
NULL
;

473  
ETIMEDOUT
;

474 
	}
}

479 
	$vlog_˛õ¡_èrgë
(c⁄° 
vlog_˛õ¡
 *
˛õ¡
)

481  
˛õ¡
->
c⁄√˘_∑th
;

482 
	}
}

	@lib/vlog-socket.h

34 #i‚de‡
VLOG_SOCKET_H


35 
	#VLOG_SOCKET_H
 1

	)

38 
	gvlog_£rvî
;

39 
vlog_£rvî_li°í
(c⁄° *
∑th
, 
vlog_£rvî
 **);

40 
vlog_£rvî_˛o£
(
vlog_£rvî
 *);

43 
	gvlog_˛õ¡
;

44 
vlog_˛õ¡_c⁄√˘
(c⁄° *
∑th
, 
vlog_˛õ¡
 **);

45 
vlog_˛õ¡_˛o£
(
vlog_˛õ¡
 *);

46 
vlog_˛õ¡_£nd
(
vlog_˛õ¡
 *, c⁄° *
ªque°
);

47 
vlog_˛õ¡_ªcv
(
vlog_˛õ¡
 *, **
ª∂y
);

48 
vlog_˛õ¡_å™ß˘
(
vlog_˛õ¡
 *,

49 c⁄° *
ªque°
, **
ª∂y
);

50 c⁄° *
vlog_˛õ¡_èrgë
(c⁄° 
vlog_˛õ¡
 *);

	@lib/vlog.c

34 
	~<c⁄fig.h
>

35 
	~"vlog.h
"

36 
	~<as£π.h
>

37 
	~<˘y≥.h
>

38 
	~<î∫o.h
>

39 
	~<°d¨g.h
>

40 
	~<°dlib.h
>

41 
	~<°rög.h
>

42 
	~<sys/ty≥s.h
>

43 
	~<sy¶og.h
>

44 
	~<time.h
>

45 
	~<uni°d.h
>

46 
	~"dús.h
"

47 
	~"dy«mic-°rög.h
"

48 
	~"ßt-m©h.h
"

49 
	~"timevÆ.h
"

50 
	~"utû.h
"

52 
	#LOG_MODULE
 
VLM_vlog


	)

55 c⁄° *
	gÀvñ_«mes
[
VLL_N_LEVELS
] = {

56 
	#VLOG_LEVEL
(
NAME
, 
SYSLOG_LEVEL
Ë#NAME,

	)

57 
VLOG_LEVELS


58 #unde‡
VLOG_LEVEL


62 
	gsy¶og_Àvñs
[
VLL_N_LEVELS
] = {

63 
	#VLOG_LEVEL
(
NAME
, 
SYSLOG_LEVEL
ËSYSLOG_LEVEL,

	)

64 
VLOG_LEVELS


65 #unde‡
VLOG_LEVEL


69 c⁄° *
	gmoduÀ_«mes
[
VLM_N_MODULES
] = {

70 
	#VLOG_MODULE
(
NAME
Ë#NAME,

	)

71 
	~"vlog-moduÀs.def
"

72 #unde‡
VLOG_MODULE


76 
	sÁcûôy
 {

77 c⁄° *
	m«me
;

78 *
	m∑âîn
;

79 
boﬁ
 
	mdeÁu…_∑âîn
;

81 
Ácûôy
 
	gÁcûôõs
[
VLF_N_FACILITIES
] = {

82 
	#VLOG_FACILITY
(
NAME
, 
PATTERN
Ë{#NAME, PATTERN, 
åue
},

	)

83 
VLOG_FACILITIES


84 #unde‡
VLOG_FACILITY


88 
	gÀvñs
[
VLM_N_MODULES
][
VLF_N_FACILITIES
];

92 
vlog_Àvñ
 
	gmö_vlog_Àvñs
[
VLM_N_MODULES
];

95 
	gboŸ_time
;

98 *
	glog_fûe_«me
;

99 
FILE
 *
	glog_fûe
;

101 
	$f‹m©_log_mesßge
(
vlog_moduÀ
, 
vlog_Àvñ
,

102 
vlog_Ácûôy
, 
msg_num
,

103 c⁄° *
mesßge
, 
va_li°
, 
ds
 *)

104 
	`PRINTF_FORMAT
(5, 0);

108 
size_t


109 
	$£¨ch_«me_¨øy
(c⁄° *
èrgë
, c⁄° **
«mes
, 
size_t
 
n_«mes
)

111 
size_t
 
i
;

113 
i
 = 0; i < 
n_«mes
; i++) {

114 
	`as£π
(
«mes
[
i
]);

115 i‡(!
	`°rˇ£cmp
(
«mes
[
i
], 
èrgë
)) {

119  
i
;

120 
	}
}

124 
	$vlog_gë_Àvñ_«me
(
vlog_Àvñ
 
Àvñ
)

126 
	`as£π
(
Àvñ
 < 
VLL_N_LEVELS
);

127  
Àvñ_«mes
[
Àvñ
];

128 
	}
}

132 
vlog_Àvñ


133 
	$vlog_gë_Àvñ_vÆ
(c⁄° *
«me
)

135  
	`£¨ch_«me_¨øy
(
«me
, 
Àvñ_«mes
, 
	`ARRAY_SIZE
(level_names));

136 
	}
}

140 
	$vlog_gë_Ácûôy_«me
(
vlog_Ácûôy
 
Ácûôy
)

142 
	`as£π
(
Ácûôy
 < 
VLF_N_FACILITIES
);

143  
Ácûôõs
[
Ácûôy
].
«me
;

144 
	}
}

148 
vlog_Ácûôy


149 
	$vlog_gë_Ácûôy_vÆ
(c⁄° *
«me
)

151 
size_t
 
i
;

153 
i
 = 0; i < 
VLF_N_FACILITIES
; i++) {

154 i‡(!
	`°rˇ£cmp
(
Ácûôõs
[
i
].
«me
,Çame)) {

158  
i
;

159 
	}
}

162 c⁄° *
	$vlog_gë_moduÀ_«me
(
vlog_moduÀ
 
moduÀ
)

164 
	`as£π
(
moduÀ
 < 
VLM_N_MODULES
);

165  
moduÀ_«mes
[
moduÀ
];

166 
	}
}

170 
vlog_moduÀ


171 
	$vlog_gë_moduÀ_vÆ
(c⁄° *
«me
)

173  
	`£¨ch_«me_¨øy
(
«me
, 
moduÀ_«mes
, 
	`ARRAY_SIZE
(module_names));

174 
	}
}

177 
vlog_Àvñ


178 
	$vlog_gë_Àvñ
(
vlog_moduÀ
 
moduÀ
, 
vlog_Ácûôy
 
Ácûôy
)

180 
	`as£π
(
moduÀ
 < 
VLM_N_MODULES
);

181 
	`as£π
(
Ácûôy
 < 
VLF_N_FACILITIES
);

182  
Àvñs
[
moduÀ
][
Ácûôy
];

183 
	}
}

186 
	$upd©e_mö_Àvñ
(
vlog_moduÀ
 
moduÀ
)

188 
vlog_Àvñ
 
mö_Àvñ
 = 
VLL_EMER
;

189 
vlog_Ácûôy
 
Ácûôy
;

191 
Ácûôy
 = 0; facûôy < 
VLF_N_FACILITIES
; facility++) {

192 i‡(
log_fûe
 || 
Ácûôy
 !
VLF_FILE
) {

193 
mö_Àvñ
 = 
	`MAX
(mö_Àvñ, 
Àvñs
[
moduÀ
][
Ácûôy
]);

196 
mö_vlog_Àvñs
[
moduÀ
] = 
mö_Àvñ
;

197 
	}
}

200 
	$£t_Ácûôy_Àvñ
(
vlog_Ácûôy
 
Ácûôy
, 
vlog_moduÀ
 
moduÀ
,

201 
vlog_Àvñ
 
Àvñ
)

203 
	`as£π
(
Ácûôy
 >0 && facûôy < 
VLF_N_FACILITIES
);

204 
	`as£π
(
Àvñ
 < 
VLL_N_LEVELS
);

206 i‡(
moduÀ
 =
VLM_ANY_MODULE
) {

207 
moduÀ
 = 0; moduÀ < 
VLM_N_MODULES
; module++) {

208 
Àvñs
[
moduÀ
][
Ácûôy
] = 
Àvñ
;

209 
	`upd©e_mö_Àvñ
(
moduÀ
);

212 
Àvñs
[
moduÀ
][
Ácûôy
] = 
Àvñ
;

213 
	`upd©e_mö_Àvñ
(
moduÀ
);

215 
	}
}

219 
	$vlog_£t_Àvñs
(
vlog_moduÀ
 
moduÀ
, 
vlog_Ácûôy
 
Ácûôy
,

220 
vlog_Àvñ
 
Àvñ
)

222 
	`as£π
(
Ácûôy
 < 
VLF_N_FACILITIES
 || facûôy =
VLF_ANY_FACILITY
);

223 i‡(
Ácûôy
 =
VLF_ANY_FACILITY
) {

224 
Ácûôy
 = 0; facûôy < 
VLF_N_FACILITIES
; facility++) {

225 
	`£t_Ácûôy_Àvñ
(
Ácûôy
, 
moduÀ
, 
Àvñ
);

228 
	`£t_Ácûôy_Àvñ
(
Ácûôy
, 
moduÀ
, 
Àvñ
);

230 
	}
}

233 
	$do_£t_∑âîn
(
vlog_Ácûôy
 
Ácûôy
, c⁄° *
∑âîn
)

235 
Ácûôy
 *
f
 = &
Ácûôõs
[facility];

236 i‡(!
f
->
deÁu…_∑âîn
) {

237 
	`‰ì
(
f
->
∑âîn
);

239 
f
->
deÁu…_∑âîn
 = 
Ál£
;

241 
f
->
∑âîn
 = 
	`x°rdup
(pattern);

242 
	}
}

246 
	$vlog_£t_∑âîn
(
vlog_Ácûôy
 
Ácûôy
, c⁄° *
∑âîn
)

248 
	`as£π
(
Ácûôy
 < 
VLF_N_FACILITIES
 || facûôy =
VLF_ANY_FACILITY
);

249 i‡(
Ácûôy
 =
VLF_ANY_FACILITY
) {

250 
Ácûôy
 = 0; facûôy < 
VLF_N_FACILITIES
; facility++) {

251 
	`do_£t_∑âîn
(
Ácûôy
, 
∑âîn
);

254 
	`do_£t_∑âîn
(
Ácûôy
, 
∑âîn
);

256 
	}
}

263 
	$vlog_gë_log_fûe
()

265  
log_fûe_«me
;

266 
	}
}

272 
	$vlog_£t_log_fûe
(c⁄° *
fûe_«me
)

274 *
ﬁd_log_fûe_«me
;

275 
vlog_moduÀ
 
moduÀ
;

276 
îr‹
;

279 i‡(
log_fûe
) {

280 
	`VLOG_INFO
(
LOG_MODULE
, "closingÜog file");

281 
	`f˛o£
(
log_fûe
);

282 
log_fûe
 = 
NULL
;

287 
ﬁd_log_fûe_«me
 = 
log_fûe_«me
;

288 
log_fûe_«me
 = (
fûe_«me


289 ? 
	`x°rdup
(
fûe_«me
)

290 : 
	`xa•rötf
("%s/%s.log", 
oÂ_logdú
, 
¥ogøm_«me
));

291 
	`‰ì
(
ﬁd_log_fûe_«me
);

292 
fûe_«me
 = 
NULL
;

296 
log_fûe
 = 
	`f›í
(
log_fûe_«me
, "a");

297 
moduÀ
 = 0; moduÀ < 
VLM_N_MODULES
; module++) {

298 
	`upd©e_mö_Àvñ
(
moduÀ
);

302 i‡(!
log_fûe
) {

303 
	`VLOG_WARN
(
LOG_MODULE
, "failedÅo open %s forÜogging: %s",

304 
log_fûe_«me
, 
	`°ªº‹
(
î∫o
));

305 
îr‹
 = 
î∫o
;

307 
	`VLOG_INFO
(
LOG_MODULE
, "›íedÜog fûê%s", 
log_fûe_«me
);

308 
îr‹
 = 0;

311  
îr‹
;

312 
	}
}

318 
	$vlog_ª›í_log_fûe
()

320  
	`vlog_£t_log_fûe
(
log_fûe_«me
);

321 
	}
}

331 
	$vlog_£t_Àvñs_‰om_°rög
(c⁄° *
s_
)

333 *
ßve_±r
;

334 *
s
 = 
	`x°rdup
(
s_
);

335 *
moduÀ
, *
Ácûôy
;

337 
moduÀ
 = 
	`°πok_r
(
s
, ": \t", &
ßve_±r
); moduÀ !
NULL
;

338 
moduÀ
 = 
	`°πok_r
(
NULL
, ": \t", &
ßve_±r
)) {

339 
vlog_moduÀ
 
e_moduÀ
;

340 
vlog_Ácûôy
 
e_Ácûôy
;

342 
Ácûôy
 = 
	`°πok_r
(
NULL
, ":", &
ßve_±r
);

344 i‡(!
Ácûôy
 || !
	`°rcmp
(facility, "ANY")) {

345 
e_Ácûôy
 = 
VLF_ANY_FACILITY
;

347 
e_Ácûôy
 = 
	`vlog_gë_Ácûôy_vÆ
(
Ácûôy
);

348 i‡(
e_Ácûôy
 >
VLF_N_FACILITIES
) {

349 *
msg
 = 
	`xa•rötf
("unknow¿Ácûôy \"%s\"", 
Ácûôy
);

350 
	`‰ì
(
s
);

351  
msg
;

355 i‡(!
	`°rcmp
(
moduÀ
, "PATTERN")) {

356 
	`vlog_£t_∑âîn
(
e_Ácûôy
, 
ßve_±r
);

359 *
Àvñ
;

360 
vlog_Àvñ
 
e_Àvñ
;

362 i‡(!
	`°rcmp
(
moduÀ
, "ANY")) {

363 
e_moduÀ
 = 
VLM_ANY_MODULE
;

365 
e_moduÀ
 = 
	`vlog_gë_moduÀ_vÆ
(
moduÀ
);

366 i‡(
e_moduÀ
 >
VLM_N_MODULES
) {

367 *
msg
 = 
	`xa•rötf
("unknow¿moduÀ \"%s\"", 
moduÀ
);

368 
	`‰ì
(
s
);

369  
msg
;

373 
Àvñ
 = 
	`°πok_r
(
NULL
, ":", &
ßve_±r
);

374 
e_Àvñ
 = 
Àvñ
 ? 
	`vlog_gë_Àvñ_vÆ
÷evñË: 
VLL_DBG
;

375 i‡(
e_Àvñ
 >
VLL_N_LEVELS
) {

376 *
msg
 = 
	`xa•rötf
("unknow¿Àvñ \"%s\"", 
Àvñ
);

377 
	`‰ì
(
s
);

378  
msg
;

381 
	`vlog_£t_Àvñs
(
e_moduÀ
, 
e_Ácûôy
, 
e_Àvñ
);

384 
	`‰ì
(
s
);

385  
NULL
;

386 
	}
}

391 
	$vlog_£t_vîbosôy
(c⁄° *
¨g
)

393 i‡(
¨g
) {

394 *
msg
 = 
	`vlog_£t_Àvñs_‰om_°rög
(
¨g
);

395 i‡(
msg
) {

396 
	`oÂ_Áèl
(0, "¥o˚ssög \"%s\": %s", 
¨g
, 
msg
);

399 
	`vlog_£t_Àvñs
(
VLM_ANY_MODULE
, 
VLF_ANY_FACILITY
, 
VLL_DBG
);

401 
	}
}

405 
	$vlog_öô
()

407 
time_t
 
now
;

409 
	`›ílog
(
¥ogøm_«me
, 
LOG_NDELAY
, 
LOG_DAEMON
);

410 
	`vlog_£t_Àvñs
(
VLM_ANY_MODULE
, 
VLF_ANY_FACILITY
, 
VLL_INFO
);

412 
boŸ_time
 = 
	`time_m£c
();

413 
now
 = 
	`time_now
();

414 i‡(
now
 < 0) {

415 
tm
Åm;

416 
s
[128];

418 
	`loˇ…ime_r
(&
now
, &
tm
);

419 
	`°r·ime
(
s
,  s, "%a, %d %b %Y %H:%M:%S %z", &
tm
);

420 
	`VLOG_ERR
(
LOG_MODULE
, "cuºíàtimêi†√g©ive: %†(%ld)", 
s
, (Ë
now
);

422 
	}
}

426 
	$vlog_exô
()

428 
	`˛o£log
();

429 
	}
}

433 
	$vlog_gë_Àvñs
()

435 
ds
 
s
 = 
DS_EMPTY_INITIALIZER
;

436 
vlog_moduÀ
 
moduÀ
;

438 
	`ds_put_f‹m©
(&
s
, " console syslog file\n");

439 
	`ds_put_f‹m©
(&
s
, " ------- ------ ------\n");

441 
moduÀ
 = 0; moduÀ < 
VLM_N_MODULES
; module++) {

442 
	`ds_put_f‹m©
(&
s
, "%-16s %4s %4s %4s\n",

443 
	`vlog_gë_moduÀ_«me
(
moduÀ
),

444 
	`vlog_gë_Àvñ_«me
(
	`vlog_gë_Àvñ
(
moduÀ
, 
VLF_CONSOLE
)),

445 
	`vlog_gë_Àvñ_«me
(
	`vlog_gë_Àvñ
(
moduÀ
, 
VLF_SYSLOG
)),

446 
	`vlog_gë_Àvñ_«me
(
	`vlog_gë_Àvñ
(
moduÀ
, 
VLF_FILE
)));

449  
	`ds_c°r
(&
s
);

450 
	}
}

455 
boﬁ


456 
	$vlog_is_íabÀd
(
vlog_moduÀ
 
moduÀ
, 
vlog_Àvñ
 
Àvñ
)

458  
mö_vlog_Àvñs
[
moduÀ
] >
Àvñ
;

459 
	}
}

462 
	$„tch_bø˚s
(c⁄° *
p
, c⁄° *
def
, *
out
, 
size_t
 
out_size
)

464 i‡(*
p
 == '{') {

465 
size_t
 
n
 = 
	`°rc•n
(
p
 + 1, "}");

466 
size_t
 
n_c›y
 = 
	`MIN
(
n
, 
out_size
 - 1);

467 
	`mem˝y
(
out
, 
p
 + 1, 
n_c›y
);

468 
out
[
n_c›y
] = '\0';

469 
p
 +
n
 + 2;

471 
	`°æ˝y
(
out
, 
def
, 
out_size
);

473  
p
;

474 
	}
}

477 
	$f‹m©_log_mesßge
(
vlog_moduÀ
 
moduÀ
, 
vlog_Àvñ
 
Àvñ
,

478 
vlog_Ácûôy
 
Ácûôy
, 
msg_num
,

479 c⁄° *
mesßge
, 
va_li°
 
¨gs_
, 
ds
 *
s
)

481 
tmp
[128];

482 
va_li°
 
¨gs
;

483 c⁄° *
p
;

485 
	`ds_˛ór
(
s
);

486 
p
 = 
Ácûôõs
[
Ácûôy
].
∑âîn
; *p != '\0'; ) {

487 íum { 
LEFT
, 
RIGHT
 } 
ju°ify
 = RIGHT;

488 
∑d
 = '0';

489 
size_t
 
Àngth
, 
fõld
, 
u£d
;

491 i‡(*
p
 != '%') {

492 
	`ds_put_ch¨
(
s
, *
p
++);

496 
p
++;

497 i‡(*
p
 == '-') {

498 
ju°ify
 = 
LEFT
;

499 
p
++;

501 i‡(*
p
 == '0') {

502 
∑d
 = '0';

503 
p
++;

505 
fõld
 = 0;

506 
	`isdigô
(*
p
)) {

507 
fõld
 = (fõld * 10Ë+ (*
p
 - '0');

508 
p
++;

511 
Àngth
 = 
s
->length;

512 *
p
++) {

514 
	`ds_put_c°r
(
s
, 
¥ogøm_«me
);

517 
p
 = 
	`„tch_bø˚s
’, "", 
tmp
, Åmp);

518 
	`ds_put_c°r
(
s
, 
	`vlog_gë_moduÀ_«me
(
moduÀ
));

521 
p
 = 
	`„tch_bø˚s
’, "%Y-%m-%d %H:%M:%S", 
tmp
, Åmp);

522 
	`ds_put_°r·ime
(
s
, 
tmp
, 
NULL
);

525 
	`va_c›y
(
¨gs
, 
¨gs_
);

526 
	`ds_put_f‹m©_vÆi°
(
s
, 
mesßge
, 
¨gs
);

527 
	`va_íd
(
¨gs
);

530 
	`ds_put_f‹m©
(
s
, "%u", 
msg_num
);

533 
	`ds_put_ch¨
(
s
, '\n');

536 
	`ds_put_c°r
(
s
, 
	`vlog_gë_Àvñ_«me
(
Àvñ
));

539 
	`ds_put_f‹m©
(
s
, "%ld", (Ë
	`gëpid
());

542 
	`ds_put_f‹m©
(
s
, "%Œd", 
	`time_m£c
(Ë- 
boŸ_time
);

545 
	`ds_put_ch¨
(
s
, 
p
[-1]);

548 
u£d
 = 
s
->
Àngth
 -Üength;

549 i‡(
u£d
 < 
fõld
) {

550 
size_t
 
n_∑d
 = 
fõld
 - 
u£d
;

551 i‡(
ju°ify
 =
RIGHT
) {

552 
	`ds_put_unöô
(
s
, 
n_∑d
);

553 
	`memmove
(&
s
->
°rög
[
Àngth
 + 
n_∑d
], &s->°rög[Àngth], 
u£d
);

554 
	`mem£t
(&
s
->
°rög
[
Àngth
], 
∑d
, 
n_∑d
);

556 
	`ds_put_ch¨_mu…ùÀ
(
s
, 
∑d
, 
n_∑d
);

560 
	}
}

567 
	$vlog_vÆi°
(
vlog_moduÀ
 
moduÀ
, 
vlog_Àvñ
 
Àvñ
,

568 c⁄° *
mesßge
, 
va_li°
 
¨gs
)

570 
boﬁ
 
log_to_c⁄sﬁe
 = 
Àvñs
[
moduÀ
][
VLF_CONSOLE
] >
Àvñ
;

571 
boﬁ
 
log_to_sy¶og
 = 
Àvñs
[
moduÀ
][
VLF_SYSLOG
] >
Àvñ
;

572 
boﬁ
 
log_to_fûe
 = 
Àvñs
[
moduÀ
][
VLF_FILE
] >
Àvñ
 && 
log_fûe
;

573 i‡(
log_to_c⁄sﬁe
 || 
log_to_sy¶og
 || 
log_to_fûe
) {

574 
ßve_î∫o
 = 
î∫o
;

575 
msg_num
;

576 
ds
 
s
;

578 
	`ds_öô
(&
s
);

579 
	`ds_ª£rve
(&
s
, 1024);

580 
msg_num
++;

582 i‡(
log_to_c⁄sﬁe
) {

583 
	`f‹m©_log_mesßge
(
moduÀ
, 
Àvñ
, 
VLF_CONSOLE
, 
msg_num
,

584 
mesßge
, 
¨gs
, &
s
);

585 
	`ds_put_ch¨
(&
s
, '\n');

586 
	`Âuts
(
	`ds_c°r
(&
s
), 
°dîr
);

589 i‡(
log_to_sy¶og
) {

590 
sy¶og_Àvñ
 = 
sy¶og_Àvñs
[
Àvñ
];

591 *
ßve_±r
 = 
NULL
;

592 *
löe
;

594 
	`f‹m©_log_mesßge
(
moduÀ
, 
Àvñ
, 
VLF_SYSLOG
, 
msg_num
,

595 
mesßge
, 
¨gs
, &
s
);

596 
löe
 = 
	`°πok_r
(
s
.
°rög
, "\n", &
ßve_±r
);Üine;

597 
löe
 = 
	`°πok_r
(
NULL
, "\n", &
ßve_±r
)) {

598 
	`sy¶og
(
sy¶og_Àvñ
, "%s", 
löe
);

602 i‡(
log_to_fûe
) {

603 
	`f‹m©_log_mesßge
(
moduÀ
, 
Àvñ
, 
VLF_FILE
, 
msg_num
,

604 
mesßge
, 
¨gs
, &
s
);

605 
	`ds_put_ch¨
(&
s
, '\n');

606 
	`Âuts
(
	`ds_c°r
(&
s
), 
log_fûe
);

607 
	`fÊush
(
log_fûe
);

610 
	`ds_de°roy
(&
s
);

611 
î∫o
 = 
ßve_î∫o
;

613 
	}
}

616 
	$vlog
(
vlog_moduÀ
 
moduÀ
, 
vlog_Àvñ
 
Àvñ
, c⁄° *
mesßge
, ...)

618 
va_li°
 
¨gs
;

620 
	`va_°¨t
(
¨gs
, 
mesßge
);

621 
	`vlog_vÆi°
(
moduÀ
, 
Àvñ
, 
mesßge
, 
¨gs
);

622 
	`va_íd
(
¨gs
);

623 
	}
}

626 
	$vlog_øã_limô
(
vlog_moduÀ
 
moduÀ
, 
vlog_Àvñ
 
Àvñ
,

627 
vlog_øã_limô
 *
æ
, c⁄° *
mesßge
, ...)

629 
va_li°
 
¨gs
;

631 i‡(!
	`vlog_is_íabÀd
(
moduÀ
, 
Àvñ
)) {

635 i‡(
æ
->
tokís
 < 
VLOG_MSG_TOKENS
) {

636 
time_t
 
now
 = 
	`time_now
();

637 i‡(
æ
->
œ°_fûl
 > 
now
) {

640 
æ
->
tokís
 =Ñl->
bur°
;

641 } i‡(
æ
->
œ°_fûl
 < 
now
) {

642 
add
 = 
	`ßt_mul
(
æ
->
øã
, 
now
 -Ñl->
œ°_fûl
);

643 
tokís
 = 
	`ßt_add
(
æ
->tokís, 
add
);

644 
æ
->
tokís
 = 
	`MIN
—okís,Ñl->
bur°
);

645 
æ
->
œ°_fûl
 = 
now
;

647 i‡(
æ
->
tokís
 < 
VLOG_MSG_TOKENS
) {

648 i‡(!
æ
->
n_dr›≥d
) {

649 
æ
->
fú°_dr›≥d
 = 
now
;

651 
æ
->
n_dr›≥d
++;

655 
æ
->
tokís
 -
VLOG_MSG_TOKENS
;

657 
	`va_°¨t
(
¨gs
, 
mesßge
);

658 
	`vlog_vÆi°
(
moduÀ
, 
Àvñ
, 
mesßge
, 
¨gs
);

659 
	`va_íd
(
¨gs
);

661 i‡(
æ
->
n_dr›≥d
) {

662 
	`vlog
(
moduÀ
, 
Àvñ
,

664 
æ
->
n_dr›≥d
, (Ë(
	`time_now
(Ë-Ñl->
fú°_dr›≥d
));

665 
æ
->
n_dr›≥d
 = 0;

667 
	}
}

670 
	$vlog_ußge
()

672 
	`¥ötf
("\nLogging options:\n"

677 
oÂ_logdú
, 
¥ogøm_«me
);

678 
	}
}

	@lib/vlog.h

34 #i‚de‡
VLOG_H


35 
	#VLOG_H
 1

	)

37 
	~<limôs.h
>

38 
	~<°d¨g.h
>

39 
	~<°dboﬁ.h
>

40 
	~<time.h
>

41 
	~"utû.h
"

44 
	#VLOG_LEVELS
 \

45 
	`VLOG_LEVEL
(
EMER
, 
LOG_ALERT
) \

46 
	`VLOG_LEVEL
(
ERR
, 
LOG_ERR
) \

47 
	`VLOG_LEVEL
(
WARN
, 
LOG_WARNING
) \

48 
	`VLOG_LEVEL
(
INFO
, 
LOG_NOTICE
) \

49 
	`VLOG_LEVEL
(
DBG
, 
LOG_DEBUG
)

	)

50 
	evlog_Àvñ
 {

51 
	#VLOG_LEVEL
(
NAME
, 
SYSLOG_LEVEL
Ë
VLL_
##NAME,

	)

52 
	mVLOG_LEVELS


53 #unde‡
VLOG_LEVEL


54 
	mVLL_N_LEVELS


57 c⁄° *
vlog_gë_Àvñ_«me
(
vlog_Àvñ
);

58 
vlog_Àvñ
 
vlog_gë_Àvñ_vÆ
(c⁄° *
«me
);

61 
	#VLOG_FACILITIES
 \

62 
	`VLOG_FACILITY
(
SYSLOG
, "%05N|%c|%p|%m") \

63 
	`VLOG_FACILITY
(
CONSOLE
, "%d{%b %d %H:%M:%S}|%05N|%c|%p|%m") \

64 
	`VLOG_FACILITY
(
FILE
, "%d{%b %d %H:%M:%S}|%05N|%c|%p|%m")

	)

65 
	evlog_Ácûôy
 {

66 
	#VLOG_FACILITY
(
NAME
, 
PATTERN
Ë
VLF_
##NAME,

	)

67 
	mVLOG_FACILITIES


68 #unde‡
VLOG_FACILITY


69 
	mVLF_N_FACILITIES
,

70 
	mVLF_ANY_FACILITY
 = -1

73 c⁄° *
vlog_gë_Ácûôy_«me
(
vlog_Ácûôy
);

74 
vlog_Ácûôy
 
vlog_gë_Ácûôy_vÆ
(c⁄° *
«me
);

77 
	evlog_moduÀ
 {

78 
	#VLOG_MODULE
(
NAME
Ë
VLM_
##NAME,

	)

79 
	~"vlog-moduÀs.def
"

80 
	mVLM_N_MODULES
,

81 
	mVLM_ANY_MODULE
 = -1

84 c⁄° *
vlog_gë_moduÀ_«me
(
vlog_moduÀ
);

85 
vlog_moduÀ
 
vlog_gë_moduÀ_vÆ
(c⁄° *
«me
);

88 
	svlog_øã_limô
 {

90 
	møã
;

91 
	mbur°
;

94 
	mtokís
;

95 
time_t
 
	mœ°_fûl
;

96 
time_t
 
	mfú°_dr›≥d
;

97 
	mn_dr›≥d
;

103 
	#VLOG_MSG_TOKENS
 60

	)

107 
	#VLOG_RATE_LIMIT_INIT
(
RATE
, 
BURST
) \

109 
RATE
, \

110 (
	`MIN
(
BURST
, 
UINT_MAX
 / 
VLOG_MSG_TOKENS
) \

111 * 
VLOG_MSG_TOKENS
), \

116 }

	)

119 
vlog_Àvñ
 
vlog_gë_Àvñ
(
vlog_moduÀ
, 
vlog_Ácûôy
);

120 
vlog_£t_Àvñs
(
vlog_moduÀ
, 
vlog_Ácûôy
, 
vlog_Àvñ
);

121 *
vlog_£t_Àvñs_‰om_°rög
(const *);

122 *
vlog_gë_Àvñs
();

123 
boﬁ
 
vlog_is_íabÀd
(
vlog_moduÀ
, 
vlog_Àvñ
);

124 
vlog_£t_vîbosôy
(c⁄° *
¨g
);

127 
vlog_£t_∑âîn
(
vlog_Ácûôy
, c⁄° *
∑âîn
);

128 c⁄° *
vlog_gë_log_fûe
();

129 
vlog_£t_log_fûe
(c⁄° *
fûe_«me
);

130 
vlog_ª›í_log_fûe
();

133 
vlog_öô
();

134 
vlog_exô
();

135 
	$vlog
(
vlog_moduÀ
, 
vlog_Àvñ
, c⁄° *
f‹m©
, ...)

136 
	`__©åibuã__
((
	`f‹m©
(
¥ötf
, 3, 4)));

137 
	$vlog_vÆi°
(
vlog_moduÀ
, 
vlog_Àvñ
, c⁄° *, 
va_li°
)

138 
	`__©åibuã__
((
	`f‹m©
(
¥ötf
, 3, 0)));

139 
	$vlog_øã_limô
(
vlog_moduÀ
, 
vlog_Àvñ
,

140 
vlog_øã_limô
 *, const *, ...)

141 
	`__©åibuã__
((
	`f‹m©
(
¥ötf
, 4, 5)));

146 
	#VLOG_EMER
(
MODULE
, ...Ë
	`VLOG
(MODULE, 
VLL_EMER
, 
__VA_ARGS__
)

	)

147 
	#VLOG_ERR
(
MODULE
, ...Ë
	`VLOG
(MODULE, 
VLL_ERR
, 
__VA_ARGS__
)

	)

148 
	#VLOG_WARN
(
MODULE
, ...Ë
	`VLOG
(MODULE, 
VLL_WARN
, 
__VA_ARGS__
)

	)

149 
	#VLOG_INFO
(
MODULE
, ...Ë
	`VLOG
(MODULE, 
VLL_INFO
, 
__VA_ARGS__
)

	)

150 
	#VLOG_DBG
(
MODULE
, ...Ë
	`VLOG
(MODULE, 
VLL_DBG
, 
__VA_ARGS__
)

	)

155 
	#VLOG_IS_EMER_ENABLED
(
MODULE
Ë
åue


	)

156 
	#VLOG_IS_ERR_ENABLED
(
MODULE
Ë
	`vlog_is_íabÀd
(MODULE, 
VLL_EMER
)

	)

157 
	#VLOG_IS_WARN_ENABLED
(
MODULE
Ë
	`vlog_is_íabÀd
(MODULE, 
VLL_WARN
)

	)

158 
	#VLOG_IS_INFO_ENABLED
(
MODULE
Ë
	`vlog_is_íabÀd
(MODULE, 
VLL_INFO
)

	)

159 
	#VLOG_IS_DBG_ENABLED
(
MODULE
Ë
	`vlog_is_íabÀd
(MODULE, 
VLL_DBG
)

	)

164 
	#VLOG_ERR_RL
(
MODULE
, 
RL
, ...Ë
	`VLOG_RL
(MODULE, RL, 
VLL_ERR
, 
__VA_ARGS__
)

	)

165 
	#VLOG_WARN_RL
(
MODULE
, 
RL
, ...Ë
	`VLOG_RL
(MODULE, RL, 
VLL_WARN
, 
__VA_ARGS__
)

	)

166 
	#VLOG_INFO_RL
(
MODULE
, 
RL
, ...Ë
	`VLOG_RL
(MODULE, RL, 
VLL_INFO
, 
__VA_ARGS__
)

	)

167 
	#VLOG_DBG_RL
(
MODULE
, 
RL
, ...Ë
	`VLOG_RL
(MODULE, RL, 
VLL_DBG
, 
__VA_ARGS__
)

	)

170 
	#VLOG_OPTION_ENUMS
 
OPT_LOG_FILE


	)

171 
	#VLOG_LONG_OPTIONS
 \

172 {"vîbo£", 
›ti⁄Æ_¨gumít
, 0, 'v'
	}
}, \

173 {"log-fûe", 
›ti⁄Æ_¨gumít
, 0, 
OPT_LOG_FILE
}

	)

174 
	#VLOG_OPTION_HANDLERS
 \

176 
	`vlog_£t_vîbosôy
(
›èrg
); \

178 
OPT_LOG_FILE
: \

179 
	`vlog_£t_log_fûe
(
›èrg
); \

180 ;

	)

181 
vlog_ußge
();

184 
	#VLOG
(
MODULE
, 
LEVEL
, ...) \

186 i‡(
mö_vlog_Àvñs
[
MODULE
] >
LEVEL
) { \

187 
	`vlog
(
MODULE
, 
LEVEL
, 
__VA_ARGS__
); \

189 } 0)

	)

190 
	#VLOG_RL
(
MODULE
, 
RL
, 
LEVEL
, ...) \

192 i‡(
mö_vlog_Àvñs
[
MODULE
] >
LEVEL
) { \

193 
	`vlog_øã_limô
(
MODULE
, 
LEVEL
, 
RL
, 
__VA_ARGS__
); \

195 } 0)

	)

196 
vlog_Àvñ
 
mö_vlog_Àvñs
[
VLM_N_MODULES
];

	@lib/xtoxll.h

33 #i‚de‡
XTOXLL_H


34 
	#XTOXLL_H
 1

	)

36 
	~<¨∑/öë.h
>

37 
	~<sys/ty≥s.h
>

39 
ölöe
 
uöt64_t


40 
	$ht⁄Œ
(
uöt64_t
 
n
)

42  
	`ht⁄l
(1Ë=1 ? 
n
 : ((
uöt64_t
) htonl(n) << 32) | htonl(n >> 32);

43 
	}
}

45 
ölöe
 
uöt64_t


46 
	$¡ohŒ
(
uöt64_t
 
n
)

48  
	`ht⁄l
(1Ë=1 ? 
n
 : ((
uöt64_t
Ë
	`¡ohl
(n) << 32) |Çtohl(n >> 32);

49 
	}
}

	@nbee_link/nbee_link.h

8 #i‚de‡
NBEE_LINK_H_


9 
	#NBEE_LINK_H_


	)

11 
	~<°dio.h
>

12 
	~<öây≥s.h
>

13 
	~<°dlib.h
>

15 
	~"lib/hm≠.h
"

16 
	~"lib/oÂbuf.h
"

17 
	~"lib/∑ckës.h
"

19 
	#ETHADDLEN
 6

	)

20 
	#IPV6ADDLEN
 16

	)

21 
	#ETHTYPELEN
 2

	)

22 
	#ERRBUF_SIZE
 256

	)

25 
	#HBH_ALLOWED
 
DESTINATION
 ^ 
ROUTING
 ^ 
FRAGMENT
 ^ 
AUTHENTICATION
 ^ 
ESP


	)

26 
	#DESTINATION_ALLOWED
 
ROUTING


	)

27 
	#ROUTING_ALLOWED
 
FRAGMENT
 ^ 
AUTHENTICATION
 ^ 
ESP
 ^ 
DESTINATION


	)

28 
	#FRAG_ALLOWED
 
AUTHENTICATION
 ^ 
ESP
 ^ 
DESTINATION


	)

29 
	#AUTH_ALLOWED
 
ESP
 ^ 
DESTINATION


	)

30 
	#ESP_ALLOWED
 
DESTINATION


	)

32 
	#DOH_BEF_RH
 1

	)

33 
	#DOH_AFTER_RH
 2

	)

34 
	#DOH_NO_RH
 3

	)

36 
	spˇp_pkthdr
 {

37 
timevÆ
 
	mts
;

38 
uöt32_t
 
	mˇ∂í
;

39 
uöt32_t
 
	mÀn
;

40 }
	tpˇp_pkthdr_t
;

43 
	sc⁄åﬁ_eh_fõlds
 {

44 
uöt8_t
 
	mcou¡_DOEH
;

45 
uöt32_t
 
	mposôi⁄_EH
[10];

49 #ifde‡
__˝lu•lus


52 
nblök_öôülize
();

54 #ifde‡
__˝lu•lus


57 
nblök_∑ckë_∑r£
(
oÂbuf
 * 
pktö
, 
oÊ_m©ch
 * 
pktout
, 
¥Ÿocﬁs_°d
 * 
pkt_¥Ÿo
);

	@oflib-exp/ofl-exp-nicira.c

32 
	~<°dlib.h
>

33 
	~<°dio.h
>

34 
	~<√töë/ö.h
>

36 
	~"›íÊow/›íÊow.h
"

37 
	~"›íÊow/nicúa-ext.h
"

38 
	~"oÊ-exp-nicúa.h
"

39 
	~"../oÊib/oÊ-¥öt.h
"

40 
	~"../oÊib/oÊ-log.h
"

42 
	#LOG_MODULE
 
oÊ_exp_nx


	)

43 
	$OFL_LOG_INIT
(
LOG_MODULE
)

47 
	$oÊ_exp_nicúa_msg_∑ck
(
oÊ_msg_ex≥rimíãr
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

48 i‡(
msg
->
ex≥rimíãr_id
 =
NX_VENDOR_ID
) {

49 
oÊ_exp_nicúa_msg_hódî
 *
exp
 = (oÊ_exp_nicúa_msg_hódî *)
msg
;

50 
exp
->
ty≥
) {

51 (
NXT_ROLE_REQUEST
):

52 (
NXT_ROLE_REPLY
): {

53 
oÊ_exp_nicúa_msg_rﬁe
 *
rﬁe
 = (oÊ_exp_nicúa_msg_rﬁê*)
exp
;

54 
nx_rﬁe_ªque°
 *
oÂ
;

56 *
buf_Àn
 = (
nx_rﬁe_ªque°
);

57 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

59 
oÂ
 = (
nx_rﬁe_ªque°
 *)(*
buf
);

60 
oÂ
->
nxh
.
víd‹
 = 
	`ht⁄l
(
exp
->
hódî
.
ex≥rimíãr_id
);

61 
oÂ
->
nxh
.
subty≥
 = 
	`ht⁄l
(
exp
->
ty≥
);

62 
oÂ
->
rﬁe
 = 
	`ht⁄l
(role->role);

67 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÖrint unknown Nicira Experimenter message.");

72 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÖrintÇon-Nicira Experimenter message.");

75 
	}
}

77 
oÊ_îr


78 
	$oÊ_exp_nicúa_msg_u≈ack
(
oÂ_hódî
 *
oh
, 
size_t
 *
Àn
, 
oÊ_msg_ex≥rimíãr
 **
msg
) {

79 
nicúa_hódî
 *
exp
;

81 i‡(*
Àn
 < (
nicúa_hódî
)) {

82 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived EXPERIMENTER mesßgêha†övÆidÜígth (%zu).", *
Àn
);

83  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

86 
exp
 = (
nicúa_hódî
 *)
oh
;

88 i‡(
	`¡ohl
(
exp
->
víd‹
Ë=
NX_VENDOR_ID
) {

90 
	`¡ohl
(
exp
->
subty≥
)) {

91 (
NXT_ROLE_REQUEST
):

92 (
NXT_ROLE_REPLY
): {

93 
nx_rﬁe_ªque°
 *
§c
;

94 
oÊ_exp_nicúa_msg_rﬁe
 *
d°
;

96 i‡(*
Àn
 < (
nx_rﬁe_ªque°
)) {

97 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived NXT_ROLE_REPLY mesßgêha†övÆidÜígth (%zu).", *
Àn
);

98  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

100 *
Àn
 -(
nx_rﬁe_ªque°
);

102 
§c
 = (
nx_rﬁe_ªque°
 *)
exp
;

104 
d°
 = (
oÊ_exp_nicúa_msg_rﬁe
 *)
	`mÆloc
((ofl_exp_nicira_msg_role));

105 
d°
->
hódî
.hódî.
ex≥rimíãr_id
 = 
	`¡ohl
(
exp
->
víd‹
);

106 
d°
->
hódî
.
ty≥
 = 
	`¡ohl
(
exp
->
subty≥
);

107 
d°
->
rﬁe
 = 
	`¡ohl
(
§c
->role);

109 (*
msg
Ë(
oÊ_msg_ex≥rimíãr
 *)
d°
;

113 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅo unpack unknown Nicira Experimenter message.");

114  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_EXPERIMENTER
);

118 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅo unpackÇon-Nicira Experimenter message.");

119  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_EXPERIMENTER
);

121 
	`‰ì
(
msg
);

123 
	}
}

126 
	$oÊ_exp_nicúa_msg_‰ì
(
oÊ_msg_ex≥rimíãr
 *
msg
) {

127 i‡(
msg
->
ex≥rimíãr_id
 =
NX_VENDOR_ID
) {

128 
oÊ_exp_nicúa_msg_hódî
 *
exp
 = (oÊ_exp_nicúa_msg_hódî *)
msg
;

129 
exp
->
ty≥
) {

130 (
NXT_ROLE_REQUEST
):

131 (
NXT_ROLE_REPLY
): {

135 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅo free unknown Nicira Experimenter message.");

139 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅo freeÇon-Nicira Experimenter message.");

141 
	`‰ì
(
msg
);

143 
	}
}

146 
	$oÊ_exp_nicúa_msg_to_°rög
(
oÊ_msg_ex≥rimíãr
 *
msg
) {

147 *
°r
;

148 
size_t
 
°r_size
;

149 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

151 i‡(
msg
->
ex≥rimíãr_id
 =
NX_VENDOR_ID
) {

152 
oÊ_exp_nicúa_msg_hódî
 *
exp
 = (oÊ_exp_nicúa_msg_hódî *)
msg
;

153 
exp
->
ty≥
) {

154 (
NXT_ROLE_REQUEST
):

155 (
NXT_ROLE_REPLY
): {

156 
oÊ_exp_nicúa_msg_rﬁe
 *
r
 = (oÊ_exp_nicúa_msg_rﬁê*)
exp
;

157 
	`Ârötf
(
°ªam
, "%s{role=\"%s\"}",

158 
exp
->
ty≥
 =
NXT_ROLE_REQUEST
 ? "rolereq" : "rolerep",

159 
r
->
rﬁe
 =
NX_ROLE_MASTER
 ? "master" :

160 
r
->
rﬁe
 =
NX_ROLE_SLAVE
 ? "slave"

165 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÖrint unknown Nicira Experimenter message.");

166 
	`Ârötf
(
°ªam
, "o„xp{ty≥=\"%u\"}", 
exp
->
ty≥
);

170 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÖrintÇon-Nicira Experimenter message.");

171 
	`Ârötf
(
°ªam
, "exp{exp_id=\"%u\"}", 
msg
->
ex≥rimíãr_id
);

174 
	`f˛o£
(
°ªam
);

175  
°r
;

176 
	}
}

	@oflib-exp/ofl-exp-nicira.h

32 #i‚de‡
OFL_EXP_NICIRA_H


33 
	#OFL_EXP_NICIRA_H
 1

	)

36 
	~"../oÊib/oÊ-°ru˘s.h
"

37 
	~"../oÊib/oÊ-mesßges.h
"

40 
	soÊ_exp_nicúa_msg_hódî
 {

41 
oÊ_msg_ex≥rimíãr
 
	mhódî
;

43 
uöt32_t
 
	mty≥
;

46 
	soÊ_exp_nicúa_msg_rﬁe
 {

47 
oÊ_exp_nicúa_msg_hódî
 
	mhódî
;

49 
uöt32_t
 
	mrﬁe
;

55 
oÊ_exp_nicúa_msg_∑ck
(
oÊ_msg_ex≥rimíãr
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
);

57 
oÊ_îr


58 
oÊ_exp_nicúa_msg_u≈ack
(
oÂ_hódî
 *
oh
, 
size_t
 *
Àn
, 
oÊ_msg_ex≥rimíãr
 **
msg
);

61 
oÊ_exp_nicúa_msg_‰ì
(
oÊ_msg_ex≥rimíãr
 *
msg
);

64 
oÊ_exp_nicúa_msg_to_°rög
(
oÊ_msg_ex≥rimíãr
 *
msg
);

	@oflib-exp/ofl-exp-openflow.c

32 
	~<°dlib.h
>

33 
	~<°dio.h
>

34 
	~<°rög.h
>

35 
	~<√töë/ö.h
>

36 
	~"›íÊow/›íÊow.h
"

37 
	~"›íÊow/›íÊow-ext.h
"

38 
	~"oÊ-exp-›íÊow.h
"

39 
	~"../oÊib/oÊ-log.h
"

40 
	~"../oÊib/oÊ-¥öt.h
"

42 
	#LOG_MODULE
 
oÊ_exp_of


	)

43 
	$OFL_LOG_INIT
(
LOG_MODULE
)

47 
	$oÊ_exp_›íÊow_msg_∑ck
(
oÊ_msg_ex≥rimíãr
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

48 i‡(
msg
->
ex≥rimíãr_id
 =
OPENFLOW_VENDOR_ID
) {

49 
oÊ_exp_›íÊow_msg_hódî
 *
exp
 = (oÊ_exp_›íÊow_msg_hódî *)
msg
;

50 
exp
->
ty≥
) {

51 (
OFP_EXT_QUEUE_MODIFY
):

52 (
OFP_EXT_QUEUE_DELETE
): {

53 
oÊ_exp_›íÊow_msg_queue
 *
q
 = (oÊ_exp_›íÊow_msg_queuê*)
exp
;

54 
›íÊow_queue_comm™d_hódî
 *
oÂ
;

56 *
buf_Àn
 = (
›íÊow_queue_comm™d_hódî
Ë+ 
	`oÊ_°ru˘s_∑ckë_queue_oÂ_Àn
(
q
->
queue
);

57 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

59 
oÂ
 = (
›íÊow_queue_comm™d_hódî
 *)(*
buf
);

60 
oÂ
->
hódî
.
víd‹
 = 
	`ht⁄l
(
exp
->hódî.
ex≥rimíãr_id
);

61 
oÂ
->
hódî
.
subty≥
 = 
	`ht⁄l
(
exp
->
ty≥
);

62 
oÂ
->
p‹t
 = 
	`ht⁄l
(
q
->
p‹t_id
);

64 
	`oÊ_°ru˘s_∑ckë_queue_∑ck
(
q
->
queue
, (
oÂ_∑ckë_queue
 *)
oÂ
->
body
);

67 (
OFP_EXT_SET_DESC
): {

68 
oÊ_exp_›íÊow_msg_£t_dp_desc
 *
s
 = (oÊ_exp_›íÊow_msg_£t_dp_des¯*)
exp
;

69 
›íÊow_ext_£t_dp_desc
 *
oÂ
;

71 *
buf_Àn
 = (
›íÊow_ext_£t_dp_desc
);

72 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

74 
oÂ
 = (
›íÊow_ext_£t_dp_desc
 *)(*
buf
);

75 
oÂ
->
hódî
.
víd‹
 = 
	`ht⁄l
(
exp
->hódî.
ex≥rimíãr_id
);

76 
oÂ
->
hódî
.
subty≥
 = 
	`ht⁄l
(
exp
->
ty≥
);

77 
	`°∫˝y
(
oÂ
->
dp_desc
, 
s
->dp_desc, 
DESC_STR_LEN
);

82 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÖrint unknown Openflow Experimenter message.");

87 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÖrintÇon-Openflow Experimenter message.");

90 
	}
}

92 
oÊ_îr


93 
	$oÊ_exp_›íÊow_msg_u≈ack
(
oÂ_hódî
 *
oh
, 
size_t
 *
Àn
, 
oÊ_msg_ex≥rimíãr
 **
msg
) {

94 
oÂ_exãnsi⁄_hódî
 *
exp
;

96 i‡(*
Àn
 < (
oÂ_exãnsi⁄_hódî
)) {

97 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived EXPERIMENTER mesßgêha†övÆidÜígth (%zu).", *
Àn
);

98  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

101 
exp
 = (
oÂ_exãnsi⁄_hódî
 *)
oh
;

103 i‡(
	`¡ohl
(
exp
->
víd‹
Ë=
OPENFLOW_VENDOR_ID
) {

105 
	`¡ohl
(
exp
->
subty≥
)) {

106 (
OFP_EXT_QUEUE_MODIFY
):

107 (
OFP_EXT_QUEUE_DELETE
): {

108 
›íÊow_queue_comm™d_hódî
 *
§c
;

109 
oÊ_exp_›íÊow_msg_queue
 *
d°
;

110 
oÊ_îr
 
îr‹
;

112 i‡(*
Àn
 < (
›íÊow_queue_comm™d_hódî
)) {

113 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived EXT_QUEUE_MODIFY mesßgêha†övÆidÜígth (%zu).", *
Àn
);

114  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

116 *
Àn
 -(
›íÊow_queue_comm™d_hódî
);

118 
§c
 = (
›íÊow_queue_comm™d_hódî
 *)
exp
;

120 
d°
 = (
oÊ_exp_›íÊow_msg_queue
 *)
	`mÆloc
((ofl_exp_openflow_msg_queue));

121 
d°
->
hódî
.hódî.
ex≥rimíãr_id
 = 
	`¡ohl
(
exp
->
víd‹
);

122 
d°
->
hódî
.
ty≥
 = 
	`¡ohl
(
exp
->
subty≥
);

123 
d°
->
p‹t_id
 = 
	`¡ohl
(
§c
->
p‹t
);

125 
îr‹
 = 
	`oÊ_°ru˘s_∑ckë_queue_u≈ack
((
oÂ_∑ckë_queue
 *)(
§c
->
body
), 
Àn
, &(
d°
->
queue
));

126 i‡(
îr‹
) {

127 
	`‰ì
(
d°
);

128  
îr‹
;

131 (*
msg
Ë(
oÊ_msg_ex≥rimíãr
 *)
d°
;

134 (
OFP_EXT_SET_DESC
): {

135 
›íÊow_ext_£t_dp_desc
 *
§c
;

136 
oÊ_exp_›íÊow_msg_£t_dp_desc
 *
d°
;

138 i‡(*
Àn
 < (
›íÊow_ext_£t_dp_desc
)) {

139 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived EXT_SET_DESC mesßgêha†övÆidÜígth (%zu).", *
Àn
);

140  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

142 *
Àn
 -(
›íÊow_ext_£t_dp_desc
);

144 
§c
 = (
›íÊow_ext_£t_dp_desc
 *)
exp
;

146 
d°
 = (
oÊ_exp_›íÊow_msg_£t_dp_desc
 *)
	`mÆloc
((ofl_exp_openflow_msg_set_dp_desc));

147 
d°
->
hódî
.hódî.
ex≥rimíãr_id
 = 
	`¡ohl
(
exp
->
víd‹
);

148 
d°
->
hódî
.
ty≥
 = 
	`¡ohl
(
exp
->
subty≥
);

150 
d°
->
dp_desc
 = 
	`°r˝y
((*)
	`mÆloc
(
	`°æí
(
§c
->dp_desc)+1), src->dp_desc);

152 (*
msg
Ë(
oÊ_msg_ex≥rimíãr
 *)
d°
;

156 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅo unpack unknown Openflow Experimenter message.");

157  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_EXPERIMENTER
);

161 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅo unpackÇon-Openflow Experimenter message.");

162  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_EXPERIMENTER
);

164 
	`‰ì
(
msg
);

166 
	}
}

169 
	$oÊ_exp_›íÊow_msg_‰ì
(
oÊ_msg_ex≥rimíãr
 *
msg
) {

170 i‡(
msg
->
ex≥rimíãr_id
 =
OPENFLOW_VENDOR_ID
) {

171 
oÊ_exp_›íÊow_msg_hódî
 *
exp
 = (oÊ_exp_›íÊow_msg_hódî *)
msg
;

172 
exp
->
ty≥
) {

173 (
OFP_EXT_QUEUE_MODIFY
):

174 (
OFP_EXT_QUEUE_DELETE
): {

175 
oÊ_exp_›íÊow_msg_queue
 *
q
 = (oÊ_exp_›íÊow_msg_queuê*)
exp
;

176 
	`oÊ_°ru˘s_‰ì_∑ckë_queue
(
q
->
queue
);

179 (
OFP_EXT_SET_DESC
): {

180 
oÊ_exp_›íÊow_msg_£t_dp_desc
 *
s
 = (oÊ_exp_›íÊow_msg_£t_dp_des¯*)
exp
;

181 
	`‰ì
(
s
->
dp_desc
);

185 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅo free unknown Openflow Experimenter message.");

189 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅo freeÇon-Openflow Experimenter message.");

191 
	`‰ì
(
msg
);

193 
	}
}

196 
	$oÊ_exp_›íÊow_msg_to_°rög
(
oÊ_msg_ex≥rimíãr
 *
msg
) {

197 *
°r
;

198 
size_t
 
°r_size
;

199 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

201 i‡(
msg
->
ex≥rimíãr_id
 =
OPENFLOW_VENDOR_ID
) {

202 
oÊ_exp_›íÊow_msg_hódî
 *
exp
 = (oÊ_exp_›íÊow_msg_hódî *)
msg
;

203 
exp
->
ty≥
) {

204 (
OFP_EXT_QUEUE_MODIFY
):

205 (
OFP_EXT_QUEUE_DELETE
): {

206 
oÊ_exp_›íÊow_msg_queue
 *
q
 = (oÊ_exp_›íÊow_msg_queuê*)
exp
;

207 
	`Ârötf
(
°ªam
, "%squeue{p‹t=\"", 
exp
->
ty≥
 =
OFP_EXT_QUEUE_MODIFY
 ? "mod" : "del");

208 
	`oÊ_p‹t_¥öt
(
°ªam
, 
q
->
p‹t_id
);

209 
	`Ârötf
(
°ªam
, "\", queue=");

210 
	`oÊ_°ru˘s_queue_¥öt
(
°ªam
, 
q
->
queue
);

211 
	`Ârötf
(
°ªam
, "}");

214 (
OFP_EXT_SET_DESC
): {

215 
oÊ_exp_›íÊow_msg_£t_dp_desc
 *
s
 = (oÊ_exp_›íÊow_msg_£t_dp_des¯*)
exp
;

216 
	`Ârötf
(
°ªam
, "£tdesc{desc=\"%s\"}", 
s
->
dp_desc
);

220 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÖrint unknown Openflow Experimenter message.");

221 
	`Ârötf
(
°ªam
, "o„xp{ty≥=\"%u\"}", 
exp
->
ty≥
);

225 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÖrintÇon-Openflow Experimenter message.");

226 
	`Ârötf
(
°ªam
, "exp{exp_id=\"%u\"}", 
msg
->
ex≥rimíãr_id
);

229 
	`f˛o£
(
°ªam
);

230  
°r
;

231 
	}
}

	@oflib-exp/ofl-exp-openflow.h

32 #i‚de‡
OFL_EXP_OPENFLOW_H


33 
	#OFL_EXP_OPENFLOW_H
 1

	)

36 
	~"../oÊib/oÊ-°ru˘s.h
"

37 
	~"../oÊib/oÊ-mesßges.h
"

40 
	soÊ_exp_›íÊow_msg_hódî
 {

41 
oÊ_msg_ex≥rimíãr
 
	mhódî
;

43 
uöt32_t
 
	mty≥
;

46 
	soÊ_exp_›íÊow_msg_queue
 {

47 
oÊ_exp_›íÊow_msg_hódî
 
	mhódî
;

49 
uöt32_t
 
	mp‹t_id
;

50 
oÊ_∑ckë_queue
 *
	mqueue
;

54 
	soÊ_exp_›íÊow_msg_£t_dp_desc
 {

55 
oÊ_exp_›íÊow_msg_hódî
 
	mhódî
;

57 *
	mdp_desc
;

63 
oÊ_exp_›íÊow_msg_∑ck
(
oÊ_msg_ex≥rimíãr
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
);

65 
oÊ_îr


66 
oÊ_exp_›íÊow_msg_u≈ack
(
oÂ_hódî
 *
oh
, 
size_t
 *
Àn
, 
oÊ_msg_ex≥rimíãr
 **
msg
);

69 
oÊ_exp_›íÊow_msg_‰ì
(
oÊ_msg_ex≥rimíãr
 *
msg
);

72 
oÊ_exp_›íÊow_msg_to_°rög
(
oÊ_msg_ex≥rimíãr
 *
msg
);

	@oflib-exp/ofl-exp.c

32 
	~<öây≥s.h
>

33 
	~<√töë/ö.h
>

34 
	~<°dlib.h
>

35 
	~<°dio.h
>

36 
	~"oÊ-exp.h
"

37 
	~"oÊ-exp-nicúa.h
"

38 
	~"oÊ-exp-›íÊow.h
"

39 
	~"../oÊib/oÊ-mesßges.h
"

40 
	~"../oÊib/oÊ-log.h
"

41 
	~"›íÊow/›íÊow.h
"

42 
	~"›íÊow/nicúa-ext.h
"

43 
	~"›íÊow/›íÊow-ext.h
"

45 
	#LOG_MODULE
 
oÊ_exp


	)

46 
	$OFL_LOG_INIT
(
LOG_MODULE
)

51 
	$oÊ_exp_msg_∑ck
(
oÊ_msg_ex≥rimíãr
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

52 
msg
->
ex≥rimíãr_id
) {

53 (
OPENFLOW_VENDOR_ID
): {

54  
	`oÊ_exp_›íÊow_msg_∑ck
(
msg
, 
buf
, 
buf_Àn
);

56 (
NX_VENDOR_ID
): {

57  
	`oÊ_exp_nicúa_msg_∑ck
(
msg
, 
buf
, 
buf_Àn
);

60 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryögÅÿ∑ck unknow¿EXPERIMENTER mesßgê(%u).", 
msg
->
ex≥rimíãr_id
);

64 
	}
}

66 
oÊ_îr


67 
	$oÊ_exp_msg_u≈ack
(
oÂ_hódî
 *
oh
, 
size_t
 *
Àn
, 
oÊ_msg_ex≥rimíãr
 **
msg
) {

68 
oÂ_ex≥rimíãr_hódî
 *
exp
;

70 i‡(*
Àn
 < (
oÂ_ex≥rimíãr_hódî
)) {

71 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received EXPERIMENTER message is shorterÅhan ofp_experimenter_header.");

72  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

75 
exp
 = (
oÂ_ex≥rimíãr_hódî
 *)
oh
;

77 
	`ht⁄l
(
exp
->
ex≥rimíãr
)) {

78 (
OPENFLOW_VENDOR_ID
): {

79  
	`oÊ_exp_›íÊow_msg_u≈ack
(
oh
, 
Àn
, 
msg
);

81 (
NX_VENDOR_ID
): {

82  
	`oÊ_exp_nicúa_msg_u≈ack
(
oh
, 
Àn
, 
msg
);

85 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryögÅÿu≈ack unknow¿EXPERIMENTER mesßgê(%u).", 
	`ht⁄l
(
exp
->
ex≥rimíãr
));

86  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_EXPERIMENTER
);

89 
	}
}

92 
	$oÊ_exp_msg_‰ì
(
oÊ_msg_ex≥rimíãr
 *
msg
) {

93 
msg
->
ex≥rimíãr_id
) {

94 (
OPENFLOW_VENDOR_ID
): {

95  
	`oÊ_exp_›íÊow_msg_‰ì
(
msg
);

97 (
NX_VENDOR_ID
): {

98  
	`oÊ_exp_nicúa_msg_‰ì
(
msg
);

101 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryögÅÿ‰ì unknow¿EXPERIMENTER mesßgê(%u).", 
msg
->
ex≥rimíãr_id
);

102 
	`‰ì
(
msg
);

106 
	}
}

109 
	$oÊ_exp_msg_to_°rög
(
oÊ_msg_ex≥rimíãr
 *
msg
) {

110 
msg
->
ex≥rimíãr_id
) {

111 (
OPENFLOW_VENDOR_ID
): {

112  
	`oÊ_exp_›íÊow_msg_to_°rög
(
msg
);

114 (
NX_VENDOR_ID
): {

115  
	`oÊ_exp_nicúa_msg_to_°rög
(
msg
);

118 *
°r
;

119 
size_t
 
°r_size
;

120 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

121 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryögÅÿc⁄vîàtÿ°rög unknow¿EXPERIMENTER mesßgê(%u).", 
msg
->
ex≥rimíãr_id
);

122 
	`Ârötf
(
°ªam
, "exp{id=\"0x%"
PRIx32
"\"}", 
msg
->
ex≥rimíãr_id
);

123 
	`f˛o£
(
°ªam
);

124  
°r
;

127 
	}
}

	@oflib-exp/ofl-exp.h

32 #i‚de‡
OFL_EXP_H


33 
	#OFL_EXP_H
 1

	)

35 
	~"../oÊib/oÊ-mesßges.h
"

36 
	~"›íÊow/›íÊow.h
"

40 
oÊ_exp_msg_∑ck
(
oÊ_msg_ex≥rimíãr
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
);

42 
oÊ_îr


43 
oÊ_exp_msg_u≈ack
(
oÂ_hódî
 *
oh
, 
size_t
 *
Àn
, 
oÊ_msg_ex≥rimíãr
 **
msg
);

46 
oÊ_exp_msg_‰ì
(
oÊ_msg_ex≥rimíãr
 *
msg
);

49 
oÊ_exp_msg_to_°rög
(
oÊ_msg_ex≥rimíãr
 *
msg
);

	@oflib/ofl-actions-pack.c

32 
	~<√töë/ö.h
>

33 
	~<sys/ty≥s.h
>

34 
	~<°dlib.h
>

35 
	~<°rög.h
>

36 
	~"oxm-m©ch.h
"

37 
	~"oÊ.h
"

38 
	~"oÊ-utûs.h
"

39 
	~"oÊ-a˘i⁄s.h
"

40 
	~"oÊ-°ru˘s.h
"

41 
	~"oÊ-mesßges.h
"

42 
	~"oÊ-log.h
"

43 
	~"›íÊow/›íÊow.h
"

45 
	#LOG_MODULE
 
oÊ_a˘_p


	)

46 
	$OFL_LOG_INIT
(
LOG_MODULE
)

49 
size_t


50 
	$oÊ_a˘i⁄s_oÂ_Àn
(
oÊ_a˘i⁄_hódî
 *
a˘i⁄
, 
oÊ_exp
 *
exp
) {

51 
a˘i⁄
->
ty≥
) {

52 
OFPAT_OUTPUT
:

53  (
oÂ_a˘i⁄_ouçut
);

55 
OFPAT_COPY_TTL_OUT
:

56 
OFPAT_COPY_TTL_IN
:

57  (
oÂ_a˘i⁄_hódî
);

58 
OFPAT_SET_MPLS_TTL
:

59  (
oÂ_a˘i⁄_m∂s_âl
);

60 
OFPAT_DEC_MPLS_TTL
:

61  (
oÂ_a˘i⁄_hódî
);

62 
OFPAT_PUSH_VLAN
:

63 
OFPAT_PUSH_PBB
:

64 
OFPAT_PUSH_MPLS
:

65  (
oÂ_a˘i⁄_push
);

66 
OFPAT_POP_VLAN
:

67 
OFPAT_POP_PBB
:

68  (
oÂ_a˘i⁄_hódî
);

69 
OFPAT_POP_MPLS
:

70  (
oÂ_a˘i⁄_p›_m∂s
);

71 
OFPAT_SET_QUEUE
:

72  (
oÂ_a˘i⁄_£t_queue
);

73 
OFPAT_GROUP
:

74  (
oÂ_a˘i⁄_group
);

75 
OFPAT_SET_NW_TTL
:

76  (
oÂ_a˘i⁄_nw_âl
);

77 
OFPAT_DEC_NW_TTL
:

78  (
oÂ_a˘i⁄_hódî
);

79 
OFPAT_SET_FIELD
: {

80 
oÊ_a˘i⁄_£t_fõld
 *
a
 = (oÊ_a˘i⁄_£t_fõld *Ë
a˘i⁄
;

81  (
oÂ_a˘i⁄_£t_fõld
Ë+ 
	`ROUND_UP
(
	`OXM_LENGTH
(
a
->
fõld
->
hódî
),8) ;

83 
OFPAT_EXPERIMENTER
: {

84 i‡(
exp
 =
NULL
 ||Éxp->
a˘
 =NULL ||Éxp->a˘->
oÂ_Àn
 == NULL) {

85 
	`OFL_LOG_WARN
(
LOG_MODULE
, "requestingÉxperimenterÜength, butÇo callback was given.");

88  
exp
->
a˘
->
	`oÂ_Àn
(
a˘i⁄
);

93 
	}
}

95 
size_t


96 
	$oÊ_a˘i⁄s_oÂ_tŸÆ_Àn
(
oÊ_a˘i⁄_hódî
 **
a˘i⁄s
,

97 
size_t
 
a˘i⁄s_num
, 
oÊ_exp
 *
exp
) {

98 
size_t
 
sum
;

99 
	`OFL_UTILS_SUM_ARR_FUN2
(
sum
, 
a˘i⁄s
, 
a˘i⁄s_num
,

100 
oÊ_a˘i⁄s_oÂ_Àn
, 
exp
);

101  
sum
;

102 
	}
}

104 
size_t


105 
	$oÊ_a˘i⁄s_∑ck
(
oÊ_a˘i⁄_hódî
 *
§c
, 
oÂ_a˘i⁄_hódî
 *
d°
, 
uöt8_t
* 
d©a
, 
oÊ_exp
 *
exp
) {

107 
d°
->
ty≥
 = 
	`ht⁄s
(
§c
->type);

108 
	`mem£t
(
d°
->
∑d
, 0x00, 4);

110 
§c
->
ty≥
) {

111 
OFPAT_OUTPUT
: {

112 
oÊ_a˘i⁄_ouçut
 *
ß
 = (oÊ_a˘i⁄_ouçuà*)
§c
;

113 
oÂ_a˘i⁄_ouçut
 *
da
 = (oÂ_a˘i⁄_ouçuà*)
d°
;

115 
da
->
Àn
 = 
	`ht⁄s
((
oÂ_a˘i⁄_ouçut
));

116 
da
->
p‹t
 = 
	`ht⁄l
(
ß
->port);

117 
da
->
max_Àn
 = 
	`ht⁄s
(
ß
->max_len);

118 
	`mem£t
(
da
->
∑d
, 0x00, 6);

119  (
oÂ_a˘i⁄_ouçut
);

122 
OFPAT_COPY_TTL_OUT
:

123 
OFPAT_COPY_TTL_IN
: {

124 
d°
->
Àn
 = 
	`ht⁄s
((
oÂ_a˘i⁄_hódî
));

125  (
oÂ_a˘i⁄_hódî
);

128 
OFPAT_SET_MPLS_TTL
: {

129 
oÊ_a˘i⁄_m∂s_âl
 *
ß
 = (oÊ_a˘i⁄_m∂s_â»*)
§c
;

130 
oÂ_a˘i⁄_m∂s_âl
 *
da
 = (oÂ_a˘i⁄_m∂s_â»*)
d°
;

132 
da
->
Àn
 = 
	`ht⁄s
((
oÂ_a˘i⁄_m∂s_âl
));

133 
da
->
m∂s_âl
 = 
ß
->mpls_ttl;

134 
	`mem£t
(
da
->
∑d
, 0x00, 3);

135  (
oÂ_a˘i⁄_m∂s_âl
);

137 
OFPAT_DEC_MPLS_TTL
: {

138 
d°
->
Àn
 = 
	`ht⁄s
((
oÂ_a˘i⁄_hódî
));

139  (
oÂ_a˘i⁄_hódî
);

141 
OFPAT_PUSH_VLAN
:

142 
OFPAT_PUSH_MPLS
:

143 
OFPAT_PUSH_PBB
:{

144 
oÊ_a˘i⁄_push
 *
ß
 = (oÊ_a˘i⁄_push *)
§c
;

145 
oÂ_a˘i⁄_push
 *
da
 = (oÂ_a˘i⁄_push *)
d°
;

147 
da
->
Àn
 = 
	`ht⁄s
((
oÂ_a˘i⁄_push
));

148 
da
->
ëhîty≥
 = 
	`ht⁄s
(
ß
->ethertype);

149 
	`mem£t
(
da
->
∑d
, 0x00, 2);

150  (
oÂ_a˘i⁄_push
);

152 
OFPAT_POP_VLAN
:

153 
OFPAT_POP_PBB
: {

154 
oÂ_a˘i⁄_hódî
 *
da
 = (oÂ_a˘i⁄_hódî *)
d°
;

156 
da
->
Àn
 = 
	`ht⁄s
((
oÂ_a˘i⁄_hódî
));

157   (
oÂ_a˘i⁄_hódî
);

159 
OFPAT_POP_MPLS
: {

160 
oÊ_a˘i⁄_p›_m∂s
 *
ß
 = (oÊ_a˘i⁄_p›_m∂†*)
§c
;

161 
oÂ_a˘i⁄_p›_m∂s
 *
da
 = (oÂ_a˘i⁄_p›_m∂†*)
d°
;

163 
da
->
Àn
 = 
	`ht⁄s
((
oÂ_a˘i⁄_p›_m∂s
));

164 
da
->
ëhîty≥
 = 
	`ht⁄s
(
ß
->ethertype);

165 
	`mem£t
(
da
->
∑d
, 0x00, 2);

166  (
oÂ_a˘i⁄_p›_m∂s
);

168 
OFPAT_SET_QUEUE
: {

169 
oÊ_a˘i⁄_£t_queue
 *
ß
 = (oÊ_a˘i⁄_£t_queuê*)
§c
;

170 
oÂ_a˘i⁄_£t_queue
 *
da
 = (oÂ_a˘i⁄_£t_queuê*)
d°
;

172 
da
->
Àn
 = 
	`ht⁄s
((
oÂ_a˘i⁄_£t_queue
));

173 
da
->
queue_id
 = 
	`ht⁄l
(
ß
->queue_id);

174  (
oÂ_a˘i⁄_£t_queue
);

176 
OFPAT_GROUP
: {

177 
oÊ_a˘i⁄_group
 *
ß
 = (oÊ_a˘i⁄_grou∞*)
§c
;

178 
oÂ_a˘i⁄_group
 *
da
 = (oÂ_a˘i⁄_grou∞*)
d°
;

180 
da
->
Àn
 = 
	`ht⁄s
((
oÂ_a˘i⁄_group
));

181 
da
->
group_id
 = 
	`ht⁄l
(
ß
->group_id);

182  (
oÂ_a˘i⁄_group
);

184 
OFPAT_SET_NW_TTL
: {

185 
oÊ_a˘i⁄_£t_nw_âl
 *
ß
 = (oÊ_a˘i⁄_£t_nw_â»*)
§c
;

186 
oÂ_a˘i⁄_nw_âl
 *
da
 = (oÂ_a˘i⁄_nw_â»*)
d°
;

188 
da
->
Àn
 = 
	`ht⁄s
((
oÂ_a˘i⁄_nw_âl
));

189 
da
->
nw_âl
 = 
ß
->nw_ttl;

190 
	`mem£t
(
da
->
∑d
, 0x00, 3);

191  (
oÂ_a˘i⁄_nw_âl
);

193 
OFPAT_DEC_NW_TTL
: {

194 
d°
->
Àn
 = 
	`ht⁄s
((
oÂ_a˘i⁄_hódî
));

195  (
oÂ_a˘i⁄_hódî
);

197 
OFPAT_SET_FIELD
: {

198 
oÊ_a˘i⁄_£t_fõld
 *
ß
 = (oÊ_a˘i⁄_£t_fõld *Ë
§c
;

199 
oÂ_a˘i⁄_£t_fõld
 *
da
 = (oÂ_a˘i⁄_£t_fõld *Ë
d°
;

200 
uöt32_t
 
hódî
;

201 
uöt8_t
 
∑ddög_size
;

203 
da
->
Àn
 = 
	`ht⁄s
((
oÂ_a˘i⁄_£t_fõld
Ë+ 
	`ROUND_UP
(
	`OXM_LENGTH
(
ß
->
fõld
->
hódî
),8));

205 
hódî
 = 
	`ht⁄l
(
ß
->
fõld
->header);

206 
	`mem˝y
(&
da
->
fõld
, &
hódî
, 4);

207 
	`OXM_LENGTH
(
ß
->
fõld
->
hódî
)){

211 
	`mem˝y
(
d©a
 + ((
oÂ_a˘i⁄_£t_fõld
)), 
ß
->
fõld
->
vÆue
, 
	`OXM_LENGTH
(ß->fõld->
hódî
));

215 
uöt16_t
 
vÆue
 = 
	`ht⁄s
(*((uöt16_t*Ë
ß
->
fõld
->value));

216 
	`mem˝y
(
d©a
 + ((
oÂ_a˘i⁄_£t_fõld
)),&
vÆue
,
	`OXM_LENGTH
(
ß
->
fõld
->
hódî
));

220 
uöt32_t
 
vÆue
;

221 
uöt8_t
 
fõld
 = 
	`OXM_FIELD
(
ß
->fõld->
hódî
);

222 if–
fõld
 != 11 && field != 12 && field != 22 && field != 23)

223 
vÆue
 = 
	`ht⁄l
(*((
uöt32_t
*Ë
ß
->
fõld
->value));

225 
vÆue
 = *((
uöt32_t
*Ë
ß
->
fõld
->value);

226 
	`mem˝y
(
d©a
 + ((
oÂ_a˘i⁄_£t_fõld
)), &
vÆue
, 
	`OXM_LENGTH
(
ß
->
fõld
->
hódî
));

230 
uöt64_t
 
vÆue
 = 
	`ht⁄s
(*((uöt64_t*Ë
ß
->
fõld
->value));

231 
	`mem˝y
(
d©a
 + ((
oÂ_a˘i⁄_£t_fõld
)),&
vÆue
,
	`OXM_LENGTH
(
ß
->
fõld
->
hódî
));

236 
∑ddög_size
 = 
	`ROUND_UP
(
	`OXM_LENGTH
(
ß
->
fõld
->
hódî
),8) - OXM_LENGTH(sa->field->header);

237 
	`mem£t
(
d©a
 + ((
oÂ_a˘i⁄_£t_fõld
Ë+ 
	`OXM_LENGTH
(
ß
->
fõld
->
hódî
)), 0, 
∑ddög_size
);

238  
	`¡ohs
((
da
->
Àn
));

241 
OFPAT_EXPERIMENTER
: {

242 i‡(
exp
 =
NULL
 ||Éxp->
a˘
 =NULL ||Éxp->a˘->
∑ck
 == NULL) {

243 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÖackÉxperimenter, butÇo callback was given.");

246  
exp
->
a˘
->
	`∑ck
(
§c
, 
d°
);

251 
	}
}

	@oflib/ofl-actions-print.c

32 
	~<°dboﬁ.h
>

33 
	~<°dlib.h
>

34 
	~<°dio.h
>

35 
	~<˘y≥.h
>

36 
	~<öây≥s.h
>

38 
	~"oÊ.h
"

39 
	~"oÊ-¥öt.h
"

40 
	~"oÊ-°ru˘s.h
"

41 
	~"oÊ-a˘i⁄s.h
"

42 
	~"oÊ-∑ckës.h
"

43 
	~"../oÊib/oxm-m©ch.h
"

44 
	~"›íÊow/›íÊow.h
"

47 
	#ETH_ADDR_FMT
 \

48 "%02"
PRIx8
":%02"PRIx8":%02"PRIx8":%02"PRIx8":%02"PRIx8":%02"
	)
PRIx8

49 
	#ETH_ADDR_ARGS
(
ó
) \

50 (
ó
)[0], (ó)[1], (ó)[2], (ó)[3], (ó)[4], (ó)[5]

	)

55 
	$oÊ_a˘i⁄_to_°rög
(
oÊ_a˘i⁄_hódî
 *
a˘
, 
oÊ_exp
 *
exp
) {

56 *
°r
;

57 
size_t
 
°r_size
;

58 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

60 
	`oÊ_a˘i⁄_¥öt
(
°ªam
, 
a˘
, 
exp
);

61 
	`f˛o£
(
°ªam
);

62  
°r
;

63 
	}
}

66 
	$oÊ_a˘i⁄_¥öt
(
FILE
 *
°ªam
, 
oÊ_a˘i⁄_hódî
 *
a˘
, 
oÊ_exp
 *
exp
) {

68 
	`oÊ_a˘i⁄_ty≥_¥öt
(
°ªam
, 
a˘
->
ty≥
);

70 
a˘
->
ty≥
) {

71 
OFPAT_OUTPUT
: {

72 
oÊ_a˘i⁄_ouçut
 *
a
 = (oÊ_a˘i⁄_ouçuà*)
a˘
;

74 
	`Ârötf
(
°ªam
, "{port=\"");

75 
	`oÊ_p‹t_¥öt
(
°ªam
, 
a
->
p‹t
);

76 i‡(
a
->
p‹t
 =
OFPP_CONTROLLER
) {

77 
	`Ârötf
(
°ªam
, "\", mÀn=\"%u\"}", 
a
->
max_Àn
);

79 
	`Ârötf
(
°ªam
, "\"}");

83 
OFPAT_SET_FIELD
:{

84 
size_t
 
size
;

85 
oÊ_a˘i⁄_£t_fõld
 *
a
 = (oÊ_a˘i⁄_£t_fõld *)
a˘
;

86 
	`Ârötf
(
°ªam
, "{field:");

87 
	`oÊ_°ru˘s_oxm_év_¥öt
(
°ªam
, 
a
->
fõld
);

88 
	`Ârötf
(
°ªam
, "}");

91 
OFPAT_COPY_TTL_OUT
:

92 
OFPAT_COPY_TTL_IN
: {

95 
OFPAT_SET_MPLS_TTL
: {

96 
oÊ_a˘i⁄_m∂s_âl
 *
a
 = (oÊ_a˘i⁄_m∂s_â»*)
a˘
;

98 
	`Ârötf
(
°ªam
, "{âl=\"%u\"}", 
a
->
m∂s_âl
);

101 
OFPAT_DEC_MPLS_TTL
: {

104 
OFPAT_PUSH_VLAN
:

105 
OFPAT_PUSH_MPLS
:

106 
OFPAT_PUSH_PBB
:{

107 
oÊ_a˘i⁄_push
 *
a
 = (oÊ_a˘i⁄_push *)
a˘
;

109 
	`Ârötf
(
°ªam
, "{ëh=\"0x%04"
PRIx16
"\"}", 
a
->
ëhîty≥
);

112 
OFPAT_POP_VLAN
:

113 
OFPAT_POP_PBB
: {

116 
OFPAT_POP_MPLS
: {

117 
oÊ_a˘i⁄_p›_m∂s
 *
a
 = (oÊ_a˘i⁄_p›_m∂†*)
a˘
;

119 
	`Ârötf
(
°ªam
, "{ëh=\"0x%04"
PRIx16
"\"}", 
a
->
ëhîty≥
);

122 
OFPAT_SET_QUEUE
: {

123 
oÊ_a˘i⁄_£t_queue
 *
a
 = (oÊ_a˘i⁄_£t_queuê*)
a˘
;

125 
	`Ârötf
(
°ªam
, "{q=\"");

126 
	`oÊ_queue_¥öt
(
°ªam
, 
a
->
queue_id
);

127 
	`Ârötf
(
°ªam
, "\"}");

130 
OFPAT_GROUP
: {

131 
oÊ_a˘i⁄_group
 *
a
 = (oÊ_a˘i⁄_grou∞*)
a˘
;

133 
	`Ârötf
(
°ªam
, "{id=\"");

134 
	`oÊ_group_¥öt
(
°ªam
, 
a
->
group_id
);

135 
	`Ârötf
(
°ªam
, "\"}");

139 
OFPAT_SET_NW_TTL
: {

140 
oÊ_a˘i⁄_£t_nw_âl
 *
a
 = (oÊ_a˘i⁄_£t_nw_â»*)
a˘
;

142 
	`Ârötf
(
°ªam
, "{âl=\"%u\"}", 
a
->
nw_âl
);

145 
OFPAT_DEC_NW_TTL
: {

148 
OFPAT_EXPERIMENTER
: {

149 i‡(
exp
 =
NULL
 ||Éxp->
a˘
 =NULL ||Éxp->a˘->
to_°rög
 == NULL) {

150 
oÊ_a˘i⁄_ex≥rimíãr
 *
a
 = (oÊ_a˘i⁄_ex≥rimíã∏*)
a˘
;

152 
	`Ârötf
(
°ªam
, "{id=\"0x%"
PRIx32
"\"}", 
a
->
ex≥rimíãr_id
);

154 *
c
 = 
exp
->
a˘
->
	`to_°rög
(act);

155 
	`Ârötf
(
°ªam
, "%s", 
c
);

156 
	`‰ì
 (
c
);

161 
	}
}

	@oflib/ofl-actions-unpack.c

32 
	~<√töë/ö.h
>

33 
	~<sys/ty≥s.h
>

34 
	~<°dlib.h
>

35 
	~<°rög.h
>

36 
	~"oÊ.h
"

37 
	~"oÊ-utûs.h
"

38 
	~"oÊ-a˘i⁄s.h
"

39 
	~"oÊ-°ru˘s.h
"

40 
	~"oÊ-mesßges.h
"

41 
	~"oÊ-¥öt.h
"

42 
	~"oÊ-∑ckës.h
"

43 
	~"oÊ-log.h
"

44 
	~"›íÊow/›íÊow.h
"

45 
	~"oxm-m©ch.h
"

47 
	#LOG_MODULE
 
oÊ_a˘_u


	)

48 
	$OFL_LOG_INIT
(
LOG_MODULE
)

51 
oÊ_îr


52 
	$oÊ_a˘i⁄s_u≈ack
(
oÂ_a˘i⁄_hódî
 *
§c
, 
size_t
 *
Àn
, 
oÊ_a˘i⁄_hódî
 **
d°
, 
oÊ_exp
 *
exp
) {

54 i‡(*
Àn
 < (
oÂ_a˘i⁄_hódî
)) {

55 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ivedá˘i⁄ i†toÿsh‹à(%zu).", *
Àn
);

56  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

59 i‡(*
Àn
 < 
	`¡ohs
(
§c
->len)) {

60 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ivedá˘i⁄ ha†övÆidÜígth (£àtÿ%u, buà⁄ly %zuÑe˚ived).", 
	`¡ohs
(
§c
->
Àn
), *len);

61  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

64 i‡((
	`¡ohs
(
§c
->
Àn
) % 8) != 0) {

65 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ivedá˘i⁄Üígth i†nŸá mu…ùÀ o‡64 bô†(%u).", 
	`¡ohs
(
§c
->
Àn
));

66  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

69 
	`¡ohs
(
§c
->
ty≥
)) {

70 
OFPAT_OUTPUT
: {

71 
oÂ_a˘i⁄_ouçut
 *
ß
;

72 
oÊ_a˘i⁄_ouçut
 *
da
;

74 i‡(*
Àn
 < (
oÂ_a˘i⁄_ouçut
)) {

75 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived OUTPUTá˘i⁄ ha†övÆidÜígth (%zu).", *
Àn
);

76  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

79 
ß
 = (
oÂ_a˘i⁄_ouçut
 *)
§c
;

81 i‡(
	`¡ohl
(
ß
->
p‹t
) == 0 ||

82 (
	`¡ohl
(
ß
->
p‹t
Ë> 
OFPP_MAX
 &&Çtohl(ß->p‹tË< 
OFPP_IN_PORT
) ||

83 
	`¡ohl
(
ß
->
p‹t
Ë=
OFPP_ANY
) {

84 i‡(
	`OFL_LOG_IS_WARN_ENABLED
(
LOG_MODULE
)) {

85 *
ps
 = 
	`oÊ_p‹t_to_°rög
(
	`¡ohl
(
ß
->
p‹t
));

86 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived OUTPUTá˘i⁄ ha†övÆidÖ‹à(%s).", 
ps
);

87 
	`‰ì
(
ps
);

89  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_OUT_PORT
);

92 
da
 = (
oÊ_a˘i⁄_ouçut
 *)
	`mÆloc
((ofl_action_output));

93 
da
->
p‹t
 = 
	`¡ohl
(
ß
->port);

94 
da
->
max_Àn
 = 
	`¡ohs
(
ß
->max_len);

96 *
Àn
 -(
oÂ_a˘i⁄_ouçut
);

97 *
d°
 = (
oÊ_a˘i⁄_hódî
 *)
da
;

100 
OFPAT_COPY_TTL_OUT
: {

102 *
Àn
 -(
oÂ_a˘i⁄_hódî
);

103 *
d°
 = (
oÊ_a˘i⁄_hódî
 *)
	`mÆloc
((ofl_action_header));

107 
OFPAT_COPY_TTL_IN
: {

109 *
Àn
 -(
oÂ_a˘i⁄_hódî
);

110 *
d°
 = (
oÊ_a˘i⁄_hódî
 *)
	`mÆloc
((ofl_action_header));

114 
OFPAT_SET_MPLS_TTL
: {

115 
oÂ_a˘i⁄_m∂s_âl
 *
ß
;

116 
oÊ_a˘i⁄_m∂s_âl
 *
da
;

118 i‡(*
Àn
 < (
oÂ_a˘i⁄_m∂s_âl
)) {

119 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived SET_MPLS_TTLá˘i⁄ ha†övÆidÜígth (%zu).", *
Àn
);

120  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

123 
ß
 = (
oÂ_a˘i⁄_m∂s_âl
 *)
§c
;

125 
da
 = (
oÊ_a˘i⁄_m∂s_âl
 *)
	`mÆloc
((ofl_action_mpls_ttl));

126 
da
->
m∂s_âl
 = 
ß
->mpls_ttl;

128 *
Àn
 -(
oÂ_a˘i⁄_m∂s_âl
);

129 *
d°
 = (
oÊ_a˘i⁄_hódî
 *)
da
;

133 
OFPAT_DEC_MPLS_TTL
: {

135 *
Àn
 -(
oÂ_a˘i⁄_m∂s_âl
);

136 *
d°
 = (
oÊ_a˘i⁄_hódî
 *)
	`mÆloc
((ofl_action_header));

140 
OFPAT_PUSH_VLAN
:

141 
OFPAT_PUSH_PBB
:

142 
OFPAT_PUSH_MPLS
: {

143 
oÂ_a˘i⁄_push
 *
ß
;

144 
oÊ_a˘i⁄_push
 *
da
;

146 i‡(*
Àn
 < (
oÂ_a˘i⁄_push
)) {

147 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived PUSH_VLAN/MPLS/PBBá˘i⁄ ha†övÆidÜígth (%zu).", *
Àn
);

148  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

151 
ß
 = (
oÂ_a˘i⁄_push
 *)
§c
;

153 i‡(((
	`¡ohs
(
§c
->
ty≥
Ë=
OFPAT_PUSH_VLAN
) &&

154 (
	`¡ohs
(
ß
->
ëhîty≥
Ë!
ETH_TYPE_VLAN
 &&

155 
	`¡ohs
(
ß
->
ëhîty≥
Ë!
ETH_TYPE_VLAN_PBB
)) ||

156 ((
	`¡ohs
(
§c
->
ty≥
Ë=
OFPAT_PUSH_MPLS
) &&

157 (
	`¡ohs
(
ß
->
ëhîty≥
Ë!
ETH_TYPE_MPLS
 &&

158 
	`¡ohs
(
ß
->
ëhîty≥
Ë!
ETH_TYPE_MPLS_MCAST
)) ||

159 ((
	`¡ohs
(
§c
->
ty≥
Ë=
OFPAT_PUSH_PBB
) &&

160 (
	`¡ohs
(
ß
->
ëhîty≥
Ë!
ETH_TYPE_PBB
))) {

161 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived PUSH_VLAN/MPLS/PBB ha†övÆidÉthÅy≥. (%u)", 
	`¡ohs
(
ß
->
ëhîty≥
));

162  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_ARGUMENT
);

165 
da
 = (
oÊ_a˘i⁄_push
 *)
	`mÆloc
((ofl_action_push));

166 
da
->
ëhîty≥
 = 
	`¡ohs
(
ß
->ethertype);

168 *
Àn
 -(
oÂ_a˘i⁄_push
);

169 *
d°
 = (
oÊ_a˘i⁄_hódî
 *)
da
;

173 
OFPAT_POP_VLAN
:

174 
OFPAT_POP_PBB
: {

176 *
Àn
 -(
oÂ_a˘i⁄_hódî
);

177 *
d°
 = (
oÊ_a˘i⁄_hódî
 *)
	`mÆloc
((ofl_action_header));

181 
OFPAT_POP_MPLS
: {

182 
oÂ_a˘i⁄_p›_m∂s
 *
ß
;

183 
oÊ_a˘i⁄_p›_m∂s
 *
da
;

185 i‡(*
Àn
 < (
oÂ_a˘i⁄_p›_m∂s
)) {

186 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived POP_MPLSá˘i⁄ ha†övÆidÜígth (%zu).", *
Àn
);

187  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

190 
ß
 = (
oÂ_a˘i⁄_p›_m∂s
 *)
§c
;

192 
da
 = (
oÊ_a˘i⁄_p›_m∂s
 *)
	`mÆloc
((ofl_action_pop_mpls));

193 
da
->
ëhîty≥
 = 
	`¡ohs
(
ß
->ethertype);

195 *
Àn
 -(
oÂ_a˘i⁄_p›_m∂s
);

196 *
d°
 = (
oÊ_a˘i⁄_hódî
 *)
da
;

200 
OFPAT_SET_QUEUE
: {

201 
oÂ_a˘i⁄_£t_queue
 *
ß
;

202 
oÊ_a˘i⁄_£t_queue
 *
da
;

204 i‡(*
Àn
 < (
oÂ_a˘i⁄_£t_queue
)) {

205 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived SET_QUEUEá˘i⁄ ha†övÆidÜígth (%zu).", *
Àn
);

206  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

209 
ß
 = (
oÂ_a˘i⁄_£t_queue
 *)
§c
;

211 
da
 = (
oÊ_a˘i⁄_£t_queue
 *)
	`mÆloc
((ofl_action_set_queue));

212 
da
->
queue_id
 = 
	`¡ohl
(
ß
->queue_id);

214 *
Àn
 -(
oÂ_a˘i⁄_£t_queue
);

215 *
d°
 = (
oÊ_a˘i⁄_hódî
 *)
da
;

219 
OFPAT_GROUP
: {

220 
oÂ_a˘i⁄_group
 *
ß
;

221 
oÊ_a˘i⁄_group
 *
da
;

223 i‡(*
Àn
 < (
oÂ_a˘i⁄_group
)) {

224 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived GROUPá˘i⁄ ha†övÆidÜígth (%zu).", *
Àn
);

225  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

228 
ß
 = (
oÂ_a˘i⁄_group
 *)
§c
;

230 i‡(
	`¡ohl
(
ß
->
group_id
Ë> 
OFPG_MAX
) {

231 i‡(
	`OFL_LOG_IS_WARN_ENABLED
(
LOG_MODULE
)) {

232 *
gs
 = 
	`oÊ_group_to_°rög
(
	`¡ohl
(
ß
->
group_id
));

233 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived GROUPá˘i⁄ ha†övÆid grou∞id (%s).", 
gs
);

234 
	`‰ì
(
gs
);

236  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_OUT_GROUP
);

239 
da
 = (
oÊ_a˘i⁄_group
 *)
	`mÆloc
((ofl_action_group));

240 
da
->
group_id
 = 
	`¡ohl
(
ß
->group_id);

242 *
Àn
 -(
oÂ_a˘i⁄_group
);

243 *
d°
 = (
oÊ_a˘i⁄_hódî
 *)
da
;

247 
OFPAT_SET_NW_TTL
: {

248 
oÂ_a˘i⁄_nw_âl
 *
ß
;

249 
oÊ_a˘i⁄_£t_nw_âl
 *
da
;

251 i‡(*
Àn
 < (
oÂ_a˘i⁄_nw_âl
)) {

252 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived SET_NW_TTLá˘i⁄ ha†övÆidÜígth (%zu).", *
Àn
);

253  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

256 
ß
 = (
oÂ_a˘i⁄_nw_âl
 *)
§c
;

258 
da
 = (
oÊ_a˘i⁄_£t_nw_âl
 *)
	`mÆloc
((ofl_action_set_nw_ttl));

259 
da
->
nw_âl
 = 
ß
->nw_ttl;

261 *
Àn
 -(
oÂ_a˘i⁄_nw_âl
);

262 *
d°
 = (
oÊ_a˘i⁄_hódî
 *)
da
;

266 
OFPAT_DEC_NW_TTL
: {

268 *
Àn
 -(
oÂ_a˘i⁄_hódî
);

269 *
d°
 = (
oÊ_a˘i⁄_hódî
 *)
	`mÆloc
((ofl_action_header));

273 
OFPAT_SET_FIELD
: {

274 
oÂ_a˘i⁄_£t_fõld
 *
ß
;

275 
oÊ_a˘i⁄_£t_fõld
 *
da
;

276 
uöt8_t
 *
vÆue
;

278 
ß
 = (
oÂ_a˘i⁄_£t_fõld
*Ë
§c
;

279 
da
 = (
oÊ_a˘i⁄_£t_fõld
 *)
	`mÆloc
((ofl_action_set_field));

280 
da
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

282 
	`mem˝y
(&
da
->
fõld
->
hódî
,
ß
->field,4);

283 
da
->
fõld
->
hódî
 = 
	`¡ohl
(da->field->header);

284 
vÆue
 = (
uöt8_t
 *Ë
§c
 +  (
oÂ_a˘i⁄_£t_fõld
);

285 
da
->
fõld
->
vÆue
 = 
	`mÆloc
(
	`OXM_LENGTH
(da->fõld->
hódî
));

287 if(
da
->
fõld
->
hódî
 =
OXM_OF_IN_PORT
 || da->fõld->hódî =
OXM_OF_IN_PHY_PORT


288 || 
da
->
fõld
->
hódî
 =
OXM_OF_METADATA
){

289  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_SET_TYPE
);

291 
	`OXM_LENGTH
(
da
->
fõld
->
hódî
)){

295 
	`mem˝y
(
da
->
fõld
->
vÆue
 , vÆue, 
	`OXM_LENGTH
(da->fõld->
hódî
));

299 
uöt16_t
 
v
 = 
	`¡ohs
(*((uöt16_t*Ë
vÆue
));

300 
	`mem˝y
(
da
->
fõld
->
vÆue
 , &
v
, 
	`OXM_LENGTH
(da->fõld->
hódî
));

304 
uöt32_t
 
v
;

305 
uöt8_t
 
fõld
 = 
	`OXM_FIELD
(
da
->fõld->
hódî
);

306 if–
fõld
 != 11 && field != 12 && field != 22 && field != 23)

307 
v
 = 
	`ht⁄l
(*((
uöt32_t
*Ë
vÆue
));

308 
v
 = *((
uöt32_t
*Ë
vÆue
);

309 
	`mem˝y
(
da
->
fõld
->
vÆue
 , &
v
, 
	`OXM_LENGTH
(da->fõld->
hódî
));

313 
uöt64_t
 
v
 = 
	`ht⁄64
(*((uöt64_t*Ë
vÆue
));

314 
	`mem˝y
(
da
->
fõld
->
vÆue
 , &
v
, 
	`OXM_LENGTH
(da->fõld->
hódî
));

318 *
Àn
 -
	`ROUND_UP
(
	`¡ohs
(
§c
->len),8);

319 *
d°
 = (
oÊ_a˘i⁄_hódî
 *)
da
;

323 
OFPAT_EXPERIMENTER
: {

324 
oÊ_îr
 
îr‹
;

326 i‡(*
Àn
 < (
oÂ_a˘i⁄_ex≥rimíãr_hódî
)) {

327 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived EXPERIMENTERá˘i⁄ ha†övÆidÜígth (%zu).", *
Àn
);

328  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

331 i‡(
exp
 =
NULL
 ||Éxp->
a˘
 =NULL ||Éxp->a˘->
u≈ack
 == NULL) {

332 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received EXPERIMENTERáction, butÇo callback is given.");

333  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_EXPERIMENTER
);

335 
îr‹
 = 
exp
->
a˘
->
	`u≈ack
(
§c
, 
Àn
, 
d°
);

336 i‡(
îr‹
) {

337  
îr‹
;

343 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived unknow¿a˘i⁄Åy≥ (%u).", 
	`¡ohs
(
§c
->
ty≥
));

344  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_TYPE
);

347 (*
d°
)->
ty≥
 = (
oÂ_a˘i⁄_ty≥
)
	`¡ohs
(
§c
->type);

350 
	}
}

	@oflib/ofl-actions.c

32 
	~<°dlib.h
>

33 
	~<°rög.h
>

34 
	~<√töë/ö.h
>

35 
	~"oÊ.h
"

36 
	~"oÊ-a˘i⁄s.h
"

37 
	~"oÊ-log.h
"

39 
	#LOG_MODULE
 
oÊ_a˘


	)

40 
	$OFL_LOG_INIT
(
LOG_MODULE
)

43 
	$oÊ_a˘i⁄s_‰ì
(
oÊ_a˘i⁄_hódî
 *
a˘
, 
oÊ_exp
 *
exp
) {

44 
a˘
->
ty≥
) {

45 
OFPAT_SET_FIELD
:{

46 
oÊ_a˘i⁄_£t_fõld
 *
a
 = (oÊ_a˘i⁄_£t_fõld*Ë
a˘
;

47 
	`‰ì
(
a
->
fõld
->
vÆue
);

48 
	`‰ì
(
a
->
fõld
);

49 
	`‰ì
(
a
);

53 
OFPAT_OUTPUT
:

54 
OFPAT_COPY_TTL_OUT
:

55 
OFPAT_COPY_TTL_IN
:

56 
OFPAT_SET_MPLS_TTL
:

57 
OFPAT_DEC_MPLS_TTL
:

58 
OFPAT_PUSH_VLAN
:

59 
OFPAT_POP_VLAN
:

60 
OFPAT_PUSH_MPLS
:

61 
OFPAT_POP_MPLS
:

62 
OFPAT_PUSH_PBB
:

63 
OFPAT_POP_PBB
:

64 
OFPAT_SET_QUEUE
:

65 
OFPAT_GROUP
:

66 
OFPAT_SET_NW_TTL
:

67 
OFPAT_DEC_NW_TTL
: {

70 
OFPAT_EXPERIMENTER
: {

71 i‡(
exp
 =
NULL
 ||Éxp->
a˘
 =NULL ||Éxp->a˘->
‰ì
 == NULL) {

72 
	`OFL_LOG_WARN
(
LOG_MODULE
, "FreeingÉxperimenteráction, butÇo callback is given.");

75 
exp
->
a˘
->
	`‰ì
(act);

81 
	`‰ì
(
a˘
);

82 
	}
}

84 
oÊ_îr


85 
	$oÊ_utûs_cou¡_oÂ_a˘i⁄s
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
) {

86 
oÂ_a˘i⁄_hódî
 *
a˘
;

87 
uöt8_t
 *
d
;

89 
d
 = (
uöt8_t
 *)
d©a
;

90 *
cou¡
 = 0;

93 
d©a_Àn
 >(
oÂ_a˘i⁄_hódî
) -4 ) {

94 
a˘
 = (
oÂ_a˘i⁄_hódî
 *)
d
;

95 i‡(
d©a_Àn
 < 
	`¡ohs
(
a˘
->
Àn
Ë||Çtohs◊˘->ÀnË< (
oÂ_a˘i⁄_hódî
) - 4) {

96 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Receivedáction has invalidÜength.");

97  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

99 
d©a_Àn
 -
	`¡ohs
(
a˘
->
Àn
);

100 
d
 +
	`¡ohs
(
a˘
->
Àn
);

101 (*
cou¡
)++;

105 
	}
}

	@oflib/ofl-actions.h

32 #i‚de‡
OFL_ACTIONS_H


33 
	#OFL_ACTIONS_H
 1

	)

35 
	~<sys/ty≥s.h
>

36 
	~<°dio.h
>

38 
	~"oÊ.h
"

39 
	~"oÊ-°ru˘s.h
"

40 
	~"../ö˛ude/›íÊow/›íÊow.h
"

42 
	goÊ_exp
;

50 
	soÊ_a˘i⁄_hódî
 {

51 
oÂ_a˘i⁄_ty≥
 
	mty≥
;

52 
uöt16_t
 
	mÀn
;

56 
	soÊ_a˘i⁄_ouçut
 {

57 
oÊ_a˘i⁄_hódî
 
	mhódî
;

59 
uöt32_t
 
	mp‹t
;

60 
uöt16_t
 
	mmax_Àn
;

63 
	soÊ_a˘i⁄_m∂s_âl
 {

64 
oÊ_a˘i⁄_hódî
 
	mhódî
;

66 
uöt8_t
 
	mm∂s_âl
;

69 
	soÊ_a˘i⁄_push
 {

70 
oÊ_a˘i⁄_hódî
 
	mhódî
;

72 
uöt16_t
 
	mëhîty≥
;

75 
	soÊ_a˘i⁄_p›_m∂s
 {

76 
oÊ_a˘i⁄_hódî
 
	mhódî
;

78 
uöt16_t
 
	mëhîty≥
;

81 
	soÊ_a˘i⁄_£t_queue
 {

82 
oÊ_a˘i⁄_hódî
 
	mhódî
;

84 
uöt32_t
 
	mqueue_id
;

87 
	soÊ_a˘i⁄_group
 {

88 
oÊ_a˘i⁄_hódî
 
	mhódî
;

90 
uöt32_t
 
	mgroup_id
;

93 
	soÊ_a˘i⁄_£t_nw_âl
 {

94 
oÊ_a˘i⁄_hódî
 
	mhódî
;

96 
uöt8_t
 
	mnw_âl
;

99 
	soÊ_a˘i⁄_£t_fõld
 {

100 
oÊ_a˘i⁄_hódî
 
	mhódî
;

101 
oÊ_m©ch_év
 *
	mfõld
;

104 
	soÊ_a˘i⁄_ex≥rimíãr
 {

105 
oÊ_a˘i⁄_hódî
 
	mhódî
;

107 
uöt32_t
 
	mex≥rimíãr_id
;

119 
size_t


120 
oÊ_a˘i⁄s_∑ck
(
oÊ_a˘i⁄_hódî
 *
§c
, 
oÂ_a˘i⁄_hódî
 *
d°
, 
uöt8_t
* 
d©a
, 
oÊ_exp
 *
exp
);

126 
oÊ_îr


127 
oÊ_utûs_cou¡_oÂ_a˘i⁄s
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
);

133 
oÊ_îr


134 
oÊ_a˘i⁄s_u≈ack
(
oÂ_a˘i⁄_hódî
 *
§c
, 
size_t
 *
Àn
, 
oÊ_a˘i⁄_hódî
 **
d°
, 
oÊ_exp
 *
exp
);

145 
oÊ_a˘i⁄s_‰ì
(
oÊ_a˘i⁄_hódî
 *
a˘
, 
oÊ_exp
 *
exp
);

156 
size_t


157 
oÊ_a˘i⁄s_oÂ_tŸÆ_Àn
(
oÊ_a˘i⁄_hódî
 **
a˘i⁄s
, 
size_t
 
a˘i⁄s_num
, 
oÊ_exp
 *
exp
);

162 
size_t


163 
oÊ_a˘i⁄s_oÂ_Àn
(
oÊ_a˘i⁄_hódî
 *
a˘i⁄
, 
oÊ_exp
 *
exp
);

174 
oÊ_a˘i⁄_to_°rög
(
oÊ_a˘i⁄_hódî
 *
a˘
, 
oÊ_exp
 *
exp
);

180 
oÊ_a˘i⁄_¥öt
(
FILE
 *
°ªam
, 
oÊ_a˘i⁄_hódî
 *
a˘
, 
oÊ_exp
 *
exp
);

	@oflib/ofl-log-vlog-cc.h

32 #i‚de‡
OFL_LOG_VLOG_CC_H


33 
	#OFL_LOG_VLOG_CC_H


	)

35 
	~"vlog.hh
"

37 
	#VLOG_NAME
(
NAME
Ë
lg_
##
	)
NAME

39 
	#OFL_LOG_INIT
(
MODULE
) \

40 
vigû
::
Vlog_moduÀ
 
	`VLOG_NAME
(
MODULE
)("MODULE");

	)

42 
	#OFL_LOG_DBG
(
MODULE
, ...) \

43 
	`VLOG_NAME
(
MODULE
).
	`dbg
(
__VA_ARGS__
)

	)

45 
	#OFL_LOG_WARN
(
MODULE
, ...) \

46 
	`VLOG_NAME
(
MODULE
).
	`w¨n
(
__VA_ARGS__
)

	)

48 
	#OFL_LOG_IS_DBG_ENABLED
(
MODULE
) \

49 
	`VLOG_NAME
(
MODULE
).
	`is_dbg_íabÀd
()

	)

51 
	#OFL_LOG_IS_WARN_ENABLED
(
MODULE
) \

52 
	`VLOG_NAME
(
MODULE
).
	`is_w¨n_íabÀd
()

	)

	@oflib/ofl-log-vlog.h

32 #i‚de‡
OFL_LOG_VLOG_H


33 
	#OFL_LOG_VLOG_H


	)

35 
	~"vlog.h
"

37 
	#VLOG_NAME
(
NAME
Ë
VLM_
##
	)
NAME

39 
	#OFL_LOG_INIT
(
MODULE
)

	)

41 
	#OFL_LOG_DBG
(
MODULE
, ...) \

42 
	`VLOG_DBG
(
	`VLOG_NAME
(
MODULE
), 
__VA_ARGS__
)

	)

44 
	#OFL_LOG_WARN
(
MODULE
, ...) \

45 
	`VLOG_WARN
(
	`VLOG_NAME
(
MODULE
), 
__VA_ARGS__
)

	)

47 
	#OFL_LOG_IS_DBG_ENABLED
(
MODULE
) \

48 
	`VLOG_IS_DBG_ENABLED
(
	`VLOG_NAME
(
MODULE
))

	)

50 
	#OFL_LOG_IS_WARN_ENABLED
(
MODULE
) \

51 
	`VLOG_IS_WARN_ENABLED
(
	`VLOG_NAME
(
MODULE
))

	)

	@oflib/ofl-log.h

32 #i‚de‡
OFL_LOG_H


33 
	#OFL_LOG_H


	)

35 #ifde‡
OFL_LOG_VLOG


36 
	~"oÊ-log-vlog.h
"

37 #ñi‡
OFL_LOG_VLOG_CC


38 
	~"oÊ-log-vlog-cc.h
"

	@oflib/ofl-messages-pack.c

32 
	~<°dlib.h
>

33 
	~<°rög.h
>

34 
	~<√töë/ö.h
>

35 
	~"oÊ-a˘i⁄s.h
"

36 
	~"oÊ-mesßges.h
"

37 
	~"oÊ-°ru˘s.h
"

38 
	~"oÊ-log.h
"

39 
	~"oÊ-utûs.h
"

40 
	~"›íÊow/›íÊow.h
"

42 
	#UNUSED
 
	`__©åibuã__
((
__unu£d__
))

	)

44 
	#LOG_MODULE
 
oÊ_msg_p


	)

45 
	$OFL_LOG_INIT
(
LOG_MODULE
)

54 
	$oÊ_msg_∑ck_îr‹
(
oÊ_msg_îr‹
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

55 
oÂ_îr‹_msg
 *
îr
;

57 *
buf_Àn
 = (
oÂ_îr‹_msg
Ë+ 
msg
->
d©a_Àngth
;

58 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

60 
îr
 = (
oÂ_îr‹_msg
 *)(*
buf
);

61 
îr
->
ty≥
 = 
	`ht⁄s
(
msg
->type);

62 
îr
->
code
 = 
	`ht⁄s
(
msg
->code);

63 
	`mem˝y
(
îr
->
d©a
, 
msg
->d©a, msg->
d©a_Àngth
);

65 
	}
}

68 
	$oÊ_msg_∑ck_echo
(
oÊ_msg_echo
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

69 
uöt8_t
 *
d©a
;

71 *
buf_Àn
 = (
oÂ_hódî
Ë+ 
msg
->
d©a_Àngth
;

72 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

74 i‡(
msg
->
d©a_Àngth
 > 0) {

75 
d©a
 = (*
buf
Ë+ (
oÂ_hódî
);

76 
	`mem˝y
(
d©a
, 
msg
->d©a, msg->
d©a_Àngth
);

79 
	}
}

82 
	$oÊ_msg_∑ck_rﬁe_ªque°
(
oÊ_msg_rﬁe_ªque°
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

83 
oÂ_rﬁe_ªque°
 *
ªq
;

85 *
buf_Àn
 = (
oÂ_rﬁe_ªque°
);

86 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

88 
ªq
 = (
oÂ_rﬁe_ªque°
 *)(*
buf
);

89 
ªq
->
rﬁe
 = 
	`ht⁄l
(
msg
->role);

90 
	`mem£t
(
ªq
->
∑d
,0,(req->pad));

91 
ªq
->
gíî©i⁄_id
 = 
	`ht⁄64
(
msg
->generation_id);

94 
	}
}

97 
	$oÊ_msg_∑ck_„©uªs_ª∂y
(
oÊ_msg_„©uªs_ª∂y
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

98 
oÂ_swôch_„©uªs
 *
„©uªs
;

100 *
buf_Àn
 = (
oÂ_swôch_„©uªs
);

101 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

103 
„©uªs
 = (
oÂ_swôch_„©uªs
 *)(*
buf
);

104 
„©uªs
->
d©≠©h_id
 = 
	`ht⁄64
(
msg
->datapath_id);

105 
„©uªs
->
n_buf„rs
 = 
	`ht⁄l
–
msg
->n_buffers);

106 
„©uªs
->
n_èbÀs
 = 
msg
->n_tables;

107 
„©uªs
->
auxûüry_id
 = 
msg
->auxiliary_id;

108 
	`mem£t
(
„©uªs
->
∑d
, 0x00, 2);

109 
„©uªs
->
ˇ∑bûôõs
 = 
	`ht⁄l
–
msg
->capabilities);

110 
„©uªs
->
ª£rved
 = 0x00000000;

113 
	}
}

116 
	$oÊ_msg_∑ck_gë_c⁄fig_ª∂y
(
oÊ_msg_gë_c⁄fig_ª∂y
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

117 
oÂ_swôch_c⁄fig
 *
c⁄fig
;

119 *
buf_Àn
 = (
oÂ_swôch_c⁄fig
);

120 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

122 
c⁄fig
 = (
oÂ_swôch_c⁄fig
 *)(*
buf
);

123 
c⁄fig
->
Êags
 = 
	`ht⁄s
(
msg
->config->flags);

124 
c⁄fig
->
miss_£nd_Àn
 = 
	`ht⁄s
(
msg
->config->miss_send_len);

127 
	}
}

130 
	$oÊ_msg_∑ck_£t_c⁄fig
(
oÊ_msg_£t_c⁄fig
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

131 
oÂ_swôch_c⁄fig
 *
c⁄fig
;

133 *
buf_Àn
 = (
oÂ_swôch_c⁄fig
);

134 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

136 
c⁄fig
 = (
oÂ_swôch_c⁄fig
 *)(*
buf
);

137 
c⁄fig
->
miss_£nd_Àn
 = 
	`ht⁄s
(
msg
->config->miss_send_len);

138 
c⁄fig
->
Êags
 = 
	`ht⁄s
(
msg
->config->flags);

141 
	}
}

144 
	$oÊ_msg_∑ck_∑ckë_ö
(
oÊ_msg_∑ckë_ö
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

145 
oÂ_∑ckë_ö
 *
∑ckë_ö
;

146 
uöt8_t
 *
±r
;

148 *
buf_Àn
 = (
oÂ_∑ckë_ö
Ë+ 
	`ROUND_UP
(
msg
->
m©ch
->
Àngth
 - 4 ,8Ë+ msg->
d©a_Àngth
 + 2;

149 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

150 
∑ckë_ö
 = (
oÂ_∑ckë_ö
 *)(*
buf
);

151 
∑ckë_ö
->
buf„r_id
 = 
	`ht⁄l
(
msg
->buffer_id);

152 
∑ckë_ö
->
tŸÆ_Àn
 = 
	`ht⁄s
(
msg
->total_len);

153 
∑ckë_ö
->
ªas⁄
 = 
msg
->reason;

154 
∑ckë_ö
->
èbÀ_id
 = 
msg
->table_id;

155 
∑ckë_ö
->
cookõ
 = 
	`ht⁄64
(
msg
->cookie);

157 
±r
 = (*
buf
Ë+ ((
oÂ_∑ckë_ö
) - 4);

158 
	`oÊ_°ru˘s_m©ch_∑ck
(
msg
->
m©ch
,&(
∑ckë_ö
->m©ch),
±r
, 
NULL
);

159 
±r
 = (*
buf
Ë+ 
	`ROUND_UP
(((
oÂ_∑ckë_ö
)-4Ë+ 
msg
->
m©ch
->
Àngth
,8);

162 
	`mem£t
(
±r
,0,2);

164 i‡(
msg
->
d©a_Àngth
 > 0) {

165 
	`mem˝y
(
±r
 + 2 , 
msg
->
d©a
, msg->
d©a_Àngth
);

169 
	}
}

172 
	$oÊ_msg_∑ck_Êow_ªmoved
(
oÊ_msg_Êow_ªmoved
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
, 
oÊ_exp
 *
exp
) {

173 
oÂ_Êow_ªmoved
 *
o‰
;

175 
uöt8_t
 *
±r
;

176 *
buf_Àn
 = 
	`ROUND_UP
(((
oÂ_Êow_ªmoved
Ë-4Ë+ 
msg
->
°©s
->
m©ch
->
Àngth
 ,8);

177 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

179 
o‰
 = (
oÂ_Êow_ªmoved
 *)(*
buf
);

180 
o‰
->
cookõ
 = 
	`ht⁄64
(
msg
->
°©s
->cookie);

181 
o‰
->
¥i‹ôy
 = 
	`ht⁄s
(
msg
->
°©s
->priority);

182 
o‰
->
ªas⁄
 = 
msg
->reason;

183 
o‰
->
èbÀ_id
 = 
msg
->
°©s
->table_id;

184 
o‰
->
duøti⁄_£c
 = 
	`ht⁄l
–
msg
->
°©s
->duration_sec);

185 
o‰
->
duøti⁄_n£c
 = 
	`ht⁄l
–
msg
->
°©s
->duration_nsec);

186 
o‰
->
idÀ_timeout
 = 
	`ht⁄s
–
msg
->
°©s
->idle_timeout);

187 
o‰
->
∑ckë_cou¡
 = 
	`ht⁄64
(
msg
->
°©s
->packet_count);

188 
o‰
->
byã_cou¡
 = 
	`ht⁄64
(
msg
->
°©s
->byte_count);

190 
±r
 = (*
buf
Ë+ ((
oÂ_Êow_ªmoved
) - 4);

192 
	`oÊ_°ru˘s_m©ch_∑ck
(
msg
->
°©s
->
m©ch
, &(
o‰
->m©ch),
±r
, 
exp
);

195 
	}
}

198 
	$oÊ_msg_∑ck_p‹t_°©us
(
oÊ_msg_p‹t_°©us
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

199 
oÂ_p‹t_°©us
 *
°©us
;

201 *
buf_Àn
 = (
oÂ_p‹t_°©us
);

202 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

204 
°©us
 = (
oÂ_p‹t_°©us
 *)(*
buf
);

205 
°©us
->
ªas⁄
 = 
msg
->reason;

206 
	`mem£t
(
°©us
->
∑d
, 0x00, 7);

208 
	`oÊ_°ru˘s_p‹t_∑ck
(
msg
->
desc
, &(
°©us
->desc));

211 
	}
}

214 
	$oÊ_msg_∑ck_∑ckë_out
(
oÊ_msg_∑ckë_out
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
, 
oÊ_exp
 *
exp
) {

215 
oÂ_∑ckë_out
 *
∑ckë_out
;

216 
size_t
 
a˘_Àn
;

217 
uöt8_t
 *
±r
;

218 
i
;

220 
a˘_Àn
 = 
	`oÊ_a˘i⁄s_oÂ_tŸÆ_Àn
(
msg
->
a˘i⁄s
, msg->
a˘i⁄s_num
, 
exp
);

222 *
buf_Àn
 = (
oÂ_∑ckë_out
Ë+ 
a˘_Àn
 + 
msg
->
d©a_Àngth
;

223 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

225 
∑ckë_out
 = (
oÂ_∑ckë_out
 *)(*
buf
);

226 
∑ckë_out
->
buf„r_id
 = 
	`ht⁄l
(
msg
->buffer_id);

227 
∑ckë_out
->
ö_p‹t
 = 
	`ht⁄l
(
msg
->in_port);

228 
∑ckë_out
->
a˘i⁄s_Àn
 = 
	`ht⁄s
(
a˘_Àn
);

229 
	`mem£t
(
∑ckë_out
->
∑d
, 0x00, 6);

231 
±r
 = (*
buf
Ë+ (
oÂ_∑ckë_out
);

233 
i
=0; i<
msg
->
a˘i⁄s_num
; i++) {

234 
±r
 +
	`oÊ_a˘i⁄s_∑ck
(
msg
->
a˘i⁄s
[
i
], (
oÂ_a˘i⁄_hódî
 *Ìå,*
buf
, 
exp
);

237 i‡(
msg
->
d©a_Àngth
 > 0) {

238 
	`mem˝y
(
±r
, 
msg
->
d©a
, msg->
d©a_Àngth
);

242 
	}
}

245 
	$oÊ_msg_∑ck_Êow_mod
(
oÊ_msg_Êow_mod
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
, 
oÊ_exp
 *
exp
) {

246 
oÂ_Êow_mod
 *
Êow_mod
;

247 
uöt8_t
 *
±r
;

249 
i
;

251 *
buf_Àn
 = 
	`ROUND_UP
((
oÂ_Êow_mod
)- 4 + 
msg
->
m©ch
->
Àngth
,8) +

252 
	`oÊ_°ru˘s_ö°ru˘i⁄s_oÂ_tŸÆ_Àn
(
msg
->
ö°ru˘i⁄s
, msg->
ö°ru˘i⁄s_num
, 
exp
);

254 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

255 
Êow_mod
 = (
oÂ_Êow_mod
 *)(*
buf
);

256 
Êow_mod
->
cookõ
 = 
	`ht⁄64
(
msg
->cookie);

257 
Êow_mod
->
cookõ_mask
 = 
	`ht⁄64
(
msg
->cookie_mask);

258 
Êow_mod
->
èbÀ_id
 = 
msg
->table_id;

259 
Êow_mod
->
comm™d
 = 
msg
->command;

260 
Êow_mod
->
idÀ_timeout
 = 
	`ht⁄s
–
msg
->idle_timeout);

261 
Êow_mod
->
h¨d_timeout
 = 
	`ht⁄s
–
msg
->hard_timeout);

262 
Êow_mod
->
¥i‹ôy
 = 
	`ht⁄s
–
msg
->priority);

263 
Êow_mod
->
buf„r_id
 = 
	`ht⁄l
–
msg
->buffer_id);

264 
Êow_mod
->
out_p‹t
 = 
	`ht⁄l
–
msg
->out_port);

265 
Êow_mod
->
out_group
 = 
	`ht⁄l
–
msg
->out_group);

266 
Êow_mod
->
Êags
 = 
	`ht⁄s
–
msg
->flags);

267 
	`mem£t
(
Êow_mod
->
∑d
, 0x00, 2);

269 
±r
 = (*
buf
Ë+ (
oÂ_Êow_mod
)- 4;

270 
	`oÊ_°ru˘s_m©ch_∑ck
(
msg
->
m©ch
, &(
Êow_mod
->m©ch), 
±r
, 
exp
);

272 
±r
 = (*
buf
Ë+ 
	`ROUND_UP
((
oÂ_Êow_mod
)- 4 + 
msg
->
m©ch
->
Àngth
,8);

273 
i
=0; i<
msg
->
ö°ru˘i⁄s_num
; i++) {

274 
±r
 +
	`oÊ_°ru˘s_ö°ru˘i⁄s_∑ck
(
msg
->
ö°ru˘i⁄s
[
i
], (
oÂ_ö°ru˘i⁄
 *Ìå, 
exp
);

277 
	}
}

280 
	$oÊ_msg_∑ck_group_mod
(
oÊ_msg_group_mod
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
, 
oÊ_exp
 *
exp
) {

281 
oÂ_group_mod
 *
group_mod
;

282 
uöt8_t
 *
±r
;

283 
i
;

285 *
buf_Àn
 = (
oÂ_group_mod
Ë+ 
	`oÊ_°ru˘s_buckës_oÂ_tŸÆ_Àn
(
msg
->
buckës
, msg->
buckës_num
, 
exp
);;

286 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

288 
group_mod
 = (
oÂ_group_mod
 *)(*
buf
);

289 
group_mod
->
comm™d
 = 
	`ht⁄s
(
msg
->command);

290 
group_mod
->
ty≥
 = 
msg
->type;

291 
group_mod
->
∑d
 = 0x00;

292 
group_mod
->
group_id
 = 
	`ht⁄l
(
msg
->group_id);

294 
±r
 = (*
buf
Ë+ (
oÂ_group_mod
);

296 
i
=0; i<
msg
->
buckës_num
; i++) {

297 
±r
 +
	`oÊ_°ru˘s_buckë_∑ck
(
msg
->
buckës
[
i
], (
oÂ_buckë
 *Ìå, 
exp
);

301 
	}
}

304 
	$oÊ_msg_∑ck_p‹t_mod
(
oÊ_msg_p‹t_mod
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

305 
oÂ_p‹t_mod
 *
p‹t_mod
;

307 *
buf_Àn
 = (
oÂ_p‹t_mod
);

308 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

310 
p‹t_mod
 = (
oÂ_p‹t_mod
 *)(*
buf
);

311 
p‹t_mod
->
p‹t_no
 = 
	`ht⁄l
(
msg
->port_no);

312 
	`mem£t
(
p‹t_mod
->
∑d
, 0x00, 4);

313 
	`mem˝y
(&(
p‹t_mod
->
hw_addr
), &(
msg
->hw_addr), 
OFP_ETH_ALEN
);

314 
	`mem£t
(
p‹t_mod
->
∑d2
, 0x00, 2);

315 
p‹t_mod
->
c⁄fig
 = 
	`ht⁄l
(
msg
->config);

316 
p‹t_mod
->
mask
 = 
	`ht⁄l
(
msg
->mask);

317 
p‹t_mod
->
advîti£
 = 
	`ht⁄l
(
msg
->advertise);

318 
	`mem£t
(
p‹t_mod
->
∑d3
, 0x00, 4);

321 
	}
}

324 
	$oÊ_msg_∑ck_èbÀ_mod
(
oÊ_msg_èbÀ_mod
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

325 
oÂ_èbÀ_mod
 *
èbÀ_mod
;

327 *
buf_Àn
 = (
oÂ_èbÀ_mod
);

328 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

330 
èbÀ_mod
 = (
oÂ_èbÀ_mod
 *)(*
buf
);

331 
èbÀ_mod
->
èbÀ_id
 = 
msg
->table_id;

332 
	`mem£t
(
èbÀ_mod
->
∑d
, 0x00, 3);

333 
èbÀ_mod
->
c⁄fig
 = 
	`ht⁄l
(
msg
->config);

336 
	}
}

339 
	$oÊ_msg_∑ck_mëî_mod
(
oÊ_msg_mëî_mod
 *
msg
, 
uöt8_t
 ** 
buf
, 
size_t
 *
buf_Àn
){

340 
oÂ_mëî_mod
 *
mëî_mod
;

341 
uöt8_t
 *
±r
;

342 
i
;

344 *
buf_Àn
 = (
oÂ_mëî_mod
Ë+ 
	`oÊ_°ru˘s_mëî_b™ds_oÂ_tŸÆ_Àn
(
msg
->
b™ds
, msg->
mëî_b™ds_num
);

345 *
buf
 = 
	`mÆloc
(*
buf_Àn
);

347 
mëî_mod
 = (
oÂ_mëî_mod
*Ë(*
buf
);

348 
mëî_mod
->
comm™d
 = 
	`ht⁄s
(
msg
->command);

349 
mëî_mod
->
Êags
 = 
	`ht⁄s
(
msg
->flags);

350 
mëî_mod
->
mëî_id
 = 
	`¡ohl
(
msg
->meter_id);

352 
±r
 = (*
buf
Ë+ (
oÂ_mëî_mod
);

353 
i
=0; i < 
msg
->
mëî_b™ds_num
; i++) {

354 
±r
 +
	`oÊ_°ru˘s_mëî_b™d_∑ck
(
msg
->
b™ds
[
i
], (
oÂ_mëî_b™d_hódî
 *)Ötr);

357 
	}
}

360 
	$oÊ_msg_∑ck_async_c⁄fig
(
oÊ_msg_async_c⁄fig
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
){

361 
oÂ_async_c⁄fig
 *
ac
;

362 
i
;

363 *
buf_Àn
 = (
oÂ_async_c⁄fig
);

364 *
buf
 = 
	`mÆloc
(*
buf_Àn
);

366 
ac
 = (
oÂ_async_c⁄fig
*)(*
buf
);

367 
i
 = 0; i < 2; i++){

368 
ac
->
∑ckë_ö_mask
[
i
] = 
msg
->
c⁄fig
->packet_in_mask[i];

369 
ac
->
p‹t_°©us_mask
[
i
] = 
msg
->
c⁄fig
->port_status_mask[i];

370 
ac
->
Êow_ªmoved_mask
[
i
] = 
msg
->
c⁄fig
->flow_removed_mask[i];

373 
	}
}

376 
	$oÊ_msg_∑ck_mu…ù¨t_ªque°_Êow
(
oÊ_msg_mu…ù¨t_ªque°_Êow
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
, 
oÊ_exp
 *
exp
) {

378 
oÂ_mu…ù¨t_ªque°
 *
ªq
;

379 
oÂ_Êow_°©s_ªque°
 *
°©s
;

380 
uöt8_t
 *
±r
;

382 *
buf_Àn
 = (
oÂ_mu…ù¨t_ªque°
Ë+ (
oÂ_Êow_°©s_ªque°
Ë+ 
msg
->
m©ch
->
Àngth
;

383 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

385 
ªq
 = (
oÂ_mu…ù¨t_ªque°
 *)(*
buf
);

386 
°©s
 = (
oÂ_Êow_°©s_ªque°
 *)
ªq
->
body
;

387 
°©s
->
èbÀ_id
 = 
msg
->table_id;

388 
	`mem£t
(
°©s
->
∑d
, 0x00, 3);

389 
°©s
->
out_p‹t
 = 
	`ht⁄l
–
msg
->out_port);

390 
°©s
->
out_group
 = 
	`ht⁄l
–
msg
->out_group);

391 
	`mem£t
(
°©s
->
∑d2
, 0x00, 4);

392 
°©s
->
cookõ
 = 
	`ht⁄64
(
msg
->cookie);

393 
°©s
->
cookõ_mask
 = 
	`ht⁄64
(
msg
->cookie_mask);

395 
±r
 = (*
buf
Ë+ (
oÂ_mu…ù¨t_ªque°
Ë+ (
oÂ_Êow_°©s_ªque°
);

396 
	`oÊ_°ru˘s_m©ch_∑ck
(
msg
->
m©ch
, &(
°©s
->m©ch),
±r
, 
exp
);

399 
	}
}

402 
	$oÊ_msg_∑ck_mu…ù¨t_ªque°_p‹t
(
oÊ_msg_mu…ù¨t_ªque°_p‹t
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

403 
oÂ_mu…ù¨t_ªque°
 *
ªq
;

404 
oÂ_p‹t_°©s_ªque°
 *
°©s
;

406 *
buf_Àn
 = (
oÂ_mu…ù¨t_ªque°
Ë+ (
oÂ_p‹t_°©s_ªque°
);

407 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

409 
ªq
 = (
oÂ_mu…ù¨t_ªque°
 *)(*
buf
);

410 
°©s
 = (
oÂ_p‹t_°©s_ªque°
 *)
ªq
->
body
;

411 
°©s
->
p‹t_no
 = 
	`ht⁄l
(
msg
->port_no);

412 
	`mem£t
(
°©s
->
∑d
, 0x00, 4);

415 
	}
}

418 
	$oÊ_msg_∑ck_mu…ù¨t_ªque°_queue
(
oÊ_msg_mu…ù¨t_ªque°_queue
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

419 
oÂ_mu…ù¨t_ªque°
 *
ªq
;

420 
oÂ_queue_°©s_ªque°
 *
°©s
;

422 *
buf_Àn
 = (
oÂ_mu…ù¨t_ªque°
Ë+ (
oÂ_queue_°©s_ªque°
);

423 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

425 
ªq
 = (
oÂ_mu…ù¨t_ªque°
 *)(*
buf
);

426 
°©s
 = (
oÂ_queue_°©s_ªque°
 *)
ªq
->
body
;

427 
°©s
->
p‹t_no
 = 
	`ht⁄l
(
msg
->port_no);

428 
°©s
->
queue_id
 = 
	`ht⁄l
(
msg
->queue_id);

431 
	}
}

434 
	$oÊ_msg_∑ck_mu…ù¨t_ªque°_group
(
oÊ_msg_mu…ù¨t_ªque°_group
 *
msg
 
UNUSED
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

435 
oÂ_mu…ù¨t_ªque°
 *
ªq
;

436 
oÂ_group_°©s_ªque°
 *
°©s
;

438 *
buf_Àn
 = (
oÂ_mu…ù¨t_ªque°
Ë+ (
oÂ_group_°©s_ªque°
);

439 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

441 
ªq
 = (
oÂ_mu…ù¨t_ªque°
 *)(*
buf
);

442 
°©s
 = (
oÂ_group_°©s_ªque°
 *)
ªq
->
body
;

443 
°©s
->
group_id
 = 
	`ht⁄l
(
msg
->group_id);

444 
	`mem£t
(
°©s
->
∑d
, 0x00, 4);

447 
	}
}

450 
	$oÊ_msg_∑ck_mu…ù¨t_ªque°_èbÀ_„©uªs
(
oÊ_msg_mu…ù¨t_ªque°_èbÀ_„©uªs
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
, 
oÊ_exp
 *
exp
) {

451 
oÂ_mu…ù¨t_ªque°
 *
ªq
;

452 
size_t
 
i
, 
„©uªs_Àn
;

453 
uöt8_t
 *
d©a
;

455 
„©uªs_Àn
 = 
	`oÊ_°ru˘s_èbÀ_„©uªs_oÂ_tŸÆ_Àn
(
msg
->
èbÀ_„©uªs
, msg->
èbÀs_num
, 
exp
);

456 *
buf_Àn
 = (
oÂ_mu…ù¨t_ªque°
Ë+ 
„©uªs_Àn
;

457 *
buf
 = (
uöt8_t
*Ë
	`mÆloc
(*
buf_Àn
);

459 
ªq
 = (
oÂ_mu…ù¨t_ªque°
*Ë(*
buf
);

461 i‡(
„©uªs_Àn
){

462 
d©a
 = (
uöt8_t
*Ë
ªq
->
body
;

463 
i
 = 0; i < 
msg
->
èbÀs_num
; i++ ){

464 
d©a
 +
	`oÊ_°ru˘s_èbÀ_„©uªs_∑ck
(
msg
->
èbÀ_„©uªs
[
i
], (
oÂ_èbÀ_„©uªs
*Ëd©a, d©a, 
exp
);

468 
	}
}

471 
	$oÊ_msg_∑ck_mëî_mu…ù¨t_ªque°
(
oÊ_msg_mu…ù¨t_mëî_ªque°
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
){

473 
oÂ_mu…ù¨t_ªque°
 *
ªq
;

474 
oÂ_mëî_mu…ù¨t_ªque°
 *
°©s
;

476 *
buf_Àn
 = (
oÂ_mu…ù¨t_ªque°
Ë+ (
oÂ_mëî_mu…ù¨t_ªque°
);

477 *
buf
 = (
uöt8_t
*Ë
	`mÆloc
(*
buf_Àn
);

479 
ªq
 = (
oÂ_mu…ù¨t_ªque°
*Ë(*
buf
);

480 
°©s
 = (
oÂ_mëî_mu…ù¨t_ªque°
*Ë
ªq
->
body
;

481 
°©s
->
mëî_id
 = 
	`ht⁄l
(
msg
->meter_id);

482 
	`mem£t
(
°©s
->
∑d
, 0x00, 4);

485 
	}
}

488 
	$oÊ_msg_∑ck_mu…ù¨t_ªque°_em±y
(
oÊ_msg_mu…ù¨t_ªque°_hódî
 *
msg
 
UNUSED
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

490 *
buf_Àn
 = (
oÂ_mu…ù¨t_ªque°
);

491 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

494 
	}
}

498 
	$oÊ_msg_∑ck_mu…ù¨t_ªque°
(
oÊ_msg_mu…ù¨t_ªque°_hódî
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
, 
oÊ_exp
 *
exp
) {

499 
oÂ_mu…ù¨t_ªque°
 *
ªq
;

500 
îr‹
 = 0;

502 
msg
->
ty≥
) {

503 
OFPMP_DESC
: {

504 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ªque°_em±y
(
msg
, 
buf
, 
buf_Àn
);

507 
OFPMP_FLOW
:

508 
OFPMP_AGGREGATE
: {

509 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ªque°_Êow
((
oÊ_msg_mu…ù¨t_ªque°_Êow
 *)
msg
, 
buf
, 
buf_Àn
, 
exp
);

512 
OFPMP_TABLE
: {

513 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ªque°_em±y
(
msg
, 
buf
, 
buf_Àn
);

516 
OFPMP_PORT_STATS
: {

517 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ªque°_p‹t
((
oÊ_msg_mu…ù¨t_ªque°_p‹t
 *)
msg
, 
buf
, 
buf_Àn
);

520 
OFPMP_QUEUE
: {

521 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ªque°_queue
((
oÊ_msg_mu…ù¨t_ªque°_queue
 *)
msg
, 
buf
, 
buf_Àn
);

524 
OFPMP_GROUP
: {

525 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ªque°_group
((
oÊ_msg_mu…ù¨t_ªque°_group
 *)
msg
, 
buf
, 
buf_Àn
);

528 
OFPMP_GROUP_DESC
: {

529 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ªque°_em±y
(
msg
, 
buf
, 
buf_Àn
);

532 
OFPMP_GROUP_FEATURES
: {

533 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ªque°_em±y
(
msg
, 
buf
, 
buf_Àn
);

536 
OFPMP_METER
:

537 
OFPMP_METER_CONFIG
:{

538 
îr‹
 = 
	`oÊ_msg_∑ck_mëî_mu…ù¨t_ªque°
((
oÊ_msg_mu…ù¨t_mëî_ªque°
*)
msg
, 
buf
, 
buf_Àn
);

541 
OFPMP_METER_FEATURES
:{

542 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ªque°_em±y
(
msg
, 
buf
, 
buf_Àn
);

545 
OFPMP_TABLE_FEATURES
:{

546 
	`oÊ_msg_∑ck_mu…ù¨t_ªque°_èbÀ_„©uªs
((
oÊ_msg_mu…ù¨t_ªque°_èbÀ_„©uªs
*)
msg
, 
buf
, 
buf_Àn
,
exp
);

549 
OFPMP_PORT_DESC
:{

550 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ªque°_em±y
(
msg
, 
buf
, 
buf_Àn
);

553 
OFPMP_EXPERIMENTER
: {

554 i‡(
exp
 =
NULL
 ||Éxp->
°©s
 =NULL ||Éxp->°©s->
ªq_∑ck
 == NULL) {

555 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÖackÉxperimenter statÑeq, butÇo callback was given.");

556 
îr‹
 = -1;

558 
îr‹
 = 
exp
->
°©s
->
	`ªq_∑ck
(
msg
, 
buf
, 
buf_Àn
);

563 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÖack unknownÉxperimenter statÑeqÅype.");

564 
îr‹
 = -1;

568 i‡(
îr‹
) {

569  
îr‹
;

572 
ªq
 = (
oÂ_mu…ù¨t_ªque°
 *)(*
buf
);

574 
ªq
->
ty≥
 = 
	`ht⁄s
(
msg
->type);

575 
ªq
->
Êags
 = 
	`ht⁄s
(
msg
->flags);

576 
	`mem£t
(
ªq
->
∑d
, 0x00, 4);

579 
	}
}

583 
	$oÊ_msg_∑ck_mu…ù¨t_ª∂y_desc
(
oÊ_msg_ª∂y_desc
 *
msg
 
UNUSED
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

584 
oÂ_mu…ù¨t_ª∂y
 *
ªq
;

585 
oÂ_desc
 *
°©s
;

587 *
buf_Àn
 = (
oÂ_mu…ù¨t_ª∂y
Ë+ (
oÂ_desc
);

588 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

590 
ªq
 = (
oÂ_mu…ù¨t_ª∂y
 *)(*
buf
);

591 
°©s
 = (
oÂ_desc
 *)
ªq
->
body
;

592 
	`mem£t
(
°©s
->
m‰_desc
, 0, 
DESC_STR_LEN
);

593 
	`mem£t
(
°©s
->
hw_desc
, 0, 
DESC_STR_LEN
);

594 
	`mem£t
(
°©s
->
sw_desc
, 0, 
DESC_STR_LEN
);

595 
	`mem£t
(
°©s
->
£rül_num
, 0, 
SERIAL_NUM_LEN
);

596 
	`mem£t
(
°©s
->
dp_desc
, 0, 
DESC_STR_LEN
);

597 
	`mem˝y
(
°©s
->
m‰_desc
, 
msg
->m‰_desc, 
DESC_STR_LEN
);

598 
	`mem˝y
(
°©s
->
hw_desc
, 
msg
->hw_desc, 
DESC_STR_LEN
);

599 
	`mem˝y
(
°©s
->
sw_desc
, 
msg
->sw_desc, 
DESC_STR_LEN
);

600 
	`mem˝y
(
°©s
->
£rül_num
, 
msg
->£rül_num, 
SERIAL_NUM_LEN
);

601 
	`mem˝y
(
°©s
->
dp_desc
, 
msg
->dp_desc, 
DESC_STR_LEN
);

604 
	}
}

607 
	$oÊ_msg_∑ck_mu…ù¨t_ª∂y_Êow
(
oÊ_msg_mu…ù¨t_ª∂y_Êow
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
, 
oÊ_exp
 *
exp
) {

608 
oÂ_mu…ù¨t_ª∂y
 *
ª•
;

609 
size_t
 
i
;

610 
uöt8_t
 * 
d©a
;

612 *
buf_Àn
 = (
oÂ_mu…ù¨t_ª∂y
Ë+ 
	`oÊ_°ru˘s_Êow_°©s_oÂ_tŸÆ_Àn
(
msg
->
°©s
, msg->
°©s_num
, 
exp
);

613 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

614 
ª•
 = (
oÂ_mu…ù¨t_ª∂y
 *)(*
buf
);

615 
d©a
 = (
uöt8_t
*Ë
ª•
->
body
;

616 
i
=0; i<
msg
->
°©s_num
; i++) {

617 
d©a
 +
	`oÊ_°ru˘s_Êow_°©s_∑ck
(
msg
->
°©s
[
i
], d©a, 
exp
);

620 
	}
}

623 
	$oÊ_msg_∑ck_mu…ù¨t_ª∂y_aggªg©e
(
oÊ_msg_mu…ù¨t_ª∂y_aggªg©e
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

624 
oÂ_mu…ù¨t_ª∂y
 *
ª•
;

625 
oÂ_aggªg©e_°©s_ª∂y
 *
°©s
;

627 *
buf_Àn
 = (
oÂ_mu…ù¨t_ª∂y
Ë+ (
oÂ_aggªg©e_°©s_ª∂y
);

628 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

630 
ª•
 = (
oÂ_mu…ù¨t_ª∂y
 *)(*
buf
);

631 
°©s
 = (
oÂ_aggªg©e_°©s_ª∂y
 *)
ª•
->
body
;

632 
°©s
->
∑ckë_cou¡
 = 
	`ht⁄64
(
msg
->packet_count);

633 
°©s
->
byã_cou¡
 = 
	`ht⁄64
(
msg
->byte_count);

634 
°©s
->
Êow_cou¡
 = 
	`ht⁄l
–
msg
->flow_count);

635 
	`mem£t
(
°©s
->
∑d
, 0x00, 4);

638 
	}
}

641 
	$oÊ_msg_∑ck_mu…ù¨t_ª∂y_èbÀ
(
oÊ_msg_mu…ù¨t_ª∂y_èbÀ
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

642 
oÂ_mu…ù¨t_ª∂y
 *
ª•
;

643 
size_t
 
i
;

644 
uöt8_t
 *
d©a
;

646 *
buf_Àn
 = (
oÂ_mu…ù¨t_ª∂y
Ë+ 
msg
->
°©s_num
 * (
oÂ_èbÀ_°©s
);

647 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

649 
ª•
 = (
oÂ_mu…ù¨t_ª∂y
 *)(*
buf
);

650 
d©a
 = (
uöt8_t
 *)
ª•
->
body
;

652 
i
=0; i<
msg
->
°©s_num
; i++) {

653 
d©a
 +
	`oÊ_°ru˘s_èbÀ_°©s_∑ck
(
msg
->
°©s
[
i
], (
oÂ_èbÀ_°©s
 *)data);

656 
	}
}

659 
	$oÊ_msg_∑ck_mu…ù¨t_ª∂y_p‹t
(
oÊ_msg_mu…ù¨t_ª∂y_p‹t
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

660 
oÂ_mu…ù¨t_ª∂y
 *
ª•
;

661 
size_t
 
i
;

662 
uöt8_t
 *
d©a
;

664 *
buf_Àn
 = (
oÂ_mu…ù¨t_ª∂y
Ë+ 
msg
->
°©s_num
 * (
oÂ_p‹t_°©s
);

665 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

667 
ª•
 = (
oÂ_mu…ù¨t_ª∂y
 *)(*
buf
);

668 
d©a
 = (
uöt8_t
 *)
ª•
->
body
;

670 
i
=0; i<
msg
->
°©s_num
; i++) {

671 
d©a
 +
	`oÊ_°ru˘s_p‹t_°©s_∑ck
(
msg
->
°©s
[
i
], (
oÂ_p‹t_°©s
 *)data);

674 
	}
}

678 
	$oÊ_msg_∑ck_mu…ù¨t_ª∂y_queue
(
oÊ_msg_mu…ù¨t_ª∂y_queue
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

679 
oÂ_mu…ù¨t_ª∂y
 *
ª•
;

680 
size_t
 
i
;

681 
uöt8_t
 *
d©a
;

683 *
buf_Àn
 = (
oÂ_mu…ù¨t_ª∂y
Ë+ 
msg
->
°©s_num
 * (
oÂ_queue_°©s
);

684 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

686 
ª•
 = (
oÂ_mu…ù¨t_ª∂y
 *)(*
buf
);

687 
d©a
 = (
uöt8_t
 *)
ª•
->
body
;

689 
i
=0; i<
msg
->
°©s_num
; i++) {

690 
d©a
 +
	`oÊ_°ru˘s_queue_°©s_∑ck
(
msg
->
°©s
[
i
], (
oÂ_queue_°©s
 *)data);

693 
	}
}

696 
	$oÊ_msg_∑ck_mu…ù¨t_ª∂y_group
(
oÊ_msg_mu…ù¨t_ª∂y_group
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

697 
oÂ_mu…ù¨t_ª∂y
 *
ª•
;

698 
size_t
 
i
;

699 
uöt8_t
 *
d©a
;

701 *
buf_Àn
 = (
oÂ_mu…ù¨t_ª∂y
Ë+ 
	`oÊ_°ru˘s_group_°©s_oÂ_tŸÆ_Àn
(
msg
->
°©s
, msg->
°©s_num
);

702 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

704 
ª•
 = (
oÂ_mu…ù¨t_ª∂y
 *)(*
buf
);

705 
d©a
 = (
uöt8_t
 *)
ª•
->
body
;

707 
i
=0; i<
msg
->
°©s_num
; i++) {

708 
d©a
 +
	`oÊ_°ru˘s_group_°©s_∑ck
(
msg
->
°©s
[
i
], (
oÂ_group_°©s
 *)data);

711 
	}
}

714 
	$oÊ_msg_∑ck_mu…ù¨t_ª∂y_group_desc
(
oÊ_msg_mu…ù¨t_ª∂y_group_desc
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
, 
oÊ_exp
 *
exp
) {

715 
oÂ_mu…ù¨t_ª∂y
 *
ª•
;

716 
uöt8_t
 *
d©a
;

717 
size_t
 
i
;

719 *
buf_Àn
 = (
oÂ_mu…ù¨t_ª∂y
Ë+ 
	`oÊ_°ru˘s_group_desc_°©s_oÂ_tŸÆ_Àn
(
msg
->
°©s
, msg->
°©s_num
, 
exp
);

720 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

722 
ª•
 = (
oÂ_mu…ù¨t_ª∂y
 *)(*
buf
);

723 
d©a
 = (
uöt8_t
 *)
ª•
->
body
;

725 
i
=0; i<
msg
->
°©s_num
; i++) {

726 
d©a
 +
	`oÊ_°ru˘s_group_desc_°©s_∑ck
(
msg
->
°©s
[
i
], (
oÂ_group_desc_°©s
 *)d©a, 
exp
);

730 
	}
}

733 
	$oÊ_msg_∑ck_mu…ù¨t_ª∂y_group_„©uªs
(
oÊ_msg_mu…ù¨t_ª∂y_group_„©uªs
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

734 
oÂ_mu…ù¨t_ª∂y
 *
ª•
;

735 
oÂ_group_„©uªs_°©s
 *
°©s
;

736 
i
;

737 *
buf_Àn
 = (
oÂ_mu…ù¨t_ª∂y
Ë+ (
oÂ_group_„©uªs_°©s
);

738 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

740 
ª•
 = (
oÂ_mu…ù¨t_ª∂y
 *)(*
buf
);

741 
°©s
 = (
oÂ_group_„©uªs_°©s
 *)
ª•
->
body
;

742 
°©s
->
ty≥s
 = 
	`ht⁄l
(
msg
->types);

743 
°©s
->
ˇ∑bûôõs
 = 
	`ht⁄l
(
msg
->capabilities);

744 
i
 = 0; i < 4; i++){

745 
°©s
->
max_groups
[
i
] = 
	`ht⁄l
(
msg
->max_groups[i]);

746 
°©s
->
a˘i⁄s
[
i
] = 
	`ht⁄l
(
msg
->actions[i]);

750 
	}
}

753 
	$oÊ_msg_∑ck_mu…ù¨t_ª∂y_èbÀ_„©uªs
(
oÊ_msg_mu…ù¨t_ª∂y_èbÀ_„©uªs
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
, 
oÊ_exp
 *
exp
) {

754 
oÂ_mu…ù¨t_ª∂y
 *
ª•
;

755 
size_t
 
i
, 
„©uªs_Àn
;

756 
uöt8_t
 *
d©a
;

758 
„©uªs_Àn
 = 
	`oÊ_°ru˘s_èbÀ_„©uªs_oÂ_tŸÆ_Àn
(
msg
->
èbÀ_„©uªs
, msg->
èbÀs_num
, 
exp
);

759 *
buf_Àn
 = (
oÂ_mu…ù¨t_ª∂y
Ë+ 
„©uªs_Àn
;

760 *
buf
 = (
uöt8_t
*Ë
	`mÆloc
(*
buf_Àn
);

762 
ª•
 = (
oÂ_mu…ù¨t_ª∂y
*Ë(*
buf
);

763 i‡(
„©uªs_Àn
){

764 
d©a
 = (
uöt8_t
*Ë
ª•
->
body
;

765 
i
 = 0; i < 
msg
->
èbÀs_num
; i++ ){

766 
d©a
 +
	`oÊ_°ru˘s_èbÀ_„©uªs_∑ck
(
msg
->
èbÀ_„©uªs
[
i
], (
oÂ_èbÀ_„©uªs
*Ëd©a, d©a, 
exp
);

770 
	}
}

773 
	$oÊ_msg_∑ck_mu…ù¨t_ª∂y_mëî_°©s
(
oÊ_msg_mu…ù¨t_ª∂y_mëî
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

774 
oÂ_mu…ù¨t_ª∂y
 *
ª•
;

775 
size_t
 
i
;

776 
uöt8_t
 *
d©a
;

778 *
buf_Àn
 = (
oÂ_mu…ù¨t_ª∂y
Ë+ 
	`oÊ_°ru˘s_mëî_°©s_oÂ_tŸÆ_Àn
(
msg
->
°©s
, msg->
°©s_num
);

779 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

781 
ª•
 = (
oÂ_mu…ù¨t_ª∂y
 *)(*
buf
);

782 
d©a
 = (
uöt8_t
 *)
ª•
->
body
;

784 
i
=0; i<
msg
->
°©s_num
; i++) {

785 
d©a
 +
	`oÊ_°ru˘s_mëî_°©s_∑ck
(
msg
->
°©s
[
i
], (
oÂ_mëî_°©s
 *)data);

788 
	}
}

791 
	$oÊ_msg_∑ck_mu…ù¨t_ª∂y_mëî_c⁄f
(
oÊ_msg_mu…ù¨t_ª∂y_mëî_c⁄f
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

792 
oÂ_mu…ù¨t_ª∂y
 *
ª•
;

793 
size_t
 
i
;

794 
uöt8_t
 *
d©a
;

796 *
buf_Àn
 = (
oÂ_mu…ù¨t_ª∂y
Ë+ 
	`oÊ_°ru˘s_mëî_c⁄f_oÂ_tŸÆ_Àn
(
msg
->
°©s
, msg->
°©s_num
);

797 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

799 
ª•
 = (
oÂ_mu…ù¨t_ª∂y
 *)(*
buf
);

800 
d©a
 = (
uöt8_t
 *)
ª•
->
body
;

802 
i
=0; i<
msg
->
°©s_num
; i++) {

803 
d©a
 +
	`oÊ_°ru˘s_mëî_c⁄f_∑ck
(
msg
->
°©s
[
i
], (
oÂ_mëî_c⁄fig
 *)data, data);

807 
	}
}

811 
	$oÊ_msg_∑ck_mu…ù¨t_ª∂y_p‹t_°©us_desc
(
oÊ_msg_mu…ù¨t_ª∂y_p‹t_desc
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

812 
oÂ_mu…ù¨t_ª∂y
 * 
ª•
;

813 
uöt8_t
 *
d©a
;

814 
size_t
 
i
;

815 *
buf_Àn
 = (
oÂ_mu…ù¨t_ª∂y
Ë+ 
msg
->
°©s_num
 * (
oÂ_p‹t
);

816 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

818 
ª•
 = (
oÂ_mu…ù¨t_ª∂y
 *)(*
buf
);

819 
d©a
 = (
uöt8_t
 *)
ª•
->
body
;

821 
i
 = 0; i < 
msg
->
°©s_num
; i++){

822 
d©a
 +
	`oÊ_°ru˘s_p‹t_∑ck
(
msg
->
°©s
[
i
], (
oÂ_p‹t
 *)data);

826 
	}
}

829 
	$oÊ_msg_∑ck_mu…ù¨t_ª∂y_mëî_„©uªs
(
oÊ_msg_mu…ù¨t_ª∂y_mëî_„©uªs
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

830 
oÂ_mu…ù¨t_ª∂y
 *
ª•
;

831 
oÂ_mëî_„©uªs
 *
„©
;

833 *
buf_Àn
 = (
oÂ_mu…ù¨t_ª∂y
Ë+ (
oÂ_mëî_„©uªs
);

834 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

835 
ª•
 = (
oÂ_mu…ù¨t_ª∂y
 *)(*
buf
);

836 
„©
 = (
oÂ_mëî_„©uªs
 *)
ª•
->
body
;

837 
„©
->
max_mëî
 = 
	`ht⁄l
(
msg
->
„©uªs
->max_meter);

838 
„©
->
b™d_ty≥s
 = 
	`ht⁄l
(
msg
->
„©uªs
->band_types);

839 
„©
->
ˇ∑bûôõs
 = 
	`ht⁄l
(
msg
->
„©uªs
->capabilities);

840 
„©
->
max_b™ds
 = 
msg
->
„©uªs
->max_bands;

841 
„©
->
max_cﬁ‹
 = 
msg
->
„©uªs
->max_color;

842 
	`mem£t
(
„©
->
∑d
, 0x0, 2);

844 
	}
}

848 
	$oÊ_msg_∑ck_mu…ù¨t_ª∂y
(
oÊ_msg_mu…ù¨t_ª∂y_hódî
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
, 
oÊ_exp
 *
exp
) {

849 
oÂ_mu…ù¨t_ª∂y
 *
ª•
;

850 
îr‹
;

852 
msg
->
ty≥
) {

853 
OFPMP_DESC
: {

854 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ª∂y_desc
((
oÊ_msg_ª∂y_desc
 *)
msg
, 
buf
, 
buf_Àn
);

857 
OFPMP_FLOW
: {

858 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ª∂y_Êow
((
oÊ_msg_mu…ù¨t_ª∂y_Êow
 *)
msg
, 
buf
, 
buf_Àn
, 
exp
);

861 
OFPMP_AGGREGATE
: {

862 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ª∂y_aggªg©e
((
oÊ_msg_mu…ù¨t_ª∂y_aggªg©e
 *)
msg
, 
buf
, 
buf_Àn
);

865 
OFPMP_TABLE
: {

866 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ª∂y_èbÀ
((
oÊ_msg_mu…ù¨t_ª∂y_èbÀ
 *)
msg
, 
buf
, 
buf_Àn
);

869 
OFPMP_TABLE_FEATURES
: {

870 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ª∂y_èbÀ_„©uªs
((
oÊ_msg_mu…ù¨t_ª∂y_èbÀ_„©uªs
*)
msg
, 
buf
, 
buf_Àn
, 
exp
);

873 
OFPMP_PORT_STATS
: {

874 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ª∂y_p‹t
((
oÊ_msg_mu…ù¨t_ª∂y_p‹t
 *)
msg
, 
buf
, 
buf_Àn
);

877 
OFPMP_QUEUE
: {

878 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ª∂y_queue
((
oÊ_msg_mu…ù¨t_ª∂y_queue
 *)
msg
, 
buf
, 
buf_Àn
);

881 
OFPMP_GROUP
: {

882 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ª∂y_group
((
oÊ_msg_mu…ù¨t_ª∂y_group
 *)
msg
, 
buf
, 
buf_Àn
);

885 
OFPMP_GROUP_DESC
: {

886 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ª∂y_group_desc
((
oÊ_msg_mu…ù¨t_ª∂y_group_desc
 *)
msg
, 
buf
, 
buf_Àn
, 
exp
);

889 
OFPMP_GROUP_FEATURES
:{

890 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ª∂y_group_„©uªs
((
oÊ_msg_mu…ù¨t_ª∂y_group_„©uªs
 *Ë
msg
, 
buf
, 
buf_Àn
);

893 
OFPMP_METER
:{

894 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ª∂y_mëî_°©s
((
oÊ_msg_mu…ù¨t_ª∂y_mëî
*)
msg
, 
buf
, 
buf_Àn
);

897 
OFPMP_METER_CONFIG
:{

898 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ª∂y_mëî_c⁄f
((
oÊ_msg_mu…ù¨t_ª∂y_mëî_c⁄f
*)
msg
, 
buf
, 
buf_Àn
);

901 
OFPMP_METER_FEATURES
:{

902 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ª∂y_mëî_„©uªs
((
oÊ_msg_mu…ù¨t_ª∂y_mëî_„©uªs
*)
msg
, 
buf
, 
buf_Àn
);

905 
OFPMP_PORT_DESC
:{

906 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ª∂y_p‹t_°©us_desc
((
oÊ_msg_mu…ù¨t_ª∂y_p‹t_desc
*)
msg
, 
buf
, 
buf_Àn
);

909 
OFPMP_EXPERIMENTER
: {

910 i‡(
exp
 =
NULL
 ||Éxp->
°©s
 =NULL ||Éxp->°©s->
ª∂y_∑ck
 == NULL) {

911 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÖackÉxperimenter statÑesp, butÇo callback was given.");

912 
îr‹
 = -1;

914 
îr‹
 = 
exp
->
°©s
->
	`ª∂y_∑ck
(
msg
, 
buf
, 
buf_Àn
);

919 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÖack unknown statÑespÅype.");

920 
îr‹
 = -1;

924 i‡(
îr‹
) {

925  
îr‹
;

927 
ª•
 = (
oÂ_mu…ù¨t_ª∂y
 *)(*
buf
);

928 
ª•
->
ty≥
 = 
	`ht⁄s
(
msg
->type);

929 
ª•
->
Êags
 = 
	`ht⁄s
(
msg
->flags);

930 
	`mem£t
(
ª•
->
∑d
, 0x00, 4);

933 
	}
}

936 
	$oÊ_msg_∑ck_queue_gë_c⁄fig_ªque°
(
oÊ_msg_queue_gë_c⁄fig_ªque°
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

937 
oÂ_queue_gë_c⁄fig_ªque°
 *
ªq
;

939 *
buf_Àn
 = (
oÂ_queue_gë_c⁄fig_ªque°
);

940 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

942 
ªq
 = (
oÂ_queue_gë_c⁄fig_ªque°
 *)(*
buf
);

943 
ªq
->
p‹t
 = 
	`ht⁄l
(
msg
->port);

944 
	`mem£t
(
ªq
->
∑d
, 0x00, 4);

947 
	}
}

950 
	$oÊ_msg_∑ck_queue_gë_c⁄fig_ª∂y
(
oÊ_msg_queue_gë_c⁄fig_ª∂y
 *
msg
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

951 
oÂ_queue_gë_c⁄fig_ª∂y
 *
ª•
;

952 
uöt8_t
 *
d©a
;

953 
size_t
 
i
;

955 *
buf_Àn
 = (
oÂ_queue_gë_c⁄fig_ª∂y
Ë+ 
	`oÊ_°ru˘s_∑ckë_queue_oÂ_tŸÆ_Àn
(
msg
->
queues
, msg->
queues_num
);

956 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

958 
ª•
 = (
oÂ_queue_gë_c⁄fig_ª∂y
 *)(*
buf
);

959 
ª•
->
p‹t
 = 
	`ht⁄l
(
msg
->port);

960 
	`mem£t
(
ª•
->
∑d
, 0x00, 4);

962 
d©a
 = (
uöt8_t
 *)
ª•
->
queues
;

964 
i
=0; i<
msg
->
queues_num
; i++) {

965 
d©a
 +
	`oÊ_°ru˘s_∑ckë_queue_∑ck
(
msg
->
queues
[
i
], (
oÂ_∑ckë_queue
 *)data);

969 
	}
}

972 
	$oÊ_msg_∑ck_em±y
(
oÊ_msg_hódî
 *
msg
 
UNUSED
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
) {

974 *
buf_Àn
 = (
oÂ_hódî
);

975 *
buf
 = (
uöt8_t
 *)
	`mÆloc
(*
buf_Àn
);

977 
	}
}

981 
	$oÊ_msg_∑ck
(
oÊ_msg_hódî
 *
msg
, 
uöt32_t
 
xid
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
, 
oÊ_exp
 *
exp
) {

982 
oÂ_hódî
 *
oh
;

983 
îr‹
 = 0;

984 
msg
->
ty≥
) {

986 
OFPT_HELLO
: {

987 
îr‹
 = 
	`oÊ_msg_∑ck_em±y
(
msg
, 
buf
, 
buf_Àn
);

990 
OFPT_ERROR
: {

991 
îr‹
 = 
	`oÊ_msg_∑ck_îr‹
((
oÊ_msg_îr‹
 *)
msg
, 
buf
, 
buf_Àn
);

994 
OFPT_ECHO_REQUEST
:

995 
OFPT_ECHO_REPLY
: {

996 
îr‹
 = 
	`oÊ_msg_∑ck_echo
((
oÊ_msg_echo
 *)
msg
, 
buf
, 
buf_Àn
);

999 
OFPT_EXPERIMENTER
: {

1000 i‡(
exp
 =
NULL
 ||Éxp->
msg
 =NULL ||Éxp->msg->
∑ck
 == NULL) {

1001 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÖackÉxperimenter msg, butÇo callback was given.");

1002 
îr‹
 = -1;

1004 
îr‹
 = 
exp
->
msg
->
	`∑ck
((
oÊ_msg_ex≥rimíãr
 *)msg, 
buf
, 
buf_Àn
);

1009 
OFPT_FEATURES_REQUEST
: {

1010 
îr‹
 = 
	`oÊ_msg_∑ck_em±y
(
msg
, 
buf
, 
buf_Àn
);

1013 
OFPT_FEATURES_REPLY
: {

1014 
îr‹
 = 
	`oÊ_msg_∑ck_„©uªs_ª∂y
((
oÊ_msg_„©uªs_ª∂y
 *)
msg
, 
buf
, 
buf_Àn
);

1017 
OFPT_GET_CONFIG_REQUEST
: {

1018 
îr‹
 = 
	`oÊ_msg_∑ck_em±y
(
msg
, 
buf
, 
buf_Àn
);

1021 
OFPT_GET_CONFIG_REPLY
: {

1022 
îr‹
 = 
	`oÊ_msg_∑ck_gë_c⁄fig_ª∂y
((
oÊ_msg_gë_c⁄fig_ª∂y
 *)
msg
, 
buf
, 
buf_Àn
);

1025 
OFPT_SET_CONFIG
: {

1026 
îr‹
 = 
	`oÊ_msg_∑ck_£t_c⁄fig
((
oÊ_msg_£t_c⁄fig
 *)
msg
, 
buf
, 
buf_Àn
);

1031 
OFPT_PACKET_IN
: {

1032 
îr‹
 = 
	`oÊ_msg_∑ck_∑ckë_ö
((
oÊ_msg_∑ckë_ö
 *)
msg
, 
buf
, 
buf_Àn
);

1035 
OFPT_FLOW_REMOVED
: {

1036 
îr‹
 = 
	`oÊ_msg_∑ck_Êow_ªmoved
((
oÊ_msg_Êow_ªmoved
 *)
msg
, 
buf
, 
buf_Àn
, 
exp
);

1039 
OFPT_PORT_STATUS
: {

1040 
îr‹
 = 
	`oÊ_msg_∑ck_p‹t_°©us
((
oÊ_msg_p‹t_°©us
 *)
msg
, 
buf
, 
buf_Àn
);

1044 
OFPT_GET_ASYNC_REQUEST
:{

1045 
îr‹
 = 
	`oÊ_msg_∑ck_em±y
(
msg
, 
buf
, 
buf_Àn
);

1048 
OFPT_GET_ASYNC_REPLY
:

1049 
OFPT_SET_ASYNC
:{

1050 
îr‹
 = 
	`oÊ_msg_∑ck_async_c⁄fig
((
oÊ_msg_async_c⁄fig
 *)
msg
, 
buf
, 
buf_Àn
);

1053 
OFPT_PACKET_OUT
: {

1054 
îr‹
 = 
	`oÊ_msg_∑ck_∑ckë_out
((
oÊ_msg_∑ckë_out
 *)
msg
, 
buf
, 
buf_Àn
, 
exp
);

1057 
OFPT_FLOW_MOD
: {

1058 
îr‹
 = 
	`oÊ_msg_∑ck_Êow_mod
((
oÊ_msg_Êow_mod
 *)
msg
, 
buf
, 
buf_Àn
, 
exp
);

1061 
OFPT_GROUP_MOD
: {

1062 
îr‹
 = 
	`oÊ_msg_∑ck_group_mod
((
oÊ_msg_group_mod
 *)
msg
, 
buf
, 
buf_Àn
, 
exp
);

1065 
OFPT_PORT_MOD
: {

1066 
îr‹
 = 
	`oÊ_msg_∑ck_p‹t_mod
((
oÊ_msg_p‹t_mod
 *)
msg
, 
buf
, 
buf_Àn
);

1069 
OFPT_TABLE_MOD
: {

1070 
îr‹
 = 
	`oÊ_msg_∑ck_èbÀ_mod
((
oÊ_msg_èbÀ_mod
 *)
msg
, 
buf
, 
buf_Àn
);

1073 
OFPT_METER_MOD
:{

1074 
îr‹
 = 
	`oÊ_msg_∑ck_mëî_mod
((
oÊ_msg_mëî_mod
 *)
msg
, 
buf
, 
buf_Àn
);

1079 
OFPT_MULTIPART_REQUEST
: {

1080 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ªque°
((
oÊ_msg_mu…ù¨t_ªque°_hódî
 *)
msg
, 
buf
, 
buf_Àn
, 
exp
);

1083 
OFPT_MULTIPART_REPLY
: {

1084 
îr‹
 = 
	`oÊ_msg_∑ck_mu…ù¨t_ª∂y
((
oÊ_msg_mu…ù¨t_ª∂y_hódî
 *)
msg
, 
buf
, 
buf_Àn
, 
exp
);

1089 
OFPT_BARRIER_REQUEST
: {

1090 
îr‹
 = 
	`oÊ_msg_∑ck_em±y
(
msg
, 
buf
, 
buf_Àn
);

1093 
OFPT_BARRIER_REPLY
: {

1094 
îr‹
 = 
	`oÊ_msg_∑ck_em±y
(
msg
, 
buf
, 
buf_Àn
);

1099 
OFPT_QUEUE_GET_CONFIG_REQUEST
: {

1100 
îr‹
 = 
	`oÊ_msg_∑ck_queue_gë_c⁄fig_ªque°
((
oÊ_msg_queue_gë_c⁄fig_ªque°
 *)
msg
, 
buf
, 
buf_Àn
);

1103 
OFPT_QUEUE_GET_CONFIG_REPLY
: {

1104 
îr‹
 = 
	`oÊ_msg_∑ck_queue_gë_c⁄fig_ª∂y
((
oÊ_msg_queue_gë_c⁄fig_ª∂y
 *)
msg
, 
buf
, 
buf_Àn
);

1107 
OFPT_ROLE_REQUEST
:

1108 
OFPT_ROLE_REPLY
:

1109 
îr‹
 = 
	`oÊ_msg_∑ck_rﬁe_ªque°
((
oÊ_msg_rﬁe_ªque°
*)
msg
, 
buf
, 
buf_Àn
);

1112 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÖack unknown messageÅype.");

1113 
îr‹
 = -1;

1117 i‡(
îr‹
) {

1118  
îr‹
;

1122 
oh
 = (
oÂ_hódî
 *)(*
buf
);

1123 
oh
->
vîsi⁄
 = 
OFP_VERSION
;

1124 
oh
->
ty≥
 = 
msg
->type;

1125 
oh
->
Àngth
 = 
	`ht⁄s
(*
buf_Àn
);

1126 
oh
->
xid
 = 
	`ht⁄l
(xid);

1129 
	}
}

	@oflib/ofl-messages-print.c

32 
	~<°dboﬁ.h
>

33 
	~<°dlib.h
>

34 
	~<°rög.h
>

35 
	~<°dio.h
>

36 
	~<˘y≥.h
>

37 
	~<öây≥s.h
>

39 
	~"oÊ.h
"

40 
	~"oÊ-a˘i⁄s.h
"

41 
	~"oÊ-mesßges.h
"

42 
	~"oÊ-°ru˘s.h
"

43 
	~"oÊ-¥öt.h
"

44 
	~"oÊ-log.h
"

45 
	~"../ö˛ude/›íÊow/›íÊow.h
"

49 
	#ETH_ADDR_FMT
 \

50 "%02"
PRIx8
":%02"PRIx8":%02"PRIx8":%02"PRIx8":%02"PRIx8":%02"
	)
PRIx8

51 
	#ETH_ADDR_ARGS
(
ó
) \

52 (
ó
)[0], (ó)[1], (ó)[2], (ó)[3], (ó)[4], (ó)[5]

	)

55 
	#LOG_MODULE
 
oÊ_msg_d


	)

56 
	$OFL_LOG_INIT
(
LOG_MODULE
)

61 
	$oÊ_msg_¥öt_îr‹
(
oÊ_msg_îr‹
 *
msg
, 
FILE
 *
°ªam
) {

62 
	`Ârötf
(
°ªam
, "{type=\"");

63 
	`oÊ_îr‹_ty≥_¥öt
(
°ªam
, 
msg
->
ty≥
);

64 
	`Ârötf
(
°ªam
, "\", code=\"");

65 
	`oÊ_îr‹_code_¥öt
(
°ªam
, 
msg
->
ty≥
, msg->
code
);

66 
	`Ârötf
(
°ªam
, "\", dÀn=\"%zu\"}", 
msg
->
d©a_Àngth
);

67 
	}
}

70 
	$oÊ_msg_¥öt_echo
(
oÊ_msg_echo
 *
msg
, 
FILE
 *
°ªam
) {

71 
	`Ârötf
(
°ªam
, "{dÀn=\"%zu\"}", 
msg
->
d©a_Àngth
);

72 
	}
}

75 
	$oÊ_msg_¥öt_ex≥rimíãr
(
oÊ_msg_ex≥rimíãr
 *
msg
, 
FILE
 *
°ªam
) {

76 
	`Ârötf
(
°ªam
, "{id=\"0x%"
PRIx32
"\"}", 
msg
->
ex≥rimíãr_id
);

77 
	}
}

80 
	$oÊ_msg_¥öt_„©uªs_ª∂y
(
oÊ_msg_„©uªs_ª∂y
 *
msg
, 
FILE
 *
°ªam
) {

82 
	`Ârötf
(
°ªam
, "{dpid=\"0x%016"
PRIx64
"\", buffs=\"%u\",Åabs=\"%u\", "

83 "aux_id=\"%u\", c≠s=\"0x%"
PRIx32
"\"",

84 
msg
->
d©≠©h_id
, msg->
n_buf„rs
, msg->
n_èbÀs
,

85 
msg
->
auxûüry_id
, msg->
ˇ∑bûôõs
);

87 
	`Ârötf
(
°ªam
, "]}");

88 
	}
}

91 
	$oÊ_msg_¥öt_gë_c⁄fig_ª∂y
(
oÊ_msg_gë_c⁄fig_ª∂y
 *
msg
, 
FILE
 *
°ªam
) {

92 
	`Ârötf
(
°ªam
, "{conf=");

93 
	`oÊ_°ru˘s_c⁄fig_¥öt
(
°ªam
, 
msg
->
c⁄fig
);

94 
	`Ârötf
(
°ªam
, "}");

95 
	}
}

99 
	$oÊ_msg_¥öt_£t_c⁄fig
(
oÊ_msg_£t_c⁄fig
 *
msg
, 
FILE
 *
°ªam
) {

100 
	`Ârötf
(
°ªam
, "{conf=");

101 
	`oÊ_°ru˘s_c⁄fig_¥öt
(
°ªam
, 
msg
->
c⁄fig
);

102 
	`Ârötf
(
°ªam
, "}");

103 
	}
}

106 
	$oÊ_msg_¥öt_∑ckë_ö
(
oÊ_msg_∑ckë_ö
 *
msg
, 
FILE
 *
°ªam
) {

107 
	`Ârötf
(
°ªam
, "{buffer=\"");

108 
	`oÊ_buf„r_¥öt
(
°ªam
, 
msg
->
buf„r_id
);

109 
	`Ârötf
(
°ªam
, "\",ÅÀn=\"%u\",Ñós=\"", 
msg
->
tŸÆ_Àn
);

110 
	`oÊ_∑ckë_ö_ªas⁄_¥öt
(
°ªam
, 
msg
->
ªas⁄
);

111 
	`Ârötf
(
°ªam
, "\",Åable=\"");

112 
	`oÊ_èbÀ_¥öt
(
°ªam
, 
msg
->
èbÀ_id
);

113 
	`Ârötf
(
°ªam
, "\", dÀn=\"%zu\"}", 
msg
->
d©a_Àngth
);

114 
	}
}

118 
	$oÊ_msg_¥öt_Êow_ªmoved
(
oÊ_msg_Êow_ªmoved
 *
msg
, 
FILE
 *
°ªam
, 
oÊ_exp
 *
exp
) {

119 
	`Ârötf
(
°ªam
, "{reas=\"");

120 
	`oÊ_Êow_ªmoved_ªas⁄_¥öt
(
°ªam
, 
msg
->
ªas⁄
);

121 
	`Ârötf
(
°ªam
, "\", stats=");

122 
	`oÊ_°ru˘s_Êow_°©s_¥öt
(
°ªam
, 
msg
->
°©s
, 
exp
);

123 
	`Ârötf
(
°ªam
, "}");

124 
	}
}

127 
	$oÊ_msg_¥öt_p‹t_°©us
(
oÊ_msg_p‹t_°©us
 *
msg
, 
FILE
 *
°ªam
) {

129 
	`Ârötf
(
°ªam
, "{reas=");

130 
	`oÊ_p‹t_°©us_ªas⁄_¥öt
(
°ªam
, 
msg
->
ªas⁄
);

131 
	`Ârötf
(
°ªam
, ", desc=");

132 
	`oÊ_°ru˘s_p‹t_¥öt
(
°ªam
, 
msg
->
desc
);

133 
	`Ârötf
(
°ªam
, "}");

134 
	}
}

137 
	$oÊ_msg_¥öt_∑ckë_out
(
oÊ_msg_∑ckë_out
 *
msg
, 
FILE
 *
°ªam
, 
oÊ_exp
 *
exp
) {

138 
size_t
 
i
;

139 
	`Ârötf
(
°ªam
, "{buffer=\"");

140 
	`oÊ_buf„r_¥öt
(
°ªam
, 
msg
->
buf„r_id
);

141 
	`Ârötf
(
°ªam
, "\",Öort=\"");

142 
	`oÊ_p‹t_¥öt
(
°ªam
, 
msg
->
ö_p‹t
);

143 
	`Ârötf
(
°ªam
, "\",áctions=[");

145 
i
=0; i<
msg
->
a˘i⁄s_num
; i++) {

146 
	`oÊ_a˘i⁄_¥öt
(
°ªam
, 
msg
->
a˘i⁄s
[
i
], 
exp
);

147 i‡(
i
 < 
msg
->
a˘i⁄s_num
 - 1Ë{ 
	`Ârötf
(
°ªam
, ", "); }

150 
	`Ârötf
(
°ªam
, "]}");

151 
	}
}

154 
	$oÊ_msg_¥öt_Êow_mod
(
oÊ_msg_Êow_mod
 *
msg
, 
FILE
 *
°ªam
, 
oÊ_exp
 *
exp
) {

155 
size_t
 
i
;

157 
	`Ârötf
(
°ªam
, "{table=\"");

158 
	`oÊ_èbÀ_¥öt
(
°ªam
, 
msg
->
èbÀ_id
);

159 
	`Ârötf
(
°ªam
, "\", cmd=\"");

160 
	`oÊ_Êow_mod_comm™d_¥öt
(
°ªam
, 
msg
->
comm™d
);

161 
	`Ârötf
(
°ªam
, "\", cookõ=\"0x%"
PRIx64
"\", mask=\"0x%"PRIx64"\", "

163 
msg
->
cookõ
, msg->
cookõ_mask
,

164 
msg
->
idÀ_timeout
, msg->
h¨d_timeout
, msg->
¥i‹ôy
);

165 
	`oÊ_buf„r_¥öt
(
°ªam
, 
msg
->
buf„r_id
);

166 
	`Ârötf
(
°ªam
, "\",Öort=\"");

167 
	`oÊ_p‹t_¥öt
(
°ªam
, 
msg
->
out_p‹t
);

168 
	`Ârötf
(
°ªam
, "\", group=\"");

169 
	`oÊ_group_¥öt
(
°ªam
, 
msg
->
out_group
);

170 
	`Ârötf
(
°ªam
, "\", fœgs=\"0x%"
PRIx16
"\", m©ch=",
msg
->
Êags
);

171 
	`oÊ_°ru˘s_m©ch_¥öt
(
°ªam
, 
msg
->
m©ch
, 
exp
);

172 
	`Ârötf
(
°ªam
, ", insts=[");

173 
i
=0; i<
msg
->
ö°ru˘i⁄s_num
; i++) {

174 
	`oÊ_°ru˘s_ö°ru˘i⁄_¥öt
(
°ªam
, 
msg
->
ö°ru˘i⁄s
[
i
], 
exp
);

175 i‡(
i
 < 
msg
->
ö°ru˘i⁄s_num
 - 1Ë{ 
	`Ârötf
(
°ªam
, ", "); }

177 
	`Ârötf
(
°ªam
, "]}");

178 
	}
}

181 
	$oÊ_msg_¥öt_group_mod
(
oÊ_msg_group_mod
 *
msg
, 
FILE
 *
°ªam
, 
oÊ_exp
 *
exp
) {

182 
size_t
 
i
;

184 
	`Ârötf
(
°ªam
,"{group=\"");

185 
	`oÊ_group_¥öt
(
°ªam
, 
msg
->
group_id
);

186 
	`Ârötf
(
°ªam
,"\", cmd=\"");

187 
	`oÊ_group_mod_comm™d_¥öt
(
°ªam
, 
msg
->
comm™d
);

188 
	`Ârötf
(
°ªam
, "\",Åype=\"");

189 
	`oÊ_group_ty≥_¥öt
(
°ªam
, 
msg
->
ty≥
);

190 
	`Ârötf
(
°ªam
,"\", buckets=[");

192 
i
=0; i<
msg
->
buckës_num
; i++) {

193 
	`oÊ_°ru˘s_buckë_¥öt
(
°ªam
, 
msg
->
buckës
[
i
], 
exp
);

195 i‡(
i
 < 
msg
->
buckës_num
 - 1Ë{ 
	`Ârötf
(
°ªam
, ", "); }

198 
	`Ârötf
(
°ªam
, "]}");

199 
	}
}

202 
	$oÊ_msg_¥öt_mëî_mod
(
oÊ_msg_mëî_mod
 *
msg
, 
FILE
 *
°ªam
) {

203 
size_t
 
i
;

205 
	`Ârötf
(
°ªam
,"{cmd=\"");

206 
	`oÊ_mëî_mod_comm™d_¥öt
(
°ªam
, 
msg
->
comm™d
);

207 
	`Ârötf
(
°ªam
, "\", fœgs=\"0x%"
PRIx16
"\"",
msg
->
Êags
);

208 
	`Ârötf
(
°ªam
, "\", mëî_id=\"%"
PRIx32
"\"",
msg
->
mëî_id
);

209 
	`Ârötf
(
°ªam
,"\", bands=[");

211 
i
=0; i<
msg
->
mëî_b™ds_num
; i++) {

212 
	`oÊ_°ru˘s_mëî_b™d_¥öt
(
°ªam
, 
msg
->
b™ds
[
i
]);

214 i‡(
i
 < 
msg
->
mëî_b™ds_num
 - 1Ë{ 
	`Ârötf
(
°ªam
, ", "); }

217 
	`Ârötf
(
°ªam
, "]}");

218 
	}
}

221 
	$oÊ_msg_¥öt_mëî_°©s_ªque°
(
oÊ_msg_mu…ù¨t_mëî_ªque°
 *
msg
, 
FILE
 *
°ªam
){

223 
	`Ârötf
(
°ªam
, "{mëî_id%x", 
msg
->
mëî_id
);

224 
	`Ârötf
(
°ªam
, "\"");

225 
	}
}

228 
	$oÊ_msg_¥öt_p‹t_mod
(
oÊ_msg_p‹t_mod
 *
msg
, 
FILE
 *
°ªam
) {

230 
	`Ârötf
(
°ªam
, "{port=\"");

231 
	`oÊ_p‹t_¥öt
(
°ªam
, 
msg
->
p‹t_no
);

232 
	`Ârötf
(
°ªam
, "\", hwaddr=\""
ETH_ADDR_FMT
"\", c⁄fig=\"0x%08"
PRIx32
"\", "

233 "mask=\"0x%"
PRIx32
"\",ádv=\"0x%"PRIx32"\"}",

234 
	`ETH_ADDR_ARGS
(
msg
->
hw_addr
), msg->
c⁄fig
, msg->
mask
, msg->
advîti£
);

235 
	}
}

238 
	$oÊ_msg_¥öt_èbÀ_mod
(
oÊ_msg_èbÀ_mod
 *
msg
, 
FILE
 *
°ªam
) {

239 
	`Ârötf
(
°ªam
, "{id=\"");

240 
	`oÊ_èbÀ_¥öt
(
°ªam
, 
msg
->
èbÀ_id
);

241 
	`Ârötf
(
°ªam
, "\", c⁄fig=\"0x%08"
PRIx32
"\"}", 
msg
->
c⁄fig
);

242 
	}
}

245 
	$oÊ_msg_¥öt_°©s_ªque°_Êow
(
oÊ_msg_mu…ù¨t_ªque°_Êow
 *
msg
, 
FILE
 *
°ªam
, 
oÊ_exp
 *
exp
) {

246 
	`Ârötf
(
°ªam
, ",Åable=\"");

247 
	`oÊ_èbÀ_¥öt
(
°ªam
, 
msg
->
èbÀ_id
);

248 
	`Ârötf
(
°ªam
, "\", oport=\"");

249 
	`oÊ_p‹t_¥öt
(
°ªam
, 
msg
->
out_p‹t
);

250 
	`Ârötf
(
°ªam
, "\", ogrp=\"");

251 
	`oÊ_group_¥öt
(
°ªam
, 
msg
->
out_group
);

252 
	`Ârötf
(
°ªam
, "\", cookõ=0x%"
PRIx64
"\", mask=0x%"PRIx64"\", match=",

253 
msg
->
cookõ
, msg->
cookõ_mask
);

254 
	`oÊ_°ru˘s_m©ch_¥öt
(
°ªam
, 
msg
->
m©ch
, 
exp
);

255 
	}
}

258 
	$oÊ_msg_¥öt_°©s_ªque°_p‹t
(
oÊ_msg_mu…ù¨t_ªque°_p‹t
 *
msg
, 
FILE
 *
°ªam
) {

259 
	`Ârötf
(
°ªam
, ",Öort=\"");

260 
	`oÊ_p‹t_¥öt
(
°ªam
, 
msg
->
p‹t_no
);

261 
	`Ârötf
(
°ªam
, "\"");

262 
	}
}

265 
	$oÊ_msg_¥öt_°©s_ªque°_queue
(
oÊ_msg_mu…ù¨t_ªque°_queue
 *
msg
, 
FILE
 *
°ªam
) {

266 
	`Ârötf
(
°ªam
, ",Öort=\"");

267 
	`oÊ_p‹t_¥öt
(
°ªam
, 
msg
->
p‹t_no
);

268 
	`Ârötf
(
°ªam
, "\", q=\"");

269 
	`oÊ_queue_¥öt
(
°ªam
, 
msg
->
queue_id
);

270 
	`Ârötf
(
°ªam
, "\"");

271 
	}
}

274 
	$oÊ_msg_¥öt_°©s_ªque°_group
(
oÊ_msg_mu…ù¨t_ªque°_group
 *
msg
, 
FILE
 *
°ªam
) {

275 
	`Ârötf
(
°ªam
, ", group=\"");

276 
	`oÊ_group_¥öt
(
°ªam
, 
msg
->
group_id
);

277 
	`Ârötf
(
°ªam
, "\"");

278 
	}
}

281 
	$oÊ_msg_¥öt_èbÀ_„©uªs_ªque°
(
oÊ_msg_mu…ù¨t_ªque°_èbÀ_„©uªs
* 
msg
, 
FILE
 *
°ªam
){

283 
size_t
 
i
;

284 i‡(
msg
->
èbÀ_„©uªs
 =
NULL
){

288 
	`Ârötf
(
°ªam
, ",Åable_features=\"");

289 
i
 = 0; i < 
msg
->
èbÀs_num
; i++)

290 
	`oÊ_°ru˘s_èbÀ_„©uªs_¥öt
(
°ªam
, 
msg
->
èbÀ_„©uªs
[
i
]);

291 
	`Ârötf
(
°ªam
, "\"");

293 
	}
}

296 
	$oÊ_msg_¥öt_°©s_ªque°_ex≥rimíãr
(
oÊ_msg_mu…ù¨t_ªque°_ex≥rimíãr
 *
msg
, 
FILE
 *
°ªam
) {

297 
	`Ârötf
(
°ªam
, ",Éxp_id=\"");

298 
	`oÊ_group_¥öt
(
°ªam
, 
msg
->
ex≥rimíãr_id
);

299 
	`Ârötf
(
°ªam
, "\"");

300 
	}
}

303 
	$oÊ_msg_¥öt_mu…ù¨t_ªque°
(
oÊ_msg_mu…ù¨t_ªque°_hódî
 *
msg
, 
FILE
 *
°ªam
, 
oÊ_exp
 *
exp
) {

304 i‡(
msg
->
ty≥
 =
OFPMP_EXPERIMENTER
) {

305 i‡(
exp
 !
NULL
 &&Éxp->
°©s
 !NULL &&Éxp->°©s->
ªq_to_°rög
 != NULL) {

306 *
c
 = 
exp
->
°©s
->
	`ªq_to_°rög
(
msg
);

307 
	`Âuts
(
c
, 
°ªam
);

308 
	`‰ì
(
c
);

311 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÖrint EXPERIMENTER statsÑequest, butÇo callback was given.");

315 
	`Ârötf
(
°ªam
, "{type=\"");

316 
	`oÊ_°©s_ty≥_¥öt
(
°ªam
, 
msg
->
ty≥
);

317 
	`Ârötf
(
°ªam
, "\", fœgs=\"0x%"
PRIx32
"\"", 
msg
->
Êags
);

319 
msg
->
ty≥
) {

320 
OFPMP_DESC
: {

323 
OFPMP_FLOW
:

324 
OFPMP_AGGREGATE
: {

325 
	`oÊ_msg_¥öt_°©s_ªque°_Êow
((
oÊ_msg_mu…ù¨t_ªque°_Êow
 *)
msg
, 
°ªam
, 
exp
);

328 
OFPMP_TABLE
: {

331 
OFPMP_TABLE_FEATURES
: {

332 
	`oÊ_msg_¥öt_èbÀ_„©uªs_ªque°
((
oÊ_msg_mu…ù¨t_ªque°_èbÀ_„©uªs
*)
msg
, 
°ªam
);

335 
OFPMP_PORT_STATS
: {

336 
	`oÊ_msg_¥öt_°©s_ªque°_p‹t
((
oÊ_msg_mu…ù¨t_ªque°_p‹t
 *)
msg
, 
°ªam
);

339 
OFPMP_QUEUE
: {

340 
	`oÊ_msg_¥öt_°©s_ªque°_queue
((
oÊ_msg_mu…ù¨t_ªque°_queue
 *)
msg
, 
°ªam
);

343 
OFPMP_GROUP
: {

344 
	`oÊ_msg_¥öt_°©s_ªque°_group
((
oÊ_msg_mu…ù¨t_ªque°_group
 *)
msg
, 
°ªam
);

347 
OFPMP_GROUP_DESC
: {

350 
OFPMP_GROUP_FEATURES
:{

353 
OFPMP_METER
:

354 
OFPMP_METER_CONFIG
:{

355 
	`oÊ_msg_¥öt_mëî_°©s_ªque°
((
oÊ_msg_mu…ù¨t_mëî_ªque°
*)
msg
, 
°ªam
);

358 
OFPMP_METER_FEATURES
:{

361 
OFPMP_PORT_DESC
:{

364 
OFPMP_EXPERIMENTER
: {

365 
	`oÊ_msg_¥öt_°©s_ªque°_ex≥rimíãr
((
oÊ_msg_mu…ù¨t_ªque°_ex≥rimíãr
 *)
msg
, 
°ªam
);

368 
	`Ârötf
(
°ªam
, "}");

369 
	}
}

372 
	$oÊ_msg_¥öt_°©s_ª∂y_desc
(
oÊ_msg_ª∂y_desc
 *
msg
, 
FILE
 *
°ªam
) {

373 
	`Ârötf
(
°ªam
, ", mfr=\"%s\", hw=\"%s\", sw=\"%s\", sn=\"%s\", dp=\"%s\"",

374 
msg
->
m‰_desc
, msg->
hw_desc
, msg->
sw_desc
, msg->
£rül_num
, msg->
dp_desc
);

375 
	}
}

378 
	$oÊ_msg_¥öt_°©s_ª∂y_Êow
(
oÊ_msg_mu…ù¨t_ª∂y_Êow
 *
msg
, 
FILE
 *
°ªam
, 
oÊ_exp
 *
exp
) {

379 
size_t
 
i
;

381 
	`Ârötf
(
°ªam
, ", stats=[");

383 
i
=0; i<
msg
->
°©s_num
; i++) {

384 
	`oÊ_°ru˘s_Êow_°©s_¥öt
(
°ªam
, 
msg
->
°©s
[
i
], 
exp
);

385 i‡(
i
 < 
msg
->
°©s_num
 - 1Ë{ 
	`Ârötf
(
°ªam
, ", "); };

388 
	`Ârötf
(
°ªam
, "]");

389 
	}
}

392 
	$oÊ_msg_¥öt_°©s_ª∂y_aggªg©e
(
oÊ_msg_mu…ù¨t_ª∂y_aggªg©e
 *
msg
, 
FILE
 *
°ªam
) {

393 
	`Ârötf
(
°ªam
, ",Ökt_˙t=\"%"
PRIu64
"\", byte_cnt=\"%"PRIu64"\", flow_cnt=\"%u\"",

394 
msg
->
∑ckë_cou¡
, msg->
byã_cou¡
, msg->
Êow_cou¡
);

395 
	}
}

398 
	$oÊ_msg_¥öt_°©s_ª∂y_èbÀ
(
oÊ_msg_mu…ù¨t_ª∂y_èbÀ
 *
msg
, 
FILE
 *
°ªam
) {

399 
size_t
 
i
;

401 
	`Ârötf
(
°ªam
, ", stats=[");

403 
i
=0; i<
msg
->
°©s_num
; i++) {

404 
	`oÊ_°ru˘s_èbÀ_°©s_¥öt
(
°ªam
, 
msg
->
°©s
[
i
]);

405 i‡(
i
 < 
msg
->
°©s_num
 - 1Ë{ 
	`Ârötf
(
°ªam
, ", "); };

408 
	`Ârötf
(
°ªam
, "]");

409 
	}
}

412 
	$oÊ_msg_¥öt_°©s_ª∂y_p‹t
(
oÊ_msg_mu…ù¨t_ª∂y_p‹t
 *
msg
, 
FILE
 *
°ªam
) {

413 
size_t
 
i
;

415 
	`Ârötf
(
°ªam
, ", stats=[");

417 
i
=0; i<
msg
->
°©s_num
; i++) {

418 
	`oÊ_°ru˘s_p‹t_°©s_¥öt
(
°ªam
, 
msg
->
°©s
[
i
]);

419 i‡(
i
 < 
msg
->
°©s_num
 - 1Ë{ 
	`Ârötf
(
°ªam
, ", "); };

422 
	`Ârötf
(
°ªam
, "]");

423 
	}
}

426 
	$oÊ_msg_¥öt_°©s_ª∂y_queue
(
oÊ_msg_mu…ù¨t_ª∂y_queue
 *
msg
, 
FILE
 *
°ªam
) {

427 
size_t
 
i
;

429 
	`Ârötf
(
°ªam
, ", stats=[");

431 
i
=0; i<
msg
->
°©s_num
; i++) {

432 
	`oÊ_°ru˘s_queue_°©s_¥öt
(
°ªam
, 
msg
->
°©s
[
i
]);

433 i‡(
i
 < 
msg
->
°©s_num
 - 1Ë{ 
	`Ârötf
(
°ªam
, ", "); };

436 
	`Ârötf
(
°ªam
, "]");

437 
	}
}

440 
	$oÊ_msg_¥öt_°©s_ª∂y_group
(
oÊ_msg_mu…ù¨t_ª∂y_group
 *
msg
, 
FILE
 *
°ªam
) {

441 
size_t
 
i
;

443 
	`Ârötf
(
°ªam
, ", stats=[");

445 
i
=0; i<
msg
->
°©s_num
; i++) {

446 
	`oÊ_°ru˘s_group_°©s_¥öt
(
°ªam
, 
msg
->
°©s
[
i
]);

447 i‡(
i
 < 
msg
->
°©s_num
 - 1Ë{ 
	`Ârötf
(
°ªam
, ", "); };

450 
	`Ârötf
(
°ªam
, "]");

451 
	}
}

454 
	$oÊ_msg_¥öt_°©s_ª∂y_mëî
(
oÊ_msg_mu…ù¨t_ª∂y_mëî
 *
msg
, 
FILE
 *
°ªam
) {

455 
size_t
 
i
;

457 
	`Ârötf
(
°ªam
, ", stats=[");

459 
i
=0; i<
msg
->
°©s_num
; i++) {

460 
	`oÊ_°ru˘s_mëî_°©s_¥öt
(
°ªam
, 
msg
->
°©s
[
i
]);

461 i‡(
i
 < 
msg
->
°©s_num
 - 1Ë{ 
	`Ârötf
(
°ªam
, ", "); };

464 
	`Ârötf
(
°ªam
, "]");

465 
	}
}

468 
	$oÊ_msg_¥öt_°©s_ª∂y_mëî_c⁄f
(
oÊ_msg_mu…ù¨t_ª∂y_mëî_c⁄f
 *
msg
, 
FILE
 *
°ªam
) {

469 
size_t
 
i
;

471 
	`Ârötf
(
°ªam
, ", stats=[");

473 
i
=0; i<
msg
->
°©s_num
; i++) {

474 
	`oÊ_°ru˘s_mëî_c⁄fig_¥öt
(
°ªam
, 
msg
->
°©s
[
i
]);

475 i‡(
i
 < 
msg
->
°©s_num
 - 1Ë{ 
	`Ârötf
(
°ªam
, ", "); };

478 
	`Ârötf
(
°ªam
, "]");

479 
	}
}

482 
	$oÊ_msg_¥öt_ª∂y_mëî_„©uªs
(
oÊ_msg_mu…ù¨t_ª∂y_mëî_„©uªs
 *
msg
, 
FILE
 *
°ªam
) {

484 
	`oÊ_°ru˘s_mëî_„©uªs_¥öt
(
°ªam
, 
msg
->
„©uªs
);

486 
	}
}

488 
	$oÊ_msg_¥öt_°©s_ª∂y_group_desc
(
oÊ_msg_mu…ù¨t_ª∂y_group_desc
 *
msg
, 
FILE
 *
°ªam
, 
oÊ_exp
 *
exp
) {

489 
size_t
 
i
;

491 
	`Ârötf
(
°ªam
, ", stats=[");

493 
i
=0; i<
msg
->
°©s_num
; i++) {

494 
	`oÊ_°ru˘s_group_desc_°©s_¥öt
(
°ªam
, 
msg
->
°©s
[
i
], 
exp
);

495 i‡(
i
 < 
msg
->
°©s_num
 - 1Ë{ 
	`Ârötf
(
°ªam
, ", "); };

498 
	`Ârötf
(
°ªam
, "]");

499 
	}
}

501 
	$oÊ_msg_¥öt_°©s_ª∂y_group_„©uªs
(
oÊ_msg_mu…ù¨t_ª∂y_group_„©uªs
 *
msg
, 
FILE
 *
°ªam
){

502 
size_t
 
i
;

503 
oÂ_a˘i⁄_ty≥
 
j
;

505 
	`Ârötf
(
°ªam
, ",Åypes=\"%d\", capabilities=\"%d [",

506 
msg
->
ty≥s
, msg->
ˇ∑bûôõs
);

508 
i
 = 0; i < 4; i++){

509 
	`oÊ_group_ty≥_¥öt
(
°ªam
, 
i
);

510 
	`Ârötf
(
°ªam
, ": max_groups=%d,á˘i⁄s", 
msg
->
max_groups
[
i
]);

511 if(
msg
->
a˘i⁄s
[
i
] & 1){

512 
	`oÊ_a˘i⁄_ty≥_¥öt
(
°ªam
, 
OFPAT_OUTPUT
);

513 
	`Ârötf
(
°ªam
, "/");

516 if(
msg
->
a˘i⁄s
[
i
] & 
OFPAT_COPY_TTL_OUT
){

517 
	`oÊ_a˘i⁄_ty≥_¥öt
(
°ªam
, 
OFPAT_COPY_TTL_OUT
);

518 
	`Ârötf
(
°ªam
, "/");

521 if(
msg
->
a˘i⁄s
[
i
] & 
OFPAT_COPY_TTL_IN
){

522 
	`oÊ_a˘i⁄_ty≥_¥öt
(
°ªam
, 
OFPAT_COPY_TTL_IN
);

523 
	`Ârötf
(
°ªam
, "/");

525 
j
 = 
OFPAT_SET_MPLS_TTL
; j < 
OFPAT_POP_PBB
; j++){

526 i‡(
msg
->
a˘i⁄s
[
i
] & 
j
){

527 
	`oÊ_a˘i⁄_ty≥_¥öt
(
°ªam
, 
j
);

528 
	`Ârötf
(
°ªam
, "/");

531 i‡(
i
 < 3)

532 
	`Ârötf
(
°ªam
, ", ");

534 
	}
}

537 
	$oÊ_msg_¥öt_°©s_ª∂y_ex≥rimíãr
(
oÊ_msg_mu…ù¨t_ª∂y_ex≥rimíãr
 *
msg
, 
FILE
 *
°ªam
) {

538 
	`Ârötf
(
°ªam
, ",Éxp_id=\"");

539 
	`oÊ_group_¥öt
(
°ªam
, 
msg
->
ex≥rimíãr_id
);

540 
	`Ârötf
(
°ªam
, "\"");

541 
	}
}

544 
	$oÊ_msg_¥öt_èbÀ_„©uªs_ª∂y
(
oÊ_msg_mu…ù¨t_ª∂y_èbÀ_„©uªs
* 
msg
, 
FILE
 *
°ªam
){

546 
size_t
 
i
;

547 i‡(
msg
->
èbÀ_„©uªs
 =
NULL
){

551 
	`Ârötf
(
°ªam
, ",Åable_features=\"");

552 
i
 = 0; i < 
msg
->
èbÀs_num
; i++)

553 
	`oÊ_°ru˘s_èbÀ_„©uªs_¥öt
(
°ªam
, 
msg
->
èbÀ_„©uªs
[
i
]);

554 
	`Ârötf
(
°ªam
, "\"");

556 
	}
}

559 
	$oÊ_msg_¥öt_p‹t_desc_ª∂y
(
oÊ_msg_mu…ù¨t_ª∂y_p‹t_desc
 *
msg
, 
FILE
 *
°ªam
) {

560 
size_t
 
i
;

562 
i
 = 0; i < 
msg
->
°©s_num
; i++){

563 
	`oÊ_°ru˘s_p‹t_¥öt
(
°ªam
, 
msg
->
°©s
[
i
]);

564 i‡(
i
 < 
msg
->
°©s_num
 - 1Ë{ 
	`Ârötf
(
°ªam
, ", "); };

566 
	`Ârötf
(
°ªam
, "}");

567 
	}
}

570 
	$oÊ_msg_¥öt_mu…ù¨t_ª∂y
(
oÊ_msg_mu…ù¨t_ª∂y_hódî
 *
msg
, 
FILE
 *
°ªam
, 
oÊ_exp
 *
exp
) {

571 i‡(
msg
->
ty≥
 =
OFPMP_EXPERIMENTER
) {

572 i‡(
exp
 !
NULL
 &&Éxp->
°©s
 !NULL &&Éxp->°©s->
ª∂y_to_°rög
 != NULL) {

573 *
c
 = 
exp
->
°©s
->
	`ª∂y_to_°rög
(
msg
);

574 
	`Âuts
(
c
, 
°ªam
);

575 
	`‰ì
(
c
);

578 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÖrint EXPERIMENTER statsÑeply, butÇo callback was given.");

582 
	`Ârötf
(
°ªam
, "{type=\"");

583 
	`oÊ_°©s_ty≥_¥öt
(
°ªam
, 
msg
->
ty≥
);

584 
	`Ârötf
(
°ªam
, "\", fœgs=\"0x%"
PRIx32
"\"", 
msg
->
Êags
);

586 
msg
->
ty≥
) {

587 (
OFPMP_DESC
): {

588 
	`oÊ_msg_¥öt_°©s_ª∂y_desc
((
oÊ_msg_ª∂y_desc
 *)
msg
, 
°ªam
);

591 (
OFPMP_FLOW
): {

592 
	`oÊ_msg_¥öt_°©s_ª∂y_Êow
((
oÊ_msg_mu…ù¨t_ª∂y_Êow
 *)
msg
, 
°ªam
, 
exp
);

595 
OFPMP_AGGREGATE
: {

596 
	`oÊ_msg_¥öt_°©s_ª∂y_aggªg©e
((
oÊ_msg_mu…ù¨t_ª∂y_aggªg©e
 *)
msg
, 
°ªam
);

599 (
OFPMP_TABLE
): {

600 
	`oÊ_msg_¥öt_°©s_ª∂y_èbÀ
((
oÊ_msg_mu…ù¨t_ª∂y_èbÀ
 *)
msg
, 
°ªam
);

603 (
OFPMP_TABLE_FEATURES
):{

604 
	`oÊ_msg_¥öt_èbÀ_„©uªs_ª∂y
((
oÊ_msg_mu…ù¨t_ª∂y_èbÀ_„©uªs
*)
msg
, 
°ªam
);

607 
OFPMP_PORT_STATS
: {

608 
	`oÊ_msg_¥öt_°©s_ª∂y_p‹t
((
oÊ_msg_mu…ù¨t_ª∂y_p‹t
 *)
msg
, 
°ªam
);

611 
OFPMP_QUEUE
: {

612 
	`oÊ_msg_¥öt_°©s_ª∂y_queue
((
oÊ_msg_mu…ù¨t_ª∂y_queue
 *)
msg
, 
°ªam
);

615 (
OFPMP_GROUP
): {

616 
	`oÊ_msg_¥öt_°©s_ª∂y_group
((
oÊ_msg_mu…ù¨t_ª∂y_group
 *)
msg
, 
°ªam
);

619 
OFPMP_GROUP_DESC
: {

620 
	`oÊ_msg_¥öt_°©s_ª∂y_group_desc
((
oÊ_msg_mu…ù¨t_ª∂y_group_desc
 *)
msg
, 
°ªam
, 
exp
);

623 
OFPMP_GROUP_FEATURES
:{

624 
	`oÊ_msg_¥öt_°©s_ª∂y_group_„©uªs
((
oÊ_msg_mu…ù¨t_ª∂y_group_„©uªs
 *)
msg
, 
°ªam
);

627 
OFPMP_METER
:{

628 
	`oÊ_msg_¥öt_°©s_ª∂y_mëî
((
oÊ_msg_mu…ù¨t_ª∂y_mëî
*)
msg
, 
°ªam
);

631 
OFPMP_METER_CONFIG
:{

632 
	`oÊ_msg_¥öt_°©s_ª∂y_mëî_c⁄f
((
oÊ_msg_mu…ù¨t_ª∂y_mëî_c⁄f
*)
msg
, 
°ªam
);

635 
OFPMP_METER_FEATURES
:{

636 
	`oÊ_msg_¥öt_ª∂y_mëî_„©uªs
((
oÊ_msg_mu…ù¨t_ª∂y_mëî_„©uªs
*)
msg
, 
°ªam
);

639 
OFPMP_PORT_DESC
:{

640 
	`oÊ_msg_¥öt_p‹t_desc_ª∂y
((
oÊ_msg_mu…ù¨t_ª∂y_p‹t_desc
*)
msg
, 
°ªam
);

643 
OFPMP_EXPERIMENTER
: {

644 
	`oÊ_msg_¥öt_°©s_ª∂y_ex≥rimíãr
((
oÊ_msg_mu…ù¨t_ª∂y_ex≥rimíãr
 *)
msg
, 
°ªam
);

649 
	`Ârötf
(
°ªam
, "}");

650 
	}
}

653 
	$oÊ_msg_¥öt_queue_gë_c⁄fig_ªque°
(
oÊ_msg_queue_gë_c⁄fig_ªque°
 *
msg
, 
FILE
 *
°ªam
) {

654 
	`Ârötf
(
°ªam
, "{port=\"");

655 
	`oÊ_p‹t_¥öt
(
°ªam
, 
msg
->
p‹t
);

656 
	`Ârötf
(
°ªam
, "\"}");

657 
	}
}

660 
	$oÊ_msg_¥öt_queue_gë_c⁄fig_ª∂y
(
oÊ_msg_queue_gë_c⁄fig_ª∂y
 *
msg
, 
FILE
 *
°ªam
) {

661 
size_t
 
i
;

663 
	`Ârötf
(
°ªam
, "{port=\"");

664 
	`oÊ_p‹t_¥öt
(
°ªam
, 
msg
->
p‹t
);

665 
	`Ârötf
(
°ªam
, "\" queues=[");

667 
i
=0; i<
msg
->
queues_num
; i++) {

668 
	`oÊ_°ru˘s_queue_¥öt
(
°ªam
, 
msg
->
queues
[
i
]);

669 i‡(
i
 < 
msg
->
queues_num
 - 1Ë{ 
	`Ârötf
(
°ªam
, ", "); }

672 
	`Ârötf
(
°ªam
, "]}");

673 
	}
}

676 
	$oÊ_msg_¥öt_rﬁe_msg
(
oÊ_msg_rﬁe_ªque°
 *
msg
, 
FILE
 *
°ªam
){

678 
	`Ârötf
(
°ªam
, "{rﬁe%d, gíî©i⁄_id%Œd}", 
msg
->
rﬁe
, msg->
gíî©i⁄_id
);

680 
	}
}

683 
	$oÊ_msg_¥öt_async
(
oÊ_msg_async_c⁄fig
* 
msg
, 
FILE
 *
°ªam
){

685 
	`Ârötf
(
°ªam
, "{");

686 
	`oÊ_°ru˘s_async_c⁄fig_¥öt
(
°ªam
, 
msg
->
c⁄fig
);

687 
	`Ârötf
(
°ªam
, "}");

689 
	}
}

692 
	$oÊ_msg_to_°rög
(
oÊ_msg_hódî
 *
msg
, 
oÊ_exp
 *
exp
) {

693 *
°r
;

694 
size_t
 
°r_size
;

695 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

697 
	`oÊ_msg_¥öt
(
°ªam
, 
msg
, 
exp
);

698 
	`f˛o£
(
°ªam
);

699  
°r
;

700 
	}
}

703 
	$oÊ_msg_¥öt
(
FILE
 *
°ªam
, 
oÊ_msg_hódî
 *
msg
, 
oÊ_exp
 *
exp
) {

704 
	`oÊ_mesßge_ty≥_¥öt
(
°ªam
, 
msg
->
ty≥
);

706 
msg
->
ty≥
) {

707 
OFPT_HELLO
: { ; }

708 
OFPT_ERROR
: { 
	`oÊ_msg_¥öt_îr‹
((
oÊ_msg_îr‹
 *)
msg
, 
°ªam
); ; }

709 
OFPT_ECHO_REQUEST
:

710 
OFPT_ECHO_REPLY
: { 
	`oÊ_msg_¥öt_echo
((
oÊ_msg_echo
 *)
msg
, 
°ªam
); ; }

711 
OFPT_EXPERIMENTER
: {

712 i‡(
exp
 =
NULL
 ||Éxp->
msg
 =NULL ||Éxp->msg->
to_°rög
 == NULL) {

713 
	`oÊ_msg_¥öt_ex≥rimíãr
((
oÊ_msg_ex≥rimíãr
 *)
msg
, 
°ªam
);

715 *
c
 = 
exp
->
msg
->
	`to_°rög
((
oÊ_msg_ex≥rimíãr
 *)msg);

716 
	`Ârötf
(
°ªam
, "%s", 
c
);

717 
	`‰ì
(
c
);

723 
OFPT_FEATURES_REQUEST
: { ; }

724 
OFPT_FEATURES_REPLY
: { 
	`oÊ_msg_¥öt_„©uªs_ª∂y
((
oÊ_msg_„©uªs_ª∂y
 *)
msg
, 
°ªam
); ; }

725 
OFPT_GET_CONFIG_REQUEST
: { ; }

726 
OFPT_GET_CONFIG_REPLY
: { 
	`oÊ_msg_¥öt_gë_c⁄fig_ª∂y
((
oÊ_msg_gë_c⁄fig_ª∂y
 *)
msg
, 
°ªam
); ; }

727 
OFPT_SET_CONFIG
: { 
	`oÊ_msg_¥öt_£t_c⁄fig
((
oÊ_msg_£t_c⁄fig
 *)
msg
, 
°ªam
); ; }

730 
OFPT_PACKET_IN
: { 
	`oÊ_msg_¥öt_∑ckë_ö
((
oÊ_msg_∑ckë_ö
 *)
msg
, 
°ªam
); ; }

731 
OFPT_FLOW_REMOVED
: { 
	`oÊ_msg_¥öt_Êow_ªmoved
((
oÊ_msg_Êow_ªmoved
 *)
msg
, 
°ªam
, 
exp
); ; }

732 
OFPT_PORT_STATUS
: { 
	`oÊ_msg_¥öt_p‹t_°©us
((
oÊ_msg_p‹t_°©us
 *)
msg
, 
°ªam
); ; }

735 
OFPT_PACKET_OUT
: { 
	`oÊ_msg_¥öt_∑ckë_out
((
oÊ_msg_∑ckë_out
 *)
msg
, 
°ªam
, 
exp
); ; }

736 
OFPT_FLOW_MOD
: { 
	`oÊ_msg_¥öt_Êow_mod
((
oÊ_msg_Êow_mod
 *)
msg
, 
°ªam
, 
exp
); ; }

737 
OFPT_GROUP_MOD
: { 
	`oÊ_msg_¥öt_group_mod
((
oÊ_msg_group_mod
 *)
msg
, 
°ªam
, 
exp
); ; }

738 
OFPT_PORT_MOD
: { 
	`oÊ_msg_¥öt_p‹t_mod
((
oÊ_msg_p‹t_mod
 *)
msg
, 
°ªam
); ; }

739 
OFPT_TABLE_MOD
: { 
	`oÊ_msg_¥öt_èbÀ_mod
((
oÊ_msg_èbÀ_mod
 *)
msg
, 
°ªam
); ; }

742 
OFPT_MULTIPART_REQUEST
: { 
	`oÊ_msg_¥öt_mu…ù¨t_ªque°
((
oÊ_msg_mu…ù¨t_ªque°_hódî
 *)
msg
, 
°ªam
, 
exp
); ; }

743 
OFPT_MULTIPART_REPLY
: { 
	`oÊ_msg_¥öt_mu…ù¨t_ª∂y
((
oÊ_msg_mu…ù¨t_ª∂y_hódî
 *)
msg
, 
°ªam
, 
exp
); ; }

746 
OFPT_BARRIER_REQUEST
: { ; }

747 
OFPT_BARRIER_REPLY
: { ; }

750 
OFPT_ROLE_REQUEST
:

751 
OFPT_ROLE_REPLY
:{

752 
	`oÊ_msg_¥öt_rﬁe_msg
((
oÊ_msg_rﬁe_ªque°
*)
msg
, 
°ªam
);

755 
OFPT_QUEUE_GET_CONFIG_REQUEST
: { 
	`oÊ_msg_¥öt_queue_gë_c⁄fig_ªque°
((
oÊ_msg_queue_gë_c⁄fig_ªque°
 *)
msg
, 
°ªam
); ; }

756 
OFPT_QUEUE_GET_CONFIG_REPLY
: { 
	`oÊ_msg_¥öt_queue_gë_c⁄fig_ª∂y
((
oÊ_msg_queue_gë_c⁄fig_ª∂y
 *)
msg
, 
°ªam
); ; }

759 
OFPT_GET_ASYNC_REQUEST
:{;}

760 
OFPT_GET_ASYNC_REPLY
:

761 
OFPT_SET_ASYNC
:{
	`oÊ_msg_¥öt_async
((
oÊ_msg_async_c⁄fig
*)
msg
, 
°ªam
); ;}

763 
OFPT_METER_MOD
: {
	`oÊ_msg_¥öt_mëî_mod
((
oÊ_msg_mëî_mod
*)
msg
, 
°ªam
); ;}

766 
	}
}

	@oflib/ofl-messages-unpack.c

31 
	~<°dlib.h
>

32 
	~<°rög.h
>

33 
	~<√töë/ö.h
>

34 
	~<ídün.h
>

35 
	~"oÊ-a˘i⁄s.h
"

36 
	~"oÊ-mesßges.h
"

37 
	~"oÊ-°ru˘s.h
"

38 
	~"oÊ-utûs.h
"

39 
	~"oÊ-¥öt.h
"

40 
	~"oÊ-log.h
"

41 
	~"›íÊow/›íÊow.h
"

43 
	#UNUSED
 
	`__©åibuã__
((
__unu£d__
))

	)

45 
	#LOG_MODULE
 
oÊ_msg_u


	)

46 
	$OFL_LOG_INIT
(
LOG_MODULE
)

53 
oÊ_îr


54 
	$oÊ_msg_u≈ack_îr‹
(
oÂ_hódî
 *
§c
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

55 
oÂ_îr‹_msg
 *
£
;

56 
oÊ_msg_îr‹
 *
de
;

58 i‡(*
Àn
 < (
oÂ_îr‹_msg
)) {

59 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived ERROR mesßgêövÆidÜígth (%zu).", *
Àn
);

60  
OFL_ERROR
;

62 *
Àn
 -(
oÂ_îr‹_msg
);

64 
£
 = (
oÂ_îr‹_msg
 *)
§c
;

66 
de
 = (
oÊ_msg_îr‹
 *)
	`mÆloc
((ofl_msg_error));

68 
de
->
ty≥
 = (
oÂ_îr‹_ty≥
)
	`¡ohs
(
£
->type);

69 
de
->
code
 = 
	`¡ohs
(
£
->code);

70 
de
->
d©a_Àngth
 = *
Àn
;

71 
de
->
d©a
 = *
Àn
 > 0 ? (
uöt8_t
 *)
	`mem˝y
(
	`mÆloc
(*Àn), 
£
->d©a, *ÀnË: 
NULL
;

72 *
Àn
 = 0;

74 (*
msg
Ë(
oÊ_msg_hódî
 *)
de
;

76 
	}
}

79 
oÊ_îr


80 
	$oÊ_msg_u≈ack_echo
(
oÂ_hódî
 *
§c
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

81 
oÊ_msg_echo
 *
e
 = (oÊ_msg_echÿ*)
	`mÆloc
((ofl_msg_echo));

82 
uöt8_t
 *
d©a
;

85 *
Àn
 -(
oÂ_hódî
);

87 
d©a
 = (
uöt8_t
 *)
§c
 + (
oÂ_hódî
);

88 
e
->
d©a_Àngth
 = *
Àn
;

89 
e
->
d©a
 = *
Àn
 > 0 ? (
uöt8_t
 *)
	`mem˝y
(
	`mÆloc
(*Àn), d©a, *ÀnË: 
NULL
;

90 *
Àn
 = 0;

92 *
msg
 = (
oÊ_msg_hódî
 *)
e
;

94 
	}
}

96 
oÊ_îr


97 
	$oÊ_msg_u≈ack_rﬁe_ªque°
(
oÂ_hódî
 *
§c
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

98 
oÂ_rﬁe_ªque°
 *
§l
;

99 
oÊ_msg_rﬁe_ªque°
 *
dæ
;

101 i‡(*
Àn
 < (
oÂ_rﬁe_ªque°
)){

102 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived ROLE mesßgêha†övÆidÜígth (%zu).", *
Àn
);

103  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

105 *
Àn
 -(
oÂ_rﬁe_ªque°
);

107 
§l
 = (
oÂ_rﬁe_ªque°
 *Ë
§c
;

108 
dæ
 = (
oÊ_msg_rﬁe_ªque°
 *Ë
	`mÆloc
((ofl_msg_role_request));

110 
dæ
->
rﬁe
 = 
	`¡ohl
(
§l
->role);

111 
dæ
->
gíî©i⁄_id
 = 
	`¡oh64
(
§l
->generation_id);

113 *
msg
 = (
oÊ_msg_hódî
 *)
dæ
;

115 
	}
}

117 
oÊ_îr


118 
	$oÊ_msg_u≈ack_„©uªs_ª∂y
(
oÂ_hódî
 *
§c
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

119 
oÂ_swôch_„©uªs
 *
§
;

120 
oÊ_msg_„©uªs_ª∂y
 *
dr
;

122 i‡(*
Àn
 < (
oÂ_swôch_„©uªs
)) {

123 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived FEATURES_REPLY mesßgêha†övÆidÜígth (%zu).", *
Àn
);

126 *
Àn
 -(
oÂ_swôch_„©uªs
);

128 
§
 = (
oÂ_swôch_„©uªs
 *)
§c
;

129 
dr
 = (
oÊ_msg_„©uªs_ª∂y
 *)
	`mÆloc
((ofl_msg_features_reply));

131 
dr
->
d©≠©h_id
 = 
	`¡oh64
(
§
->datapath_id);

132 
dr
->
n_buf„rs
 = 
	`¡ohl
–
§
->n_buffers);

133 
dr
->
n_èbÀs
 = 
§
->n_tables;

134 
dr
->
auxûüry_id
 = 
§
->auxiliary_id;

135 
dr
->
ˇ∑bûôõs
 = 
	`¡ohl
–
§
->capabilities);

137 *
msg
 = (
oÊ_msg_hódî
 *)
dr
;

139 
	}
}

142 
oÊ_îr


143 
	$oÊ_msg_u≈ack_gë_c⁄fig_ª∂y
(
oÂ_hódî
 *
§c
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

144 
oÂ_swôch_c⁄fig
 *
§
;

145 
oÊ_msg_gë_c⁄fig_ª∂y
 *
dr
;

147 i‡(*
Àn
 < (
oÂ_swôch_c⁄fig
)) {

148 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived GET_CONFIG_REPLY mesßgêha†övÆidÜígth (%zu).", *
Àn
);

149  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

151 *
Àn
 -(
oÂ_swôch_c⁄fig
);

153 
§
 = (
oÂ_swôch_c⁄fig
 *)
§c
;

154 
dr
 = (
oÊ_msg_gë_c⁄fig_ª∂y
 *)
	`mÆloc
((ofl_msg_get_config_reply));

156 
dr
->
c⁄fig
 = (
oÊ_c⁄fig
 *)
	`mÆloc
((ofl_config));

157 
dr
->
c⁄fig
->
miss_£nd_Àn
 = 
	`¡ohs
(
§
->miss_send_len);

158 
dr
->
c⁄fig
->
Êags
 = 
	`¡ohs
(
§
->flags);

160 *
msg
 = (
oÊ_msg_hódî
 *)
dr
;

162 
	}
}

164 
oÊ_îr


165 
	$oÊ_msg_u≈ack_£t_c⁄fig
(
oÂ_hódî
 *
§c
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

166 
oÂ_swôch_c⁄fig
 *
§
;

167 
oÊ_msg_£t_c⁄fig
 *
dr
;

169 i‡(*
Àn
 < (
oÂ_swôch_c⁄fig
)) {

170 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived SET_CONFIG mesßgêha†övÆidÜígth (%zu).", *
Àn
);

171  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

173 *
Àn
 -(
oÂ_swôch_c⁄fig
);

175 
§
 = (
oÂ_swôch_c⁄fig
 *)
§c
;

176 
dr
 = (
oÊ_msg_£t_c⁄fig
 *)
	`mÆloc
((ofl_msg_set_config));

178 
dr
->
c⁄fig
 = (
oÊ_c⁄fig
 *)
	`mÆloc
((ofl_config));

180 
dr
->
c⁄fig
->
miss_£nd_Àn
 = 
	`¡ohs
(
§
->miss_send_len);

181 
dr
->
c⁄fig
->
Êags
 = 
	`¡ohs
(
§
->flags);

183 *
msg
 = (
oÊ_msg_hódî
 *)
dr
;

185 
	}
}

187 
oÊ_îr


188 
	$oÊ_msg_u≈ack_async_c⁄fig
(
oÂ_hódî
 *
§c
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
){

189 
oÂ_async_c⁄fig
 *
ßc
;

190 
oÊ_msg_async_c⁄fig
 *
dac
;

191 
i
;

193 i‡(*
Àn
 < (
oÂ_async_c⁄fig
)) {

194 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived ASYNC CONFIG mesßgêha†övÆidÜígth (%zu).", *
Àn
);

195  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

198 *
Àn
 -(
oÂ_async_c⁄fig
);

200 
ßc
 = (
oÂ_async_c⁄fig
*)
§c
;

201 
dac
 = (
oÊ_msg_async_c⁄fig
*)
	`mÆloc
((ofl_msg_async_config));

202 
dac
->
c⁄fig
 = (
oÊ_async_c⁄fig
*Ë
	`mÆloc
((ofl_async_config));

203 
i
 = 0; i < 2; i++){

204 
dac
->
c⁄fig
->
∑ckë_ö_mask
[
i
] = 
ßc
->packet_in_mask[i];

205 
dac
->
c⁄fig
->
p‹t_°©us_mask
[
i
] = 
ßc
->port_status_mask[i];

206 
dac
->
c⁄fig
->
Êow_ªmoved_mask
[
i
] = 
ßc
->flow_removed_mask[i];

209 *
msg
 = (
oÊ_msg_hódî
*)
dac
;

211 
	}
}

213 
oÊ_îr


214 
	$oÊ_msg_u≈ack_∑ckë_ö
(
oÂ_hódî
 *
§c
, 
uöt8_t
* 
buf
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

215 
oÂ_∑ckë_ö
 *
•
;

216 
oÊ_msg_∑ckë_ö
 *
dp
;

217 
uöt8_t
 *
±r
;

219 i‡(*
Àn
 < (
oÂ_∑ckë_ö
)) {

220 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived PACKET_IN mesßgêha†övÆidÜígth (%zu).", *
Àn
);

221  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

224 
•
 = (
oÂ_∑ckë_ö
 *)
§c
;

238 i‡(
•
->
èbÀ_id
 =
PIPELINE_TABLES
) {

239 i‡(
	`OFL_LOG_IS_WARN_ENABLED
(
LOG_MODULE
)) {

240 *
ts
 = 
	`oÊ_èbÀ_to_°rög
(
•
->
èbÀ_id
);

241 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived PACKET_IN ha†övÆidÅabÀ_id (%s).", 
ts
);

242 
	`‰ì
(
ts
);

244  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_TABLE_ID
);

246 *
Àn
 -(
oÂ_∑ckë_ö
Ë- (
oÂ_m©ch
);

247 
dp
 = (
oÊ_msg_∑ckë_ö
 *)
	`mÆloc
((ofl_msg_packet_in));

248 
dp
->
buf„r_id
 = 
	`¡ohl
(
•
->buffer_id);

249 
dp
->
tŸÆ_Àn
 = 
	`¡ohs
(
•
->total_len);

250 
dp
->
ªas⁄
 = (
oÂ_∑ckë_ö_ªas⁄
)
•
->reason;

251 
dp
->
èbÀ_id
 = 
•
->table_id;

252 
dp
->
cookõ
 = 
	`¡oh64
(
•
->cookie);

254 
±r
 = 
buf
 + ((
oÂ_∑ckë_ö
)-4);

255 
	`oÊ_°ru˘s_m©ch_u≈ack
(&(
•
->
m©ch
),
±r
, 
Àn
 ,&(
dp
->m©ch),
NULL
);

257 
±r
 = 
buf
 + 
	`ROUND_UP
((
oÂ_∑ckë_ö
)-4 + 
dp
->
m©ch
->
Àngth
,8) + 2;

259 *
Àn
 -= 2;

260 
dp
->
d©a_Àngth
 = *
Àn
;

261 
dp
->
d©a
 = *
Àn
 > 0 ? (
uöt8_t
 *)
	`mem˝y
(
	`mÆloc
(*Àn), 
±r
, *ÀnË: 
NULL
;

262 *
Àn
 = 0;

264 *
msg
 = (
oÊ_msg_hódî
 *)
dp
;

266 
	}
}

268 
oÊ_îr


269 
	$oÊ_msg_u≈ack_Êow_ªmoved
(
oÂ_hódî
 *
§c
,
uöt8_t
 *
buf
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
, 
oÊ_exp
 *
exp
) {

270 
oÂ_Êow_ªmoved
 *
§
;

271 
oÊ_msg_Êow_ªmoved
 *
dr
;

272 
oÊ_îr
 
îr‹
;

273 
m©ch_pos
;

275 i‡(*
Àn
 < ((
oÂ_Êow_ªmoved
Ë- (
oÂ_m©ch
))) {

276 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived FLOW_REMOVED mesßgêha†övÆidÜígth (%zu).", *
Àn
);

277  
OFL_ERROR
;

280 
§
 = (
oÂ_Êow_ªmoved
 *)
§c
 ;

282 i‡(
§
->
èbÀ_id
 >
PIPELINE_TABLES
) {

283 i‡(
	`OFL_LOG_IS_WARN_ENABLED
(
LOG_MODULE
)) {

284 *
ts
 = 
	`oÊ_èbÀ_to_°rög
(
§
->
èbÀ_id
);

285 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived FLOW_REMOVED mesßgêha†övÆidÅabÀ_id (%s).", 
ts
);

286 
	`‰ì
(
ts
);

288  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_TABLE_ID
);

290 *
Àn
 -(
oÂ_Êow_ªmoved
Ë- (
oÂ_m©ch
) ;

292 
dr
 = (
oÊ_msg_Êow_ªmoved
 *)
	`mÆloc
((ofl_msg_flow_removed));

293 
dr
->
ªas⁄
 = (
oÂ_Êow_ªmoved_ªas⁄
)
§
->reason;

295 
dr
->
°©s
 = (
oÊ_Êow_°©s
 *)
	`mÆloc
((ofl_flow_stats));

296 
dr
->
°©s
->
èbÀ_id
 = 
§
->table_id;

297 
dr
->
°©s
->
duøti⁄_£c
 = 
	`¡ohl
–
§
->duration_sec);

298 
dr
->
°©s
->
duøti⁄_n£c
 = 
	`¡ohl
–
§
->duration_nsec);

299 
dr
->
°©s
->
¥i‹ôy
 = 
	`¡ohs
(
§
->priority);

300 
dr
->
°©s
->
idÀ_timeout
 = 
	`¡ohs
–
§
->idle_timeout);

301 
dr
->
°©s
->
h¨d_timeout
 = 0;

302 
dr
->
°©s
->
cookõ
 = 
	`¡oh64
(
§
->cookie);

303 
dr
->
°©s
->
∑ckë_cou¡
 = 
	`¡oh64
(
§
->packet_count);

304 
dr
->
°©s
->
byã_cou¡
 = 
	`¡oh64
(
§
->byte_count);

305 
dr
->
°©s
->
ö°ru˘i⁄s_num
 = 0;

306 
dr
->
°©s
->
ö°ru˘i⁄s
 = 
NULL
;

308 
m©ch_pos
 = (
oÂ_Êow_ªmoved
) - 4;

310 
îr‹
 = 
	`oÊ_°ru˘s_m©ch_u≈ack
(&(
§
->
m©ch
),
buf
 + 
m©ch_pos
, 
Àn
, &(
dr
->
°©s
->m©ch), 
exp
);

311 i‡(
îr‹
) {

312 
	`‰ì
(
dr
->
°©s
);

313 
	`‰ì
(
dr
);

314  
îr‹
;

316 *
msg
 = (
oÊ_msg_hódî
 *)
dr
;

318 
	}
}

320 
oÊ_îr


321 
	$oÊ_msg_u≈ack_p‹t_°©us
(
oÂ_hódî
 *
§c
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

322 
oÂ_p‹t_°©us
 *
ss
;

323 
oÊ_msg_p‹t_°©us
 *
ds
;

324 
oÊ_îr
 
îr‹
;

326 i‡(*
Àn
 < (
oÂ_p‹t_°©us
)) {

327 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived PORT_STATUS mesßgêha†övÆidÜígth (%zu).", *
Àn
);

328  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

330 *
Àn
 -((
oÂ_p‹t_°©us
Ë- (
oÂ_p‹t
));

332 
ss
 = (
oÂ_p‹t_°©us
 *)
§c
;

333 
ds
 = (
oÊ_msg_p‹t_°©us
 *)
	`mÆloc
((ofl_msg_port_status));

335 
ds
->
ªas⁄
 = (
oÂ_p‹t_ªas⁄
Ë
ss
->reason;

337 
îr‹
 = 
	`oÊ_°ru˘s_p‹t_u≈ack
(&(
ss
->
desc
), 
Àn
, &(
ds
->desc));

338 i‡(
îr‹
) {

339 
	`‰ì
(
ds
);

340  
îr‹
;

343 *
msg
 = (
oÊ_msg_hódî
 *)
ds
;

345 
	}
}

347 
oÊ_îr


348 
	$oÊ_msg_u≈ack_∑ckë_out
(
oÂ_hódî
 *
§c
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
, 
oÊ_exp
 *
exp
) {

349 
oÂ_∑ckë_out
 *
•
;

350 
oÊ_msg_∑ckë_out
 *
dp
;

351 
oÂ_a˘i⁄_hódî
 *
a˘
;

352 
uöt8_t
 *
d©a
;

353 
oÊ_îr
 
îr‹
;

354 
size_t
 
i
, 
a˘i⁄s_num
;

356 i‡(*
Àn
 < (
oÂ_∑ckë_out
)) {

357 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived PACKET_OUT mesßgêha†övÆidÜígth (%zu).", *
Àn
);

358  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

361 
•
 = (
oÂ_∑ckë_out
 *)
§c
;

373 i‡(
	`¡ohl
(
•
->
buf„r_id
) != 0xffffffff &&

374 *
Àn
 !(
oÂ_∑ckë_out
Ë+ 
	`¡ohs
(
•
->
a˘i⁄s_Àn
)) {

375 i‡(
	`OFL_LOG_IS_WARN_ENABLED
(
LOG_MODULE
)) {

376 *
bs
 = 
	`oÊ_buf„r_to_°rög
(
	`¡ohl
(
•
->
buf„r_id
));

377 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived PACKET_OUT mesßgêwôh d©®™d buf„r_id (%s).", 
bs
);

378 
	`‰ì
(
bs
);

380  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

382 *
Àn
 -(
oÂ_∑ckë_out
);

384 
dp
 = (
oÊ_msg_∑ckë_out
 *)
	`mÆloc
((ofl_msg_packet_out));

386 
dp
->
buf„r_id
 = 
	`¡ohl
(
•
->buffer_id);

387 
dp
->
ö_p‹t
 = 
	`¡ohl
(
•
->in_port);

388 i‡(*
Àn
 < 
	`¡ohs
(
•
->
a˘i⁄s_Àn
)) {

389 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived PACKET_OUT mesßgêha†övÆidá˘i⁄Üígth (%zu).", *
Àn
);

390 
	`‰ì
(
dp
);

391  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

394 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_a˘i⁄s
(&(
•
->
a˘i⁄s
), 
	`¡ohs
(•->
a˘i⁄s_Àn
), &
a˘i⁄s_num
);

395 i‡(
îr‹
) {

396 
	`‰ì
(
dp
);

397  
îr‹
;

399 
dp
->
a˘i⁄s_num
 =áctions_num;

400 
dp
->
a˘i⁄s
 = (
oÊ_a˘i⁄_hódî
 **)
	`mÆloc
(dp->
a˘i⁄s_num
 * (
oÂ_a˘i⁄_hódî
 *));

403 
a˘
 = 
•
->
a˘i⁄s
;

404 
i
 = 0; i < 
dp
->
a˘i⁄s_num
; i++) {

405 
îr‹
 = 
	`oÊ_a˘i⁄s_u≈ack
(
a˘
, 
Àn
, &(
dp
->
a˘i⁄s
[
i
]), 
exp
);

406 i‡(
îr‹
) {

407 
	`OFL_UTILS_FREE_ARR_FUN2
(
dp
->
a˘i⁄s
, 
i
,

408 
oÊ_a˘i⁄s_‰ì
, 
exp
);

409 
	`‰ì
(
dp
);

411 
a˘
 = (
oÂ_a˘i⁄_hódî
 *)((
uöt8_t
 *Ô˘ + 
	`¡ohs
◊˘->
Àn
));

414 
d©a
 = ((
uöt8_t
 *)
•
->
a˘i⁄s
Ë+ 
	`¡ohs
(•->
a˘i⁄s_Àn
);

415 
dp
->
d©a_Àngth
 = *
Àn
;

416 
dp
->
d©a
 = *
Àn
 > 0 ? (
uöt8_t
 *)
	`mem˝y
(
	`mÆloc
(*Àn), d©a, *ÀnË: 
NULL
;

417 *
Àn
 = 0;

419 *
msg
 = (
oÊ_msg_hódî
 *)
dp
;

422 
	}
}

425 
oÊ_îr


426 
	$oÊ_msg_u≈ack_Êow_mod
(
oÂ_hódî
 *
§c
,
uöt8_t
* 
buf
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
, 
oÊ_exp
 *
exp
) {

427 
oÂ_Êow_mod
 *
sm
;

428 
oÊ_msg_Êow_mod
 *
dm
;

429 
oÂ_ö°ru˘i⁄
 *
ö°
;

430 
oÊ_îr
 
îr‹
;

431 
size_t
 
i
;

432 
m©ch_pos
;

434 i‡(*
Àn
 < ((
oÂ_Êow_mod
Ë- (
oÂ_m©ch
))) {

435 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived FLOW_MOD mesßgêha†övÆidÜígth (%zu).", *
Àn
);

436  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

439 *
Àn
 -((
oÂ_Êow_mod
Ë- (
oÂ_m©ch
));

441 
sm
 = (
oÂ_Êow_mod
 *)
§c
;

442 
dm
 = (
oÊ_msg_Êow_mod
 *)
	`mÆloc
((ofl_msg_flow_mod));

444 i‡(
sm
->
èbÀ_id
 >
PIPELINE_TABLES
 && ((sm->
comm™d
 !
OFPFC_DELETE


445 || 
sm
->
comm™d
 !
OFPFC_DELETE_STRICT
Ë&& sm->
èbÀ_id
 !
OFPTT_ALL
)) {

446 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived FLOW_MOD mesßgêha†övÆidÅabÀ id (%zu).", 
sm
->
èbÀ_id
 );

447  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_TABLE_ID
);

450 
dm
->
cookõ
 = 
	`¡oh64
(
sm
->cookie);

451 
dm
->
cookõ_mask
 = 
	`¡oh64
(
sm
->cookie_mask);

452 
dm
->
èbÀ_id
 = 
sm
->table_id;

453 
dm
->
comm™d
 = (
oÂ_Êow_mod_comm™d
)
sm
->command;

454 
dm
->
idÀ_timeout
 = 
	`¡ohs
–
sm
->idle_timeout);

455 
dm
->
h¨d_timeout
 = 
	`¡ohs
–
sm
->hard_timeout);

456 
dm
->
¥i‹ôy
 = 
	`¡ohs
–
sm
->priority);

457 
dm
->
buf„r_id
 = 
	`¡ohl
–
sm
->buffer_id);

458 
dm
->
out_p‹t
 = 
	`¡ohl
–
sm
->out_port);

459 
dm
->
out_group
 = 
	`¡ohl
–
sm
->out_group);

460 
dm
->
Êags
 = 
	`¡ohs
–
sm
->flags);

462 
m©ch_pos
 = (
oÂ_Êow_mod
) - 4;

463 
îr‹
 = 
	`oÊ_°ru˘s_m©ch_u≈ack
(&(
sm
->
m©ch
), 
buf
 + 
m©ch_pos
, 
Àn
, &(
dm
->m©ch), 
exp
);

464 i‡(
îr‹
) {

465 
	`‰ì
(
dm
);

466  
îr‹
;

469 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_ö°ru˘i⁄s
((
oÂ_ö°ru˘i⁄
 *)(
buf
 + 
	`ROUND_UP
(
m©ch_pos
 + 
dm
->
m©ch
->
Àngth
,8)), *
Àn
, &dm->
ö°ru˘i⁄s_num
);

470 i‡(
îr‹
) {

471 
	`oÊ_°ru˘s_‰ì_m©ch
(
dm
->
m©ch
, 
exp
);

472 
	`‰ì
(
dm
);

473  
îr‹
;

476 
dm
->
ö°ru˘i⁄s
 = (
oÊ_ö°ru˘i⁄_hódî
 **)
	`mÆloc
(dm->
ö°ru˘i⁄s_num
 * (ofl_instruction_header *));

477 
ö°
 = (
oÂ_ö°ru˘i⁄
 *Ë(
buf
 + 
	`ROUND_UP
(
m©ch_pos
 + 
dm
->
m©ch
->
Àngth
,8));

478 
i
 = 0; i < 
dm
->
ö°ru˘i⁄s_num
; i++) {

479 
îr‹
 = 
	`oÊ_°ru˘s_ö°ru˘i⁄s_u≈ack
(
ö°
, 
Àn
, &(
dm
->
ö°ru˘i⁄s
[
i
]), 
exp
);

480 i‡(
îr‹
) {

481 
	`OFL_UTILS_FREE_ARR_FUN2
(
dm
->
ö°ru˘i⁄s
, 
i
,

482 
oÊ_°ru˘s_‰ì_ö°ru˘i⁄
, 
exp
);

483 
	`oÊ_°ru˘s_‰ì_m©ch
(
dm
->
m©ch
, 
exp
);

484 
	`‰ì
(
dm
);

485  
îr‹
;

487 
ö°
 = (
oÂ_ö°ru˘i⁄
 *)((
uöt8_t
 *)ö° + 
	`¡ohs
(ö°->
Àn
));

489 *
msg
 = (
oÊ_msg_hódî
 *)
dm
;

491 
	}
}

493 
oÊ_îr


494 
	$oÊ_msg_u≈ack_group_mod
(
oÂ_hódî
 *
§c
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
, 
oÊ_exp
 *
exp
) {

495 
oÂ_group_mod
 *
sm
;

496 
oÊ_msg_group_mod
 *
dm
;

497 
oÂ_buckë
 *
buckë
;

498 
oÊ_îr
 
îr‹
;

499 
size_t
 
i
;

501 i‡(*
Àn
 < (
oÂ_group_mod
)) {

502 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived GROUP_MOD mesßgêha†övÆidÜígth (%zu).", *
Àn
);

503  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

505 *
Àn
 -(
oÂ_group_mod
);

507 
sm
 = (
oÂ_group_mod
 *)
§c
;

509 i‡(
	`¡ohs
(
sm
->
comm™d
Ë> 
OFPGC_DELETE
) {

510 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived GROUP_MOD mesßgêwôh invÆid comm™d (%u).", 
	`¡ohs
(
sm
->
comm™d
));

511  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPGMFC_BAD_COMMAND
);

514 i‡(
	`¡ohs
(
sm
->
ty≥
Ë> 
OFPGT_FF
 &&Çtohs(sm->type) < 128 ) {

515 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived GROUP_MOD mesßgêwôh invÆidÅy≥ (%u).", 
	`¡ohs
(
sm
->
ty≥
));

516  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPGMFC_BAD_TYPE
);

519 i‡(
	`¡ohl
(
sm
->
group_id
Ë> 
OFPG_MAX
 &&

520 !(
	`¡ohs
(
sm
->
comm™d
Ë=
OFPGC_DELETE
 && 
	`¡ohl
(sm->
group_id
Ë=
OFPG_ALL
)) {

521 i‡(
	`OFL_LOG_IS_WARN_ENABLED
(
LOG_MODULE
)) {

522 *
gs
 = 
	`oÊ_group_to_°rög
(
	`¡ohl
(
sm
->
group_id
));

523 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived GROUP_MOD mesßgêwôh invÆid grou∞id (%s).", 
gs
);

524 
	`‰ì
(
gs
);

526  
	`oÊ_îr‹
(
OFPET_GROUP_MOD_FAILED
, 
OFPGMFC_INVALID_GROUP
);

529 
dm
 = (
oÊ_msg_group_mod
 *)
	`mÆloc
((ofl_msg_group_mod));

531 
dm
->
comm™d
 = (
oÂ_group_mod_comm™d
)
	`¡ohs
(
sm
->command);

532 
dm
->
ty≥
 = 
sm
->type;

533 
dm
->
group_id
 = 
	`¡ohl
(
sm
->group_id);

535 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_buckës
(&(
sm
->
buckës
), *
Àn
, &
dm
->
buckës_num
);

536 i‡(
îr‹
) {

537 
	`‰ì
(
dm
);

538  
îr‹
;

541 i‡(
dm
->
comm™d
 =
OFPGC_DELETE
 && dm->
buckës_num
 > 0) {

542 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived DELETE grou∞comm™d wôh buckë†(%zu).", 
dm
->
buckës_num
);

543 
	`‰ì
(
dm
);

544  
	`oÊ_îr‹
(
OFPET_GROUP_MOD_FAILED
, 
OFPGMFC_INVALID_GROUP
);

547 i‡(
dm
->
ty≥
 =
OFPGT_INDIRECT
 && dm->
buckës_num
 != 1) {

548 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived INDIRECT grou∞d€¢'àhavêexa˘ly o√ buckë (%zu).", 
dm
->
buckës_num
);

549 
	`‰ì
(
dm
);

550  
	`oÊ_îr‹
(
OFPET_GROUP_MOD_FAILED
, 
OFPGMFC_INVALID_GROUP
);

553 
dm
->
buckës
 = (
oÊ_buckë
 **)
	`mÆloc
(dm->
buckës_num
 * (ofl_bucket *));

555 
buckë
 = 
sm
->
buckës
;

556 
i
 = 0; i < 
dm
->
buckës_num
; i++) {

557 
îr‹
 = 
	`oÊ_°ru˘s_buckë_u≈ack
(
buckë
, 
Àn
, 
dm
->
ty≥
, &(dm->
buckës
[
i
]), 
exp
);

558 i‡(
îr‹
) {

559 
	`OFL_UTILS_FREE_ARR_FUN2
(
dm
->
buckës
, 
i
,

560 
oÊ_°ru˘s_‰ì_buckë
, 
exp
);

561 
	`‰ì
(
dm
);

562  
îr‹
;

564 
buckë
 = (
oÂ_buckë
 *)((
uöt8_t
 *)buckë + 
	`¡ohs
(buckë->
Àn
));

567 *
msg
 = (
oÊ_msg_hódî
 *)
dm
;

569 
	}
}

571 
oÊ_îr


572 
	$oÊ_msg_u≈ack_mëî_mod
(
oÂ_hódî
 *
§c
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

573 
oÂ_mëî_mod
 *
sm
;

574 
oÊ_msg_mëî_mod
 *
dm
;

575 
oÂ_mëî_b™d_hódî
 *
b™d
;

576 
oÊ_îr
 
îr‹
;

577 
size_t
 
i
;

578 i‡(*
Àn
 < (
oÂ_mëî_mod
)) {

579 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived METER_MOD mesßgêha†övÆidÜígth (%zu).", *
Àn
);

580  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

582 *
Àn
 -(
oÂ_mëî_mod
);

584 
sm
 = (
oÂ_mëî_mod
 *)
§c
;

586 i‡(
	`¡ohs
(
sm
->
comm™d
Ë> 
OFPMC_DELETE
) {

587 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived METER_MOD mesßgêwôh invÆid comm™d (%u).", 
	`¡ohs
(
sm
->
comm™d
));

588  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPMMFC_BAD_COMMAND
);

591 i‡((
	`¡ohs
(
sm
->
Êags
) >> 3) > 1 ) {

592 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived METER_MOD mesßgêwôh invÆid fœgs(%u).", 
	`¡ohs
(
sm
->
Êags
));

593  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPMMFC_BAD_FLAGS
);

596 i‡(
	`¡ohl
(
sm
->
mëî_id
Ë> 
OFPM_MAX
 &&

597 !(
	`¡ohs
(
sm
->
comm™d
Ë=
OFPMC_DELETE
 && 
	`¡ohl
(sm->
mëî_id
Ë=
OFPM_ALL
)) {

599  
	`oÊ_îr‹
(
OFPET_METER_MOD_FAILED
, 
OFPMMFC_INVALID_METER
);

602 
dm
 = (
oÊ_msg_mëî_mod
 *)
	`mÆloc
((ofl_msg_meter_mod));

604 
dm
->
comm™d
 = 
	`¡ohs
(
sm
->command);

605 
dm
->
Êags
 = 
	`¡ohs
(
sm
->flags);

606 
dm
->
mëî_id
 = 
	`¡ohl
(
sm
->meter_id);

608 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_mëî_b™ds
(&(
sm
->
b™ds
), *
Àn
, &
dm
->
mëî_b™ds_num
);

609 i‡(
îr‹
) {

610 
	`‰ì
(
dm
);

611  
îr‹
;

614 
dm
->
b™ds
 = (
oÊ_mëî_b™d_hódî
 **)
	`mÆloc
(dm->
mëî_b™ds_num
 * (ofl_meter_band_header *));

616 
b™d
 = 
sm
->
b™ds
;

617 
i
 = 0; i < 
dm
->
mëî_b™ds_num
; i++) {

618 
îr‹
 = 
	`oÊ_°ru˘s_mëî_b™d_u≈ack
(
b™d
, 
Àn
, &(
dm
->
b™ds
[
i
]));

619 i‡(
îr‹
) {

620 
	`OFL_UTILS_FREE_ARR_FUN
(
dm
->
b™ds
, 
i
,

621 
oÊ_°ru˘s_‰ì_mëî_b™ds
);

622 
	`‰ì
(
dm
);

623  
îr‹
;

625 
b™d
 = (
oÂ_mëî_b™d_hódî
 *)((
uöt8_t
 *)b™d + 
	`¡ohs
(b™d->
Àn
));

628 *
msg
 = (
oÊ_msg_hódî
 *)
dm
;

630 
	}
}

632 
oÊ_îr


633 
	$oÊ_msg_u≈ack_p‹t_mod
(
oÂ_hódî
 *
§c
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

634 
oÂ_p‹t_mod
 *
sm
;

635 
oÊ_msg_p‹t_mod
 *
dm
;

637 i‡(*
Àn
 < (
oÂ_p‹t_mod
)) {

638 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived PORT_MOD ha†övÆidÜígth (%zu).", *
Àn
);

639  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

642 
sm
 = (
oÂ_p‹t_mod
 *)
§c
;

652 *
Àn
 -(
oÂ_p‹t_mod
);

654 
dm
 = (
oÊ_msg_p‹t_mod
 *)
	`mÆloc
((ofl_msg_port_mod));

656 
dm
->
p‹t_no
 = 
	`¡ohl
(
sm
->port_no);

657 
	`mem˝y
(
dm
->
hw_addr
, 
sm
->hw_addr, 
OFP_ETH_ALEN
);

658 
dm
->
c⁄fig
 = 
	`¡ohl
(
sm
->config);

659 
dm
->
mask
 = 
	`¡ohl
(
sm
->mask);

660 
dm
->
advîti£
 = 
	`¡ohl
(
sm
->advertise);

662 *
msg
 = (
oÊ_msg_hódî
 *)
dm
;

664 
	}
}

666 
oÊ_îr


667 
	$oÊ_msg_u≈ack_èbÀ_mod
(
oÂ_hódî
 *
§c
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

668 
oÂ_èbÀ_mod
 *
sm
;

669 
oÊ_msg_èbÀ_mod
 *
dm
;

671 i‡(*
Àn
 < (
oÂ_èbÀ_mod
)) {

672 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived TABLE_MOD mesßgêha†övÆidÜígth (%zu).", *
Àn
);

673  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

675 *
Àn
 -(
oÂ_èbÀ_mod
);

677 
sm
 = (
oÂ_èbÀ_mod
 *)
§c
;

678 
dm
 = (
oÊ_msg_èbÀ_mod
 *)
	`mÆloc
((ofl_msg_table_mod));

679 i‡(
sm
->
èbÀ_id
 >
PIPELINE_TABLES
) {

680 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived TABLE_MOD mesßgêha†övÆidÅabÀ id (%zu).", 
sm
->
èbÀ_id
 );

681  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_TABLE_ID
);

684 
dm
->
èbÀ_id
 = 
sm
->table_id;

685 
dm
->
c⁄fig
 = 
	`¡ohl
(
sm
->config);

687 *
msg
 = (
oÊ_msg_hódî
 *)
dm
;

689 
	}
}

691 
oÊ_îr


692 
	$oÊ_msg_u≈ack_mu…ù¨t_ªque°_Êow
(
oÂ_mu…ù¨t_ªque°
 *
os
, 
uöt8_t
* 
buf
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
, 
oÊ_exp
 *
exp
) {

693 
oÂ_Êow_°©s_ªque°
 *
sm
;

694 
oÊ_msg_mu…ù¨t_ªque°_Êow
 *
dm
;

695 
oÊ_îr
 
îr‹
 = 0;

696 
m©ch_pos
;

700 i‡(*
Àn
 < ((
oÂ_Êow_°©s_ªque°
Ë- (
oÂ_m©ch
))) {

701 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived FLOW sèt†ªque° ha†övÆidÜígth (%zu).", *
Àn
);

702  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

704 *
Àn
 -((
oÂ_Êow_°©s_ªque°
Ë- (
oÂ_m©ch
));

706 
sm
 = (
oÂ_Êow_°©s_ªque°
 *)
os
->
body
;

707 
dm
 = (
oÊ_msg_mu…ù¨t_ªque°_Êow
 *Ë
	`mÆloc
((ofl_msg_multipart_request_flow));

709 i‡(
sm
->
èbÀ_id
 !
OFPTT_ALL
 && sm->èbÀ_id >
PIPELINE_TABLES
) {

710 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived MULTIPART REQUEST FLOW mesßgêha†övÆidÅabÀ id (%zu).", 
sm
->
èbÀ_id
 );

711  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_TABLE_ID
);

714 
dm
->
èbÀ_id
 = 
sm
->table_id;

715 
dm
->
out_p‹t
 = 
	`¡ohl
(
sm
->out_port);

716 
dm
->
out_group
 = 
	`¡ohl
(
sm
->out_group);

717 
dm
->
cookõ
 = 
	`¡oh64
(
sm
->cookie);

718 
dm
->
cookõ_mask
 = 
	`¡oh64
(
sm
->cookie_mask);

720 
m©ch_pos
 = (
oÂ_mu…ù¨t_ªque°
Ë+ (
oÂ_Êow_°©s_ªque°
) - 4;

721 
îr‹
 = 
	`oÊ_°ru˘s_m©ch_u≈ack
(&(
sm
->
m©ch
),
buf
 + 
m©ch_pos
, 
Àn
, &(
dm
->m©ch), 
exp
);

722 i‡(
îr‹
) {

723 
	`‰ì
(
dm
);

724  
îr‹
;

727 *
msg
 = (
oÊ_msg_hódî
 *)
dm
;

729 
	}
}

731 
oÊ_îr


732 
	$oÊ_msg_u≈ack_mu…ù¨t_ªque°_p‹t
(
oÂ_mu…ù¨t_ªque°
 *
os
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

733 
oÂ_p‹t_°©s_ªque°
 *
sm
;

734 
oÊ_msg_mu…ù¨t_ªque°_p‹t
 *
dm
;

738 i‡(*
Àn
 < (
oÂ_p‹t_°©s_ªque°
)) {

739 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived PORT sèt†ªque° ha†övÆidÜígth (%zu).", *
Àn
);

740  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

743 
sm
 = (
oÂ_p‹t_°©s_ªque°
 *)
os
->
body
;

745 i‡(
	`¡ohl
(
sm
->
p‹t_no
) == 0 ||

746 (
	`¡ohl
(
sm
->
p‹t_no
Ë> 
OFPP_MAX
 &&Çtohl(sm->p‹t_noË!
OFPP_ANY
)) {

747 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived PORT sèt†ªque° ha†övÆidÖ‹à(%u).", 
	`¡ohl
(
sm
->
p‹t_no
));

748  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

751 *
Àn
 -(
oÂ_p‹t_°©s_ªque°
);

753 
dm
 = (
oÊ_msg_mu…ù¨t_ªque°_p‹t
 *Ë
	`mÆloc
((ofl_msg_multipart_request_port));

755 
dm
->
p‹t_no
 = 
	`¡ohl
(
sm
->port_no);

757 *
msg
 = (
oÊ_msg_hódî
 *)
dm
;

759 
	}
}

761 
oÊ_îr


762 
	$oÊ_msg_u≈ack_mu…ù¨t_ªque°_em±y
(
oÂ_mu…ù¨t_ªque°
 *
os
 
UNUSED
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

764 
Àn
 -(
oÂ_mu…ù¨t_ªque°
);

766 *
msg
 = (
oÊ_msg_hódî
 *)
	`mÆloc
((
oÊ_msg_mu…ù¨t_ªque°_hódî
));

768 
	}
}

770 
oÊ_îr


771 
	$oÊ_msg_u≈ack_mu…ù¨t_ªque°_èbÀ_„©uªs
(
oÂ_mu…ù¨t_ªque°
 *
os
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
, 
oÊ_exp
 *
exp
){

772 
oÊ_msg_mu…ù¨t_ªque°_èbÀ_„©uªs
 *
dm
;

773 
oÊ_îr
 
îr‹
;

774 
uöt8_t
 *
„©uªs
;

775 
size_t
 
i
;

777 
dm
 = (
oÊ_msg_mu…ù¨t_ªque°_èbÀ_„©uªs
*Ë
	`mÆloc
((ofl_msg_multipart_request_table_features));

778 i‡(!(*
Àn
)){

779 
dm
->
èbÀs_num
 = 0;

780 
dm
->
èbÀ_„©uªs
 = 
NULL
;

781 *
msg
 = (
oÊ_msg_hódî
*Ë
dm
;

785 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_èbÀ_„©uªs
((
uöt8_t
*Ë
os
->
body
, *
Àn
, &
dm
->
èbÀs_num
);

786 i‡(
îr‹
) {

787 
	`‰ì
(
dm
);

788  
îr‹
;

790 
dm
->
èbÀ_„©uªs
 = (
oÊ_èbÀ_„©uªs
 **Ë
	`mÆloc
((oÊ_èbÀ_„©uª†*Ë* dm->
èbÀs_num
);

791 
„©uªs
 = (
uöt8_t
* ) 
os
->
body
;

793 
i
 = 0; i < 
dm
->
èbÀs_num
; i++){

794 
îr‹
 = 
	`oÊ_°ru˘s_èbÀ_„©uªs_u≈ack
((
oÂ_èbÀ_„©uªs
*Ë
„©uªs
, 
Àn
, &
dm
->
èbÀ_„©uªs
[
i
] , 
exp
);

795 
„©uªs
 +
	`¡ohs
(((
oÂ_èbÀ_„©uªs
*Ë„©uªs)->
Àngth
);

797 *
msg
 = (
oÊ_msg_hódî
 *)
dm
;

799 
	}
}

801 
oÊ_îr


802 
	$oÊ_msg_u≈ack_mu…ù¨t_ªque°_queue
(
oÂ_mu…ù¨t_ªque°
 *
os
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

803 
oÂ_queue_°©s_ªque°
 *
sm
;

804 
oÊ_msg_mu…ù¨t_ªque°_queue
 *
dm
;

808 i‡(*
Àn
 < (
oÂ_queue_°©s_ªque°
)) {

809 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived QUEUE sèt†ªque° ha†övÆidÜígth (%zu).", *
Àn
);

810  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

813 
sm
 = (
oÂ_queue_°©s_ªque°
 *)
os
->
body
;

815 i‡(
	`¡ohl
(
sm
->
p‹t_no
) == 0 ||

816 (
	`¡ohl
(
sm
->
p‹t_no
Ë> 
OFPP_MAX
 &&Çtohl(sm->p‹t_noË!
OFPP_ANY
)) {

817 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived QUEUE sèt†ªque° ha†övÆidÖ‹à(%u).", 
	`¡ohl
(
sm
->
p‹t_no
));

818  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

820 *
Àn
 -(
oÂ_queue_°©s_ªque°
);

822 
dm
 = (
oÊ_msg_mu…ù¨t_ªque°_queue
 *Ë
	`mÆloc
((ofl_msg_multipart_request_queue));

824 
dm
->
p‹t_no
 = 
	`¡ohl
(
sm
->port_no);

825 
dm
->
queue_id
 = 
	`¡ohl
(
sm
->queue_id);

827 *
msg
 = (
oÊ_msg_hódî
 *)
dm
;

829 
	}
}

831 
oÊ_îr


832 
	$oÊ_msg_u≈ack_mu…ù¨t_ªque°_group
(
oÂ_mu…ù¨t_ªque°
 *
os
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

833 
oÂ_group_°©s_ªque°
 *
sm
;

834 
oÊ_msg_mu…ù¨t_ªque°_group
 *
dm
;

838 i‡(*
Àn
 < (
oÂ_group_°©s_ªque°
)) {

839 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived GROUP sèt†ªque° ha†övÆidÜígth (%zu).", *
Àn
);

840  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

842 *
Àn
 -(
oÂ_group_°©s_ªque°
);

844 
sm
 = (
oÂ_group_°©s_ªque°
 *)
os
->
body
;

845 
dm
 = (
oÊ_msg_mu…ù¨t_ªque°_group
 *Ë
	`mÆloc
((ofl_msg_multipart_request_group));

847 
dm
->
group_id
 = 
	`¡ohl
(
sm
->group_id);

849 *
msg
 = (
oÊ_msg_hódî
 *)
dm
;

851 
	}
}

853 
oÊ_îr


854 
	$oÊ_msg_u≈ack_mëî_mu…ù¨t_ªque°
(
oÂ_mu…ù¨t_ªque°
 *
os
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

855 
oÂ_mëî_mu…ù¨t_ªque°
 *
sm
;

856 
oÊ_msg_mu…ù¨t_mëî_ªque°
 *
dm
;

860 i‡(*
Àn
 < (
oÂ_mëî_mu…ù¨t_ªque°
)) {

861 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived METER mu…ù¨àªque° ha†övÆidÜígth (%zu).", *
Àn
);

862  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

864 *
Àn
 -(
oÂ_mëî_mu…ù¨t_ªque°
);

866 
sm
 = (
oÂ_mëî_mu…ù¨t_ªque°
 *)
os
->
body
;

867 
dm
 = (
oÊ_msg_mu…ù¨t_mëî_ªque°
 *Ë
	`mÆloc
((ofl_msg_multipart_meter_request));

869 
dm
->
mëî_id
 = 
	`¡ohl
(
sm
->meter_id);

871 *
msg
 = (
oÊ_msg_hódî
 *)
dm
;

873 
	}
}

875 
oÊ_îr


876 
	$oÊ_msg_u≈ack_mu…ù¨t_ªque°
(
oÂ_hódî
 *
§c
,
uöt8_t
 *
buf
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
, 
oÊ_exp
 *
exp
) {

877 
oÊ_msg_mu…ù¨t_ªque°_hódî
 *
oÊs
;

878 
oÂ_mu…ù¨t_ªque°
 *
os
;

879 
îr‹
;

881 i‡(*
Àn
 < (
oÂ_mu…ù¨t_ªque°
)) {

882 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived STATS_REQUEST mesßgêha†övÆidÜígth (%zu).", *
Àn
);

883  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

885 *
Àn
 -(
oÂ_mu…ù¨t_ªque°
);

887 
os
 = (
oÂ_mu…ù¨t_ªque°
 *)
§c
;

889 
	`¡ohs
(
os
->
ty≥
)) {

890 
OFPMP_DESC
: {

891 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ªque°_em±y
(
os
, 
Àn
, 
msg
);

894 
OFPMP_FLOW
:

895 
OFPMP_AGGREGATE
: {

896 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ªque°_Êow
(
os
,
buf
, 
Àn
, 
msg
, 
exp
);

899 
OFPMP_TABLE
: {

900 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ªque°_em±y
(
os
, 
Àn
, 
msg
);

903 
OFPMP_TABLE_FEATURES
:{

904 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ªque°_èbÀ_„©uªs
(
os
, 
Àn
, 
msg
, 
exp
);

907 
OFPMP_PORT_STATS
: {

908 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ªque°_p‹t
(
os
, 
Àn
, 
msg
);

911 
OFPMP_QUEUE
: {

912 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ªque°_queue
(
os
, 
Àn
, 
msg
);

915 
OFPMP_GROUP
: {

916 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ªque°_group
(
os
, 
Àn
, 
msg
);

919 
OFPMP_GROUP_DESC
: {

920 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ªque°_em±y
(
os
, 
Àn
, 
msg
);

923 
OFPMP_GROUP_FEATURES
:{

924 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ªque°_em±y
(
os
, 
Àn
, 
msg
);

927 
OFPMP_METER
:

928 
OFPMP_METER_CONFIG
:{

929 
îr‹
 = 
	`oÊ_msg_u≈ack_mëî_mu…ù¨t_ªque°
(
os
, 
Àn
, 
msg
);

932 
OFPMP_METER_FEATURES
:{

933 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ªque°_em±y
(
os
, 
Àn
, 
msg
);

936 
OFPMP_PORT_DESC
: {

937 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ªque°_em±y
(
os
, 
Àn
, 
msg
);

940 
OFPMP_EXPERIMENTER
: {

941 i‡(
exp
 =
NULL
 ||Éxp->
°©s
 =NULL ||Éxp->°©s->
ª∂y_u≈ack
 == NULL) {

942 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received EXPERIMENTER statsÑequest, butÇo callback was given.");

943 
îr‹
 = 
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_MULTIPART
);

945 
îr‹
 = 
exp
->
°©s
->
	`ªq_u≈ack
(
os
, 
Àn
, (
oÊ_msg_mu…ù¨t_ªque°_hódî
 **)
msg
);

950 
îr‹
 = 
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_MULTIPART
);

954 i‡(
îr‹
) {

955  
îr‹
;

958 
oÊs
 = (
oÊ_msg_mu…ù¨t_ªque°_hódî
 *)(*
msg
);

959 
oÊs
->
ty≥
 = (
oÂ_mu…ù¨t_ty≥s
)
	`¡ohs
(
os
->type);

960 
oÊs
->
Êags
 = 
	`¡ohs
(
os
->flags);

963 
	}
}

965 
oÊ_îr


966 
	$oÊ_msg_u≈ack_ª∂y_desc
(
oÂ_mu…ù¨t_ª∂y
 *
os
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

967 
oÂ_desc
 *
sm
;

968 
oÊ_msg_ª∂y_desc
 *
dm
;

970 i‡(*
Àn
 < (
oÂ_desc
)) {

971 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived DESC sèt†ª∂y ha†övÆidÜígth (%zu).", *
Àn
);

972  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

974 *
Àn
 -(
oÂ_desc
);

976 
sm
 = (
oÂ_desc
 *)
os
->
body
;

977 
dm
 = (
oÊ_msg_ª∂y_desc
 *Ë
	`mÆloc
((ofl_msg_reply_desc));

979 
dm
->
m‰_desc
 = (*)
	`°r˝y
((*)
	`mÆloc
(
	`°æí
(
sm
->mfr_desc) + 1), sm->mfr_desc);

980 
dm
->
hw_desc
 = (*)
	`°r˝y
((*)
	`mÆloc
(
	`°æí
(
sm
->hw_desc) + 1), sm->hw_desc);

981 
dm
->
sw_desc
 = (*)
	`°r˝y
((*)
	`mÆloc
(
	`°æí
(
sm
->sw_desc) + 1), sm->sw_desc);

982 
dm
->
£rül_num
 = (*)
	`°r˝y
((*)
	`mÆloc
(
	`°æí
(
sm
->serial_num) + 1), sm->serial_num);

983 
dm
->
dp_desc
 = (*)
	`°r˝y
((*)
	`mÆloc
(
	`°æí
(
sm
->dp_desc) + 1), sm->dp_desc);

985 *
msg
 = (
oÊ_msg_hódî
 *)
dm
;

987 
	}
}

990 
oÊ_îr


991 
	$oÊ_msg_u≈ack_mu…ù¨t_ª∂y_Êow
(
oÂ_mu…ù¨t_ª∂y
 *
os
, 
uöt8_t
 *
buf
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
, 
oÊ_exp
 *
exp
) {

992 
oÂ_Êow_°©s
 *
°©
;

993 
oÊ_msg_mu…ù¨t_ª∂y_Êow
 *
dm
;

994 
oÊ_îr
 
îr‹
;

995 
size_t
 
i
, 
öi_Àn
;

996 
uöt8_t
 *
±r
;

999 
°©
 = (
oÂ_Êow_°©s
 *)
os
->
body
;

1000 
dm
 = (
oÊ_msg_mu…ù¨t_ª∂y_Êow
 *)
	`mÆloc
((ofl_msg_multipart_reply_flow));

1002 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_Êow_°©s
(
°©
, *
Àn
, &
dm
->
°©s_num
);

1003 i‡(
îr‹
) {

1004 
	`‰ì
(
dm
);

1005  
îr‹
;

1007 
dm
->
°©s
 = (
oÊ_Êow_°©s
 **)
	`mÆloc
(dm->
°©s_num
 * (ofl_flow_stats *));

1009 
öi_Àn
 = *
Àn
;

1010 
±r
 = 
buf
 + (
oÂ_mu…ù¨t_ª∂y
);

1011 
i
 = 0; i < 
dm
->
°©s_num
; i++) {

1012 
îr‹
 = 
	`oÊ_°ru˘s_Êow_°©s_u≈ack
(
°©
, 
±r
, 
Àn
, &(
dm
->
°©s
[
i
]), 
exp
);

1013 
±r
 +
öi_Àn
 - *
Àn
;

1014 
öi_Àn
 = *
Àn
;

1015 i‡(
îr‹
) {

1016 
	`OFL_UTILS_FREE_ARR_FUN2
(
dm
->
°©s
, 
i
,

1017 
oÊ_°ru˘s_‰ì_Êow_°©s
, 
exp
);

1018 
	`‰ì
 (
dm
);

1019  
îr‹
;

1021 
°©
 = (
oÂ_Êow_°©s
 *)((
uöt8_t
 *)°© + 
	`¡ohs
(°©->
Àngth
));

1024 *
msg
 = (
oÊ_msg_hódî
 *)
dm
;

1026 
	}
}

1028 
oÊ_îr


1029 
	$oÊ_msg_u≈ack_mu…ù¨t_ª∂y_aggªg©e
(
oÂ_mu…ù¨t_ª∂y
 *
os
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

1030 
oÂ_aggªg©e_°©s_ª∂y
 *
sm
;

1031 
oÊ_msg_mu…ù¨t_ª∂y_aggªg©e
 *
dm
;

1035 i‡(*
Àn
 < (
oÂ_aggªg©e_°©s_ª∂y
)) {

1036 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived AGGREGATE sèt†ª∂y ha†övÆidÜígth (%zu).", *
Àn
);

1037  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

1039 *
Àn
 -(
oÂ_aggªg©e_°©s_ª∂y
);

1041 
sm
 = (
oÂ_aggªg©e_°©s_ª∂y
 *)
os
->
body
;

1042 
dm
 = (
oÊ_msg_mu…ù¨t_ª∂y_aggªg©e
 *Ë
	`mÆloc
((ofl_msg_multipart_reply_aggregate));

1044 
dm
->
∑ckë_cou¡
 = 
	`¡oh64
(
sm
->packet_count);

1045 
dm
->
byã_cou¡
 = 
	`¡oh64
(
sm
->byte_count);

1046 
dm
->
Êow_cou¡
 = 
	`¡ohl
–
sm
->flow_count);

1048 *
msg
 = (
oÊ_msg_hódî
 *)
dm
;

1050 
	}
}

1052 
oÊ_îr


1053 
	$oÊ_msg_u≈ack_mu…ù¨t_ª∂y_èbÀ
(
oÂ_mu…ù¨t_ª∂y
 *
os
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

1054 
oÂ_èbÀ_°©s
 *
°©
;

1055 
oÊ_msg_mu…ù¨t_ª∂y_èbÀ
 *
dm
;

1056 
oÊ_îr
 
îr‹
;

1057 
size_t
 
i
;

1061 
°©
 = (
oÂ_èbÀ_°©s
 *)
os
->
body
;

1062 
dm
 = (
oÊ_msg_mu…ù¨t_ª∂y_èbÀ
 *Ë
	`mÆloc
((ofl_msg_multipart_reply_table));

1064 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_èbÀ_°©s
(
°©
, *
Àn
, &
dm
->
°©s_num
);

1065 i‡(
îr‹
) {

1066 
	`‰ì
(
dm
);

1067  
îr‹
;

1069 
dm
->
°©s
 = (
oÊ_èbÀ_°©s
 **)
	`mÆloc
(dm->
°©s_num
 * (ofl_table_stats *));

1071 
i
 = 0; i < 
dm
->
°©s_num
; i++) {

1072 
îr‹
 = 
	`oÊ_°ru˘s_èbÀ_°©s_u≈ack
(
°©
, 
Àn
, &(
dm
->
°©s
[
i
]));

1073 i‡(
îr‹
) {

1074 
	`OFL_UTILS_FREE_ARR
(
dm
->
°©s
, 
i
);

1075 
	`‰ì
(
dm
);

1076  
îr‹
;

1078 
°©
 = (
oÂ_èbÀ_°©s
 *)((
uöt8_t
 *)stat + (ofp_table_stats));

1081 *
msg
 = (
oÊ_msg_hódî
 *)
dm
;

1083 
	}
}

1085 
oÊ_îr


1086 
	$oÊ_msg_u≈ack_mu…ù¨t_ª∂y_p‹t
(
oÂ_mu…ù¨t_ª∂y
 *
os
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

1087 
oÂ_p‹t_°©s
 *
°©
 = (oÂ_p‹t_°©†*)
os
->
body
;

1088 
oÊ_msg_mu…ù¨t_ª∂y_p‹t
 *
dm
 = (oÊ_msg_mu…ù¨t_ª∂y_p‹à*Ë
	`mÆloc
((ofl_msg_multipart_reply_port));

1089 
oÊ_îr
 
îr‹
;

1090 
size_t
 
i
;

1094 
°©
 = (
oÂ_p‹t_°©s
 *)
os
->
body
;

1095 
dm
 = (
oÊ_msg_mu…ù¨t_ª∂y_p‹t
 *Ë
	`mÆloc
((ofl_msg_multipart_reply_port));

1097 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_p‹t_°©s
(
°©
, *
Àn
, &
dm
->
°©s_num
);

1098 i‡(
îr‹
) {

1099 
	`‰ì
(
dm
);

1100  
îr‹
;

1103 
dm
->
°©s
 = (
oÊ_p‹t_°©s
 **)
	`mÆloc
(dm->
°©s_num
 * (ofl_port_stats *));

1105 
i
 = 0; i < 
dm
->
°©s_num
; i++) {

1106 
îr‹
 = 
	`oÊ_°ru˘s_p‹t_°©s_u≈ack
(
°©
, 
Àn
, &(
dm
->
°©s
[
i
]));

1107 i‡(
îr‹
) {

1108 
	`OFL_UTILS_FREE_ARR
(
dm
->
°©s
, 
i
);

1109 
	`‰ì
(
dm
);

1110  
îr‹
;

1112 
°©
 = (
oÂ_p‹t_°©s
 *)((
uöt8_t
 *)stat + (ofp_port_stats));

1115 *
msg
 = (
oÊ_msg_hódî
 *)
dm
;

1117 
	}
}

1119 
oÊ_îr


1120 
	$oÊ_msg_u≈ack_mu…ù¨t_ª∂y_queue
(
oÂ_mu…ù¨t_ª∂y
 *
os
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

1121 
oÂ_queue_°©s
 *
°©
 = (oÂ_queue_°©†*)
os
->
body
;

1122 
oÊ_msg_mu…ù¨t_ª∂y_queue
 *
dm
 = (oÊ_msg_mu…ù¨t_ª∂y_queuê*Ë
	`mÆloc
((ofl_msg_multipart_reply_queue));

1123 
oÊ_îr
 
îr‹
;

1124 
size_t
 
i
;

1128 
°©
 = (
oÂ_queue_°©s
 *)
os
->
body
;

1129 
dm
 = (
oÊ_msg_mu…ù¨t_ª∂y_queue
 *Ë
	`mÆloc
((ofl_msg_multipart_reply_queue));

1131 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_queue_°©s
(
°©
, *
Àn
, &
dm
->
°©s_num
);

1132 i‡(
îr‹
) {

1133 
	`‰ì
(
dm
);

1134  
îr‹
;

1136 
dm
->
°©s
 = (
oÊ_queue_°©s
 **)
	`mÆloc
(dm->
°©s_num
 * (ofl_queue_stats *));

1137 
i
 = 0; i < 
dm
->
°©s_num
; i++) {

1138 
îr‹
 = 
	`oÊ_°ru˘s_queue_°©s_u≈ack
(
°©
, 
Àn
, &(
dm
->
°©s
[
i
]));

1139 i‡(
îr‹
) {

1140 
	`OFL_UTILS_FREE_ARR
(
dm
->
°©s
, 
i
);

1141 
	`‰ì
(
dm
);

1142  
îr‹
;

1144 
°©
 = (
oÂ_queue_°©s
 *)((
uöt8_t
 *)stat + (ofp_queue_stats));

1147 *
msg
 = (
oÊ_msg_hódî
 *)
dm
;

1149 
	}
}

1151 
oÊ_îr


1152 
	$oÊ_msg_u≈ack_mu…ù¨t_ª∂y_group
(
oÂ_mu…ù¨t_ª∂y
 *
os
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

1153 
oÂ_group_°©s
 *
°©
;

1154 
oÊ_msg_mu…ù¨t_ª∂y_group
 *
dm
;

1155 
oÊ_îr
 
îr‹
;

1156 
size_t
 
i
;

1160 
°©
 = (
oÂ_group_°©s
 *)
os
->
body
;

1161 
dm
 = (
oÊ_msg_mu…ù¨t_ª∂y_group
 *Ë
	`mÆloc
((ofl_msg_multipart_reply_group));

1163 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_group_°©s
(
°©
, *
Àn
, &
dm
->
°©s_num
);

1164 i‡(
îr‹
) {

1165 
	`‰ì
(
dm
);

1166  
îr‹
;

1168 
dm
->
°©s
 = (
oÊ_group_°©s
 **)
	`mÆloc
(dm->
°©s_num
 * (ofl_group_stats *));

1170 
i
 = 0; i < 
dm
->
°©s_num
; i++) {

1171 
îr‹
 = 
	`oÊ_°ru˘s_group_°©s_u≈ack
(
°©
, 
Àn
, &(
dm
->
°©s
[
i
]));

1172 i‡(
îr‹
) {

1173 
	`OFL_UTILS_FREE_ARR_FUN
(
dm
->
°©s
, 
i
,

1174 
oÊ_°ru˘s_‰ì_group_°©s
);

1175 
	`‰ì
 (
dm
);

1176  
îr‹
;

1178 
°©
 = (
oÂ_group_°©s
 *)((
uöt8_t
 *)°© + 
	`¡ohs
(°©->
Àngth
));

1181 *
msg
 = (
oÊ_msg_hódî
 *)
dm
;

1183 
	}
}

1185 
oÊ_îr


1186 
	$oÊ_msg_u≈ack_mu…ù¨t_ª∂y_group_desc
(
oÂ_mu…ù¨t_ª∂y
 *
os
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
, 
oÊ_exp
 *
exp
) {

1187 
oÂ_group_desc_°©s
 *
°©
;

1188 
oÊ_msg_mu…ù¨t_ª∂y_group_desc
 *
dm
;

1189 
oÊ_îr
 
îr‹
;

1190 
size_t
 
i
;

1194 
°©
 = (
oÂ_group_desc_°©s
 *)
os
->
body
;

1195 
dm
 = (
oÊ_msg_mu…ù¨t_ª∂y_group_desc
 *Ë
	`mÆloc
((ofl_msg_multipart_reply_group_desc));

1197 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_group_desc_°©s
(
°©
, *
Àn
, &
dm
->
°©s_num
);

1198 i‡(
îr‹
) {

1199 
	`‰ì
(
dm
);

1200  
îr‹
;

1202 
dm
->
°©s
 = (
oÊ_group_desc_°©s
 **)
	`mÆloc
(dm->
°©s_num
 * (ofl_group_desc_stats *));

1204 
i
 = 0; i < 
dm
->
°©s_num
; i++) {

1205 
îr‹
 = 
	`oÊ_°ru˘s_group_desc_°©s_u≈ack
(
°©
, 
Àn
, &(
dm
->
°©s
[
i
]), 
exp
);

1206 i‡(
îr‹
) {

1207 
	`OFL_UTILS_FREE_ARR_FUN2
(
dm
->
°©s
, 
i
,

1208 
oÊ_°ru˘s_‰ì_group_desc_°©s
, 
exp
);

1209 
	`‰ì
 (
dm
);

1210  
îr‹
;

1212 
°©
 = (
oÂ_group_desc_°©s
 *)((
uöt8_t
 *)°© + 
	`¡ohs
(°©->
Àngth
));

1215 *
msg
 = (
oÊ_msg_hódî
 *)
dm
;

1217 
	}
}

1219 
oÊ_îr


1220 
	$oÊ_msg_u≈ack_mu…ù¨t_ª∂y_group_„©uªs
(
oÂ_mu…ù¨t_ª∂y
 *
os
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

1221 
oÂ_group_„©uªs_°©s
 *
sm
;

1222 
oÊ_msg_mu…ù¨t_ª∂y_group_„©uªs
 *
dm
;

1223 
i
;

1224 i‡(*
Àn
 < (
oÂ_group_„©uªs_°©s
)) {

1225 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived OFPMP_GROUP_FEATURES sèt†ª∂y ha†övÆidÜígth (%zu).", *
Àn
);

1226  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

1228 *
Àn
 -(
oÂ_group_„©uªs_°©s
);

1230 
sm
 = (
oÂ_group_„©uªs_°©s
 *)
os
->
body
;

1231 
dm
 = (
oÊ_msg_mu…ù¨t_ª∂y_group_„©uªs
 *Ë
	`mÆloc
((ofl_msg_multipart_reply_group_features));

1233 
dm
->
ty≥s
 = 
	`¡ohl
(
sm
->types);

1234 
dm
->
ˇ∑bûôõs
 = 
	`¡ohl
(
sm
->capabilities);

1235 
i
 = 0; i < 4; i++){

1236 
dm
->
max_groups
[
i
] = 
	`¡ohl
(
sm
->max_groups[i]);

1237 
dm
->
a˘i⁄s
[
i
] = 
	`¡ohl
(
sm
->actions[i]);

1240 *
msg
 = (
oÊ_msg_hódî
 *)
dm
;

1242 
	}
}

1244 
oÊ_îr


1245 
	$oÊ_msg_u≈ack_mu…ù¨t_ª∂y_èbÀ_„©uªs
(
oÂ_mu…ù¨t_ª∂y
 *
§c
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
, 
oÊ_exp
 *
exp
){

1246 
oÊ_msg_mu…ù¨t_ª∂y_èbÀ_„©uªs
 *
dm
;

1247 
i
;

1248 
oÊ_îr
 
îr‹
;

1249 
uöt8_t
 *
„©uªs
;

1251 
dm
 = (
oÊ_msg_mu…ù¨t_ª∂y_èbÀ_„©uªs
*Ë
	`mÆloc
((ofl_msg_multipart_reply_table_features) );

1253 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_èbÀ_„©uªs
((
uöt8_t
*Ë
§c
->
body
, *
Àn
, &
dm
->
èbÀs_num
);

1254 i‡(
îr‹
) {

1255 
	`‰ì
(
dm
);

1256  
îr‹
;

1258 
dm
->
èbÀ_„©uªs
 = (
oÊ_èbÀ_„©uªs
 **Ë
	`mÆloc
((oÊ_èbÀ_„©uª†*Ë* dm->
èbÀs_num
);

1259 
„©uªs
 = (
uöt8_t
* ) 
§c
->
body
;

1261 
i
 = 0; i < 
dm
->
èbÀs_num
; i++){

1262 
îr‹
 = 
	`oÊ_°ru˘s_èbÀ_„©uªs_u≈ack
((
oÂ_èbÀ_„©uªs
*Ë
„©uªs
, 
Àn
, &
dm
->
èbÀ_„©uªs
[
i
] , 
exp
);

1263 
„©uªs
 +
	`¡ohs
(((
oÂ_èbÀ_„©uªs
*Ë„©uªs)->
Àngth
);

1265 *
msg
 = (
oÊ_msg_hódî
 *)
dm
;

1267 
	}
}

1269 
oÊ_îr


1270 
	$oÊ_msg_u≈ack_mu…ù¨t_ª∂y_mëî_°©s
(
oÂ_mu…ù¨t_ª∂y
 *
os
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

1271 
oÂ_mëî_°©s
 *
°©
;

1272 
oÊ_msg_mu…ù¨t_ª∂y_mëî
 *
dm
;

1273 
oÊ_îr
 
îr‹
;

1274 
size_t
 
i
;

1278 
°©
 = (
oÂ_mëî_°©s
 *)
os
->
body
;

1279 
dm
 = (
oÊ_msg_mu…ù¨t_ª∂y_mëî
 *Ë
	`mÆloc
((ofl_msg_multipart_reply_meter));

1281 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_mëî_°©s
(
°©
, *
Àn
, &
dm
->
°©s_num
);

1282 i‡(
îr‹
) {

1283 
	`‰ì
(
dm
);

1284  
îr‹
;

1286 
dm
->
°©s
 = (
oÊ_mëî_°©s
 **)
	`mÆloc
(dm->
°©s_num
 * (ofl_meter_stats *));

1288 
i
 = 0; i < 
dm
->
°©s_num
; i++) {

1289 
îr‹
 = 
	`oÊ_°ru˘s_mëî_°©s_u≈ack
(
°©
, 
Àn
, &(
dm
->
°©s
[
i
]));

1290 i‡(
îr‹
) {

1291 
	`OFL_UTILS_FREE_ARR_FUN
(
dm
->
°©s
, 
i
,

1292 
oÊ_°ru˘s_‰ì_mëî_°©s
);

1293 
	`‰ì
 (
dm
);

1294  
îr‹
;

1296 
°©
 = (
oÂ_mëî_°©s
 *)((
uöt8_t
 *)°© + 
	`¡ohs
(°©->
Àn
));

1299 *
msg
 = (
oÊ_msg_hódî
 *)
dm
;

1301 
	}
}

1303 
oÊ_îr


1304 
	$oÊ_msg_u≈ack_mu…ù¨t_ª∂y_mëî_c⁄fig
(
oÂ_mu…ù¨t_ª∂y
 *
os
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
){

1305 
oÂ_mëî_c⁄fig
 *
c⁄f
;

1306 
oÊ_msg_mu…ù¨t_ª∂y_mëî_c⁄f
 *
dm
;

1307 
oÊ_îr
 
îr‹
;

1308 
size_t
 
i
;

1310 
c⁄f
 = (
oÂ_mëî_c⁄fig
*Ë
os
->
body
;

1311 
dm
 = (
oÊ_msg_mu…ù¨t_ª∂y_mëî_c⁄f
 *Ë
	`mÆloc
((ofl_msg_multipart_reply_meter_conf));

1313 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_mëî_c⁄fig
(
c⁄f
, *
Àn
, &
dm
->
°©s_num
);

1314 i‡(
îr‹
) {

1315 
	`‰ì
(
dm
);

1316  
îr‹
;

1319 
dm
->
°©s
 = (
oÊ_mëî_c⁄fig
 **)
	`mÆloc
(dm->
°©s_num
 * (ofl_meter_config *));

1321 
i
 = 0; i < 
dm
->
°©s_num
; i++) {

1322 
îr‹
 = 
	`oÊ_°ru˘s_mëî_c⁄fig_u≈ack
(
c⁄f
, 
Àn
, &(
dm
->
°©s
[
i
]));

1323 i‡(
îr‹
) {

1324 
	`OFL_UTILS_FREE_ARR_FUN
(
dm
->
°©s
, 
i
,

1325 
oÊ_°ru˘s_‰ì_mëî_c⁄fig
);

1326 
	`‰ì
 (
dm
);

1327  
îr‹
;

1329 
c⁄f
 = (
oÂ_mëî_c⁄fig
 *)((
uöt8_t
 *)c⁄‡+ 
	`¡ohs
(c⁄f->
Àngth
));

1333 *
msg
 = (
oÊ_msg_hódî
*Ë
dm
;

1335 
	}
}

1337 
oÊ_îr


1338 
	$oÊ_msg_u≈ack_mu…ù¨t_ª∂y_p‹t_desc
(
oÂ_mu…ù¨t_ª∂y
 *
§c
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

1339 
oÂ_p‹t
 *
p‹t
;

1340 
oÊ_msg_mu…ù¨t_ª∂y_p‹t_desc
 *
pd
;

1341 
oÊ_îr
 
îr‹
;

1342 
size_t
 
i
;

1343 
p‹t
 = (
oÂ_p‹t
* )
§c
->
body
;

1344 
pd
 = (
oÊ_msg_mu…ù¨t_ª∂y_p‹t_desc
*Ë
	`mÆloc
((ofl_msg_multipart_reply_port_desc));

1346 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_p‹ts
(
p‹t
, *
Àn
, &
pd
->
°©s_num
);

1347 i‡(
îr‹
) {

1348 
	`‰ì
(
pd
);

1349  
îr‹
;

1352 
pd
->
°©s
 = (
oÊ_p‹t
**Ë
	`mÆloc
’d->
°©s_num
 * (ofl_port));

1353 
i
 = 0; i < 
pd
->
°©s_num
; i++){

1354 
îr‹
 = 
	`oÊ_°ru˘s_p‹t_u≈ack
(
p‹t
, 
Àn
, &
pd
->
°©s
[
i
]);

1355 i‡(
îr‹
) {

1356 
	`OFL_UTILS_FREE_ARR_FUN
(
pd
->
°©s
, 
i
,

1357 
oÊ_°ru˘s_‰ì_p‹t
);

1358 
	`‰ì
 (
pd
);

1359  
îr‹
;

1361 
p‹t
 = (
oÂ_p‹t
 *)((
uöt8_t
 *)port + (ofp_port));

1363 *
msg
 = (
oÊ_msg_hódî
 *)
pd
;

1365 
	}
}

1367 
oÊ_îr


1368 
	$oÊ_msg_u≈ack_mu…ù¨t_ª∂y_mëî_„©uªs
(
oÂ_mu…ù¨t_ª∂y
 *
os
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

1369 
oÂ_mëî_„©uªs
 *
§c
;

1370 
oÊ_msg_mu…ù¨t_ª∂y_mëî_„©uªs
 *
d°
;

1372 if(*
Àn
 < (
oÂ_mëî_„©uªs
)){

1373 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived MULTIPART REPLY mesßgêha†övÆidÜígth (%zu).", *
Àn
);

1374  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

1377 *
Àn
 -(
oÂ_mëî_„©uªs
);

1378 
§c
 = (
oÂ_mëî_„©uªs
*Ë
os
->
body
;

1379 
d°
 = (
oÊ_msg_mu…ù¨t_ª∂y_mëî_„©uªs
*Ë
	`mÆloc
((ofl_msg_multipart_reply_meter_features));

1380 
d°
->
„©uªs
 = (
oÊ_mëî_„©uªs
*Ë
	`mÆloc
((ofl_meter_features));

1382 
d°
->
„©uªs
->
max_mëî
 = 
	`¡ohl
(
§c
->max_meter);

1383 
d°
->
„©uªs
->
b™d_ty≥s
 = 
	`¡ohl
(
§c
->band_types);

1384 
d°
->
„©uªs
->
ˇ∑bûôõs
 = 
	`¡ohl
(
§c
->capabilities);

1385 
d°
->
„©uªs
->
max_b™ds
 = 
§c
->max_bands;

1386 
d°
->
„©uªs
->
max_cﬁ‹
 = 
§c
->max_color;

1388 *
msg
 = (
oÊ_msg_hódî
*Ë
d°
;

1390 
	}
}

1392 
oÊ_îr


1393 
	$oÊ_msg_u≈ack_mu…ù¨t_ª∂y
(
oÂ_hódî
 *
§c
, 
uöt8_t
 *
buf
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
, 
oÊ_exp
 *
exp
) {

1394 
oÊ_msg_mu…ù¨t_ª∂y_hódî
 *
oÊs
;

1395 
oÂ_mu…ù¨t_ª∂y
 *
os
;

1396 
îr‹
;

1398 i‡(*
Àn
 < (
oÂ_mu…ù¨t_ª∂y
)) {

1399 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived MULTIPART REPLY mesßgêha†övÆidÜígth (%zu).", *
Àn
);

1400  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

1402 *
Àn
 -(
oÂ_mu…ù¨t_ª∂y
);

1403 
os
 = (
oÂ_mu…ù¨t_ª∂y
 *)
§c
;

1404 
	`¡ohs
(
os
->
ty≥
)) {

1405 
OFPMP_DESC
: {

1406 
îr‹
 = 
	`oÊ_msg_u≈ack_ª∂y_desc
(
os
, 
Àn
, 
msg
);

1409 
OFPMP_FLOW
: {

1410 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ª∂y_Êow
(
os
,
buf
, 
Àn
, 
msg
, 
exp
);

1413 
OFPMP_AGGREGATE
: {

1414 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ª∂y_aggªg©e
(
os
, 
Àn
, 
msg
);

1417 
OFPMP_TABLE
: {

1418 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ª∂y_èbÀ
(
os
, 
Àn
, 
msg
);

1421 
OFPMP_TABLE_FEATURES
: {

1422 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ª∂y_èbÀ_„©uªs
(
os
, 
Àn
, 
msg
, 
exp
);

1425 
OFPMP_PORT_STATS
: {

1426 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ª∂y_p‹t
(
os
, 
Àn
, 
msg
);

1429 
OFPMP_QUEUE
: {

1430 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ª∂y_queue
(
os
, 
Àn
, 
msg
);

1433 
OFPMP_GROUP
: {

1434 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ª∂y_group
(
os
, 
Àn
, 
msg
);

1437 
OFPMP_GROUP_DESC
: {

1438 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ª∂y_group_desc
(
os
, 
Àn
, 
msg
, 
exp
);

1441 
OFPMP_GROUP_FEATURES
:{

1442 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ª∂y_group_„©uªs
(
os
, 
Àn
, 
msg
);

1445 
OFPMP_METER
:{

1446 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ª∂y_mëî_°©s
(
os
, 
Àn
, 
msg
);

1449 
OFPMP_METER_CONFIG
:{

1450 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ª∂y_mëî_c⁄fig
(
os
, 
Àn
, 
msg
);

1453 
OFPMP_METER_FEATURES
:{

1454 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ª∂y_mëî_„©uªs
(
os
, 
Àn
, 
msg
);

1457 
OFPMP_PORT_DESC
:{

1458 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ª∂y_p‹t_desc
(
os
, 
Àn
, 
msg
);

1461 
OFPMP_EXPERIMENTER
: {

1462 i‡(
exp
 =
NULL
 ||Éxp->
°©s
 =NULL ||Éxp->°©s->
ª∂y_u≈ack
 == NULL) {

1463 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received EXPERIMENTER statsÑeply, butÇo callback was given.");

1464 
îr‹
 = 
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_MULTIPART
);

1466 
îr‹
 = 
exp
->
°©s
->
	`ª∂y_u≈ack
(
os
, 
Àn
, (
oÊ_msg_mu…ù¨t_ª∂y_hódî
 **)
msg
);

1471 
îr‹
 = 
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_MULTIPART
);

1475 i‡(
îr‹
) {

1476  
îr‹
;

1479 
oÊs
 = (
oÊ_msg_mu…ù¨t_ª∂y_hódî
 *)(*
msg
);

1480 
oÊs
->
ty≥
 = (
oÂ_mu…ù¨t_ty≥s
)
	`¡ohs
(
os
->type);

1481 
oÊs
->
Êags
 = 
	`¡ohs
(
os
->flags);

1484 
	}
}

1486 
oÊ_îr


1487 
	$oÊ_msg_u≈ack_queue_gë_c⁄fig_ªque°
(
oÂ_hódî
 *
§c
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

1488 
oÂ_queue_gë_c⁄fig_ªque°
 *
§
;

1489 
oÊ_msg_queue_gë_c⁄fig_ªque°
 *
dr
;

1491 i‡(*
Àn
 < (
oÂ_group_desc_°©s
)) {

1492 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived GET_CONFIG_REQUEST mesßgêha†övÆidÜígth (%zu).", *
Àn
);

1493  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

1496 
§
 = (
oÂ_queue_gë_c⁄fig_ªque°
 *)
§c
;

1498 i‡(
	`¡ohl
(
§
->
p‹t
Ë=0 ||Çtohl(§->p‹tË> 
OFPP_ANY
) {

1499 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived GET_CONFIG_REQUEST mesßgêha†övÆidÖ‹à(%u).", 
	`¡ohl
(
§
->
p‹t
));

1500  
	`oÊ_îr‹
(
OFPET_QUEUE_OP_FAILED
, 
OFPQOFC_BAD_PORT
);

1502 *
Àn
 -(
oÂ_queue_gë_c⁄fig_ªque°
);

1504 
dr
 = (
oÊ_msg_queue_gë_c⁄fig_ªque°
 *)
	`mÆloc
((ofl_msg_queue_get_config_request));

1506 
dr
->
p‹t
 = 
	`¡ohl
(
§
->port);

1508 *
msg
 = (
oÊ_msg_hódî
 *)
dr
;

1510 
	}
}

1512 
oÊ_îr


1513 
	$oÊ_msg_u≈ack_queue_gë_c⁄fig_ª∂y
(
oÂ_hódî
 *
§c
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

1514 
oÂ_queue_gë_c⁄fig_ª∂y
 *
§
;

1515 
oÊ_msg_queue_gë_c⁄fig_ª∂y
 *
dr
;

1516 
oÂ_∑ckë_queue
 *
queue
;

1517 
oÊ_îr
 
îr‹
;

1518 
size_t
 
i
;

1520 i‡(*
Àn
 < (
oÂ_queue_gë_c⁄fig_ª∂y
)) {

1521 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived GET_CONFIG_REPLY ha†övÆidÜígth (%zu).", *
Àn
);

1522  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

1524 *
Àn
 -(
oÂ_queue_gë_c⁄fig_ª∂y
);

1526 
§
 = (
oÂ_queue_gë_c⁄fig_ª∂y
 *)
§c
;

1527 
dr
 = (
oÊ_msg_queue_gë_c⁄fig_ª∂y
 *)
	`mÆloc
((ofl_msg_queue_get_config_reply));

1529 
dr
->
p‹t
 = 
	`¡ohl
(
§
->port);

1531 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_∑ckë_queues
(&(
§
->
queues
), *
Àn
, &
dr
->
queues_num
);

1532 i‡(
îr‹
) {

1533 
	`‰ì
(
dr
);

1534  
îr‹
;

1536 
dr
->
queues
 = (
oÊ_∑ckë_queue
 **)
	`mÆloc
(dr->
queues_num
 * (ofl_packet_queue *));

1538 
queue
 = 
§
->
queues
;

1539 
i
 = 0; i < 
dr
->
queues_num
; i++) {

1540 
îr‹
 = 
	`oÊ_°ru˘s_∑ckë_queue_u≈ack
(
queue
, 
Àn
, &(
dr
->
queues
[
i
]));

1541 i‡(
îr‹
) {

1542 
	`OFL_UTILS_FREE_ARR_FUN
(
dr
->
queues
, 
i
,

1543 
oÊ_°ru˘s_‰ì_∑ckë_queue
);

1544 
	`‰ì
 (
dr
);

1545  
îr‹
;

1547 
queue
 = (
oÂ_∑ckë_queue
 *)((
uöt8_t
 *)queuê+ 
	`¡ohs
(queue->
Àn
));

1550 *
msg
 = (
oÊ_msg_hódî
 *)
dr
;

1552 
	}
}

1555 
oÊ_îr


1556 
	$oÊ_msg_u≈ack_em±y
(
oÂ_hódî
 *
§c
 
UNUSED
, 
size_t
 *
Àn
, 
oÊ_msg_hódî
 **
msg
) {

1558 *
Àn
 -(
oÂ_hódî
);

1560 *
msg
 = (
oÊ_msg_hódî
 *)
	`mÆloc
((ofl_msg_header));

1562 
	}
}

1565 
oÊ_îr


1566 
	$oÊ_msg_u≈ack
(
uöt8_t
 *
buf
, 
size_t
 
buf_Àn
, 
oÊ_msg_hódî
 **
msg
, 
uöt32_t
 *
xid
, 
oÊ_exp
 *
exp
) {

1567 
oÂ_hódî
 *
oh
;

1568 
size_t
 
Àn
 = 
buf_Àn
;

1569 
oÊ_îr
 
îr‹
 = 0;

1570 i‡(
Àn
 < (
oÂ_hódî
)) {

1571 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received message is shorterÅhan ofp_header.");

1572 i‡(
xid
 !
NULL
) {

1573 *
xid
 = 0x00000000;

1575  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

1578 
oh
 = (
oÂ_hódî
 *)
buf
;

1580 i‡(
oh
->
vîsi⁄
 !
OFP_VERSION
) {

1581 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received message has wrong version.");

1582  
	`oÊ_îr‹
(
OFPET_HELLO_FAILED
, 
OFPHFC_INCOMPATIBLE
);

1585 i‡(
xid
 !
NULL
) {

1586 *
xid
 = 
	`¡ohl
(
oh
->xid);

1589 i‡(
Àn
 !
	`¡ohs
(
oh
->
Àngth
)) {

1590 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received messageÜength doesÇot matchÅheÜength field.");

1591  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

1594 
oh
->
ty≥
) {

1595 
OFPT_HELLO
:

1596 
îr‹
 = 
	`oÊ_msg_u≈ack_em±y
(
oh
, &
Àn
, 
msg
);

1598 
OFPT_ERROR
:

1599 
îr‹
 = 
	`oÊ_msg_u≈ack_îr‹
(
oh
, &
Àn
, 
msg
);

1601 
OFPT_ECHO_REQUEST
:

1602 
OFPT_ECHO_REPLY
:

1603 
îr‹
 = 
	`oÊ_msg_u≈ack_echo
(
oh
, &
Àn
, 
msg
);

1605 
OFPT_EXPERIMENTER
:

1606 i‡(
exp
 =
NULL
 ||Éxp->
msg
 =NULL ||Éxp->msg->
u≈ack
 == NULL) {

1607 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received EXPERIMENTER message, butÇo callback was given.");

1608 
îr‹
 = 
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_EXPERIMENTER
);

1610 
îr‹
 = 
exp
->
msg
->
	`u≈ack
(
oh
, &
Àn
, (
oÊ_msg_ex≥rimíãr
 **)msg);

1615 
OFPT_FEATURES_REQUEST
:

1616 
îr‹
 = 
	`oÊ_msg_u≈ack_em±y
(
oh
, &
Àn
, 
msg
);

1618 
OFPT_FEATURES_REPLY
:

1619 
îr‹
 = 
	`oÊ_msg_u≈ack_„©uªs_ª∂y
(
oh
, &
Àn
, 
msg
);

1621 
OFPT_GET_CONFIG_REQUEST
:

1622 
îr‹
 = 
	`oÊ_msg_u≈ack_em±y
(
oh
, &
Àn
, 
msg
);

1624 
OFPT_GET_CONFIG_REPLY
:

1625 
îr‹
 = 
	`oÊ_msg_u≈ack_gë_c⁄fig_ª∂y
(
oh
, &
Àn
, 
msg
);

1627 
OFPT_SET_CONFIG
:

1628 
îr‹
 = 
	`oÊ_msg_u≈ack_£t_c⁄fig
(
oh
, &
Àn
, 
msg
);

1632 
OFPT_PACKET_IN
:

1633 
îr‹
 = 
	`oÊ_msg_u≈ack_∑ckë_ö
(
oh
,
buf
, &
Àn
, 
msg
);

1635 
OFPT_FLOW_REMOVED
:

1636 
îr‹
 = 
	`oÊ_msg_u≈ack_Êow_ªmoved
(
oh
,
buf
, &
Àn
, 
msg
, 
exp
);

1638 
OFPT_PORT_STATUS
:

1639 
îr‹
 = 
	`oÊ_msg_u≈ack_p‹t_°©us
(
oh
, &
Àn
, 
msg
);

1643 
OFPT_GET_ASYNC_REQUEST
:

1644 
îr‹
 = 
	`oÊ_msg_u≈ack_em±y
(
oh
, &
Àn
, 
msg
);

1646 
OFPT_GET_ASYNC_REPLY
:

1647 
OFPT_SET_ASYNC
:{

1648 
îr‹
 = 
	`oÊ_msg_u≈ack_async_c⁄fig
(
oh
, &
Àn
, 
msg
);

1651 
OFPT_PACKET_OUT
:

1652 
îr‹
 = 
	`oÊ_msg_u≈ack_∑ckë_out
(
oh
, &
Àn
, 
msg
, 
exp
);

1654 
OFPT_FLOW_MOD
:

1655 
îr‹
 = 
	`oÊ_msg_u≈ack_Êow_mod
(
oh
,
buf
, &
Àn
, 
msg
, 
exp
);

1657 
OFPT_GROUP_MOD
:

1658 
îr‹
 = 
	`oÊ_msg_u≈ack_group_mod
(
oh
, &
Àn
, 
msg
, 
exp
);

1660 
OFPT_PORT_MOD
:

1661 
îr‹
 = 
	`oÊ_msg_u≈ack_p‹t_mod
(
oh
, &
Àn
, 
msg
);

1663 
OFPT_TABLE_MOD
:

1664 
îr‹
 = 
	`oÊ_msg_u≈ack_èbÀ_mod
(
oh
, &
Àn
, 
msg
);

1668 
OFPT_MULTIPART_REQUEST
:

1669 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ªque°
(
oh
,
buf
, &
Àn
, 
msg
, 
exp
);

1671 
OFPT_MULTIPART_REPLY
:

1672 
îr‹
 = 
	`oÊ_msg_u≈ack_mu…ù¨t_ª∂y
(
oh
,
buf
, &
Àn
, 
msg
, 
exp
);

1676 
OFPT_BARRIER_REQUEST
:

1677 
OFPT_BARRIER_REPLY
:

1678 
îr‹
 = 
	`oÊ_msg_u≈ack_em±y
(
oh
, &
Àn
, 
msg
);

1682 
OFPT_ROLE_REQUEST
:

1683 
OFPT_ROLE_REPLY
:

1684 
îr‹
 = 
	`oÊ_msg_u≈ack_rﬁe_ªque°
(
oh
, &
Àn
, 
msg
);

1688 
OFPT_QUEUE_GET_CONFIG_REQUEST
:

1689 
îr‹
 = 
	`oÊ_msg_u≈ack_queue_gë_c⁄fig_ªque°
(
oh
, &
Àn
, 
msg
);

1691 
OFPT_QUEUE_GET_CONFIG_REPLY
:

1692 
îr‹
 = 
	`oÊ_msg_u≈ack_queue_gë_c⁄fig_ª∂y
(
oh
, &
Àn
, 
msg
);

1694 
OFPT_METER_MOD
:

1695 
îr‹
 = 
	`oÊ_msg_u≈ack_mëî_mod
(
oh
, &
Àn
, 
msg
);

1698 
îr‹
 = 
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPGMFC_BAD_TYPE
);

1702 i‡(
îr‹
) {

1703 i‡(
	`OFL_LOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

1704 *
°r
 = 
	`oÊ_hex_to_°rög
(
buf
, 
buf_Àn
 < 1024 ? buf_len : 1024);

1706 
	`OFL_LOG_DBG
(
LOG_MODULE
, "Eº‹ h≠≥√dá·îÖro˚ssög %zu byã†o‡∑ckë.", 
	`¡ohs
(
oh
->
Àngth
Ë- 
Àn
);

1707 
	`OFL_LOG_DBG
(
LOG_MODULE
, "\n%s\n", 
°r
);

1708 
	`‰ì
(
°r
);

1710  
îr‹
;

1716 i‡(
Àn
 != 0) {

1717 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived mesßgê£emedÅÿbêvÆid, buàô c⁄èöed unu£d d©®(%zu).", 
Àn
);

1718 i‡(
	`OFL_LOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

1719 *
°r
 = 
	`oÊ_hex_to_°rög
(
buf
, 
buf_Àn
 < 1024 ? buf_len : 1024);

1721 
	`OFL_LOG_DBG
(
LOG_MODULE
, "Eº‹ h≠≥√dá·îÖro˚ssög %zu byã†o‡∑ckë.", 
	`¡ohs
(
oh
->
Àngth
Ë- 
Àn
);

1722 
	`OFL_LOG_DBG
(
LOG_MODULE
, "\n%s\n", 
°r
);

1723 
	`‰ì
(
°r
);

1727 (*
msg
)->
ty≥
 = (
oÂ_ty≥
)
oh
->type;

1730 
	}
}

	@oflib/ofl-messages.c

32 
	~<°dlib.h
>

33 
	~<°rög.h
>

34 
	~<°dboﬁ.h
>

35 
	~<√töë/ö.h
>

36 
	~"oÊ.h
"

37 
	~"oÊ-a˘i⁄s.h
"

38 
	~"oÊ-mesßges.h
"

39 
	~"oÊ-°ru˘s.h
"

40 
	~"oÊ-utûs.h
"

41 
	~"oÊ-log.h
"

44 
	#LOG_MODULE
 
oÊ_msg


	)

45 
	$OFL_LOG_INIT
(
LOG_MODULE
)

50 
	$oÊ_msg_‰ì_îr‹
(
oÊ_msg_îr‹
 *
msg
) {

51 
	`‰ì
(
msg
->
d©a
);

52 
	`‰ì
(
msg
);

55 
	}
}

58 
	$oÊ_msg_‰ì_mu…ù¨t_ªque°
(
oÊ_msg_mu…ù¨t_ªque°_hódî
 *
msg
, 
oÊ_exp
 *
exp
) {

59 
msg
->
ty≥
) {

60 
OFPMP_DESC
: {

63 
OFPMP_FLOW
:

64 
OFPMP_AGGREGATE
: {

65 
	`oÊ_°ru˘s_‰ì_m©ch
(((
oÊ_msg_mu…ù¨t_ªque°_Êow
 *)
msg
)->
m©ch
, 
exp
);

68 
OFPMP_TABLE
:

69 
OFPMP_PORT_STATS
 :

70 
OFPMP_QUEUE
:

71 
OFPMP_GROUP
:

72 
OFPMP_GROUP_DESC
:

73 
OFPMP_GROUP_FEATURES
:

74 
OFPMP_METER
:

75 
OFPMP_METER_CONFIG
:

76 
OFPMP_METER_FEATURES
:

78 
OFPMP_TABLE_FEATURES
:{

79 
oÊ_msg_mu…ù¨t_ªque°_èbÀ_„©uªs
 *
m
 = (oÊ_msg_mu…ù¨t_ªque°_èbÀ_„©uª†*)
msg
;

80 
	`OFL_UTILS_FREE_ARR_FUN2
(
m
->
èbÀ_„©uªs
, m->
èbÀs_num
,

81 
oÊ_°ru˘s_‰ì_èbÀ_„©uªs
, 
exp
);

84 
OFPMP_PORT_DESC
:

86 
OFPMP_EXPERIMENTER
: {

87 i‡(
exp
 =
NULL
 ||Éxp->
°©s
 =NULL ||Éxp->°©s->
ªq_‰ì
 == NULL) {

88 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅo free EXPERIMENTER statsÑequest, butÇo callback was given.");

91 
exp
->
°©s
->
	`ªq_‰ì
(
msg
);

97 
	`‰ì
(
msg
);

99 
	}
}

106 
	$oÊ_msg_‰ì_mu…ù¨t_ª∂y
(
oÊ_msg_mu…ù¨t_ª∂y_hódî
 *
msg
, 
oÊ_exp
 *
exp
) {

107 
msg
->
ty≥
) {

108 
OFPMP_DESC
: {

109 
oÊ_msg_ª∂y_desc
 *
°©
 = (oÊ_msg_ª∂y_des¯*Ë
msg
;

110 
	`‰ì
(
°©
->
m‰_desc
);

111 
	`‰ì
(
°©
->
hw_desc
);

112 
	`‰ì
(
°©
->
sw_desc
);

113 
	`‰ì
(
°©
->
£rül_num
);

114 
	`‰ì
(
°©
->
dp_desc
);

117 
OFPMP_FLOW
: {

118 
oÊ_msg_mu…ù¨t_ª∂y_Êow
 *
°©
 = (oÊ_msg_mu…ù¨t_ª∂y_Êow *)
msg
;

119 
	`OFL_UTILS_FREE_ARR_FUN2
(
°©
->
°©s
, sèt->
°©s_num
,

120 
oÊ_°ru˘s_‰ì_Êow_°©s
, 
exp
);

122 
OFPMP_AGGREGATE
: {

125 
OFPMP_TABLE
: {

126 
oÊ_msg_mu…ù¨t_ª∂y_èbÀ
 *
°©
 = (oÊ_msg_mu…ù¨t_ª∂y_èbÀ *)
msg
;

127 
	`OFL_UTILS_FREE_ARR_FUN
(
°©
->
°©s
, sèt->
°©s_num
,

128 
oÊ_°ru˘s_‰ì_èbÀ_°©s
);

131 
OFPMP_PORT_STATS
: {

132 
oÊ_msg_mu…ù¨t_ª∂y_p‹t
 *
°©
 = (oÊ_msg_mu…ù¨t_ª∂y_p‹à*)
msg
;

133 
	`OFL_UTILS_FREE_ARR
(
°©
->
°©s
, sèt->
°©s_num
);

136 
OFPMP_QUEUE
: {

137 
oÊ_msg_mu…ù¨t_ª∂y_queue
 *
°©
 = (oÊ_msg_mu…ù¨t_ª∂y_queuê*)
msg
;

138 
	`OFL_UTILS_FREE_ARR
(
°©
->
°©s
, sèt->
°©s_num
);

141 
OFPMP_GROUP
: {

142 
oÊ_msg_mu…ù¨t_ª∂y_group
 *
°©
 = (oÊ_msg_mu…ù¨t_ª∂y_grou∞*)
msg
;

143 
	`OFL_UTILS_FREE_ARR_FUN
(
°©
->
°©s
, sèt->
°©s_num
,

144 
oÊ_°ru˘s_‰ì_group_°©s
);

147 
OFPMP_METER
:{

148 
oÊ_msg_mu…ù¨t_ª∂y_mëî
 *
°©
 = (oÊ_msg_mu…ù¨t_ª∂y_mëî*)
msg
;

149 
	`OFL_UTILS_FREE_ARR_FUN
(
°©
->
°©s
, sèt->
°©s_num
,

150 
oÊ_°ru˘s_‰ì_mëî_°©s
);

153 
OFPMP_METER_CONFIG
:{

154 
oÊ_msg_mu…ù¨t_ª∂y_mëî_c⁄f
 *
c⁄f
 = (oÊ_msg_mu…ù¨t_ª∂y_mëî_c⁄‡*)
msg
;

155 
	`OFL_UTILS_FREE_ARR_FUN
(
c⁄f
->
°©s
, c⁄f->
°©s_num
,

156 
oÊ_°ru˘s_‰ì_mëî_c⁄fig
);

159 
OFPMP_METER_FEATURES
:{

160 
oÊ_msg_mu…ù¨t_ª∂y_mëî_„©uªs
 *
„©
 = (oÊ_msg_mu…ù¨t_ª∂y_mëî_„©uª†*)
msg
;

161 
	`‰ì
(
„©
->
„©uªs
);

164 
OFPMP_GROUP_DESC
: {

165 
oÊ_msg_mu…ù¨t_ª∂y_group_desc
 *
°©
 = (oÊ_msg_mu…ù¨t_ª∂y_group_des¯*)
msg
;

166 
	`OFL_UTILS_FREE_ARR_FUN2
(
°©
->
°©s
, sèt->
°©s_num
,

167 
oÊ_°ru˘s_‰ì_group_desc_°©s
, 
exp
);

170 
OFPMP_PORT_DESC
:{

171 
oÊ_msg_mu…ù¨t_ª∂y_p‹t_desc
 *
°©
 = (oÊ_msg_mu…ù¨t_ª∂y_p‹t_des¯*)
msg
;

172 
	`OFL_UTILS_FREE_ARR_FUN
(
°©
->
°©s
, sèt->
°©s_num
,

173 
oÊ_°ru˘s_‰ì_p‹t
);

176 
OFPMP_TABLE_FEATURES
:{

177 
oÊ_msg_mu…ù¨t_ª∂y_èbÀ_„©uªs
 *
m
 = (oÊ_msg_mu…ù¨t_ª∂y_èbÀ_„©uª†*)
msg
;

178 
	`OFL_UTILS_FREE_ARR_FUN2
(
m
->
èbÀ_„©uªs
, m->
èbÀs_num
,

179 
oÊ_°ru˘s_‰ì_èbÀ_„©uªs
, 
exp
);

182 
OFPMP_EXPERIMENTER
: {

183 i‡(
exp
 =
NULL
 ||Éxp->
°©s
 ||Éxp->°©s->
ª∂y_‰ì
 == NULL) {

184 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅo free EXPERIMENTER statsÑeply, butÇo callback was given.");

187 
exp
->
°©s
->
	`ª∂y_‰ì
(
msg
);

190 
OFPMP_GROUP_FEATURES
:{

198 
	`‰ì
(
msg
);

200 
	}
}

203 
	$oÊ_msg_‰ì
(
oÊ_msg_hódî
 *
msg
, 
oÊ_exp
 *
exp
) {

205 
msg
->
ty≥
) {

206 
OFPT_HELLO
: {

209 
OFPT_ERROR
: {

210  
	`oÊ_msg_‰ì_îr‹
((
oÊ_msg_îr‹
 *)
msg
);

212 
OFPT_ECHO_REQUEST
:

213 
OFPT_ECHO_REPLY
: {

214 
	`‰ì
(((
oÊ_msg_echo
 *)
msg
)->
d©a
);

217 
OFPT_EXPERIMENTER
: {

218 i‡(
exp
 =
NULL
 ||Éxp->
msg
 =NULL ||Éxp->msg->
‰ì
 == NULL) {

219 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅo free EXPERIMENTER message, butÇo callback was given");

222 
exp
->
msg
->
	`‰ì
((
oÊ_msg_ex≥rimíãr
 *)msg);

225 
OFPT_FEATURES_REQUEST
: {

228 
OFPT_FEATURES_REPLY
: {

231 
OFPT_GET_CONFIG_REQUEST
: {

234 
OFPT_GET_CONFIG_REPLY
: {

235 
	`‰ì
(((
oÊ_msg_gë_c⁄fig_ª∂y
 *)
msg
)->
c⁄fig
);

238 
OFPT_SET_CONFIG
: {

239 
	`‰ì
(((
oÊ_msg_£t_c⁄fig
 *)
msg
)->
c⁄fig
);

242 
OFPT_PACKET_IN
: {

243 
	`oÊ_°ru˘s_‰ì_m©ch
(((
oÊ_msg_∑ckë_ö
 *)
msg
)->
m©ch
,
NULL
);

244 
	`‰ì
(((
oÊ_msg_∑ckë_ö
 *)
msg
)->
d©a
);

247 
OFPT_FLOW_REMOVED
: {

248  
	`oÊ_msg_‰ì_Êow_ªmoved
((
oÊ_msg_Êow_ªmoved
 *)
msg
, 
åue
, 
exp
);

251 
OFPT_PORT_STATUS
: {

252 
	`‰ì
(((
oÊ_msg_p‹t_°©us
 *)
msg
)->
desc
);

255 
OFPT_PACKET_OUT
: {

256  
	`oÊ_msg_‰ì_∑ckë_out
((
oÊ_msg_∑ckë_out
 *)
msg
, 
åue
, 
exp
);

258 
OFPT_FLOW_MOD
: {

259  
	`oÊ_msg_‰ì_Êow_mod
((
oÊ_msg_Êow_mod
 *)
msg
, 
åue
,Årue, 
exp
);

261 
OFPT_GROUP_MOD
: {

262  
	`oÊ_msg_‰ì_group_mod
((
oÊ_msg_group_mod
 *)
msg
, 
åue
, 
exp
);

264 
OFPT_PORT_MOD
:

265 
OFPT_TABLE_MOD
: {

268 
OFPT_MULTIPART_REQUEST
: {

269  
	`oÊ_msg_‰ì_mu…ù¨t_ªque°
((
oÊ_msg_mu…ù¨t_ªque°_hódî
 *)
msg
, 
exp
);

271 
OFPT_MULTIPART_REPLY
: {

272  
	`oÊ_msg_‰ì_mu…ù¨t_ª∂y
((
oÊ_msg_mu…ù¨t_ª∂y_hódî
 *)
msg
, 
exp
);

274 
OFPT_BARRIER_REQUEST
:

275 
OFPT_BARRIER_REPLY
:

276 
OFPT_QUEUE_GET_CONFIG_REQUEST
: {

279 
OFPT_ROLE_REPLY
:

280 
OFPT_ROLE_REQUEST
:{

283 
OFPT_GET_ASYNC_REPLY
:

284 
OFPT_SET_ASYNC
:

285 
OFPT_GET_ASYNC_REQUEST
:{

288 
OFPT_METER_MOD
:{

289  
	`oÊ_msg_‰ì_mëî_mod
((
oÊ_msg_mëî_mod
*)
msg
, 
åue
);

291 
OFPT_QUEUE_GET_CONFIG_REPLY
: {

292 
oÊ_msg_queue_gë_c⁄fig_ª∂y
 *
mod
 =

293 (
oÊ_msg_queue_gë_c⁄fig_ª∂y
 *)
msg
;

294 
	`OFL_UTILS_FREE_ARR_FUN
(
mod
->
queues
, mod->
queues_num
,

295 
oÊ_°ru˘s_‰ì_∑ckë_queue
);

300 
	`‰ì
(
msg
);

302 
	}
}

305 
	$oÊ_msg_‰ì_mëî_mod
(
oÊ_msg_mëî_mod
 * 
msg
, 
boﬁ
 
wôh_b™ds
){

306 i‡(
wôh_b™ds
) {

307 
	`OFL_UTILS_FREE_ARR_FUN
(
msg
->
b™ds
, msg->
mëî_b™ds_num
,

308 
oÊ_°ru˘s_‰ì_mëî_b™ds
);

310 
	`‰ì
(
msg
);

312 
	}
}

315 
	$oÊ_msg_‰ì_∑ckë_out
(
oÊ_msg_∑ckë_out
 *
msg
, 
boﬁ
 
wôh_d©a
, 
oÊ_exp
 *
exp
) {

316 i‡(
wôh_d©a
) {

317 
	`‰ì
(
msg
->
d©a
);

319 
	`OFL_UTILS_FREE_ARR_FUN2
(
msg
->
a˘i⁄s
, msg->
a˘i⁄s_num
,

320 
oÊ_a˘i⁄s_‰ì
, 
exp
);

322 
	`‰ì
(
msg
);

324 
	}
}

327 
	$oÊ_msg_‰ì_group_mod
(
oÊ_msg_group_mod
 *
msg
, 
boﬁ
 
wôh_buckës
, 
oÊ_exp
 *
exp
) {

328 i‡(
wôh_buckës
) {

329 
	`OFL_UTILS_FREE_ARR_FUN2
(
msg
->
buckës
, msg->
buckës_num
,

330 
oÊ_°ru˘s_‰ì_buckë
, 
exp
);

333 
	`‰ì
(
msg
);

335 
	}
}

338 
	$oÊ_msg_‰ì_Êow_mod
(
oÊ_msg_Êow_mod
 *
msg
, 
boﬁ
 
wôh_m©ch
, boﬁ 
wôh_ö°ru˘i⁄s
, 
oÊ_exp
 *
exp
) {

339 i‡(
wôh_m©ch
) {

340 
	`oÊ_°ru˘s_‰ì_m©ch
(
msg
->
m©ch
, 
exp
);

342 i‡(
wôh_ö°ru˘i⁄s
) {

343 
	`OFL_UTILS_FREE_ARR_FUN2
(
msg
->
ö°ru˘i⁄s
, msg->
ö°ru˘i⁄s_num
,

344 
oÊ_°ru˘s_‰ì_ö°ru˘i⁄
, 
exp
);

347 
	`‰ì
(
msg
);

349 
	}
}

353 
	$oÊ_msg_‰ì_Êow_ªmoved
(
oÊ_msg_Êow_ªmoved
 *
msg
, 
boﬁ
 
wôh_°©s
, 
oÊ_exp
 *
exp
) {

354 i‡(
wôh_°©s
) {

355 
	`oÊ_°ru˘s_‰ì_Êow_°©s
(
msg
->
°©s
, 
exp
);

357 
	`‰ì
(
msg
);

359 
	}
}

363 
boﬁ


364 
	$oÊ_msg_mîge_mu…ù¨t_ª∂y_Êow
(
oÊ_msg_mu…ù¨t_ª∂y_Êow
 *
‹ig
, oÊ_msg_mu…ù¨t_ª∂y_Êow *
mîge
) {

365 
uöt32_t
 
√w_°©s_num
;

366 
size_t
 
i
, 
j
;

368 
√w_°©s_num
 = 
‹ig
->
°©s_num
 + 
mîge
->stats_num;

370 
‹ig
->
°©s
 = (
oÊ_Êow_°©s
 ** )
	`ªÆloc
(‹ig->°©s, 
√w_°©s_num
 * (ofl_flow_stats *));

372 
i
=0; i < 
mîge
->
°©s_num
; i++) {

373 
j
 = 
‹ig
->
°©s_num
 + 
i
;

374 
‹ig
->
°©s
[
j
] = (
oÊ_Êow_°©s
 *)
	`mÆloc
((ofl_flow_stats));

375 
	`mem˝y
(
‹ig
->
°©s
[
j
], 
mîge
->°©s[
i
], (
oÊ_Êow_°©s
));

378 
‹ig
->
°©s_num
 = 
√w_°©s_num
;

380  ((
mîge
->
hódî
.
Êags
 & 
OFPMPF_REPLY_MORE
) == 0);

381 
	}
}

383 
boﬁ


384 
	$oÊ_msg_mîge_mu…ù¨t_ª∂y_èbÀ
(
oÊ_msg_mu…ù¨t_ª∂y_èbÀ
 *
‹ig
, oÊ_msg_mu…ù¨t_ª∂y_èbÀ *
mîge
) {

385 
uöt32_t
 
√w_°©s_num
;

386 
size_t
 
i
, 
j
;

388 
√w_°©s_num
 = 
‹ig
->
°©s_num
 + 
mîge
->stats_num;

390 
‹ig
->
°©s
 = (
oÊ_èbÀ_°©s
 **)
	`ªÆloc
(‹ig->°©s, 
√w_°©s_num
 * (ofl_table_stats *));

392 
i
=0; i < 
mîge
->
°©s_num
; i++) {

393 
j
 = 
‹ig
->
°©s_num
 + 
i
;

394 
‹ig
->
°©s
[
j
] = (
oÊ_èbÀ_°©s
 *)
	`mÆloc
((ofl_table_stats));

395 
	`mem˝y
(
‹ig
->
°©s
[
j
], 
mîge
->°©s[
i
], (
oÊ_èbÀ_°©s
));

398 
‹ig
->
°©s_num
 = 
√w_°©s_num
;

400  ((
mîge
->
hódî
.
Êags
 & 
OFPMPF_REPLY_MORE
) == 0);

401 
	}
}

403 
boﬁ


404 
	$oÊ_msg_mîge_mu…ù¨t_ª∂y_p‹t
(
oÊ_msg_mu…ù¨t_ª∂y_p‹t
 *
‹ig
, oÊ_msg_mu…ù¨t_ª∂y_p‹à*
mîge
) {

405 
uöt32_t
 
√w_°©s_num
;

406 
size_t
 
i
, 
j
;

408 
√w_°©s_num
 = 
‹ig
->
°©s_num
 + 
mîge
->stats_num;

410 
‹ig
->
°©s
 = (
oÊ_p‹t_°©s
 **)
	`ªÆloc
(‹ig->°©s, 
√w_°©s_num
 * (ofl_port_stats *));

412 
i
=0; i < 
mîge
->
°©s_num
; i++) {

413 
j
 = 
‹ig
->
°©s_num
 + 
i
;

414 
‹ig
->
°©s
[
j
] = (
oÊ_p‹t_°©s
 *)
	`mÆloc
((ofl_port_stats));

415 
	`mem˝y
(
‹ig
->
°©s
[
j
], 
mîge
->°©s[
i
], (
oÊ_p‹t_°©s
));

418 
‹ig
->
°©s_num
 = 
√w_°©s_num
;

420  ((
mîge
->
hódî
.
Êags
 & 
OFPMPF_REPLY_MORE
) == 0);

421 
	}
}

423 
boﬁ


424 
	$oÊ_msg_mîge_mu…ù¨t_ª∂y_queue
(
oÊ_msg_mu…ù¨t_ª∂y_queue
 *
‹ig
, oÊ_msg_mu…ù¨t_ª∂y_queuê*
mîge
) {

425 
uöt32_t
 
√w_°©s_num
;

426 
size_t
 
i
, 
j
;

428 
√w_°©s_num
 = 
‹ig
->
°©s_num
 + 
mîge
->stats_num;

430 
‹ig
->
°©s
 = (
oÊ_queue_°©s
 **)
	`ªÆloc
(‹ig->°©s, 
√w_°©s_num
 * (ofl_queue_stats *));

432 
i
=0; i < 
mîge
->
°©s_num
; i++) {

433 
j
 = 
‹ig
->
°©s_num
 + 
i
;

434 
‹ig
->
°©s
[
j
] = (
oÊ_queue_°©s
 *)
	`mÆloc
((ofl_queue_stats));

435 
	`mem˝y
(
‹ig
->
°©s
[
j
], 
mîge
->°©s[
i
], (
oÊ_queue_°©s
));

438 
‹ig
->
°©s_num
 = 
√w_°©s_num
;

440  ((
mîge
->
hódî
.
Êags
 & 
OFPMPF_REPLY_MORE
) == 0);

441 
	}
}

	@oflib/ofl-messages.h

32 #i‚de‡
OFL_MESSAGES_H


33 
	#OFL_MESSAGES_H
 1

	)

35 
	~<sys/ty≥s.h
>

36 
	~<°dboﬁ.h
>

37 
	~<°dio.h
>

39 
	~"../ö˛ude/›íÊow/›íÊow.h
"

40 
	~"oÊ.h
"

41 
	~"oÊ-°ru˘s.h
"

42 
	~"oÊ-a˘i⁄s.h
"

51 
	soÊ_msg_hódî
 {

52 
oÂ_ty≥
 
	mty≥
;

62 
	soÊ_msg_îr‹
 {

63 
oÊ_msg_hódî
 
	mhódî
;

65 
oÂ_îr‹_ty≥
 
	mty≥
;

66 
uöt16_t
 
	mcode
;

67 
size_t
 
	md©a_Àngth
;

68 
uöt8_t
 *
	md©a
;

74 
	soÊ_msg_echo
 {

75 
oÊ_msg_hódî
 
	mhódî
;

77 
size_t
 
	md©a_Àngth
;

78 
uöt8_t
 *
	md©a
;

87 
	soÊ_msg_ex≥rimíãr
 {

88 
oÊ_msg_hódî
 
	mhódî
;

90 
uöt32_t
 
	mex≥rimíãr_id
;

95 
	soÊ_msg_„©uªs_ª∂y
 {

96 
oÊ_msg_hódî
 
	mhódî
;

98 
uöt64_t
 
	md©≠©h_id
;

101 
uöt32_t
 
	mn_buf„rs
;

102 
uöt8_t
 
	mn_èbÀs
;

104 
uöt8_t
 
	mauxûüry_id
;

105 
uöt32_t
 
	mˇ∑bûôõs
;

106 
uöt32_t
 
	mª£rved
;

109 
	soÊ_msg_gë_c⁄fig_ª∂y
 {

110 
oÊ_msg_hódî
 
	mhódî
;

112 
oÊ_c⁄fig
 *
	mc⁄fig
;

115 
	soÊ_msg_£t_c⁄fig
 {

116 
oÊ_msg_hódî
 
	mhódî
;

118 
oÊ_c⁄fig
 *
	mc⁄fig
;

122 
	soÊ_msg_rﬁe_ªque°
 {

123 
oÊ_msg_hódî
 
	mhódî
;

124 
uöt32_t
 
	mrﬁe
;

125 
uöt64_t
 
	mgíî©i⁄_id
;

134 
	soÊ_msg_∑ckë_ö
 {

135 
oÊ_msg_hódî
 
	mhódî
;

137 
uöt32_t
 
	mbuf„r_id
;

138 
uöt16_t
 
	mtŸÆ_Àn
;

139 
oÂ_∑ckë_ö_ªas⁄
 
	mªas⁄
;

140 
uöt8_t
 
	mèbÀ_id
;

141 
uöt64_t
 
	mcookõ
;

142 
oÊ_m©ch_hódî
 *
	mm©ch
;

143 
size_t
 
	md©a_Àngth
;

144 
uöt8_t
 *
	md©a
;

147 
	soÊ_msg_Êow_ªmoved
 {

148 
oÊ_msg_hódî
 
	mhódî
;

150 
oÊ_Êow_°©s
 *
	m°©s
;

151 
oÂ_Êow_ªmoved_ªas⁄
 
	mªas⁄
;

154 
	soÊ_msg_p‹t_°©us
 {

155 
oÊ_msg_hódî
 
	mhódî
;

157 
oÂ_p‹t_ªas⁄
 
	mªas⁄
;

158 
oÊ_p‹t
 *
	mdesc
;

166 
	soÊ_msg_async_c⁄fig
 {

167 
oÊ_msg_hódî
 
	mhódî
;

168 
oÊ_async_c⁄fig
 *
	mc⁄fig
;

171 
	soÊ_msg_∑ckë_out
 {

172 
oÊ_msg_hódî
 
	mhódî
;

174 
uöt32_t
 
	mbuf„r_id
;

176 
uöt32_t
 
	mö_p‹t
;

178 
uöt32_t
 
	ma˘i⁄s_num
;

179 
oÊ_a˘i⁄_hódî
 **
	ma˘i⁄s
;

181 
size_t
 
	md©a_Àngth
;

182 
uöt8_t
 *
	md©a
;

186 
	soÊ_msg_Êow_mod
 {

187 
oÊ_msg_hódî
 
	mhódî
;

189 
uöt64_t
 
	mcookõ
;

190 
uöt64_t
 
	mcookõ_mask
;

194 
uöt8_t
 
	mèbÀ_id
;

195 
oÂ_Êow_mod_comm™d
 
	mcomm™d
;

196 
uöt16_t
 
	midÀ_timeout
;

197 
uöt16_t
 
	mh¨d_timeout
;

198 
uöt16_t
 
	m¥i‹ôy
;

199 
uöt32_t
 
	mbuf„r_id
;

201 
uöt32_t
 
	mout_p‹t
;

205 
uöt32_t
 
	mout_group
;

209 
uöt16_t
 
	mÊags
;

210 
oÊ_m©ch_hódî
 *
	mm©ch
;

211 
size_t
 
	mö°ru˘i⁄s_num
;

212 
oÊ_ö°ru˘i⁄_hódî
 **
	mö°ru˘i⁄s
;

217 
	soÊ_msg_group_mod
 {

218 
oÊ_msg_hódî
 
	mhódî
;

220 
oÂ_group_mod_comm™d
 
	mcomm™d
;

221 
uöt8_t
 
	mty≥
;

222 
uöt32_t
 
	mgroup_id
;

223 
size_t
 
	mbuckës_num
;

224 
oÊ_buckë
 **
	mbuckës
;

229 
	soÊ_msg_p‹t_mod
 {

230 
oÊ_msg_hódî
 
	mhódî
;

232 
uöt32_t
 
	mp‹t_no
;

233 
uöt8_t
 
	mhw_addr
[
OFP_ETH_ALEN
];

238 
uöt32_t
 
	mc⁄fig
;

239 
uöt32_t
 
	mmask
;

240 
uöt32_t
 
	madvîti£
;

244 
	soÊ_msg_èbÀ_mod
 {

245 
oÊ_msg_hódî
 
	mhódî
;

247 
uöt8_t
 
	mèbÀ_id
;

248 
uöt32_t
 
	mc⁄fig
;

252 
	soÊ_msg_mëî_mod
 {

253 
oÊ_msg_hódî
 
	mhódî
;

254 
uöt16_t
 
	mcomm™d
;

255 
uöt16_t
 
	mÊags
;

256 
uöt32_t
 
	mmëî_id
;

257 
size_t
 
	mmëî_b™ds_num
;

258 
oÊ_mëî_b™d_hódî
 **
	mb™ds
;

268 
	soÊ_msg_mu…ù¨t_ªque°_hódî
 {

269 
oÊ_msg_hódî
 
	mhódî
;

271 
oÂ_mu…ù¨t_ty≥s
 
	mty≥
;

272 
uöt16_t
 
	mÊags
;

275 
	soÊ_msg_mu…ù¨t_ªque°_Êow
 {

276 
oÊ_msg_mu…ù¨t_ªque°_hódî
 
	mhódî
;

278 
uöt8_t
 
	mèbÀ_id
;

281 
uöt32_t
 
	mout_p‹t
;

284 
uöt32_t
 
	mout_group
;

287 
uöt64_t
 
	mcookõ
;

289 
uöt64_t
 
	mcookõ_mask
;

292 
oÊ_m©ch_hódî
 *
	mm©ch
;

295 
	soÊ_msg_mu…ù¨t_ªque°_p‹t
 {

296 
oÊ_msg_mu…ù¨t_ªque°_hódî
 
	mhódî
;

297 
uöt32_t
 
	mp‹t_no
;

303 
	soÊ_msg_mu…ù¨t_ªque°_queue
 {

304 
oÊ_msg_mu…ù¨t_ªque°_hódî
 
	mhódî
;

305 
uöt32_t
 
	mp‹t_no
;

306 
uöt32_t
 
	mqueue_id
;

309 
	soÊ_msg_mu…ù¨t_ªque°_group
 {

310 
oÊ_msg_mu…ù¨t_ªque°_hódî
 
	mhódî
;

311 
uöt32_t
 
	mgroup_id
;

314 
	soÊ_msg_mu…ù¨t_ªque°_èbÀ_„©uªs
{

315 
oÊ_msg_mu…ù¨t_ªque°_hódî
 
	mhódî
;

316 
size_t
 
	mèbÀs_num
;

317 
oÊ_èbÀ_„©uªs
 **
	mèbÀ_„©uªs
;

320 
	soÊ_msg_mu…ù¨t_mëî_ªque°
 {

321 
oÊ_msg_mu…ù¨t_ªque°_hódî
 
	mhódî
;

323 
uöt32_t
 
	mmëî_id
;

326 
	soÊ_msg_mu…ù¨t_ªque°_ex≥rimíãr
 {

327 
oÊ_msg_mu…ù¨t_ªque°_hódî
 
	mhódî
;

329 
uöt32_t
 
	mex≥rimíãr_id
;

332 
	soÊ_msg_mu…ù¨t_ª∂y_hódî
 {

333 
oÊ_msg_hódî
 
	mhódî
;

335 
oÂ_mu…ù¨t_ty≥s
 
	mty≥
;

336 
uöt16_t
 
	mÊags
;

339 
	soÊ_msg_ª∂y_desc
 {

340 
oÊ_msg_mu…ù¨t_ª∂y_hódî
 
	mhódî
;

342 *
	mm‰_desc
;

343 *
	mhw_desc
;

344 *
	msw_desc
;

345 *
	m£rül_num
;

346 *
	mdp_desc
;

350 
	soÊ_msg_mu…ù¨t_ª∂y_Êow
 {

351 
oÊ_msg_mu…ù¨t_ª∂y_hódî
 
	mhódî
;

353 
size_t
 
	m°©s_num
;

354 
oÊ_Êow_°©s
 **
	m°©s
;

357 
	soÊ_msg_mu…ù¨t_ª∂y_aggªg©e
 {

358 
oÊ_msg_mu…ù¨t_ª∂y_hódî
 
	mhódî
;

360 
uöt64_t
 
	m∑ckë_cou¡
;

361 
uöt64_t
 
	mbyã_cou¡
;

362 
uöt32_t
 
	mÊow_cou¡
;

365 
	soÊ_msg_mu…ù¨t_ª∂y_èbÀ
 {

366 
oÊ_msg_mu…ù¨t_ª∂y_hódî
 
	mhódî
;

368 
size_t
 
	m°©s_num
;

369 
oÊ_èbÀ_°©s
 **
	m°©s
;

372 
	soÊ_msg_mu…ù¨t_ª∂y_èbÀ_„©uªs
 {

373 
oÊ_msg_mu…ù¨t_ª∂y_hódî
 
	mhódî
;

374 
size_t
 
	mèbÀs_num
;

375 
oÊ_èbÀ_„©uªs
 ** 
	mèbÀ_„©uªs
;

379 
	soÊ_msg_mu…ù¨t_ª∂y_p‹t
 {

380 
oÊ_msg_mu…ù¨t_ª∂y_hódî
 
	mhódî
;

382 
size_t
 
	m°©s_num
;

383 
oÊ_p‹t_°©s
 **
	m°©s
;

386 
	soÊ_msg_mu…ù¨t_ª∂y_queue
 {

387 
oÊ_msg_mu…ù¨t_ª∂y_hódî
 
	mhódî
;

389 
size_t
 
	m°©s_num
;

390 
oÊ_queue_°©s
 **
	m°©s
;

393 
	soÊ_msg_mu…ù¨t_ª∂y_group
 {

394 
oÊ_msg_mu…ù¨t_ª∂y_hódî
 
	mhódî
;

396 
size_t
 
	m°©s_num
;

397 
oÊ_group_°©s
 **
	m°©s
;

400 
	soÊ_msg_mu…ù¨t_ª∂y_group_desc
 {

401 
oÊ_msg_mu…ù¨t_ª∂y_hódî
 
	mhódî
;

403 
size_t
 
	m°©s_num
;

404 
oÊ_group_desc_°©s
 **
	m°©s
;

407 
	soÊ_msg_mu…ù¨t_ª∂y_group_„©uªs
 {

408 
oÊ_msg_mu…ù¨t_ª∂y_hódî
 
	mhódî
;

410 
uöt32_t
 
	mty≥s
;

411 
uöt32_t
 
	mˇ∑bûôõs
;

412 
uöt32_t
 
	mmax_groups
[4];

413 
uöt32_t
 
	ma˘i⁄s
[4];

416 
	soÊ_msg_mu…ù¨t_ª∂y_mëî
 {

417 
oÊ_msg_mu…ù¨t_ª∂y_hódî
 
	mhódî
;

419 
size_t
 
	m°©s_num
;

420 
oÊ_mëî_°©s
 **
	m°©s
;

423 
	soÊ_msg_mu…ù¨t_ª∂y_mëî_„©uªs
 {

424 
oÊ_msg_mu…ù¨t_ª∂y_hódî
 
	mhódî
;

426 
oÊ_mëî_„©uªs
 *
	m„©uªs
;

429 
	soÊ_msg_mu…ù¨t_ª∂y_mëî_c⁄f
 {

430 
oÊ_msg_mu…ù¨t_ª∂y_hódî
 
	mhódî
;

432 
size_t
 
	m°©s_num
;

433 
oÊ_mëî_c⁄fig
 **
	m°©s
;

436 
	soÊ_msg_mu…ù¨t_ª∂y_p‹t_desc
 {

437 
oÊ_msg_mu…ù¨t_ª∂y_hódî
 
	mhódî
;

439 
size_t
 
	m°©s_num
;

440 
oÊ_p‹t
 **
	m°©s
;

443 
	soÊ_msg_mu…ù¨t_ª∂y_ex≥rimíãr
 {

444 
oÊ_msg_mu…ù¨t_ª∂y_hódî
 
	mhódî
;

446 
uöt32_t
 
	mex≥rimíãr_id
;

448 
size_t
 
	md©a_Àngth
;

449 
uöt8_t
 *
	md©a
;

456 
	soÊ_msg_queue_gë_c⁄fig_ªque°
 {

457 
oÊ_msg_hódî
 
	mhódî
;

459 
uöt32_t
 
	mp‹t
;

467 
	soÊ_msg_queue_gë_c⁄fig_ª∂y
 {

468 
oÊ_msg_hódî
 
	mhódî
;

469 
uöt32_t
 
	mp‹t
;

471 
size_t
 
	mqueues_num
;

472 
oÊ_∑ckë_queue
 **
	mqueues
;

479 
	soÊ_msg_°©e_mod
 {

480 
oÊ_msg_hódî
 
	mhódî
;

481 
uöt64_t
 
	mcookõ
;

482 
uöt64_t
 
	mcookõ_mask
;

483 
uöt8_t
 
	mèbÀ_id
;

485 
oÂ_°©e_mod_comm™d
 
	mcomm™d
;

487 
uöt8_t
 
	m∑ylﬂd
[];

490 
	soÊ_msg_°©e_íåy
 {

491 
uöt32_t
 
	mkey_Àn
;

492 
uöt32_t
 
	m°©e
;

493 
uöt8_t
 
	mkey
[
OFPSC_MAX_KEY_LEN
];

496 
	soÊ_msg_exåa˘i⁄
 {

497 
uöt32_t
 
	mfõld_cou¡
;

498 
uöt8_t
 
	mfõlds
[
OFPSC_MAX_FIELD_COUNT
];

512 
oÊ_msg_∑ck
(
oÊ_msg_hódî
 *
msg
, 
uöt32_t
 
xid
, 
uöt8_t
 **
buf
, 
size_t
 *
buf_Àn
, 
oÊ_exp
 *
exp
);

518 
oÊ_îr


519 
oÊ_msg_u≈ack
(
uöt8_t
 *
buf
, 
size_t
 
buf_Àn
,

520 
oÊ_msg_hódî
 **
msg
, 
uöt32_t
 *
xid
, 
oÊ_exp
 *
exp
);

532 
oÊ_msg_‰ì
(
oÊ_msg_hódî
 *
msg
, 
oÊ_exp
 *
exp
);

536 
oÊ_msg_‰ì_mëî_mod
(
oÊ_msg_mëî_mod
 * 
msg
, 
boﬁ
 
wôh_b™ds
);

542 
oÊ_msg_‰ì_∑ckë_out
(
oÊ_msg_∑ckë_out
 *
msg
, 
boﬁ
 
wôh_d©a
, 
oÊ_exp
 *
exp
);

548 
oÊ_msg_‰ì_group_mod
(
oÊ_msg_group_mod
 *
msg
, 
boﬁ
 
wôh_buckës
, 
oÊ_exp
 *
exp
);

556 
oÊ_msg_‰ì_Êow_mod
(
oÊ_msg_Êow_mod
 *
msg
, 
boﬁ
 
wôh_m©ch
, boﬁ 
wôh_ö°ru˘i⁄s
, 
oÊ_exp
 *
exp
);

562 
oÊ_msg_‰ì_Êow_ªmoved
(
oÊ_msg_Êow_ªmoved
 *
msg
, 
boﬁ
 
wôh_°©s
, 
oÊ_exp
 *
exp
);

570 
boﬁ


571 
oÊ_msg_mîge_mu…ù¨t_ªque°_èbÀ_„©uªs
(
oÊ_msg_mu…ù¨t_ªque°_èbÀ_„©uªs
 *
‹ig
, oÊ_msg_mu…ù¨t_ªque°_èbÀ_„©uª†*
mîge
);

575 
boﬁ


576 
oÊ_msg_mîge_mu…ù¨t_ª∂y_Êow
(
oÊ_msg_mu…ù¨t_ª∂y_Êow
 *
‹ig
,

577 
oÊ_msg_mu…ù¨t_ª∂y_Êow
 *
mîge
);

581 
boﬁ


582 
oÊ_msg_mîge_mu…ù¨t_ª∂y_èbÀ
(
oÊ_msg_mu…ù¨t_ª∂y_èbÀ
 *
‹ig
,

583 
oÊ_msg_mu…ù¨t_ª∂y_èbÀ
 *
mîge
);

587 
boﬁ


588 
oÊ_msg_mîge_mu…ù¨t_ª∂y_p‹t
(
oÊ_msg_mu…ù¨t_ª∂y_p‹t
 *
‹ig
,

589 
oÊ_msg_mu…ù¨t_ª∂y_p‹t
 *
mîge
);

593 
boﬁ


594 
oÊ_msg_mîge_mu…ù¨t_ª∂y_queue
(
oÊ_msg_mu…ù¨t_ª∂y_queue
 *
‹ig
,

595 
oÊ_msg_mu…ù¨t_ª∂y_queue
 *
mîge
);

606 
oÊ_msg_to_°rög
(
oÊ_msg_hódî
 *
msg
, 
oÊ_exp
 *
exp
);

612 
oÊ_msg_¥öt
(
FILE
 *
°ªam
, 
oÊ_msg_hódî
 *
msg
, 
oÊ_exp
 *
exp
);

	@oflib/ofl-packets.h

31 #i‚de‡
OFL_PACKETS_H


32 
	#OFL_PACKETS_H


	)

34 
	#ETH_TYPE_II_START
 0x0600

	)

35 
	#ETH_TYPE_IP
 0x0800

	)

36 
	#ETH_TYPE_ARP
 0x0806

	)

37 
	#ETH_TYPE_VLAN
 0x8100

	)

38 
	#ETH_TYPE_VLAN_PBB
 0x88a8

	)

39 
	#ETH_TYPE_PBB
 0x88e7

	)

40 
	#ETH_TYPE_MPLS
 0x8847

	)

41 
	#ETH_TYPE_MPLS_MCAST
 0x8848

	)

43 
	#ETH_ADDR_LEN
 6

	)

44 
	#IPv6_ADDR_LEN
 16

	)

47 
	#VLAN_VID_MASK
 0x0fff

	)

48 
	#VLAN_VID_SHIFT
 0

	)

49 
	#VLAN_PCP_MASK
 0xe000

	)

50 
	#VLAN_PCP_SHIFT
 13

	)

51 
	#VLAN_PCP_BITMASK
 0x0007

	)

53 
	#VLAN_VID_MAX
 4095

	)

54 
	#VLAN_PCP_MAX
 7

	)

58 
	#MPLS_TTL_MASK
 0x000000ff

	)

59 
	#MPLS_TTL_SHIFT
 0

	)

60 
	#MPLS_S_MASK
 0x00000100

	)

61 
	#MPLS_S_SHIFT
 8

	)

62 
	#MPLS_TC_MASK
 0x00000e00

	)

63 
	#MPLS_TC_SHIFT
 9

	)

64 
	#MPLS_LABEL_MASK
 0xfffff000

	)

65 
	#MPLS_LABEL_SHIFT
 12

	)

67 
	#MPLS_LABEL_MAX
 1048575

	)

68 
	#MPLS_TC_MAX
 7

	)

72 
	#IP_ECN_MASK
 0x03

	)

73 
	#IP_DSCP_MASK
 0xfc

	)

	@oflib/ofl-print.c

31 
	~<°dboﬁ.h
>

32 
	~<°dlib.h
>

33 
	~<°rög.h
>

34 
	~<°dio.h
>

35 
	~<˘y≥.h
>

36 
	~<öây≥s.h
>

38 
	~"oÊ.h
"

39 
	~"oÊ-¥öt.h
"

40 
	~"oxm-m©ch.h
"

41 
	~"›íÊow/›íÊow.h
"

45 
	$oÊ_p‹t_to_°rög
(
uöt32_t
 
p‹t
) {

46 *
°r
;

47 
size_t
 
°r_size
;

48 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

50 
	`oÊ_p‹t_¥öt
(
°ªam
, 
p‹t
);

51 
	`f˛o£
(
°ªam
);

52  
°r
;

53 
	}
}

56 
	$oÊ_p‹t_¥öt
(
FILE
 *
°ªam
, 
uöt32_t
 
p‹t
) {

57 
p‹t
) {

58 (
OFPP_IN_PORT
): { 
	`Ârötf
(
°ªam
, "in_port"); ; }

59 (
OFPP_TABLE
): { 
	`Ârötf
(
°ªam
, "table"); ; }

60 (
OFPP_NORMAL
): { 
	`Ârötf
(
°ªam
, "normal"); ; }

61 (
OFPP_FLOOD
): { 
	`Ârötf
(
°ªam
, "flood"); ; }

62 (
OFPP_ALL
): { 
	`Ârötf
(
°ªam
, "all"); ; }

63 (
OFPP_CONTROLLER
): { 
	`Ârötf
(
°ªam
, "ctrl"); ; }

64 (
OFPP_LOCAL
): { 
	`Ârötf
(
°ªam
, "local"); ; }

65 (
OFPP_ANY
): { 
	`Ârötf
(
°ªam
, "any"); ; }

66 : { 
	`Ârötf
(
°ªam
, "%u", 
p‹t
); ; }

68 
	}
}

71 
	$oÊ_ùv6_ext_hdr_to_°rög
(
uöt16_t
 
ext_hdr
){

72 *
°r
;

73 
size_t
 
°r_size
;

74 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

76 
	`oÊ_ùv6_ext_hdr_¥öt
(
°ªam
, 
ext_hdr
);

77 
	`f˛o£
(
°ªam
);

78  
°r
;

79 
	}
}

82 
	$oÊ_ùv6_ext_hdr_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
ext_hdr
) {

84 i‡(
ext_hdr
 !0Ë
	`Ârötf
(
°ªam
, "|");

85 i‡(
ext_hdr
 & 
OFPIEH_NONEXT
Ë{ 
	`Ârötf
(
°ªam
, "no_next|"); }

86 i‡(
ext_hdr
 & 
OFPIEH_ESP
Ë{ 
	`Ârötf
(
°ªam
, "esp|"); }

87 i‡(
ext_hdr
 & 
OFPIEH_AUTH
Ë{ 
	`Ârötf
(
°ªam
, "auth|"); }

88 i‡(
ext_hdr
 & 
OFPIEH_DEST
Ë{ 
	`Ârötf
(
°ªam
, "dest|"); }

89 i‡(
ext_hdr
 & 
OFPIEH_FRAG
Ë{ 
	`Ârötf
(
°ªam
, "frag|"); }

90 i‡(
ext_hdr
 & 
OFPIEH_ROUTER
){ 
	`Ârötf
(
°ªam
, "router|"); }

91 i‡(
ext_hdr
 & 
OFPIEH_HOP
Ë{ 
	`Ârötf
(
°ªam
, "hop|"); }

92 i‡(
ext_hdr
 & 
OFPIEH_UNREP
Ë{ 
	`Ârötf
(
°ªam
, "unreq|"); }

93 i‡(
ext_hdr
 & 
OFPIEH_UNSEQ
Ë{ 
	`Ârötf
(
°ªam
, "unseq|"); }

94 
	}
}

97 
	$oÊ_queue_to_°rög
(
uöt32_t
 
queue
) {

98 *
°r
;

99 
size_t
 
°r_size
;

100 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

102 
	`oÊ_queue_¥öt
(
°ªam
, 
queue
);

103 
	`f˛o£
(
°ªam
);

104  
°r
;

105 
	}
}

108 
	$oÊ_queue_¥öt
(
FILE
 *
°ªam
, 
uöt32_t
 
queue
) {

109 
queue
) {

110 (
OFPQ_ALL
): { 
	`Ârötf
(
°ªam
, "all"); ; }

111 : { 
	`Ârötf
(
°ªam
, "%u", 
queue
); ; }

113 
	}
}

117 
	$oÊ_group_to_°rög
(
uöt32_t
 
group
) {

118 *
°r
;

119 
size_t
 
°r_size
;

120 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

122 
	`oÊ_group_¥öt
(
°ªam
, 
group
);

123 
	`f˛o£
(
°ªam
);

124  
°r
;

125 
	}
}

128 
	$oÊ_group_¥öt
(
FILE
 *
°ªam
, 
uöt32_t
 
group
) {

129 
group
) {

130 (
OFPG_ALL
): { 
	`Ârötf
(
°ªam
, "all"); ; }

131 (
OFPG_ANY
): { 
	`Ârötf
(
°ªam
, "any"); ; }

132 : { 
	`Ârötf
(
°ªam
, "%u", 
group
); ; }

134 
	}
}

139 
	$oÊ_èbÀ_to_°rög
(
uöt8_t
 
èbÀ
) {

140 *
°r
;

141 
size_t
 
°r_size
;

142 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

144 
	`oÊ_èbÀ_¥öt
(
°ªam
, 
èbÀ
);

145 
	`f˛o£
(
°ªam
);

146  
°r
;

147 
	}
}

150 
	$oÊ_èbÀ_¥öt
(
FILE
 *
°ªam
, 
uöt8_t
 
èbÀ
) {

151 
èbÀ
) {

152 (0xff): { 
	`Ârötf
(
°ªam
, "all"); ; }

153 : { 
	`Ârötf
(
°ªam
, "%u", 
èbÀ
); ; }

155 
	}
}

160 
	$oÊ_vœn_vid_to_°rög
(
uöt32_t
 
vid
) {

161 *
°r
;

162 
size_t
 
°r_size
;

163 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

165 
	`oÊ_vœn_vid_¥öt
(
°ªam
, 
vid
);

166 
	`f˛o£
(
°ªam
);

167  
°r
;

168 
	}
}

171 
	$oÊ_vœn_vid_¥öt
(
FILE
 *
°ªam
, 
uöt32_t
 
vid
) {

172 
vid
) {

173 (
OFPVID_PRESENT
): { 
	`Ârötf
(
°ªam
, "any"); ; }

174 (
OFPVID_NONE
): { 
	`Ârötf
(
°ªam
, "none"); ; }

175 : { 
	`Ârötf
(
°ªam
, "%u", 
vid
); ; }

177 
	}
}

182 
	$oÊ_a˘i⁄_ty≥_to_°rög
(
uöt16_t
 
ty≥
) {

183 *
°r
;

184 
size_t
 
°r_size
;

185 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

187 
	`oÊ_a˘i⁄_ty≥_¥öt
(
°ªam
, 
ty≥
);

188 
	`f˛o£
(
°ªam
);

189  
°r
;

190 
	}
}

193 
	$oÊ_a˘i⁄_ty≥_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
ty≥
) {

194 
ty≥
) {

195 
OFPAT_OUTPUT
: { 
	`Ârötf
(
°ªam
, "out"); ; }

196 
OFPAT_SET_FIELD
: { 
	`Ârötf
(
°ªam
, "set_field"); ; }

197 
OFPAT_COPY_TTL_OUT
: { 
	`Ârötf
(
°ªam
, "ttl_out"); ; }

198 
OFPAT_COPY_TTL_IN
: { 
	`Ârötf
(
°ªam
, "ttl_in"); ; }

199 
OFPAT_SET_MPLS_TTL
: { 
	`Ârötf
(
°ªam
, "mpls_ttl"); ; }

200 
OFPAT_DEC_MPLS_TTL
: { 
	`Ârötf
(
°ªam
, "mpls_dec"); ; }

201 
OFPAT_PUSH_VLAN
: { 
	`Ârötf
(
°ªam
, "vlan_psh"); ; }

202 
OFPAT_POP_VLAN
: { 
	`Ârötf
(
°ªam
, "vlan_pop"); ; }

203 
OFPAT_PUSH_MPLS
: { 
	`Ârötf
(
°ªam
, "mpls_psh"); ; }

204 
OFPAT_POP_MPLS
: { 
	`Ârötf
(
°ªam
, "mpls_pop"); ; }

205 
OFPAT_SET_QUEUE
: { 
	`Ârötf
(
°ªam
, "queue"); ; }

206 
OFPAT_GROUP
: { 
	`Ârötf
(
°ªam
, "group"); ; }

207 
OFPAT_PUSH_PBB
: { 
	`Ârötf
(
°ªam
, "pbb_psh"); ; }

208 
OFPAT_POP_PBB
: { 
	`Ârötf
(
°ªam
, "pbb_pop"); ; }

209 
OFPAT_SET_NW_TTL
: { 
	`Ârötf
(
°ªam
, "nw_ttl"); ; }

210 
OFPAT_DEC_NW_TTL
: { 
	`Ârötf
(
°ªam
, "nw_dec"); ; }

211 
OFPAT_EXPERIMENTER
: { 
	`Ârötf
(
°ªam
, "exp"); ; }

212 : { 
	`Ârötf
(
°ªam
, "?(%u)", 
ty≥
); ; }

214 
	}
}

217 
	$oÊ_oxm_ty≥_to_°rög
(
uöt16_t
 
ty≥
) {

218 *
°r
;

219 
size_t
 
°r_size
;

220 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

222 
	`oÊ_oxm_ty≥_¥öt
(
°ªam
, 
ty≥
);

223 
	`f˛o£
(
°ªam
);

224  
°r
;

225 
	}
}

228 
	$oÊ_oxm_ty≥_¥öt
(
FILE
 *
°ªam
, 
uöt32_t
 
ty≥
){

229 
ty≥
){

230 
OXM_OF_IN_PORT
: {
	`Ârötf
(
°ªam
, "in_port"); ; }

231 
OXM_OF_IN_PHY_PORT
: {
	`Ârötf
(
°ªam
, "in_phy_port"); ; }

232 
OXM_OF_METADATA
: {
	`Ârötf
(
°ªam
, "metadata"); ; }

233 
OXM_OF_ETH_DST
: {
	`Ârötf
(
°ªam
, "eth_dst"); ; }

234 
OXM_OF_ETH_SRC
: {
	`Ârötf
(
°ªam
, "eth_src"); ; }

235 
OXM_OF_ETH_TYPE
: {
	`Ârötf
(
°ªam
, "eth_type"); ; }

236 
OXM_OF_VLAN_VID
: {
	`Ârötf
(
°ªam
, "vlan_vid"); ; }

237 
OXM_OF_VLAN_PCP
: {
	`Ârötf
(
°ªam
, "vlan_pcp"); ; }

238 
OXM_OF_IP_DSCP
: {
	`Ârötf
(
°ªam
, "ip_dscp"); ; }

239 
OXM_OF_IP_ECN
: {
	`Ârötf
(
°ªam
, "ip_ecn"); ; }

240 
OXM_OF_IP_PROTO
: {
	`Ârötf
(
°ªam
, "ip_proto"); ; }

241 
OXM_OF_IPV4_SRC
: {
	`Ârötf
(
°ªam
, "ipv4_src"); ; }

242 
OXM_OF_IPV4_DST
: {
	`Ârötf
(
°ªam
, "ipv4_dst"); ; }

243 
OXM_OF_TCP_SRC
: {
	`Ârötf
(
°ªam
, "tcp_src"); ; }

244 
OXM_OF_TCP_DST
: {
	`Ârötf
(
°ªam
, "tcp_dst"); ; }

245 
OXM_OF_UDP_SRC
: {
	`Ârötf
(
°ªam
, "udp_src"); ; }

246 
OXM_OF_UDP_DST
: {
	`Ârötf
(
°ªam
, "udp_dst"); ; }

247 
OXM_OF_SCTP_SRC
: {
	`Ârötf
(
°ªam
, "sctp_src"); ; }

248 
OXM_OF_SCTP_DST
: {
	`Ârötf
(
°ªam
, "udp_dst"); ; }

249 
OXM_OF_ICMPV4_CODE
: {
	`Ârötf
(
°ªam
, "icmpv4_code"); ; }

250 
OXM_OF_ICMPV4_TYPE
: {
	`Ârötf
(
°ªam
, "icmpv4_type"); ; }

251 
OXM_OF_ARP_OP
: {
	`Ârötf
(
°ªam
, "arp_op"); ; }

252 
OXM_OF_ARP_SPA
: {
	`Ârötf
(
°ªam
, "arp_spa"); ; }

253 
OXM_OF_ARP_TPA
: {
	`Ârötf
(
°ªam
, "arp_tpa"); ; }

254 
OXM_OF_ARP_SHA
: {
	`Ârötf
(
°ªam
, "arp_sha"); ; }

255 
OXM_OF_ARP_THA
: {
	`Ârötf
(
°ªam
, "arp_tha"); ; }

256 
OXM_OF_IPV6_SRC
: {
	`Ârötf
(
°ªam
, "ipv6_src"); ; }

257 
OXM_OF_IPV6_DST
: {
	`Ârötf
(
°ªam
, "ipv6_dst"); ; }

258 
OXM_OF_IPV6_FLABEL
: {
	`Ârötf
(
°ªam
, "ipv6_flabel"); ; }

259 
OXM_OF_ICMPV6_TYPE
: {
	`Ârötf
(
°ªam
, "icmpv6_type"); ; }

260 
OXM_OF_ICMPV6_CODE
: {
	`Ârötf
(
°ªam
, "icmpv6_code"); ; }

261 
OXM_OF_IPV6_ND_TARGET
: {
	`Ârötf
(
°ªam
, "ipv6_nd_target"); ; }

262 
OXM_OF_IPV6_ND_SLL
: {
	`Ârötf
(
°ªam
, "ipv6_nd_sll"); ; }

263 
OXM_OF_IPV6_ND_TLL
: {
	`Ârötf
(
°ªam
, "ipv6_nd_tll"); ; }

264 
OXM_OF_MPLS_LABEL
: {
	`Ârötf
(
°ªam
, "mpls_label"); ; }

265 
OXM_OF_MPLS_TC
: {
	`Ârötf
(
°ªam
, "mpls_tc"); ; }

266 
OXM_OF_MPLS_BOS
: {
	`Ârötf
(
°ªam
, "mpls_bos"); ; }

267 
OXM_OF_PBB_ISID
: {
	`Ârötf
(
°ªam
, "pbb_isid"); ; }

268 
OXM_OF_TUNNEL_ID
: {
	`Ârötf
(
°ªam
, "tunnel_id"); ; }

269 
OXM_OF_IPV6_EXTHDR
: {
	`Ârötf
(
°ªam
, "ipv6_exthdr"); ; }

270 : { 
	`Ârötf
(
°ªam
, "?(%d)", 
ty≥
); ; }

274 
	}
}

278 
	$oÊ_ö°ru˘i⁄_ty≥_to_°rög
(
uöt16_t
 
ty≥
) {

279 *
°r
;

280 
size_t
 
°r_size
;

281 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

283 
	`oÊ_ö°ru˘i⁄_ty≥_¥öt
(
°ªam
, 
ty≥
);

284 
	`f˛o£
(
°ªam
);

285  
°r
;

286 
	}
}

289 
	$oÊ_ö°ru˘i⁄_ty≥_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
ty≥
) {

290 
ty≥
) {

291 
OFPIT_GOTO_TABLE
: { 
	`Ârötf
(
°ªam
, "goto"); ; }

292 
OFPIT_WRITE_METADATA
: { 
	`Ârötf
(
°ªam
, "meta"); ; }

293 
OFPIT_WRITE_ACTIONS
: { 
	`Ârötf
(
°ªam
, "write"); ; }

294 
OFPIT_APPLY_ACTIONS
: { 
	`Ârötf
(
°ªam
, "apply"); ; }

295 
OFPIT_CLEAR_ACTIONS
: { 
	`Ârötf
(
°ªam
, "clear"); ; }

296 
OFPIT_METER
: { 
	`Ârötf
(
°ªam
, "meter"); ; }

297 
OFPIT_EXPERIMENTER
: { 
	`Ârötf
(
°ªam
, "exp"); ; }

298 : { 
	`Ârötf
(
°ªam
, "?(%u)", 
ty≥
); ; }

300 
	}
}

304 
	$oÊ_queue_¥›_ty≥_to_°rög
(
uöt16_t
 
ty≥
) {

305 *
°r
;

306 
size_t
 
°r_size
;

307 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

309 
	`oÊ_queue_¥›_ty≥_¥öt
(
°ªam
, 
ty≥
);

310 
	`f˛o£
(
°ªam
);

311  
°r
;

312 
	}
}

315 
	$oÊ_queue_¥›_ty≥_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
ty≥
) {

316 
ty≥
) {

317 (
OFPQT_MIN_RATE
): { 
	`Ârötf
(
°ªam
, "minrate"); ; }

318 : { 
	`Ârötf
(
°ªam
, "?(%u)", 
ty≥
); ; }

320 
	}
}

325 
	$oÊ_îr‹_ty≥_to_°rög
(
uöt16_t
 
ty≥
) {

326 *
°r
;

327 
size_t
 
°r_size
;

328 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

330 
	`oÊ_îr‹_ty≥_¥öt
(
°ªam
, 
ty≥
);

331 
	`f˛o£
(
°ªam
);

332  
°r
;

333 
	}
}

336 
	$oÊ_îr‹_ty≥_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
ty≥
) {

337 
ty≥
) {

338 (
OFPET_HELLO_FAILED
): { 
	`Ârötf
(
°ªam
, "HELLO_FAILED"); ; }

339 (
OFPET_BAD_REQUEST
): { 
	`Ârötf
(
°ªam
, "BAD_REQUEST"); ; }

340 (
OFPET_BAD_ACTION
): { 
	`Ârötf
(
°ªam
, "BAD_ACTION"); ; }

341 (
OFPET_BAD_INSTRUCTION
): { 
	`Ârötf
(
°ªam
, "BAD_INSTRUCTION"); ; }

342 (
OFPET_BAD_MATCH
): { 
	`Ârötf
(
°ªam
, "BAD_MATCH"); ; }

343 (
OFPET_FLOW_MOD_FAILED
): { 
	`Ârötf
(
°ªam
, "FLOW_MOD_FAILED"); ; }

344 (
OFPET_GROUP_MOD_FAILED
): { 
	`Ârötf
(
°ªam
, "GROUP_MOD_FAILED"); ; }

345 (
OFPET_PORT_MOD_FAILED
): { 
	`Ârötf
(
°ªam
, "PORT_MOD_FAILED"); ; }

346 (
OFPET_TABLE_MOD_FAILED
): { 
	`Ârötf
(
°ªam
, "TABLE_MOD_FAILED"); ; }

347 (
OFPET_METER_MOD_FAILED
): { 
	`Ârötf
(
°ªam
, "METER_MOD_FAILED"); ; }

348 (
OFPET_QUEUE_OP_FAILED
): { 
	`Ârötf
(
°ªam
, "QUEUE_OP_FAILED"); ; }

349 (
OFPET_SWITCH_CONFIG_FAILED
): { 
	`Ârötf
(
°ªam
, "SWITCH_CONFIG_FAILED"); ; }

350 : { 
	`Ârötf
(
°ªam
, "?(%u)", 
ty≥
); ; }

352 
	}
}

357 
	$oÊ_îr‹_code_to_°rög
(
uöt16_t
 
ty≥
, uöt16_à
code
) {

358 *
°r
;

359 
size_t
 
°r_size
;

360 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

362 
	`oÊ_îr‹_code_¥öt
(
°ªam
, 
ty≥
, 
code
);

363 
	`f˛o£
(
°ªam
);

364  
°r
;

365 
	}
}

368 
	$oÊ_îr‹_code_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
ty≥
, uöt16_à
code
) {

369 
ty≥
) {

370 (
OFPET_HELLO_FAILED
): {

371 
code
) {

372 (
OFPHFC_INCOMPATIBLE
Ë: { 
	`Ârötf
(
°ªam
, "INCOMPATIBLE"); ; }

373 (
OFPHFC_EPERM
Ë: { 
	`Ârötf
(
°ªam
, "EPERM"); ; }

377 (
OFPET_BAD_REQUEST
): {

378 
code
) {

379 (
OFPBRC_BAD_VERSION
Ë: { 
	`Ârötf
(
°ªam
, "BAD_VERSION"); ; }

380 (
OFPBRC_BAD_TYPE
Ë: { 
	`Ârötf
(
°ªam
, "BAD_TYPE"); ; }

381 (
OFPBRC_BAD_MULTIPART
Ë: { 
	`Ârötf
(
°ªam
, "OFPBRC_BAD_MULTIPART"); ; }

382 (
OFPBRC_BAD_EXPERIMENTER
Ë: { 
	`Ârötf
(
°ªam
, "BAD_EXPERIMENTER"); ; }

383 (
OFPBRC_EPERM
Ë: { 
	`Ârötf
(
°ªam
, "EPERM"); ; }

384 (
OFPBRC_BAD_LEN
Ë: { 
	`Ârötf
(
°ªam
, "BAD_LEN"); ; }

385 (
OFPBRC_BUFFER_EMPTY
Ë: { 
	`Ârötf
(
°ªam
, "BUFFER_EMPTY"); ; }

386 (
OFPBRC_BUFFER_UNKNOWN
Ë: { 
	`Ârötf
(
°ªam
, "BUFFER_UNKNOWN"); ; }

387 (
OFPBRC_BAD_TABLE_ID
Ë: { 
	`Ârötf
(
°ªam
, "BAD_TABLE_ID"); ; }

391 (
OFPET_BAD_ACTION
): {

392 
code
) {

393 (
OFPBAC_BAD_TYPE
Ë: { 
	`Ârötf
(
°ªam
, "BAD_TYPE"); ; }

394 (
OFPBAC_BAD_LEN
Ë: { 
	`Ârötf
(
°ªam
, "BAD_LEN"); ; }

395 (
OFPBAC_BAD_EXPERIMENTER
Ë: { 
	`Ârötf
(
°ªam
, "BAD_EXPERIMENTER"); ; }

396 (
OFPBAC_BAD_OUT_PORT
Ë: { 
	`Ârötf
(
°ªam
, "BAD_OUT_PORT"); ; }

397 (
OFPBAC_BAD_ARGUMENT
Ë: { 
	`Ârötf
(
°ªam
, "BAD_ARGUMENT"); ; }

398 (
OFPBAC_EPERM
Ë: { 
	`Ârötf
(
°ªam
, "EPERM"); ; }

399 (
OFPBAC_TOO_MANY
Ë: { 
	`Ârötf
(
°ªam
, "TOO_MANY"); ; }

400 (
OFPBAC_BAD_QUEUE
Ë: { 
	`Ârötf
(
°ªam
, "BAD_QUEUE"); ; }

401 (
OFPBAC_BAD_OUT_GROUP
Ë: { 
	`Ârötf
(
°ªam
, "BAD_OUT_GROUP"); ; }

402 (
OFPBAC_UNSUPPORTED_ORDER
Ë: { 
	`Ârötf
(
°ªam
, "UNSUPPORTED_ORDER"); ; }

403 (
OFPBAC_BAD_TAG
Ë: { 
	`Ârötf
(
°ªam
, "BAD_TAG"); ; }

404 (
OFPBAC_MATCH_INCONSISTENT
): { 
	`Ârötf
(
°ªam
, "MATCH_INCONSISTENT"); ;}

405 (
OFPBAC_BAD_SET_TYPE
): { 
	`Ârötf
(
°ªam
, "BAD_SET_TYPE"); ;}

406 (
OFPBAC_BAD_SET_LEN
): { 
	`Ârötf
(
°ªam
, "BAD_SET_LEN"); ;}

407 (
OFPBAC_BAD_SET_ARGUMENT
): { 
	`Ârötf
(
°ªam
, "BAD_SET_ARGUMENT"); ;}

411 (
OFPET_BAD_INSTRUCTION
): {

412 
code
) {

413 (
OFPBIC_UNKNOWN_INST
Ë: { 
	`Ârötf
(
°ªam
, "UNKNOWN_INST"); ; }

414 (
OFPBIC_BAD_TABLE_ID
Ë: { 
	`Ârötf
(
°ªam
, "BAD_TABLE_ID"); ; }

415 (
OFPBIC_UNSUP_METADATA
Ë: { 
	`Ârötf
(
°ªam
, "UNSUP_METADATA"); ; }

416 (
OFPBIC_UNSUP_METADATA_MASK
Ë: { 
	`Ârötf
(
°ªam
, "UNSUP_METADATA_MASK"); ; }

420 (
OFPET_BAD_MATCH
): {

421 
code
) {

422 (
OFPBMC_BAD_TYPE
Ë: { 
	`Ârötf
(
°ªam
, "BAD_TYPE"); ; }

423 (
OFPBMC_BAD_LEN
Ë: { 
	`Ârötf
(
°ªam
, "BAD_LEN"); ; }

424 (
OFPBMC_BAD_TAG
Ë: { 
	`Ârötf
(
°ªam
, "BAD_TAG"); ; }

425 (
OFPBMC_BAD_DL_ADDR_MASK
Ë: { 
	`Ârötf
(
°ªam
, "BAD_DL_ADDR_MASK"); ; }

426 (
OFPBMC_BAD_NW_ADDR_MASK
Ë: { 
	`Ârötf
(
°ªam
, "BAD_NW_ADDR_MASK"); ; }

427 (
OFPBMC_BAD_WILDCARDS
Ë: { 
	`Ârötf
(
°ªam
, "BAD_WILDCARDS"); ; }

428 (
OFPBMC_BAD_FIELD
Ë: { 
	`Ârötf
(
°ªam
, "BAD_FIELD"); ; }

429 (
OFPBMC_BAD_VALUE
Ë: { 
	`Ârötf
(
°ªam
, "BAD_VALUE"); ; }

430 (
OFPBMC_BAD_MASK
Ë: { 
	`Ârötf
(
°ªam
, "BAD_MASK"); ; }

431 (
OFPBMC_BAD_PREREQ
Ë: { 
	`Ârötf
(
°ªam
, "BAD_PREREQ"); ; }

432 (
OFPBMC_DUP_FIELD
Ë: { 
	`Ârötf
(
°ªam
, "DUP_FIELD"); ; }

433 (
OFPBMC_EPERM
Ë: { 
	`Ârötf
(
°ªam
, "PERMISSION ERROR"); ; }

437 (
OFPET_FLOW_MOD_FAILED
): {

438 
code
) {

439 (
OFPFMFC_UNKNOWN
Ë: { 
	`Ârötf
(
°ªam
, "UNKNOWN"); ; }

440 (
OFPFMFC_TABLE_FULL
Ë: { 
	`Ârötf
(
°ªam
, "TABLE_FULL"); ; }

441 (
OFPFMFC_BAD_TABLE_ID
Ë: { 
	`Ârötf
(
°ªam
, "BAD_TABLE_ID"); ; }

442 (
OFPFMFC_OVERLAP
Ë: { 
	`Ârötf
(
°ªam
, "OVERLAP"); ; }

443 (
OFPFMFC_EPERM
Ë: { 
	`Ârötf
(
°ªam
, "EPERM"); ; }

444 (
OFPFMFC_BAD_TIMEOUT
Ë: { 
	`Ârötf
(
°ªam
, "BAD_TIMEOUT"); ; }

445 (
OFPFMFC_BAD_COMMAND
Ë: { 
	`Ârötf
(
°ªam
, "BAD_COMMAND"); ; }

449 (
OFPET_GROUP_MOD_FAILED
): {

450 
code
) {

451 (
OFPGMFC_GROUP_EXISTS
Ë: { 
	`Ârötf
(
°ªam
, "GROUP_EXISTS"); ; }

452 (
OFPGMFC_INVALID_GROUP
Ë: { 
	`Ârötf
(
°ªam
, "INVALID_GROUP"); ; }

453 (
OFPGMFC_OUT_OF_BUCKETS
Ë: { 
	`Ârötf
(
°ªam
, "OUT_OF_BUCKETS"); ; }

454 (
OFPGMFC_CHAINING_UNSUPPORTED
Ë: { 
	`Ârötf
(
°ªam
, "CHAINING_UNSUPPORTED"); ; }

455 (
OFPGMFC_WATCH_UNSUPPORTED
Ë: { 
	`Ârötf
(
°ªam
, "UNSUPPORTED"); ; }

456 (
OFPGMFC_LOOP
Ë: { 
	`Ârötf
(
°ªam
, "LOOP"); ; }

457 (
OFPGMFC_UNKNOWN_GROUP
Ë: { 
	`Ârötf
(
°ªam
, "UNKNOWN_GROUP"); ; }

461 (
OFPET_PORT_MOD_FAILED
): {

462 
code
) {

463 (
OFPPMFC_BAD_PORT
Ë: { 
	`Ârötf
(
°ªam
, "BAD_PORT"); ; }

464 (
OFPPMFC_BAD_HW_ADDR
Ë: { 
	`Ârötf
(
°ªam
, "BAD_HW_ADDR"); ; }

465 (
OFPPMFC_BAD_CONFIG
Ë: { 
	`Ârötf
(
°ªam
, "BAD_CONFIG"); ; }

466 (
OFPPMFC_BAD_ADVERTISE
Ë: { 
	`Ârötf
(
°ªam
, "BAD_ADVERTISE"); ; }

470 (
OFPET_TABLE_MOD_FAILED
): {

471 
code
) {

472 (
OFPTMFC_BAD_TABLE
Ë: { 
	`Ârötf
(
°ªam
, "BAD_TABLE"); ; }

473 (
OFPTMFC_BAD_CONFIG
Ë: { 
	`Ârötf
(
°ªam
, "BAD_CONFIG"); ; }

477 (
OFPET_METER_MOD_FAILED
): {

478 
code
) {

479 (
OFPMMFC_METER_EXISTS
Ë: { 
	`Ârötf
(
°ªam
, "METER_EXISTS"); ; }

480 (
OFPMMFC_INVALID_METER
Ë: { 
	`Ârötf
(
°ªam
, "INVALID_METER"); ; }

481 (
OFPMMFC_UNKNOWN_METER
Ë: { 
	`Ârötf
(
°ªam
, "UNKNOWN_METER"); ; }

482 (
OFPMMFC_BAD_COMMAND
Ë: { 
	`Ârötf
(
°ªam
, "BAD_COMMAND"); ; }

483 (
OFPMMFC_BAD_FLAGS
Ë: { 
	`Ârötf
(
°ªam
, "BAD_FLAGS"); ; }

484 (
OFPMMFC_BAD_RATE
Ë: { 
	`Ârötf
(
°ªam
, "BAD_RATE"); ; }

485 (
OFPMMFC_BAD_BURST
Ë: { 
	`Ârötf
(
°ªam
, "BAD_BURST"); ; }

486 (
OFPMMFC_BAD_BAND
Ë: { 
	`Ârötf
(
°ªam
, "BAD_BAND"); ; }

487 (
OFPMMFC_BAD_BAND_VALUE
Ë: { 
	`Ârötf
(
°ªam
, "BAD_BAND_VALUE"); ; }

488 (
OFPMMFC_OUT_OF_METERS
Ë: { 
	`Ârötf
(
°ªam
, "OUT_OF_METERS"); ; }

489 (
OFPMMFC_OUT_OF_BANDS
Ë: { 
	`Ârötf
(
°ªam
, "OUT_OF_BANDS"); ; }

493 (
OFPET_QUEUE_OP_FAILED
): {

494 
code
) {

495 (
OFPQOFC_BAD_PORT
Ë: { 
	`Ârötf
(
°ªam
, "BAD_PORT"); ; }

496 (
OFPQOFC_BAD_QUEUE
Ë: { 
	`Ârötf
(
°ªam
, "BAD_QUEUE"); ; }

497 (
OFPQOFC_EPERM
Ë: { 
	`Ârötf
(
°ªam
, "EPERM"); ; }

501 (
OFPET_SWITCH_CONFIG_FAILED
): {

502 
code
) {

503 (
OFPSCFC_BAD_FLAGS
Ë: { 
	`Ârötf
(
°ªam
, "BAD_FLAGS"); ; }

504 (
OFPSCFC_BAD_LEN
Ë: { 
	`Ârötf
(
°ªam
, "BAD_LEN"); ; }

509 
	`Ârötf
(
°ªam
, "?(%u)", 
code
);

510 
	}
}

515 
	$oÊ_mesßge_ty≥_to_°rög
(
uöt16_t
 
ty≥
) {

516 *
°r
;

517 
size_t
 
°r_size
;

518 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

520 
	`oÊ_mesßge_ty≥_¥öt
(
°ªam
, 
ty≥
);

521 
	`f˛o£
(
°ªam
);

522  
°r
;

523 
	}
}

526 
	$oÊ_mesßge_ty≥_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
ty≥
) {

527 
ty≥
) {

528 
OFPT_HELLO
: { 
	`Ârötf
(
°ªam
, "hello"); ; }

529 
OFPT_ERROR
: { 
	`Ârötf
(
°ªam
, "error"); ; }

530 
OFPT_ECHO_REQUEST
: { 
	`Ârötf
(
°ªam
, "echo_req"); ; }

531 
OFPT_ECHO_REPLY
: { 
	`Ârötf
(
°ªam
, "echo_repl"); ; }

532 
OFPT_EXPERIMENTER
: { 
	`Ârötf
(
°ªam
, "exp"); ; }

533 
OFPT_FEATURES_REQUEST
: { 
	`Ârötf
(
°ªam
, "feat_req"); ; }

534 
OFPT_FEATURES_REPLY
: { 
	`Ârötf
(
°ªam
, "feat_repl"); ; }

535 
OFPT_GET_CONFIG_REQUEST
: { 
	`Ârötf
(
°ªam
, "conf_req"); ; }

536 
OFPT_GET_CONFIG_REPLY
: { 
	`Ârötf
(
°ªam
, "conf_repl"); ; }

537 
OFPT_SET_CONFIG
: { 
	`Ârötf
(
°ªam
, "set_conf"); ; }

538 
OFPT_PACKET_IN
: { 
	`Ârötf
(
°ªam
, "pkt_in"); ; }

539 
OFPT_FLOW_REMOVED
: { 
	`Ârötf
(
°ªam
, "flow_rem"); ; }

540 
OFPT_PORT_STATUS
: { 
	`Ârötf
(
°ªam
, "port_stat"); ; }

541 
OFPT_PACKET_OUT
: { 
	`Ârötf
(
°ªam
, "pkt_out"); ; }

542 
OFPT_FLOW_MOD
: { 
	`Ârötf
(
°ªam
, "flow_mod"); ; }

543 
OFPT_GROUP_MOD
: { 
	`Ârötf
(
°ªam
, "grp_mod"); ; }

544 
OFPT_PORT_MOD
: { 
	`Ârötf
(
°ªam
, "port_mod"); ; }

545 
OFPT_TABLE_MOD
: { 
	`Ârötf
(
°ªam
, "tab_mod"); ; }

546 
OFPT_MULTIPART_REQUEST
: { 
	`Ârötf
(
°ªam
, "stat_req"); ; }

547 
OFPT_MULTIPART_REPLY
: { 
	`Ârötf
(
°ªam
, "stat_repl"); ; }

548 
OFPT_BARRIER_REQUEST
: { 
	`Ârötf
(
°ªam
, "barr_req"); ; }

549 
OFPT_BARRIER_REPLY
: { 
	`Ârötf
(
°ªam
, "barr_repl"); ; }

550 
OFPT_QUEUE_GET_CONFIG_REQUEST
: { 
	`Ârötf
(
°ªam
, "q_cnf_req"); ; }

551 
OFPT_QUEUE_GET_CONFIG_REPLY
: { 
	`Ârötf
(
°ªam
, "q_cnf_repl"); ; }

552 
OFPT_GET_ASYNC_REQUEST
: { 
	`Ârötf
(
°ªam
, "get_async_req"); ;}

553 
OFPT_GET_ASYNC_REPLY
: { 
	`Ârötf
(
°ªam
, "get_async_rep"); ;}

554 
OFPT_SET_ASYNC
: { 
	`Ârötf
(
°ªam
, "set_async"); ;}

555 
OFPT_METER_MOD
: { 
	`Ârötf
(
°ªam
, "meter_mod"); ;}

556 
OFPT_ROLE_REQUEST
: { 
	`Ârötf
(
°ªam
, "role_request"); ;}

557 
OFPT_ROLE_REPLY
: { 
	`Ârötf
(
°ªam
, "role_reply"); ;}

558 : { 
	`Ârötf
(
°ªam
, "?(%u)", 
ty≥
); ; }

560 
	}
}

565 
	$oÊ_buf„r_to_°rög
(
uöt32_t
 
buf„r
) {

566 *
°r
;

567 
size_t
 
°r_size
;

568 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

570 
	`oÊ_buf„r_¥öt
(
°ªam
, 
buf„r
);

571 
	`f˛o£
(
°ªam
);

572  
°r
;

573 
	}
}

576 
	$oÊ_buf„r_¥öt
(
FILE
 *
°ªam
, 
uöt32_t
 
buf„r
) {

577 
buf„r
) {

578 (0xffffffff): { 
	`Ârötf
(
°ªam
, "none"); ; }

579 : { 
	`Ârötf
(
°ªam
, "%u", 
buf„r
); ; }

581 
	}
}

586 
	$oÊ_∑ckë_ö_ªas⁄_to_°rög
(
uöt8_t
 
ªas⁄
) {

587 *
°r
;

588 
size_t
 
°r_size
;

589 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

591 
	`oÊ_∑ckë_ö_ªas⁄_¥öt
(
°ªam
, 
ªas⁄
);

592 
	`f˛o£
(
°ªam
);

593  
°r
;

594 
	}
}

597 
	$oÊ_∑ckë_ö_ªas⁄_¥öt
(
FILE
 *
°ªam
, 
uöt8_t
 
ªas⁄
) {

598 
ªas⁄
) {

599 (
OFPR_NO_MATCH
): { 
	`Ârötf
(
°ªam
, "no_match"); ; }

600 (
OFPR_ACTION
): { 
	`Ârötf
(
°ªam
, "action"); ; }

601 : { 
	`Ârötf
(
°ªam
, "?(%u)", 
ªas⁄
); ; }

603 
	}
}

608 
	$oÊ_Êow_ªmoved_ªas⁄_to_°rög
(
uöt8_t
 
ªas⁄
) {

609 *
°r
;

610 
size_t
 
°r_size
;

611 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

613 
	`oÊ_Êow_ªmoved_ªas⁄_¥öt
(
°ªam
, 
ªas⁄
);

614 
	`f˛o£
(
°ªam
);

615  
°r
;

616 
	}
}

619 
	$oÊ_Êow_ªmoved_ªas⁄_¥öt
(
FILE
 *
°ªam
, 
uöt8_t
 
ªas⁄
) {

620 
ªas⁄
) {

621 (
OFPRR_IDLE_TIMEOUT
): { 
	`Ârötf
(
°ªam
, "idle"); ; }

622 (
OFPRR_HARD_TIMEOUT
): { 
	`Ârötf
(
°ªam
, "hard"); ; }

623 (
OFPRR_DELETE
): { 
	`Ârötf
(
°ªam
, "del"); ; }

624 (
OFPRR_GROUP_DELETE
): { 
	`Ârötf
(
°ªam
, "group"); ; }

625 (
OFPRR_METER_DELETE
): { 
	`Ârötf
(
°ªam
, "meter"); ; }

626 : { 
	`Ârötf
(
°ªam
, "?(%u)", 
ªas⁄
); ; }

628 
	}
}

633 
	$oÊ_p‹t_°©us_ªas⁄_to_°rög
(
uöt8_t
 
ªas⁄
) {

634 *
°r
;

635 
size_t
 
°r_size
;

636 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

638 
	`oÊ_p‹t_°©us_ªas⁄_¥öt
(
°ªam
, 
ªas⁄
);

639 
	`f˛o£
(
°ªam
);

640  
°r
;

641 
	}
}

644 
	$oÊ_p‹t_°©us_ªas⁄_¥öt
(
FILE
 *
°ªam
, 
uöt8_t
 
ªas⁄
) {

645 
ªas⁄
) {

646 (
OFPPR_ADD
): { 
	`Ârötf
(
°ªam
, "add"); ; }

647 (
OFPPR_DELETE
): { 
	`Ârötf
(
°ªam
, "del"); ; }

648 (
OFPPR_MODIFY
): { 
	`Ârötf
(
°ªam
, "mod"); ; }

649 : { 
	`Ârötf
(
°ªam
, "?(%u)", 
ªas⁄
); ; }

651 
	}
}

656 
	$oÊ_Êow_mod_comm™d_to_°rög
(
uöt8_t
 
comm™d
) {

657 *
°r
;

658 
size_t
 
°r_size
;

659 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

661 
	`oÊ_Êow_mod_comm™d_¥öt
(
°ªam
, 
comm™d
);

662 
	`f˛o£
(
°ªam
);

663  
°r
;

664 
	}
}

667 
	$oÊ_Êow_mod_comm™d_¥öt
(
FILE
 *
°ªam
, 
uöt8_t
 
comm™d
) {

668 
comm™d
) {

669 (
OFPFC_ADD
): { 
	`Ârötf
(
°ªam
, "add"); ; }

670 (
OFPFC_MODIFY
): { 
	`Ârötf
(
°ªam
, "mod"); ; }

671 (
OFPFC_MODIFY_STRICT
): { 
	`Ârötf
(
°ªam
, "mods"); ; }

672 (
OFPFC_DELETE
): { 
	`Ârötf
(
°ªam
, "del"); ; }

673 (
OFPFC_DELETE_STRICT
): { 
	`Ârötf
(
°ªam
, "dels"); ; }

674 : { 
	`Ârötf
(
°ªam
, "?(%u)", 
comm™d
); ; }

676 
	}
}

681 
	$oÊ_group_mod_comm™d_to_°rög
(
uöt16_t
 
comm™d
) {

682 *
°r
;

683 
size_t
 
°r_size
;

684 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

686 
	`oÊ_group_mod_comm™d_¥öt
(
°ªam
, 
comm™d
);

687 
	`f˛o£
(
°ªam
);

688  
°r
;

689 
	}
}

692 
	$oÊ_group_mod_comm™d_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
comm™d
) {

693 
comm™d
) {

694 (
OFPGC_ADD
): { 
	`Ârötf
(
°ªam
, "add"); ; }

695 (
OFPGC_MODIFY
): { 
	`Ârötf
(
°ªam
, "mod"); ; }

696 (
OFPGC_DELETE
): { 
	`Ârötf
(
°ªam
, "del"); ; }

697 : { 
	`Ârötf
(
°ªam
, "?(%u)", 
comm™d
); ; }

699 
	}
}

702 
	$oÊ_mëî_mod_comm™d_to_°rög
(
uöt16_t
 
comm™d
) {

703 *
°r
;

704 
size_t
 
°r_size
;

705 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

707 
	`oÊ_mëî_mod_comm™d_¥öt
(
°ªam
, 
comm™d
);

708 
	`f˛o£
(
°ªam
);

709  
°r
;

710 
	}
}

713 
	$oÊ_mëî_mod_comm™d_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
comm™d
){

714 
comm™d
){

715 (
OFPMC_ADD
): { 
	`Ârötf
(
°ªam
, "add"); ; }

716 (
OFPMC_MODIFY
): { 
	`Ârötf
(
°ªam
, "mod"); ; }

717 (
OFPMC_DELETE
): { 
	`Ârötf
(
°ªam
, "del"); ; }

718 : { 
	`Ârötf
(
°ªam
, "?(%u)", 
comm™d
); ;}

720 
	}
}

723 
	$oÊ_mëî_b™d_ty≥_to_°rög
(
uöt16_t
 
ty≥
) {

724 *
°r
;

725 
size_t
 
°r_size
;

726 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

728 
	`oÊ_mëî_b™d_ty≥_¥öt
(
°ªam
, 
ty≥
);

729 
	`f˛o£
(
°ªam
);

730  
°r
;

731 
	}
}

734 
	$oÊ_mëî_b™d_ty≥_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
ty≥
) {

735 
ty≥
) {

736 
OFPMBT_DROP
: { 
	`Ârötf
(
°ªam
, "drop"); ; }

737 
OFPMBT_DSCP_REMARK
: { 
	`Ârötf
(
°ªam
, "dscp_remark"); ; }

738 
OFPMBT_EXPERIMENTER
: { 
	`Ârötf
(
°ªam
, "exp"); ; }

739 : { 
	`Ârötf
(
°ªam
, "?(%u)", 
ty≥
); ; }

741 
	}
}

745 
	$oÊ_group_ty≥_to_°rög
(
uöt8_t
 
ty≥
) {

746 *
°r
;

747 
size_t
 
°r_size
;

748 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

750 
	`oÊ_group_ty≥_¥öt
(
°ªam
, 
ty≥
);

751 
	`f˛o£
(
°ªam
);

752  
°r
;

753 
	}
}

756 
	$oÊ_group_ty≥_¥öt
(
FILE
 *
°ªam
, 
uöt8_t
 
ty≥
) {

757 
ty≥
) {

758 (
OFPGT_ALL
): { 
	`Ârötf
(
°ªam
, "all"); ; }

759 (
OFPGT_SELECT
): { 
	`Ârötf
(
°ªam
, "sel"); ; }

760 (
OFPGT_INDIRECT
): { 
	`Ârötf
(
°ªam
, "ind"); ; }

761 (
OFPGT_FF
): { 
	`Ârötf
(
°ªam
, "ff"); ; }

762 : { 
	`Ârötf
(
°ªam
, "?(%u)", 
ty≥
); ; }

764 
	}
}

767 
	$oÊ_°©s_ty≥_to_°rög
(
uöt16_t
 
ty≥
) {

768 *
°r
;

769 
size_t
 
°r_size
;

770 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

771 
	`oÊ_°©s_ty≥_¥öt
(
°ªam
, 
ty≥
);

772 
	`f˛o£
(
°ªam
);

773  
°r
;

774 
	}
}

777 
	$oÊ_°©s_ty≥_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
ty≥
) {

778 
ty≥
) {

779 (
OFPMP_DESC
): { 
	`Ârötf
(
°ªam
, "desc"); ; }

780 (
OFPMP_FLOW
): { 
	`Ârötf
(
°ªam
, "flow"); ; }

781 (
OFPMP_AGGREGATE
): { 
	`Ârötf
(
°ªam
, "aggr"); ; }

782 (
OFPMP_TABLE
): { 
	`Ârötf
(
°ªam
, "table"); ; }

783 (
OFPMP_TABLE_FEATURES
):{ 
	`Ârötf
(
°ªam
, "table-features"); ; }

784 (
OFPMP_PORT_STATS
): { 
	`Ârötf
(
°ªam
, "port"); ; }

785 (
OFPMP_QUEUE
): { 
	`Ârötf
(
°ªam
, "queue"); ; }

786 (
OFPMP_GROUP
): { 
	`Ârötf
(
°ªam
, "grp"); ; }

787 (
OFPMP_GROUP_FEATURES
):{ 
	`Ârötf
(
°ªam
, "grp_features"); ; }

788 (
OFPMP_GROUP_DESC
): { 
	`Ârötf
(
°ªam
, "gdesc"); ; }

789 (
OFPMP_METER
): { 
	`Ârötf
(
°ªam
, "mstats"); ; }

790 (
OFPMP_METER_CONFIG
): { 
	`Ârötf
(
°ªam
, "mconf"); ; }

791 (
OFPMP_METER_FEATURES
):{ 
	`Ârötf
(
°ªam
, "mfeat"); ; }

792 (
OFPMP_PORT_DESC
): { 
	`Ârötf
(
°ªam
, "port-desc"); ; }

793 (
OFPMP_EXPERIMENTER
): { 
	`Ârötf
(
°ªam
, "exp"); ; }

794 : { 
	`Ârötf
(
°ªam
, "?(%u)", 
ty≥
); ; }

796 
	}
}

799 
	$oÊ_¥›îtõs_ty≥_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
ty≥
){

800 
ty≥
){

801 (
OFPTFPT_INSTRUCTIONS
): { 
	`Ârötf
(
°ªam
, "instructions"); ; }

802 (
OFPTFPT_INSTRUCTIONS_MISS
): { 
	`Ârötf
(
°ªam
, "instructions_miss"); ; }

803 (
OFPTFPT_NEXT_TABLES
): { 
	`Ârötf
(
°ªam
, "next_tables"); ; }

804 (
OFPTFPT_NEXT_TABLES_MISS
): { 
	`Ârötf
(
°ªam
, "next_tables_miss"); ; }

805 (
OFPTFPT_WRITE_ACTIONS
): { 
	`Ârötf
(
°ªam
, "write_actions"); ; }

806 (
OFPTFPT_WRITE_ACTIONS_MISS
): { 
	`Ârötf
(
°ªam
, "write_actions_miss"); ; }

807 (
OFPTFPT_APPLY_ACTIONS
): { 
	`Ârötf
(
°ªam
, "apply_actions"); ; }

808 (
OFPTFPT_APPLY_ACTIONS_MISS
): { 
	`Ârötf
(
°ªam
, "apply_actions_miss"); ; }

809 (
OFPTFPT_MATCH
): { 
	`Ârötf
(
°ªam
, "oxms"); ; }

810 (
OFPTFPT_WILDCARDS
): { 
	`Ârötf
(
°ªam
, "wildcards"); ; }

811 (
OFPTFPT_WRITE_SETFIELD
): { 
	`Ârötf
(
°ªam
, "write_setfield"); ; }

812 (
OFPTFPT_WRITE_SETFIELD_MISS
):{ 
	`Ârötf
(
°ªam
, "write_setfield_miss"); ; }

813 (
OFPTFPT_APPLY_SETFIELD
): { 
	`Ârötf
(
°ªam
, "apply_setfield"); ; }

814 (
OFPTFPT_APPLY_SETFIELD_MISS
):{ 
	`Ârötf
(
°ªam
, "apply_setfield_miss"); ; }

815 (
OFPTFPT_EXPERIMENTER
): { 
	`Ârötf
(
°ªam
, "experimenter"); ; }

816 (
OFPTFPT_EXPERIMENTER_MISS
): { 
	`Ârötf
(
°ªam
, "experimenter_miss"); ; }

817 : { 
	`Ârötf
(
°ªam
, "?(%u)", 
ty≥
); ; }

819 
	}
}

823 
	$oÊ_async_∑ckë_ö
(
FILE
 *
°ªam
, 
uöt32_t
 
∑ckë_ö_mask
){

824 
boﬁ
 
e
 = 
Ál£
;

826 
	`Ârötf
(
°ªam
, "packet_in(" );

827 if(
∑ckë_ö_mask
 & (1 << 0)){

828 
	`Ârötf
(
°ªam
, "no_match");

829 
e
 = 
åue
;

831 if(
∑ckë_ö_mask
 & ((1 << 1))){

832 if(
e
)

833 
	`Ârötf
(
°ªam
,", ");

834 
	`Ârötf
(
°ªam
, "action");

835 
e
 = 
åue
;

837 if(
∑ckë_ö_mask
 & ((1 << 2))){

838 if(
e
)

839 
	`Ârötf
(
°ªam
,", ");

840 
	`Ârötf
(
°ªam
, "invalid_ttl");

841 
e
 = 
åue
;

843 i‡(!
e
)

844 
	`Ârötf
(
°ªam
, "none");

845 
	`Ârötf
(
°ªam
, ")" );

846 
	}
}

849 
	$oÊ_async_p‹t_°©us
(
FILE
 *
°ªam
, 
uöt32_t
 
p‹t_°©us_mask
){

850 
boﬁ
 
e
 = 
Ál£
;

852 
	`Ârötf
(
°ªam
, "port_status(" );

853 if(
p‹t_°©us_mask
& (1 << 0)){

854 
	`Ârötf
(
°ªam
, "add");

855 
e
 = 
åue
;

857 if(
p‹t_°©us_mask
 & ((1 << 1))){

858 if(
e
)

859 
	`Ârötf
(
°ªam
,", ");

860 
	`Ârötf
(
°ªam
, "delete");

861 
e
 = 
åue
;

863 if(
p‹t_°©us_mask
 & ((1 << 2))){

864 if(
e
)

865 
	`Ârötf
(
°ªam
,", ");

866 
	`Ârötf
(
°ªam
, "modify");

867 
e
 = 
åue
;

869 i‡(!
e
)

870 
	`Ârötf
(
°ªam
, "none");

871 
	`Ârötf
(
°ªam
, ")" );

872 
	}
}

875 
	$oÊ_async_Êow_ªmoved
(
FILE
 *
°ªam
, 
uöt32_t
 
Êow_ªm_mask
){

876 
boﬁ
 
e
 = 
Ál£
;

878 
	`Ârötf
(
°ªam
, "flow_removed(" );

879 if(
Êow_ªm_mask
 & (1 << 0)){

880 
	`Ârötf
(
°ªam
, "idle_timeout");

881 
e
 = 
åue
;

883 if(
Êow_ªm_mask
 & ((1 << 1))){

884 if(
e
)

885 
	`Ârötf
(
°ªam
,", ");

886 
	`Ârötf
(
°ªam
, "hard_timeout");

887 
e
 = 
åue
;

889 if(
Êow_ªm_mask
 & ((1 << 2))){

890 if(
e
)

891 
	`Ârötf
(
°ªam
,", ");

892 
	`Ârötf
(
°ªam
, "delete");

893 
e
 = 
åue
;

895 if(
Êow_ªm_mask
 & ((1 << 3))){

896 if(
e
)

897 
	`Ârötf
(
°ªam
,", ");

898 
	`Ârötf
(
°ªam
, "group delete");

899 
e
 = 
åue
;

901 if(
Êow_ªm_mask
 & ((1 << 4))){

902 if(
e
)

903 
	`Ârötf
(
°ªam
,", ");

904 
	`Ârötf
(
°ªam
, "meter delete");

905 
e
 = 
åue
;

907 i‡(!
e
)

908 
	`Ârötf
(
°ªam
, "none");

910 
	`Ârötf
(
°ªam
, ")" );

911 
	}
}

914 
	$oÊ_hex_to_°rög
(
uöt8_t
 *
buf
, 
size_t
 
buf_size
) {

915 *
°r
;

916 
size_t
 
°r_size
;

917 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

918 
	`oÊ_hex_¥öt
(
°ªam
, 
buf
, 
buf_size
);

919 
	`f˛o£
(
°ªam
);

920  
°r
;

921 
	}
}

924 
	$oÊ_hex_¥öt
(
FILE
 *
°ªam
, 
uöt8_t
 *
buf
, 
size_t
 
buf_size
) {

925 
size_t
 
i
;

926 
size_t
 
löes
 = 0;

928 
i
=0; i < 
buf_size
; i++) {

929 i‡(
i
 % 16 == 0) {

930 i‡(
löes
 > 0) {

931 
	`Ârötf
(
°ªam
, "\n");

933 
löes
++;

934 
	`Ârötf
(
°ªam
, "%04zu %02"
PRIx8
"", 
i
, 
buf
[i]);

935 } i‡–
i
 % 8 == 0) {

936 
	`Ârötf
(
°ªam
, " %02"
PRIx8
"", 
buf
[
i
]);

938 
	`Ârötf
(
°ªam
, " %02"
PRIx8
"", 
buf
[
i
]);

941 
	}
}

	@oflib/ofl-print.h

32 #i‚de‡
OFL_PRINT_H


33 
	#OFL_PRINT_H
 1

	)

35 
	~<sys/ty≥s.h
>

36 
	~<öây≥s.h
>

37 
	~<°dio.h
>

39 
	~"oÊ.h
"

40 
	~"oÊ-¥öt.h
"

48 
oÊ_p‹t_to_°rög
(
uöt32_t
 
p‹t
);

51 
oÊ_p‹t_¥öt
(
FILE
 *
°ªam
, 
uöt32_t
 
p‹t
);

54 
oÊ_ùv6_ext_hdr_to_°rög
(
uöt16_t
 
ext_hdr
);

57 
oÊ_ùv6_ext_hdr_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
ext_hdr
);

60 
oÊ_queue_to_°rög
(
uöt32_t
 
queue
);

63 
oÊ_queue_¥öt
(
FILE
 *
°ªam
, 
uöt32_t
 
queue
);

66 
oÊ_group_to_°rög
(
uöt32_t
 
group
);

69 
oÊ_group_¥öt
(
FILE
 *
°ªam
, 
uöt32_t
 
group
);

72 
oÊ_èbÀ_to_°rög
(
uöt8_t
 
èbÀ
);

75 
oÊ_èbÀ_¥öt
(
FILE
 *
°ªam
, 
uöt8_t
 
èbÀ
);

78 
oÊ_vœn_vid_to_°rög
(
uöt32_t
 
vid
);

81 
oÊ_vœn_vid_¥öt
(
FILE
 *
°ªam
, 
uöt32_t
 
vid
);

84 
oÊ_a˘i⁄_ty≥_to_°rög
(
uöt16_t
 
ty≥
);

87 
oÊ_a˘i⁄_ty≥_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
ty≥
);

90 
oÊ_oxm_ty≥_to_°rög
(
uöt16_t
 
ty≥
);

93 
oÊ_oxm_ty≥_¥öt
(
FILE
 *
°ªam
, 
uöt32_t
 
ty≥
);

96 
oÊ_ö°ru˘i⁄_ty≥_to_°rög
(
uöt16_t
 
ty≥
);

99 
oÊ_ö°ru˘i⁄_ty≥_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
ty≥
);

102 
oÊ_queue_¥›_ty≥_to_°rög
(
uöt16_t
 
ty≥
);

105 
oÊ_queue_¥›_ty≥_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
ty≥
);

108 
oÊ_îr‹_ty≥_to_°rög
(
uöt16_t
 
ty≥
);

111 
oÊ_îr‹_ty≥_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
ty≥
);

114 
oÊ_îr‹_code_to_°rög
(
uöt16_t
 
ty≥
, uöt16_à
code
);

117 
oÊ_îr‹_code_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
ty≥
, uöt16_à
code
);

120 
oÊ_mesßge_ty≥_to_°rög
(
uöt16_t
 
ty≥
);

123 
oÊ_mesßge_ty≥_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
ty≥
);

126 
oÊ_buf„r_to_°rög
(
uöt32_t
 
buf„r
);

129 
oÊ_buf„r_¥öt
(
FILE
 *
°ªam
, 
uöt32_t
 
buf„r
);

132 
oÊ_∑ckë_ö_ªas⁄_to_°rög
(
uöt8_t
 
ªas⁄
);

135 
oÊ_∑ckë_ö_ªas⁄_¥öt
(
FILE
 *
°ªam
, 
uöt8_t
 
ªas⁄
);

138 
oÊ_Êow_ªmoved_ªas⁄_to_°rög
(
uöt8_t
 
ªas⁄
);

141 
oÊ_Êow_ªmoved_ªas⁄_¥öt
(
FILE
 *
°ªam
, 
uöt8_t
 
ªas⁄
);

144 
oÊ_p‹t_°©us_ªas⁄_to_°rög
(
uöt8_t
 
ªas⁄
);

147 
oÊ_p‹t_°©us_ªas⁄_¥öt
(
FILE
 *
°ªam
, 
uöt8_t
 
ªas⁄
);

150 
oÊ_Êow_mod_comm™d_to_°rög
(
uöt8_t
 
comm™d
);

153 
oÊ_Êow_mod_comm™d_¥öt
(
FILE
 *
°ªam
, 
uöt8_t
 
comm™d
);

156 
oÊ_group_mod_comm™d_to_°rög
(
uöt16_t
 
comm™d
);

159 
oÊ_group_mod_comm™d_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
comm™d
);

162 
oÊ_mëî_mod_comm™d_to_°rög
(
uöt16_t
 
comm™d
);

165 
oÊ_mëî_mod_comm™d_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
comm™d
);

168 
oÊ_mëî_b™d_ty≥_to_°rög
(
uöt16_t
 
ty≥
);

171 
oÊ_mëî_b™d_ty≥_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
ty≥
);

174 
oÊ_group_ty≥_to_°rög
(
uöt8_t
 
ty≥
);

177 
oÊ_group_ty≥_¥öt
(
FILE
 *
°ªam
, 
uöt8_t
 
ty≥
);

180 
oÊ_°©s_ty≥_to_°rög
(
uöt16_t
 
ty≥
);

183 
oÊ_°©s_ty≥_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
ty≥
);

186 
oÊ_¥›îtõs_ty≥_¥öt
(
FILE
 *
°ªam
, 
uöt16_t
 
ty≥
);

189 
oÊ_async_∑ckë_ö
(
FILE
 *
°ªam
, 
uöt32_t
 
∑ckë_ö_mask
);

192 
oÊ_async_p‹t_°©us
(
FILE
 *
°ªam
, 
uöt32_t
 
p‹t_°©us_mask
);

195 
oÊ_async_Êow_ªmoved
(
FILE
 *
°ªam
, 
uöt32_t
 
Êow_ªm_mask
);

198 
oÊ_hex_to_°rög
(
uöt8_t
 *
buf
, 
size_t
 
buf_size
);

201 
oÊ_hex_¥öt
(
FILE
 *
°ªam
, 
uöt8_t
 *
buf
, 
size_t
 
buf_size
);

	@oflib/ofl-structs-match.c

31 
	~"oÊ-°ru˘s.h
"

32 
	~"lib/hash.h
"

33 
	~"oxm-m©ch.h
"

36 
	$oÊ_°ru˘s_m©ch_öô
(
oÊ_m©ch
 *
m©ch
){

38 
m©ch
->
hódî
.
ty≥
 = 
OFPMT_OXM
;

39 
m©ch
->
hódî
.
Àngth
 = 0;

40 
m©ch
->
m©ch_fõlds
 = (
hm≠
Ë
	`HMAP_INITIALIZER
(&match->match_fields);

41 
	}
}

45 
	$oÊ_°ru˘s_m©ch_put8
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, 
uöt8_t
 
vÆue
){

46 
oÊ_m©ch_év
 *
m
 = 
	`mÆloc
( (ofl_match_tlv));

47 
Àn
 = (
uöt8_t
);

49 
m
->
hódî
 = header;

50 
m
->
vÆue
 = 
	`mÆloc
(
Àn
);

51 
	`mem˝y
(
m
->
vÆue
, &vÆue, 
Àn
);

52 
	`hm≠_ö£π
(&
m©ch
->
m©ch_fõlds
,&
m
->
hm≠_node
,
	`hash_öt
(
hódî
, 0));

53 
m©ch
->
hódî
.
Àngth
 +
Àn
 + 4;

54 
	}
}

57 
	$oÊ_°ru˘s_m©ch_put8m
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, 
uöt8_t
 
vÆue
, uöt8_à
mask
){

58 
oÊ_m©ch_év
 *
m
 = 
	`mÆloc
( (ofl_match_tlv));

59 
Àn
 = (
uöt8_t
);

61 
m
->
hódî
 = header;

62 
m
->
vÆue
 = 
	`mÆloc
(
Àn
*2);

63 
	`mem˝y
(
m
->
vÆue
, &vÆue, 
Àn
);

64 
	`mem˝y
(
m
->
vÆue
 + 
Àn
, &
mask
,Üen);

65 
	`hm≠_ö£π
(&
m©ch
->
m©ch_fõlds
,&
m
->
hm≠_node
,
	`hash_öt
(
hódî
, 0));

66 
m©ch
->
hódî
.
Àngth
 +
Àn
*2 + 4;

67 
	}
}

70 
	$oÊ_°ru˘s_m©ch_put16
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, 
uöt16_t
 
vÆue
){

71 
oÊ_m©ch_év
 *
m
 = 
	`mÆloc
( (ofl_match_tlv));

72 
Àn
 = (
uöt16_t
);

74 
m
->
hódî
 = header;

75 
m
->
vÆue
 = 
	`mÆloc
(
Àn
);

76 
	`mem˝y
(
m
->
vÆue
, &vÆue, 
Àn
);

77 
	`hm≠_ö£π
(&
m©ch
->
m©ch_fõlds
,&
m
->
hm≠_node
,
	`hash_öt
(
hódî
, 0));

78 
m©ch
->
hódî
.
Àngth
 +
Àn
 + 4;

79 
	}
}

83 
	$oÊ_°ru˘s_m©ch_put16m
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, 
uöt16_t
 
vÆue
, uöt16_à
mask
){

84 
oÊ_m©ch_év
 *
m
 = 
	`mÆloc
( (ofl_match_tlv));

85 
Àn
 = (
uöt16_t
);

87 
m
->
hódî
 = header;

88 
m
->
vÆue
 = 
	`mÆloc
(
Àn
*2);

89 
	`mem˝y
(
m
->
vÆue
, &vÆue, 
Àn
);

90 
	`mem˝y
(
m
->
vÆue
 + 
Àn
, &
mask
,Üen);

91 
	`hm≠_ö£π
(&
m©ch
->
m©ch_fõlds
,&
m
->
hm≠_node
,
	`hash_öt
(
hódî
, 0));

92 
m©ch
->
hódî
.
Àngth
 +
Àn
*2 + 4;

93 
	}
}

96 
	$oÊ_°ru˘s_m©ch_put32
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, uöt32_à
vÆue
){

97 
oÊ_m©ch_év
 *
m
 = 
	`xmÆloc
( (ofl_match_tlv));

99 
Àn
 = (
uöt32_t
);

101 
m
->
hódî
 = header;

102 
m
->
vÆue
 = 
	`mÆloc
(
Àn
);

103 
	`mem˝y
(
m
->
vÆue
, &vÆue, 
Àn
);

104 
	`hm≠_ö£π
(&
m©ch
->
m©ch_fõlds
,&
m
->
hm≠_node
,
	`hash_öt
(
hódî
, 0));

105 
m©ch
->
hódî
.
Àngth
 +
Àn
 + 4;

107 
	}
}

110 
	$oÊ_°ru˘s_m©ch_put32m
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, uöt32_à
vÆue
, uöt32_à
mask
){

111 
oÊ_m©ch_év
 *
m
 = 
	`mÆloc
( (ofl_match_tlv));

112 
Àn
 = (
uöt32_t
);

114 
m
->
hódî
 = header;

115 
m
->
vÆue
 = 
	`mÆloc
(
Àn
*2);

116 
	`mem˝y
(
m
->
vÆue
, &vÆue, 
Àn
);

117 
	`mem˝y
(
m
->
vÆue
 + 
Àn
, &
mask
,Üen);

118 
	`hm≠_ö£π
(&
m©ch
->
m©ch_fõlds
,&
m
->
hm≠_node
,
	`hash_öt
(
hódî
, 0));

119 
m©ch
->
hódî
.
Àngth
 +
Àn
*2 + 4;

121 
	}
}

124 
	$oÊ_°ru˘s_m©ch_put64
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, 
uöt64_t
 
vÆue
){

125 
oÊ_m©ch_év
 *
m
 = 
	`mÆloc
( (ofl_match_tlv));

126 
Àn
 = (
uöt64_t
);

128 
m
->
hódî
 = header;

129 
m
->
vÆue
 = 
	`mÆloc
(
Àn
);

130 
	`mem˝y
(
m
->
vÆue
, &vÆue, 
Àn
);

131 
	`hm≠_ö£π
(&
m©ch
->
m©ch_fõlds
,&
m
->
hm≠_node
,
	`hash_öt
(
hódî
, 0));

132 
m©ch
->
hódî
.
Àngth
 +
Àn
 + 4;

134 
	}
}

137 
	$oÊ_°ru˘s_m©ch_put64m
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, 
uöt64_t
 
vÆue
, uöt64_à
mask
){

138 
oÊ_m©ch_év
 *
m
 = 
	`mÆloc
( (ofl_match_tlv));

139 
Àn
 = (
uöt64_t
);

141 
m
->
hódî
 = header;

142 
m
->
vÆue
 = 
	`mÆloc
(
Àn
*2);

143 
	`mem˝y
(
m
->
vÆue
, &vÆue, 
Àn
);

144 
	`mem˝y
(
m
->
vÆue
 + 
Àn
, &
mask
,Üen);

145 
	`hm≠_ö£π
(&
m©ch
->
m©ch_fõlds
,&
m
->
hm≠_node
,
	`hash_öt
(
hódî
, 0));

146 
m©ch
->
hódî
.
Àngth
 +
Àn
*2 + 4;

148 
	}
}

151 
	$oÊ_°ru˘s_m©ch_put_ëh
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, 
uöt8_t
 
vÆue
[
ETH_ADDR_LEN
]){

152 
oÊ_m©ch_év
 *
m
 = 
	`mÆloc
( (ofl_match_tlv));

153 
Àn
 = 
ETH_ADDR_LEN
;

155 
m
->
hódî
 = header;

156 
m
->
vÆue
 = 
	`mÆloc
(
Àn
);

157 
	`mem˝y
(
m
->
vÆue
, vÆue, 
Àn
);

158 
	`hm≠_ö£π
(&
m©ch
->
m©ch_fõlds
,&
m
->
hm≠_node
,
	`hash_öt
(
hódî
, 0));

159 
m©ch
->
hódî
.
Àngth
 +
Àn
 + 4;

161 
	}
}

164 
	$oÊ_°ru˘s_m©ch_put_ëh_m
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, 
uöt8_t
 
vÆue
[
ETH_ADDR_LEN
], uöt8_à
mask
[ETH_ADDR_LEN]){

165 
oÊ_m©ch_év
 *
m
 = 
	`mÆloc
( (ofl_match_tlv));

166 
Àn
 = 
ETH_ADDR_LEN
;

168 
m
->
hódî
 = header;

169 
m
->
vÆue
 = 
	`mÆloc
(
Àn
*2);

170 
	`mem˝y
(
m
->
vÆue
, vÆue, 
Àn
);

171 
	`mem˝y
(
m
->
vÆue
 + 
Àn
, 
mask
,Üen);

172 
	`hm≠_ö£π
(&
m©ch
->
m©ch_fõlds
,&
m
->
hm≠_node
,
	`hash_öt
(
hódî
, 0));

173 
m©ch
->
hódî
.
Àngth
 +
Àn
*2 + 4;

175 
	}
}

178 
	$oÊ_°ru˘s_m©ch_put_ùv6
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, 
uöt8_t
 
vÆue
[
IPv6_ADDR_LEN
]){

180 
oÊ_m©ch_év
 *
m
 = 
	`mÆloc
( (ofl_match_tlv));

181 
Àn
 = 
IPv6_ADDR_LEN
;

183 
m
->
hódî
 = header;

184 
m
->
vÆue
 = 
	`mÆloc
(
Àn
);

185 
	`mem˝y
(
m
->
vÆue
, vÆue, 
Àn
);

186 
	`hm≠_ö£π
(&
m©ch
->
m©ch_fõlds
,&
m
->
hm≠_node
,
	`hash_öt
(
hódî
, 0));

187 
m©ch
->
hódî
.
Àngth
 +
Àn
 + 4;

189 
	}
}

192 
	$oÊ_°ru˘s_m©ch_put_ùv6m
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, 
uöt8_t
 
vÆue
[
IPv6_ADDR_LEN
], uöt8_à
mask
[IPv6_ADDR_LEN]){

193 
oÊ_m©ch_év
 *
m
 = 
	`mÆloc
( (ofl_match_tlv));

194 
Àn
 = 
IPv6_ADDR_LEN
;

196 
m
->
hódî
 = header;

197 
m
->
vÆue
 = 
	`mÆloc
(
Àn
*2);

198 
	`mem˝y
(
m
->
vÆue
, vÆue, 
Àn
);

199 
	`mem˝y
(
m
->
vÆue
 + 
Àn
, 
mask
,Üen);

200 
	`hm≠_ö£π
(&
m©ch
->
m©ch_fõlds
,&
m
->
hm≠_node
,
	`hash_öt
(
hódî
, 0));

201 
m©ch
->
hódî
.
Àngth
 +
Àn
*2 + 4;

203 
	}
}

	@oflib/ofl-structs-pack.c

32 
	~<°dlib.h
>

33 
	~<°rög.h
>

34 
	~<√töë/ö.h
>

36 
	~"ö˛ude/›íÊow/›íÊow.h
"

37 
	~"oxm-m©ch.h
"

38 
	~"oÊ.h
"

39 
	~"oÊ-a˘i⁄s.h
"

40 
	~"oÊ-°ru˘s.h
"

41 
	~"oÊ-utûs.h
"

42 
	~"oÊ-log.h
"

43 
	~"oÊ-∑ckës.h
"

46 
	#LOG_MODULE
 
oÊ_°r_p


	)

47 
	$OFL_LOG_INIT
(
LOG_MODULE
)

50 
size_t


51 
	$oÊ_°ru˘s_ö°ru˘i⁄s_oÂ_Àn
(
oÊ_ö°ru˘i⁄_hódî
 *
ö°ru˘i⁄
, 
oÊ_exp
 *
exp
) {

52 
ö°ru˘i⁄
->
ty≥
) {

53 
OFPIT_GOTO_TABLE
: {

54  (
oÂ_ö°ru˘i⁄_gŸo_èbÀ
);

56 
OFPIT_WRITE_METADATA
: {

57  (
oÂ_ö°ru˘i⁄_wrôe_mëad©a
);

59 
OFPIT_WRITE_ACTIONS
:

60 
OFPIT_APPLY_ACTIONS
: {

61 
oÊ_ö°ru˘i⁄_a˘i⁄s
 *
i
 = (oÊ_ö°ru˘i⁄_a˘i⁄†*)
ö°ru˘i⁄
;

63  (
oÂ_ö°ru˘i⁄_a˘i⁄s
)

64 + 
	`oÊ_a˘i⁄s_oÂ_tŸÆ_Àn
(
i
->
a˘i⁄s
, i->
a˘i⁄s_num
, 
exp
);

66 
OFPIT_CLEAR_ACTIONS
: {

67  (
oÂ_ö°ru˘i⁄_a˘i⁄s
);

69 
OFPIT_METER
:{

70  (
oÂ_ö°ru˘i⁄_mëî
);

72 
OFPIT_SET_STATE
:{

73  (
oÂ_ö°ru˘i⁄_£t_°©e
);

75 
OFPIT_EXPERIMENTER
: {

76 i‡(
exp
 =
NULL
 ||Éxp->
ö°
 =NULL ||Éxp->ö°->
oÂ_Àn
 == NULL) {

77 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÜenÉxperimenter instruction, butÇo callback was given.");

80  
exp
->
ö°
->
	`oÂ_Àn
(
ö°ru˘i⁄
);

83 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÜen unknown instructionÅype.");

86 
	}
}

88 
size_t


89 
	$oÊ_°ru˘s_ö°ru˘i⁄s_oÂ_tŸÆ_Àn
(
oÊ_ö°ru˘i⁄_hódî
 **
ö°ru˘i⁄s
, 
size_t
 
ö°ru˘i⁄s_num
, 
oÊ_exp
 *
exp
) {

90 
size_t
 
sum
;

91 
	`OFL_UTILS_SUM_ARR_FUN2
(
sum
, 
ö°ru˘i⁄s
, 
ö°ru˘i⁄s_num
,

92 
oÊ_°ru˘s_ö°ru˘i⁄s_oÂ_Àn
, 
exp
);

93  
sum
;

94 
	}
}

96 
size_t


97 
	$oÊ_°ru˘s_ö°ru˘i⁄s_∑ck
(
oÊ_ö°ru˘i⁄_hódî
 *
§c
, 
oÂ_ö°ru˘i⁄
 *
d°
, 
oÊ_exp
 *
exp
) {

99 
d°
->
ty≥
 = 
	`ht⁄s
(
§c
->type);

100 
	`mem£t
(
d°
->
∑d
, 0x00, 4);

102 
§c
->
ty≥
) {

103 
OFPIT_GOTO_TABLE
: {

104 
oÊ_ö°ru˘i⁄_gŸo_èbÀ
 *
si
 = (oÊ_ö°ru˘i⁄_gŸo_èbÀ *)
§c
;

105 
oÂ_ö°ru˘i⁄_gŸo_èbÀ
 *
di
 = (oÂ_ö°ru˘i⁄_gŸo_èbÀ *)
d°
;

107 
di
->
Àn
 = 
	`ht⁄s
((
oÂ_ö°ru˘i⁄_gŸo_èbÀ
));

108 
di
->
èbÀ_id
 = 
si
->table_id;

109 
	`mem£t
(
di
->
∑d
, 0x00, 3);

111  (
oÂ_ö°ru˘i⁄_gŸo_èbÀ
);

113 
OFPIT_WRITE_METADATA
: {

114 
oÊ_ö°ru˘i⁄_wrôe_mëad©a
 *
si
 = (oÊ_ö°ru˘i⁄_wrôe_mëad©®*)
§c
;

115 
oÂ_ö°ru˘i⁄_wrôe_mëad©a
 *
di
 = (oÂ_ö°ru˘i⁄_wrôe_mëad©®*)
d°
;

117 
di
->
Àn
 = 
	`ht⁄s
((
oÂ_ö°ru˘i⁄_wrôe_mëad©a
));

118 
	`mem£t
(
di
->
∑d
, 0x00, 4);

119 
di
->
mëad©a
 = 
	`ht⁄64
(
si
->metadata);

120 
di
->
mëad©a_mask
 = 
	`ht⁄64
(
si
->metadata_mask);

122  (
oÂ_ö°ru˘i⁄_wrôe_mëad©a
);

124 
OFPIT_WRITE_ACTIONS
:

125 
OFPIT_APPLY_ACTIONS
: {

126 
size_t
 
tŸÆ_Àn
, 
Àn
;

127 
uöt8_t
 *
d©a
;

128 
size_t
 
i
;

130 
oÊ_ö°ru˘i⁄_a˘i⁄s
 *
si
 = (oÊ_ö°ru˘i⁄_a˘i⁄†*)
§c
;

131 
oÂ_ö°ru˘i⁄_a˘i⁄s
 *
di
 = (oÂ_ö°ru˘i⁄_a˘i⁄†*)
d°
;

133 
tŸÆ_Àn
 = (
oÂ_ö°ru˘i⁄_a˘i⁄s
Ë+ 
	`oÊ_a˘i⁄s_oÂ_tŸÆ_Àn
(
si
->
a˘i⁄s
, si->
a˘i⁄s_num
, 
exp
);

135 
di
->
Àn
 = 
	`ht⁄s
(
tŸÆ_Àn
);

136 
	`mem£t
(
di
->
∑d
, 0x00, 4);

137 
d©a
 = (
uöt8_t
 *)
d°
 + (
oÂ_ö°ru˘i⁄_a˘i⁄s
);

139 
i
=0; i<
si
->
a˘i⁄s_num
; i++) {

140 
Àn
 = 
	`oÊ_a˘i⁄s_∑ck
(
si
->
a˘i⁄s
[
i
], (
oÂ_a˘i⁄_hódî
 *)
d©a
, d©a, 
exp
);

141 
d©a
 +
Àn
;

143  
tŸÆ_Àn
;

145 
OFPIT_CLEAR_ACTIONS
: {

146 
size_t
 
tŸÆ_Àn
;

148 
oÂ_ö°ru˘i⁄_a˘i⁄s
 *
di
 = (oÂ_ö°ru˘i⁄_a˘i⁄†*)
d°
;

150 
tŸÆ_Àn
 = (
oÂ_ö°ru˘i⁄_a˘i⁄s
);

152 
di
->
Àn
 = 
	`ht⁄s
(
tŸÆ_Àn
);

153 
	`mem£t
(
di
->
∑d
, 0x00, 4);

155  
tŸÆ_Àn
;

157 
OFPIT_METER
: {

158 
oÊ_ö°ru˘i⁄_mëî
 *
si
 = (oÊ_ö°ru˘i⁄_mëî *Ë
§c
;

159 
oÂ_ö°ru˘i⁄_mëî
 *
di
 = (oÂ_ö°ru˘i⁄_mëî *Ë
d°
;

161 
di
->
Àn
 = 
	`ht⁄s
((
oÂ_ö°ru˘i⁄_mëî
));

162 
di
->
mëî_id
 = 
	`ht⁄l
(
si
->meter_id);

164  (
oÂ_ö°ru˘i⁄_mëî
);

166 
OFPIT_SET_STATE
: {

167 
oÊ_ö°ru˘i⁄_£t_°©e
 *
si
 = (oÊ_ö°ru˘i⁄_£t_°©ê*Ë
§c
;

168 
oÂ_ö°ru˘i⁄_£t_°©e
 *
di
 = (oÂ_ö°ru˘i⁄_£t_°©ê*Ë
d°
;

170 
di
->
Àn
 = 
	`ht⁄s
((
oÂ_ö°ru˘i⁄_£t_°©e
));

171 
di
->
°©e
 = 
	`ht⁄l
(
si
->state);

173  (
oÂ_ö°ru˘i⁄_£t_°©e
);

175 
OFPIT_EXPERIMENTER
: {

176 i‡(
exp
 =
NULL
 ||Éxp->
ö°
 =NULL ||Éxp->ö°->
∑ck
 == NULL) {

177 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÖackÉxperimenter instruction, butÇo callback was given.");

180  
exp
->
ö°
->
	`∑ck
((
oÊ_ö°ru˘i⁄_hódî
 *)
§c
, 
d°
);

183 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÖack unknown instructionÅype.");

186 
	}
}

188 
size_t


189 
	$oÊ_°ru˘s_mëî_b™d_oÂ_Àn
(
oÊ_mëî_b™d_hódî
 *
mëî_b™d
) {

190 
mëî_b™d
->
ty≥
) {

191 
OFPMBT_DROP
:

192  (
oÂ_mëî_b™d_dr›
);

193 
OFPMBT_DSCP_REMARK
:

194  (
oÂ_mëî_b™d_ds˝_ªm¨k
);

195 
OFPMBT_EXPERIMENTER
:

196  (
oÂ_mëî_b™d_ex≥rimíãr
);

198 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÜen unknown meterÅype.");

201 
	}
}

203 
size_t


204 
	$oÊ_°ru˘s_mëî_b™ds_oÂ_tŸÆ_Àn
(
oÊ_mëî_b™d_hódî
 **
mëî_b™ds
, 
size_t
 
mëî_b™ds_num
) {

205 
size_t
 
sum
;

206 
	`OFL_UTILS_SUM_ARR_FUN
(
sum
, 
mëî_b™ds
, 
mëî_b™ds_num
,

207 
oÊ_°ru˘s_mëî_b™d_oÂ_Àn
);

208  
sum
;

209 
	}
}

211 
size_t


212 
	$oÊ_°ru˘s_mëî_b™d_∑ck
(
oÊ_mëî_b™d_hódî
 *
§c
, 
oÂ_mëî_b™d_hódî
 *
d°
){

214 
d°
->
ty≥
 = 
	`ht⁄s
(
§c
->type);

215 
d°
->
øã
 = 
	`ht⁄l
(
§c
->rate);

216 
d°
->
bur°_size
 = 
	`ht⁄l
(
§c
->burst_size);

217 
§c
->
ty≥
) {

218 
OFPMBT_DROP
:{

219 
oÂ_mëî_b™d_dr›
 *
di
 = (oÂ_mëî_b™d_dr› *)
d°
;

220 
di
->
Àn
 = 
	`ht⁄s
((
oÂ_mëî_b™d_dr›
));

221 
	`mem£t
(
di
->
∑d
, 0x0, 4);

222  (
oÂ_mëî_b™d_dr›
);

224 
OFPMBT_DSCP_REMARK
:{

225 
oÊ_mëî_b™d_ds˝_ªm¨k
 *
si
 = (oÊ_mëî_b™d_ds˝_ªm¨k*)
§c
;

226 
oÂ_mëî_b™d_ds˝_ªm¨k
 *
di
 = (oÂ_mëî_b™d_ds˝_ªm¨k *)
d°
;

227 
di
->
Àn
 = 
	`ht⁄s
((
oÂ_mëî_b™d_ds˝_ªm¨k
));

228 
di
->
¥ec_Àvñ
 = 
si
->prec_level;

229 
	`mem£t
(
di
->
∑d
,0x0,3);

230  (
oÂ_mëî_b™d_ds˝_ªm¨k
);

232 
OFPMBT_EXPERIMENTER
:{

233 
oÊ_mëî_b™d_ex≥rimíãr
 *
si
 = (oÊ_mëî_b™d_ex≥rimíãr*)
§c
;

234 
oÂ_mëî_b™d_ex≥rimíãr
 *
di
 = (oÂ_mëî_b™d_ex≥rimíã∏*)
d°
;

235 
di
->
Àn
 = 
	`ht⁄s
((
oÂ_mëî_b™d_ex≥rimíãr
));

236 
di
->
ex≥rimíãr
 = 
	`ht⁄l
(
si
->experimenter);

237  (
oÂ_mëî_b™d_ex≥rimíãr
);

240 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÖack unknown meter band.");

243 
	}
}

245 
size_t


246 
	$oÊ_°ru˘s_èbÀ_„©uªs_¥›îtõs_oÂ_Àn
(
oÊ_èbÀ_„©uª_¥›_hódî
 *
¥›
, 
oÊ_exp
 *
exp
){

248 
¥›
->
ty≥
){

249 
OFPTFPT_INSTRUCTIONS
:

250 
OFPTFPT_INSTRUCTIONS_MISS
:{

251 
oÊ_èbÀ_„©uª_¥›_ö°ru˘i⁄s
 *
ö°_¥›
 = (oÊ_èbÀ_„©uª_¥›_ö°ru˘i⁄s*Ë
¥›
;

252 
Àn
 = 0;

253 
i
;

254 
i
 = 0; i < 
ö°_¥›
->
ids_num
; i++){

255 i‡(
ö°_¥›
->
ö°ru˘i⁄_ids
[
i
].
ty≥
 =
OFPIT_EXPERIMENTER
) {

256 i‡(
exp
 =
NULL
 ||Éxp->
ö°
 =NULL ||Éxp->ö°->
u≈ack
 == NULL) {

257 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received EXPERIMENTER instruction, butÇo callback was given.");

258  
	`oÊ_îr‹
(
OFPET_BAD_INSTRUCTION
, 
OFPBIC_UNSUP_INST
);

260 
Àn
 +(
oÂ_ö°ru˘i⁄
Ë+ 
exp
->
ö°
->
	`oÂ_Àn
(&
ö°_¥›
->
ö°ru˘i⁄_ids
[
i
]);

263 
Àn
 +(
oÂ_ö°ru˘i⁄
) - 4;

267  (
oÂ_èbÀ_„©uª_¥›_ö°ru˘i⁄s
Ë+ 
Àn
 ;

269 
OFPTFPT_NEXT_TABLES
:

270 
OFPTFPT_NEXT_TABLES_MISS
:{

271 
oÊ_èbÀ_„©uª_¥›_√xt_èbÀs
 * 
èbÀ_¥›
 = (oÊ_èbÀ_„©uª_¥›_√xt_èbÀ†*Ë
¥›
;

272  (
oÂ_èbÀ_„©uª_¥›_√xt_èbÀs
Ë+ (
èbÀ_¥›
->
èbÀ_num
 * (
uöt8_t
));

275 
OFPTFPT_WRITE_ACTIONS
:

276 
OFPTFPT_WRITE_ACTIONS_MISS
:

277 
OFPTFPT_APPLY_ACTIONS
:

278 
OFPTFPT_APPLY_ACTIONS_MISS
:{

279 
oÊ_èbÀ_„©uª_¥›_a˘i⁄s
 *
a˘_¥›
 = (oÊ_èbÀ_„©uª_¥›_a˘i⁄s*Ë
¥›
;

280 
Àn
 = 0;

281 
i
;

282 
i
 = 0; i < 
a˘_¥›
->
a˘i⁄s_num
; i++){

283 i‡(
a˘_¥›
->
a˘i⁄_ids
[
i
].
ty≥
 =
OFPAT_EXPERIMENTER
)

284 
Àn
 += 8;

286 
Àn
 += 4;

288  (
oÂ_èbÀ_„©uª_¥›_a˘i⁄s
Ë+ 
Àn
;

290 
OFPTFPT_MATCH
:

291 
OFPTFPT_WILDCARDS
:

292 
OFPTFPT_WRITE_SETFIELD
:

293 
OFPTFPT_WRITE_SETFIELD_MISS
:

294 
OFPTFPT_APPLY_SETFIELD
:

295 
OFPTFPT_APPLY_SETFIELD_MISS
:{

296 
oÊ_èbÀ_„©uª_¥›_oxm
 * 
oxm_¥›
 = (oÊ_èbÀ_„©uª_¥›_oxm *Ë
¥›
;

297  (
oÂ_èbÀ_„©uª_¥›_oxm
Ë+ (
oxm_¥›
->
oxm_num
 * (
uöt32_t
));

299 
OFPTFPT_EXPERIMENTER
:

300 
OFPTFPT_EXPERIMENTER_MISS
:{

306 
	}
}

308 
size_t


309 
	$oÊ_°ru˘s_èbÀ_„©uªs_¥›îtõs_oÂ_tŸÆ_Àn
(
oÊ_èbÀ_„©uª_¥›_hódî
 **
¥›s
, 
size_t
 
„©uªs_num
, 
oÊ_exp
 *
exp
){

310 
i
;

311 
size_t
 
sum
 = 0;

312 
size_t
 
sum_check
;

313 
i
 = 0; i < 
„©uªs_num
; i++){

315 
sum
 +
	`ROUND_UP
(
¥›s
[
i
]->
Àngth
, 8);

318 
sum_check
 = 
	`oÊ_°ru˘s_èbÀ_„©uªs_¥›îtõs_oÂ_Àn
(
¥›s
[
i
], 
exp
);

319 if(
¥›s
[
i
]->
Àngth
 !
sum_check
)

320 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TabÀ fótuªÖr›îty %X ha†u√x≥˘edÜígth, %u !%zu.", 
¥›s
[
i
]->
ty≥
,Ör›s[i]->
Àngth
, 
sum_check
);

323  
sum
;

324 
	}
}

326 
size_t
 
	$oÊ_°ru˘s_èbÀ_„©uªs_oÂ_tŸÆ_Àn
(
oÊ_èbÀ_„©uªs
 **
„©
, 
size_t
 
èbÀs_num
, 
oÊ_exp
 * 
exp
){

328 
i
, 
tŸÆ_Àn
;

329 
tŸÆ_Àn
 = 0;

330 
i
 = 0; i < 
èbÀs_num
; i++){

331 
tŸÆ_Àn
 +(
oÂ_èbÀ_„©uªs
Ë+ 
	`oÊ_°ru˘s_èbÀ_„©uªs_¥›îtõs_oÂ_tŸÆ_Àn
(
„©
[
i
]->
¥›îtõs
, fót[i]->
¥›îtõs_num
, 
exp
);

333  
tŸÆ_Àn
;

334 
	}
}

336 
size_t


337 
	$oÊ_°ru˘s_èbÀ_¥›îtõs_∑ck
(
oÊ_èbÀ_„©uª_¥›_hódî
 * 
§c
, 
oÂ_èbÀ_„©uª_¥›_hódî
 *
d°
, 
uöt8_t
 *
d©a
, 
oÊ_exp
 *
exp
){

339 
d°
->
ty≥
 = 
	`ht⁄s
(
§c
->type);

340 
§c
->
ty≥
){

341 
OFPTFPT_INSTRUCTIONS
:

342 
OFPTFPT_INSTRUCTIONS_MISS
:{

343 
i
;

344 
oÊ_èbÀ_„©uª_¥›_ö°ru˘i⁄s
 *
•
 = (oÊ_èbÀ_„©uª_¥›_ö°ru˘i⁄s*Ë
§c
;

345 
oÂ_èbÀ_„©uª_¥›_ö°ru˘i⁄s
 *
dp
 = (oÂ_èbÀ_„©uª_¥›_ö°ru˘i⁄s*Ë
d°
;

346 
uöt8_t
 *
±r
;

348 
dp
->
Àngth
 = 
	`ht⁄s
(
•
->
hódî
.length);

349 
±r
 = (
uöt8_t
*Ë
d©a
 + ((
oÂ_èbÀ_„©uª_¥›_hódî
));

350 
i
 = 0; i < 
•
->
ids_num
; i++){

351 if(
•
->
ö°ru˘i⁄_ids
[
i
].
ty≥
 =
OFPIT_EXPERIMENTER
){

352 
oÂ_ö°ru˘i⁄
 
ö°
;

354 
ö°
.
ty≥
 = 
•
->
ö°ru˘i⁄_ids
[
i
].type;

355 i‡(
exp
 =
NULL
 ||Éxp->
ö°
 =NULL ||Éxp->ö°->
u≈ack
 == NULL) {

356 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received EXPERIMENTER instruction, butÇo callback was given.");

357  
	`oÊ_îr‹
(
OFPET_BAD_INSTRUCTION
, 
OFPBIC_UNSUP_INST
);

359 
ö°
.
Àn
 = 
	`ROUND_UP
((
oÂ_ö°ru˘i⁄
Ë+ 
exp
->ö°->
	`oÂ_Àn
(&
•
->
ö°ru˘i⁄_ids
[
i
]),8);

360 
	`mem˝y
(
±r
, &
ö°
, (
oÂ_ö°ru˘i⁄
) - 4);

361 
±r
 +(
oÂ_ö°ru˘i⁄
) - 4;

364 
oÂ_ö°ru˘i⁄
 
ö°
;

365 
ö°
.
ty≥
 = 
	`ht⁄s
(
•
->
ö°ru˘i⁄_ids
[
i
].type);

366 
ö°
.
Àn
 = 
	`ht⁄s
((
oÂ_ö°ru˘i⁄
) - 4);

367 
	`mem˝y
(
±r
, &
ö°
, (
oÂ_ö°ru˘i⁄
) - 4);

368 
±r
 +(
oÂ_ö°ru˘i⁄
) - 4;

371 
	`mem£t
(
±r
, 0x0, 
	`ROUND_UP
(
•
->
hódî
.
Àngth
,8) - sp->header.length);

372  
	`ROUND_UP
(
	`¡ohs
(
dp
->
Àngth
),8);

374 
OFPTFPT_NEXT_TABLES
:

375 
OFPTFPT_NEXT_TABLES_MISS
:{

376 
i
;

377 
uöt8_t
 *
±r
;

378 
oÊ_èbÀ_„©uª_¥›_√xt_èbÀs
 *
•
 = (oÊ_èbÀ_„©uª_¥›_√xt_èbÀs*Ë
§c
;

379 
oÂ_èbÀ_„©uª_¥›_√xt_èbÀs
 *
dp
 = (oÂ_èbÀ_„©uª_¥›_√xt_èbÀs*Ë
d°
;

381 
dp
->
Àngth
 = 
	`ht⁄s
(
•
->
hódî
.length);

382 
±r
 = 
d©a
 + ((
oÂ_èbÀ_„©uª_¥›_hódî
));

383 
i
 = 0; i < 
•
->
èbÀ_num
; i++){

384 
	`mem˝y
(
±r
, &
•
->
√xt_èbÀ_ids
[
i
], (
uöt8_t
));

385 
±r
 +(
uöt8_t
);

387 
	`mem£t
(
±r
, 0x0, 
	`ROUND_UP
(
•
->
hódî
.
Àngth
,8)-sp->header.length);

388  
	`ROUND_UP
(
	`¡ohs
(
dp
->
Àngth
),8);

390 
OFPTFPT_WRITE_ACTIONS
:

391 
OFPTFPT_WRITE_ACTIONS_MISS
:

392 
OFPTFPT_APPLY_ACTIONS
:

393 
OFPTFPT_APPLY_ACTIONS_MISS
:{

394 
i
;

395 
uöt8_t
 *
±r
;

397 
oÊ_èbÀ_„©uª_¥›_a˘i⁄s
 *
•
 = (oÊ_èbÀ_„©uª_¥›_a˘i⁄s*Ë
§c
;

398 
oÂ_èbÀ_„©uª_¥›_a˘i⁄s
 *
dp
 = (oÂ_èbÀ_„©uª_¥›_a˘i⁄s*Ë
d°
;

400 
dp
->
Àngth
 = 
	`ht⁄s
(
•
->
hódî
.length);

401 
±r
 = 
d©a
 + ((
oÂ_èbÀ_„©uª_¥›_hódî
));

402 
i
 = 0; i < 
•
->
a˘i⁄s_num
; i++){

403 if(
•
->
a˘i⁄_ids
[
i
].
ty≥
 =
OFPAT_EXPERIMENTER
){

404 
	`mem˝y
(
±r
, &
•
->
a˘i⁄_ids
[
i
], (
oÂ_a˘i⁄_hódî
));

405 
±r
 +(
oÂ_a˘i⁄_hódî
);

408 
oÂ_a˘i⁄_hódî
 
a˘i⁄
;

409 
a˘i⁄
.
ty≥
 = 
	`ht⁄s
(
•
->
a˘i⁄_ids
[
i
].type);

410 
a˘i⁄
.
Àn
 = 
	`ht⁄s
(
•
->
a˘i⁄_ids
[
i
].len);

411 
	`mem˝y
(
±r
, &
a˘i⁄
, (
oÂ_a˘i⁄_hódî
) -4);

412 
±r
 +(
oÂ_a˘i⁄_hódî
) -4;

415 
	`mem£t
(
±r
, 0x0, 
	`ROUND_UP
(
•
->
hódî
.
Àngth
,8)- sp->header.length);

416  
	`ROUND_UP
(
	`¡ohs
(
dp
->
Àngth
),8);

418 
OFPTFPT_MATCH
:

419 
OFPTFPT_WILDCARDS
:

420 
OFPTFPT_WRITE_SETFIELD
:

421 
OFPTFPT_WRITE_SETFIELD_MISS
:

422 
OFPTFPT_APPLY_SETFIELD
:

423 
OFPTFPT_APPLY_SETFIELD_MISS
:{

424 
i
;

425 
oÊ_èbÀ_„©uª_¥›_oxm
 *
•
 = (oÊ_èbÀ_„©uª_¥›_oxm*Ë
§c
;

426 
oÂ_èbÀ_„©uª_¥›_oxm
 *
dp
 = (oÂ_èbÀ_„©uª_¥›_oxm*Ë
d°
;

428 
dp
->
Àngth
 = 
	`ht⁄s
(
•
->
hódî
.length);

429 
d©a
 +(
oÂ_èbÀ_„©uª_¥›_hódî
);

430 
i
 = 0; i < 
•
->
oxm_num
; i++){

431 
uöt32_t
 
hódî
 = 
	`ht⁄l
(
•
->
oxm_ids
[
i
]);

432 
	`mem˝y
(
d©a
, &
hódî
, (
uöt32_t
));

433 
d©a
 +(
uöt32_t
);

435 
	`mem£t
(
d©a
, 0x0, 
	`ROUND_UP
(
•
->
hódî
.
Àngth
,8)- sp->header.length);

436  
	`ROUND_UP
(
	`¡ohs
(
dp
->
Àngth
),8);

438 
OFPTFPT_EXPERIMENTER
:

439 
OFPTFPT_EXPERIMENTER_MISS
:{

445 
	}
}

447 
size_t


448 
	$oÊ_°ru˘s_èbÀ_„©uªs_∑ck
(
oÊ_èbÀ_„©uªs
 *
§c
, 
oÂ_èbÀ_„©uªs
 *
d°
, 
uöt8_t
 *
d©a
, 
oÊ_exp
 *
exp
){

449 
size_t
 
tŸÆ_Àn
;

450 
uöt8_t
 *
±r
;

451 
i
;

454 
tŸÆ_Àn
 = (
oÂ_èbÀ_„©uªs
Ë+ 
	`oÊ_°ru˘s_èbÀ_„©uªs_¥›îtõs_oÂ_tŸÆ_Àn
(
§c
->
¥›îtõs
,§c->
¥›îtõs_num
,
exp
);

455 
d°
->
èbÀ_id
 = 
§c
->table_id;

456 
	`mem£t
(
d°
->
∑d
, 0x0,5);

457 
	`°∫˝y
(
d°
->
«me
,
§c
->«me, 
OFP_MAX_TABLE_NAME_LEN
);

458 
d°
->
mëad©a_m©ch
 = 
	`ht⁄64
(
§c
->metadata_match);

459 
d°
->
mëad©a_wrôe
 = 
	`ht⁄64
(
§c
->metadata_write);

460 
d°
->
c⁄fig
 = 
	`ht⁄l
(
§c
->config);

461 
d°
->
max_íåõs
 = 
	`ht⁄l
(
§c
->max_entries);

463 
±r
 = (
uöt8_t
*Ë(
d©a
 + (
oÂ_èbÀ_„©uªs
));

464 
i
 = 0; i < 
§c
->
¥›îtõs_num
; i++){

465 
±r
 +
	`oÊ_°ru˘s_èbÀ_¥›îtõs_∑ck
(
§c
->
¥›îtõs
[
i
], (
oÂ_èbÀ_„©uª_¥›_hódî
*Ë±r,Öå, 
exp
);

467 
d°
->
Àngth
 = 
	`ht⁄s
(
tŸÆ_Àn
);

468  
tŸÆ_Àn
;

469 
	}
}

471 
size_t


472 
	$oÊ_°ru˘s_buckës_oÂ_Àn
(
oÊ_buckë
 *
buckë
, 
oÊ_exp
 *
exp
) {

473 
size_t
 
tŸÆ_Àn
, 
ªm
;

475 
tŸÆ_Àn
 = (
oÂ_buckë
Ë+ 
	`oÊ_a˘i⁄s_oÂ_tŸÆ_Àn
(
buckë
->
a˘i⁄s
, buckë->
a˘i⁄s_num
, 
exp
);

477 
ªm
 = 
tŸÆ_Àn
 % 8;

478  
tŸÆ_Àn
 + (
ªm
 == 0 ? 0 : (8 -Ñem));

479 
	}
}

481 
size_t


482 
	$oÊ_°ru˘s_buckës_oÂ_tŸÆ_Àn
(
oÊ_buckë
 **
buckës
, 
size_t
 
buckës_num
, 
oÊ_exp
 *
exp
) {

483 
size_t
 
sum
;

484 
	`OFL_UTILS_SUM_ARR_FUN2
(
sum
, 
buckës
, 
buckës_num
,

485 
oÊ_°ru˘s_buckës_oÂ_Àn
, 
exp
);

486  
sum
;

487 
	}
}

489 
size_t


490 
	$oÊ_°ru˘s_buckë_∑ck
(
oÊ_buckë
 *
§c
, 
oÂ_buckë
 *
d°
, 
oÊ_exp
 *
exp
) {

491 
size_t
 
tŸÆ_Àn
, 
ªm
, 
Æign
, 
Àn
;

492 
uöt8_t
 *
d©a
;

493 
size_t
 
i
;

495 
tŸÆ_Àn
 = (
oÂ_buckë
Ë+ 
	`oÊ_a˘i⁄s_oÂ_tŸÆ_Àn
(
§c
->
a˘i⁄s
, src->
a˘i⁄s_num
, 
exp
);

497 
ªm
 = 
tŸÆ_Àn
 % 8;

498 
Æign
 = 
ªm
 == 0 ? 0 : (8-rem);

499 
tŸÆ_Àn
 +
Æign
;

501 
d°
->
Àn
 = 
	`ht⁄s
(
tŸÆ_Àn
);

502 
d°
->
weight
 = 
	`ht⁄s
(
§c
->weight);

503 
d°
->
w©ch_p‹t
 = 
	`ht⁄l
(
§c
->watch_port);

504 
d°
->
w©ch_group
 = 
	`ht⁄l
(
§c
->watch_group);

505 
	`mem£t
(
d°
->
∑d
, 0x00, 4);

507 
d©a
 = (
uöt8_t
 *)
d°
 + (
oÂ_buckë
);

509 
i
=0; i<
§c
->
a˘i⁄s_num
; i++) {

510 
Àn
 = 
	`oÊ_a˘i⁄s_∑ck
(
§c
->
a˘i⁄s
[
i
], (
oÂ_a˘i⁄_hódî
 *)
d©a
, d©a, 
exp
);

511 
d©a
 +
Àn
;

514 
	`mem£t
(
d©a
, 0x00, 
Æign
);

516  
tŸÆ_Àn
;

517 
	}
}

520 
size_t


521 
	$oÊ_°ru˘s_Êow_°©s_oÂ_Àn
(
oÊ_Êow_°©s
 *
°©s
, 
oÊ_exp
 *
exp
) {

523  
	`ROUND_UP
(((
oÂ_Êow_°©s
Ë- 4Ë+ 
°©s
->
m©ch
->
Àngth
,8) +

524 
	`oÊ_°ru˘s_ö°ru˘i⁄s_oÂ_tŸÆ_Àn
(
°©s
->
ö°ru˘i⁄s
, sèts->
ö°ru˘i⁄s_num
, 
exp
);

525 
	}
}

527 
size_t


528 
	$oÊ_°ru˘s_Êow_°©s_oÂ_tŸÆ_Àn
(
oÊ_Êow_°©s
 ** 
°©s
, 
size_t
 
°©s_num
, 
oÊ_exp
 *
exp
) {

529 
size_t
 
sum
;

530 
	`OFL_UTILS_SUM_ARR_FUN2
(
sum
, 
°©s
, 
°©s_num
,

531 
oÊ_°ru˘s_Êow_°©s_oÂ_Àn
, 
exp
);

532  
sum
;

533 
	}
}

537 
size_t


538 
	$oÊ_°ru˘s_Êow_°©s_∑ck
(
oÊ_Êow_°©s
 *
§c
, 
uöt8_t
 *
d°
, 
oÊ_exp
 *
exp
) {

540 
oÂ_Êow_°©s
 *
Êow_°©s
;

541 
size_t
 
tŸÆ_Àn
;

542 
uöt8_t
 *
d©a
;

543 
size_t
 
i
;

545 
tŸÆ_Àn
 = 
	`ROUND_UP
((
oÂ_Êow_°©s
Ë-4 + 
§c
->
m©ch
->
Àngth
,8) +

546 
	`oÊ_°ru˘s_ö°ru˘i⁄s_oÂ_tŸÆ_Àn
(
§c
->
ö°ru˘i⁄s
, src->
ö°ru˘i⁄s_num
, 
exp
);

548 
Êow_°©s
 = (
oÂ_Êow_°©s
*Ë
d°
;

550 
Êow_°©s
->
Àngth
 = 
	`ht⁄s
(
tŸÆ_Àn
);

551 
Êow_°©s
->
èbÀ_id
 = 
§c
->table_id;

552 
Êow_°©s
->
∑d
 = 0x00;

553 
Êow_°©s
->
duøti⁄_£c
 = 
	`ht⁄l
(
§c
->duration_sec);

554 
Êow_°©s
->
duøti⁄_n£c
 = 
	`ht⁄l
(
§c
->duration_nsec);

555 
Êow_°©s
->
¥i‹ôy
 = 
	`ht⁄s
(
§c
->priority);

556 
Êow_°©s
->
idÀ_timeout
 = 
	`ht⁄s
(
§c
->idle_timeout);

557 
Êow_°©s
->
h¨d_timeout
 = 
	`ht⁄s
(
§c
->hard_timeout);

558 
	`mem£t
(
Êow_°©s
->
∑d2
, 0x00, 6);

559 
Êow_°©s
->
cookõ
 = 
	`ht⁄64
(
§c
->cookie);

560 
Êow_°©s
->
∑ckë_cou¡
 = 
	`ht⁄64
(
§c
->packet_count);

561 
Êow_°©s
->
byã_cou¡
 = 
	`ht⁄64
(
§c
->byte_count);

562 
d©a
 = (
d°
Ë+ (
oÂ_Êow_°©s
) - 4;

564 
	`oÊ_°ru˘s_m©ch_∑ck
(
§c
->
m©ch
, &(
Êow_°©s
->m©ch), 
d©a
, 
exp
);

565 
d©a
 = (
d°
Ë+ 
	`ROUND_UP
((
oÂ_Êow_°©s
Ë-4 + 
§c
->
m©ch
->
Àngth
, 8);

567 
i
=0; i < 
§c
->
ö°ru˘i⁄s_num
; i++) {

568 
d©a
 +
	`oÊ_°ru˘s_ö°ru˘i⁄s_∑ck
(
§c
->
ö°ru˘i⁄s
[
i
], (
oÂ_ö°ru˘i⁄
 *Ëd©a, 
exp
);

570  
tŸÆ_Àn
;

571 
	}
}

573 
size_t


574 
	$oÊ_°ru˘s_group_°©s_oÂ_Àn
(
oÊ_group_°©s
 *
°©s
) {

575  (
oÂ_group_°©s
) +

576 (
oÂ_buckë_cou¡î
Ë* 
°©s
->
cou¡îs_num
;

577 
	}
}

579 
size_t


580 
	$oÊ_°ru˘s_group_°©s_oÂ_tŸÆ_Àn
(
oÊ_group_°©s
 ** 
°©s
, 
size_t
 
°©s_num
) {

581 
size_t
 
sum
;

582 
	`OFL_UTILS_SUM_ARR_FUN
(
sum
, 
°©s
, 
°©s_num
,

583 
oÊ_°ru˘s_group_°©s_oÂ_Àn
);

584  
sum
;

585 
	}
}

587 
size_t


588 
	$oÊ_°ru˘s_group_°©s_∑ck
(
oÊ_group_°©s
 *
§c
, 
oÂ_group_°©s
 *
d°
) {

589 
size_t
 
tŸÆ_Àn
, 
Àn
;

590 
uöt8_t
 *
d©a
;

591 
size_t
 
i
;

593 
tŸÆ_Àn
 = (
oÂ_group_°©s
) +

594 (
oÂ_buckë_cou¡î
Ë* 
§c
->
cou¡îs_num
;

596 
d°
->
Àngth
 = 
	`ht⁄s
–
tŸÆ_Àn
);

597 
	`mem£t
(
d°
->
∑d
, 0x00, 2);

598 
d°
->
group_id
 = 
	`ht⁄l
–
§c
->group_id);

599 
d°
->
ªf_cou¡
 = 
	`ht⁄l
–
§c
->ref_count);

600 
	`mem£t
(
d°
->
∑d2
, 0x00, 4);

601 
d°
->
∑ckë_cou¡
 = 
	`ht⁄64
(
§c
->packet_count);

602 
d°
->
byã_cou¡
 = 
	`ht⁄64
(
§c
->byte_count);

603 
d°
->
duøti⁄_£c
 = 
	`ht⁄l
(
§c
->duration_sec);

604 
d°
->
duøti⁄_n£c
 = 
	`ht⁄l
(
§c
->duration_nsec);

606 
d©a
 = (
uöt8_t
 *)
d°
->
buckë_°©s
;

608 
i
=0; i<
§c
->
cou¡îs_num
; i++) {

609 
Àn
 = 
	`oÊ_°ru˘s_buckë_cou¡î_∑ck
(
§c
->
cou¡îs
[
i
], (
oÂ_buckë_cou¡î
 *)
d©a
);

610 
d©a
 +
Àn
;

613  
tŸÆ_Àn
;

614 
	}
}

616 
size_t


617 
	$oÊ_°ru˘s_mëî_°©s_oÂ_Àn
(
oÊ_mëî_°©s
 *
°©s
){

618  (
oÂ_mëî_°©s
) +

619 (
oÂ_mëî_b™d_°©s
Ë* 
°©s
->
mëî_b™ds_num
;

620 
	}
}

622 
size_t


623 
	$oÊ_°ru˘s_∑ck_b™d_°©s
(
oÊ_mëî_b™d_°©s
 *
§c
, 
oÂ_mëî_b™d_°©s
 *
d°
){

625 
d°
->
∑ckë_b™d_cou¡
 = 
	`ht⁄64
(
§c
->packet_band_count);

626 
d°
->
byã_b™d_cou¡
 = 
	`ht⁄64
(
§c
->byte_band_count);

628  (
oÂ_mëî_b™d_°©s
);

629 
	}
}

631 
size_t


632 
	$oÊ_°ru˘s_mëî_°©s_oÂ_tŸÆ_Àn
(
oÊ_mëî_°©s
 **
°©s
, 
size_t
 
°©s_num
){

633 
size_t
 
sum
;

634 
	`OFL_UTILS_SUM_ARR_FUN
(
sum
, 
°©s
, 
°©s_num
,

635 
oÊ_°ru˘s_mëî_°©s_oÂ_Àn
);

636  
sum
;

637 
	}
}

639 
size_t


640 
	$oÊ_°ru˘s_mëî_°©s_∑ck
(
oÊ_mëî_°©s
 *
§c
, 
oÂ_mëî_°©s
 *
d°
){

641 
size_t
 
tŸÆ_Àn
;

642 
size_t
 
i
;

644 
tŸÆ_Àn
 = (
oÂ_mëî_°©s
) +

645 (
oÂ_mëî_b™d_°©s
Ë* 
§c
->
mëî_b™ds_num
;

647 
d°
->
mëî_id
 = 
	`ht⁄l
(
§c
->meter_id);

648 
d°
->
Àn
 = 
	`ht⁄s
–
tŸÆ_Àn
);

649 
	`mem£t
(
d°
->
∑d
, 0x00, 6);

650 
d°
->
Êow_cou¡
 = 
	`ht⁄l
(
§c
->flow_count);

651 
d°
->
∑ckë_ö_cou¡
 = 
	`ht⁄64
–
§c
->packet_in_count);

652 
d°
->
byã_ö_cou¡
 = 
	`ht⁄64
(
§c
->byte_in_count);

653 
d°
->
duøti⁄_£c
 = 
	`ht⁄l
(
§c
->duration_sec);

654 
d°
->
duøti⁄_n£c
 = 
	`ht⁄l
(
§c
->duration_nsec);

656 
i
 = 0; i < 
§c
->
mëî_b™ds_num
; i++){

657 
	`oÊ_°ru˘s_∑ck_b™d_°©s
(
§c
->
b™d_°©s
[
i
], &
d°
->band_stats[i]);

659  
tŸÆ_Àn
;

662 
	}
}

664 
size_t


665 
	$oÊ_°ru˘s_mëî_c⁄f_oÂ_Àn
(
oÊ_mëî_c⁄fig
 * 
mëî_c⁄f
){

666  (
oÂ_mëî_c⁄fig
) +

667 
	`oÊ_°ru˘s_mëî_b™ds_oÂ_tŸÆ_Àn
(
mëî_c⁄f
->
b™ds
, mëî_c⁄f->
mëî_b™ds_num
);

668 
	}
}

670 
size_t


671 
	$oÊ_°ru˘s_mëî_c⁄f_oÂ_tŸÆ_Àn
(
oÊ_mëî_c⁄fig
 **
mëî_c⁄f
, 
size_t
 
°©s_num
){

672 
size_t
 
sum
;

673 
	`OFL_UTILS_SUM_ARR_FUN
(
sum
, 
mëî_c⁄f
, 
°©s_num
,

674 
oÊ_°ru˘s_mëî_c⁄f_oÂ_Àn
);

675  
sum
;

676 
	}
}

678 
size_t


679 
	$oÊ_°ru˘s_mëî_c⁄f_∑ck
(
oÊ_mëî_c⁄fig
 *
§c
, 
oÂ_mëî_c⁄fig
 *
d°
, 
uöt8_t
* 
d©a
){

680 
size_t
 
tŸÆ_Àn
, 
Àn
;

681 
i
;

683 
tŸÆ_Àn
 = (
oÂ_mëî_c⁄fig
) +

684 
	`oÊ_°ru˘s_mëî_b™ds_oÂ_tŸÆ_Àn
(
§c
->
b™ds
, src->
mëî_b™ds_num
);

686 
d°
->
Àngth
 = 
	`¡ohs
(
tŸÆ_Àn
);

687 
d°
->
Êags
 = 
	`¡ohs
(
§c
->flags);

688 
d°
->
mëî_id
 = 
	`¡ohl
(
§c
->meter_id);

690 
d©a
 = (
uöt8_t
 *)
d°
->
b™ds
;

692 
i
=0; i<
§c
->
mëî_b™ds_num
; i++) {

693 
Àn
 = 
	`oÊ_°ru˘s_mëî_b™d_∑ck
(
§c
->
b™ds
[
i
], (
oÂ_mëî_b™d_hódî
 *)
d©a
);

694 
d©a
 +
Àn
;

696  
tŸÆ_Àn
;

697 
	}
}

699 
size_t


700 
	$oÊ_°ru˘s_group_desc_°©s_oÂ_Àn
(
oÊ_group_desc_°©s
 *
°©s
, 
oÊ_exp
 *
exp
) {

701  (
oÂ_group_desc_°©s
) +

702 
	`oÊ_°ru˘s_buckës_oÂ_tŸÆ_Àn
(
°©s
->
buckës
, sèts->
buckës_num
, 
exp
);

703 
	}
}

705 
size_t


706 
	$oÊ_°ru˘s_group_desc_°©s_oÂ_tŸÆ_Àn
(
oÊ_group_desc_°©s
 ** 
°©s
, 
size_t
 
°©s_num
, 
oÊ_exp
 *
exp
) {

707 
size_t
 
sum
;

708 
	`OFL_UTILS_SUM_ARR_FUN2
(
sum
, 
°©s
, 
°©s_num
,

709 
oÊ_°ru˘s_group_desc_°©s_oÂ_Àn
, 
exp
);

710  
sum
;

711 
	}
}

713 
size_t


714 
	$oÊ_°ru˘s_group_desc_°©s_∑ck
(
oÊ_group_desc_°©s
 *
§c
, 
oÂ_group_desc_°©s
 *
d°
, 
oÊ_exp
 *
exp
) {

715 
size_t
 
tŸÆ_Àn
, 
Àn
;

716 
uöt8_t
 *
d©a
;

717 
size_t
 
i
;

719 
tŸÆ_Àn
 = (
oÂ_group_desc_°©s
) +

720 
	`oÊ_°ru˘s_buckës_oÂ_tŸÆ_Àn
(
§c
->
buckës
, src->
buckës_num
, 
exp
);

722 
d°
->
Àngth
 = 
	`ht⁄s
–
tŸÆ_Àn
);

723 
d°
->
ty≥
 = 
§c
->type;

724 
d°
->
∑d
 = 0x00;

725 
d°
->
group_id
 = 
	`ht⁄l
–
§c
->group_id);

727 
d©a
 = (
uöt8_t
 *)
d°
->
buckës
;

729 
i
=0; i<
§c
->
buckës_num
; i++) {

730 
Àn
 = 
	`oÊ_°ru˘s_buckë_∑ck
(
§c
->
buckës
[
i
], (
oÂ_buckë
 *)
d©a
, 
exp
);

731 
d©a
 +
Àn
;

734  
tŸÆ_Àn
;

735 
	}
}

738 
size_t


739 
	$oÊ_°ru˘s_queue_¥›_oÂ_tŸÆ_Àn
(
oÊ_queue_¥›_hódî
 ** 
¥›s
,

740 
size_t
 
¥›s_num
) {

741 
size_t
 
sum
;

742 
	`OFL_UTILS_SUM_ARR_FUN
(
sum
, 
¥›s
, 
¥›s_num
,

743 
oÊ_°ru˘s_queue_¥›_oÂ_Àn
);

744  
sum
;

745 
	}
}

747 
size_t


748 
	$oÊ_°ru˘s_queue_¥›_oÂ_Àn
(
oÊ_queue_¥›_hódî
 *
¥›
) {

749 
¥›
->
ty≥
) {

751 
OFPQT_MIN_RATE
: {

752  (
oÂ_queue_¥›_mö_øã
);

754 
OFPQT_MAX_RATE
:{

755  (
oÂ_queue_¥›_max_øã
);

757 
OFPQT_EXPERIMENTER
:{

758  (
oÂ_queue_¥›_ex≥rimíãr
);

762 
	}
}

764 
size_t


765 
	$oÊ_°ru˘s_queue_¥›_∑ck
(
oÊ_queue_¥›_hódî
 *
§c
,

766 
oÂ_queue_¥›_hódî
 *
d°
) {

767 
d°
->
¥›îty
 = 
	`ht⁄s
(
§c
->
ty≥
);

768 
	`mem£t
(
d°
->
∑d
, 0x00, 4);

770 
§c
->
ty≥
) {

772 
OFPQT_MIN_RATE
: {

773 
oÊ_queue_¥›_mö_øã
 *
•
 = (oÊ_queue_¥›_mö_øã *)
§c
;

774 
oÂ_queue_¥›_mö_øã
 *
dp
 = (oÂ_queue_¥›_mö_øã *)
d°
;

776 
dp
->
¥›_hódî
.
Àn
 = 
	`ht⁄s
((
oÂ_queue_¥›_mö_øã
));

777 
dp
->
øã
 = 
	`ht⁄s
(
•
->rate);

778 
	`mem£t
(
dp
->
∑d
, 0x00, 6);

780  (
oÂ_queue_¥›_mö_øã
);

782 
OFPQT_MAX_RATE
:{

783 
oÊ_queue_¥›_max_øã
 *
•
 = (oÊ_queue_¥›_max_øã *)
§c
;

784 
oÂ_queue_¥›_max_øã
 *
dp
 = (oÂ_queue_¥›_max_øã *)
d°
;

785 
dp
->
¥›_hódî
.
Àn
 = 
	`ht⁄s
((
oÂ_queue_¥›_max_øã
));

786 
dp
->
øã
 = 
	`ht⁄s
(
•
->rate);

787 
	`mem£t
(
dp
->
∑d
, 0x00, 6);

789  (
oÂ_queue_¥›_max_øã
);

791 
OFPQT_EXPERIMENTER
:{

793 
oÂ_queue_¥›_ex≥rimíãr
 *
dp
 = (oÂ_queue_¥›_ex≥rimíãr*)
d°
;

794 
dp
->
¥›_hódî
.
Àn
 = 
	`ht⁄s
((
oÂ_queue_¥›_ex≥rimíãr
));

795 
	`mem£t
(
dp
->
∑d
, 0x00, 4);

798  (
oÂ_queue_¥›_ex≥rimíãr
);

805 
	}
}

807 
size_t


808 
	$oÊ_°ru˘s_∑ckë_queue_oÂ_tŸÆ_Àn
(
oÊ_∑ckë_queue
 ** 
queues
,

809 
size_t
 
queues_num
) {

810 
size_t
 
sum
;

811 
	`OFL_UTILS_SUM_ARR_FUN
(
sum
, 
queues
, 
queues_num
,

812 
oÊ_°ru˘s_∑ckë_queue_oÂ_Àn
);

813  
sum
;

814 
	}
}

816 
size_t


817 
	$oÊ_°ru˘s_∑ckë_queue_oÂ_Àn
(
oÊ_∑ckë_queue
 *
queue
) {

818  (
oÂ_∑ckë_queue
) +

819 
	`oÊ_°ru˘s_queue_¥›_oÂ_tŸÆ_Àn
(
queue
->
¥›îtõs
,

820 
queue
->
¥›îtõs_num
);

821 
	}
}

823 
size_t


824 
	$oÊ_°ru˘s_∑ckë_queue_∑ck
(
oÊ_∑ckë_queue
 *
§c
, 
oÂ_∑ckë_queue
 *
d°
) {

825 
size_t
 
tŸÆ_Àn
, 
Àn
;

826 
uöt8_t
 *
d©a
;

827 
size_t
 
i
;

829 
tŸÆ_Àn
 = (
oÂ_∑ckë_queue
) +

830 
	`oÊ_°ru˘s_queue_¥›_oÂ_tŸÆ_Àn
(
§c
->
¥›îtõs
,

831 
§c
->
¥›îtõs_num
);

833 
d°
->
Àn
 = 
	`ht⁄s
(
tŸÆ_Àn
);

834 
	`mem£t
(
d°
->
∑d
, 0x00, 2);

835 
d°
->
queue_id
 = 
	`ht⁄l
(
§c
->queue_id);

837 
d©a
 = (
uöt8_t
 *)
d°
 + (
oÂ_∑ckë_queue
);

839 
i
=0; i<
§c
->
¥›îtõs_num
; i++) {

840 
Àn
 = 
	`oÊ_°ru˘s_queue_¥›_∑ck
(
§c
->
¥›îtõs
[
i
],

841 (
oÂ_queue_¥›_hódî
 *)
d©a
);

842 
d©a
 +
Àn
;

845  
tŸÆ_Àn
;

846 
	}
}

849 
size_t


850 
	$oÊ_°ru˘s_p‹t_∑ck
(
oÊ_p‹t
 *
§c
, 
oÂ_p‹t
 *
d°
) {

851 
d°
->
p‹t_no
 = 
	`ht⁄l
(
§c
->port_no);

852 
	`mem£t
(
d°
->
∑d
, 0x00, 4);

853 
	`mem˝y
(
d°
->
hw_addr
, 
§c
->hw_addr, 
ETH_ADDR_LEN
);

854 
	`mem£t
(
d°
->
∑d2
, 0x00, 2);

855 
	`°∫˝y
(
d°
->
«me
, 
§c
->«me, 
OFP_MAX_PORT_NAME_LEN
);

856 
d°
->
c⁄fig
 = 
	`ht⁄l
(
§c
->config);

857 
d°
->
°©e
 = 
	`ht⁄l
(
§c
->state);

858 
d°
->
cuº
 = 
	`ht⁄l
(
§c
->curr);

859 
d°
->
advîti£d
 = 
	`ht⁄l
(
§c
->advertised);

860 
d°
->
suµ‹ãd
 = 
	`ht⁄l
(
§c
->supported);

861 
d°
->
≥î
 = 
	`ht⁄l
(
§c
->peer);

862 
d°
->
cuº_•ìd
 = 
	`ht⁄l
(
§c
->curr_speed);

863 
d°
->
max_•ìd
 = 
	`ht⁄l
(
§c
->max_speed);

865  (
oÂ_p‹t
);

866 
	}
}

868 
size_t


869 
	$oÊ_°ru˘s_èbÀ_°©s_∑ck
(
oÊ_èbÀ_°©s
 *
§c
, 
oÂ_èbÀ_°©s
 *
d°
) {

870 
d°
->
èbÀ_id
 = 
§c
->table_id;

871 
	`mem£t
(
d°
->
∑d
, 0x00, 3);

872 
d°
->
a˘ive_cou¡
 = 
	`ht⁄l
–
§c
->active_count);

873 
d°
->
lookup_cou¡
 = 
	`ht⁄64
(
§c
->lookup_count);

874 
d°
->
m©ched_cou¡
 = 
	`ht⁄64
(
§c
->matched_count);

876  (
oÂ_èbÀ_°©s
);

877 
	}
}

879 
size_t


880 
	$oÊ_°ru˘s_p‹t_°©s_∑ck
(
oÊ_p‹t_°©s
 *
§c
, 
oÂ_p‹t_°©s
 *
d°
) {

881 
d°
->
p‹t_no
 = 
	`ht⁄l
–
§c
->port_no);

882 
	`mem£t
(
d°
->
∑d
, 0x00, 4);

883 
d°
->
rx_∑ckës
 = 
	`ht⁄64
(
§c
->rx_packets);

884 
d°
->
tx_∑ckës
 = 
	`ht⁄64
(
§c
->tx_packets);

885 
d°
->
rx_byãs
 = 
	`ht⁄64
(
§c
->rx_bytes);

886 
d°
->
tx_byãs
 = 
	`ht⁄64
(
§c
->tx_bytes);

887 
d°
->
rx_dr›≥d
 = 
	`ht⁄64
(
§c
->rx_dropped);

888 
d°
->
tx_dr›≥d
 = 
	`ht⁄64
(
§c
->tx_dropped);

889 
d°
->
rx_îr‹s
 = 
	`ht⁄64
(
§c
->rx_errors);

890 
d°
->
tx_îr‹s
 = 
	`ht⁄64
(
§c
->tx_errors);

891 
d°
->
rx_‰ame_îr
 = 
	`ht⁄64
(
§c
->rx_frame_err);

892 
d°
->
rx_ovî_îr
 = 
	`ht⁄64
(
§c
->rx_over_err);

893 
d°
->
rx_¸c_îr
 = 
	`ht⁄64
(
§c
->rx_crc_err);

894 
d°
->
cﬁlisi⁄s
 = 
	`ht⁄64
(
§c
->collisions);

895 
d°
->
duøti⁄_£c
 = 
	`ht⁄l
(
§c
->duration_sec);

896 
d°
->
duøti⁄_n£c
 = 
	`ht⁄l
(
§c
->duration_nsec);

898  (
oÂ_p‹t_°©s
);

899 
	}
}

901 
size_t


902 
	$oÊ_°ru˘s_queue_°©s_∑ck
(
oÊ_queue_°©s
 *
§c
, 
oÂ_queue_°©s
 *
d°
) {

903 
d°
->
p‹t_no
 = 
	`ht⁄l
(
§c
->port_no);

904 
d°
->
queue_id
 = 
	`ht⁄l
(
§c
->queue_id);

905 
d°
->
tx_byãs
 = 
	`ht⁄64
(
§c
->tx_bytes);

906 
d°
->
tx_∑ckës
 = 
	`ht⁄64
(
§c
->tx_packets);

907 
d°
->
tx_îr‹s
 = 
	`ht⁄64
(
§c
->tx_errors);

908 
d°
->
duøti⁄_£c
 = 
	`¡ohl
(
§c
->duration_sec);

909 
d°
->
duøti⁄_n£c
 = 
	`¡ohl
(
§c
->duration_nsec);

911  (
oÂ_queue_°©s
);

912 
	}
}

914 
size_t


915 
	$oÊ_°ru˘s_buckë_cou¡î_∑ck
(
oÊ_buckë_cou¡î
 *
§c
, 
oÂ_buckë_cou¡î
 *
d°
) {

916 
d°
->
∑ckë_cou¡
 = 
	`ht⁄64
(
§c
->packet_count);

917 
d°
->
byã_cou¡
 = 
	`ht⁄64
(
§c
->byte_count);

919  (
oÂ_buckë_cou¡î
);

920 
	}
}

923 
size_t


924 
	$oÊ_°ru˘s_m©ch_oÂ_Àn
(
oÊ_m©ch_hódî
 *
m©ch
, 
oÊ_exp
 *
exp
) {

925 
m©ch
->
ty≥
) {

926 (
OFPMT_STANDARD
): {

927  ((
oÂ_m©ch
));

930 i‡(
exp
 =
NULL
 ||Éxp->
m©ch
 =NULL ||Éxp->m©ch->
oÂ_Àn
 == NULL) {

931 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÜenÉxperimenter match, butÇo callback was given.");

934  
exp
->
m©ch
->
	`oÂ_Àn
(match);

937 
	}
}

939 
size_t


940 
	$oÊ_°ru˘s_m©ch_∑ck
(
oÊ_m©ch_hódî
 *
§c
, 
oÂ_m©ch
 *
d°
, 
uöt8_t
* 
oxm_fõlds
, 
oÊ_exp
 *
exp
) {

941 
§c
->
ty≥
) {

942 (
OFPMT_OXM
): {

943 
oÊ_m©ch
 *
m
 = (oÊ_m©ch *)
§c
;

944 
oÂbuf
 *
b
 = 
	`oÂbuf_√w
(0);

945 
oxm_Àn
;

946 
d°
->
ty≥
 = 
	`ht⁄s
(
m
->
hódî
.type);

947 
oxm_fõlds
 = (
uöt8_t
*Ë&
d°
->oxm_fields;

948 
d°
->
Àngth
 = 
	`ht⁄s
((
oÂ_m©ch
) - 4);

949 i‡(
§c
->
Àngth
){

950 
oxm_Àn
 = 
	`oxm_put_m©ch
(
b
, 
m
);

951 
	`mem˝y
(
oxm_fõlds
, (
uöt8_t
*Ë
	`oÂbuf_puŒ
(
b
,
oxm_Àn
), oxm_len);

952 
d°
->
Àngth
 = 
	`ht⁄s
(
oxm_Àn
 + (((
oÂ_m©ch
 )-4)));

953 
	`oÂbuf_dñëe
(
b
);

954  
	`¡ohs
(
d°
->
Àngth
);

959 i‡(
exp
 =
NULL
 ||Éxp->
m©ch
 =NULL ||Éxp->m©ch->
∑ck
 == NULL) {

960 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅoÖackÉxperimenter match, butÇo callback was given.");

963  
exp
->
m©ch
->
	`∑ck
(
§c
, 
d°
);

966 
	}
}

	@oflib/ofl-structs-print.c

32 
	~<¨∑/öë.h
>

33 
	~<°dboﬁ.h
>

34 
	~<°dlib.h
>

35 
	~<°rög.h
>

36 
	~<°dio.h
>

37 
	~<˘y≥.h
>

38 
	~<öây≥s.h
>

39 
	~<√töë/ö.h
>

40 
	~"oxm-m©ch.h
"

41 
	~"›íÊow/›íÊow.h
"

43 
	~"oÊ.h
"

44 
	~"oÊ-a˘i⁄s.h
"

45 
	~"oÊ-°ru˘s.h
"

46 
	~"oÊ-¥öt.h
"

47 
	~"oÊ-∑ckës.h
"

50 
	#ETH_ADDR_FMT
 \

51 "%02"
PRIx8
":%02"PRIx8":%02"PRIx8":%02"PRIx8":%02"PRIx8":%02"
	)
PRIx8

52 
	#ETH_ADDR_ARGS
(
ó
) \

53 (
ó
)[0], (ó)[1], (ó)[2], (ó)[3], (ó)[4], (ó)[5]

	)

55 
	#IP_FMT
 "%"
PRIu8
".%"PRIu8".%"PRIu8".%"
	)
PRIu8

58 
	$oÊ_°ru˘s_p‹t_to_°rög
(
oÊ_p‹t
 *
p‹t
) {

59 *
°r
;

60 
size_t
 
°r_size
;

61 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

62 
	`oÊ_°ru˘s_p‹t_¥öt
(
°ªam
, 
p‹t
);

63 
	`f˛o£
(
°ªam
);

64  
°r
;

65 
	}
}

68 
	$oÊ_°ru˘s_p‹t_¥öt
(
FILE
 *
°ªam
, 
oÊ_p‹t
 *
p‹t
) {

69 
	`Ârötf
(
°ªam
, "{no=\"");

70 
	`oÊ_p‹t_¥öt
(
°ªam
, 
p‹t
->
p‹t_no
);

71 
	`Ârötf
(
°ªam
, "\", hw_addr=\""
ETH_ADDR_FMT
"\",Çame=\"%s\", "

72 "c⁄fig=\"0x%"
PRIx32
"\", state=\"0x%"PRIx32"\", curr=\"0x%"PRIx32"\", "

73 "adv=\"0x%"
PRIx32
"\", supp=\"0x%"PRIx32"\",Öeer=\"0x%"PRIx32"\", "

75 
	`ETH_ADDR_ARGS
(
p‹t
->
hw_addr
),Ö‹t->
«me
,

76 
p‹t
->
c⁄fig
,Ö‹t->
°©e
,Ö‹t->
cuº
,

77 
p‹t
->
advîti£d
,Ö‹t->
suµ‹ãd
,Ö‹t->
≥î
,

78 
p‹t
->
cuº_•ìd
,Ö‹t->
max_•ìd
);

79 
	}
}

82 
	$oÊ_°ru˘s_ö°ru˘i⁄_to_°rög
(
oÊ_ö°ru˘i⁄_hódî
 *
ö°
, 
oÊ_exp
 *
exp
) {

83 *
°r
;

84 
size_t
 
°r_size
;

85 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

86 
	`oÊ_°ru˘s_ö°ru˘i⁄_¥öt
(
°ªam
, 
ö°
, 
exp
);

87 
	`f˛o£
(
°ªam
);

88  
°r
;

89 
	}
}

92 
	$oÊ_°ru˘s_ö°ru˘i⁄_¥öt
(
FILE
 *
°ªam
, 
oÊ_ö°ru˘i⁄_hódî
 *
ö°
, 
oÊ_exp
 *
exp
) {

93 
	`oÊ_ö°ru˘i⁄_ty≥_¥öt
(
°ªam
, 
ö°
->
ty≥
);

95 
ö°
->
ty≥
) {

96 (
OFPIT_GOTO_TABLE
): {

97 
oÊ_ö°ru˘i⁄_gŸo_èbÀ
 *
i
 = (oÊ_ö°ru˘i⁄_gŸo_èbÀ*)
ö°
;

99 
	`Ârötf
(
°ªam
, "{èbÀ=\"%u\"}", 
i
->
èbÀ_id
);

103 (
OFPIT_WRITE_METADATA
): {

104 
oÊ_ö°ru˘i⁄_wrôe_mëad©a
 *
i
 = (oÊ_ö°ru˘i⁄_wrôe_mëad©®*)
ö°
;

106 
	`Ârötf
(
°ªam
, "{mëa=\"0x%"
PRIx64
"\", mask=\"0x%"PRIx64"\"}",

107 
i
->
mëad©a
, i->
mëad©a_mask
);

111 (
OFPIT_WRITE_ACTIONS
):

112 (
OFPIT_APPLY_ACTIONS
): {

113 
oÊ_ö°ru˘i⁄_a˘i⁄s
 *
i
 = (oÊ_ö°ru˘i⁄_a˘i⁄†*)
ö°
;

114 
size_t
 
j
;

116 
	`Ârötf
(
°ªam
, "{acts=[");

117 
j
=0; j<
i
->
a˘i⁄s_num
; j++) {

118 
	`oÊ_a˘i⁄_¥öt
(
°ªam
, 
i
->
a˘i⁄s
[
j
], 
exp
);

119 i‡(
j
 < 
i
->
a˘i⁄s_num
 - 1Ë{ 
	`Ârötf
(
°ªam
, ", "); }

121 
	`Ârötf
(
°ªam
, "]}");

125 (
OFPIT_CLEAR_ACTIONS
): {

128 (
OFPIT_METER
):{

129 
oÊ_ö°ru˘i⁄_mëî
 *
i
 = (oÊ_ö°ru˘i⁄_mëî *)
ö°
;

130 
	`Ârötf
(
°ªam
, "{mëî=\"%u\"}", 
i
->
mëî_id
);

133 (
OFPIT_EXPERIMENTER
): {

134 i‡(
exp
 =
NULL
 ||Éxp->
ö°
 =NULL ||Éxp->ö°->
to_°rög
 == NULL) {

135 
oÊ_ö°ru˘i⁄_ex≥rimíãr
 *
i
 = (oÊ_ö°ru˘i⁄_ex≥rimíã∏*)
ö°
;

137 
	`Ârötf
(
°ªam
, "{id=\"0x%"
PRIx32
"\"}", 
i
->
ex≥rimíãr_id
);

139 *
c
 = 
exp
->
ö°
->
	`to_°rög
(inst);

140 
	`Ârötf
(
°ªam
, "%s", 
c
);

141 
	`‰ì
 (
c
);

147 
	}
}

150 
	$oÊ_°ru˘s_m©ch_to_°rög
(
oÊ_m©ch_hódî
 *
m©ch
, 
oÊ_exp
 *
exp
) {

151 *
°r
;

152 
size_t
 
°r_size
;

153 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

154 
	`oÊ_°ru˘s_m©ch_¥öt
(
°ªam
, 
m©ch
, 
exp
);

155 
	`f˛o£
(
°ªam
);

156  
°r
;

157 
	}
}

160 
	$oÊ_°ru˘s_m©ch_¥öt
(
FILE
 *
°ªam
, 
oÊ_m©ch_hódî
 *
m©ch
, 
oÊ_exp
 *
exp
) {

162 
m©ch
->
ty≥
) {

163 (
OFPMT_OXM
): {

164 
oÊ_m©ch
 *
m
 = (oÊ_m©ch*Ë
m©ch
;

165 
	`oÊ_°ru˘s_oxm_m©ch_¥öt
(
°ªam
, 
m
);

169 i‡(
exp
 =
NULL
 ||Éxp->
m©ch
 =NULL ||Éxp->m©ch->
to_°rög
 == NULL) {

170 
	`Ârötf
(
°ªam
, "?(%u)", 
m©ch
->
ty≥
);

172 *
c
 = 
exp
->
m©ch
->
	`to_°rög
(match);

173 
	`Ârötf
(
°ªam
, "%s", 
c
);

174 
	`‰ì
(
c
);

178 
	}
}

182 
	$oÊ_°ru˘s_oxm_m©ch_to_°rög
(
oÊ_m©ch
 *
m
) {

183 *
°r
;

184 
size_t
 
°r_size
;

185 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

187 
	`oÊ_°ru˘s_oxm_m©ch_¥öt
(
°ªam
, 
m
);

188 
	`f˛o£
(
°ªam
);

189  
°r
;

190 
	}
}

194 
	$oÊ_°ru˘s_oxm_m©ch_¥öt
(
FILE
 *
°ªam
, c⁄° 
oÊ_m©ch
 *
omt
) {

195 
oÊ_m©ch_év
 *
f
;

196 
i
;

197 
size_t
 
size
;

199 if(
omt
->
hódî
.
Àngth
 > 4)

200 
size
 = 
	`hm≠_cou¡
(&
omt
->
m©ch_fõlds
);

201 
size
 = 0;

203 
	`Ârötf
(
°ªam
, "oxm{");

204 i‡(
size
) {

206 
i
 = 0; i<
NUM_OXM_FIELDS
; i++) {

207 
f
 = 
	`oxm_m©ch_lookup
(
Æl_fõlds
[
i
].
hódî
, 
omt
);

208 i‡(
f
 !
NULL
) {

210 
	`oÊ_°ru˘s_oxm_év_¥öt
(
°ªam
, 
f
);

211 i‡(--
size
 > 0Ë
	`Ârötf
(
°ªam
, ", ");

216 
	`Ârötf
(
°ªam
, "all match");

218 
	`Ârötf
(
°ªam
, "}");

219 
	}
}

223 
	$oÊ_°ru˘s_oxm_év_to_°rög
(
oÊ_m©ch_év
 *
f
) {

224 *
°r
;

225 
size_t
 
°r_size
;

226 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

228 
	`oÊ_°ru˘s_oxm_év_¥öt
(
°ªam
, 
f
);

229 
	`f˛o£
(
°ªam
);

230  
°r
;

231 
	}
}

235 
	$oÊ_°ru˘s_oxm_év_¥öt
(
FILE
 *
°ªam
, 
oÊ_m©ch_év
 *
f
)

237 
uöt8_t
 
fõld
 = 
	`OXM_FIELD
(
f
->
hódî
);

239 
fõld
) {

241 
OFPXMT_OFB_IN_PORT
:

242 
	`Ârötf
(
°ªam
, "ö_p‹t=\"%d\"", *((
uöt32_t
*Ë
f
->
vÆue
));

244 
OFPXMT_OFB_IN_PHY_PORT
:

245 
	`Ârötf
(
°ªam
, "ö_phy_p‹t=\"%d\"", *((
uöt32_t
*Ë
f
->
vÆue
));

247 
OFPXMT_OFB_VLAN_VID
: {

248 
uöt16_t
 
v
 = *((uöt16_à*Ë
f
->
vÆue
);

249 i‡(
v
 =
OFPVID_NONE
)

250 
	`Ârötf
(
°ªam
, "vlan_vid=Çone");

251 i‡(
v
 =
OFPVID_PRESENT
 && 
	`OXM_HASMASK
(
f
->
hódî
))

252 
	`Ârötf
(
°ªam
, "vlan_vid=ány");

254 
	`Ârötf
(
°ªam
, "vœn_vid=\"%d\"",
v
 & 
VLAN_VID_MASK
);

257 
OFPXMT_OFB_VLAN_PCP
:

258 
	`Ârötf
(
°ªam
, "vœn_p˝=\"%d\"", *
f
->
vÆue
 & 0x7);

260 
OFPXMT_OFB_ETH_TYPE
:

261 
	`Ârötf
(
°ªam
, "ëh_ty≥=\"0x%x\"", *((
uöt16_t
 *Ë
f
->
vÆue
));

263 
OFPXMT_OFB_TCP_SRC
:

264 
	`Ârötf
(
°ªam
, "t˝_§c=\"%d\"", *((
uöt16_t
*Ë
f
->
vÆue
));

266 
OFPXMT_OFB_TCP_DST
:

267 
	`Ârötf
(
°ªam
, "t˝_d°=\"%d\"", *((
uöt16_t
*Ë
f
->
vÆue
));

269 
OFPXMT_OFB_UDP_SRC
:

270 
	`Ârötf
(
°ªam
, "udp_§c=\"%d\"", *((
uöt16_t
*Ë
f
->
vÆue
));

272 
OFPXMT_OFB_UDP_DST
:

273 
	`Ârötf
(
°ªam
, "udp_d°=\"%d\"", *((
uöt16_t
*Ë
f
->
vÆue
));

275 
OFPXMT_OFB_SCTP_SRC
:

276 
	`Ârötf
(
°ªam
, "s˘p_§c=\"%d\"", *((
uöt16_t
*Ë
f
->
vÆue
));

278 
OFPXMT_OFB_SCTP_DST
:

279 
	`Ârötf
(
°ªam
, "s˘p_d°=\"%d\"", *((
uöt16_t
*Ë
f
->
vÆue
));

281 
OFPXMT_OFB_ETH_SRC
:

282 
	`Ârötf
(
°ªam
, "ëh_§c=\""
ETH_ADDR_FMT
"\"", 
	`ETH_ADDR_ARGS
(
f
->
vÆue
));

283 i‡(
	`OXM_HASMASK
(
f
->
hódî
)) {

284 
	`Ârötf
(
°ªam
, ",Éth_§c_mask=\""
ETH_ADDR_FMT
"\"", 
	`ETH_ADDR_ARGS
(
f
->
vÆue
 + 6));

287 
OFPXMT_OFB_ETH_DST
:

288 
	`Ârötf
(
°ªam
, "ëh_d°=\""
ETH_ADDR_FMT
"\"", 
	`ETH_ADDR_ARGS
(
f
->
vÆue
));

289 i‡(
	`OXM_HASMASK
(
f
->
hódî
)) {

290 
	`Ârötf
(
°ªam
, ",Éth_d°_mask=\""
ETH_ADDR_FMT
"\"", 
	`ETH_ADDR_ARGS
(
f
->
vÆue
 + 6));

293 
OFPXMT_OFB_IPV4_DST
:

294 
	`Ârötf
(
°ªam
, "ùv4_d°=\""
IP_FMT
"\"", 
	`IP_ARGS
(
f
->
vÆue
));

295 i‡(
	`OXM_HASMASK
(
f
->
hódî
)) {

296 
	`Ârötf
(
°ªam
, ", ipv4_d°_mask=\""
IP_FMT
"\"", 
	`IP_ARGS
(
f
->
vÆue
 + 4));

299 
OFPXMT_OFB_IPV4_SRC
:

300 
	`Ârötf
(
°ªam
, "ùv4_§c=\""
IP_FMT
"\"", 
	`IP_ARGS
(
f
->
vÆue
));

301 i‡(
	`OXM_HASMASK
(
f
->
hódî
)) {

302 
	`Ârötf
(
°ªam
, ", ipv4_§c_mask=\""
IP_FMT
"\"", 
	`IP_ARGS
(
f
->
vÆue
 + 4));

305 
OFPXMT_OFB_IP_PROTO
:

306 
	`Ârötf
(
°ªam
, "ù_¥Ÿo=\"%d\"", *
f
->
vÆue
);

308 
OFPXMT_OFB_IP_DSCP
:

309 
	`Ârötf
(
°ªam
, "ù_ds˝=\"%d\"", *
f
->
vÆue
 & 0x3f);

311 
OFPXMT_OFB_IP_ECN
:

312 
	`Ârötf
(
°ªam
, "ù_e˙=\"%d\"", *
f
->
vÆue
 & 0x3);

314 
OFPXMT_OFB_ICMPV4_TYPE
:

315 
	`Ârötf
(
°ªam
, "icmpv4_ty≥\"%d\"", *
f
->
vÆue
);

317 
OFPXMT_OFB_ICMPV4_CODE
:

318 
	`Ârötf
(
°ªam
, "icmpv4_code=\"%d\"", *
f
->
vÆue
);

320 
OFPXMT_OFB_ARP_SHA
:

321 
	`Ârötf
(
°ªam
, "¨p_sha=\""
ETH_ADDR_FMT
"\"", 
	`ETH_ADDR_ARGS
(
f
->
vÆue
));

322 i‡(
	`OXM_HASMASK
(
f
->
hódî
)) {

323 
	`Ârötf
(
°ªam
, ",áΩ_sha_mask=\""
ETH_ADDR_FMT
"\"", 
	`ETH_ADDR_ARGS
(
f
->
vÆue
 + 6));

326 
OFPXMT_OFB_ARP_THA
:

327 
	`Ârötf
(
°ªam
, "¨p_tha=\""
ETH_ADDR_FMT
"\"", 
	`ETH_ADDR_ARGS
(
f
->
vÆue
));

328 i‡(
	`OXM_HASMASK
(
f
->
hódî
)) {

329 
	`Ârötf
(
°ªam
, ",áΩ_tha_mask=\""
ETH_ADDR_FMT
"\"", 
	`ETH_ADDR_ARGS
(
f
->
vÆue
 + 6));

332 
OFPXMT_OFB_ARP_SPA
:

333 
	`Ârötf
(
°ªam
, "¨p_•a=\""
IP_FMT
"\"", 
	`IP_ARGS
(
f
->
vÆue
));

334 i‡(
	`OXM_HASMASK
(
f
->
hódî
)) {

335 
	`Ârötf
(
°ªam
, ",áΩ_sha_mask=\""
IP_FMT
"\"", 
	`IP_ARGS
(
f
->
vÆue
 + 4));

338 
OFPXMT_OFB_ARP_TPA
:

339 
	`Ârötf
(
°ªam
, "¨p_ça=\""
IP_FMT
"\"", 
	`IP_ARGS
(
f
->
vÆue
));

340 i‡(
	`OXM_HASMASK
(
f
->
hódî
)) {

341 
	`Ârötf
(
°ªam
, ",áΩ_ça_mask=\""
IP_FMT
"\"", 
	`IP_ARGS
(
f
->
vÆue
 + 4));

344 
OFPXMT_OFB_ARP_OP
:

345 
	`Ârötf
(
°ªam
, "¨p_›=\"0x%x\"", *((
uöt16_t
*Ë
f
->
vÆue
));

347 
OFPXMT_OFB_IPV6_SRC
: {

348 
addr_°r
[
INET6_ADDRSTRLEN
];

349 
	`öë_¡›
(
AF_INET6
, 
f
->
vÆue
, 
addr_°r
, 
INET6_ADDRSTRLEN
);

350 
	`Ârötf
(
°ªam
, "nw_§c_ùv6=\"%s\"", 
addr_°r
);

351 i‡(
	`OXM_HASMASK
(
f
->
hódî
)) {

352 
	`öë_¡›
(
AF_INET6
, 
f
->
vÆue
 + 16, 
addr_°r
, 
INET6_ADDRSTRLEN
);

353 
	`Ârötf
(
°ªam
, ",Çw_§c_ùv6_mask=\"%s\"", 
addr_°r
);

357 
OFPXMT_OFB_IPV6_DST
: {

358 
addr_°r
[
INET6_ADDRSTRLEN
];

359 
	`öë_¡›
(
AF_INET6
, 
f
->
vÆue
, 
addr_°r
, 
INET6_ADDRSTRLEN
);

360 
	`Ârötf
(
°ªam
, "nw_d°_ùv6=\"%s\"", 
addr_°r
);

361 i‡(
	`OXM_HASMASK
(
f
->
hódî
)) {

362 
	`öë_¡›
(
AF_INET6
, 
f
->
vÆue
 + 16, 
addr_°r
, 
INET6_ADDRSTRLEN
);

363 
	`Ârötf
(
°ªam
, ",Çw_d°_ùv6_mask=\"%s\"", 
addr_°r
);

367 
OFPXMT_OFB_IPV6_ND_TARGET
: {

368 
addr_°r
[
INET6_ADDRSTRLEN
];

369 
	`öë_¡›
(
AF_INET6
, 
f
->
vÆue
, 
addr_°r
, 
INET6_ADDRSTRLEN
);

370 
	`Ârötf
(
°ªam
, "ùv6_nd_èrgë=\"%s\"", 
addr_°r
);

373 
OFPXMT_OFB_IPV6_ND_SLL
:

374 
	`Ârötf
(
°ªam
, "ùv6_nd_¶l=\""
ETH_ADDR_FMT
"\"", 
	`ETH_ADDR_ARGS
(
f
->
vÆue
));

376 
OFPXMT_OFB_IPV6_ND_TLL
:

377 
	`Ârötf
(
°ªam
, "ùv6_nd_él=\""
ETH_ADDR_FMT
"\"", 
	`ETH_ADDR_ARGS
(
f
->
vÆue
));

379 
OFPXMT_OFB_IPV6_FLABEL
:

380 
	`Ârötf
(
°ªam
, "ùv6_Êow_œbñ=\"%d\"", *((
uöt32_t
*Ë
f
->
vÆue
) & 0x000fffff);

381 i‡(
	`OXM_HASMASK
(
f
->
hódî
)) {

382 
	`Ârötf
(
°ªam
, ", ipv6_Êow_œbñ_mask=\"%d\"", *((
uöt32_t
*Ë(
f
->
vÆue
+4)));

385 
OFPXMT_OFB_ICMPV6_TYPE
:

386 
	`Ârötf
(
°ªam
, "icmpv6_ty≥=\"%d\"", *
f
->
vÆue
);

388 
OFPXMT_OFB_ICMPV6_CODE
:

389 
	`Ârötf
(
°ªam
, "icmpv6_code=\"%d\"", *
f
->
vÆue
);

391 
OFPXMT_OFB_MPLS_LABEL
:

392 
	`Ârötf
(
°ªam
, "m∂s_œbñ=\"%d\"",((
uöt32_t
Ë*
f
->
vÆue
) & 0x000fffff);

394 
OFPXMT_OFB_MPLS_TC
:

395 
	`Ârötf
(
°ªam
, "m∂s_tc=\"%d\"", *
f
->
vÆue
 & 0x3);

397 
OFPXMT_OFB_MPLS_BOS
:

398 
	`Ârötf
(
°ªam
, "m∂s_bos=\"%d\"", *
f
->
vÆue
 & 0xfe);

400 
OFPXMT_OFB_METADATA
:

401 
	`Ârötf
(
°ªam
, "mëad©a=\"0x%Œx\"", *((
uöt64_t
*Ë
f
->
vÆue
));

402 i‡(
	`OXM_HASMASK
(
f
->
hódî
)) {

403 
	`Ârötf
(
°ªam
, ", mëad©a_mask=\"0x%Œx\"", *((
uöt64_t
*)(
f
->
vÆue
+8)));

406 
OFPXMT_OFB_PBB_ISID
 :

407 
	`Ârötf
(
°ªam
, "pbb_isid=\"%d\"", *((
uöt32_t
*Ë
f
->
vÆue
));

408 i‡(
	`OXM_HASMASK
(
f
->
hódî
)) {

409 
	`Ârötf
(
°ªam
, ",Öbb_isid_mask=\"%d\"", *((
uöt32_t
*)(
f
->
vÆue
+4)));

412 
OFPXMT_OFB_TUNNEL_ID
:

413 
	`Ârötf
(
°ªam
, "tu¬ñ_id=\"%Œd\"", *((
uöt64_t
*Ë
f
->
vÆue
));

414 i‡(
	`OXM_HASMASK
(
f
->
hódî
)) {

415 
	`Ârötf
(
°ªam
, ",Åu¬ñ_id_mask=\"%Œd\"", *((
uöt64_t
*)(
f
->
vÆue
+8)));

418 
OFPXMT_OFB_IPV6_EXTHDR
:

419 
	`Ârötf
(
°ªam
, "ext_hdr=\"");

420 
	`oÊ_ùv6_ext_hdr_¥öt
(
°ªam
, *((
uöt16_t
*Ë
f
->
vÆue
));

421 
	`Ârötf
(
°ªam
, "\"");

422 i‡(
	`OXM_HASMASK
(
f
->
hódî
)) {

423 
	`Ârötf
(
°ªam
, ",Éxt_hdr_mask=\"0x%x\"", *((
uöt16_t
*)(
f
->
vÆue
+4)));

427 
	`Ârötf
(
°ªam
, "unknow¿ty≥ %d", 
fõld
);

429 
	}
}

433 
	$oÊ_°ru˘s_c⁄fig_to_°rög
(
oÊ_c⁄fig
 *
c
) {

434 *
°r
;

435 
size_t
 
°r_size
;

436 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

437 
	`oÊ_°ru˘s_c⁄fig_¥öt
(
°ªam
, 
c
);

438 
	`f˛o£
(
°ªam
);

439  
°r
;

440 
	}
}

443 
	$oÊ_°ru˘s_c⁄fig_¥öt
(
FILE
 *
°ªam
, 
oÊ_c⁄fig
 *
c
) {

444 
	`Ârötf
(
°ªam
, "{Êags=\"0x%"
PRIx16
"\", mlen=\"%u\"}",

445 
c
->
Êags
, c->
miss_£nd_Àn
);

446 
	}
}

449 
	$oÊ_°ru˘s_buckë_to_°rög
(
oÊ_buckë
 *
b
, 
oÊ_exp
 *
exp
) {

450 *
°r
;

451 
size_t
 
°r_size
;

452 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

453 
	`oÊ_°ru˘s_buckë_¥öt
(
°ªam
, 
b
, 
exp
);

454 
	`f˛o£
(
°ªam
);

455  
°r
;

456 
	}
}

459 
	$oÊ_°ru˘s_buckë_¥öt
(
FILE
 *
°ªam
, 
oÊ_buckë
 *
b
, 
oÊ_exp
 *
exp
) {

460 
size_t
 
i
;

462 
	`Ârötf
(
°ªam
, "{w=\"%u\", w¥t=\"", 
b
->
weight
);

463 
	`oÊ_p‹t_¥öt
(
°ªam
, 
b
->
w©ch_p‹t
);

464 
	`Ârötf
(
°ªam
, "\", wgrp=\"");

465 
	`oÊ_group_¥öt
(
°ªam
, 
b
->
w©ch_group
);

466 
	`Ârötf
(
°ªam
, "\",ácts=[");

468 
i
=0; i<
b
->
a˘i⁄s_num
; i++) {

469 
	`oÊ_a˘i⁄_¥öt
(
°ªam
, 
b
->
a˘i⁄s
[
i
], 
exp
);

470 i‡(
i
 < 
b
->
a˘i⁄s_num
 - 1Ë{ 
	`Ârötf
(
°ªam
, ", "); }

473 
	`Ârötf
(
°ªam
, "]}");

474 
	}
}

477 
	$oÊ_°ru˘s_queue_to_°rög
(
oÊ_∑ckë_queue
 *
q
) {

478 *
°r
;

479 
size_t
 
°r_size
;

480 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

481 
	`oÊ_°ru˘s_queue_¥öt
(
°ªam
, 
q
);

482 
	`f˛o£
(
°ªam
);

483  
°r
;

484 
	}
}

487 
	$oÊ_°ru˘s_queue_¥öt
(
FILE
 *
°ªam
, 
oÊ_∑ckë_queue
 *
q
) {

488 
size_t
 
i
;

490 
	`Ârötf
(
°ªam
, "{q=\"");

491 
	`oÊ_queue_¥öt
(
°ªam
, 
q
->
queue_id
);

492 
	`Ârötf
(
°ªam
, "\",Örops=[");

494 
i
=0; i<
q
->
¥›îtõs_num
; i++) {

495 
	`oÊ_°ru˘s_queue_¥›_¥öt
(
°ªam
, 
q
->
¥›îtõs
[
i
]);

496 i‡(
i
 < 
q
->
¥›îtõs_num
 - 1Ë{ 
	`Ârötf
(
°ªam
, ", "); }

499 
	`Ârötf
(
°ªam
, "]}");

500 
	}
}

503 
	$oÊ_°ru˘s_queue_¥›_to_°rög
(
oÊ_queue_¥›_hódî
 *
p
) {

504 *
°r
;

505 
size_t
 
°r_size
;

506 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

507 
	`oÊ_°ru˘s_queue_¥›_¥öt
(
°ªam
, 
p
);

508 
	`f˛o£
(
°ªam
);

509  
°r
;

510 
	}
}

513 
	$oÊ_°ru˘s_queue_¥›_¥öt
(
FILE
 *
°ªam
, 
oÊ_queue_¥›_hódî
 *
p
) {

514 
	`oÊ_queue_¥›_ty≥_¥öt
(
°ªam
, 
p
->
ty≥
);

516 
p
->
ty≥
) {

517 (
OFPQT_MIN_RATE
): {

518 
oÊ_queue_¥›_mö_øã
 *
pm
 = (oÊ_queue_¥›_mö_øã *)
p
;

520 
	`Ârötf
(
°ªam
, "{øã=\"%u\"}", 
pm
->
øã
);

526 
	}
}

529 
	$oÊ_°ru˘s_Êow_°©s_to_°rög
(
oÊ_Êow_°©s
 *
s
, 
oÊ_exp
 *
exp
) {

530 *
°r
;

531 
size_t
 
°r_size
;

532 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

533 
	`oÊ_°ru˘s_Êow_°©s_¥öt
(
°ªam
, 
s
, 
exp
);

534 
	`f˛o£
(
°ªam
);

535  
°r
;

536 
	}
}

539 
	$oÊ_°ru˘s_Êow_°©s_¥öt
(
FILE
 *
°ªam
, 
oÊ_Êow_°©s
 *
s
, 
oÊ_exp
 *
exp
) {

540 
size_t
 
i
;

542 
	`Ârötf
(
°ªam
, "{table=\"");

543 
	`oÊ_èbÀ_¥öt
(
°ªam
, 
s
->
èbÀ_id
);

544 
	`Ârötf
(
°ªam
, "\", match=\"");

545 
	`oÊ_°ru˘s_m©ch_¥öt
(
°ªam
, 
s
->
m©ch
, 
exp
);

546 
	`Ârötf
(
°ªam
, "\", dur_s=\"%u\", dur_ns=\"%u\",Örio=\"%u\", "

547 "idÀ_to=\"%u\", h¨d_to=\"%u\", cookõ=\"0x%"
PRIx64
"\", "

548 "pkt_˙t=\"%"
PRIu64
"\", byte_cnt=\"%"PRIu64"\", insts=[",

549 
s
->
duøti⁄_£c
, s->
duøti⁄_n£c
, s->
¥i‹ôy
,

550 
s
->
idÀ_timeout
, s->
h¨d_timeout
, s->
cookõ
,

551 
s
->
∑ckë_cou¡
, s->
byã_cou¡
);

553 
i
=0; i<
s
->
ö°ru˘i⁄s_num
; i++) {

554 
	`oÊ_°ru˘s_ö°ru˘i⁄_¥öt
(
°ªam
, 
s
->
ö°ru˘i⁄s
[
i
], 
exp
);

555 i‡(
i
 < 
s
->
ö°ru˘i⁄s_num
 - 1Ë{ 
	`Ârötf
(
°ªam
, ", "); };

558 
	`Ârötf
(
°ªam
, "]}");

559 
	}
}

562 
	$oÊ_°ru˘s_buckë_cou¡î_to_°rög
(
oÊ_buckë_cou¡î
 *
s
) {

563 *
°r
;

564 
size_t
 
°r_size
;

565 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

566 
	`oÊ_°ru˘s_buckë_cou¡î_¥öt
(
°ªam
, 
s
);

567 
	`f˛o£
(
°ªam
);

568  
°r
;

569 
	}
}

572 
	$oÊ_°ru˘s_buckë_cou¡î_¥öt
(
FILE
 *
°ªam
, 
oÊ_buckë_cou¡î
 *
c
) {

573 
	`Ârötf
(
°ªam
, "{pkt_˙t=\"%"
PRIu64
"\", byte_cnt=\"%"PRIu64"\"}",

574 
c
->
∑ckë_cou¡
, c->
byã_cou¡
);

575 
	}
}

578 
	$oÊ_°ru˘s_group_°©s_to_°rög
(
oÊ_group_°©s
 *
s
) {

579 *
°r
;

580 
size_t
 
°r_size
;

581 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

582 
	`oÊ_°ru˘s_group_°©s_¥öt
(
°ªam
, 
s
);

583 
	`f˛o£
(
°ªam
);

584  
°r
;

585 
	}
}

588 
	$oÊ_°ru˘s_group_°©s_¥öt
(
FILE
 *
°ªam
, 
oÊ_group_°©s
 *
s
) {

589 
size_t
 
i
;

591 
	`Ârötf
(
°ªam
, "{group=\"");

592 
	`oÊ_group_¥öt
(
°ªam
, 
s
->
group_id
);

593 
	`Ârötf
(
°ªam
, "\",Ñef_˙t=\"%u\",Ökt_˙t=\"%"
PRIu64
"\", byte_cnt=\"%"PRIu64"\", cntrs=[",

594 
s
->
ªf_cou¡
, s->
∑ckë_cou¡
, s->
byã_cou¡
);

596 
i
=0; i<
s
->
cou¡îs_num
; i++) {

597 
	`oÊ_°ru˘s_buckë_cou¡î_¥öt
(
°ªam
, 
s
->
cou¡îs
[
i
]);

598 i‡(
i
 < 
s
->
cou¡îs_num
 - 1Ë{ 
	`Ârötf
(
°ªam
, ", "); };

601 
	`Ârötf
(
°ªam
, "]}");

602 
	}
}

605 
	$oÊ_°ru˘s_mëî_b™d_to_°rög
(
oÊ_mëî_b™d_hódî
* 
s
){

606 *
°r
;

607 
size_t
 
°r_size
;

608 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

609 
	`oÊ_°ru˘s_mëî_b™d_¥öt
(
°ªam
, 
s
);

610 
	`f˛o£
(
°ªam
);

611  
°r
;

614 
	}
}

617 
	$oÊ_°ru˘s_mëî_b™d_¥öt
(
FILE
 *
°ªam
, 
oÊ_mëî_b™d_hódî
* 
s
){

618 
	`Ârötf
(
°ªam
, "{type = ");

619 
	`oÊ_mëî_b™d_ty≥_¥öt
(
°ªam
, 
s
->
ty≥
);

620 
s
->
ty≥
){

621 (
OFPMBT_DROP
):{

622 
oÊ_mëî_b™d_dr›
 *
d
 = (oÊ_mëî_b™d_dr›*)
s
;

623 
	`Ârötf
(
°ªam
, ",Ñ©e=\"%"
PRIu32
"\", burst_size=\"%"PRIu32"\"}",

624 
d
->
øã
, d->
bur°_size
);

627 (
OFPMBT_DSCP_REMARK
):{

628 
oÊ_mëî_b™d_ds˝_ªm¨k
 *
d
 = (oÊ_mëî_b™d_ds˝_ªm¨k*)
s
;

629 
	`Ârötf
(
°ªam
, ",Ñ©e=\"%"
PRIu32
"\", burst_size=\"%"PRIu32"\",Örec_level=\"%u\"}",

630 
d
->
øã
, d->
bur°_size
, d->
¥ec_Àvñ
);

633 (
OFPMBT_EXPERIMENTER
):{

634 
oÊ_mëî_b™d_ex≥rimíãr
 *
d
 = (oÊ_mëî_b™d_ex≥rimíãr*)
s
;

635 
	`Ârötf
(
°ªam
, ",Ñ©e=\"%"
PRIu32
"\", burst_size=\"%"PRIu32"\",Éxp_id=\"%"PRIu32"\"}",

636 
d
->
øã
, d->
bur°_size
, d->
ex≥rimíãr
);

640 
	}
}

643 
	$oÊ_°ru˘s_mëî_b™d_°©s_to_°rög
(
oÊ_mëî_b™d_°©s
* 
s
){

644 *
°r
;

645 
size_t
 
°r_size
;

646 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

647 
	`oÊ_°ru˘s_mëî_b™d_°©s_¥öt
(
°ªam
, 
s
);

648 
	`f˛o£
(
°ªam
);

649  
°r
;

650 
	}
}

653 
	$oÊ_°ru˘s_mëî_b™d_°©s_¥öt
(
FILE
 *
°ªam
, 
oÊ_mëî_b™d_°©s
* 
s
){

654 
	`Ârötf
(
°ªam
, "{pkt_b™d_˙t=\"%"
PRIu64
"\", byte_band_cnt=\"%"PRIu64"\"}",

655 
s
->
∑ckë_b™d_cou¡
, s->
byã_b™d_cou¡
);

656 
	}
}

659 
	$oÊ_°ru˘s_mëî_°©s_to_°rög
(
oÊ_mëî_°©s
* 
s
){

660 *
°r
;

661 
size_t
 
°r_size
;

662 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

663 
	`oÊ_°ru˘s_mëî_°©s_¥öt
(
°ªam
, 
s
);

664 
	`f˛o£
(
°ªam
);

665  
°r
;

666 
	}
}

669 
	$oÊ_°ru˘s_mëî_°©s_¥öt
(
FILE
 *
°ªam
, 
oÊ_mëî_°©s
* 
s
){

670 
size_t
 
i
;

672 
	`Ârötf
(
°ªam
, "{mëî%x\"", 
s
->
mëî_id
);

673 
	`Ârötf
(
°ªam
, "\", flow_˙t=\"%u\",Ökt_ö_˙t=\"%"
PRIu64
"\", byte_in_cnt=\"%"PRIu64"\""

674 ", duøti⁄_£c=\"%"
PRIu32
"\", duration_nsec=\"%"PRIu32"\", bands=[",

675 
s
->
Êow_cou¡
, s->
∑ckë_ö_cou¡
, s->
byã_ö_cou¡
,

676 
s
->
duøti⁄_£c
, s->
duøti⁄_n£c
);

678 
i
=0; i<
s
->
mëî_b™ds_num
; i++) {

679 
	`oÊ_°ru˘s_mëî_b™d_°©s_¥öt
(
°ªam
, 
s
->
b™d_°©s
[
i
]);

680 i‡(
i
 < 
s
->
mëî_b™ds_num
 - 1Ë{ 
	`Ârötf
(
°ªam
, ", "); };

683 
	`Ârötf
(
°ªam
, "]}");

684 
	}
}

687 
	$oÊ_°ru˘s_mëî_c⁄fig_to_°rög
(
oÊ_mëî_c⁄fig
* 
s
){

688 *
°r
;

689 
size_t
 
°r_size
;

690 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

691 
	`oÊ_°ru˘s_mëî_c⁄fig_¥öt
(
°ªam
, 
s
);

692 
	`f˛o£
(
°ªam
);

693  
°r
;

694 
	}
}

697 
	$oÊ_°ru˘s_mëî_c⁄fig_¥öt
(
FILE
 *
°ªam
, 
oÊ_mëî_c⁄fig
* 
s
){

698 
size_t
 
i
;

700 
	`Ârötf
(
°ªam
, "{mëî%x\"", 
s
->
mëî_id
);

701 
	`Ârötf
(
°ªam
, "\", fœgs=\"%"
PRIx16
"\", bands=[",

702 
s
->
Êags
);

704 
i
=0; i<
s
->
mëî_b™ds_num
; i++) {

705 
	`oÊ_°ru˘s_mëî_b™d_¥öt
(
°ªam
, 
s
->
b™ds
[
i
]);

706 i‡(
i
 < 
s
->
mëî_b™ds_num
 - 1Ë{ 
	`Ârötf
(
°ªam
, ", "); };

709 
	`Ârötf
(
°ªam
, "]}");

711 
	}
}

714 
	$oÊ_°ru˘s_mëî_„©uªs_to_°rög
(
oÊ_mëî_„©uªs
* 
s
){

715 *
°r
;

716 
size_t
 
°r_size
;

717 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

718 
	`oÊ_°ru˘s_mëî_„©uªs_¥öt
(
°ªam
, 
s
);

719 
	`f˛o£
(
°ªam
);

720  
°r
;

721 
	}
}

724 
	$oÊ_°ru˘s_mëî_„©uªs_¥öt
(
FILE
 *
°ªam
, 
oÊ_mëî_„©uªs
* 
s
){

726 
	`Ârötf
(
°ªam
, "{max_mëî=\"%"
PRIu32
"\", b™d_ty≥s=\"%"
PRIx32
"\","

727 "ˇ∑bûôõ†=\"%"
PRIx32
"\", max_bands = %u , max_color = %u",

728 
s
->
max_mëî
, s->
b™d_ty≥s
, s->
ˇ∑bûôõs
, s->
max_b™ds
, s->
max_cﬁ‹
);

729 
	`Ârötf
(
°ªam
, "}");

731 
	}
}

734 
	$oÊ_°ru˘s_èbÀ_°©s_to_°rög
(
oÊ_èbÀ_°©s
 *
s
) {

735 *
°r
;

736 
size_t
 
°r_size
;

737 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

739 
	`oÊ_°ru˘s_èbÀ_°©s_¥öt
(
°ªam
, 
s
);

741 
	`f˛o£
(
°ªam
);

742  
°r
;

743 
	}
}

746 
	$oÊ_°ru˘s_èbÀ_°©s_¥öt
(
FILE
 *
°ªam
, 
oÊ_èbÀ_°©s
 *
s
) {

747 
	`Ârötf
(
°ªam
, "{table=\"");

748 
	`oÊ_èbÀ_¥öt
(
°ªam
, 
s
->
èbÀ_id
);

749 
	`Ârötf
(
°ªam
, "\",áctive=\"%u\", "

750 "lookup=\"%"
PRIu64
"\", match=\"%"PRIu64"\"",

751 
s
->
a˘ive_cou¡
,

752 
s
->
lookup_cou¡
, s->
m©ched_cou¡
);

753 
	}
}

756 
	$oÊ_°ru˘s_èbÀ_¥›îtõs_to_°rög
(
oÊ_èbÀ_„©uª_¥›_hódî
 *
s
){

757 *
°r
;

758 
size_t
 
°r_size
;

759 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

760 
	`oÊ_°ru˘s_èbÀ_¥›îtõs_¥öt
(
°ªam
, 
s
);

761 
	`f˛o£
(
°ªam
);

762  
°r
;

763 
	}
}

766 
	$oÊ_°ru˘s_èbÀ_¥›îtõs_¥öt
(
FILE
 * 
°ªam
, 
oÊ_èbÀ_„©uª_¥›_hódî
* 
s
){

767 
i
;

768 
	`Ârötf
(
°ªam
, "{property=\"");

769 
	`oÊ_¥›îtõs_ty≥_¥öt
(
°ªam
, 
s
->
ty≥
);

770 
s
->
ty≥
){

771 
OFPTFPT_INSTRUCTIONS
:

772 
OFPTFPT_INSTRUCTIONS_MISS
:{

773 
oÊ_èbÀ_„©uª_¥›_ö°ru˘i⁄s
 *
ö°s
 = (oÊ_èbÀ_„©uª_¥›_ö°ru˘i⁄s*Ë
s
;

774 
	`Ârötf
(
°ªam
, "[");

775 if(
ö°s
->
ids_num
) {

776 
i
 = 0; i < 
ö°s
->
ids_num
 -1; i++){

777 
	`oÊ_ö°ru˘i⁄_ty≥_¥öt
(
°ªam
, 
ö°s
->
ö°ru˘i⁄_ids
[
i
].
ty≥
);

778 
	`Ârötf
(
°ªam
, ", ");

780 
	`oÊ_ö°ru˘i⁄_ty≥_¥öt
(
°ªam
, 
ö°s
->
ö°ru˘i⁄_ids
[ö°s->
ids_num
-1].
ty≥
);

782 
	`Ârötf
(
°ªam
, "]");

785 
OFPTFPT_NEXT_TABLES
:

786 
OFPTFPT_NEXT_TABLES_MISS
:{

787 
oÊ_èbÀ_„©uª_¥›_√xt_èbÀs
 *
tbls
 = (oÊ_èbÀ_„©uª_¥›_√xt_èbÀs*Ë
s
;

788 
	`Ârötf
(
°ªam
, "[");

789 if(
tbls
->
èbÀ_num
) {

790 
i
 = 0; i < 
tbls
->
èbÀ_num
 -1; i++){

791 
	`Ârötf
(
°ªam
, "%d, ", 
tbls
->
√xt_èbÀ_ids
[
i
]);

793 
	`Ârötf
(
°ªam
, "%d]", 
tbls
->
√xt_èbÀ_ids
[tbls->
èbÀ_num
 -1]);

797 
OFPTFPT_APPLY_ACTIONS
:

798 
OFPTFPT_APPLY_ACTIONS_MISS
:

799 
OFPTFPT_WRITE_ACTIONS
:

800 
OFPTFPT_WRITE_ACTIONS_MISS
:{

801 
oÊ_èbÀ_„©uª_¥›_a˘i⁄s
 *
a˘s
 = (oÊ_èbÀ_„©uª_¥›_a˘i⁄s*Ë
s
;

802 
	`Ârötf
(
°ªam
, "[");

803 if(
a˘s
->
a˘i⁄s_num
) {

804 
i
 = 0; i < 
a˘s
->
a˘i⁄s_num
 -1; i++){

805 
	`oÊ_a˘i⁄_ty≥_¥öt
(
°ªam
, 
a˘s
->
a˘i⁄_ids
[
i
].
ty≥
);

806 
	`Ârötf
(
°ªam
, ", ");

808 
	`oÊ_a˘i⁄_ty≥_¥öt
(
°ªam
, 
a˘s
->
a˘i⁄_ids
[a˘s->
a˘i⁄s_num
-1].
ty≥
);

810 
	`Ârötf
(
°ªam
, "]");

813 
OFPTFPT_MATCH
:

814 
OFPTFPT_WILDCARDS
:

815 
OFPTFPT_APPLY_SETFIELD
:

816 
OFPTFPT_APPLY_SETFIELD_MISS
:

817 
OFPTFPT_WRITE_SETFIELD
:

818 
OFPTFPT_WRITE_SETFIELD_MISS
:{

819 
oÊ_èbÀ_„©uª_¥›_oxm
 *
oxms
 = (oÊ_èbÀ_„©uª_¥›_oxm*Ë
s
;

820 
	`Ârötf
(
°ªam
, "[");

821 if(
oxms
->
oxm_num
) {

822 
i
 = 0; i < 
oxms
->
oxm_num
 -1; i++){

823 
	`oÊ_oxm_ty≥_¥öt
(
°ªam
, 
oxms
->
oxm_ids
[
i
]);

824 
	`Ârötf
(
°ªam
, ", " );

826 
	`oÊ_oxm_ty≥_¥öt
(
°ªam
, 
oxms
->
oxm_ids
[oxms->
oxm_num
 -1]);

828 
	`Ârötf
(
°ªam
, "]");

834 
	`Ârötf
(
°ªam
, "\"} ");

835 
	}
}

838 
	$oÊ_°ru˘s_èbÀ_„©uªs_to_°rög
(
oÊ_èbÀ_„©uªs
 *
s
){

839 *
°r
;

840 
size_t
 
°r_size
;

841 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

842 
	`oÊ_°ru˘s_èbÀ_„©uªs_¥öt
(
°ªam
, 
s
);

843 
	`f˛o£
(
°ªam
);

844  
°r
;

845 
	}
}

848 
	$oÊ_°ru˘s_èbÀ_„©uªs_¥öt
(
FILE
 *
°ªam
, 
oÊ_èbÀ_„©uªs
 *
s
){

849 
i
;

850 
	`Ârötf
(
°ªam
, "{table=\"");

851 
	`oÊ_èbÀ_¥öt
(
°ªam
, 
s
->
èbÀ_id
);

852 
	`Ârötf
(
°ªam
, "\",Çame=\"%s\", "

853 "mëad©a_m©ch=\"%"
PRIx64
"\", mëad©a_wrôe=\"%"PRIx64"\", c⁄fig=\"%"
PRIu32
"\","

854 "max_íåõs=\"%"
PRIu32
"\"",

855 
s
->
«me
, s->
mëad©a_m©ch
, s->
mëad©a_wrôe
, s->
c⁄fig
, s->
max_íåõs
);

856 
i
 =0; i < 
s
->
¥›îtõs_num
; i++){

857 
	`oÊ_°ru˘s_èbÀ_¥›îtõs_¥öt
(
°ªam
, 
s
->
¥›îtõs
[
i
]);

859 
	}
}

862 
	$oÊ_°ru˘s_p‹t_°©s_to_°rög
(
oÊ_p‹t_°©s
 *
s
) {

863 *
°r
;

864 
size_t
 
°r_size
;

865 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

866 
	`oÊ_°ru˘s_p‹t_°©s_¥öt
(
°ªam
, 
s
);

867 
	`f˛o£
(
°ªam
);

868  
°r
;

869 
	}
}

872 
	$oÊ_°ru˘s_p‹t_°©s_¥öt
(
FILE
 *
°ªam
, 
oÊ_p‹t_°©s
 *
s
) {

874 
	`Ârötf
(
°ªam
, "{port=\"");

875 
	`oÊ_p‹t_¥öt
(
°ªam
, 
s
->
p‹t_no
);

876 
	`Ârötf
(
°ªam
, "\",Ñx_pkt=\"%"
PRIu64
"\",Åx_pkt=\"%"PRIu64"\", "

877 "rx_byãs=\"%"
PRIu64
"\",Åx_bytes=\"%"PRIu64"\", "

878 "rx_dr›s=\"%"
PRIu64
"\",Åx_drops=\"%"PRIu64"\", "

879 "rx_îrs=\"%"
PRIu64
"\",Åx_errs=\"%"PRIu64"\", "

880 "rx_‰m=\"%"
PRIu64
"\",Ñx_over=\"%"PRIu64"\", "

881 "rx_¸c=\"%"
PRIu64
"\", coll=\"%"PRIu64"\"}",

882 
s
->
rx_∑ckës
, s->
tx_∑ckës
,

883 
s
->
rx_byãs
, s->
tx_byãs
,

884 
s
->
rx_dr›≥d
, s->
tx_dr›≥d
,

885 
s
->
rx_îr‹s
, s->
tx_îr‹s
,

886 
s
->
rx_‰ame_îr
, s->
rx_ovî_îr
,

887 
s
->
rx_¸c_îr
, s->
cﬁlisi⁄s
);

888 
	}
};

891 
	$oÊ_°ru˘s_queue_°©s_to_°rög
(
oÊ_queue_°©s
 *
s
) {

892 *
°r
;

893 
size_t
 
°r_size
;

894 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

895 
	`oÊ_°ru˘s_queue_°©s_¥öt
(
°ªam
, 
s
);

896 
	`f˛o£
(
°ªam
);

897  
°r
;

898 
	}
}

901 
	$oÊ_°ru˘s_queue_°©s_¥öt
(
FILE
 *
°ªam
, 
oÊ_queue_°©s
 *
s
) {

903 
	`Ârötf
(
°ªam
, "{port=\"");

904 
	`oÊ_p‹t_¥öt
(
°ªam
, 
s
->
p‹t_no
);

905 
	`Ârötf
(
°ªam
, "\", q=\"");

906 
	`oÊ_queue_¥öt
(
°ªam
, 
s
->
queue_id
);

907 
	`Ârötf
(
°ªam
, "\",Åx_byãs=\"%"
PRIu64
"\", "

908 "tx_pkt=\"%"
PRIu64
"\",Åx_err=\"%"PRIu64"\"}",

909 
s
->
tx_byãs
, s->
tx_∑ckës
, s->
tx_îr‹s
);

910 
	}
};

913 
	$oÊ_°ru˘s_group_desc_°©s_to_°rög
(
oÊ_group_desc_°©s
 *
s
, 
oÊ_exp
 *
exp
) {

914 *
°r
;

915 
size_t
 
°r_size
;

916 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

917 
	`oÊ_°ru˘s_group_desc_°©s_¥öt
(
°ªam
, 
s
, 
exp
);

918 
	`f˛o£
(
°ªam
);

919  
°r
;

920 
	}
}

923 
	$oÊ_°ru˘s_group_desc_°©s_¥öt
(
FILE
 *
°ªam
, 
oÊ_group_desc_°©s
 *
s
, 
oÊ_exp
 *
exp
) {

924 
size_t
 
i
;

926 
	`Ârötf
(
°ªam
, "{type=\"");

927 
	`oÊ_group_ty≥_¥öt
(
°ªam
, 
s
->
ty≥
);

928 
	`Ârötf
(
°ªam
, "\", group=\"");

929 
	`oÊ_group_¥öt
(
°ªam
, 
s
->
group_id
);

930 
	`Ârötf
(
°ªam
, "\", buckets=[");

932 
i
=0; i<
s
->
buckës_num
; i++) {

933 
	`oÊ_°ru˘s_buckë_¥öt
(
°ªam
, 
s
->
buckës
[
i
], 
exp
);

934 i‡(
i
 < 
s
->
buckës_num
 - 1Ë{ 
	`Ârötf
(
°ªam
, ", "); };

937 
	`Ârötf
(
°ªam
, "]}");

938 
	}
}

941 
	$oÊ_°ru˘s_async_c⁄fig_to_°rög
(
oÊ_async_c⁄fig
 *
s
) {

942 *
°r
;

943 
size_t
 
°r_size
;

944 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

945 
	`oÊ_°ru˘s_async_c⁄fig_¥öt
(
°ªam
, 
s
);

946 
	`f˛o£
(
°ªam
);

947  
°r
;

948 
	}
}

952 
	$oÊ_°ru˘s_async_c⁄fig_¥öt
(
FILE
 * 
°ªam
, 
oÊ_async_c⁄fig
 *
s
){

953 
	`Ârötf
(
°ªam
, "{equal=[");

954 
	`oÊ_async_∑ckë_ö
(
°ªam
, 
s
->
∑ckë_ö_mask
[0]);

955 
	`oÊ_async_p‹t_°©us
(
°ªam
, 
s
->
p‹t_°©us_mask
[0]);

956 
	`oÊ_async_Êow_ªmoved
(
°ªam
, 
s
->
Êow_ªmoved_mask
[0]);

957 
	`Ârötf
(
°ªam
, "], ");

958 
	`Ârötf
(
°ªam
, "slave=[");

959 
	`oÊ_async_∑ckë_ö
(
°ªam
, 
s
->
∑ckë_ö_mask
[1]);

960 
	`oÊ_async_p‹t_°©us
(
°ªam
, 
s
->
p‹t_°©us_mask
[1]);

961 
	`oÊ_async_Êow_ªmoved
(
°ªam
, 
s
->
Êow_ªmoved_mask
[1]);

962 
	`Ârötf
(
°ªam
, "]}");

963 
	}
}

	@oflib/ofl-structs-unpack.c

32 
	~<°dlib.h
>

33 
	~<°rög.h
>

34 
	~<√töë/ö.h
>

35 
	~"oÊ.h
"

36 
	~"oÊ-¥öt.h
"

37 
	~"oÊ-a˘i⁄s.h
"

38 
	~"oÊ-°ru˘s.h
"

39 
	~"oÊ-utûs.h
"

40 
	~"oÊ-∑ckës.h
"

41 
	~"oÊ-log.h
"

42 
	~"oxm-m©ch.h
"

43 
	~"›íÊow/›íÊow.h
"

45 
	#LOG_MODULE
 
oÊ_°r_u


	)

46 
	$OFL_LOG_INIT
(
LOG_MODULE
)

48 
oÊ_îr


49 
	$oÊ_°ru˘s_ö°ru˘i⁄s_u≈ack
(
oÂ_ö°ru˘i⁄
 *
§c
, 
size_t
 *
Àn
, 
oÊ_ö°ru˘i⁄_hódî
 **
d°
, 
oÊ_exp
 *
exp
) {

50 
size_t
 
ûí
;

51 
oÊ_ö°ru˘i⁄_hódî
 *
ö°
 = 
NULL
;

53 i‡(*
Àn
 < (
oÂ_ö°ru˘i⁄
)) {

54 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived in°ru˘i⁄ i†toÿsh‹à(%zu).", *
Àn
);

55  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

58 i‡(*
Àn
 < 
	`¡ohs
(
§c
->len)) {

59 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived in°ru˘i⁄ ha†övÆidÜígth (£àtÿ%u, buà⁄ly %zuÑe˚ived).", 
	`¡ohs
(
§c
->
Àn
), *len);

60  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

62 
ûí
 = 
	`¡ohs
(
§c
->
Àn
);

64 
	`¡ohs
(
§c
->
ty≥
)) {

65 
OFPIT_GOTO_TABLE
: {

66 
oÂ_ö°ru˘i⁄_gŸo_èbÀ
 *
si
;

67 
oÊ_ö°ru˘i⁄_gŸo_èbÀ
 *
di
;

69 i‡(
ûí
 < (
oÂ_ö°ru˘i⁄_gŸo_èbÀ
)) {

70 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived GOTO_TABLE in°ru˘i⁄ ha†övÆidÜígth (%zu).", *
Àn
);

71  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBRC_BAD_LEN
);

74 
si
 = (
oÂ_ö°ru˘i⁄_gŸo_èbÀ
 *)
§c
;

76 i‡(
si
->
èbÀ_id
 >
PIPELINE_TABLES
) {

77 i‡(
	`OFL_LOG_IS_WARN_ENABLED
(
LOG_MODULE
)) {

78 *
ts
 = 
	`oÊ_èbÀ_to_°rög
(
si
->
èbÀ_id
);

79 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived GOTO_TABLE in°ru˘i⁄ ha†övÆidÅabÀ_id (%s).", 
ts
);

80 
	`‰ì
(
ts
);

82  
	`oÊ_îr‹
(
OFPET_BAD_INSTRUCTION
, 
OFPBIC_BAD_TABLE_ID
);

85 
di
 = (
oÊ_ö°ru˘i⁄_gŸo_èbÀ
 *)
	`mÆloc
((ofl_instruction_goto_table));

87 
di
->
èbÀ_id
 = 
si
->table_id;

89 
ö°
 = (
oÊ_ö°ru˘i⁄_hódî
 *)
di
;

90 
ûí
 -(
oÂ_ö°ru˘i⁄_gŸo_èbÀ
);

94 
OFPIT_WRITE_METADATA
: {

95 
oÂ_ö°ru˘i⁄_wrôe_mëad©a
 *
si
;

96 
oÊ_ö°ru˘i⁄_wrôe_mëad©a
 *
di
;

98 i‡(
ûí
 < (
oÂ_ö°ru˘i⁄_wrôe_mëad©a
)) {

99 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived WRITE_METADATA in°ru˘i⁄ ha†övÆidÜígth (%zu).", *
Àn
);

100  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBRC_BAD_LEN
);

103 
si
 = (
oÂ_ö°ru˘i⁄_wrôe_mëad©a
 *)
§c
;

104 
di
 = (
oÊ_ö°ru˘i⁄_wrôe_mëad©a
 *)
	`mÆloc
((ofl_instruction_write_metadata));

106 
di
->
mëad©a
 = 
	`¡oh64
(
si
->metadata);

107 
di
->
mëad©a_mask
 = 
	`¡oh64
(
si
->metadata_mask);

109 
ö°
 = (
oÊ_ö°ru˘i⁄_hódî
 *)
di
;

110 
ûí
 -(
oÂ_ö°ru˘i⁄_wrôe_mëad©a
);

113 
OFPIT_WRITE_ACTIONS
:

114 
OFPIT_APPLY_ACTIONS
: {

115 
oÂ_ö°ru˘i⁄_a˘i⁄s
 *
si
;

116 
oÊ_ö°ru˘i⁄_a˘i⁄s
 *
di
;

117 
oÂ_a˘i⁄_hódî
 *
a˘
;

118 
oÊ_îr
 
îr‹
;

119 
size_t
 
i
;

121 i‡(
ûí
 < (
oÂ_ö°ru˘i⁄_a˘i⁄s
)) {

122 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived *_ACTIONS in°ru˘i⁄ ha†övÆidÜígth (%zu).", *
Àn
);

123  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

125 
ûí
 -(
oÂ_ö°ru˘i⁄_a˘i⁄s
);

127 
si
 = (
oÂ_ö°ru˘i⁄_a˘i⁄s
 *)
§c
;

128 
di
 = (
oÊ_ö°ru˘i⁄_a˘i⁄s
 *)
	`mÆloc
((ofl_instruction_actions));

130 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_a˘i⁄s
((
uöt8_t
 *)
si
->
a˘i⁄s
, 
ûí
, &
di
->
a˘i⁄s_num
);

131 i‡(
îr‹
) {

132 
	`‰ì
(
di
);

133  
îr‹
;

135 
di
->
a˘i⁄s
 = (
oÊ_a˘i⁄_hódî
 **)
	`mÆloc
(di->
a˘i⁄s_num
 * (ofl_action_header *));

137 
a˘
 = 
si
->
a˘i⁄s
;

138 
i
 = 0; i < 
di
->
a˘i⁄s_num
; i++) {

139 
îr‹
 = 
	`oÊ_a˘i⁄s_u≈ack
(
a˘
, &
ûí
, &(
di
->
a˘i⁄s
[
i
]), 
exp
);

140 i‡(
îr‹
) {

141 *
Àn
 = *À¿- 
	`¡ohs
(
§c
->ÀnË+ 
ûí
;

142 
	`OFL_UTILS_FREE_ARR_FUN2
(
di
->
a˘i⁄s
, 
i
,

143 
oÊ_a˘i⁄s_‰ì
, 
exp
);

144 
	`‰ì
(
di
);

145  
îr‹
;

147 
a˘
 = (
oÂ_a˘i⁄_hódî
 *)((
uöt8_t
 *Ô˘ + 
	`¡ohs
◊˘->
Àn
));

150 
ö°
 = (
oÊ_ö°ru˘i⁄_hódî
 *)
di
;

153 
OFPIT_CLEAR_ACTIONS
: {

154 i‡(
ûí
 < (
oÂ_ö°ru˘i⁄_a˘i⁄s
)) {

155 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived CLEAR_ACTIONS in°ru˘i⁄ ha†övÆidÜígth (%zu).", *
Àn
);

156  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

159 
ö°
 = (
oÊ_ö°ru˘i⁄_hódî
 *)
	`mÆloc
((ofl_instruction_header));

160 
ö°
->
ty≥
 = (
oÂ_ö°ru˘i⁄_ty≥
)
	`¡ohs
(
§c
->type);

162 
ûí
 -(
oÂ_ö°ru˘i⁄_a˘i⁄s
);

165 
OFPIT_METER
: {

166 
oÂ_ö°ru˘i⁄_mëî
 *
si
;

167 
oÊ_ö°ru˘i⁄_mëî
 *
di
;

169 i‡(
ûí
 < (
oÂ_ö°ru˘i⁄_mëî
)) {

170 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived METER in°ru˘i⁄ ha†övÆidÜígth (%zu).", *
Àn
);

171  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBRC_BAD_LEN
);

173 
si
 = (
oÂ_ö°ru˘i⁄_mëî
*)
§c
;

174 
di
 = (
oÊ_ö°ru˘i⁄_mëî
 *)
	`mÆloc
((ofl_instruction_meter));

176 
di
->
mëî_id
 = 
	`¡ohl
(
si
->meter_id);

178 
ö°
 = (
oÊ_ö°ru˘i⁄_hódî
 *)
di
;

179 
ûí
 -(
oÂ_ö°ru˘i⁄_mëî
);

182 
OFPIT_SET_STATE
: {

183 
oÂ_ö°ru˘i⁄_£t_°©e
 *
si
;

184 
oÊ_ö°ru˘i⁄_£t_°©e
 *
di
;

186 i‡(
ûí
 < (
oÂ_ö°ru˘i⁄_£t_°©e
)) {

187 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived së sèã in°ru˘i⁄ ha†övÆidÜígth (%zu).", *
Àn
);

188  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBRC_BAD_LEN
);

190 
si
 = (
oÂ_ö°ru˘i⁄_£t_°©e
*)
§c
;

191 
di
 = (
oÊ_ö°ru˘i⁄_£t_°©e
 *)
	`mÆloc
((ofl_instruction_set_state));

193 
di
->
°©e
 = 
	`¡ohl
(
si
->state);

195 
ö°
 = (
oÊ_ö°ru˘i⁄_hódî
 *)
di
;

196 
ûí
 -(
oÂ_ö°ru˘i⁄_£t_°©e
);

199 
OFPIT_EXPERIMENTER
: {

200 
oÊ_îr
 
îr‹
;

202 i‡(
exp
 =
NULL
 ||Éxp->
ö°
 =NULL ||Éxp->ö°->
u≈ack
 == NULL) {

203 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received EXPERIMENTER instruction, butÇo callback was given.");

204  
	`oÊ_îr‹
(
OFPET_BAD_INSTRUCTION
, 
OFPBIC_UNSUP_INST
);

206 
îr‹
 = 
exp
->
ö°
->
	`u≈ack
(
§c
, &
ûí
, &inst);

207 i‡(
îr‹
) {

208  
îr‹
;

213 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Thêª˚ived in°ru˘i⁄Åy≥ (%zuËi†övÆid.", 
	`¡ohs
(
§c
->
ty≥
));

214  
	`oÊ_îr‹
(
OFPET_BAD_INSTRUCTION
, 
OFPBIC_UNKNOWN_INST
);

218 
ö°
->
ty≥
 = (
oÂ_ö°ru˘i⁄_ty≥
)
	`¡ohs
(
§c
->type);

220 i‡(
ûí
 != 0) {

221 *
Àn
 = *À¿- 
	`¡ohs
(
§c
->ÀnË+ 
ûí
;

222 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Thêª˚ived in°ru˘i⁄ c⁄èöedÉxå®byã†(%zu).", 
ûí
);

223 
	`oÊ_°ru˘s_‰ì_ö°ru˘i⁄
(
ö°
, 
exp
);

224  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

227 *
Àn
 -
	`¡ohs
(
§c
->len);

228 (*
d°
Ë
ö°
;

231 
	}
}

233 
oÊ_îr


234 
	$oÊ_°ru˘s_èbÀ_¥›îtõs_u≈ack
(
oÂ_èbÀ_„©uª_¥›_hódî
 * 
§c
, 
size_t
 *
Àn
, 
oÊ_èbÀ_„©uª_¥›_hódî
 **
d°
, 
oÊ_exp
 *
exp
){

235 
size_t
 
∂í
;

236 
oÊ_îr
 
îr‹
;

237 
oÊ_èbÀ_„©uª_¥›_hódî
 * 
¥›
 = 
NULL
;

239 i‡(*
Àn
 < (
oÂ_èbÀ_„©uª_¥›_hódî
)){

240 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived fótuª i†toÿsh‹à(%zu).", *
Àn
);

241  
	`oÊ_îr‹
(
OFPET_TABLE_FEATURES_FAILED
, 
OFPTFFC_BAD_LEN
);

244 i‡(*
Àn
 < 
	`¡ohs
(
§c
->
Àngth
)) {

245 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ivedÅabÀÖr›îty ha†övÆidÜígth (£àtÿ%u, buà⁄ly %zuÑe˚ived).", 
	`¡ohs
(
§c
->
Àngth
), *
Àn
);

246  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

248 
∂í
 = 
	`¡ohs
(
§c
->
Àngth
);

250 
	`¡ohs
(
§c
->
ty≥
)){

251 
OFPTFPT_INSTRUCTIONS
:

252 
OFPTFPT_INSTRUCTIONS_MISS
:{

253 
oÂ_èbÀ_„©uª_¥›_ö°ru˘i⁄s
 *
•
 = (oÂ_èbÀ_„©uª_¥›_ö°ru˘i⁄s*Ë
§c
;

254 
oÊ_èbÀ_„©uª_¥›_ö°ru˘i⁄s
 *
dp
;

255 
size_t
 
ûí
,
i
;

256 
uöt8_t
 *
±r
;

258 i‡(
∂í
 < (
oÂ_èbÀ_„©uª_¥›_ö°ru˘i⁄s
)) {

259 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived INSTRUCTION fótuª ha†övÆidÜígth (%zu).", *
Àn
);

260  
	`oÊ_îr‹
(
OFPET_TABLE_FEATURES_FAILED
, 
OFPTFFC_BAD_LEN
);

263 
dp
 = (
oÊ_èbÀ_„©uª_¥›_ö°ru˘i⁄s
*Ë
	`mÆloc
((ofl_table_feature_prop_instructions));

264 
ûí
 = 
∂í
 - (
oÂ_èbÀ_„©uª_¥›_ö°ru˘i⁄s
);

265 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_ö°ru˘i⁄s
((
uöt8_t
*Ë
•
->
ö°ru˘i⁄_ids
, 
ûí
, &
dp
->
ids_num
);

266 if(
îr‹
){

267 
	`‰ì
(
dp
);

268  
îr‹
;

270 
dp
->
ö°ru˘i⁄_ids
 = (
oÊ_ö°ru˘i⁄_hódî
*Ë
	`mÆloc
((oÊ_ö°ru˘i⁄_hódîË* dp->
ids_num
);

272 
±r
 = (
uöt8_t
*Ë
•
->
ö°ru˘i⁄_ids
;

273 
i
 = 0; i < 
dp
->
ids_num
; i++){

274 
dp
->
ö°ru˘i⁄_ids
[
i
].
ty≥
 = 
	`¡ohs
(((
oÂ_ö°ru˘i⁄
*Ë
±r
)->type);

275 
±r
 +
	`¡ohs
(((
oÂ_ö°ru˘i⁄
*Ë±r)->
Àn
);

277 
∂í
 -
	`¡ohs
(
•
->
Àngth
);

278 
¥›
 = (
oÊ_èbÀ_„©uª_¥›_hódî
*Ë
dp
;

281 
OFPTFPT_NEXT_TABLES
:

282 
OFPTFPT_NEXT_TABLES_MISS
:{

283 
oÂ_èbÀ_„©uª_¥›_√xt_èbÀs
 *
•
 = (oÂ_èbÀ_„©uª_¥›_√xt_èbÀs*Ë
§c
;

284 
oÊ_èbÀ_„©uª_¥›_√xt_èbÀs
 *
dp
;

286 i‡(
∂í
 < (
oÂ_èbÀ_„©uª_¥›_√xt_èbÀs
)) {

287 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived NEXT TABLE fótuª ha†övÆidÜígth (%zu).", *
Àn
);

288  
	`oÊ_îr‹
(
OFPET_TABLE_FEATURES_FAILED
, 
OFPTFFC_BAD_LEN
);

290 
dp
 = (
oÊ_èbÀ_„©uª_¥›_√xt_èbÀs
*Ë
	`mÆloc
((ofl_table_feature_prop_next_tables));

292 
dp
->
èbÀ_num
 = 
	`¡ohs
(
•
->
Àngth
Ë- (
oÂ_èbÀ_„©uª_¥›_√xt_èbÀs
);

293 
dp
->
√xt_èbÀ_ids
 = (
uöt8_t
*Ë
	`mÆloc
((uöt8_tË* dp->
èbÀ_num
);

294 
	`mem˝y
(
dp
->
√xt_èbÀ_ids
, 
•
->√xt_èbÀ_ids, dp->
èbÀ_num
);

296 
∂í
 -
	`¡ohs
(
•
->
Àngth
);

297 
¥›
 = (
oÊ_èbÀ_„©uª_¥›_hódî
*Ë
dp
;

300 
OFPTFPT_WRITE_ACTIONS
:

301 
OFPTFPT_WRITE_ACTIONS_MISS
:

302 
OFPTFPT_APPLY_ACTIONS
:

303 
OFPTFPT_APPLY_ACTIONS_MISS
:{

304 
oÂ_èbÀ_„©uª_¥›_a˘i⁄s
 *
•
 = (oÂ_èbÀ_„©uª_¥›_a˘i⁄s*Ë
§c
;

305 
oÊ_èbÀ_„©uª_¥›_a˘i⁄s
 *
dp
;

306 
size_t
 
Æí
, 
i
;

307 
uöt8_t
 *
±r
;

309 i‡(
∂í
 < (
oÂ_èbÀ_„©uª_¥›_a˘i⁄s
)) {

310 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived ACTION fótuª ha†övÆidÜígth (%zu).", *
Àn
);

311  
	`oÊ_îr‹
(
OFPET_TABLE_FEATURES_FAILED
, 
OFPTFFC_BAD_LEN
);

313 
Æí
 = 
∂í
 - (
oÂ_èbÀ_„©uª_¥›_a˘i⁄s
);

314 
dp
 = (
oÊ_èbÀ_„©uª_¥›_a˘i⁄s
*Ë
	`mÆloc
((ofl_table_feature_prop_actions));

315 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_a˘i⁄s
((
uöt8_t
*)
•
->
a˘i⁄_ids
, 
Æí
, &
dp
->
a˘i⁄s_num
);

316 if(
îr‹
){

317 
	`‰ì
(
dp
);

318  
îr‹
;

321 
dp
->
a˘i⁄_ids
 = (
oÊ_a˘i⁄_hódî
*Ë
	`mÆloc
((oÊ_a˘i⁄_hódîË* dp->
a˘i⁄s_num
);

323 
±r
 = (
uöt8_t
*Ë
•
->
a˘i⁄_ids
;

324 
i
 = 0; i < 
dp
->
a˘i⁄s_num
; i++){

325 
dp
->
a˘i⁄_ids
[
i
].
ty≥
 = 
	`¡ohs
(((
oÂ_a˘i⁄_hódî
*Ë
±r
)->type);

326 
dp
->
a˘i⁄_ids
[
i
].
Àn
 = 
	`¡ohs
(((
oÂ_a˘i⁄_hódî
*Ë
±r
)->len);

327 
±r
 +
	`¡ohs
(((
oÂ_a˘i⁄_hódî
*Ë±r)->
Àn
);

329 
∂í
 -
	`¡ohs
(
•
->
Àngth
);

330 
¥›
 = (
oÊ_èbÀ_„©uª_¥›_hódî
*Ë
dp
;

333 
OFPTFPT_MATCH
:

334 
OFPTFPT_WILDCARDS
:

335 
OFPTFPT_WRITE_SETFIELD
:

336 
OFPTFPT_WRITE_SETFIELD_MISS
:

337 
OFPTFPT_APPLY_SETFIELD
:

338 
OFPTFPT_APPLY_SETFIELD_MISS
:{

339 
oÂ_èbÀ_„©uª_¥›_oxm
 *
•
 = (oÂ_èbÀ_„©uª_¥›_oxm*Ë
§c
;

340 
oÊ_èbÀ_„©uª_¥›_oxm
 *
dp
;

341 
size_t
 
i
;

343 i‡(
∂í
 < (
oÂ_èbÀ_„©uª_¥›_oxm
)) {

344 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived MATCH fótuª ha†övÆidÜígth (%zu).", *
Àn
);

345  
	`oÊ_îr‹
(
OFPET_TABLE_FEATURES_FAILED
, 
OFPTFFC_BAD_LEN
);

348 
dp
 = (
oÊ_èbÀ_„©uª_¥›_oxm
*Ë
	`mÆloc
((ofl_table_feature_prop_oxm));

350 
dp
->
oxm_num
 = (
	`¡ohs
(
•
->
Àngth
Ë- (
oÂ_èbÀ_„©uª_¥›_oxm
))/(
uöt32_t
);

351 
dp
->
oxm_ids
 = (
uöt32_t
*Ë
	`mÆloc
((uöt32_tË* dp->
oxm_num
);

352 
i
 = 0; i < 
dp
->
oxm_num
; i++ ){

353 
dp
->
oxm_ids
[
i
] = 
	`¡ohl
(
•
->oxm_ids[i]);

355 
∂í
 -
	`¡ohs
(
•
->
Àngth
);

356 
¥›
 = (
oÊ_èbÀ_„©uª_¥›_hódî
*Ë
dp
;

362 
¥›
->
ty≥
 = (
oÂ_èbÀ_„©uª_¥›_ty≥
Ë
	`¡ohs
(
§c
->type);

364 
¥›
->
Àngth
 = 
	`¡ohs
(
§c
->length);

366 i‡(
∂í
 != 0){

367 *
Àn
 = *À¿- 
	`¡ohs
(
§c
->
Àngth
Ë+ 
∂í
;

368 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Thêª˚ivedÖr›îty c⁄èöedÉxå®byã†(%zu).", 
∂í
);

370  
	`oÊ_îr‹
(
OFPET_TABLE_FEATURES_FAILED
, 
OFPTFFC_BAD_LEN
);

372 *
Àn
 -
	`¡ohs
(
§c
->
Àngth
);

373 (*
d°
Ë
¥›
;

375 
	}
}

378 
oÊ_îr


379 
	$oÊ_°ru˘s_èbÀ_„©uªs_u≈ack
(
oÂ_èbÀ_„©uªs
 *
§c
,
size_t
 *
Àn
, 
oÊ_èbÀ_„©uªs
 **
d°
, 
oÊ_exp
 *
exp
){

380 
oÊ_èbÀ_„©uªs
 *
„©
;

381 
uöt8_t
 *
¥›
;

382 
oÊ_îr
 
îr‹
;

383 
size_t
 
∂í
, 
i
;

385 if(*
Àn
 < (
oÂ_èbÀ_„©uªs
)){

386 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ivedÅabÀ fótuª i†toÿsh‹à(%zu).", *
Àn
);

387  
	`oÊ_îr‹
(
OFPET_TABLE_FEATURES_FAILED
, 
OFPTFFC_BAD_LEN
);

390 if(*
Àn
 < 
	`¡ohs
(
§c
->
Àngth
)){

391 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ivedÅabÀ_„©uª ha†övÆidÜígth (£àtÿ%u, buà⁄ly %zuÑe˚ived).", 
	`¡ohs
(
§c
->
Àngth
), *
Àn
);

392  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

395 
„©
 = (
oÊ_èbÀ_„©uªs
*Ë
	`mÆloc
((ofl_table_features));

397 
„©
->
Àngth
 = 
	`¡ohs
(
§c
->length);

398 
„©
->
èbÀ_id
 = 
§c
->table_id;

399 
„©
->
«me
 = 
	`mÆloc
(
OFP_MAX_TABLE_NAME_LEN
);

400 
	`°∫˝y
(
„©
->
«me
, 
§c
->«me, 
OFP_MAX_TABLE_NAME_LEN
);

401 
„©
->
mëad©a_m©ch
 = 
	`¡oh64
(
§c
->metadata_match);

402 
„©
->
mëad©a_wrôe
 = 
	`¡oh64
(
§c
->metadata_write);

403 
„©
->
c⁄fig
 = 
	`¡ohl
(
§c
->config);

404 
„©
->
max_íåõs
 = 
	`¡ohl
(
§c
->max_entries);

406 
∂í
 = 
	`¡ohs
(
§c
->
Àngth
Ë- (
oÂ_èbÀ_„©uªs
);

407 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_èbÀ_„©uªs_¥›îtõs
((
uöt8_t
*Ë
§c
->
¥›îtõs
, 
∂í
, &
„©
->
¥›îtõs_num
);

408 i‡(
îr‹
) {

409 
	`‰ì
(
„©
);

410  
îr‹
;

412 
„©
->
¥›îtõs
 = (
oÊ_èbÀ_„©uª_¥›_hódî
**Ë
	`mÆloc
((oÊ_èbÀ_„©uª_¥›_hódî *Ë* fót->
¥›îtõs_num
);

414 
¥›
 = (
uöt8_t
*Ë
§c
->
¥›îtõs
;

415 
i
 = 0; i < 
„©
->
¥›îtõs_num
; i++){

416 
îr‹
 = 
	`oÊ_°ru˘s_èbÀ_¥›îtõs_u≈ack
((
oÂ_èbÀ_„©uª_¥›_hódî
*Ë
¥›
, &
∂í
, &
„©
->
¥›îtõs
[
i
], 
exp
);

417 i‡(
îr‹
) {

418 *
Àn
 = *À¿- 
	`¡ohs
(
§c
->
Àngth
Ë+ 
∂í
;

421 
	`‰ì
(
„©
);

422  
îr‹
;

424 
¥›
 +
	`ROUND_UP
(
	`¡ohs
(((
oÂ_èbÀ_„©uª_¥›_hódî
*Ë¥›)->
Àngth
),8);

427 *
Àn
 -
	`¡ohs
(
§c
->
Àngth
);

429 *
d°
 = 
„©
;

431 
	}
}

433 
oÊ_îr


434 
	$oÊ_°ru˘s_buckë_u≈ack
(
oÂ_buckë
 *
§c
, 
size_t
 *
Àn
, 
uöt8_t
 
gty≥
, 
oÊ_buckë
 **
d°
, 
oÊ_exp
 *
exp
) {

435 
oÊ_buckë
 *
b
;

436 
oÂ_a˘i⁄_hódî
 *
a˘
;

437 
size_t
 
bÀn
;

438 
oÊ_îr
 
îr‹
;

439 
size_t
 
i
;

441 i‡(*
Àn
 < (
oÂ_buckë
)) {

442 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived buckë i†toÿsh‹à(%zu).", *
Àn
);

443  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

446 i‡(*
Àn
 < 
	`¡ohs
(
§c
->len)) {

447 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived buckë ha†övÆidÜígth (£àtÿ%u, buà⁄ly %zuÑe˚ived).", 
	`¡ohs
(
§c
->
Àn
), *len);

448  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

451 
bÀn
 = 
	`¡ohs
(
§c
->
Àn
Ë- (
oÂ_buckë
);

453 i‡(
gty≥
 =
OFPGT_SELECT
 && 
	`¡ohs
(
§c
->
weight
) == 0) {

454 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received bucket hasÇo weight for SELECT group.");

455  
	`oÊ_îr‹
(
OFPET_GROUP_MOD_FAILED
, 
OFPGMFC_INVALID_GROUP
);

458 i‡(
gty≥
 !
OFPGT_SELECT
 && 
	`¡ohs
(
§c
->
weight
) > 0) {

459 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received bucket has weight forÇon-SELECT group.");

460  
	`oÊ_îr‹
(
OFPET_GROUP_MOD_FAILED
, 
OFPGMFC_INVALID_GROUP
);

463 
b
 = (
oÊ_buckë
 *)
	`mÆloc
((ofl_bucket));

465 
b
->
weight
 = 
	`¡ohs
(
§c
->weight);

466 
b
->
w©ch_p‹t
 = 
	`¡ohl
(
§c
->watch_port);

467 
b
->
w©ch_group
 = 
	`¡ohl
(
§c
->watch_group);

469 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_a˘i⁄s
((
uöt8_t
 *)
§c
->
a˘i⁄s
, 
bÀn
, &
b
->
a˘i⁄s_num
);

470 i‡(
îr‹
) {

471 
	`‰ì
(
b
);

472  
îr‹
;

474 
b
->
a˘i⁄s
 = (
oÊ_a˘i⁄_hódî
 **)
	`mÆloc
(b->
a˘i⁄s_num
 * (ofl_action_header *));

476 
a˘
 = 
§c
->
a˘i⁄s
;

477 
i
 = 0; i < 
b
->
a˘i⁄s_num
; i++) {

478 
îr‹
 = 
	`oÊ_a˘i⁄s_u≈ack
(
a˘
, &
bÀn
, &(
b
->
a˘i⁄s
[
i
]), 
exp
);

479 i‡(
îr‹
) {

480 *
Àn
 = *À¿- 
	`¡ohs
(
§c
->ÀnË+ 
bÀn
;

481 
	`OFL_UTILS_FREE_ARR_FUN2
(
b
->
a˘i⁄s
, 
i
,

482 
oÊ_a˘i⁄s_‰ì
, 
exp
);

483 
	`‰ì
(
b
);

484  
îr‹
;

486 
a˘
 = (
oÂ_a˘i⁄_hódî
 *)((
uöt8_t
 *Ô˘ + 
	`¡ohs
◊˘->
Àn
));

489 i‡(
bÀn
 >= 8) {

490 *
Àn
 = *À¿- 
	`¡ohs
(
§c
->ÀnË+ 
bÀn
;

491 
	`oÊ_°ru˘s_‰ì_buckë
(
b
, 
exp
);

492 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived buckë ha†m‹êth™ 64 bôÖaddög (%zu).", 
bÀn
);

493  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

495 *
Àn
 -
	`¡ohs
(
§c
->len);

497 *
d°
 = 
b
;

499 
	}
}

502 
oÊ_îr


503 
	$oÊ_°ru˘s_Êow_°©s_u≈ack
(
oÂ_Êow_°©s
 *
§c
, 
uöt8_t
 *
buf
, 
size_t
 *
Àn
, 
oÊ_Êow_°©s
 **
d°
, 
oÊ_exp
 *
exp
) {

504 
oÊ_Êow_°©s
 *
s
;

505 
oÂ_ö°ru˘i⁄
 *
ö°
;

506 
oÊ_îr
 
îr‹
;

507 
size_t
 
¶í
;

508 
size_t
 
i
;

509 
m©ch_pos
;

510 i‡(*
Àn
 < ( ((
oÂ_Êow_°©s
Ë- (
oÂ_m©ch
)Ë+ 
	`ROUND_UP
(
	`¡ohs
(
§c
->
m©ch
.
Àngth
),8))) {

511 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived flow sèt†ha†övÆidÜígth (%zu).", *
Àn
);

512  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

515 i‡(*
Àn
 < 
	`¡ohs
(
§c
->
Àngth
)) {

516 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived flow sèt†ª∂y ha†övÆidÜígth (£àtÿ%u, buà⁄ly %zuÑe˚ived).", 
	`¡ohs
(
§c
->
Àngth
), *
Àn
);

517  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

520 i‡(
§c
->
èbÀ_id
 >
PIPELINE_TABLES
) {

521 i‡(
	`OFL_LOG_IS_WARN_ENABLED
(
LOG_MODULE
)) {

522 *
ts
 = 
	`oÊ_èbÀ_to_°rög
(
§c
->
èbÀ_id
);

523 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived flow sèt†ha†övÆidÅabÀ_id (%s).", 
ts
);

524 
	`‰ì
(
ts
);

526  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_TABLE_ID
);

529 
¶í
 = 
	`¡ohs
(
§c
->
Àngth
Ë- ((
oÂ_Êow_°©s
Ë- (
oÂ_m©ch
));

531 
s
 = (
oÊ_Êow_°©s
 *)
	`mÆloc
((ofl_flow_stats));

532 
s
->
èbÀ_id
 = 
§c
->table_id;

533 
s
->
duøti⁄_£c
 = 
	`¡ohl
–
§c
->duration_sec);

534 
s
->
duøti⁄_n£c
 = 
	`¡ohl
–
§c
->duration_nsec);

535 
s
->
¥i‹ôy
 = 
	`¡ohs
–
§c
->priority);

536 
s
->
idÀ_timeout
 = 
	`¡ohs
–
§c
->idle_timeout);

537 
s
->
h¨d_timeout
 = 
	`¡ohs
–
§c
->hard_timeout);

538 
s
->
cookõ
 = 
	`¡oh64
(
§c
->cookie);

539 
s
->
∑ckë_cou¡
 = 
	`¡oh64
(
§c
->packet_count);

540 
s
->
byã_cou¡
 = 
	`¡oh64
(
§c
->byte_count);

542 
m©ch_pos
 = (
oÂ_Êow_°©s
) - 4;

544 
îr‹
 = 
	`oÊ_°ru˘s_m©ch_u≈ack
(&(
§c
->
m©ch
),
buf
 + 
m©ch_pos
 , &
¶í
, &(
s
->m©ch), 
exp
);

545 i‡(
îr‹
) {

546 
	`‰ì
(
s
);

547  
îr‹
;

549 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_ö°ru˘i⁄s
((
oÂ_ö°ru˘i⁄
 *Ë(
buf
 + 
	`ROUND_UP
(
m©ch_pos
 + 
s
->
m©ch
->
Àngth
,8)),

550 
¶í
, &
s
->
ö°ru˘i⁄s_num
);

552 i‡(
îr‹
) {

553 
	`oÊ_°ru˘s_‰ì_m©ch
(
s
->
m©ch
, 
exp
);

554 
	`‰ì
(
s
);

555  
îr‹
;

557 
s
->
ö°ru˘i⁄s
 = (
oÊ_ö°ru˘i⁄_hódî
 **)
	`mÆloc
(s->
ö°ru˘i⁄s_num
 * (ofl_instruction_header *));

559 
ö°
 = (
oÂ_ö°ru˘i⁄
 *Ë(
buf
 + 
	`ROUND_UP
(
m©ch_pos
 + 
s
->
m©ch
->
Àngth
,8));

560 
i
 = 0; i < 
s
->
ö°ru˘i⁄s_num
; i++) {

561 
îr‹
 = 
	`oÊ_°ru˘s_ö°ru˘i⁄s_u≈ack
(
ö°
, &
¶í
, &(
s
->
ö°ru˘i⁄s
[
i
]), 
exp
);

562 i‡(
îr‹
) {

563 
	`OFL_UTILS_FREE_ARR_FUN2
(
s
->
ö°ru˘i⁄s
, 
i
,

564 
oÊ_°ru˘s_‰ì_ö°ru˘i⁄
, 
exp
);

565 
	`‰ì
(
s
);

566  
îr‹
;

568 
ö°
 = (
oÂ_ö°ru˘i⁄
 *)((
uöt8_t
 *)ö° + 
	`¡ohs
(ö°->
Àn
));

571 i‡(
¶í
 != 0) {

572 *
Àn
 = *À¿- 
	`¡ohs
(
§c
->
Àngth
Ë+ 
¶í
;

573 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Thêª˚ived flow sèt†c⁄èöedÉxå®byã†(%zu).", 
¶í
);

574 
	`oÊ_°ru˘s_‰ì_Êow_°©s
(
s
, 
exp
);

575  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

577 *
Àn
 -
	`¡ohs
(
§c
->
Àngth
);

578 *
d°
 = 
s
;

580 
	}
}

583 
oÊ_îr


584 
	$oÊ_°ru˘s_group_°©s_u≈ack
(
oÂ_group_°©s
 *
§c
, 
size_t
 *
Àn
, 
oÊ_group_°©s
 **
d°
) {

585 
oÊ_group_°©s
 *
s
;

586 
oÂ_buckë_cou¡î
 *
c
;

587 
oÊ_îr
 
îr‹
;

588 
size_t
 
¶í
;

589 
size_t
 
i
;

591 i‡(*
Àn
 < (
oÂ_group_°©s
)) {

592 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived grou∞des¯°©†ª∂y i†toÿsh‹à(%zu).", *
Àn
);

593  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

596 i‡(*
Àn
 < 
	`¡ohs
(
§c
->
Àngth
)) {

597 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived grou∞°©†ª∂y ha†övÆidÜígth (£àtÿ%u, buà⁄ly %zuÑe˚ived).", 
	`¡ohs
(
§c
->
Àngth
), *
Àn
);

598  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

601 i‡(
	`¡ohl
(
§c
->
group_id
Ë> 
OFPG_MAX
) {

602 i‡(
	`OFL_LOG_IS_WARN_ENABLED
(
LOG_MODULE
)) {

603 *
gs
 = 
	`oÊ_group_to_°rög
(
	`¡ohl
(
§c
->
group_id
));

604 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived grou∞°©†ha†övÆid group_id (%s).", 
gs
);

605 
	`‰ì
(
gs
);

607  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBRC_BAD_LEN
);

609 
¶í
 = 
	`¡ohs
(
§c
->
Àngth
Ë- (
oÂ_group_°©s
);

611 
s
 = (
oÊ_group_°©s
 *)
	`mÆloc
((ofl_group_stats));

612 
s
->
group_id
 = 
	`¡ohl
(
§c
->group_id);

613 
s
->
ªf_cou¡
 = 
	`¡ohl
(
§c
->ref_count);

614 
s
->
∑ckë_cou¡
 = 
	`¡oh64
(
§c
->packet_count);

615 
s
->
byã_cou¡
 = 
	`¡oh64
(
§c
->byte_count);

616 
s
->
duøti⁄_£c
 = 
	`ht⁄l
(
§c
->duration_sec);

617 
s
->
duøti⁄_n£c
 = 
	`ht⁄l
(
§c
->duration_nsec);

619 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_buckë_cou¡îs
(
§c
->
buckë_°©s
, 
¶í
, &
s
->
cou¡îs_num
);

620 i‡(
îr‹
) {

621 
	`‰ì
(
s
);

622  
îr‹
;

624 
s
->
cou¡îs
 = (
oÊ_buckë_cou¡î
 **)
	`mÆloc
(s->
cou¡îs_num
 * (ofl_bucket_counter *));

626 
c
 = 
§c
->
buckë_°©s
;

627 
i
 = 0; i < 
s
->
cou¡îs_num
; i++) {

628 
îr‹
 = 
	`oÊ_°ru˘s_buckë_cou¡î_u≈ack
(
c
, &
¶í
, &(
s
->
cou¡îs
[
i
]));

629 i‡(
îr‹
) {

630 
	`OFL_UTILS_FREE_ARR
(
s
->
cou¡îs
, 
i
);

631 
	`‰ì
(
s
);

632  
îr‹
;

634 
c
 = (
oÂ_buckë_cou¡î
 *)((
uöt8_t
 *)c + (ofp_bucket_counter));

637 i‡(
¶í
 != 0) {

638 *
Àn
 = *À¿- 
	`¡ohs
(
§c
->
Àngth
Ë+ 
¶í
;

639 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Thêª˚ived grou∞°©†c⁄èöedÉxå®byã†(%zu).", 
¶í
);

640 
	`oÊ_°ru˘s_‰ì_group_°©s
(
s
);

641  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

644 *
Àn
 -
	`¡ohs
(
§c
->
Àngth
);

645 *
d°
 = 
s
;

647 
	}
}

649 
oÊ_îr


650 
	$oÊ_°ru˘s_mëî_b™d_°©s_u≈ack
(
oÂ_mëî_b™d_°©s
 *
§c
, 
size_t
 *
Àn
, 
oÊ_mëî_b™d_°©s
 **
d°
){

651 
oÊ_mëî_b™d_°©s
 *
p
;

653 i‡(*
Àn
 < (
oÂ_mëî_b™d_°©s
)) {

654 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived mëî b™d sèt†ha†övÆidÜígth (%zu).", *
Àn
);

655  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

657 *
Àn
 -(
oÂ_mëî_b™d_°©s
);

659 
p
 = (
oÊ_mëî_b™d_°©s
 *)
	`mÆloc
((ofl_meter_band_stats));

660 
p
->
∑ckë_b™d_cou¡
 = 
	`¡oh64
(
§c
->packet_band_count);

661 
p
->
byã_b™d_cou¡
 = 
	`¡oh64
(
§c
->byte_band_count);

663 *
d°
 = 
p
;

666 
	}
}

668 
oÊ_îr


669 
	$oÊ_°ru˘s_mëî_°©s_u≈ack
(
oÂ_mëî_°©s
 *
§c
, 
size_t
 *
Àn
, 
oÊ_mëî_°©s
 **
d°
) {

670 
oÊ_mëî_°©s
 *
s
;

671 
oÂ_mëî_b™d_°©s
 *
c
;

672 
oÊ_îr
 
îr‹
;

673 
size_t
 
¶í
;

674 
size_t
 
i
;

676 i‡(*
Àn
 < (
oÂ_mëî_°©s
)) {

677 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived mëî sèt†ª∂y i†toÿsh‹à(%zu).", *
Àn
);

678  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

681 i‡(*
Àn
 < 
	`¡ohs
(
§c
->len)) {

682 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived mëî sèt†ª∂y ha†övÆidÜígth (£àtÿ%u, buà⁄ly %zuÑe˚ived).", 
	`¡ohs
(
§c
->
Àn
), *len);

683  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

686 
¶í
 = 
	`¡ohs
(
§c
->
Àn
Ë- (
oÂ_mëî_°©s
);

688 
s
 = (
oÊ_mëî_°©s
 *Ë
	`mÆloc
((ofl_meter_stats));

689 
s
->
mëî_id
 = 
	`¡ohl
(
§c
->meter_id);

690 
s
->
Àn
 = 
	`¡ohs
(
§c
->len);

692 
s
->
Êow_cou¡
 = 
	`¡ohl
(
§c
->flow_count);

693 
s
->
∑ckë_ö_cou¡
 = 
	`¡oh64
(
§c
->packet_in_count);

694 
s
->
byã_ö_cou¡
 = 
	`¡oh64
(
§c
->byte_in_count);

695 
s
->
duøti⁄_£c
 = 
	`ht⁄l
(
§c
->duration_sec);

696 
s
->
duøti⁄_n£c
 = 
	`ht⁄l
(
§c
->duration_nsec);

698 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_mëî_b™d_°©s
(
§c
->
b™d_°©s
, 
¶í
, &
s
->
mëî_b™ds_num
);

699 i‡(
îr‹
) {

700 
	`‰ì
(
s
);

701  
îr‹
;

703 
s
->
b™d_°©s
 = (
oÊ_mëî_b™d_°©s
 **)
	`mÆloc
(s->
mëî_b™ds_num
 * (ofl_meter_band_stats *));

705 
c
 = 
§c
->
b™d_°©s
;

706 
i
 = 0; i < 
s
->
mëî_b™ds_num
; i++) {

707 
îr‹
 = 
	`oÊ_°ru˘s_mëî_b™d_°©s_u≈ack
(
c
, &
¶í
, &(
s
->
b™d_°©s
[
i
]));

708 i‡(
îr‹
) {

709 
	`OFL_UTILS_FREE_ARR
(
s
->
b™d_°©s
, 
i
);

710 
	`‰ì
(
s
);

711  
îr‹
;

713 
c
 = (
oÂ_mëî_b™d_°©s
 *)((
uöt8_t
 *)c + (ofp_meter_band_stats));

716 i‡(
¶í
 != 0) {

717 *
Àn
 = *À¿- 
	`¡ohs
(
§c
->ÀnË+ 
¶í
;

718 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Thêª˚ived mëî sèt†c⁄èöedÉxå®byã†(%zu).", 
¶í
);

719 
	`oÊ_°ru˘s_‰ì_mëî_°©s
(
s
);

720  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

722 *
Àn
 -
	`¡ohs
(
§c
->len);

723 *
d°
 = 
s
;

725 
	}
}

727 
oÊ_îr


728 
	$oÊ_°ru˘s_mëî_c⁄fig_u≈ack
(
oÂ_mëî_c⁄fig
 *
§c
, 
size_t
 *
Àn
, 
oÊ_mëî_c⁄fig
 **
d°
) {

729 
oÊ_mëî_c⁄fig
 *
s
;

730 
oÂ_mëî_b™d_hódî
 *
b
;

731 
oÊ_îr
 
îr‹
;

732 
size_t
 
¶í
;

733 
size_t
 
i
;

735 i‡(*
Àn
 < (
oÂ_mëî_c⁄fig
)) {

736 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived mëî c⁄figÑïly i†toÿsh‹à(%zu).", *
Àn
);

737  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

740 i‡(*
Àn
 < 
	`¡ohs
(
§c
->
Àngth
)) {

741 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived mëî c⁄figÑïly ha†övÆidÜígth (£àtÿ%u, buà⁄ly %zuÑe˚ived).", 
	`¡ohs
(
§c
->
Àngth
), *
Àn
);

742  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

745 
¶í
 = 
	`¡ohs
(
§c
->
Àngth
Ë- (
oÂ_mëî_c⁄fig
);

747 
s
 = (
oÊ_mëî_c⁄fig
 *Ë
	`mÆloc
((ofl_meter_config));

748 
s
->
mëî_id
 = 
	`¡ohl
(
§c
->meter_id);

749 
s
->
Àngth
 = 
	`¡ohs
(
§c
->length);

751 
s
->
Êags
 = 
	`¡ohs
(
§c
->flags);

753 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_mëî_b™ds
(
§c
->
b™ds
, 
¶í
, &
s
->
mëî_b™ds_num
);

754 i‡(
îr‹
) {

755 
	`‰ì
(
s
);

756  
îr‹
;

758 
s
->
b™ds
 = (
oÊ_mëî_b™d_hódî
 **)
	`mÆloc
(s->
mëî_b™ds_num
 * (ofl_meter_band_header *));

760 
b

§c
->
b™ds
;

761 
i
 = 0; i < 
s
->
mëî_b™ds_num
; i++) {

762 
îr‹
 = 
	`oÊ_°ru˘s_mëî_b™d_u≈ack
(
b
, &
¶í
, &(
s
->
b™ds
[
i
]));

763 i‡(
îr‹
) {

764 
	`OFL_UTILS_FREE_ARR
(
s
->
b™ds
, 
i
);

765 
	`‰ì
(
s
);

766  
îr‹
;

768 
b
 = (
oÂ_mëî_b™d_hódî
 *)((
uöt8_t
 *)b + 
	`¡ohs
(b->
Àn
));

771 i‡(
¶í
 != 0) {

772 *
Àn
 = *À¿- 
	`¡ohs
(
§c
->
Àngth
Ë+ 
¶í
;

773 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Thêª˚ived mëî c⁄fig c⁄èöedÉxå®byã†(%zu).", 
¶í
);

775  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

777 *
Àn
 -
	`¡ohs
(
§c
->
Àngth
);

778 *
d°
 = 
s
;

780 
	}
}

782 
oÊ_îr


783 
	$oÊ_°ru˘s_queue_¥›_u≈ack
(
oÂ_queue_¥›_hódî
 *
§c
, 
size_t
 *
Àn
, 
oÊ_queue_¥›_hódî
 **
d°
) {

785 i‡(*
Àn
 < (
oÂ_a˘i⁄_hódî
)) {

786 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived queuê¥›îty i†toÿsh‹à(%zu).", *
Àn
);

787  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

790 i‡(*
Àn
 < 
	`¡ohs
(
§c
->len)) {

791 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived queuê¥›îty ha†övÆidÜígth (£àtÿ%u, buà⁄ly %zuÑe˚ived).", 
	`¡ohs
(
§c
->
Àn
), *len);

792  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

795 
	`¡ohs
(
§c
->
¥›îty
)) {

796 
OFPQT_MIN_RATE
: {

797 
oÂ_queue_¥›_mö_øã
 *
•
 = (oÂ_queue_¥›_mö_øã *)
§c
;

798 
oÊ_queue_¥›_mö_øã
 *
dp
 = (oÊ_queue_¥›_mö_øã *)
	`mÆloc
((ofl_queue_prop_min_rate));

800 i‡(*
Àn
 < (
oÂ_queue_¥›_mö_øã
)) {

801 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived MIN_RATE queuê¥›îty ha†övÆidÜígth (%zu).", *
Àn
);

802  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBRC_BAD_LEN
);

804 *
Àn
 -(
oÂ_queue_¥›_mö_øã
);

806 
dp
->
øã
 = 
	`¡ohs
(
•
->rate);

808 *
d°
 = (
oÊ_queue_¥›_hódî
 *)
dp
;

811 
OFPQT_MAX_RATE
:{

812 
oÂ_queue_¥›_max_øã
 *
•
 = (oÂ_queue_¥›_max_øã *)
§c
;

813 
oÊ_queue_¥›_max_øã
 *
dp
 = (oÊ_queue_¥›_max_øã *)
	`mÆloc
((ofl_queue_prop_max_rate));

815 i‡(*
Àn
 < (
oÂ_queue_¥›_max_øã
)) {

816 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived MAX_RATE queuê¥›îty ha†övÆidÜígth (%zu).", *
Àn
);

817  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBRC_BAD_LEN
);

819 *
Àn
 -(
oÂ_queue_¥›_max_øã
);

820 
dp
->
øã
 = 
	`¡ohs
(
•
->rate);

822 *
d°
 = (
oÊ_queue_¥›_hódî
 *)
dp
;

826 
OFPQT_EXPERIMENTER
:{

827 
oÂ_queue_¥›_ex≥rimíãr
 *
•
 = (oÂ_queue_¥›_ex≥rimíã∏*)
§c
;

828 
oÊ_queue_¥›_ex≥rimíãr
 *
dp
 = (oÊ_queue_¥›_ex≥rimíã∏*)
	`mÆloc
((ofl_queue_prop_experimenter));

830 i‡(*
Àn
 < (
oÂ_queue_¥›_ex≥rimíãr
)) {

831 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived EXPERIMENTER queuê¥›îty ha†övÆidÜígth (%zu).", *
Àn
);

832  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBRC_BAD_LEN
);

834 *
Àn
 -(
oÂ_queue_¥›_ex≥rimíãr
);

835 
dp
->
d©a
 = 
•
->data;

837 *
d°
 = (
oÊ_queue_¥›_hódî
 *)
dp
;

842 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received unknown queueÖropÅype.");

843  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBRC_BAD_LEN
);

847 (*
d°
)->
ty≥
 = (
oÂ_queue_¥›îtõs
)
	`¡ohs
(
§c
->
¥›îty
);

849 
	}
}

852 
oÊ_îr


853 
	$oÊ_°ru˘s_∑ckë_queue_u≈ack
(
oÂ_∑ckë_queue
 *
§c
, 
size_t
 *
Àn
, 
oÊ_∑ckë_queue
 **
d°
) {

854 
oÊ_∑ckë_queue
 *
q
;

855 
oÂ_queue_¥›_hódî
 *
¥›
;

856 
oÊ_îr
 
îr‹
;

857 
size_t
 
i
;

859 i‡(*
Àn
 < 
	`¡ohs
(
§c
->len)) {

860 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ivedÖackë queuêha†övÆidÜígth (%zu).", *
Àn
);

861  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBRC_BAD_LEN
);

863 *
Àn
 -(
oÂ_∑ckë_queue
);

865 
q
 = (
oÊ_∑ckë_queue
 *)
	`mÆloc
((ofl_packet_queue));

866 
q
->
queue_id
 = 
	`¡ohl
(
§c
->queue_id);

868 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_queue_¥›s
((
uöt8_t
 *)
§c
->
¥›îtõs
, *
Àn
, &
q
->
¥›îtõs_num
);

869 i‡(
îr‹
) {

870 
	`‰ì
(
q
);

871  
îr‹
;

873 
q
->
¥›îtõs
 = (
oÊ_queue_¥›_hódî
 **)
	`mÆloc
(q->
¥›îtõs_num
 * (ofl_queue_prop_header *));

875 
¥›
 = 
§c
->
¥›îtõs
;

876 
i
 = 0; i < 
q
->
¥›îtõs_num
; i++) {

877 
	`oÊ_°ru˘s_queue_¥›_u≈ack
(
¥›
, 
Àn
, &(
q
->
¥›îtõs
[
i
]));

878 
¥›
 = (
oÂ_queue_¥›_hódî
 *)((
uöt8_t
 *Ìr› + 
	`¡ohs
’r›->
Àn
));

881 *
d°
 = 
q
;

883 
	}
}

886 
oÊ_îr


887 
	$oÊ_°ru˘s_p‹t_u≈ack
(
oÂ_p‹t
 *
§c
, 
size_t
 *
Àn
, 
oÊ_p‹t
 **
d°
) {

888 
oÊ_p‹t
 *
p
;

890 i‡(*
Àn
 < (
oÂ_p‹t
)) {

891 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ivedÖ‹àha†övÆidÜígth (%zu).", *
Àn
);

892  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBRC_BAD_LEN
);

895 i‡(
	`¡ohl
(
§c
->
p‹t_no
) == 0 ||

896 (
	`¡ohl
(
§c
->
p‹t_no
Ë> 
OFPP_MAX
 &&Çtohl(§c->p‹t_noË!
OFPP_LOCAL
)) {

897 i‡(
	`OFL_LOG_IS_WARN_ENABLED
(
LOG_MODULE
)) {

898 *
ps
 = 
	`oÊ_p‹t_to_°rög
(
	`¡ohl
(
§c
->
p‹t_no
));

899 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ivedÖ‹àha†övÆidÖ‹t_id (%s).", 
ps
);

900 
	`‰ì
(
ps
);

902  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBRC_BAD_LEN
);

904 *
Àn
 -(
oÂ_p‹t
);

905 
p
 = (
oÊ_p‹t
 *)
	`mÆloc
((ofl_port));

907 
p
->
p‹t_no
 = 
	`¡ohl
(
§c
->port_no);

908 
	`mem˝y
(
p
->
hw_addr
, 
§c
->hw_addr, 
ETH_ADDR_LEN
);

909 
p
->
«me
 = 
	`°r˝y
((*)
	`mÆloc
(
	`°æí
(
§c
->name) + 1), src->name);

910 
p
->
c⁄fig
 = 
	`¡ohl
(
§c
->config);

911 
p
->
°©e
 = 
	`¡ohl
(
§c
->state);

912 
p
->
cuº
 = 
	`¡ohl
(
§c
->curr);

913 
p
->
advîti£d
 = 
	`¡ohl
(
§c
->advertised);

914 
p
->
suµ‹ãd
 = 
	`¡ohl
(
§c
->supported);

915 
p
->
≥î
 = 
	`¡ohl
(
§c
->peer);

916 
p
->
cuº_•ìd
 = 
	`¡ohl
(
§c
->curr_speed);

917 
p
->
max_•ìd
 = 
	`¡ohl
(
§c
->max_speed);

919 *
d°
 = 
p
;

921 
	}
}

925 
oÊ_îr


926 
	$oÊ_°ru˘s_èbÀ_°©s_u≈ack
(
oÂ_èbÀ_°©s
 *
§c
, 
size_t
 *
Àn
, 
oÊ_èbÀ_°©s
 **
d°
) {

927 
oÊ_èbÀ_°©s
 *
p
;

929 i‡(*
Àn
 < (
oÂ_èbÀ_°©s
)) {

930 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ivedÅabÀ sèt†ha†övÆidÜígth (%zu).", *
Àn
);

931  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBRC_BAD_LEN
);

934 i‡(
§c
->
èbÀ_id
 == 0xff) {

935 i‡(
	`OFL_LOG_IS_WARN_ENABLED
(
LOG_MODULE
)) {

936 *
ts
 = 
	`oÊ_èbÀ_to_°rög
(
§c
->
èbÀ_id
);

937 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ivedÅabÀ sèt†ha†övÆidÅabÀ_id (%s).", 
ts
);

938 
	`‰ì
(
ts
);

940  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBRC_BAD_LEN
);

942 *
Àn
 -(
oÂ_èbÀ_°©s
);

944 
p
 = (
oÊ_èbÀ_°©s
 *)
	`mÆloc
((ofl_table_stats));

945 
p
->
èbÀ_id
 = 
§c
->table_id;

946 
p
->
a˘ive_cou¡
 = 
	`¡ohl
(
§c
->active_count);

947 
p
->
lookup_cou¡
 = 
	`¡oh64
(
§c
->lookup_count);

948 
p
->
m©ched_cou¡
 = 
	`¡oh64
(
§c
->matched_count);

950 *
d°
 = 
p
;

952 
	}
}

954 
oÊ_îr


955 
	$oÊ_°ru˘s_p‹t_°©s_u≈ack
(
oÂ_p‹t_°©s
 *
§c
, 
size_t
 *
Àn
, 
oÊ_p‹t_°©s
 **
d°
) {

956 
oÊ_p‹t_°©s
 *
p
;

958 i‡(*
Àn
 < (
oÂ_p‹t_°©s
)) {

959 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ivedÖ‹à°©†ha†övÆidÜígth (%zu).", *
Àn
);

960  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBRC_BAD_LEN
);

962 i‡(
	`¡ohl
(
§c
->
p‹t_no
) == 0 ||

963 (
	`¡ohl
(
§c
->
p‹t_no
Ë> 
OFPP_MAX
 &&Çtohl(§c->p‹t_noË!
OFPP_LOCAL
)) {

964 i‡(
	`OFL_LOG_IS_WARN_ENABLED
(
LOG_MODULE
)) {

965 *
ps
 = 
	`oÊ_p‹t_to_°rög
(
	`¡ohl
(
§c
->
p‹t_no
));

966 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ivedÖ‹à°©†ha†övÆidÖ‹t_id (%s).", 
ps
);

967 
	`‰ì
(
ps
);

969  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBRC_BAD_LEN
);

971 *
Àn
 -(
oÂ_p‹t_°©s
);

973 
p
 = (
oÊ_p‹t_°©s
 *)
	`mÆloc
((ofl_port_stats));

975 
p
->
p‹t_no
 = 
	`¡ohl
(
§c
->port_no);

976 
p
->
rx_∑ckës
 = 
	`¡oh64
(
§c
->rx_packets);

977 
p
->
tx_∑ckës
 = 
	`¡oh64
(
§c
->tx_packets);

978 
p
->
rx_byãs
 = 
	`¡oh64
(
§c
->rx_bytes);

979 
p
->
tx_byãs
 = 
	`¡oh64
(
§c
->tx_bytes);

980 
p
->
rx_dr›≥d
 = 
	`¡oh64
(
§c
->rx_dropped);

981 
p
->
tx_dr›≥d
 = 
	`¡oh64
(
§c
->tx_dropped);

982 
p
->
rx_îr‹s
 = 
	`¡oh64
(
§c
->rx_errors);

983 
p
->
tx_îr‹s
 = 
	`¡oh64
(
§c
->tx_errors);

984 
p
->
rx_‰ame_îr
 = 
	`¡oh64
(
§c
->rx_frame_err);

985 
p
->
rx_ovî_îr
 = 
	`¡oh64
(
§c
->rx_over_err);

986 
p
->
rx_¸c_îr
 = 
	`¡oh64
(
§c
->rx_crc_err);

987 
p
->
cﬁlisi⁄s
 = 
	`¡oh64
(
§c
->collisions);

988 
p
->
duøti⁄_£c
 = 
	`¡ohl
(
§c
->duration_sec);

989 
p
->
duøti⁄_n£c
 = 
	`¡ohl
(
§c
->duration_nsec);

990 *
d°
 = 
p
;

992 
	}
}

994 
oÊ_îr


995 
	$oÊ_°ru˘s_queue_°©s_u≈ack
(
oÂ_queue_°©s
 *
§c
, 
size_t
 *
Àn
, 
oÊ_queue_°©s
 **
d°
) {

996 
oÊ_queue_°©s
 *
p
;

998 i‡(*
Àn
 < (
oÂ_queue_°©s
)) {

999 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived queuê°©†ha†övÆidÜígth (%zu).", *
Àn
);

1000  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

1003 i‡(
	`¡ohl
(
§c
->
p‹t_no
Ë=0 ||Çtohl(§c->p‹t_noË> 
OFPP_MAX
) {

1004 i‡(
	`OFL_LOG_IS_WARN_ENABLED
(
LOG_MODULE
)) {

1005 *
ps
 = 
	`oÊ_p‹t_to_°rög
(
	`¡ohl
(
§c
->
p‹t_no
));

1006 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived queuê°©†ha†övÆidÖ‹t_id (%s).", 
ps
);

1007 
	`‰ì
(
ps
);

1009  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBRC_BAD_LEN
);

1011 *
Àn
 -(
oÂ_queue_°©s
);

1013 
p
 = (
oÊ_queue_°©s
 *)
	`mÆloc
((ofl_queue_stats));

1015 
p
->
p‹t_no
 = 
	`¡ohl
(
§c
->port_no);

1016 
p
->
queue_id
 = 
	`¡ohl
(
§c
->queue_id);

1017 
p
->
tx_byãs
 = 
	`¡oh64
(
§c
->tx_bytes);

1018 
p
->
tx_∑ckës
 = 
	`¡oh64
(
§c
->tx_packets);

1019 
p
->
tx_îr‹s
 = 
	`¡oh64
(
§c
->tx_errors);

1020 
p
->
duøti⁄_£c
 = 
	`¡ohl
(
§c
->duration_sec);

1021 
p
->
duøti⁄_n£c
 = 
	`¡ohl
(
§c
->duration_nsec);

1022 *
d°
 = 
p
;

1024 
	}
}

1026 
oÊ_îr


1027 
	$oÊ_°ru˘s_group_desc_°©s_u≈ack
(
oÂ_group_desc_°©s
 *
§c
, 
size_t
 *
Àn
, 
oÊ_group_desc_°©s
 **
d°
, 
oÊ_exp
 *
exp
) {

1028 
oÊ_group_desc_°©s
 *
dm
;

1029 
oÂ_buckë
 *
buckë
;

1030 
oÊ_îr
 
îr‹
;

1031 
size_t
 
dÀn
;

1032 
size_t
 
i
;

1034 i‡(*
Àn
 < (
oÂ_group_desc_°©s
)) {

1035 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived grou∞des¯°©†ª∂y i†toÿsh‹à(%zu).", *
Àn
);

1036  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

1039 i‡(*
Àn
 < 
	`¡ohs
(
§c
->
Àngth
)) {

1040 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived grou∞des¯°©†ª∂y ha†övÆidÜígth (£àtÿ%u, buà⁄ly %zuÑe˚ived).", 
	`¡ohs
(
§c
->
Àngth
), *
Àn
);

1041  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

1044 i‡(
	`¡ohl
(
§c
->
group_id
Ë> 
OFPG_MAX
) {

1045 i‡(
	`OFL_LOG_IS_WARN_ENABLED
(
LOG_MODULE
)) {

1046 *
gs
 = 
	`oÊ_group_to_°rög
(
	`¡ohl
(
§c
->
group_id
));

1047 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived grou∞des¯°©†ha†övÆid group_id (%s).", 
gs
);

1048 
	`‰ì
(
gs
);

1050  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

1052 
dÀn
 = 
	`¡ohs
(
§c
->
Àngth
Ë- (
oÂ_group_desc_°©s
);

1054 
dm
 = (
oÊ_group_desc_°©s
 *)
	`mÆloc
((ofl_group_desc_stats));

1056 
dm
->
ty≥
 = 
§c
->type;

1057 
dm
->
group_id
 = 
	`¡ohl
(
§c
->group_id);

1059 
îr‹
 = 
	`oÊ_utûs_cou¡_oÂ_buckës
(
§c
->
buckës
, 
dÀn
, &
dm
->
buckës_num
);

1060 i‡(
îr‹
) {

1061 
	`‰ì
(
dm
);

1062  
îr‹
;

1064 
dm
->
buckës
 = (
oÊ_buckë
 **)
	`mÆloc
(dm->
buckës_num
 * (ofl_bucket *));

1066 
buckë
 = 
§c
->
buckës
;

1067 
i
 = 0; i < 
dm
->
buckës_num
; i++) {

1068 
îr‹
 = 
	`oÊ_°ru˘s_buckë_u≈ack
(
buckë
, &
dÀn
, 
dm
->
ty≥
, &(dm->
buckës
[
i
]), 
exp
);

1069 i‡(
îr‹
) {

1070 
	`OFL_UTILS_FREE_ARR_FUN2
(
dm
->
buckës
, 
i
,

1071 
oÊ_°ru˘s_‰ì_buckë
, 
exp
);

1072 
	`‰ì
 (
dm
);

1073  
îr‹
;

1075 
buckë
 = (
oÂ_buckë
 *)((
uöt8_t
 *)buckë + 
	`¡ohs
(buckë->
Àn
));

1078 i‡(
dÀn
 != 0) {

1079 *
Àn
 = *À¿- 
	`¡ohs
(
§c
->
Àngth
Ë+ 
dÀn
;

1080 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Thêª˚ived grou∞des¯°©†c⁄èöedÉxå®byã†(%zu).", 
dÀn
);

1081 
	`oÊ_°ru˘s_‰ì_group_desc_°©s
(
dm
, 
exp
);

1082  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

1085 *
Àn
 -
	`¡ohs
(
§c
->
Àngth
);

1086 *
d°
 = 
dm
;

1088 
	}
}

1090 
oÊ_îr


1091 
	$oÊ_°ru˘s_buckë_cou¡î_u≈ack
(
oÂ_buckë_cou¡î
 *
§c
, 
size_t
 *
Àn
, 
oÊ_buckë_cou¡î
 **
d°
) {

1092 
oÊ_buckë_cou¡î
 *
p
;

1094 i‡(*
Àn
 < (
oÂ_buckë_cou¡î
)) {

1095 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived buckë cou¡î ha†övÆidÜígth (%zu).", *
Àn
);

1096  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

1098 *
Àn
 -(
oÂ_buckë_cou¡î
);

1100 
p
 = (
oÊ_buckë_cou¡î
 *)
	`mÆloc
((ofl_bucket_counter));

1101 
p
->
∑ckë_cou¡
 = 
	`¡oh64
(
§c
->packet_count);

1102 
p
->
byã_cou¡
 = 
	`¡oh64
(
§c
->byte_count);

1104 *
d°
 = 
p
;

1106 
	}
}

1108 
oÊ_îr


1109 
	$oÊ_°ru˘s_mëî_b™d_u≈ack
(
oÂ_mëî_b™d_hódî
 *
§c
, 
size_t
 *
Àn
, 
oÊ_mëî_b™d_hódî
 **
d°
){

1110 
oÊ_mëî_b™d_hódî
 *
mb
;

1112 if(*
Àn
 < (
oÂ_mëî_b™d_hódî
)){

1113 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived mëî b™d i†toÿsh‹à(%zu).", *
Àn
);

1114  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_LEN
);

1116 
	`¡ohs
(
§c
->
ty≥
)){

1117 
OFPMBT_DROP
:{

1118 
oÊ_mëî_b™d_dr›
 *
b
 = (oÊ_mëî_b™d_dr› *)
	`mÆloc
((ofl_meter_band_drop));

1119 
b
->
ty≥
 = 
	`¡ohs
(
§c
->type);

1120 
b
->
øã
 = 
	`¡ohl
(
§c
->rate);

1121 
b
->
bur°_size
 = 
	`¡ohl
(
§c
->burst_size);

1122 
mb
 = (
oÊ_mëî_b™d_hódî
 *)
b
;

1123 *
d°
 = 
mb
;

1126 
OFPMBT_DSCP_REMARK
:{

1127 
oÊ_mëî_b™d_ds˝_ªm¨k
 *
b
 = (oÊ_mëî_b™d_ds˝_ªm¨k *)
	`mÆloc
((ofl_meter_band_dscp_remark));

1128 
oÂ_mëî_b™d_ds˝_ªm¨k
 *
s
 = (oÂ_mëî_b™d_ds˝_ªm¨k*)
§c
;

1129 
b
->
ty≥
 = 
	`¡ohs
(
s
->type);

1130 
b
->
øã
 = 
	`¡ohl
(
s
->rate);

1131 
b
->
bur°_size
 = 
	`¡ohl
(
s
->burst_size);

1132 
b
->
¥ec_Àvñ
 = 
s
->prec_level;

1133 
mb
 = (
oÊ_mëî_b™d_hódî
 *)
b
;

1134 *
d°
 = 
mb
;

1137 
OFPMBT_EXPERIMENTER
:{

1138 
oÊ_mëî_b™d_ex≥rimíãr
 *
b
 = (oÊ_mëî_b™d_ex≥rimíã∏*)
	`mÆloc
((ofl_meter_band_experimenter));

1139 
oÂ_mëî_b™d_ex≥rimíãr
 *
s
 = (oÂ_mëî_b™d_ex≥rimíãr*Ë
§c
;

1140 
b
->
ty≥
 = 
	`¡ohs
(
s
->type);

1141 
b
->
øã
 = 
	`¡ohl
(
s
->rate);

1142 
b
->
bur°_size
 = 
	`¡ohl
(
s
->burst_size);

1143 
b
->
ex≥rimíãr
 = 
	`¡ohl
(
s
->experimenter);

1144 
mb
 = (
oÊ_mëî_b™d_hódî
 *)
b
;

1145 *
d°
 = 
mb
;

1149 *
Àn
 -
	`¡ohs
(
§c
->len);

1151 
	}
}

1155 
oÊ_îr


1156 
	$oÊ_°ru˘s_oxm_m©ch_u≈ack
(
oÂ_m©ch
* 
§c
, 
uöt8_t
* 
buf
, 
size_t
 *
Àn
, 
oÊ_m©ch
 **
d°
){

1158 
îr‹
 = 0;

1159 
oÂbuf
 *
b
 = 
	`oÂbuf_√w
(0);

1160 
oÊ_m©ch
 *
m
 = (oÊ_m©ch *Ë
	`mÆloc
((ofl_match));

1161 *
Àn
 -
	`ROUND_UP
(
	`¡ohs
(
§c
->
Àngth
),8);

1162 if(
	`¡ohs
(
§c
->
Àngth
Ë> (
oÂ_m©ch
)){

1163 
	`oÂbuf_put
(
b
, 
buf
, 
	`¡ohs
(
§c
->
Àngth
Ë- ((
oÂ_m©ch
) -4));

1164 
îr‹
 = 
	`oxm_puŒ_m©ch
(
b
, 
m
, 
	`¡ohs
(
§c
->
Àngth
Ë- ((
oÂ_m©ch
) -4));

1165 
m
->
hódî
.
Àngth
 = 
	`¡ohs
(
§c
->length) - 4;

1168 
m
->
hódî
.
Àngth
 = 0;

1169 
m
->
hódî
.
ty≥
 = 
	`¡ohs
(
§c
->type);

1170 
m
->
m©ch_fõlds
 = (
hm≠
Ë
	`HMAP_INITIALIZER
(&m->match_fields);

1172 
	`oÂbuf_dñëe
(
b
);

1173 *
d°
 = 
m
;

1174  
îr‹
;

1175 
	}
}

1177 
oÊ_îr


1178 
	$oÊ_°ru˘s_m©ch_u≈ack
(
oÂ_m©ch
 *
§c
,
uöt8_t
 * 
buf
, 
size_t
 *
Àn
, 
oÊ_m©ch_hódî
 **
d°
, 
oÊ_exp
 *
exp
) {

1180 
	`¡ohs
(
§c
->
ty≥
)) {

1181 (
OFPMT_OXM
): {

1182  
	`oÊ_°ru˘s_oxm_m©ch_u≈ack
(
§c
, 
buf
, 
Àn
, (
oÊ_m©ch
**Ë
d°
 );

1185 i‡(
exp
 =
NULL
 ||Éxp->
m©ch
 =NULL ||Éxp->m©ch->
u≈ack
 == NULL) {

1186 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received match isÉxperimental, butÇo callback was given.");

1187  
	`oÊ_îr‹
(
OFPET_BAD_MATCH
, 
OFPBMC_BAD_TYPE
);

1189  
exp
->
m©ch
->
	`u≈ack
(
§c
, 
Àn
, 
d°
);

1192 
	}
}

	@oflib/ofl-structs.c

32 
	~<°dlib.h
>

33 
	~<°rög.h
>

34 
	~<√töë/ö.h
>

35 
	~"oÊ.h
"

36 
	~"oÊ-°ru˘s.h
"

37 
	~"oÊ-a˘i⁄s.h
"

38 
	~"oÊ-utûs.h
"

39 
	~"oÊ-log.h
"

40 
	~"hm≠.h
"

41 
	~"›íÊow/›íÊow.h
"

43 
	#UNUSED
 
	`__©åibuã__
((
__unu£d__
))

	)

45 
	#LOG_MODULE
 
oÊ_°r


	)

46 
	$OFL_LOG_INIT
(
LOG_MODULE
)

48 
oÊ_îr


49 
	$oÊ_utûs_cou¡_oÂ_èbÀ_„©uªs_¥›îtõs
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
){

51 
oÂ_èbÀ_„©uª_¥›_hódî
 *
¥›
;

52 
uöt8_t
 *
d
;

54 
d
 = (
uöt8_t
*Ë
d©a
;

55 *
cou¡
 = 0;

56 
d©a_Àn
 >(
oÂ_èbÀ_„©uª_¥›_hódî
)){

57 
¥›
 = (
oÂ_èbÀ_„©uª_¥›_hódî
 *Ë
d
;

58 i‡(
d©a_Àn
 < 
	`¡ohs
(
¥›
->
Àngth
Ë||Çtohs’r›->ÀngthË< (
oÂ_èbÀ_„©uª_¥›_hódî
) ){

59 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ivedÖr›îty ha†övÆidÜígth (¥›->Àngth=%d, d©a_Àn=%d).", 
	`¡ohs
(
¥›
->
Àngth
), (Ë
d©a_Àn
);

60  
	`oÊ_îr‹
(
OFPET_TABLE_FEATURES_FAILED
, 
OFPTFFC_BAD_LEN
);

62 
d©a_Àn
 -
	`ROUND_UP
(
	`¡ohs
(
¥›
->
Àngth
), 8);

63 
d
 +
	`ROUND_UP
(
	`¡ohs
(
¥›
->
Àngth
), 8);

64 (*
cou¡
)++;

67 
	}
}

69 
oÊ_îr


70 
	$oÊ_utûs_cou¡_oÂ_èbÀ_„©uªs
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
){

71 
oÂ_èbÀ_„©uªs
 *
„©uª
;

72 
uöt8_t
 *
d
;

74 
d
 = (
uöt8_t
*Ë
d©a
;

75 *
cou¡
 = 0;

76 
d©a_Àn
 >(
oÂ_èbÀ_„©uªs
)){

77 
„©uª
 = (
oÂ_èbÀ_„©uªs
 *Ë
d
;

78 i‡(
d©a_Àn
 < 
	`¡ohs
(
„©uª
->
Àngth
Ë||Çtohs(„©uª->ÀngthË< (
oÂ_èbÀ_„©uªs
) ){

79 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Re˚ived fótuª ha†övÆidÜígth („©->Àngth=%d, d©a_Àn=%d).", 
	`¡ohs
(
„©uª
->
Àngth
), (Ë
d©a_Àn
);

80  
	`oÊ_îr‹
(
OFPET_TABLE_FEATURES_FAILED
, 
OFPTFFC_BAD_LEN
);

82 
d©a_Àn
 -
	`¡ohs
(
„©uª
->
Àngth
);

83 
d
 +
	`¡ohs
(
„©uª
->
Àngth
);

84 (*
cou¡
)++;

87 
	}
}

91 
oÊ_îr


92 
	$oÊ_utûs_cou¡_oÂ_ö°ru˘i⁄s
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
) {

93 
oÂ_ö°ru˘i⁄
 *
ö°
;

94 
uöt8_t
 *
d
;

96 
d
 = (
uöt8_t
 *)
d©a
;

97 *
cou¡
 = 0;

99 
d©a_Àn
 >(
oÂ_ö°ru˘i⁄
)- 4) {

100 
ö°
 = (
oÂ_ö°ru˘i⁄
 *)
d
;

101 i‡(
d©a_Àn
 < 
	`¡ohs
(
ö°
->
Àn
Ë||Çtohs(ö°->ÀnË< (
oÂ_ö°ru˘i⁄
) - 4) {

102 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received instruction has invalidÜength.");

103  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

106 
d©a_Àn
 -
	`¡ohs
(
ö°
->
Àn
);

107 
d
 +
	`¡ohs
(
ö°
->
Àn
);

108 (*
cou¡
)++;

113 
	}
}

116 
oÊ_îr


117 
	$oÊ_utûs_cou¡_oÂ_buckës
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
) {

118 
oÂ_buckë
 *
buckë
;

119 
uöt8_t
 *
d
;

121 
d
 = (
uöt8_t
 *)
d©a
;

122 *
cou¡
 = 0;

124 
d©a_Àn
 >(
oÂ_buckë
)) {

125 
buckë
 = (
oÂ_buckë
 *)
d
;

127 i‡(
d©a_Àn
 < 
	`¡ohs
(
buckë
->
Àn
Ë||Çtohs(buckë->ÀnË< (
oÂ_buckë
)) {

128 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received bucket has invalidÜength.");

129  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

131 
d©a_Àn
 -
	`¡ohs
(
buckë
->
Àn
);

132 
d
 +
	`¡ohs
(
buckë
->
Àn
);

133 (*
cou¡
)++;

137 
	}
}

140 
oÊ_îr


141 
	$oÊ_utûs_cou¡_oÂ_mëî_b™ds
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
) {

142 
oÂ_mëî_b™d_hódî
 *
mb
;

143 
uöt8_t
 *
d
;

145 
d
 = (
uöt8_t
 *)
d©a
;

146 *
cou¡
 = 0;

148 
d©a_Àn
 >(
oÂ_mëî_b™d_hódî
)) {

149 
mb
 = (
oÂ_mëî_b™d_hódî
 *)
d
;

151 i‡(
d©a_Àn
 < 
	`¡ohs
(
mb
->
Àn
Ë||Çtohs(mb->ÀnË< (
oÂ_mëî_b™d_hódî
)) {

152 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received meter band has invalidÜength.");

153  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

155 
d©a_Àn
 -
	`¡ohs
(
mb
->
Àn
);

156 
d
 +
	`¡ohs
(
mb
->
Àn
);

157 (*
cou¡
)++;

161 
	}
}

163 
oÊ_îr


164 
	$oÊ_utûs_cou¡_oÂ_p‹ts
(*
d©a
 
UNUSED
, 
size_t
 
d©a_Àn
, size_à*
cou¡
) {

165 *
cou¡
 = 
d©a_Àn
 / (
oÂ_p‹t
);

167 
	}
}

170 
oÊ_îr


171 
	$oÊ_utûs_cou¡_oÂ_∑ckë_queues
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
) {

172 
oÂ_∑ckë_queue
 *
queue
;

173 
uöt8_t
 *
d
;

175 
d
 = (
uöt8_t
 *)
d©a
;

176 *
cou¡
 = 0;

178 
d©a_Àn
 >(
oÂ_∑ckë_queue
)) {

179 
queue
 = (
oÂ_∑ckë_queue
 *)
d
;

181 i‡(
d©a_Àn
 < 
	`¡ohs
(
queue
->
Àn
Ë||Çtohs(queue->ÀnË< (
oÂ_∑ckë_queue
)) {

182 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received queue has invalidÜength.");

183  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

185 
d©a_Àn
 -
	`¡ohs
(
queue
->
Àn
);

186 
d
 +
	`¡ohs
(
queue
->
Àn
);

187 (*
cou¡
)++;

192 
	}
}

194 
oÊ_îr


195 
	$oÊ_utûs_cou¡_oÂ_Êow_°©s
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
) {

196 
oÂ_Êow_°©s
 *
°©
;

197 
uöt8_t
 *
d
;

199 
d
 = (
uöt8_t
 *)
d©a
;

200 *
cou¡
 = 0;

201 
d©a_Àn
 >(
oÂ_Êow_°©s
)) {

202 
°©
 = (
oÂ_Êow_°©s
 *)
d
;

203 i‡(
d©a_Àn
 < 
	`¡ohs
(
°©
->
Àngth
Ë||Çtohs(°©->ÀngthË< (
oÂ_Êow_°©s
)) {

204 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received flow stat has invalidÜength.");

205  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

207 
d©a_Àn
 -
	`¡ohs
(
°©
->
Àngth
);

208 
d
 +
	`¡ohs
(
°©
->
Àngth
);

209 (*
cou¡
)++;

213 
	}
}

215 
oÊ_îr


216 
	$oÊ_utûs_cou¡_oÂ_group_°©s
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
) {

217 
oÂ_group_°©s
 *
°©
;

218 
uöt8_t
 *
d
;

220 
d
 = (
uöt8_t
 *)
d©a
;

221 *
cou¡
 = 0;

223 
d©a_Àn
 >(
oÂ_group_°©s
)) {

224 
°©
 = (
oÂ_group_°©s
 *)
d
;

226 i‡(
d©a_Àn
 < 
	`¡ohs
(
°©
->
Àngth
Ë||Çtohs(°©->ÀngthË< (
oÂ_group_°©s
)) {

227 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received group stat has invalidÜength.");

228  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

230 
d©a_Àn
 -
	`¡ohs
(
°©
->
Àngth
);

231 
d
 +
	`¡ohs
(
°©
->
Àngth
);

232 (*
cou¡
)++;

236 
	}
}

239 
oÊ_îr


240 
	$oÊ_utûs_cou¡_oÂ_èbÀ_°©s
(*
d©a
 
UNUSED
, 
size_t
 
d©a_Àn
, size_à*
cou¡
) {

241 *
cou¡
 = 
d©a_Àn
 / (
oÂ_èbÀ_°©s
);

244 
	}
}

246 
oÊ_îr


247 
	$oÊ_utûs_cou¡_oÂ_buckë_cou¡îs
(*
d©a
 
UNUSED
, 
size_t
 
d©a_Àn
, size_à*
cou¡
) {

248 *
cou¡
 = 
d©a_Àn
 / (
oÂ_buckë_cou¡î
);

250 
	}
}

252 
oÊ_îr


253 
	$oÊ_utûs_cou¡_oÂ_p‹t_°©s
(*
d©a
 
UNUSED
, 
size_t
 
d©a_Àn
, size_à*
cou¡
) {

254 *
cou¡
 = 
d©a_Àn
 / (
oÂ_p‹t_°©s
);

256 
	}
}

258 
oÊ_îr


259 
	$oÊ_utûs_cou¡_oÂ_queue_°©s
(*
d©a
 
UNUSED
, 
size_t
 
d©a_Àn
, size_à*
cou¡
) {

260 *
cou¡
 = 
d©a_Àn
 / (
oÂ_queue_°©s
);

262 
	}
}

264 
oÊ_îr


265 
	$oÊ_utûs_cou¡_oÂ_group_desc_°©s
(*
d©a
 
UNUSED
, 
size_t
 
d©a_Àn
, size_à*
cou¡
) {

266 
oÂ_group_desc_°©s
 *
°©
;

267 
uöt8_t
 *
d
;

269 
d
 = (
uöt8_t
 *)
d©a
;

270 *
cou¡
 = 0;

272 
d©a_Àn
 >(
oÂ_group_desc_°©s
)) {

273 
°©
 = (
oÂ_group_desc_°©s
 *)
d
;

275 i‡(
d©a_Àn
 < 
	`¡ohs
(
°©
->
Àngth
Ë||Çtohs(°©->ÀngthË< (
oÂ_group_desc_°©s
)) {

276 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received group desc stat has invalidÜength.");

277  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

279 
d©a_Àn
 -
	`¡ohs
(
°©
->
Àngth
);

280 
d
 +
	`¡ohs
(
°©
->
Àngth
);

281 (*
cou¡
)++;

285 
	}
}

287 
oÊ_îr


288 
	$oÊ_utûs_cou¡_oÂ_queue_¥›s
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
) {

289 
oÂ_queue_¥›_hódî
 *
¥›
;

290 
uöt8_t
 *
d
;

292 
d
 = (
uöt8_t
 *)
d©a
;

293 (*
cou¡
) = 0;

295 
d©a_Àn
 >(
oÂ_queue_¥›_hódî
)) {

296 
¥›
 = (
oÂ_queue_¥›_hódî
 *)
d
;

298 i‡(
d©a_Àn
 < 
	`¡ohs
(
¥›
->
Àn
Ë||Çtohs’r›->ÀnË< (
oÂ_queue_¥›_hódî
)) {

299 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received queueÖrop has invalidÜength.");

300  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

302 
d©a_Àn
 -
	`¡ohs
(
¥›
->
Àn
);

303 
d
 +
	`¡ohs
(
¥›
->
Àn
);

304 (*
cou¡
)++;

308 
	}
}

310 
oÊ_îr


311 
	$oÊ_utûs_cou¡_oÂ_mëî_°©s
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
){

312 
oÂ_mëî_°©s
 *
°©s
;

313 
uöt8_t
 *
d
;

315 
d
 = (
uöt8_t
 *)
d©a
;

316 (*
cou¡
) = 0;

318 
d©a_Àn
 >(
oÂ_mëî_°©s
)) {

319 
°©s
 = (
oÂ_mëî_°©s
 *)
d
;

321 i‡(
d©a_Àn
 < 
	`¡ohs
(
°©s
->
Àn
Ë||Çtohs(°©s->ÀnË< (
oÂ_mëî_°©s
)) {

322 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received meter stat has invalidÜength.");

323  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

325 
d©a_Àn
 -
	`¡ohs
(
°©s
->
Àn
);

326 
d
 +
	`¡ohs
(
°©s
->
Àn
);

327 (*
cou¡
)++;

330 
	}
}

332 
oÊ_îr


333 
	$oÊ_utûs_cou¡_oÂ_mëî_b™d_°©s
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
){

334 
uöt8_t
 *
d
;

336 
d
 = (
uöt8_t
 *)
d©a
;

337 (*
cou¡
) = 0;

339 
d©a_Àn
 >(
oÂ_mëî_b™d_°©s
)) {

341 i‡(
d©a_Àn
 < (
oÂ_mëî_b™d_°©s
)) {

342 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received band meter stat has invalidÜength.");

343  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

345 
d©a_Àn
 -(
oÂ_mëî_b™d_°©s
);

346 
d
 +(
oÂ_mëî_b™d_°©s
);

347 (*
cou¡
)++;

350 
	}
}

352 
oÊ_îr


353 
	$oÊ_utûs_cou¡_oÂ_mëî_c⁄fig
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
){

354 
oÂ_mëî_c⁄fig
 *
c⁄fig
;

355 
uöt8_t
 *
d
;

357 
d
 = (
uöt8_t
 *)
d©a
;

358 (*
cou¡
) = 0;

360 
d©a_Àn
 >(
oÂ_mëî_c⁄fig
)) {

361 
c⁄fig
 = (
oÂ_mëî_c⁄fig
 *)
d
;

362 i‡(
d©a_Àn
 < 
	`¡ohs
(
c⁄fig
->
Àngth
Ë||Çtohs(c⁄fig->ÀngthË< (
oÂ_mëî_c⁄fig
)) {

363 
	`OFL_LOG_WARN
(
LOG_MODULE
, "Received meter stat has invalidÜength.");

364  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_LEN
);

366 
d©a_Àn
 -
	`¡ohs
(
c⁄fig
->
Àngth
);

367 
d
 +
	`¡ohs
(
c⁄fig
->
Àngth
);

368 (*
cou¡
)++;

371 
	}
}

374 
	$oÊ_°ru˘s_‰ì_∑ckë_queue
(
oÊ_∑ckë_queue
 *
queue
) {

375 
	`OFL_UTILS_FREE_ARR
(
queue
->
¥›îtõs
, queue->
¥›îtõs_num
);

376 
	`‰ì
(
queue
);

377 
	}
}

380 
	$oÊ_°ru˘s_‰ì_ö°ru˘i⁄
(
oÊ_ö°ru˘i⁄_hódî
 *
ö°
, 
oÊ_exp
 *
exp
) {

381 
ö°
->
ty≥
) {

382 
OFPIT_GOTO_TABLE
:

383 
OFPIT_WRITE_METADATA
:

384 
OFPIT_METER
:

386 
OFPIT_WRITE_ACTIONS
:

387 
OFPIT_APPLY_ACTIONS
: {

388 
oÊ_ö°ru˘i⁄_a˘i⁄s
 *
ü
 = (oÊ_ö°ru˘i⁄_a˘i⁄†*)
ö°
;

389 
	`OFL_UTILS_FREE_ARR_FUN2
(
ü
->
a˘i⁄s
, ia->
a˘i⁄s_num
,

390 
oÊ_a˘i⁄s_‰ì
, 
exp
);

393 
OFPIT_CLEAR_ACTIONS
: {

396 
OFPIT_EXPERIMENTER
: {

397 i‡(
exp
 =
NULL
 ||Éxp->
ö°
 =NULL ||Éxp->ö°->
‰ì
 == NULL) {

398 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅo freeÉxperimented instruction, butÇo callback was given.");

400 
exp
->
ö°
->
	`‰ì
(inst);

405 
	`‰ì
(
ö°
);

406 
	}
}

408 
	$oÊ_°ru˘s_‰ì_mëî_b™ds
(
oÊ_mëî_b™d_hódî
 *
mëî_b™d
){

409 
	`‰ì
(
mëî_b™d
);

410 
	}
}

413 
	$oÊ_°ru˘s_‰ì_mëî_b™d_°©s
(
oÊ_mëî_b™d_°©s
* 
s
){

414 
	`‰ì
(
s
);

415 
	}
}

418 
	$oÊ_°ru˘s_‰ì_mëî_°©s
(
oÊ_mëî_°©s
 *
°©s
){

419 
	`OFL_UTILS_FREE_ARR_FUN
(
°©s
->
b™d_°©s
, sèts->
mëî_b™ds_num
,

420 
oÊ_°ru˘s_‰ì_mëî_b™d_°©s
);

421 
	`‰ì
(
°©s
);

422 
	}
}

425 
	$oÊ_°ru˘s_‰ì_mëî_c⁄fig
(
oÊ_mëî_c⁄fig
 *
c⁄f
){

426 
	`OFL_UTILS_FREE_ARR_FUN
(
c⁄f
->
b™ds
, c⁄f->
mëî_b™ds_num
,

427 
oÊ_°ru˘s_‰ì_mëî_b™ds
);

428 
	`‰ì
(
c⁄f
);

429 
	}
}

432 
	$oÊ_°ru˘s_‰ì_èbÀ_°©s
(
oÊ_èbÀ_°©s
 *
°©s
) {

433 
	`‰ì
(
°©s
);

434 
	}
}

437 
	$oÊ_°ru˘s_‰ì_buckë
(
oÊ_buckë
 *
buckë
, 
oÊ_exp
 *
exp
) {

438 
	`OFL_UTILS_FREE_ARR_FUN2
(
buckë
->
a˘i⁄s
, buckë->
a˘i⁄s_num
,

439 
oÊ_a˘i⁄s_‰ì
, 
exp
);

440 
	`‰ì
(
buckë
);

441 
	}
}

445 
	$oÊ_°ru˘s_‰ì_Êow_°©s
(
oÊ_Êow_°©s
 *
°©s
, 
oÊ_exp
 *
exp
) {

446 
	`OFL_UTILS_FREE_ARR_FUN2
(
°©s
->
ö°ru˘i⁄s
, sèts->
ö°ru˘i⁄s_num
,

447 
oÊ_°ru˘s_‰ì_ö°ru˘i⁄
, 
exp
);

448 
	`oÊ_°ru˘s_‰ì_m©ch
(
°©s
->
m©ch
, 
exp
);

449 
	`‰ì
(
°©s
);

450 
	}
}

453 
	$oÊ_°ru˘s_‰ì_p‹t
(
oÊ_p‹t
 *
p‹t
) {

454 
	`‰ì
(
p‹t
->
«me
);

455 
	`‰ì
(
p‹t
);

456 
	}
}

459 
	$oÊ_°ru˘s_‰ì_group_°©s
(
oÊ_group_°©s
 *
°©s
) {

460 
	`OFL_UTILS_FREE_ARR
(
°©s
->
cou¡îs
, sèts->
cou¡îs_num
);

461 
	`‰ì
(
°©s
);

462 
	}
}

465 
	$oÊ_°ru˘s_‰ì_group_desc_°©s
(
oÊ_group_desc_°©s
 *
°©s
, 
oÊ_exp
 *
exp
) {

466 
	`OFL_UTILS_FREE_ARR_FUN2
(
°©s
->
buckës
, sèts->
buckës_num
,

467 
oÊ_°ru˘s_‰ì_buckë
, 
exp
);

468 
	`‰ì
(
°©s
);

469 
	}
}

472 
	$oÊ_°ru˘s_‰ì_èbÀ_„©uªs
(
oÊ_èbÀ_„©uªs
* 
„©uªs
, 
oÊ_exp
 *
exp
){

473 
	`OFL_UTILS_FREE_ARR_FUN2
(
„©uªs
->
¥›îtõs
, fótuªs->
¥›îtõs_num
,

474 
oÊ_°ru˘s_‰ì_èbÀ_¥›îtõs
, 
exp
);

475 
	`‰ì
(
„©uªs
->
«me
);

476 
	`‰ì
(
„©uªs
);

477 
	}
}

480 
	$oÊ_°ru˘s_‰ì_èbÀ_¥›îtõs
(
oÊ_èbÀ_„©uª_¥›_hódî
 *
¥›
, 
oÊ_exp
 *
exp
 
UNUSED
){

481 
¥›
->
ty≥
){

482 (
OFPTFPT_INSTRUCTIONS
):

483 (
OFPTFPT_INSTRUCTIONS_MISS
):{

484 
oÊ_èbÀ_„©uª_¥›_ö°ru˘i⁄s
 *
ö°
 = (oÊ_èbÀ_„©uª_¥›_ö°ru˘i⁄†*)
¥›
;

485 
	`‰ì
(
ö°
->
ö°ru˘i⁄_ids
);

488 (
OFPTFPT_NEXT_TABLES_MISS
):

489 (
OFPTFPT_NEXT_TABLES
):{

490 
oÊ_èbÀ_„©uª_¥›_√xt_èbÀs
 *
èbÀs
 = (oÊ_èbÀ_„©uª_¥›_√xt_èbÀ†*)
¥›
 ;

491 
	`‰ì
(
èbÀs
->
√xt_èbÀ_ids
);

494 (
OFPTFPT_WRITE_ACTIONS
):

495 (
OFPTFPT_WRITE_ACTIONS_MISS
):

496 (
OFPTFPT_APPLY_ACTIONS
):

497 (
OFPTFPT_APPLY_ACTIONS_MISS
):{

498 
oÊ_èbÀ_„©uª_¥›_a˘i⁄s
 *
a˘
 = (oÊ_èbÀ_„©uª_¥›_a˘i⁄†*)
¥›
;

499 
	`‰ì
(
a˘
->
a˘i⁄_ids
);

502 (
OFPTFPT_APPLY_SETFIELD
):

503 (
OFPTFPT_APPLY_SETFIELD_MISS
):

504 (
OFPTFPT_WRITE_SETFIELD
):

505 (
OFPTFPT_WRITE_SETFIELD_MISS
):

506 (
OFPTFPT_WILDCARDS
):

507 (
OFPTFPT_MATCH
):{

508 
oÊ_èbÀ_„©uª_¥›_oxm
 *
oxm
 = (oÊ_èbÀ_„©uª_¥›_oxm *)
¥›
;

509 
	`‰ì
(
oxm
->
oxm_ids
);

513 
	`‰ì
(
¥›
);

514 
	}
}

517 
	$oÊ_°ru˘s_‰ì_m©ch
(
oÊ_m©ch_hódî
 *
m©ch
, 
oÊ_exp
 *
exp
) {

518 
m©ch
->
ty≥
) {

519 (
OFPMT_OXM
): {

520 i‡(
m©ch
->
Àngth
 > (
oÂ_m©ch
)){

521 
oÊ_m©ch
 *
m
 = (oÊ_m©ch*Ë
m©ch
;

522 
oÊ_m©ch_év
 *
év
, *
√xt
;

523 
	`HMAP_FOR_EACH_SAFE
(
év
, 
√xt
, 
oÊ_m©ch_év
, 
hm≠_node
, &
m
->
m©ch_fõlds
){

524 
	`‰ì
(
év
->
vÆue
);

525 
	`‰ì
(
év
);

527 
	`hm≠_de°roy
(&
m
->
m©ch_fõlds
);

528 
	`‰ì
(
m
);

530 
	`‰ì
(
m©ch
);

535 i‡(
exp
 =
NULL
 ||Éxp->
m©ch
 =NULL ||Éxp->m©ch->
‰ì
 == NULL) {

536 
	`OFL_LOG_WARN
(
LOG_MODULE
, "TryingÅo freeÉxperimented instruction, butÇo callback was given.");

537 
	`‰ì
(
m©ch
);

539 
exp
->
m©ch
->
	`‰ì
(match);

543 
	}
}

	@oflib/ofl-structs.h

32 #i‚de‡
OFL_STRUCTS_H


33 
	#OFL_STRUCTS_H
 1

	)

35 
	~<sys/ty≥s.h
>

36 
	~<°dio.h
>

38 
	~<√töë/icmp6.h
>

39 
	~"../ö˛ude/›íÊow/›íÊow.h
"

40 
	~"oÊ.h
"

41 
	~"oÊ-a˘i⁄s.h
"

42 
	~"oÊ-∑ckës.h
"

43 
	~"../lib/hm≠.h
"

46 
	goÊ_exp
;

52 
	soÊ_∑ckë_queue
 {

53 
uöt32_t
 
	mqueue_id
;

54 
size_t
 
	m¥›îtõs_num
;

55 
oÊ_queue_¥›_hódî
 **
	m¥›îtõs
;

59 
	soÊ_queue_¥›_hódî
 {

60 
oÂ_queue_¥›îtõs
 
	mty≥
;

63 
	soÊ_queue_¥›_mö_øã
 {

64 
oÊ_queue_¥›_hódî
 
	mhódî
;

66 
uöt16_t
 
	møã
;

69 
	soÊ_queue_¥›_max_øã
 {

70 
oÊ_queue_¥›_hódî
 
	mhódî
;

72 
uöt16_t
 
	møã
;

75 
	soÊ_queue_¥›_ex≥rimíãr
 {

76 
oÊ_queue_¥›_hódî
 
	m¥›_hódî
;

77 
uöt32_t
 
	mex≥rimíãr
;

78 
uöt8_t
 *
	md©a
;

82 
	soÊ_ö°ru˘i⁄_hódî
 {

83 
oÂ_ö°ru˘i⁄_ty≥
 
	mty≥
;

86 
	soÊ_ö°ru˘i⁄_gŸo_èbÀ
 {

87 
oÊ_ö°ru˘i⁄_hódî
 
	mhódî
;

89 
uöt8_t
 
	mèbÀ_id
;

94 
	soÊ_ö°ru˘i⁄_wrôe_mëad©a
 {

95 
oÊ_ö°ru˘i⁄_hódî
 
	mhódî
;

97 
uöt64_t
 
	mmëad©a
;

98 
uöt64_t
 
	mmëad©a_mask
;

102 
	soÊ_ö°ru˘i⁄_a˘i⁄s
 {

103 
oÊ_ö°ru˘i⁄_hódî
 
	mhódî
;

105 
size_t
 
	ma˘i⁄s_num
;

106 
oÊ_a˘i⁄_hódî
 **
	ma˘i⁄s
;

109 
	soÊ_ö°ru˘i⁄_mëî
 {

110 
oÊ_ö°ru˘i⁄_hódî
 
	mhódî
;

111 
uöt32_t
 
	mmëî_id
;

116 
	soÊ_ö°ru˘i⁄_£t_°©e
 {

117 
oÊ_ö°ru˘i⁄_hódî
 
	mhódî
;

119 
uöt64_t
 
	m°©e
;

123 
	soÊ_ö°ru˘i⁄_ex≥rimíãr
 {

124 
oÊ_ö°ru˘i⁄_hódî
 
	mhódî
;

126 
uöt32_t
 
	mex≥rimíãr_id
;

129 
	soÊ_c⁄fig
 {

130 
uöt16_t
 
	mÊags
;

131 
uöt16_t
 
	mmiss_£nd_Àn
;

135 
	soÊ_async_c⁄fig
 {

136 
uöt32_t
 
	m∑ckë_ö_mask
[2];

137 
uöt32_t
 
	mp‹t_°©us_mask
[2];

138 
uöt32_t
 
	mÊow_ªmoved_mask
[2];

141 
	soÊ_buckë
 {

142 
uöt16_t
 
	mweight
;

144 
uöt32_t
 
	mw©ch_p‹t
;

147 
uöt32_t
 
	mw©ch_group
;

150 
size_t
 
	ma˘i⁄s_num
;

151 
oÊ_a˘i⁄_hódî
 **
	ma˘i⁄s
;

154 
	soÊ_Êow_°©s
 {

155 
uöt8_t
 
	mèbÀ_id
;

156 
uöt32_t
 
	mduøti⁄_£c
;

157 
uöt32_t
 
	mduøti⁄_n£c
;

159 
uöt16_t
 
	m¥i‹ôy
;

161 
uöt16_t
 
	midÀ_timeout
;

163 
uöt16_t
 
	mh¨d_timeout
;

164 
uöt64_t
 
	mcookõ
;

165 
uöt64_t
 
	m∑ckë_cou¡
;

166 
uöt64_t
 
	mbyã_cou¡
;

167 
oÊ_m©ch_hódî
 *
	mm©ch
;

168 
size_t
 
	mö°ru˘i⁄s_num
;

169 
oÊ_ö°ru˘i⁄_hódî
 **
	mö°ru˘i⁄s
;

174 
	soÊ_èbÀ_°©s
 {

175 
uöt8_t
 
	mèbÀ_id
;

177 
uöt32_t
 
	ma˘ive_cou¡
;

178 
uöt64_t
 
	mlookup_cou¡
;

179 
uöt64_t
 
	mm©ched_cou¡
;

182 
	soÊ_èbÀ_„©uª_¥›_hódî
 {

183 
uöt16_t
 
	mty≥
;

184 
uöt16_t
 
	mÀngth
;

187 
OFP_ASSERT
((
oÊ_èbÀ_„©uª_¥›_hódî
) == 4);

190 
	soÊ_èbÀ_„©uª_¥›_ö°ru˘i⁄s
 {

191 
oÊ_èbÀ_„©uª_¥›_hódî
 
	mhódî
;

192 
size_t
 
	mids_num
;

193 
oÊ_ö°ru˘i⁄_hódî
 *
	mö°ru˘i⁄_ids
;

196 
	soÊ_èbÀ_„©uª_¥›_√xt_èbÀs
 {

197 
oÊ_èbÀ_„©uª_¥›_hódî
 
	mhódî
;

198 
size_t
 
	mèbÀ_num
;

199 
uöt8_t
 *
	m√xt_èbÀ_ids
;

203 
	soÊ_èbÀ_„©uª_¥›_a˘i⁄s
 {

204 
oÊ_èbÀ_„©uª_¥›_hódî
 
	mhódî
;

205 
size_t
 
	ma˘i⁄s_num
;

206 
oÊ_a˘i⁄_hódî
 *
	ma˘i⁄_ids
;

209 
	soÊ_èbÀ_„©uª_¥›_oxm
 {

210 
oÊ_èbÀ_„©uª_¥›_hódî
 
	mhódî
;

211 
size_t
 
	moxm_num
;

212 
uöt32_t
 *
	moxm_ids
;

218 
	soÊ_èbÀ_„©uªs
 {

219 
uöt16_t
 
	mÀngth
;

220 
uöt8_t
 
	mèbÀ_id
;

222 
uöt8_t
 
	m∑d
[5];

223 *
	m«me
;

224 
uöt64_t
 
	mmëad©a_m©ch
;

225 
uöt64_t
 
	mmëad©a_wrôe
;

226 
uöt32_t
 
	mc⁄fig
;

227 
uöt32_t
 
	mmax_íåõs
;

228 
size_t
 
	m¥›îtõs_num
;

230 
oÊ_èbÀ_„©uª_¥›_hódî
 **
	m¥›îtõs
;

233 
	soÊ_m©ch_hódî
 {

234 
uöt16_t
 
	mty≥
;

235 
uöt16_t
 
	mÀngth
;

238 
	soÊ_m©ch
 {

239 
oÊ_m©ch_hódî
 
	mhódî
;

240 
hm≠
 
	mm©ch_fõlds
;

243 
	soÊ_m©ch_év
{

245 
hm≠_node
 
	mhm≠_node
;

246 
uöt32_t
 
	mhódî
;

247 
uöt8_t
 *
	mvÆue
;

252 
	soÊ_mëî_b™d_hódî
 {

253 
uöt16_t
 
	mty≥
;

254 
uöt32_t
 
	møã
;

255 
uöt32_t
 
	mbur°_size
;

260 
	soÊ_mëî_b™d_dr›
 {

261 
uöt16_t
 
	mty≥
;

262 
uöt32_t
 
	møã
;

263 
uöt32_t
 
	mbur°_size
;

267 
	soÊ_mëî_b™d_ds˝_ªm¨k
 {

268 
uöt16_t
 
	mty≥
;

269 
uöt32_t
 
	møã
;

270 
uöt32_t
 
	mbur°_size
;

271 
uöt8_t
 
	m¥ec_Àvñ
;

275 
	soÊ_mëî_b™d_ex≥rimíãr
 {

276 
uöt16_t
 
	mty≥
;

277 
uöt32_t
 
	møã
;

278 
uöt32_t
 
	mbur°_size
;

279 
uöt32_t
 
	mex≥rimíãr
;

284 
	soÊ_p‹t_°©s
 {

285 
uöt32_t
 
	mp‹t_no
;

286 
uöt64_t
 
	mrx_∑ckës
;

287 
uöt64_t
 
	mtx_∑ckës
;

288 
uöt64_t
 
	mrx_byãs
;

289 
uöt64_t
 
	mtx_byãs
;

290 
uöt64_t
 
	mrx_dr›≥d
;

291 
uöt64_t
 
	mtx_dr›≥d
;

292 
uöt64_t
 
	mrx_îr‹s
;

296 
uöt64_t
 
	mtx_îr‹s
;

300 
uöt64_t
 
	mrx_‰ame_îr
;

301 
uöt64_t
 
	mrx_ovî_îr
;

302 
uöt64_t
 
	mrx_¸c_îr
;

303 
uöt64_t
 
	mcﬁlisi⁄s
;

304 
uöt32_t
 
	mduøti⁄_£c
;

305 
uöt32_t
 
	mduøti⁄_n£c
;

309 
	soÊ_buckë_cou¡î
 {

310 
uöt64_t
 
	m∑ckë_cou¡
;

311 
uöt64_t
 
	mbyã_cou¡
;

314 
	soÊ_group_°©s
 {

315 
uöt32_t
 
	mgroup_id
;

316 
uöt32_t
 
	mªf_cou¡
;

317 
uöt64_t
 
	m∑ckë_cou¡
;

318 
uöt64_t
 
	mbyã_cou¡
;

319 
size_t
 
	mcou¡îs_num
;

320 
uöt32_t
 
	mduøti⁄_£c
;

321 
uöt32_t
 
	mduøti⁄_n£c
;

323 
oÊ_buckë_cou¡î
 **
	mcou¡îs
;

327 
	soÊ_p‹t
 {

328 
uöt32_t
 
	mp‹t_no
;

329 
uöt8_t
 
	mhw_addr
[
OFP_ETH_ALEN
];

330 *
	m«me
;

332 
uöt32_t
 
	mc⁄fig
;

333 
uöt32_t
 
	m°©e
;

335 
uöt32_t
 
	mcuº
;

336 
uöt32_t
 
	madvîti£d
;

337 
uöt32_t
 
	msuµ‹ãd
;

338 
uöt32_t
 
	m≥î
;

340 
uöt32_t
 
	mcuº_•ìd
;

341 
uöt32_t
 
	mmax_•ìd
;

346 
	soÊ_queue_°©s
 {

347 
uöt32_t
 
	mp‹t_no
;

348 
uöt32_t
 
	mqueue_id
;

349 
uöt64_t
 
	mtx_byãs
;

350 
uöt64_t
 
	mtx_∑ckës
;

351 
uöt64_t
 
	mtx_îr‹s
;

352 
uöt32_t
 
	mduøti⁄_£c
;

353 
uöt32_t
 
	mduøti⁄_n£c
;

357 
	soÊ_group_desc_°©s
 {

358 
uöt8_t
 
	mty≥
;

359 
uöt32_t
 
	mgroup_id
;

361 
size_t
 
	mbuckës_num
;

362 
oÊ_buckë
 **
	mbuckës
;

367 
	soÊ_mëî_b™d_°©s
 {

368 
uöt64_t
 
	m∑ckë_b™d_cou¡
;

369 
uöt64_t
 
	mbyã_b™d_cou¡
;

372 
uöt64_t
 
	mœ°_fûl
;

373 
uöt64_t
 
	mtokís
;

377 
	soÊ_mëî_°©s
 {

378 
uöt32_t
 
	mmëî_id
;

379 
uöt16_t
 
	mÀn
;

380 
uöt32_t
 
	mÊow_cou¡
;

381 
uöt64_t
 
	m∑ckë_ö_cou¡
;

382 
uöt64_t
 
	mbyã_ö_cou¡
;

383 
uöt32_t
 
	mduøti⁄_£c
;

384 
uöt32_t
 
	mduøti⁄_n£c
;

386 
size_t
 
	mmëî_b™ds_num
;

387 
oÊ_mëî_b™d_°©s
 **
	mb™d_°©s
;

392 
	soÊ_mëî_c⁄fig
 {

393 
uöt16_t
 
	mÀngth
;

394 
uöt16_t
 
	mÊags
;

395 
uöt32_t
 
	mmëî_id
;

396 
size_t
 
	mmëî_b™ds_num
;

397 
oÊ_mëî_b™d_hódî
 **
	mb™ds
;

401 
	soÊ_mëî_„©uªs
 {

402 
uöt32_t
 
	mmax_mëî
;

403 
uöt32_t
 
	mb™d_ty≥s
;

404 
uöt32_t
 
	mˇ∑bûôõs
;

405 
uöt8_t
 
	mmax_b™ds
;

406 
uöt8_t
 
	mmax_cﬁ‹
;

413 
oÊ_°ru˘s_m©ch_öô
(
oÊ_m©ch
 *
m©ch
);

415 #ifde‡
__˝lu•lus


419 
oÊ_°ru˘s_m©ch_put8
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, 
uöt8_t
 
vÆue
);

422 
oÊ_°ru˘s_m©ch_put8m
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, 
uöt8_t
 
vÆue
, uöt8_à
mask
);

425 
oÊ_°ru˘s_m©ch_put16
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, 
uöt16_t
 
vÆue
);

428 
oÊ_°ru˘s_m©ch_put16m
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, 
uöt16_t
 
vÆue
, uöt16_à
mask
);

431 
oÊ_°ru˘s_m©ch_put32
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, uöt32_à
vÆue
);

434 
oÊ_°ru˘s_m©ch_put32m
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, uöt32_à
vÆue
, uöt32_à
mask
);

437 
oÊ_°ru˘s_m©ch_put64
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, 
uöt64_t
 
vÆue
);

440 
oÊ_°ru˘s_m©ch_put64m
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, 
uöt64_t
 
vÆue
, uöt64_à
mask
);

443 
oÊ_°ru˘s_m©ch_put_ëh
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, 
uöt8_t
 
vÆue
[
ETH_ADDR_LEN
]);

446 
oÊ_°ru˘s_m©ch_put_ëh_m
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, 
uöt8_t
 
vÆue
[
ETH_ADDR_LEN
], uöt8_à
mask
[ETH_ADDR_LEN]);

449 
oÊ_°ru˘s_m©ch_put_ùv6
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, 
uöt8_t
 
vÆue
[
IPv6_ADDR_LEN
] );

452 
oÊ_°ru˘s_m©ch_put_ùv6m
(
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
, 
uöt8_t
 
vÆue
[
IPv6_ADDR_LEN
], uöt8_à
mask
[IPv6_ADDR_LEN]);

454 #ifde‡
__˝lu•lus


459 
oÊ_°ru˘s_m©ch_oÂ_tŸÆ_Àn
(
oÊ_m©ch
 *
m©ch
);

466 
size_t


467 
oÊ_°ru˘s_ö°ru˘i⁄s_∑ck
(
oÊ_ö°ru˘i⁄_hódî
 *
§c
, 
oÂ_ö°ru˘i⁄
 *
d°
, 
oÊ_exp
 *
exp
);

469 
size_t


470 
oÊ_°ru˘s_mëî_b™d_∑ck
(
oÊ_mëî_b™d_hódî
 *
§c
, 
oÂ_mëî_b™d_hódî
 *
d°
);

472 
size_t


473 
oÊ_°ru˘s_mëî_c⁄f_∑ck
(
oÊ_mëî_c⁄fig
 *
§c
, 
oÂ_mëî_c⁄fig
 *
d°
, 
uöt8_t
* 
d©a
);

475 
size_t


476 
oÊ_°ru˘s_mëî_°©s_∑ck
(
oÊ_mëî_°©s
 *
§c
, 
oÂ_mëî_°©s
 *
d°
);

478 
size_t


479 
oÊ_°ru˘s_èbÀ_¥›îtõs_∑ck
(
oÊ_èbÀ_„©uª_¥›_hódî
 * 
§c
, 
oÂ_èbÀ_„©uª_¥›_hódî
 *
d°
, 
uöt8_t
 *
d©a
, 
oÊ_exp
 *
exp
);

481 
size_t


482 
oÊ_°ru˘s_èbÀ_„©uªs_∑ck
(
oÊ_èbÀ_„©uªs
 *
§c
, 
oÂ_èbÀ_„©uªs
 *
d°
, 
uöt8_t
* 
d©a
, 
oÊ_exp
 *
exp
);

484 
size_t


485 
oÊ_°ru˘s_buckë_∑ck
(
oÊ_buckë
 *
§c
, 
oÂ_buckë
 *
d°
, 
oÊ_exp
 *
exp
);

487 
size_t


488 
oÊ_°ru˘s_Êow_°©s_∑ck
(
oÊ_Êow_°©s
 *
§c
, 
uöt8_t
 *
d°
, 
oÊ_exp
 *
exp
);

490 
size_t


491 
oÊ_°ru˘s_group_°©s_∑ck
(
oÊ_group_°©s
 *
§c
, 
oÂ_group_°©s
 *
d°
);

493 
size_t


494 
oÊ_°ru˘s_queue_¥›_∑ck
(
oÊ_queue_¥›_hódî
 *
§c
, 
oÂ_queue_¥›_hódî
 *
d°
);

496 
size_t


497 
oÊ_°ru˘s_∑ckë_queue_∑ck
(
oÊ_∑ckë_queue
 *
§c
, 
oÂ_∑ckë_queue
 *
d°
);

499 
size_t


500 
oÊ_°ru˘s_p‹t_°©s_∑ck
(
oÊ_p‹t_°©s
 *
§c
, 
oÂ_p‹t_°©s
 *
d°
);

503 
size_t


504 
oÊ_°ru˘s_p‹t_∑ck
(
oÊ_p‹t
 *
§c
, 
oÂ_p‹t
 *
d°
);

506 
size_t


507 
oÊ_°ru˘s_èbÀ_°©s_∑ck
(
oÊ_èbÀ_°©s
 *
§c
, 
oÂ_èbÀ_°©s
 *
d°
);

510 
size_t


511 
oÊ_°ru˘s_queue_°©s_∑ck
(
oÊ_queue_°©s
 *
§c
, 
oÂ_queue_°©s
 *
d°
);

513 
size_t


514 
oÊ_°ru˘s_group_desc_°©s_∑ck
(
oÊ_group_desc_°©s
 *
§c
, 
oÂ_group_desc_°©s
 *
d°
, 
oÊ_exp
 *
exp
);

516 
size_t


517 
oÊ_°ru˘s_buckë_cou¡î_∑ck
(
oÊ_buckë_cou¡î
 *
§c
, 
oÂ_buckë_cou¡î
 *
d°
);

519 
size_t


520 
oÊ_°ru˘s_m©ch_∑ck
(
oÊ_m©ch_hódî
 *
§c
, 
oÂ_m©ch
 *
d°
, 
uöt8_t
* 
oxm_fõlds
, 
oÊ_exp
 *
exp
);

522 
oÊ_îr


523 
oÊ_°ru˘s_ö°ru˘i⁄s_u≈ack
(
oÂ_ö°ru˘i⁄
 *
§c
, 
size_t
 *
Àn
, 
oÊ_ö°ru˘i⁄_hódî
 **
d°
, 
oÊ_exp
 *
exp
);

525 
oÊ_îr


526 
oÊ_°ru˘s_èbÀ_„©uªs_u≈ack
(
oÂ_èbÀ_„©uªs
 *
§c
, 
size_t
 *
Àn
, 
oÊ_èbÀ_„©uªs
 **
d°
, 
oÊ_exp
 *
exp
);

528 
oÊ_îr


529 
oÊ_°ru˘s_buckë_u≈ack
(
oÂ_buckë
 *
§c
, 
size_t
 *
Àn
, 
uöt8_t
 
gty≥
, 
oÊ_buckë
 **
d°
, 
oÊ_exp
 *
exp
);

531 
oÊ_îr


532 
oÊ_°ru˘s_Êow_°©s_u≈ack
(
oÂ_Êow_°©s
 *
§c
,
uöt8_t
 *
buf
, 
size_t
 *
Àn
, 
oÊ_Êow_°©s
 **
d°
, 
oÊ_exp
 *
exp
);

534 
oÊ_îr


535 
oÊ_°ru˘s_queue_¥›_u≈ack
(
oÂ_queue_¥›_hódî
 *
§c
, 
size_t
 *
Àn
, 
oÊ_queue_¥›_hódî
 **
d°
);

537 
oÊ_îr


538 
oÊ_°ru˘s_∑ckë_queue_u≈ack
(
oÂ_∑ckë_queue
 *
§c
, 
size_t
 *
Àn
, 
oÊ_∑ckë_queue
 **
d°
);

540 
oÊ_îr


541 
oÊ_°ru˘s_p‹t_u≈ack
(
oÂ_p‹t
 *
§c
, 
size_t
 *
Àn
, 
oÊ_p‹t
 **
d°
);

543 
oÊ_îr


544 
oÊ_°ru˘s_èbÀ_°©s_u≈ack
(
oÂ_èbÀ_°©s
 *
§c
, 
size_t
 *
Àn
, 
oÊ_èbÀ_°©s
 **
d°
);

546 
oÊ_îr


547 
oÊ_°ru˘s_p‹t_°©s_u≈ack
(
oÂ_p‹t_°©s
 *
§c
, 
size_t
 *
Àn
, 
oÊ_p‹t_°©s
 **
d°
);

549 
oÊ_îr


550 
oÊ_°ru˘s_group_°©s_u≈ack
(
oÂ_group_°©s
 *
§c
, 
size_t
 *
Àn
, 
oÊ_group_°©s
 **
d°
);

552 
oÊ_îr


553 
oÊ_°ru˘s_queue_°©s_u≈ack
(
oÂ_queue_°©s
 *
§c
, 
size_t
 *
Àn
, 
oÊ_queue_°©s
 **
d°
);

555 
oÊ_îr


556 
oÊ_°ru˘s_mëî_b™d_u≈ack
(
oÂ_mëî_b™d_hódî
 *
§c
, 
size_t
 *
Àn
, 
oÊ_mëî_b™d_hódî
 **
d°
);

558 
oÊ_îr


559 
oÊ_°ru˘s_group_desc_°©s_u≈ack
(
oÂ_group_desc_°©s
 *
§c
, 
size_t
 *
Àn
, 
oÊ_group_desc_°©s
 **
d°
, 
oÊ_exp
 *
exp
);

561 
oÊ_îr


562 
oÊ_°ru˘s_buckë_cou¡î_u≈ack
(
oÂ_buckë_cou¡î
 *
§c
, 
size_t
 *
Àn
, 
oÊ_buckë_cou¡î
 **
d°
);

564 
oÊ_îr


565 
oÊ_°ru˘s_m©ch_u≈ack
(
oÂ_m©ch
 *
§c
,
uöt8_t
 *
buf
, 
size_t
 *
Àn
, 
oÊ_m©ch_hódî
 **
d°
, 
oÊ_exp
 *
exp
);

567 
oÊ_îr


568 
oÊ_°ru˘s_mëî_b™d_°©s_u≈ack
(
oÂ_mëî_b™d_°©s
 *
§c
, 
size_t
 *
Àn
, 
oÊ_mëî_b™d_°©s
 **
d°
);

570 
oÊ_îr


571 
oÊ_°ru˘s_mëî_°©s_u≈ack
(
oÂ_mëî_°©s
 *
§c
, 
size_t
 *
Àn
, 
oÊ_mëî_°©s
 **
d°
);

573 
oÊ_îr


574 
oÊ_°ru˘s_mëî_c⁄fig_u≈ack
(
oÂ_mëî_c⁄fig
 *
§c
, 
size_t
 *
Àn
, 
oÊ_mëî_c⁄fig
 **
d°
);

581 
oÊ_°ru˘s_‰ì_mëî_b™ds
(
oÊ_mëî_b™d_hódî
 *
mëî_b™d
);

584 
oÊ_°ru˘s_‰ì_∑ckë_queue
(
oÊ_∑ckë_queue
 *
queue
);

587 
oÊ_°ru˘s_‰ì_ö°ru˘i⁄
(
oÊ_ö°ru˘i⁄_hódî
 *
ö°
, 
oÊ_exp
 *
exp
);

590 
oÊ_°ru˘s_‰ì_èbÀ_°©s
(
oÊ_èbÀ_°©s
 *
°©s
);

593 
oÊ_°ru˘s_‰ì_buckë
(
oÊ_buckë
 *
buckë
, 
oÊ_exp
 *
exp
);

596 
oÊ_°ru˘s_‰ì_Êow_°©s
(
oÊ_Êow_°©s
 *
°©s
, 
oÊ_exp
 *
exp
);

599 
oÊ_°ru˘s_‰ì_p‹t
(
oÊ_p‹t
 *
p‹t
);

602 
oÊ_°ru˘s_‰ì_group_°©s
(
oÊ_group_°©s
 *
°©s
);

605 
oÊ_°ru˘s_‰ì_group_desc_°©s
(
oÊ_group_desc_°©s
 *
°©s
, 
oÊ_exp
 *
exp
);

608 
oÊ_°ru˘s_‰ì_m©ch
(
oÊ_m©ch_hódî
 *
m©ch
, 
oÊ_exp
 *
exp
);

611 
oÊ_°ru˘s_‰ì_mëî_b™d_°©s
(
oÊ_mëî_b™d_°©s
* 
s
);

614 
oÊ_°ru˘s_‰ì_mëî_°©s
(
oÊ_mëî_°©s
 *
°©s
);

617 
oÊ_°ru˘s_‰ì_mëî_c⁄fig
(
oÊ_mëî_c⁄fig
 *
c⁄f
);

620 
oÊ_°ru˘s_‰ì_èbÀ_„©uªs
(
oÊ_èbÀ_„©uªs
* 
„©uªs
, 
oÊ_exp
 *
exp
);

623 
oÊ_°ru˘s_‰ì_èbÀ_¥›îtõs
(
oÊ_èbÀ_„©uª_¥›_hódî
 *
¥›
, 
oÊ_exp
 *
exp
);

632 
oÊ_îr


633 
oÊ_utûs_cou¡_oÂ_ö°ru˘i⁄s
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
);

635 
oÊ_îr


636 
oÊ_utûs_cou¡_oÂ_buckës
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
);

638 
oÊ_îr


639 
oÊ_utûs_cou¡_oÂ_mëî_b™ds
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
);

641 
oÊ_îr


642 
oÊ_utûs_cou¡_oÂ_p‹ts
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
);

644 
oÊ_îr


645 
oÊ_utûs_cou¡_oÂ_Êow_°©s
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
);

647 
oÊ_îr


648 
oÊ_utûs_cou¡_oÂ_group_°©s
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
);

650 
oÊ_îr


651 
oÊ_utûs_cou¡_oÂ_èbÀ_°©s
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
);

653 
oÊ_îr


654 
oÊ_utûs_cou¡_oÂ_buckë_cou¡îs
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
);

656 
oÊ_îr


657 
oÊ_utûs_cou¡_oÂ_p‹t_°©s
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
);

659 
oÊ_îr


660 
oÊ_utûs_cou¡_oÂ_queue_°©s
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
);

662 
oÊ_îr


663 
oÊ_utûs_cou¡_oÂ_group_desc_°©s
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
);

665 
oÊ_îr


666 
oÊ_utûs_cou¡_oÂ_∑ckë_queues
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
);

668 
oÊ_îr


669 
oÊ_utûs_cou¡_oÂ_queue_¥›s
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
);

671 
oÊ_îr


672 
oÊ_utûs_cou¡_oÂ_èbÀ_„©uªs_¥›îtõs
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
);

674 
oÊ_îr


675 
oÊ_utûs_cou¡_oÂ_èbÀ_„©uªs
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
);

677 
oÊ_îr


678 
oÊ_utûs_cou¡_oÂ_mëî_°©s
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
);

680 
oÊ_îr


681 
oÊ_utûs_cou¡_oÂ_mëî_b™d_°©s
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
);

683 
oÊ_îr


684 
oÊ_utûs_cou¡_oÂ_mëî_c⁄fig
(*
d©a
, 
size_t
 
d©a_Àn
, size_à*
cou¡
);

686 
size_t


687 
oÊ_°ru˘s_ö°ru˘i⁄s_oÂ_tŸÆ_Àn
(
oÊ_ö°ru˘i⁄_hódî
 **
ö°ru˘i⁄s
, 
size_t
 
ö°ru˘i⁄s_num
, 
oÊ_exp
 *
exp
);

689 
size_t


690 
oÊ_°ru˘s_ö°ru˘i⁄s_oÂ_Àn
(
oÊ_ö°ru˘i⁄_hódî
 *
ö°ru˘i⁄
, 
oÊ_exp
 *
exp
);

692 
size_t


693 
oÊ_°ru˘s_mëî_b™ds_oÂ_tŸÆ_Àn
(
oÊ_mëî_b™d_hódî
 **
mëî_b™ds
, 
size_t
 
mëî_b™ds_num
);

695 
size_t


696 
oÊ_°ru˘s_mëî_b™d_oÂ_Àn
(
oÊ_mëî_b™d_hódî
 *
mëî_b™d
);

698 
size_t


699 
oÊ_°ru˘s_buckës_oÂ_tŸÆ_Àn
(
oÊ_buckë
 ** 
buckës
, 
size_t
 
buckës_num
, 
oÊ_exp
 *
exp
);

701 
size_t


702 
oÊ_°ru˘s_buckës_oÂ_Àn
(
oÊ_buckë
 *
buckë
, 
oÊ_exp
 *
exp
);

704 
size_t


705 
oÊ_°ru˘s_Êow_°©s_oÂ_tŸÆ_Àn
(
oÊ_Êow_°©s
 ** 
°©s
, 
size_t
 
°©s_num
, 
oÊ_exp
 *
exp
);

707 
size_t


708 
oÊ_°ru˘s_Êow_°©s_oÂ_Àn
(
oÊ_Êow_°©s
 *
°©s
, 
oÊ_exp
 *
exp
);

710 
size_t


711 
oÊ_°ru˘s_group_°©s_oÂ_tŸÆ_Àn
(
oÊ_group_°©s
 ** 
°©s
, 
size_t
 
°©s_num
);

713 
size_t


714 
oÊ_°ru˘s_group_°©s_oÂ_Àn
(
oÊ_group_°©s
 *
°©s
);

716 
size_t


717 
oÊ_°ru˘s_group_desc_°©s_oÂ_tŸÆ_Àn
(
oÊ_group_desc_°©s
 ** 
°©s
, 
size_t
 
°©s_num
, 
oÊ_exp
 *
exp
);

719 
size_t


720 
oÊ_°ru˘s_èbÀ_„©uªs_¥›îtõs_oÂ_Àn
(
oÊ_èbÀ_„©uª_¥›_hódî
 *
¥›
, 
oÊ_exp
 *
exp
);

722 
size_t


723 
oÊ_°ru˘s_èbÀ_„©uªs_¥›îtõs_oÂ_tŸÆ_Àn
(
oÊ_èbÀ_„©uª_¥›_hódî
 **
¥›s
, 
size_t
 
„©uªs_num
, 
oÊ_exp
 *
exp
);

725 
size_t
 
oÊ_°ru˘s_èbÀ_„©uªs_oÂ_tŸÆ_Àn
(
oÊ_èbÀ_„©uªs
 **
„©
, size_à
èbÀs_num
, 
oÊ_exp
 * 
exp
);

727 
size_t


728 
oÊ_°ru˘s_group_desc_°©s_oÂ_Àn
(
oÊ_group_desc_°©s
 *
°©s
, 
oÊ_exp
 *
exp
);

730 
size_t


731 
oÊ_°ru˘s_queue_¥›_oÂ_tŸÆ_Àn
(
oÊ_queue_¥›_hódî
 ** 
¥›s
, 
size_t
 
¥›s_num
);

733 
size_t


734 
oÊ_°ru˘s_queue_¥›_oÂ_Àn
(
oÊ_queue_¥›_hódî
 *
¥›
);

736 
size_t


737 
oÊ_°ru˘s_∑ckë_queue_oÂ_tŸÆ_Àn
(
oÊ_∑ckë_queue
 ** 
queues
, 
size_t
 
queues_num
);

739 
size_t


740 
oÊ_°ru˘s_∑ckë_queue_oÂ_Àn
(
oÊ_∑ckë_queue
 *
queue
);

742 
size_t


743 
oÊ_°ru˘s_m©ch_oÂ_Àn
(
oÊ_m©ch_hódî
 *
m©ch
, 
oÊ_exp
 *
exp
);

745 
size_t


746 
oÊ_°ru˘s_mëî_°©s_oÂ_tŸÆ_Àn
(
oÊ_mëî_°©s
 **
°©s
, 
size_t
 
°©s_num
);

748 
size_t


749 
oÊ_°ru˘s_mëî_°©s_oÂ_Àn
(
oÊ_mëî_°©s
 * 
°©s
);

751 
size_t


752 
oÊ_°ru˘s_∑ck_b™d_°©s
(
oÊ_mëî_b™d_°©s
 *
§c
, 
oÂ_mëî_b™d_°©s
 *
d°
);

754 
size_t


755 
oÊ_°ru˘s_mëî_c⁄f_oÂ_tŸÆ_Àn
(
oÊ_mëî_c⁄fig
 **
mëî_c⁄f
, 
size_t
 
°©s_num
);

757 
size_t


758 
oÊ_°ru˘s_mëî_c⁄f_oÂ_Àn
(
oÊ_mëî_c⁄fig
 * 
mëî_c⁄f
);

767 
oÊ_°ru˘s_p‹t_to_°rög
(
oÊ_p‹t
 *
p‹t
);

770 
oÊ_°ru˘s_p‹t_¥öt
(
FILE
 *
°ªam
, 
oÊ_p‹t
 *
p‹t
);

773 
oÊ_°ru˘s_ö°ru˘i⁄_to_°rög
(
oÊ_ö°ru˘i⁄_hódî
 *
ö°
, 
oÊ_exp
 *
exp
);

776 
oÊ_°ru˘s_ö°ru˘i⁄_¥öt
(
FILE
 *
°ªam
, 
oÊ_ö°ru˘i⁄_hódî
 *
ö°
, 
oÊ_exp
 *
exp
);

779 
oÊ_°ru˘s_m©ch_to_°rög
(
oÊ_m©ch_hódî
 *
m©ch
, 
oÊ_exp
 *
exp
);

782 
oÊ_°ru˘s_m©ch_¥öt
(
FILE
 *
°ªam
, 
oÊ_m©ch_hódî
 *
m©ch
, 
oÊ_exp
 *
exp
);

785 
oÊ_°ru˘s_oxm_év_to_°rög
(
oÊ_m©ch_év
 *
f
);

788 
oÊ_°ru˘s_oxm_év_¥öt
(
FILE
 *
°ªam
, 
oÊ_m©ch_év
 *
f
);

791 
oÊ_°ru˘s_oxm_m©ch_to_°rög
(
oÊ_m©ch
 *
m
);

794 
oÊ_°ru˘s_oxm_m©ch_¥öt
(
FILE
 *
°ªam
, c⁄° 
oÊ_m©ch
 *
omt
);

797 
oÊ_°ru˘s_c⁄fig_to_°rög
(
oÊ_c⁄fig
 *
c
);

800 
oÊ_°ru˘s_c⁄fig_¥öt
(
FILE
 *
°ªam
, 
oÊ_c⁄fig
 *
c
);

803 
oÊ_°ru˘s_buckë_to_°rög
(
oÊ_buckë
 *
b
, 
oÊ_exp
 *
exp
);

806 
oÊ_°ru˘s_buckë_¥öt
(
FILE
 *
°ªam
, 
oÊ_buckë
 *
b
, 
oÊ_exp
 *
exp
);

809 
oÊ_°ru˘s_queue_to_°rög
(
oÊ_∑ckë_queue
 *
q
);

812 
oÊ_°ru˘s_queue_¥öt
(
FILE
 *
°ªam
, 
oÊ_∑ckë_queue
 *
q
);

815 
oÊ_°ru˘s_queue_¥›_to_°rög
(
oÊ_queue_¥›_hódî
 *
p
);

818 
oÊ_°ru˘s_queue_¥›_¥öt
(
FILE
 *
°ªam
, 
oÊ_queue_¥›_hódî
 *
p
);

821 
oÊ_°ru˘s_Êow_°©s_to_°rög
(
oÊ_Êow_°©s
 *
s
, 
oÊ_exp
 *
exp
);

824 
oÊ_°ru˘s_Êow_°©s_¥öt
(
FILE
 *
°ªam
, 
oÊ_Êow_°©s
 *
s
, 
oÊ_exp
 *
exp
);

827 
oÊ_°ru˘s_buckë_cou¡î_to_°rög
(
oÊ_buckë_cou¡î
 *
s
);

830 
oÊ_°ru˘s_buckë_cou¡î_¥öt
(
FILE
 *
°ªam
, 
oÊ_buckë_cou¡î
 *
c
);

833 
oÊ_°ru˘s_group_°©s_to_°rög
(
oÊ_group_°©s
 *
s
);

836 
oÊ_°ru˘s_group_°©s_¥öt
(
FILE
 *
°ªam
, 
oÊ_group_°©s
 *
s
);

839 
oÊ_°ru˘s_èbÀ_°©s_to_°rög
(
oÊ_èbÀ_°©s
 *
s
);

842 
oÊ_°ru˘s_èbÀ_°©s_¥öt
(
FILE
 *
°ªam
, 
oÊ_èbÀ_°©s
 *
s
);

845 
oÊ_°ru˘s_èbÀ_¥›îtõs_to_°rög
(
oÊ_èbÀ_„©uª_¥›_hódî
 *
s
);

848 
oÊ_°ru˘s_èbÀ_¥›îtõs_¥öt
(
FILE
 * 
°ªam
, 
oÊ_èbÀ_„©uª_¥›_hódî
* 
s
);

851 
oÊ_°ru˘s_èbÀ_„©uªs_to_°rög
(
oÊ_èbÀ_„©uªs
 *
s
);

854 
oÊ_°ru˘s_èbÀ_„©uªs_¥öt
(
FILE
 *
°ªam
, 
oÊ_èbÀ_„©uªs
 *
s
);

857 
oÊ_°ru˘s_p‹t_°©s_to_°rög
(
oÊ_p‹t_°©s
 *
s
);

860 
oÊ_°ru˘s_p‹t_°©s_¥öt
(
FILE
 *
°ªam
, 
oÊ_p‹t_°©s
 *
s
);

863 
oÊ_°ru˘s_queue_°©s_to_°rög
(
oÊ_queue_°©s
 *
s
);

866 
oÊ_°ru˘s_queue_°©s_¥öt
(
FILE
 *
°ªam
, 
oÊ_queue_°©s
 *
s
);

869 
oÊ_°ru˘s_group_desc_°©s_to_°rög
(
oÊ_group_desc_°©s
 *
s
, 
oÊ_exp
 *
exp
);

872 
oÊ_°ru˘s_group_desc_°©s_¥öt
(
FILE
 *
°ªam
, 
oÊ_group_desc_°©s
 *
s
, 
oÊ_exp
 *
exp
);

875 
oÊ_°ru˘s_mëî_b™d_to_°rög
(
oÊ_mëî_b™d_hódî
* 
s
);

878 
oÊ_°ru˘s_mëî_b™d_¥öt
(
FILE
 *
°ªam
, 
oÊ_mëî_b™d_hódî
* 
s
);

881 
oÊ_°ru˘s_mëî_b™d_°©s_to_°rög
(
oÊ_mëî_b™d_°©s
* 
s
);

884 
oÊ_°ru˘s_mëî_b™d_°©s_¥öt
(
FILE
 *
°ªam
, 
oÊ_mëî_b™d_°©s
* 
s
);

887 
oÊ_°ru˘s_mëî_„©uªs_to_°rög
(
oÊ_mëî_„©uªs
* 
s
);

890 
oÊ_°ru˘s_mëî_„©uªs_¥öt
(
FILE
 *
°ªam
, 
oÊ_mëî_„©uªs
* 
s
);

893 
oÊ_°ru˘s_mëî_°©s_to_°rög
(
oÊ_mëî_°©s
 *
s
);

896 
oÊ_°ru˘s_mëî_°©s_¥öt
(
FILE
 *
°ªam
, 
oÊ_mëî_°©s
* 
s
);

899 
oÊ_°ru˘s_mëî_c⁄fig_to_°rög
(
oÊ_mëî_c⁄fig
* 
s
);

902 
oÊ_°ru˘s_mëî_c⁄fig_¥öt
(
FILE
 *
°ªam
, 
oÊ_mëî_c⁄fig
* 
s
);

905 
oÊ_°ru˘s_async_c⁄fig_to_°rög
(
oÊ_async_c⁄fig
 *
s
);

908 
oÊ_°ru˘s_async_c⁄fig_¥öt
(
FILE
 * 
°ªam
, 
oÊ_async_c⁄fig
 *
s
);

	@oflib/ofl-utils.h

32 #i‚de‡
OFL_UTILS_H


33 
	#OFL_UTILS_H
 1

	)

36 
	~<√töë/ö.h
>

42 
	#OFL_UTILS_FREE_ARR
(
ELEMS
, 
ELEM_NUM
) \

44 
size_t
 
_ôî
; \

45 
_ôî
=0; _ôî<
ELEM_NUM
; _iter++) { \

46 
	`‰ì
(
ELEMS
[
_ôî
]); \

48 
	`‰ì
(
ELEMS
); \

49 }

	)

54 
	#OFL_UTILS_FREE_ARR_FUN
(
ELEMS
, 
ELEM_NUM
, 
FREE_FUN
) \

56 
size_t
 
_ôî
; \

57 
_ôî
=0; _ôî<
ELEM_NUM
; _iter++) { \

58 
	`FREE_FUN
(
ELEMS
[
_ôî
]); \

60 
	`‰ì
(
ELEMS
); \

61 }

	)

63 
	#OFL_UTILS_FREE_ARR_FUN2
(
ELEMS
, 
ELEM_NUM
, 
FREE_FUN
, 
ARG2
) \

65 
size_t
 
_ôî
; \

66 
_ôî
=0; _ôî<
ELEM_NUM
; _iter++) { \

67 
	`FREE_FUN
(
ELEMS
[
_ôî
], 
ARG2
); \

69 
	`‰ì
(
ELEMS
); \

70 }

	)

77 
	#OFL_UTILS_SUM_ARR_FUN
(
RESULT
, 
ELEMS
, 
ELEM_NUM
, 
LEN_FUN
) \

79 
size_t
 
_ôî
, 
_ªt
; \

81 
_ªt
 = 0; \

82 
_ôî
=0; _ôî<
ELEM_NUM
; _iter++) { \

83 
_ªt
 +
	`LEN_FUN
(
ELEMS
[
_ôî
]); \

86 
RESULT
 = 
_ªt
; \

87 }

	)

90 
	#OFL_UTILS_SUM_ARR_FUN2
(
RESULT
, 
ELEMS
, 
ELEM_NUM
, 
LEN_FUN
, 
ARG2
) \

92 
size_t
 
_ôî
, 
_ªt
; \

94 
_ªt
 = 0; \

95 
_ôî
=0; _ôî<
ELEM_NUM
; _iter++) { \

96 
_ªt
 +
	`LEN_FUN
(
ELEMS
[
_ôî
], 
ARG2
); \

99 
RESULT
 = 
_ªt
; \

100 }

	)

103 
ölöe
 
uöt64_t


104 
	$ht⁄64
(
uöt64_t
 
n
) {

105 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


106  
n
;

108  (((
uöt64_t
)
	`ht⁄l
(
n
)) << 32) + htonl(n >> 32);

110 
	}
}

112 
ölöe
 
uöt64_t


113 
	$¡oh64
(
uöt64_t
 
n
) {

114 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


115  
n
;

117  (((
uöt64_t
)
	`¡ohl
(
n
)) << 32) +Çtohl(n >> 32);

119 
	}
}

	@oflib/ofl.h

32 #i‚de‡
OFL_H


33 
	#OFL_H
 1

	)

35 
	~<sys/ty≥s.h
>

37 
	~"../ö˛ude/›íÊow/›íÊow.h
"

39 
	goÊ_msg_ex≥rimíãr
;

40 
	goÊ_msg_mu…ù¨t_ªque°_hódî
;

41 
	goÊ_msg_mu…ù¨t_ª∂y_hódî
;

42 
	goÊ_a˘i⁄_hódî
;

43 
	goÊ_ö°ru˘i⁄_hódî
;

44 
	goÊ_m©ch_hódî
;

45 
	goÂ_a˘i⁄_hódî
;

46 
	goÂ_ö°ru˘i⁄
;

47 
	goÂ_mu…ù¨t_ª∂y
;

48 
	goÂ_m©ch
;

54 
uöt32_t
 
	toÊ_îr
;

84 
	soÊ_exp_a˘
 {

85 (*
	m∑ck
Ë(
oÊ_a˘i⁄_hódî
 *
	m§c
, 
oÂ_a˘i⁄_hódî
 *
	md°
);

86 
oÊ_îr
 (*
u≈ack
Ë(
oÂ_a˘i⁄_hódî
 *
	m§c
, 
size_t
 *
	mÀn
, 
oÊ_a˘i⁄_hódî
 **
	md°
);

87 (*
	m‰ì
Ë(
oÊ_a˘i⁄_hódî
 *
	ma˘
);

88 
size_t
 (*
oÂ_Àn
Ë(
oÊ_a˘i⁄_hódî
 *
	ma˘
);

89 *(*
	mto_°rög
Ë(
oÊ_a˘i⁄_hódî
 *
	ma˘
);

93 
	soÊ_exp_ö°
 {

94 (*
	m∑ck
Ë(
oÊ_ö°ru˘i⁄_hódî
 *
	m§c
, 
oÂ_ö°ru˘i⁄
 *
	md°
);

95 
oÊ_îr
 (*
u≈ack
Ë(
oÂ_ö°ru˘i⁄
 *
	m§c
, 
size_t
 *
	mÀn
, 
oÊ_ö°ru˘i⁄_hódî
 **
	md°
);

96 (*
	m‰ì
Ë(
oÊ_ö°ru˘i⁄_hódî
 *
	mi
);

97 
size_t
 (*
oÂ_Àn
Ë(
oÊ_ö°ru˘i⁄_hódî
 *
	mi
);

98 *(*
	mto_°rög
Ë(
oÊ_ö°ru˘i⁄_hódî
 *
	mi
);

102 
	soÊ_exp_m©ch
 {

103 (*
	m∑ck
Ë(
oÊ_m©ch_hódî
 *
	m§c
, 
oÂ_m©ch
 *
	md°
);

104 
oÊ_îr
 (*
u≈ack
Ë(
oÂ_m©ch
 *
	m§c
, 
size_t
 *
	mÀn
, 
oÊ_m©ch_hódî
 **
	md°
);

105 (*
	m‰ì
Ë(
oÊ_m©ch_hódî
 *
	mm
);

106 
size_t
 (*
oÂ_Àn
Ë(
oÊ_m©ch_hódî
 *
	mm
);

107 *(*
	mto_°rög
Ë(
oÊ_m©ch_hódî
 *
	mm
);

111 
	soÊ_exp_°©s
 {

112 (*
	mªq_∑ck
Ë(
oÊ_msg_mu…ù¨t_ªque°_hódî
 *
	mmsg
, 
uöt8_t
 **
	mbuf
, 
size_t
 *
	mbuf_Àn
);

113 
oÊ_îr
 (*
ªq_u≈ack
Ë(
oÂ_mu…ù¨t_ªque°
 *
	mos
, 
size_t
 *
	mÀn
, 
oÊ_msg_mu…ù¨t_ªque°_hódî
 **
	mmsg
);

114 (*
	mªq_‰ì
Ë(
oÊ_msg_mu…ù¨t_ªque°_hódî
 *
	mmsg
);

115 *(*
	mªq_to_°rög
Ë(
oÊ_msg_mu…ù¨t_ªque°_hódî
 *
	mmsg
);

116 (*
	mª∂y_∑ck
Ë(
oÊ_msg_mu…ù¨t_ª∂y_hódî
 *
	mmsg
, 
uöt8_t
 **
	mbuf
, 
size_t
 *
	mbuf_Àn
);

117 
oÊ_îr
 (*
ª∂y_u≈ack
Ë(
oÂ_mu…ù¨t_ª∂y
 *
	mos
, 
size_t
 *
	mÀn
, 
oÊ_msg_mu…ù¨t_ª∂y_hódî
 **
	mmsg
);

118 (*
	mª∂y_‰ì
Ë(
oÊ_msg_mu…ù¨t_ª∂y_hódî
 *
	mmsg
);

119 *(*
	mª∂y_to_°rög
Ë(
oÊ_msg_mu…ù¨t_ª∂y_hódî
 *
	mmsg
);

123 
	soÊ_exp_msg
 {

124 (*
	m∑ck
Ë(
oÊ_msg_ex≥rimíãr
 *
	mmsg
, 
uöt8_t
 **
	mbuf
, 
size_t
 *
	mbuf_Àn
);

125 
oÊ_îr
 (*
u≈ack
Ë(
oÂ_hódî
 *
	moh
, 
size_t
 *
	mÀn
, 
oÊ_msg_ex≥rimíãr
 **
	mmsg
);

126 (*
	m‰ì
Ë(
oÊ_msg_ex≥rimíãr
 *
	mmsg
);

127 *(*
	mto_°rög
Ë(
oÊ_msg_ex≥rimíãr
 *
	mmsg
);

131 
	soÊ_exp
 {

132 
oÊ_exp_a˘
 *
	ma˘
;

133 
oÊ_exp_ö°
 *
	mö°
;

134 
oÊ_exp_m©ch
 *
	mm©ch
;

135 
oÊ_exp_°©s
 *
	m°©s
;

136 
oÊ_exp_msg
 *
	mmsg
;

144 
	#OFL_ERROR
 0xffffffff

	)

147 
ölöe
 
oÊ_îr


148 
	$oÊ_îr‹
(
uöt16_t
 
ty≥
, uöt16_à
code
) {

150 
uöt32_t
 
ªt
 = 
ty≥
;

151  0x80000000 | 
ªt
 << 16 | 
code
;

152 
	}
}

155 
ölöe
 
uöt16_t


156 
	$oÊ_îr‹_ty≥
(
oÊ_îr
 
îr‹
) {

157  (0x7fff0000 & 
îr‹
) >> 16;

158 
	}
}

161 
ölöe
 
uöt16_t


162 
	$oÊ_îr‹_code
(
oÊ_îr
 
îr‹
) {

163  
îr‹
 & 0x0000ffff;

164 
	}
}

	@oflib/oxm-match.c

48 
	~"oxm-m©ch.h
"

50 
	~<√töë/icmp6.h
>

51 
	~"hm≠.h
"

52 
	~"hash.h
"

53 
	~"oÂ.h
"

54 
	~"oÂbuf.h
"

55 
	~"byã-‹dî.h
"

56 
	~"∑ckës.h
"

57 
	~"oÂbuf.h
"

58 
	~"oÊib/oÊ-°ru˘s.h
"

59 
	~"oÊib/oÊ-utûs.h
"

60 
	~"oÊib/oÊ-¥öt.h
"

61 
	~"u«lig√d.h
"

62 
	~"byã-‹dî.h
"

63 
	~"../ö˛ude/›íÊow/›íÊow.h
"

65 
	#LOG_MODULE
 
VLM_oxm_m©ch


	)

66 
	~"vlog.h
"

68 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(1, 5);

71 c⁄° 
uöt8_t
 
	gëh_Æl_0s
[
ETH_ADDR_LEN
]

73 c⁄° 
uöt8_t
 
	gëh_Æl_1s
[
ETH_ADDR_LEN
]

75 c⁄° 
uöt8_t
 
	gëh_mˇ°_1
[
ETH_ADDR_LEN
]

77 c⁄° 
uöt8_t
 
	gëh_mˇ°_0
[
ETH_ADDR_LEN
]

80 
oxm_fõld
 
	gÆl_fõlds
[
NUM_OXM_FIELDS
] = {

81 
	#DEFINE_FIELD
(
HEADER
, 
DL_TYPES
, 
NW_PROTO
, 
MASKABLE
) \

82 { 
HMAP_NODE_NULL_INITIALIZER
, 
OFI_OXM_
##
HEADER
, 
OXM_
##HEADER, \

83 
DL_CONVERT
 
DL_TYPES
, 
NW_PROTO
, 
MASKABLE
 },

	)

84 
	#DL_CONVERT
(
T1
, 
T2
Ë{ 
	`CONSTANT_HTONS
(T1), CONSTANT_HTONS(T2Ë}

	)

85 
	~"oxm-m©ch.def
"

89 
hm≠
 
	gÆl_oxm_fõlds
 = 
HMAP_INITIALIZER
(&
Æl_oxm_fõlds
);

92 
	$oxm_öô
()

94 i‡(
	`hm≠_is_em±y
(&
Æl_oxm_fõlds
)) {

95 
i
;

97 
i
 = 0; i < 
NUM_OXM_FIELDS
; i++) {

98 
oxm_fõld
 *
f
 = &
Æl_fõlds
[
i
];

99 
	`hm≠_ö£π
(&
Æl_oxm_fõlds
, &
f
->
hm≠_node
,

100 
	`hash_öt
(
f
->
hódî
, 0));

106 
	#DEFINE_FIELD
(
HEADER
, 
DL_TYPE
, 
NW_PROTO
, 
MASKABLE
) \

107 
OXM_
##
HEADER
: ;

	)

108 
	~"oxm-m©ch.def
"

111 
	}
}

113 
oxm_fõld
 *

114 
	$oxm_fõld_lookup
(
uöt32_t
 
hódî
)

116 
oxm_fõld
 *
f
;

118 
	`oxm_öô
();

119 
	`HMAP_FOR_EACH_WITH_HASH
(
f
, 
oxm_fõld
, 
hm≠_node
, 
	`hash_öt
(
hódî
, 0),

120 &
Æl_oxm_fõlds
) {

121 i‡(
f
->
hódî
 == header) {

122  
f
;

125  
NULL
;

126 
	}
}

129 
oÊ_m©ch_év
 *

130 
	$oxm_m©ch_lookup
(
uöt32_t
 
hódî
, c⁄° 
oÊ_m©ch
 *
omt
)

132 
oÊ_m©ch_év
 *
f
;

134 
	`HMAP_FOR_EACH_WITH_HASH
(
f
, 
oÊ_m©ch_év
, 
hm≠_node
, 
	`hash_öt
(
hódî
, 0),

135 &
omt
->
m©ch_fõlds
) {

136 i‡(
f
->
hódî
 == header) {

137  
f
;

140  
NULL
;

141 
	}
}

144 
boﬁ


145 
	$check_¥e£¡_¥îeq
(c⁄° 
oÊ_m©ch
 *
m©ch
, 
uöt32_t
 
hódî
){

147 
oÊ_m©ch_év
 *
omt
;

150 
	`HMAP_FOR_EACH_WITH_HASH
 (
omt
, 
oÊ_m©ch_év
, 
hm≠_node
, 
	`hash_öt
(
hódî
, 0),

151 &
m©ch
->
m©ch_fõlds
) {

152  
åue
;

154  
Ál£
;

155 
	}
}

157 
boﬁ


158 
	$oxm_¥îeqs_ok
(c⁄° 
oxm_fõld
 *
fõld
, c⁄° 
oÊ_m©ch
 *
ruÀ
)

161 
oÊ_m©ch_év
 *
omt
 = 
NULL
;

164 i‡(
fõld
->
hódî
 =
OXM_OF_IPV6_ND_SLL
 || fõld->hódî =
OXM_OF_IPV6_ND_TARGET
 ){

165 
boﬁ
 
found
 = 
Ál£
;

166 
	`HMAP_FOR_EACH_WITH_HASH
 (
omt
, 
oÊ_m©ch_év
, 
hm≠_node
, 
	`hash_öt
(
OXM_OF_ICMPV6_TYPE
, 0),

167 &
ruÀ
->
m©ch_fõlds
) {

168 i‡(*
omt
->
vÆue
 !
ICMPV6_NEIGHSOL
){

169  
Ál£
;

171 
found
 = 
åue
;

173 if(!
found
)

174  
Ál£
;

177 i‡(
fõld
->
hódî
 =
OXM_OF_IPV6_ND_TLL
 || fõld->hódî =
OXM_OF_IPV6_ND_TARGET
){

178 
boﬁ
 
found
 = 
Ál£
;

179 
	`HMAP_FOR_EACH_WITH_HASH
 (
omt
, 
oÊ_m©ch_év
, 
hm≠_node
, 
	`hash_öt
(
OXM_OF_ICMPV6_TYPE
, 0),

180 &
ruÀ
->
m©ch_fõlds
) {

181 i‡(*
omt
->
vÆue
 !
ICMPV6_NEIGHADV
){

182  
Ál£
;

184 
found
 = 
åue
;

186 if(!
found
)

187  
Ál£
;

191 i‡(
fõld
->
nw_¥Ÿo
){

192 
boﬁ
 
found
 = 
Ál£
;

193 
	`HMAP_FOR_EACH_WITH_HASH
 (
omt
, 
oÊ_m©ch_év
, 
hm≠_node
, 
	`hash_öt
(
OXM_OF_IP_PROTO
, 0),

194 &
ruÀ
->
m©ch_fõlds
) {

195 
uöt8_t
 
ù_¥Ÿo
;

196 
	`mem˝y
(&
ù_¥Ÿo
,
omt
->
vÆue
, (
uöt8_t
));

197 i‡(
fõld
->
nw_¥Ÿo
 !
ù_¥Ÿo
)

198  
Ál£
;

199 
found
 = 
åue
;

201 if(!
found
)

202  
Ál£
;

206 i‡(!
fõld
->
dl_ty≥
[0])

207  
åue
;

209 
	`HMAP_FOR_EACH_WITH_HASH
 (
omt
, 
oÊ_m©ch_év
, 
hm≠_node
, 
	`hash_öt
(
OXM_OF_ETH_TYPE
, 0),

210 &
ruÀ
->
m©ch_fõlds
) {

211 
uöt16_t
 
ëh_ty≥
;

212 
	`mem˝y
(&
ëh_ty≥
, 
omt
->
vÆue
, (
uöt16_t
));

213 i‡(
fõld
->
dl_ty≥
[0] =
	`ht⁄s
(
ëh_ty≥
)) {

214  
åue
;

215 } i‡(
fõld
->
dl_ty≥
[1] && fõld->dl_ty≥[1] =
	`ht⁄s
(
ëh_ty≥
)) {

216  
åue
;

221  
Ál£
;

222 
	}
}

224 
boﬁ


225 
	$check_oxm_dup
(
oÊ_m©ch
 *
m©ch
,c⁄° 
oxm_fõld
 *
om
){

227 
oÊ_m©ch_év
 *
t
;

228 
	`HMAP_FOR_EACH_WITH_HASH
(
t
, 
oÊ_m©ch_év
, 
hm≠_node
 ,
	`hash_öt
(
om
->
hódî
, 0),

229 &
m©ch
->
m©ch_fõlds
) {

230  
åue
;

232  
Ál£
;

234 
	}
}

236 
uöt8_t
* 
	$gë_oxm_vÆue
(
oÊ_m©ch
 *
m
, 
uöt32_t
 
hódî
){

238 
oÊ_m©ch_év
 *
t
;

239 
	`HMAP_FOR_EACH_WITH_HASH
 (
t
, 
oÊ_m©ch_év
, 
hm≠_node
, 
	`hash_öt
(
hódî
, 0),

240 &
m
->
m©ch_fõlds
) {

241  
t
->
vÆue
;

244  
NULL
;

245 
	}
}

248 
	$∑r£_oxm_íåy
(
oÊ_m©ch
 *
m©ch
, c⁄° 
oxm_fõld
 *
f
,

249 c⁄° *
vÆue
, c⁄° *
mask
){

251 
f
->
ödex
) {

252 
OFI_OXM_OF_IN_PORT
: {

253 
uöt32_t
* 
ö_p‹t
 = (uöt32_t*Ë
vÆue
;

254 
	`oÊ_°ru˘s_m©ch_put32
(
m©ch
, 
f
->
hódî
, 
	`¡ohl
(*
ö_p‹t
));

257 
OFI_OXM_OF_IN_PHY_PORT
:{

259 i‡(
	`check_¥e£¡_¥îeq
(
m©ch
,
OXM_OF_IN_PORT
))

260 
	`oÊ_°ru˘s_m©ch_put32
(
m©ch
, 
f
->
hódî
, 
	`¡ohl
(*((
uöt32_t
*Ë
vÆue
)));

261  
	`oÂ_mkîr
(
OFPET_BAD_MATCH
, 
OFPBMC_BAD_PREREQ
);

264 
OFI_OXM_OF_METADATA
:{

265 
	`oÊ_°ru˘s_m©ch_put64
(
m©ch
, 
f
->
hódî
, 
	`¡oh64
(*((
uöt64_t
*Ë
vÆue
)));

268 
OFI_OXM_OF_METADATA_W
:{

269 
	`oÊ_°ru˘s_m©ch_put64m
(
m©ch
, 
f
->
hódî
, 
	`¡oh64
(*((
uöt64_t
*Ë
vÆue
)),Çtoh64(*((uöt64_t*Ë
mask
)));

273 
OFI_OXM_OF_ETH_DST
:

274 
OFI_OXM_OF_ETH_SRC
:{

275 
	`oÊ_°ru˘s_m©ch_put_ëh
(
m©ch
, 
f
->
hódî
,(
uöt8_t
* )
vÆue
);

278 
OFI_OXM_OF_ETH_DST_W
:

279 
OFI_OXM_OF_ETH_SRC_W
:{

280 
	`oÊ_°ru˘s_m©ch_put_ëh_m
(
m©ch
, 
f
->
hódî
,(
uöt8_t
* )
vÆue
, (uöt8_t* )
mask
 );

283 
OFI_OXM_OF_ETH_TYPE
:{

284 
uöt16_t
* 
ëh_ty≥
 = (uöt16_t*Ë
vÆue
;

285 
	`oÊ_°ru˘s_m©ch_put16
(
m©ch
, 
f
->
hódî
, 
	`¡ohs
(*
ëh_ty≥
));

289 
OFI_OXM_OF_VLAN_VID
:{

290 
uöt16_t
* 
vœn_id
 = (uöt16_t*Ë
vÆue
;

291 i‡(
	`¡ohs
(*
vœn_id
)> 
OFPVID_PRESENT
+
VLAN_VID_MAX
){

292  
	`oÂ_mkîr
(
OFPET_BAD_MATCH
, 
OFPBMC_BAD_VALUE
);

295 
	`oÊ_°ru˘s_m©ch_put16
(
m©ch
, 
f
->
hódî
, 
	`¡ohs
(*
vœn_id
));

299 
OFI_OXM_OF_VLAN_VID_W
:{

300 
uöt16_t
* 
vœn_id
 = (uöt16_t*Ë
vÆue
;

301 
uöt16_t
* 
vœn_mask
 = (uöt16_t*Ë
mask
;

303 i‡(
	`¡ohs
(*
vœn_id
Ë> 
OFPVID_PRESENT
+
VLAN_VID_MAX
)

304  
	`oÂ_mkîr
(
OFPET_BAD_MATCH
, 
OFPBMC_BAD_VALUE
);

306 
	`oÊ_°ru˘s_m©ch_put16m
(
m©ch
, 
f
->
hódî
, 
	`¡ohs
(*
vœn_id
),Çtohs(*
vœn_mask
));

310 
OFI_OXM_OF_VLAN_PCP
:{

312 i‡(
	`check_¥e£¡_¥îeq
(
m©ch
,
OXM_OF_VLAN_VID
)){

313 
uöt8_t
 *
p
 = 
	`gë_oxm_vÆue
(
m©ch
,
OXM_OF_VLAN_VID
);

314 i‡(*(
uöt16_t
*Ë
p
 !
OFPVID_NONE
 ){

315 
uöt8_t
 *
v
 = (uöt8_t*Ë
vÆue
;

316 
	`oÊ_°ru˘s_m©ch_put8
(
m©ch
, 
f
->
hódî
, *
v
);

321  
	`oÂ_mkîr
(
OFPET_BAD_MATCH
, 
OFPBMC_BAD_PREREQ
);

324 
OFI_OXM_OF_IP_DSCP
:{

325 
uöt8_t
 *
v
 = (uöt8_t*Ë
vÆue
;

326 i‡(*
v
 & 0xc0) {

327  
	`oÂ_mkîr
(
OFPET_BAD_MATCH
, 
OFPBMC_BAD_VALUE
);

330 
	`oÊ_°ru˘s_m©ch_put8
(
m©ch
, 
f
->
hódî
, *
v
);

334 
OFI_OXM_OF_IP_ECN
:

335 
OFI_OXM_OF_IP_PROTO
:{

336 
uöt8_t
 *
v
 = (uöt8_t*Ë
vÆue
;

337 
	`oÊ_°ru˘s_m©ch_put8
(
m©ch
, 
f
->
hódî
, *
v
);

342 
OFI_OXM_OF_IPV4_SRC
:

343 
OFI_OXM_OF_IPV4_DST
:

344 
OFI_OXM_OF_ARP_TPA
:

345 
OFI_OXM_OF_ARP_SPA
:

346 
	`oÊ_°ru˘s_m©ch_put32
(
m©ch
, 
f
->
hódî
, *((
uöt32_t
*Ë
vÆue
));

348 
OFI_OXM_OF_IPV4_DST_W
:

349 
OFI_OXM_OF_IPV4_SRC_W
:

350 
OFI_OXM_OF_ARP_SPA_W
:

351 
OFI_OXM_OF_ARP_TPA_W
:

352 
	`oÊ_°ru˘s_m©ch_put32m
(
m©ch
, 
f
->
hódî
, *((
uöt32_t
*Ë
vÆue
), *((uöt32_t*Ë
mask
));

354 
OFI_OXM_OF_ARP_SHA
:

355 
OFI_OXM_OF_ARP_THA
:

356 
	`oÊ_°ru˘s_m©ch_put_ëh
(
m©ch
, 
f
->
hódî
,(
uöt8_t
* )
vÆue
);

359 
OFI_OXM_OF_ARP_SHA_W
:

360 
OFI_OXM_OF_ARP_THA_W
:

361 
	`oÊ_°ru˘s_m©ch_put_ëh_m
(
m©ch
, 
f
->
hódî
,(
uöt8_t
* )
vÆue
, (uöt8_t* )
mask
 );

365 
OFI_OXM_OF_IPV6_SRC
:

366 
OFI_OXM_OF_IPV6_DST
:{

367 
	`oÊ_°ru˘s_m©ch_put_ùv6
(
m©ch
, 
f
->
hódî
,(
uöt8_t
* ) 
vÆue
);

370 
OFI_OXM_OF_IPV6_SRC_W
:

371 
OFI_OXM_OF_IPV6_DST_W
:{

372 
	`oÊ_°ru˘s_m©ch_put_ùv6m
(
m©ch
, 
f
->
hódî
,(
uöt8_t
* ) 
vÆue
,(uöt8_t* ) 
mask
);

375 
OFI_OXM_OF_IPV6_FLABEL
:{

376 
	`oÊ_°ru˘s_m©ch_put32
(
m©ch
, 
f
->
hódî
, 
	`¡ohl
(*((
uöt32_t
*Ë
vÆue
)));

379 
OFI_OXM_OF_IPV6_FLABEL_W
:{

380 
	`oÊ_°ru˘s_m©ch_put32m
(
m©ch
, 
f
->
hódî
, 
	`¡ohl
(*((
uöt32_t
*Ë
vÆue
)),Çtohl(*((uöt32_t*Ë
mask
)));

384 
OFI_OXM_OF_TCP_SRC
:

385 
OFI_OXM_OF_TCP_DST
:

387 
OFI_OXM_OF_UDP_SRC
:

388 
OFI_OXM_OF_UDP_DST
:

390 
OFI_OXM_OF_SCTP_SRC
:

391 
OFI_OXM_OF_SCTP_DST
:

392 
	`oÊ_°ru˘s_m©ch_put16
(
m©ch
, 
f
->
hódî
, 
	`¡ohs
(*((
uöt16_t
*Ë
vÆue
)));

396 
OFI_OXM_OF_ICMPV4_TYPE
:

397 
OFI_OXM_OF_ICMPV4_CODE
:

399 
OFI_OXM_OF_ICMPV6_TYPE
:

400 
OFI_OXM_OF_ICMPV6_CODE
:{

401 
uöt8_t
 *
v
 = (uöt8_t*Ë
vÆue
;

402 
	`oÊ_°ru˘s_m©ch_put8
(
m©ch
, 
f
->
hódî
, *
v
);

406 
OFI_OXM_OF_IPV6_ND_TARGET
:

407 
	`oÊ_°ru˘s_m©ch_put_ùv6
(
m©ch
, 
f
->
hódî
,(
uöt8_t
* ) 
vÆue
);

409 
OFI_OXM_OF_IPV6_ND_SLL
:

410 
OFI_OXM_OF_IPV6_ND_TLL
:

411 
	`oÊ_°ru˘s_m©ch_put_ëh
(
m©ch
, 
f
->
hódî
,(
uöt8_t
* )
vÆue
);

414 
OFI_OXM_OF_ARP_OP
:{

415 
	`oÊ_°ru˘s_m©ch_put16
(
m©ch
, 
f
->
hódî
, 
	`¡ohs
(*((
uöt16_t
*Ë
vÆue
)));

418 
OFI_OXM_OF_MPLS_LABEL
:

419 
	`oÊ_°ru˘s_m©ch_put32
(
m©ch
, 
f
->
hódî
, 
	`¡ohl
(*((
uöt32_t
*Ë
vÆue
)));

421 
OFI_OXM_OF_MPLS_TC
:{

422 
uöt8_t
 *
v
 = (uöt8_t*Ë
vÆue
;

423 
	`oÊ_°ru˘s_m©ch_put8
(
m©ch
, 
f
->
hódî
, *
v
);

426 
OFI_OXM_OF_MPLS_BOS
:{

427 
uöt8_t
 *
v
 = (uöt8_t*Ë
vÆue
;

428 
	`oÊ_°ru˘s_m©ch_put8
(
m©ch
, 
f
->
hódî
, *
v
);

431 
OFI_OXM_OF_PBB_ISID
:

432 
	`oÊ_°ru˘s_m©ch_put32
(
m©ch
, 
f
->
hódî
, 
	`¡ohl
(*((
uöt32_t
*Ë
vÆue
)));

434 
OFI_OXM_OF_PBB_ISID_W
:

435 
	`oÊ_°ru˘s_m©ch_put32m
(
m©ch
, 
f
->
hódî
, 
	`¡ohl
(*((
uöt32_t
*Ë
vÆue
)),Çtohl(*((uöt32_t*Ë
mask
)));

437 
OFI_OXM_OF_TUNNEL_ID
:{

438 
	`oÊ_°ru˘s_m©ch_put64
(
m©ch
, 
f
->
hódî
, *((
uöt64_t
*Ë
vÆue
));

441 
OFI_OXM_OF_TUNNEL_ID_W
:{

442 
	`oÊ_°ru˘s_m©ch_put64m
(
m©ch
, 
f
->
hódî
,*((
uöt64_t
*Ë
vÆue
),*((uöt64_t*Ë
mask
));

445 
OFI_OXM_OF_IPV6_EXTHDR
:

446 
	`oÊ_°ru˘s_m©ch_put16
(
m©ch
, 
f
->
hódî
, 
	`¡ohs
(*((
uöt16_t
*Ë
vÆue
)));

448 
OFI_OXM_OF_IPV6_EXTHDR_W
:

449 
	`oÊ_°ru˘s_m©ch_put16m
(
m©ch
, 
f
->
hódî
, 
	`¡ohs
(*((
uöt16_t
*Ë
vÆue
)),¡ohs(*((uöt16_t*Ë
mask
)));

451 
NUM_OXM_FIELDS
:

452 
	`NOT_REACHED
();

454 
	`NOT_REACHED
();

455 
	}
}

465 
	$oxm_puŒ_m©ch
(
oÂbuf
 *
buf
, 
oÊ_m©ch
 * 
m©ch_d°
, 
m©ch_Àn
)

468 
uöt32_t
 
hódî
;

469 
uöt8_t
 *
p
;

470 
p
 = 
	`oÂbuf_åy_puŒ
(
buf
, 
m©ch_Àn
);

472 i‡(!
p
) {

473 
	`VLOG_DBG_RL
(
LOG_MODULE
,&
æ
, "oxm_matchÜength %u,Ñounded upÅoá "

475 "Àngth %d)", 
m©ch_Àn
, 
buf
->
size
);

477  
	`oÂ_mkîr
(
OFPET_BAD_MATCH
, 
OFPBRC_BAD_LEN
);

481 
	`oÊ_°ru˘s_m©ch_öô
(
m©ch_d°
);

483 (
hódî
 = 
	`oxm_íåy_ok
(
p
, 
m©ch_Àn
)) != 0) {

485 
Àngth
 = 
	`OXM_LENGTH
(
hódî
);

486 c⁄° 
oxm_fõld
 *
f
;

487 
îr‹
;

488 
f
 = 
	`oxm_fõld_lookup
(
hódî
);

490 i‡(!
f
) {

491 
îr‹
 = 
	`oÂ_mkîr
(
OFPET_BAD_MATCH
, 
OFPBMC_BAD_FIELD
);

493 i‡(
	`OXM_HASMASK
(
hódî
Ë&& !
f
->
maskabÀ
){

494 
îr‹
 = 
	`oÂ_mkîr
(
OFPET_BAD_MATCH
, 
OFPBMC_BAD_MASK
);

496 i‡(!
	`oxm_¥îeqs_ok
(
f
, 
m©ch_d°
)) {

497 
îr‹
 = 
	`oÂ_mkîr
(
OFPET_BAD_MATCH
, 
OFPBMC_BAD_PREREQ
);

499 i‡(
	`check_oxm_dup
(
m©ch_d°
,
f
)){

500 
îr‹
 = 
	`oÂ_mkîr
(
OFPET_BAD_MATCH
, 
OFPBMC_DUP_FIELD
);

506 
îr‹
 = 
	`∑r£_oxm_íåy
(
m©ch_d°
, 
f
, 
p
 + 4,Ö + 4 + 
Àngth
 / 2);

508 i‡(
îr‹
) {

509 
	`VLOG_DBG_RL
(
LOG_MODULE
,&
æ
, "bad oxm_íåy wôh víd‹=%"
PRIu32
", "

510 "fõld=%"
PRIu32
", hasmask=%"PRIu32",Åype=%"PRIu32" "

512 
	`OXM_VENDOR
(
hódî
), 
	`OXM_FIELD
(header),

513 
	`OXM_HASMASK
(
hódî
), 
	`OXM_TYPE
(header),

514 
îr‹
);

515  
îr‹
;

517 
p
 +4 + 
Àngth
;

518 
m©ch_Àn
 -4 + 
Àngth
;

520  
m©ch_Àn
 ? 
	`oÂ_mkîr
(
OFPET_BAD_MATCH
, 
OFPBMC_BAD_LEN
) : 0;

521 
	}
}

524 
uöt32_t


525 
	$oxm_íåy_ok
(c⁄° *
p
, 
m©ch_Àn
)

527 
∑ylﬂd_Àn
;

528 
uöt32_t
 
hódî
;

530 i‡(
m©ch_Àn
 <= 4) {

531 i‡(
m©ch_Àn
) {

532 
	`VLOG_DBG
(
LOG_MODULE
,"oxm_matchÉnds withÖartial oxm_header");

537 
	`mem˝y
(&
hódî
, 
p
, 4);

538 
hódî
 = 
	`¡ohl
(header);

539 
∑ylﬂd_Àn
 = 
	`OXM_LENGTH
(
hódî
);

540 i‡(!
∑ylﬂd_Àn
) {

541 
	`VLOG_DBG
(
LOG_MODULE
, "oxm_íåy %08"
PRIx32
" has invalidÖayload "

542 "Àngth 0", 
hódî
);

545 i‡(
m©ch_Àn
 < 
∑ylﬂd_Àn
 + 4) {

546 
	`VLOG_DBG
(
LOG_MODULE
, "%"
PRIu32
"-byte oxm_entry but only "

547 "%u byã†À· i¿ox_m©ch", 
∑ylﬂd_Àn
 + 4, 
m©ch_Àn
);

548 
	`VLOG_DBG
(
LOG_MODULE
, "Header == %d"

549 , 
	`OXM_FIELD
(
hódî
));

552  
hódî
;

553 
	}
}

563 
	$oxm_put_hódî
(
oÂbuf
 *
buf
, 
uöt32_t
 
hódî
)

565 
uöt32_t
 
n_hódî
 = 
	`ht⁄l
(
hódî
);

566 
	`oÂbuf_put
(
buf
, &
n_hódî
, Ç_header);

568 
	}
}

571 
	$oxm_put_8
(
oÂbuf
 *
buf
, 
uöt32_t
 
hódî
, 
uöt8_t
 
vÆue
)

573 
	`oxm_put_hódî
(
buf
, 
hódî
);

574 
	`oÂbuf_put
(
buf
, &
vÆue
,  value);

575 
	}
}

578 
	$oxm_put_8w
(
oÂbuf
 *
buf
, 
uöt32_t
 
hódî
, 
uöt8_t
 
vÆue
, 
uöt16_t
 
mask
){

580 
	`oxm_put_hódî
(
buf
, 
hódî
);

581 
	`oÂbuf_put
(
buf
, &
vÆue
,  value);

582 
	`oÂbuf_put
(
buf
, &
mask
,  mask);

584 
	}
}

587 
	$oxm_put_16
(
oÂbuf
 *
buf
, 
uöt32_t
 
hódî
, 
uöt16_t
 
vÆue
)

589 
	`oxm_put_hódî
(
buf
, 
hódî
);

590 
	`oÂbuf_put
(
buf
, &
vÆue
,  value);

591 
	}
}

594 
	$oxm_put_16w
(
oÂbuf
 *
buf
, 
uöt32_t
 
hódî
, 
uöt16_t
 
vÆue
, uöt16_à
mask
)

596 
	`oxm_put_hódî
(
buf
, 
hódî
);

597 
	`oÂbuf_put
(
buf
, &
vÆue
,  value);

598 
	`oÂbuf_put
(
buf
, &
mask
,  mask);

599 
	}
}

602 
	$oxm_put_32
(
oÂbuf
 *
buf
, 
uöt32_t
 
hódî
, uöt32_à
vÆue
)

604 
	`oxm_put_hódî
(
buf
, 
hódî
);

605 
	`oÂbuf_put
(
buf
, &
vÆue
,  value);

606 
	}
}

609 
	$oxm_put_32w
(
oÂbuf
 *
buf
, 
uöt32_t
 
hódî
, uöt32_à
vÆue
, uöt32_à
mask
)

611 
	`oxm_put_hódî
(
buf
, 
hódî
);

612 
	`oÂbuf_put
(
buf
, &
vÆue
,  value);

613 
	`oÂbuf_put
(
buf
, &
mask
,  mask);

614 
	}
}

617 
	$oxm_put_64
(
oÂbuf
 *
buf
, 
uöt32_t
 
hódî
, 
uöt64_t
 
vÆue
)

619 
	`oxm_put_hódî
(
buf
, 
hódî
);

620 
	`oÂbuf_put
(
buf
, &
vÆue
,  value);

621 
	}
}

624 
	$oxm_put_64w
(
oÂbuf
 *
buf
, 
uöt32_t
 
hódî
, 
uöt64_t
 
vÆue
, uöt64_à
mask
)

626 
	`oxm_put_hódî
(
buf
, 
hódî
);

627 
	`oÂbuf_put
(
buf
, &
vÆue
,  value);

628 
	`oÂbuf_put
(
buf
, &
mask
,  mask);

629 
	}
}

632 
	$oxm_put_ëh
(
oÂbuf
 *
buf
, 
uöt32_t
 
hódî
,

633 c⁄° 
uöt8_t
 
vÆue
[
ETH_ADDR_LEN
])

635 
	`oxm_put_hódî
(
buf
, 
hódî
);

636 
	`oÂbuf_put
(
buf
, 
vÆue
, 
ETH_ADDR_LEN
);

638 
	}
}

641 
	$oxm_put_ëhm
(
oÂbuf
 *
buf
, 
uöt32_t
 
hódî
,

642 c⁄° 
uöt8_t
 
vÆue
[
ETH_ADDR_LEN
], c⁄° uöt8_à
mask
[ETH_ADDR_LEN])

644 
	`oxm_put_hódî
(
buf
, 
hódî
);

645 
	`oÂbuf_put
(
buf
, 
vÆue
, 
ETH_ADDR_LEN
);

646 
	`oÂbuf_put
(
buf
, 
mask
, 
ETH_ADDR_LEN
);

647 
	}
}

649 
	$oxm_put_ùv6
(
oÂbuf
 *
buf
, 
uöt32_t
 
hódî
,

650 
uöt8_t
 
vÆue
[
IPv6_ADDR_LEN
]){

651 
	`oxm_put_hódî
(
buf
, 
hódî
);

652 
	`oÂbuf_put
(
buf
, 
vÆue
, 
IPv6_ADDR_LEN
);

653 
	}
}

655 
	$oxm_put_ùv6m
(
oÂbuf
 *
buf
, 
uöt32_t
 
hódî
,

656 
uöt8_t
 
vÆue
[
ETH_ADDR_LEN
], uöt8_à
mask
[ETH_ADDR_LEN]){

657 
	`oxm_put_hódî
(
buf
, 
hódî
);

658 
	`oÂbuf_put
(
buf
, 
vÆue
, 
IPv6_ADDR_LEN
);

659 
	`oÂbuf_put
(
buf
, 
mask
, 
IPv6_ADDR_LEN
);

660 
	}
}

686 
boﬁ


687 
	$is_ªquisôe
(
uöt32_t
 
hódî
){

688 if(
hódî
 =
OXM_OF_IN_PORT
 || hódî =
OXM_OF_ETH_TYPE


689 || 
hódî
 =
OXM_OF_VLAN_VID
 || hódî =
OXM_OF_IP_PROTO
) {

690  
åue
;

692  
Ál£
;

693 
	}
}

696 
	$oxm_put_m©ch
(
oÂbuf
 *
buf
, 
oÊ_m©ch
 *
omt
){

698 
oÊ_m©ch_év
 *
o·
;

699 
°¨t_Àn
 = 
buf
->
size
;

700 
m©ch_Àn
;

705 
	`HMAP_FOR_EACH_WITH_HASH
(
o·
, 
oÊ_m©ch_év
, 
hm≠_node
, 
	`hash_öt
(
OXM_OF_IN_PORT
, 0),

706 &
omt
->
m©ch_fõlds
) {

707 
uöt32_t
 
vÆue
;

708 
	`mem˝y
(&
vÆue
, 
o·
->vÆue,(
uöt32_t
));

709 
	`oxm_put_32
(
buf
,
o·
->
hódî
, 
	`ht⁄l
(
vÆue
));

715 
	`HMAP_FOR_EACH_WITH_HASH
(
o·
, 
oÊ_m©ch_év
, 
hm≠_node
, 
	`hash_öt
(
OXM_OF_ETH_TYPE
, 0),

716 &
omt
->
m©ch_fõlds
) {

717 
uöt16_t
 
vÆue
;

718 
	`mem˝y
(&
vÆue
, 
o·
->vÆue,(
uöt16_t
));

719 
	`oxm_put_16
(
buf
,
o·
->
hódî
, 
	`ht⁄s
(
vÆue
));

723 
	`HMAP_FOR_EACH_WITH_HASH
(
o·
, 
oÊ_m©ch_év
, 
hm≠_node
, 
	`hash_öt
(
OXM_OF_VLAN_VID
, 0),

724 &
omt
->
m©ch_fõlds
) {

725 
uöt16_t
 
vÆue
;

726 
	`mem˝y
(&
vÆue
, 
o·
->vÆue,(
uöt16_t
));

727 
	`oxm_put_16
(
buf
,
o·
->
hódî
, 
	`ht⁄s
(
vÆue
));

731 
	`HMAP_FOR_EACH_WITH_HASH
(
o·
, 
oÊ_m©ch_év
, 
hm≠_node
, 
	`hash_öt
(
OXM_OF_IP_PROTO
, 0),

732 &
omt
->
m©ch_fõlds
) {

733 
uöt8_t
 
vÆue
;

734 
	`mem˝y
(&
vÆue
, 
o·
->vÆue,(
uöt8_t
));

735 
	`oxm_put_8
(
buf
,
o·
->
hódî
, 
vÆue
);

739 
	`HMAP_FOR_EACH
(
o·
, 
oÊ_m©ch_év
, 
hm≠_node
, &
omt
->
m©ch_fõlds
){

741 i‡(
	`is_ªquisôe
(
o·
->
hódî
))

745 
uöt8_t
 
Àngth
 = 
	`OXM_LENGTH
(
o·
->
hódî
) ;

746 
boﬁ
 
has_mask
 =
Ál£
;

747 i‡(
	`OXM_HASMASK
(
o·
->
hódî
)){

748 
Àngth
 =Üength / 2;

749 
has_mask
 = 
åue
;

751 
Àngth
){

752 ((
uöt8_t
)):{

753 
uöt8_t
 
vÆue
;

754 
	`mem˝y
(&
vÆue
, 
o·
->vÆue,(
uöt8_t
));

755 if(!
has_mask
)

756 
	`oxm_put_8
(
buf
,
o·
->
hódî
, 
vÆue
);

758 
uöt8_t
 
mask
;

759 
	`mem˝y
(&
mask
,
o·
->
vÆue
 + 
Àngth
 ,(
uöt8_t
));

760 
	`oxm_put_8w
(
buf
, 
o·
->
hódî
,
vÆue
,
mask
);

764 ((
uöt16_t
)):{

765 
uöt16_t
 
vÆue
;

766 
	`mem˝y
(&
vÆue
, 
o·
->vÆue,(
uöt16_t
));

767 if(!
has_mask
)

768 
	`oxm_put_16
(
buf
,
o·
->
hódî
, 
	`ht⁄s
(
vÆue
));

770 
uöt16_t
 
mask
;

771 
	`mem˝y
(&
mask
,
o·
->
vÆue
 + 
Àngth
 ,(
uöt16_t
));

772 
	`oxm_put_16w
(
buf
, 
o·
->
hódî
,
	`ht⁄s
(
vÆue
),ht⁄s(
mask
));

776 ((
uöt32_t
)):{

777 
uöt32_t
 
vÆue
;

778 
	`mem˝y
(&
vÆue
, 
o·
->vÆue,(
uöt32_t
));

779 if(!
has_mask
)

780 i‡(
o·
->
hódî
 =
OXM_OF_IPV4_DST
 || o·->hódî =
OXM_OF_IPV4_SRC


781 ||
o·
->
hódî
 =
OXM_OF_ARP_SPA
 || o·->hódî =
OXM_OF_ARP_TPA
)

782 
	`oxm_put_32
(
buf
,
o·
->
hódî
, 
vÆue
);

784 
	`oxm_put_32
(
buf
,
o·
->
hódî
, 
	`ht⁄l
(
vÆue
));

786 
uöt32_t
 
mask
;

787 
	`mem˝y
(&
mask
,
o·
->
vÆue
 + 
Àngth
 ,(
uöt32_t
));

788 i‡(
o·
->
hódî
 =
OXM_OF_IPV4_DST_W
|| o·->hódî =
OXM_OF_IPV4_SRC_W


789 ||
o·
->
hódî
 =
OXM_OF_ARP_SPA_W
 || o·->hódî =
OXM_OF_ARP_TPA_W
){

790 
	`oxm_put_32w
(
buf
, 
o·
->
hódî
, 
vÆue
, 
mask
);

793 
	`oxm_put_32w
(
buf
, 
o·
->
hódî
, 
	`ht⁄l
(
vÆue
),ht⁄l(
mask
));

799 ((
uöt64_t
)):{

800 
uöt64_t
 
vÆue
;

801 
	`mem˝y
(&
vÆue
, 
o·
->vÆue,(
uöt64_t
));

802 if(!
has_mask
)

803 
	`oxm_put_64
(
buf
,
o·
->
hódî
, 
	`ht⁄64
(
vÆue
));

805 
uöt64_t
 
mask
;

806 
	`mem˝y
(&
mask
,
o·
->
vÆue
 + 
Àngth
 ,(
uöt64_t
));

807 
	`oxm_put_64w
(
buf
, 
o·
->
hódî
,
	`ht⁄64
(
vÆue
),ht⁄64(
mask
));

811 (
ETH_ADDR_LEN
):{

812 
uöt8_t
 
vÆue
[
ETH_ADDR_LEN
];

813 
	`mem˝y
(&
vÆue
, 
o·
->vÆue,
ETH_ADDR_LEN
);

814 if(!
has_mask
)

815 
	`oxm_put_ëh
(
buf
,
o·
->
hódî
, 
vÆue
);

817 
uöt8_t
 
mask
[
ETH_ADDR_LEN
];

818 
	`mem˝y
(&
mask
,
o·
->
vÆue
 + 
Àngth
 ,
ETH_ADDR_LEN
);

819 
	`oxm_put_ëhm
(
buf
, 
o·
->
hódî
,
vÆue
,
mask
);

823 (
IPv6_ADDR_LEN
):{

824 
uöt8_t
 
vÆue
[
IPv6_ADDR_LEN
];

825 
	`mem˝y
(
vÆue
, 
o·
->vÆue,
IPv6_ADDR_LEN
);

826 if(!
has_mask
)

827 
	`oxm_put_ùv6
(
buf
,
o·
->
hódî
, 
vÆue
);

829 
uöt8_t
 
mask
[
IPv6_ADDR_LEN
];

830 
	`mem˝y
(&
mask
,
o·
->
vÆue
 + 
Àngth
 ,
IPv6_ADDR_LEN
);

831 
	`oxm_put_ùv6m
(
buf
, 
o·
->
hódî
,
vÆue
,
mask
);

839 
m©ch_Àn
 = 
buf
->
size
 - 
°¨t_Àn
;

840 
	`oÂbuf_put_zîos
(
buf
, 
	`ROUND_UP
(
m©ch_Àn
 - 4, 8) - (match_len -4));

841  
m©ch_Àn
;

842 
	}
}

	@oflib/oxm-match.h

46 #i‚de‡
OX_MATCH_H


47 
	#OX_MATCH_H
 1

	)

49 
	~<°döt.h
>

50 
	~<sys/ty≥s.h
>

51 
	~<√töë/ö.h
>

52 
	~"oÂbuf.h
"

53 
	~"hm≠.h
"

54 
	~"∑ckës.h
"

55 
	~"../oÊib/oÊ-°ru˘s.h
"

57 
	#OXM_HEADER__
(
VENDOR
, 
FIELD
, 
HASMASK
, 
LENGTH
) \

58 (((
VENDOR
Ë<< 16Ë| ((
FIELD
Ë<< 9Ë| ((
HASMASK
Ë<< 8Ë| (
LENGTH
))

	)

59 
	#OXM_HEADER
(
VENDOR
, 
FIELD
, 
LENGTH
) \

60 
	`OXM_HEADER__
(
VENDOR
, 
FIELD
, 0, 
LENGTH
)

	)

61 
	#OXM_HEADER_W
(
VENDOR
, 
FIELD
, 
LENGTH
) \

62 
	`OXM_HEADER__
(
VENDOR
, 
FIELD
, 1, (
LENGTH
Ë* 2)

	)

64 
	#OXM_HEADER_VL
(
VENDOR
,
FIELD
) \

65 
	`OXM_HEADER__
(
VENDOR
,
FIELD
,0,0)

	)

67 
	#OXM_HEADER_VL_W
(
VENDOR
,
FIELD
) \

68 
	`OXM_HEADER__
(
VENDOR
,
FIELD
,1,0)

	)

70 
	#OXM_VENDOR
(
HEADER
Ë((HEADERË>> 16)

	)

71 
	#OXM_FIELD
(
HEADER
Ë(((HEADERË>> 9Ë& 0x7f)

	)

72 
	#OXM_TYPE
(
HEADER
Ë(((HEADERË>> 9Ë& 0x7fffff)

	)

73 
	#OXM_HASMASK
(
HEADER
Ë(((HEADERË>> 8Ë& 1)

	)

74 
	#OXM_LENGTH
(
HEADER
Ë((HEADERË& 0xff)

	)

75 
	#VENDOR_FROM_TYPE
(
TYPE
Ë((TYPEË>> 7)

	)

76 
	#FIELD_FROM_TYPE
(
TYPE
Ë((TYPEË& 0x7f)

	)

78 
	#OXM_MAKE_WILD_HEADER
(
HEADER
) \

79 
	`OXM_HEADER_W
(
	`OXM_VENDOR
(
HEADER
), 
	`OXM_FIELD
(HEADER), 
	`OXM_LENGTH
(HEADER))

	)

90 
	#OXM_OF_IN_PORT
 
	`OXM_HEADER
 (0x8000, 0, 4)

	)

98 
	#OXM_OF_IN_PHY_PORT
 
	`OXM_HEADER
 (0x8000, 1, 4)

	)

101 
	#OXM_OF_METADATA
 
	`OXM_HEADER
 (0x8000, 2, 8)

	)

102 
	#OXM_OF_METADATA_W
 
	`OXM_HEADER_W
 (0x8000, 2, 8)

	)

105 
	#OXM_OF_ETH_DST
 
	`OXM_HEADER
 (0x8000,3,6)

	)

106 
	#OXM_OF_ETH_DST_W
 
	`OXM_HEADER_W
(0x8000,3,6)

	)

109 
	#OXM_OF_ETH_SRC
 
	`OXM_HEADER
 (0x8000, 4,6)

	)

110 
	#OXM_OF_ETH_SRC_W
 
	`OXM_HEADER_W
(0x8000,4,6)

	)

113 
	#OXM_OF_ETH_TYPE
 
	`OXM_HEADER
 (0x8000, 5, 2)

	)

116 
	#OXM_OF_VLAN_VID
 
	`OXM_HEADER
 (0x8000, 6, 2)

	)

117 
	#OXM_OF_VLAN_VID_W
 
	`OXM_HEADER_W
 (0x8000, 6, 2)

	)

120 
	#OXM_OF_VLAN_PCP
 
	`OXM_HEADER
 (0x8000, 7, 1)

	)

124 
	#OXM_OF_IP_DSCP
 
	`OXM_HEADER
 (0x8000, 8, 1)

	)

127 
	#OXM_OF_IP_ECN
 
	`OXM_HEADER
 (0x8000, 9, 1)

	)

130 
	#OXM_OF_IP_PROTO
 
	`OXM_HEADER
 (0x8000, 10, 1)

	)

133 
	#OXM_OF_IPV4_SRC
 
	`OXM_HEADER
 (0x8000,11, 4)

	)

134 
	#OXM_OF_IPV4_SRC_W
 
	`OXM_HEADER_W
 (0x8000,11, 4)

	)

137 
	#OXM_OF_IPV4_DST
 
	`OXM_HEADER
 (0x8000,12 , 4)

	)

138 
	#OXM_OF_IPV4_DST_W
 
	`OXM_HEADER_W
 (0x8000,12 , 4)

	)

141 
	#OXM_OF_TCP_SRC
 
	`OXM_HEADER
 (0x8000, 13, 2)

	)

144 
	#OXM_OF_TCP_DST
 
	`OXM_HEADER
 (0x8000, 14, 2)

	)

147 
	#OXM_OF_UDP_SRC
 
	`OXM_HEADER
 (0x8000, 15, 2)

	)

150 
	#OXM_OF_UDP_DST
 
	`OXM_HEADER
 (0x8000, 16, 2)

	)

153 
	#OXM_OF_SCTP_SRC
 
	`OXM_HEADER
 (0x8000, 17, 2)

	)

156 
	#OXM_OF_SCTP_DST
 
	`OXM_HEADER
 (0x8000, 18, 2)

	)

159 
	#OXM_OF_ICMPV4_TYPE
 
	`OXM_HEADER
 (0x8000, 19, 1)

	)

162 
	#OXM_OF_ICMPV4_CODE
 
	`OXM_HEADER
 (0x8000, 20, 1)

	)

165 
	#OXM_OF_ARP_OP
 
	`OXM_HEADER
 (0x8000,21, 2)

	)

168 
	#OXM_OF_ARP_SPA
 
	`OXM_HEADER
 (0x8000,22, 4)

	)

169 
	#OXM_OF_ARP_SPA_W
 
	`OXM_HEADER_W
 (0x8000,22, 4)

	)

172 
	#OXM_OF_ARP_TPA
 
	`OXM_HEADER
 (0x8000,23 , 4)

	)

173 
	#OXM_OF_ARP_TPA_W
 
	`OXM_HEADER_W
 (0x8000,23 , 4)

	)

176 
	#OXM_OF_ARP_SHA
 
	`OXM_HEADER
 (0x8000,24,6)

	)

177 
	#OXM_OF_ARP_SHA_W
 
	`OXM_HEADER_W
(0x8000,24,6)

	)

180 
	#OXM_OF_ARP_THA
 
	`OXM_HEADER
 (0x8000, 25,6)

	)

181 
	#OXM_OF_ARP_THA_W
 
	`OXM_HEADER_W
(0x8000,25,6)

	)

184 
	#OXM_OF_IPV6_SRC
 
	`OXM_HEADER
 (0x8000, 26, 16)

	)

185 
	#OXM_OF_IPV6_SRC_W
 
	`OXM_HEADER_W
(0x8000, 26, 16)

	)

188 
	#OXM_OF_IPV6_DST
 
	`OXM_HEADER
 (0x8000, 27, 16)

	)

189 
	#OXM_OF_IPV6_DST_W
 
	`OXM_HEADER_W
(0x8000, 27, 16)

	)

192 
	#OXM_OF_IPV6_FLABEL
 
	`OXM_HEADER
 (0x8000, 28, 4)

	)

193 
	#OXM_OF_IPV6_FLABEL_W
 
	`OXM_HEADER_W
 (0x8000, 28, 4)

	)

196 
	#OXM_OF_ICMPV6_TYPE
 
	`OXM_HEADER
 (0x8000, 29, 1)

	)

199 
	#OXM_OF_ICMPV6_CODE
 
	`OXM_HEADER
 (0x8000, 30, 1)

	)

202 
	#OXM_OF_IPV6_ND_TARGET
 
	`OXM_HEADER
 (0x8000, 31, 16)

	)

205 
	#OXM_OF_IPV6_ND_SLL
 
	`OXM_HEADER
 (0x8000, 32, 6)

	)

208 
	#OXM_OF_IPV6_ND_TLL
 
	`OXM_HEADER
 (0x8000, 33, 6)

	)

211 
	#OXM_OF_MPLS_LABEL
 
	`OXM_HEADER
 (0x8000, 34, 4)

	)

214 
	#OXM_OF_MPLS_TC
 
	`OXM_HEADER
 (0x8000, 35, 1)

	)

216 
	#OXM_OF_MPLS_BOS
 
	`OXM_HEADER
 (0x8000, 36, 1)

	)

218 
	#OXM_OF_PBB_ISID
 
	`OXM_HEADER
 (0x8000, 37, 4)

	)

219 
	#OXM_OF_PBB_ISID_W
 
	`OXM_HEADER_W
 (0x8000, 37, 4)

	)

221 
	#OXM_OF_TUNNEL_ID
 
	`OXM_HEADER
 (0x8000, 38, 8)

	)

222 
	#OXM_OF_TUNNEL_ID_W
 
	`OXM_HEADER_W
 (0x8000, 38, 8)

	)

224 
	#OXM_OF_IPV6_EXTHDR
 
	`OXM_HEADER
 (0x8000, 39, 2)

	)

225 
	#OXM_OF_IPV6_EXTHDR_W
 
	`OXM_HEADER_W
 (0x8000, 39, 2)

	)

233 
	#OXM_OF_IPV6_TC
 
	`OXM_HEADER
 (0x0002, 5, 1)

	)

234 
	#OXM_OF_IPV6_TC_W
 
	`OXM_HEADER_W
 (0x0002, 5, 1)

	)

237 
	#OXM_OF_IPV6_HBH_ID
 
	`OXM_HEADER
 (0x0002, 8, 1)

	)

238 
	#OXM_OF_IPV6_HBH_ID_W
 
	`OXM_HEADER_W
 (0x0002, 8, 1)

	)

240 
	#OXM_OF_IPV6_HBH_OPT_CODE
 
	`OXM_HEADER
 (0x0002, 9, 1)

	)

242 
	#OXM_OF_IPV6_HBH_OPT_VALUE
 
	`OXM_HEADER_VL
 (0x0002, 10)

	)

245 
	#OXM_OF_IPV6_DOH_ID
 
	`OXM_HEADER
 (0x0002, 16, 1)

	)

246 
	#OXM_OF_IPV6_DOH_ID_W
 
	`OXM_HEADER_W
 (0x0002, 16, 1)

	)

248 
	#OXM_OF_IPV6_DOH_OPT_CODE
 
	`OXM_HEADER
 (0x0002, 17, 1)

	)

250 
	#OXM_OF_IPV6_DOH_OPT_VALUE
 
	`OXM_HEADER_VL
 (0x0002, 18)

	)

254 
	#OXM_OF_IPV6_RH_ID
 
	`OXM_HEADER
 (0x0002, 24, 1)

	)

255 
	#OXM_OF_IPV6_RH_ID_W
 
	`OXM_HEADER_W
 (0x0002, 24, 1)

	)

257 
	#OXM_OF_IPV6_RH_ADDRESS
 
	`OXM_HEADER
 (0x0002, 25, 16)

	)

260 
	#OXM_OF_IPV6_FH_ID
 
	`OXM_HEADER
 (0x0002, 32, 1)

	)

261 
	#OXM_OF_IPV6_FH_ID_W
 
	`OXM_HEADER_W
 (0x0002, 32, 1)

	)

264 
	#OXM_OF_IPV6_AH_ID
 
	`OXM_HEADER
 (0x0002, 40, 1)

	)

265 
	#OXM_OF_IPV6_AH_ID_W
 
	`OXM_HEADER_W
 (0x0002, 40, 1)

	)

268 
	#OXM_OF_IPV6_ESP_ID
 
	`OXM_HEADER
 (0x0002, 48, 1)

	)

271 
	#OXM_OF_IPV6_MH_ID
 
	`OXM_HEADER
 (0x0002, 56, 1)

	)

278 
	#OXM_OF_MPLS_TTL
 
	`OXM_HEADER
 (0x0002, 80, 4)

	)

281 
	#OXM_OF_IPV4_TTL
 
	`OXM_HEADER
 (0x0002, 81, 1)

	)

283 
	eoxm_fõld_ödex
 {

284 
	#DEFINE_FIELD
(
HEADER
,
DL_TYPES
, 
NW_PROTO
, 
MASKABLE
) \

285 
OFI_OXM_
##
HEADER
,

	)

286 
	~"oxm-m©ch.def
"

287 
	mNUM_OXM_FIELDS
 = 56

290 
	soxm_fõld
 {

291 
hm≠_node
 
	mhm≠_node
;

292 
oxm_fõld_ödex
 
	mödex
;

293 
uöt32_t
 
	mhódî
;

294 
uöt16_t
 
	mdl_ty≥
[
N_OXM_DL_TYPES
];

295 
uöt8_t
 
	mnw_¥Ÿo
;

296 
boﬁ
 
	mmaskabÀ
;

300 
oxm_fõld
 
Æl_fõlds
[
NUM_OXM_FIELDS
];

302 
oxm_fõld
 *

303 
oxm_fõld_lookup
(
uöt32_t
 
hódî
);

305 
boﬁ


306 
oxm_¥îeqs_ok
(c⁄° 
oxm_fõld
 *
fõld
, c⁄° 
oÊ_m©ch
 *
ruÀ
);

309 
oxm_puŒ_m©ch
(
oÂbuf
 * 
buf
, 
oÊ_m©ch
 *
m©ch_d°
, 
m©ch_Àn
);

311 
oxm_put_m©ch
(
oÂbuf
 *
buf
, 
oÊ_m©ch
 *
omt
);

313 
oÊ_m©ch_év
 *

314 
oxm_m©ch_lookup
(
uöt32_t
 
hódî
, c⁄° 
oÊ_m©ch
 *
omt
);

316 
uöt32_t
 
oxm_íåy_ok
(const *, );

319 
oxm_fõld_byãs
(
uöt32_t
 
hódî
);

322 
oxm_fõld_bôs
(
uöt32_t
 
hódî
);

	@secchan/discovery.c

34 
	~<c⁄fig.h
>

35 
	~"discovîy.h
"

36 
	~<öây≥s.h
>

37 
	~<°dlib.h
>

38 
	~<°rög.h
>

39 
	~"dh˝-˛õ¡.h
"

40 
	~"dh˝.h
"

41 
	~"√tdev.h
"

42 
	~"›íÊow/›íÊow.h
"

43 
	~"∑ckës.h
"

44 
	~"p‹t-w©chî.h
"

45 
	~"£cch™.h
"

46 
	~"°©us.h
"

48 
	~"vlog.h
"

50 
	#LOG_MODULE
 
VLM_discovîy


	)

52 
	sdiscovîy


54 c⁄° 
£âögs
 *
	ms
;

55 
dh˛õ¡
 *
	mdh˝
;

56 
	mn_ch™ges
;

59 
modify_dh˝_ªque°
(
dh˝_msg
 *, *
aux
);

60 
boﬁ
 
vÆid©e_dh˝_of„r
(c⁄° 
dh˝_msg
 *, *
aux
);

62 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(60, 60);

65 
	$discovîy_°©us_cb
(
°©us_ª∂y
 *
§
, *
d_
)

67 
discovîy
 *
d
 = 
d_
;

69 
	`°©us_ª∂y_put
(
§
, "ac˚±-ªmŸe=%s", 
d
->
s
->
ac˚±_c⁄åﬁÀr_ª
);

70 
	`°©us_ª∂y_put
(
§
, "n-ch™ges=%d", 
d
->
n_ch™ges
);

71 i‡(
d
->
dh˝
) {

72 
	`°©us_ª∂y_put
(
§
, "°©e=%s", 
	`dh˛õ¡_gë_°©e
(
d
->
dh˝
));

73 
	`°©us_ª∂y_put
(
§
, "state-elapsed=%u",

74 
	`dh˛õ¡_gë_°©e_ñ≠£d
(
d
->
dh˝
));

75 i‡(
	`dh˛õ¡_is_bound
(
d
->
dh˝
)) {

76 
uöt32_t
 
ù
 = 
	`dh˛õ¡_gë_ù
(
d
->
dh˝
);

77 
uöt32_t
 
√tmask
 = 
	`dh˛õ¡_gë_√tmask
(
d
->
dh˝
);

78 
uöt32_t
 
rouãr
 = 
	`dh˛õ¡_gë_rouãr
(
d
->
dh˝
);

80 c⁄° 
dh˝_msg
 *
cfg
 = 
	`dh˛õ¡_gë_c⁄fig
(
d
->
dh˝
);

81 
uöt32_t
 
dns_£rvî
;

82 *
domaö_«me
;

83 
i
;

85 
	`°©us_ª∂y_put
(
§
, "ù="
IP_FMT
, 
	`IP_ARGS
(&
ù
));

86 
	`°©us_ª∂y_put
(
§
, "√tmask="
IP_FMT
, 
	`IP_ARGS
(&
√tmask
));

87 i‡(
rouãr
) {

88 
	`°©us_ª∂y_put
(
§
, "rouãr="
IP_FMT
, 
	`IP_ARGS
(&
rouãr
));

91 
i
 = 0; 
	`dh˝_msg_gë_ù
(
cfg
, 
DHCP_CODE_DNS_SERVER
, i,

92 &
dns_£rvî
);

93 
i
++) {

94 
	`°©us_ª∂y_put
(
§
, "dns%d="
IP_FMT
, 
i
, 
	`IP_ARGS
(&
dns_£rvî
));

97 
domaö_«me
 = 
	`dh˝_msg_gë_°rög
(
cfg
, 
DHCP_CODE_DOMAIN_NAME
);

98 i‡(
domaö_«me
) {

99 
	`°©us_ª∂y_put
(
§
, "domaö=%s", 
domaö_«me
);

100 
	`‰ì
(
domaö_«me
);

103 
	`°©us_ª∂y_put
(
§
, "lease-remaining=%u",

104 
	`dh˛õ¡_gë_Àa£_ªmaöög
(
d
->
dh˝
));

107 
	}
}

110 
	$discovîy_loˇl_p‹t_cb
(c⁄° 
oÂ_p‹t
 *
p‹t
, *
d_
)

112 
discovîy
 *
d
 = 
d_
;

113 i‡(
p‹t
) {

114 
«me
[
OFP_MAX_PORT_NAME_LEN
 + 1];

115 
√tdev
 *netdev;

116 
ªtvÆ
;

119 
	`gë_p‹t_«me
(
p‹t
, 
«me
, Çame);

120 i‡(
d
->
dh˝
 && !
	`°rcmp
(
	`√tdev_gë_«me
(
	`dh˛õ¡_gë_√tdev
(d->dhcp)),

121 
«me
)) {

126 
	`dh˛õ¡_de°roy
(
d
->
dh˝
);

127 
d
->
dh˝
 = 
NULL
;

130 
ªtvÆ
 = 
	`√tdev_›í
(
«me
, 
NETDEV_ETH_TYPE_NONE
, &
√tdev
);

131 i‡(
ªtvÆ
) {

132 
	`VLOG_ERR
(
LOG_MODULE
, "CouldÇot open %s device, discovery disabled: %s",

133 
«me
, 
	`°ªº‹
(
ªtvÆ
));

136 
ªtvÆ
 = 
	`√tdev_tu∫_Êags_⁄
(
√tdev
, 
NETDEV_UP
, 
åue
);

137 i‡(
ªtvÆ
) {

138 
	`VLOG_ERR
(
LOG_MODULE
, "CouldÇot bring %s device up, discovery disabled: %s",

139 
«me
, 
	`°ªº‹
(
ªtvÆ
));

142 
	`√tdev_˛o£
(
√tdev
);

145 
ªtvÆ
 = 
	`dh˛õ¡_¸óã
(
«me
, 
modify_dh˝_ªque°
,

146 
vÆid©e_dh˝_of„r
, (*Ë
d
->
s
, &d->
dh˝
);

147 i‡(
ªtvÆ
) {

148 
	`VLOG_ERR
(
LOG_MODULE
, "FailedÅo initialize DHCP client, "

149 "discovîy dißbÀd: %s", 
	`°ªº‹
(
ªtvÆ
));

152 
	`dh˛õ¡_£t_max_timeout
(
d
->
dh˝
, 3);

153 
	`dh˛õ¡_öô
(
d
->
dh˝
, 0);

155 
	`dh˛õ¡_de°roy
(
d
->
dh˝
);

156 
d
->
dh˝
 = 
NULL
;

158 
	}
}

161 
discovîy
 *

162 
	$discovîy_öô
(c⁄° 
£âögs
 *
s
, 
p‹t_w©chî
 *
pw
,

163 
swôch_°©us
 *
ss
)

165 
discovîy
 *
d
;

167 
d
 = 
	`xmÆloc
( *d);

168 
d
->
s
 = s;

169 
d
->
dh˝
 = 
NULL
;

170 
d
->
n_ch™ges
 = 0;

172 
	`swôch_°©us_ªgi°î_ˇãg‹y
(
ss
, "discovîy", 
discovîy_°©us_cb
, 
d
);

173 
	`p‹t_w©chî_ªgi°î_loˇl_p‹t_ˇŒback
(
pw
, 
discovîy_loˇl_p‹t_cb
, 
d
);

175  
d
;

176 
	}
}

179 
	$discovîy_que°i⁄_c⁄√˘ivôy
(
discovîy
 *
d
)

181 i‡(
d
->
dh˝
) {

182 
	`dh˛õ¡_f‹˚_ª√w
(
d
->
dh˝
, 15);

184 
	}
}

186 
boﬁ


187 
	$discovîy_run
(
discovîy
 *
d
, **
c⁄åﬁÀr_«me
)

189 i‡(!
d
->
dh˝
) {

190 *
c⁄åﬁÀr_«me
 = 
NULL
;

191  
åue
;

194 
	`dh˛õ¡_run
(
d
->
dh˝
);

195 i‡(!
	`dh˛õ¡_ch™ged
(
d
->
dh˝
)) {

196  
Ál£
;

199 
	`dh˛õ¡_c⁄figuª_√tdev
(
d
->
dh˝
);

200 i‡(
d
->
s
->
upd©e_ªsﬁv_c⁄f
) {

201 
	`dh˛õ¡_upd©e_ªsﬁv_c⁄f
(
d
->
dh˝
);

204 i‡(
	`dh˛õ¡_is_bound
(
d
->
dh˝
)) {

205 *
c⁄åﬁÀr_«me
 = 
	`dh˝_msg_gë_°rög
(
	`dh˛õ¡_gë_c⁄fig
(
d
->
dh˝
),

206 
DHCP_CODE_OFP_CONTROLLER_VCONN
);

207 
	`VLOG_INFO
(
LOG_MODULE
, "%s: discovîed c⁄åﬁÀr", *
c⁄åﬁÀr_«me
);

208 
d
->
n_ch™ges
++;

210 *
c⁄åﬁÀr_«me
 = 
NULL
;

211 i‡(
d
->
n_ch™ges
) {

212 
	`VLOG_INFO
(
LOG_MODULE
, "discovered controllerÇoÜongerávailable");

213 
d
->
n_ch™ges
++;

216  
åue
;

217 
	}
}

220 
	$discovîy_waô
(
discovîy
 *
d
)

222 i‡(
d
->
dh˝
) {

223 
	`dh˛õ¡_waô
(
d
->
dh˝
);

225 
	}
}

228 
	$modify_dh˝_ªque°
(
dh˝_msg
 *
msg
, *
aux
 
UNUSED
)

230 
	`dh˝_msg_put_°rög
(
msg
, 
DHCP_CODE_VENDOR_CLASS
, "OpenFlow");

231 
	}
}

233 
boﬁ


234 
	$vÆid©e_dh˝_of„r
(c⁄° 
dh˝_msg
 *
msg
, *
s_
)

236 c⁄° 
£âögs
 *
s
 = 
s_
;

237 *
vc⁄n_«me
;

238 
boﬁ
 
ac˚±
;

240 
vc⁄n_«me
 = 
	`dh˝_msg_gë_°rög
(
msg
, 
DHCP_CODE_OFP_CONTROLLER_VCONN
);

241 i‡(!
vc⁄n_«me
) {

242 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "rejecting DHCP offer missing controller vconn");

243  
Ál£
;

245 
ac˚±
 = !
	`ªgexec
(&
s
->
ac˚±_c⁄åﬁÀr_ªgex
, 
vc⁄n_«me
, 0, 
NULL
, 0);

246 i‡(!
ac˚±
) {

247 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "rejecting controller vconnÅhat failsÅo match %s",

248 
s
->
ac˚±_c⁄åﬁÀr_ª
);

250 
	`‰ì
(
vc⁄n_«me
);

251  
ac˚±
;

252 
	}
}

	@secchan/discovery.h

34 #i‚de‡
DISCOVERY_H


35 
	#DISCOVERY_H
 1

	)

37 
	~<°dboﬁ.h
>

39 
	g£âögs
;

40 
	gp‹t_w©chî
;

41 
	gswôch_°©us
;

43 
discovîy
 *
discovîy_öô
(c⁄° 
£âögs
 *,

44 
p‹t_w©chî
 *,

45 
swôch_°©us
 *);

46 
discovîy_que°i⁄_c⁄√˘ivôy
(
discovîy
 *);

47 
boﬁ
 
discovîy_run
(
discovîy
 *, **
c⁄åﬁÀr_«me
);

48 
discovîy_waô
(
discovîy
 *);

	@secchan/failover.c

33 
	~<c⁄fig.h
>

34 
	~<°dlib.h
>

35 
	~<°ddef.h
>

36 
	~<°rög.h
>

38 
	~"utû.h
"

39 
	~"rc⁄n.h
"

40 
	~"£cch™.h
"

41 
	~"°©us.h
"

42 
	~"timevÆ.h
"

43 
	~"ßt-m©h.h
"

44 
	~"Áûovî.h
"

45 
	~"vlog.h
"

47 
	#LOG_MODULE
 
VLM_Áûovî


	)

49 
	sÁûovî_≥î
 {

50 
time_t
 
	mïoch
;

53 
	sÁûovî_c⁄ãxt
 {

54 c⁄° 
£âögs
 *
	m£âögs
;

55 c⁄° 
£cch™
 *
	m£cch™
;

56 
rc⁄n
 *
	mªmŸe_rc⁄n
;

57 
	mödex
;

58 
Áûovî_≥î
 *
	m≥îs
[
MAX_CONTROLLERS
];

61 
Áûovî_°©us_cb
(
°©us_ª∂y
 *, *);

62 
boﬁ
 
is_timed_out
(c⁄° 
Áûovî_≥î
 *, );

63 
Áûovî_≥riodic_cb
(*);

66 
	$Áûovî_°©us_cb
(
°©us_ª∂y
 *°©us_ª∂y, *
c⁄ãxt_
)

68 
Áûovî_c⁄ãxt
 *
c⁄ãxt
 = 
c⁄ãxt_
;

69 
i
;

71 
	`°©us_ª∂y_put
(
°©us_ª∂y
, "num-controllers=%d",

72 
c⁄ãxt
->
£âögs
->
num_c⁄åﬁÀrs
);

74 
i
 = 0; i < 
MAX_CONTROLLERS
; ++i) {

75 i‡(
c⁄ãxt
->
£âögs
->
c⁄åﬁÀr_«mes
[
i
] =
NULL
)

77 
	`°©us_ª∂y_put
(
°©us_ª∂y
, "controller#%d=%s",

78 
i
, 
c⁄ãxt
->
£âögs
->
c⁄åﬁÀr_«mes
[i]);

80 
	}
}

82 
boﬁ


83 
	$is_timed_out
(c⁄° 
Áûovî_≥î
 *
≥î
, 
max_backoff
)

85 
ßt_vÆue
 = 
	`ßt_add
(
≥î
->
ïoch
, 
max_backoff
);

86  
	`time_now
(Ë>
ßt_vÆue
;

87 
	}
}

90 
	$Áûovî_≥riodic_cb
(*
c⁄ãxt_
)

92 
Áûovî_c⁄ãxt
 *
c⁄ãxt
 = 
c⁄ãxt_
;

93 *
cuº_≥î
 = 
NULL
;

94 *
¥ev_≥î
 = 
NULL
;

96 i‡(
	`rc⁄n_is_c⁄√˘ed
(
c⁄ãxt
->
ªmŸe_rc⁄n
))

99 i‡(!
	`is_timed_out
(
c⁄ãxt
->
≥îs
[c⁄ãxt->
ödex
],

100 
c⁄ãxt
->
£âögs
->
max_backoff
)) {

104 
	`rc⁄n_disc⁄√˘
(
c⁄ãxt
->
ªmŸe_rc⁄n
);

105 
¥ev_≥î
 = (*)
c⁄ãxt
->
£âögs
->
c⁄åﬁÀr_«mes
[c⁄ãxt->
ödex
];

106 
c⁄ãxt
->
ödex
 = (context->index + 1)

107 % 
c⁄ãxt
->
£âögs
->
num_c⁄åﬁÀrs
;

108 
cuº_≥î
 = (*)
c⁄ãxt
->
£âögs
->
c⁄åﬁÀr_«mes
[c⁄ãxt->
ödex
];

109 
	`rc⁄n_c⁄√˘
(
c⁄ãxt
->
ªmŸe_rc⁄n
,

110 
c⁄ãxt
->
£âögs
->
c⁄åﬁÀr_«mes
[c⁄ãxt->
ödex
]);

111 
c⁄ãxt
->
≥îs
[c⁄ãxt->
ödex
]->
ïoch
 = 
	`time_now
();

112 
	`VLOG_INFO
(
LOG_MODULE
, "Swôchög ovîÅÿ%s, from %s", 
cuº_≥î
, 
¥ev_≥î
);

113 
	}
}

116 
	$Áûovî_°¨t
(
£cch™
 *£cch™, c⁄° 
£âögs
 *settings,

117 
swôch_°©us
 *swôch_°©us, 
rc⁄n
 *
ªmŸe_rc⁄n
)

119 
Áûovî_c⁄ãxt
 *
c⁄ãxt
 = 
NULL
;

120 
i
;

121 
hook_˛ass
 
Áûovî_hook_˛ass
 = {

122 
NULL
,

123 
NULL
,

124 
Áûovî_≥riodic_cb
,

125 
NULL
,

126 
NULL
,

129 
c⁄ãxt
 = 
	`xmÆloc
((*context));

130 
c⁄ãxt
->
£âögs
 = settings;

131 
c⁄ãxt
->
£cch™
 = secchan;

132 
c⁄ãxt
->
ªmŸe_rc⁄n
 =Ñemote_rconn;

133 
c⁄ãxt
->
ödex
 = 0;

134 
i
 = 0; i < 
MAX_CONTROLLERS
; ++i) {

135 
c⁄ãxt
->
≥îs
[
i
] = 
NULL
;

136 i‡(
£âögs
->
c⁄åﬁÀr_«mes
[
i
] =
NULL
)

138 
c⁄ãxt
->
≥îs
[
i
] = 
	`xmÆloc
((
Áûovî_≥î
));

139 
c⁄ãxt
->
≥îs
[
i
]->
ïoch
 = 
	`time_now
();

142 
	`swôch_°©us_ªgi°î_ˇãg‹y
(
swôch_°©us
, "failover",

143 
Áûovî_°©us_cb
, 
c⁄ãxt
);

144 
	`add_hook
(
£cch™
, &
Áûovî_hook_˛ass
, 
c⁄ãxt
);

145 
	}
}

	@secchan/failover.h

33 #i‚de‡
FAILOVER_H_


34 
	#FAILOVER_H_
 1

	)

36 
	grc⁄n
;

37 
	g£cch™
;

38 
	g£âögs
;

39 
	gswôch_°©us
;

41 
Áûovî_°¨t
(
£cch™
 *, c⁄° 
£âögs
 *,

42 
swôch_°©us
 *, 
rc⁄n
 *);

	@secchan/in-band.c

34 
	~<c⁄fig.h
>

35 
	~"ö-b™d.h
"

36 
	~<¨∑/öë.h
>

37 
	~<î∫o.h
>

38 
	~<öây≥s.h
>

39 
	~<°rög.h
>

40 
	~"Êow.h
"

41 
	~"mac-À¨nög.h
"

42 
	~"√tdev.h
"

43 
	~"oÂ.h
"

44 
	~"oÂbuf.h
"

45 
	~"›íÊow/›íÊow.h
"

46 
	~"∑ckës.h
"

47 
	~"p‹t-w©chî.h
"

48 
	~"rc⁄n.h
"

49 
	~"£cch™.h
"

50 
	~"°©us.h
"

51 
	~"timevÆ.h
"

52 
	~"vlog.h
"

54 
	#LOG_MODULE
 
VLM_ö_b™d


	)

56 
	sö_b™d_d©a
 {

57 c⁄° 
£âögs
 *
	ms
;

58 
mac_À¨nög
 *
	mml
;

59 
√tdev
 *
	mof_devi˚
;

60 
rc⁄n
 *
	mc⁄åﬁÀr
;

61 
	mn_queued
;

64 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(60, 60);

67 
	$queue_tx
(
rc⁄n
 *
rc
, 
ö_b™d_d©a
 *
ö_b™d
, 
oÂbuf
 *
b
)

69 
	`rc⁄n_£nd_wôh_limô
(
rc
, 
b
, &
ö_b™d
->
n_queued
, 10);

70 
	}
}

72 c⁄° 
uöt8_t
 *

73 
	$gë_c⁄åﬁÀr_mac
(
ö_b™d_d©a
 *
ö_b™d
)

75 
uöt32_t
 
ù
, 
œ°_n⁄zîo_ù
;

76 
uöt8_t
 
mac
[
ETH_ADDR_LEN
], 
œ°_n⁄zîo_mac
[ETH_ADDR_LEN];

77 
time_t
 
√xt_ª‰esh
 = 0;

79 
uöt32_t
 
œ°_ù
 = 
ù
;

81 
time_t
 
now
 = 
	`time_now
();

83 
ù
 = 
	`rc⁄n_gë_ù
(
ö_b™d
->
c⁄åﬁÀr
);

84 i‡(
œ°_ù
 !
ù
 || !
√xt_ª‰esh
 || 
now
 >=Çext_refresh) {

85 
boﬁ
 
have_mac
;

88 
	`mem£t
(
mac
, 0,  mac);

89 i‡(
ù
 && 
ö_b™d
->
of_devi˚
) {

90 
ªtvÆ
 = 
	`√tdev_¨p_lookup
(
ö_b™d
->
of_devi˚
, 
ù
, 
mac
);

91 i‡(
ªtvÆ
) {

92 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "cannotÜook up controller hwáddress "

93 "("
IP_FMT
"): %s", 
	`IP_ARGS
(&
ù
), 
	`°ªº‹
(
ªtvÆ
));

96 
have_mac
 = !
	`ëh_addr_is_zîo
(
mac
);

99 i‡(
ù
 && i∞!
œ°_n⁄zîo_ù
) {

100 
	`VLOG_DBG
(
LOG_MODULE
, "c⁄åﬁÀ∏IPáddªs†ch™ged from "
IP_FMT


101 "Åÿ"
IP_FMT
, 
	`IP_ARGS
(&
œ°_n⁄zîo_ù
), IP_ARGS(&
ù
));

102 
œ°_n⁄zîo_ù
 = 
ù
;

104 i‡(
have_mac
 && 
	`memcmp
(
œ°_n⁄zîo_mac
, 
mac
, 
ETH_ADDR_LEN
)) {

105 
	`VLOG_DBG
(
LOG_MODULE
, "c⁄åﬁÀ∏MACáddªs†ch™ged from "
ETH_ADDR_FMT
"Åo "

106 
ETH_ADDR_FMT
,

107 
	`ETH_ADDR_ARGS
(
œ°_n⁄zîo_mac
), ETH_ADDR_ARGS(
mac
));

108 
	`mem˝y
(
œ°_n⁄zîo_mac
, 
mac
, 
ETH_ADDR_LEN
);

116 
√xt_ª‰esh
 = 
now
 + (!
ù
 || 
have_mac
 ? 10 : 1);

118  !
	`ëh_addr_is_zîo
(
mac
Ë? ma¯: 
NULL
;

119 
	}
}

121 
boﬁ


122 
	$is_c⁄åﬁÀr_mac
(c⁄° 
uöt8_t
 
dl_addr
[
ETH_ADDR_LEN
],

123 
ö_b™d_d©a
 *
ö_b™d
)

125 c⁄° 
uöt8_t
 *
mac
 = 
	`gë_c⁄åﬁÀr_mac
(
ö_b™d
);

126  
mac
 && 
	`ëh_addr_equÆs
(mac, 
dl_addr
);

127 
	}
}

130 
	$ö_b™d_À¨n_mac
(
ö_b™d_d©a
 *
ö_b™d
,

131 
uöt16_t
 
ö_p‹t
, c⁄° 
uöt8_t
 
§c_mac
[
ETH_ADDR_LEN
])

133 i‡(
	`mac_À¨nög_À¨n
(
ö_b™d
->
ml
, 
§c_mac
, 0, 
ö_p‹t
)) {

134 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "À¨√dÅh© "
ETH_ADDR_FMT
" i†⁄Ö‹à%"
PRIu16
,

135 
	`ETH_ADDR_ARGS
(
§c_mac
), 
ö_p‹t
);

137 
	}
}

139 
boﬁ


140 
	$ö_b™d_loˇl_∑ckë_cb
(
ªœy
 *
r
, *
ö_b™d_
)

142 
ö_b™d_d©a
 *
ö_b™d
 = 
ö_b™d_
;

143 
rc⁄n
 *
rc
 = 
r
->
hÆves
[
HALF_LOCAL
].rconn;

144 
oÂ_∑ckë_ö
 *
›i
;

145 
ëh_hódî
 *
ëh
;

146 
oÂbuf
 
∑ylﬂd
;

147 
Êow
 flow;

148 
uöt16_t
 
ö_p‹t
;

149 
out_p‹t
;

151 i‡(!
	`gë_oÂ_∑ckë_ëh_hódî
(
r
, &
›i
, &
ëh
Ë|| !
ö_b™d
->
of_devi˚
) {

152  
Ál£
;

155 
ö_p‹t
 = 0;

157 
	`gë_oÂ_∑ckë_∑ylﬂd
(
›i
, &
∑ylﬂd
);

158 
	`Êow_exåa˘
(&
∑ylﬂd
, 
ö_p‹t
, &
Êow
);

160 i‡(
ö_p‹t
 =
OFPP_LOCAL
) {

162 
out_p‹t
 = 
	`mac_À¨nög_lookup
(
ö_b™d
->
ml
, 
ëh
->
ëh_d°
, 0);

163 } i‡(
	`ëh_addr_equÆs
(
ëh
->
ëh_d°
,

164 
	`√tdev_gë_ëhîaddr
(
ö_b™d
->
of_devi˚
))) {

166 
out_p‹t
 = 
OFPP_LOCAL
;

167 
	`ö_b™d_À¨n_mac
(
ö_b™d
, 
ö_p‹t
, 
ëh
->
ëh_§c
);

168 } i‡(
ëh
->
ëh_ty≥
 =
	`ht⁄s
(
ETH_TYPE_ARP
)

169 && 
	`ëh_addr_is_brﬂdˇ°
(
ëh
->
ëh_d°
)

170 && 
	`is_c⁄åﬁÀr_mac
(
ëh
->
ëh_§c
, 
ö_b™d
)) {

172 
out_p‹t
 = 
OFPP_FLOOD
;

173 } i‡((
	`is_c⁄åﬁÀr_mac
(
ëh
->
ëh_d°
, 
ö_b™d
)

174 || 
	`is_c⁄åﬁÀr_mac
(
ëh
->
ëh_§c
, 
ö_b™d
))

175 && 
Êow
.
dl_ty≥
 =
	`ht⁄s
(
ETH_TYPE_IP
)

176 && 
Êow
.
nw_¥Ÿo
 =
IP_TYPE_TCP


177 && (
Êow
.
ç_§c
 =
	`ht⁄s
(
OFP_TCP_PORT
)

178 || 
Êow
.
ç_§c
 =
	`ht⁄s
(
OFP_SSL_PORT
)

179 || 
Êow
.
ç_d°
 =
	`ht⁄s
(
OFP_TCP_PORT
)

180 || 
Êow
.
ç_d°
 =
	`ht⁄s
(
OFP_SSL_PORT
))) {

182 
	`ö_b™d_À¨n_mac
(
ö_b™d
, 
ö_p‹t
, 
ëh
->
ëh_§c
);

183 
out_p‹t
 = 
	`mac_À¨nög_lookup
(
ö_b™d
->
ml
, 
ëh
->
ëh_d°
, 0);

185 c⁄° 
uöt8_t
 *
c⁄åﬁÀr_mac
;

186 
c⁄åﬁÀr_mac
 = 
	`gë_c⁄åﬁÀr_mac
(
ö_b™d
);

187 i‡(
ëh
->
ëh_ty≥
 =
	`ht⁄s
(
ETH_TYPE_ARP
)

188 && 
	`ëh_addr_is_brﬂdˇ°
(
ëh
->
ëh_d°
)

189 && 
	`is_c⁄åﬁÀr_mac
(
ëh
->
ëh_§c
, 
ö_b™d
)) {

191 
out_p‹t
 = 
OFPP_FLOOD
;

192 } i‡(
	`is_c⁄åﬁÀr_mac
(
ëh
->
ëh_d°
, 
ö_b™d
)

193 && 
ö_p‹t
 =
	`mac_À¨nög_lookup
(
ö_b™d
->
ml
,

194 
c⁄åﬁÀr_mac
, 0)) {

196 
out_p‹t
 = -1;

198  
Ál£
;

202 i‡(
ö_p‹t
 =
out_p‹t
) {

204 
	`queue_tx
(
rc
, 
ö_b™d
, 
	`make_add_Êow
(&
Êow
, 
	`¡ohl
(
›i
->
buf„r_id
), 0x00,

205 
ö_b™d
->
s
->
max_idÀ
, 0));

206 } i‡(
out_p‹t
 !
OFPP_FLOOD
) {

208 
	`queue_tx
(
rc
, 
ö_b™d
,

209 
	`make_add_sim∂e_Êow
(&
Êow
, 
	`¡ohl
(
›i
->
buf„r_id
),

210 
out_p‹t
, 
ö_b™d
->
s
->
max_idÀ
));

213 i‡(
	`¡ohl
(
›i
->
buf„r_id
Ë=
UINT32_MAX
) {

214 
	`queue_tx
(
rc
, 
ö_b™d
,

215 
	`make_unbuf„ªd_∑ckë_out
(&
∑ylﬂd
, 
ö_p‹t
, 
out_p‹t
));

220 
oÂbuf
 *
b
;

221 i‡(
	`¡ohl
(
›i
->
buf„r_id
Ë=
UINT32_MAX
) {

222 
b
 = 
	`make_unbuf„ªd_∑ckë_out
(&
∑ylﬂd
, 
ö_p‹t
, 
out_p‹t
);

224 
b
 = 
	`make_buf„ªd_∑ckë_out
(
	`¡ohl
(
›i
->
buf„r_id
),

225 
ö_p‹t
, 
out_p‹t
);

227 
	`queue_tx
(
rc
, 
ö_b™d
, 
b
);

229  
åue
;

230 
	}
}

233 
	$ö_b™d_°©us_cb
(
°©us_ª∂y
 *
§
, *
ö_b™d_
)

235 
ö_b™d_d©a
 *
ö_b™d
 = 
ö_b™d_
;

236 
ö_addr
 
loˇl_ù
;

237 
uöt32_t
 
c⁄åﬁÀr_ù
;

238 c⁄° 
uöt8_t
 *
c⁄åﬁÀr_mac
;

240 i‡(
ö_b™d
->
of_devi˚
) {

241 c⁄° 
uöt8_t
 *
mac
 = 
	`√tdev_gë_ëhîaddr
(
ö_b™d
->
of_devi˚
);

242 i‡(
	`√tdev_gë_ö4
(
ö_b™d
->
of_devi˚
, &
loˇl_ù
)) {

243 
	`°©us_ª∂y_put
(
§
, "loˇl-ù="
IP_FMT
, 
	`IP_ARGS
(&
loˇl_ù
.
s_addr
));

245 
	`°©us_ª∂y_put
(
§
, "loˇl-mac="
ETH_ADDR_FMT
, 
	`ETH_ADDR_ARGS
(
mac
));

247 
c⁄åﬁÀr_ù
 = 
	`rc⁄n_gë_ù
(
ö_b™d
->
c⁄åﬁÀr
);

248 i‡(
c⁄åﬁÀr_ù
) {

249 
	`°©us_ª∂y_put
(
§
, "c⁄åﬁÀr-ù="
IP_FMT
,

250 
	`IP_ARGS
(&
c⁄åﬁÀr_ù
));

252 
c⁄åﬁÀr_mac
 = 
	`gë_c⁄åﬁÀr_mac
(
ö_b™d
);

253 i‡(
c⁄åﬁÀr_mac
) {

254 
	`°©us_ª∂y_put
(
§
, "c⁄åﬁÀr-mac="
ETH_ADDR_FMT
,

255 
	`ETH_ADDR_ARGS
(
c⁄åﬁÀr_mac
));

258 
	}
}

261 
	$gë_oÂ_∑ckë_∑ylﬂd
(
oÂ_∑ckë_ö
 *
›i
, 
oÂbuf
 *
∑ylﬂd
)

266 
	}
}

269 
	$ö_b™d_loˇl_p‹t_cb
(c⁄° 
oÂ_p‹t
 *
p‹t
, *
ö_b™d_
)

271 
ö_b™d_d©a
 *
ö_b™d
 = 
ö_b™d_
;

272 i‡(
p‹t
) {

273 
«me
[ 
p‹t
->name + 1];

274 
	`gë_p‹t_«me
(
p‹t
, 
«me
, Çame);

276 i‡(!
ö_b™d
->
of_devi˚


277 || 
	`°rcmp
(
	`√tdev_gë_«me
(
ö_b™d
->
of_devi˚
), 
«me
))

279 
îr‹
;

280 
	`√tdev_˛o£
(
ö_b™d
->
of_devi˚
);

281 
îr‹
 = 
	`√tdev_›í
(
«me
, 
NETDEV_ETH_TYPE_NONE
,

282 &
ö_b™d
->
of_devi˚
);

283 i‡(
îr‹
) {

284 
	`VLOG_ERR
(
LOG_MODULE
, "failedÅo open in-band controlÇetwork device "

285 "\"%s\": %s", 
«me
, 
	`°ªº‹
(
î∫o
));

289 
	`√tdev_˛o£
(
ö_b™d
->
of_devi˚
);

290 
ö_b™d
->
of_devi˚
 = 
NULL
;

292 
	}
}

295 
	$ö_b™d_≥riodic_cb
(*
ö_b™d_
)

297 
ö_b™d_d©a
 *
ö_b™d
 = 
ö_b™d_
;

298 
	`mac_À¨nög_run
(
ö_b™d
->
ml
, 
NULL
);

299 
	}
}

302 
	$ö_b™d_waô_cb
(*
ö_b™d_
)

304 
ö_b™d_d©a
 *
ö_b™d
 = 
ö_b™d_
;

305 
	`mac_À¨nög_waô
(
ö_b™d
->
ml
);

306 
	}
}

308 
hook_˛ass
 
	gö_b™d_hook_˛ass
 = {

309 
ö_b™d_loˇl_∑ckë_cb
,

310 
NULL
,

311 
ö_b™d_≥riodic_cb
,

312 
ö_b™d_waô_cb
,

313 
NULL
,

317 
	$ö_b™d_°¨t
(
£cch™
 *secchan,

318 c⁄° 
£âögs
 *
s
, 
swôch_°©us
 *
ss
,

319 
p‹t_w©chî
 *
pw
, 
rc⁄n
 *
ªmŸe
)

321 
ö_b™d_d©a
 *
ö_b™d
;

323 
ö_b™d
 = 
	`xˇŒoc
(1,  *in_band);

324 
ö_b™d
->
s
 = s;

325 
ö_b™d
->
ml
 = 
	`mac_À¨nög_¸óã
();

326 
ö_b™d
->
of_devi˚
 = 
NULL
;

327 
ö_b™d
->
c⁄åﬁÀr
 = 
ªmŸe
;

328 
	`swôch_°©us_ªgi°î_ˇãg‹y
(
ss
, "ö-b™d", 
ö_b™d_°©us_cb
, 
ö_b™d
);

329 
	`p‹t_w©chî_ªgi°î_loˇl_p‹t_ˇŒback
(
pw
, 
ö_b™d_loˇl_p‹t_cb
,

330 
ö_b™d
);

331 
	`add_hook
(
£cch™
, &
ö_b™d_hook_˛ass
, 
ö_b™d
);

332 
	}
}

	@secchan/in-band.h

34 #i‚de‡
IN_BAND_H


35 
	#IN_BAND_H
 1

	)

37 
	gp‹t_w©chî
;

38 
	grc⁄n
;

39 
	g£cch™
;

40 
	g£âögs
;

41 
	gswôch_°©us
;

43 
ö_b™d_°¨t
(
£cch™
 *, c⁄° 
£âögs
 *,

44 
swôch_°©us
 *, 
p‹t_w©chî
 *,

45 
rc⁄n
 *
ªmŸe
);

	@secchan/port-watcher.c

34 
	~<c⁄fig.h
>

35 
	~"p‹t-w©chî.h
"

36 
	~<¨∑/öë.h
>

37 
	~<as£π.h
>

38 
	~<öây≥s.h
>

39 
	~<°dlib.h
>

40 
	~"dy«mic-°rög.h
"

41 
	~"√tdev.h
"

42 
	~"oÂ.h
"

43 
	~"oÂbuf.h
"

44 
	~"›íÊow/›íÊow.h
"

45 
	~"pﬁl-lo›.h
"

46 
	~"p‹t-¨øy.h
"

47 
	~"rc⁄n.h
"

48 
	~"shash.h
"

49 
	~"svec.h
"

50 
	~"timevÆ.h
"

51 
	~"xtoxŒ.h
"

52 
	~"vlog.h
"

54 
	#LOG_MODULE
 
VLM_p‹t_w©chî


	)

56 
	sp‹t_w©chî_cb
 {

57 
p‹t_ch™ged_cb_func
 *
	mp‹t_ch™ged
;

58 *
	maux
;

61 
	sp‹t_w©chî_loˇl_cb
 {

62 
loˇl_p‹t_ch™ged_cb_func
 *
	mloˇl_p‹t_ch™ged
;

63 *
	maux
;

66 
	sp‹t_w©chî
 {

67 
rc⁄n
 *
	mloˇl_rc⁄n
;

68 
rc⁄n
 *
	mªmŸe_rc⁄n
;

69 
p‹t_¨øy
 
	mp‹ts
;

70 
time_t
 
	mœ°_„©uª_ªque°
;

71 
boﬁ
 
	mgŸ_„©uª_ª∂y
;

72 
uöt64_t
 
	md©≠©h_id
;

73 
	mn_txq
;

74 
p‹t_w©chî_cb
 
	mcbs
[2];

75 
	mn_cbs
;

76 
p‹t_w©chî_loˇl_cb
 
	mloˇl_cbs
[4];

77 
	mn_loˇl_cbs
;

78 
	mloˇl_p‹t_«me
[
OFP_MAX_PORT_NAME_LEN
 + 1];

79 
√tdev_m⁄ô‹
 *
	mm⁄
;

80 
shash
 
	mp‹t_by_«me
;

85 
	$›p_dif„rs
(c⁄° 
oÂ_p‹t
 *
a
, c⁄° oÂ_p‹à*
b
)

87 
	`BUILD_ASSERT_DECL
( *
a
 == 64);

88  ((
a
->
p‹t_no
 !
b
->port_no)

89 + (
	`memcmp
(
a
->
hw_addr
, 
b
->hw_addr, á->hw_addr) != 0)

90 + (
	`memcmp
(
a
->
«me
, 
b
->name, á->name) != 0)

91 + (
a
->
c⁄fig
 !
b
->config)

92 + (
a
->
°©e
 !
b
->state)

93 + (
a
->
cuº
 !
b
->curr)

94 + (
a
->
advîti£d
 !
b
->advertised)

95 + (
a
->
suµ‹ãd
 !
b
->supported)

96 + (
a
->
≥î
 !
b
->peer)

97 + (
a
->
cuº_•ìd
 !
b
->curr_speed)

98 + (
a
->
max_•ìd
 !
b
->max_speed));

99 
	}
}

102 
	$ßnôize_›p
(
oÂ_p‹t
 *
›p
)

104 
size_t
 
i
;

106 
i
 = 0; i <  
›p
->
«me
; i++) {

107 
c
 = 
›p
->
«me
[
i
];

108 i‡(
c
 && (c < 0x20 || c > 0x7e)) {

109 
›p
->
«me
[
i
] = '.';

112 
›p
->
«me
[ opp->name - 1] = '\0';

113 
	}
}

116 
	$ˇŒ_p‹t_ch™ged_ˇŒbacks
(
p‹t_w©chî
 *
pw
, 
p‹t_no
,

117 c⁄° 
oÂ_p‹t
 *
ﬁd
,

118 c⁄° 
oÂ_p‹t
 *
√w
)

120 
i
;

121 
i
 = 0; i < 
pw
->
n_cbs
; i++) {

122 
p‹t_ch™ged_cb_func
 *
p‹t_ch™ged
 = 
pw
->
cbs
[
i
].port_changed;

123 (
p‹t_ch™ged
)(
p‹t_no
, 
ﬁd
, 
√w
, 
pw
->
cbs
[
i
].
aux
);

125 
	}
}

128 
	$gë_p‹t_«me
(c⁄° 
oÂ_p‹t
 *
p‹t
, *
«me
, 
size_t
 
«me_size
)

130 *
p
;

132 
	`mem˝y
(
«me
, 
p‹t
->«me, 
	`MIN
(
«me_size
, Öort->name));

133 
«me
[
«me_size
 - 1] = '\0';

134 
p
 = 
«me
; *p != '\0';Ö++) {

135 i‡(*
p
 < 32 || *p > 126) {

136 *
p
 = '.';

139 
	}
}

141 
oÂ_p‹t
 *

142 
	$lookup_p‹t
(c⁄° 
p‹t_w©chî
 *
pw
, 
uöt32_t
 
p‹t_no
)

144  
	`p‹t_¨øy_gë
(&
pw
->
p‹ts
, 
p‹t_no
);

145 
	}
}

148 
	$ˇŒ_loˇl_p‹t_ch™ged_ˇŒbacks
(
p‹t_w©chî
 *
pw
)

150 
«me
[
OFP_MAX_PORT_NAME_LEN
 + 1];

151 c⁄° 
oÂ_p‹t
 *
p‹t
;

152 
i
;

156 
p‹t
 = 
	`lookup_p‹t
(
pw
, 
OFPP_LOCAL
);

159 i‡(
p‹t
) {

160 
	`gë_p‹t_«me
(
p‹t
, 
«me
, Çame);

162 
«me
[0] = '\0';

164 i‡(
	`°rcmp
(
pw
->
loˇl_p‹t_«me
, 
«me
)) {

165 i‡(
«me
[0]) {

166 
	`VLOG_INFO
(
LOG_MODULE
, "Idítifõd d©®∑thÜoˇ»p‹àa†\"%s\".", 
«me
);

168 
	`VLOG_WARN
(
LOG_MODULE
, "DataÖath hasÇoÜocalÖort.");

170 
	`°r˝y
(
pw
->
loˇl_p‹t_«me
, 
«me
);

174 
i
 = 0; i < 
pw
->
n_loˇl_cbs
; i++) {

175 
loˇl_p‹t_ch™ged_cb_func
 *
cb
 = 
pw
->
loˇl_cbs
[
i
].
loˇl_p‹t_ch™ged
;

176 (
cb
)(
p‹t
, 
pw
->
loˇl_cbs
[
i
].
aux
);

178 
	}
}

181 
	$upd©e_phy_p‹t
(
p‹t_w©chî
 *
pw
, 
oÂ_p‹t
 *
›p
,

182 
uöt8_t
 
ªas⁄
)

184 
oÂ_p‹t
 *
ﬁd
;

185 
uöt32_t
 
p‹t_no
;

187 
p‹t_no
 = 
	`¡ohl
(
›p
->port_no);

188 
ﬁd
 = 
	`lookup_p‹t
(
pw
, 
p‹t_no
);

190 i‡(
ªas⁄
 =
OFPPR_DELETE
 && 
ﬁd
) {

191 
	`ˇŒ_p‹t_ch™ged_ˇŒbacks
(
pw
, 
p‹t_no
, 
ﬁd
, 
NULL
);

192 
	`‰ì
(
ﬁd
);

193 
	`p‹t_¨øy_£t
(&
pw
->
p‹ts
, 
p‹t_no
, 
NULL
);

194 } i‡(
ªas⁄
 =
OFPPR_MODIFY
 ||Ñós⁄ =
OFPPR_ADD
) {

203 
oÂ_p‹t
 
√w
 = *
›p
;

204 
	`ßnôize_›p
(&
√w
);

205 
	`ˇŒ_p‹t_ch™ged_ˇŒbacks
(
pw
, 
p‹t_no
, 
ﬁd
, &
√w
);

206 i‡(
ﬁd
) {

207 *
ﬁd
 = 
√w
;

209 
	`p‹t_¨øy_£t
(&
pw
->
p‹ts
, 
p‹t_no
, 
	`xmemdup
(&
√w
, Çew));

215 
	}
}

218 
	$upd©e_√tdev_m⁄ô‹_devi˚s
(
p‹t_w©chî
 *
pw
)

220 
oÂ_p‹t
 *
p
;

221 
svec
 
√tdevs
;

222 
p‹t_no
;

224 
	`svec_öô
(&
√tdevs
);

225 
	`shash_˛ór
(&
pw
->
p‹t_by_«me
);

226 
p
 = 
	`p‹t_¨øy_fú°
(&
pw
->
p‹ts
, &
p‹t_no
);Ö;

227 
p
 = 
	`p‹t_¨øy_√xt
(&
pw
->
p‹ts
, &
p‹t_no
)) {

228 c⁄° *
«me
 = (c⁄° *Ë
p
->name;

229 
	`svec_add
(&
√tdevs
, 
«me
);

230 
	`shash_add
(&
pw
->
p‹t_by_«me
, 
«me
, 
p
);

232 
	`√tdev_m⁄ô‹_£t_devi˚s
(
pw
->
m⁄
, 
√tdevs
.
«mes
,Çëdevs.
n
);

233 
	`svec_de°roy
(&
√tdevs
);

234 
	}
}

236 
boﬁ


237 
	$p‹t_w©chî_loˇl_∑ckë_cb
(
ªœy
 *
r
, *
pw_
)

239 
p‹t_w©chî
 *
pw
 = 
pw_
;

240 
oÂbuf
 *
msg
 = 
r
->
hÆves
[
HALF_LOCAL
].
rxbuf
;

241 
oÂ_hódî
 *
oh
 = 
msg
->
d©a
;

242 i‡(
oh
->
ty≥
 =
OFPT_FEATURES_REPLY
) {

243 
oÂ_swôch_„©uªs
 *
osf
 = 
msg
->
d©a
;

245 
pw
->
gŸ_„©uª_ª∂y
 = 
åue
;

246 i‡(
pw
->
d©≠©h_id
 !
osf
->datapath_id) {

247 
pw
->
d©≠©h_id
 = 
osf
->datapath_id;

248 
	`VLOG_INFO
(
LOG_MODULE
, "D©≠©h id i†%012"
PRIx64
, 
	`¡ohŒ
(
pw
->
d©≠©h_id
));

251 i‡(
oh
->
ty≥
 =
OFPT_MULTIPART_REPLY
) {

252 
oÂ_mu…ù¨t_ª∂y
 *
ª∂
 = 
msg
->
d©a
;

253 if(
	`¡ohs
(
ª∂
->
ty≥
Ë=
OFPMP_PORT_DESC
){

254 
boﬁ
 
£í
[
PORT_ARRAY_SIZE
];

255 
oÂ_p‹t
 *
p
;

256 
p‹t_no
;

257 
size_t
 
n_p‹ts
, 
i
;

258 
p
 = (
oÂ_p‹t
*Ë
ª∂
->
body
;

260 
	`mem£t
(
£í
, 
Ál£
,  seen);

261 
n_p‹ts
 = ((
msg
->
size
 - 
	`off£tof
(
oÂ_mu…ù¨t_ª∂y
, 
body
))

262 /  *
p
);

263 
i
 = 0; i < 
n_p‹ts
; i++) {

264 
oÂ_p‹t
 *
›p
 = &
p
[
i
];

265 i‡(
	`¡ohl
(
›p
->
p‹t_no
Ë> 
PORT_ARRAY_SIZE
 - 1) {

266 i‡(
	`¡ohl
(
›p
->
p‹t_no
Ë<
OFPP_MAX
) {

267 
	`VLOG_WARN
(
LOG_MODULE
, "P‹àID %u ovîÜimô", 
	`¡ohl
(
›p
->
p‹t_no
));

271 
	`upd©e_phy_p‹t
(
pw
, 
›p
, 
OFPPR_MODIFY
);

272 
£í
[
	`¡ohl
(
›p
->
p‹t_no
)] = 
åue
;

276 
p
 = 
	`p‹t_¨øy_fú°
(&
pw
->
p‹ts
, &
p‹t_no
);Ö;

277 
p
 = 
	`p‹t_¨øy_√xt
(&
pw
->
p‹ts
, &
p‹t_no
)) {

278 i‡(!
£í
[
p‹t_no
]) {

279 
	`upd©e_phy_p‹t
(
pw
, 
p
, 
OFPPR_DELETE
);

283 
	`upd©e_√tdev_m⁄ô‹_devi˚s
(
pw
);

285 
	`ˇŒ_loˇl_p‹t_ch™ged_ˇŒbacks
(
pw
);

287 i‡((
	`¡ohs
(
oh
->
ty≥
Ë=
OFPMP_PORT_STATS
 ||

288 
	`¡ohs
(
oh
->
ty≥
Ë=
OFPT_PORT_STATUS
)

289 && 
msg
->
size
 >(
oÂ_p‹t_°©us
)) {

290 
oÂ_p‹t_°©us
 *
›s
 = 
msg
->
d©a
;

291 
	`upd©e_phy_p‹t
(
pw
, &
›s
->
desc
, ops->
ªas⁄
);

292 i‡(
›s
->
desc
.
p‹t_no
 =
	`ht⁄l
(
OFPP_LOCAL
)) {

293 
	`ˇŒ_loˇl_p‹t_ch™ged_ˇŒbacks
(
pw
);

295 i‡(
›s
->
ªas⁄
 =
OFPPR_ADD
 || 
OFPPR_DELETE
) {

296 
	`upd©e_√tdev_m⁄ô‹_devi˚s
(
pw
);

301  
Ál£
;

302 
	}
}

305 
	$brög_√tdev_up_‹_down
(c⁄° *
«me
, 
boﬁ
 
down
)

307 
vlog_øã_limô
 
æ
 = 
	`VLOG_RATE_LIMIT_INIT
(1, 5);

308 
√tdev
 *netdev;

309 
ªtvÆ
;

311 
ªtvÆ
 = 
	`√tdev_›í
(
«me
, 
NETDEV_ETH_TYPE_NONE
, &
√tdev
);

312 i‡(!
ªtvÆ
) {

313 i‡(
down
) {

314 
ªtvÆ
 = 
	`√tdev_tu∫_Êags_off
(
√tdev
, 
NETDEV_UP
, 
åue
);

316 
ªtvÆ
 = 
	`√tdev_tu∫_Êags_⁄
(
√tdev
, 
NETDEV_UP
, 
åue
);

318 i‡(
ªtvÆ
) {

319 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "failedÅo bringÇetwork device %s %s: %s",

320 
«me
, 
down
 ? "down" : "up", 
	`°ªº‹
(
ªtvÆ
));

322 
	`√tdev_˛o£
(
√tdev
);

324 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "failedÅo openÇetwork device %s: %s",

325 
«me
, 
	`°ªº‹
(
ªtvÆ
));

327 
	}
}

329 
boﬁ


330 
	$p‹t_w©chî_ªmŸe_∑ckë_cb
(
ªœy
 *
r
, *
pw_
)

332 
p‹t_w©chî
 *
pw
 = 
pw_
;

333 
oÂbuf
 *
msg
 = 
r
->
hÆves
[
HALF_REMOTE
].
rxbuf
;

334 
oÂ_hódî
 *
oh
 = 
msg
->
d©a
;

336 i‡(
oh
->
ty≥
 =
OFPT_PORT_MOD


337 && 
msg
->
size
 >(
oÂ_p‹t_mod
)) {

338 
oÂ_p‹t_mod
 *
›m
 = 
msg
->
d©a
;

339 
uöt32_t
 
p‹t_no
 = 
	`¡ohl
(
›m
->port_no);

340 
oÂ_p‹t
 *
pw_›p
 = 
	`lookup_p‹t
(
pw
, 
p‹t_no
);

341 i‡(
pw_›p
->
p‹t_no
 !
	`ht⁄l
(
OFPP_ANY
)) {

342 
oÂ_p‹t
 
ﬁd
 = *
pw_›p
;

343 
pw_›p
->
c⁄fig
 = (’w_›p->c⁄fig & ~
›m
->
mask
)

344 | (
›m
->
c⁄fig
 & opm->
mask
));

345 
	`ˇŒ_p‹t_ch™ged_ˇŒbacks
(
pw
, 
p‹t_no
, &
ﬁd
, 
pw_›p
);

346 i‡(
pw_›p
->
p‹t_no
 =
	`ht⁄l
(
OFPP_LOCAL
)) {

347 
	`ˇŒ_loˇl_p‹t_ch™ged_ˇŒbacks
(
pw
);

350 i‡(
›m
->
mask
 & 
	`ht⁄l
(
OFPPC_PORT_DOWN
)) {

351 
	`brög_√tdev_up_‹_down
((c⁄° *Ë
pw_›p
->
«me
,

352 
›m
->
c⁄fig
 & 
	`ht⁄l
(
OFPPC_PORT_DOWN
));

356  
Ál£
;

357 
	}
}

361 
	$£t_bô
(
uöt32_t
 
bô
, 
boﬁ
 
vÆue
, uöt32_à*
w‹d
)

363 i‡(
vÆue
) {

364 *
w‹d
 |
bô
;

366 *
w‹d
 &~
bô
;

368 
	}
}

371 
	$p‹t_w©chî_≥riodic_cb
(*
pw_
)

373 
p‹t_w©chî
 *
pw
 = 
pw_
;

374 c⁄° *
«me
;

376 i‡(!
pw
->
gŸ_„©uª_ª∂y


377 && 
	`time_now
(Ë>
pw
->
œ°_„©uª_ªque°
 + 5

378 && 
	`rc⁄n_is_c⁄√˘ed
(
pw
->
loˇl_rc⁄n
)) {

379 
oÂbuf
 *
b
;

380 
	`make_›íÊow
((
oÂ_hódî
), 
OFPT_FEATURES_REQUEST
, &
b
);

381 
	`rc⁄n_£nd_wôh_limô
(
pw
->
loˇl_rc⁄n
, 
b
, &pw->
n_txq
, 1);

383 
b
 = 
	`make_p‹t_desc_ªque°
();

384 
	`rc⁄n_£nd_wôh_limô
(
pw
->
loˇl_rc⁄n
, 
b
, &pw->
n_txq
, 1);

385 
pw
->
œ°_„©uª_ªque°
 = 
	`time_now
();

388 
	`√tdev_m⁄ô‹_run
(
pw
->
m⁄
);

389 (
«me
 = 
	`√tdev_m⁄ô‹_pﬁl
(
pw
->
m⁄
)Ë!
NULL
) {

390 
oÂ_p‹t
 *
›p
;

391 
oÂ_p‹t
 
√w_›p
;

392 
√tdev_Êags
 
Êags
;

393 
ªtvÆ
;

394 
›p
 = 
	`shash_föd_d©a
(&
pw
->
p‹t_by_«me
, 
«me
);

395 i‡(!
›p
) {

399 
ªtvÆ
 = 
	`√tdev_nodev_gë_Êags
(
«me
, &
Êags
);

400 i‡(
ªtvÆ
) {

401 
vlog_øã_limô
 
æ
 = 
	`VLOG_RATE_LIMIT_INIT
(1, 5);

402 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "couldÇŸ gë fœg†f‹ %s", 
«me
);

406 
√w_›p
 = *
›p
;

407 
	`£t_bô
(
	`ht⁄l
(
OFPPC_PORT_DOWN
), ~
Êags
 & 
NETDEV_UP
, &
√w_›p
.
c⁄fig
);

408 
	`£t_bô
(
	`ht⁄l
(
OFPPS_LINK_DOWN
), ~
Êags
 & 
NETDEV_CARRIER
,

409 &
√w_›p
.
°©e
);

410 i‡(
›p
->
c⁄fig
 !
√w_›p
.c⁄fig || oµ->
°©e
 !=Çew_opp.state) {

411 
oÂ_p‹t_°©us
 *
›s
;

412 
oÂbuf
 *
b
;

415 
	`upd©e_phy_p‹t
(
pw
, &
√w_›p
, 
OFPPR_MODIFY
);

417 i‡(
√w_›p
.
p‹t_no
 =
	`ht⁄l
(
OFPP_LOCAL
)) {

418 
	`ˇŒ_loˇl_p‹t_ch™ged_ˇŒbacks
(
pw
);

422 
›s
 = 
	`make_›íÊow
( *›s, 
OFPT_PORT_STATUS
, &
b
);

423 
›s
->
ªas⁄
 = 
OFPPR_MODIFY
;

424 
›s
->
desc
 = 
√w_›p
;

425 
	`rc⁄n_£nd
(
pw
->
ªmŸe_rc⁄n
, 
b
, 
NULL
);

428 
	}
}

431 
	$p‹t_w©chî_waô_cb
(*
pw_
)

433 
p‹t_w©chî
 *
pw
 = 
pw_
;

434 i‡(!
pw
->
gŸ_„©uª_ª∂y
 && 
	`rc⁄n_is_c⁄√˘ed
’w->
loˇl_rc⁄n
)) {

435 i‡(
pw
->
œ°_„©uª_ªque°
 !
TIME_MIN
) {

436 
	`pﬁl_timî_waô
(
pw
->
œ°_„©uª_ªque°
 + 5 - 
	`time_now
());

438 
	`pﬁl_immedüã_wake
();

441 
	`√tdev_m⁄ô‹_waô
(
pw
->
m⁄
);

442 
	}
}

445 
	$put_du∂exes
(
ds
 *ds, c⁄° *
«me
, 
uöt32_t
 
„©uªs
,

446 
uöt32_t
 
hd_bô
, uöt32_à
fd_bô
)

448 i‡(
„©uªs
 & (
hd_bô
 | 
fd_bô
)) {

449 
	`ds_put_f‹m©
(
ds
, " %s", 
«me
);

450 i‡(
„©uªs
 & 
hd_bô
) {

451 
	`ds_put_c°r
(
ds
, "(HD)");

453 i‡(
„©uªs
 & 
fd_bô
) {

454 
	`ds_put_c°r
(
ds
, "(FD)");

457 
	}
}

460 
	$put_„©uªs
(
ds
 *ds, c⁄° *
«me
, 
uöt32_t
 
„©uªs
)

462 i‡(
„©uªs
 & (
OFPPF_10MB_HD
 | 
OFPPF_10MB_FD


463 | 
OFPPF_100MB_HD
 | 
OFPPF_100MB_FD


464 | 
OFPPF_1GB_HD
 | 
OFPPF_1GB_FD
 | 
OFPPF_10GB_FD
)) {

465 
	`ds_put_c°r
(
ds
, 
«me
);

466 
	`put_du∂exes
(
ds
, "10M", 
„©uªs
, 
OFPPF_10MB_HD
, 
OFPPF_10MB_FD
);

467 
	`put_du∂exes
(
ds
, "100M", 
„©uªs
,

468 
OFPPF_100MB_HD
, 
OFPPF_100MB_FD
);

469 
	`put_du∂exes
(
ds
, "1G", 
„©uªs
, 
OFPPF_1GB_HD
, 
OFPPF_1GB_FD
);

470 i‡(
„©uªs
 & 
OFPPF_10GB_FD
) {

471 
	`ds_put_c°r
(
ds
, " 10G");

473 i‡(
„©uªs
 & 
OFPPF_AUTONEG
) {

474 
	`ds_put_c°r
(
ds
, " AUTO_NEG");

476 i‡(
„©uªs
 & 
OFPPF_PAUSE
) {

477 
	`ds_put_c°r
(
ds
, " PAUSE");

479 i‡(
„©uªs
 & 
OFPPF_PAUSE_ASYM
) {

480 
	`ds_put_c°r
(
ds
, " PAUSE_ASYM");

483 
	}
}

486 
	$log_p‹t_°©us
(
uöt32_t
 
p‹t_no
,

487 c⁄° 
oÂ_p‹t
 *
ﬁd
,

488 c⁄° 
oÂ_p‹t
 *
√w
,

489 *
aux
 
UNUSED
)

491 i‡(
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

492 i‡(
ﬁd
 && 
√w
 && (
	`›p_dif„rs
(old,Çew)

493 =((
ﬁd
->
c⁄fig
 !
√w
->config)

494 + (
ﬁd
->
°©e
 !
√w
->state))))

497 } i‡(!
√w
) {

498 i‡(
ﬁd
) {

499 
	`VLOG_DBG
(
LOG_MODULE
, "P‹à%d dñëed", 
p‹t_no
);

502 
ds
 d†
DS_EMPTY_INITIALIZER
;

503 
uöt32_t
 
cuº
 = 
	`¡ohl
(
√w
->curr);

504 
uöt32_t
 
suµ‹ãd
 = 
	`¡ohl
(
√w
->supported);

505 
	`ds_put_f‹m©
(&
ds
, "\"%s\", "
ETH_ADDR_FMT
, 
√w
->
«me
,

506 
	`ETH_ADDR_ARGS
(
√w
->
hw_addr
));

507 i‡(
cuº
) {

508 
	`put_„©uªs
(&
ds
, ", cuºít", 
cuº
);

510 i‡(
suµ‹ãd
) {

511 
	`put_„©uªs
(&
ds
, ", suµ‹ts", 
suµ‹ãd
);

513 
	`VLOG_DBG
(
LOG_MODULE
, "Port %d %s: %s",

514 
p‹t_no
, 
ﬁd
 ? "ch™ged" : "added", 
	`ds_c°r
(&
ds
));

515 
	`ds_de°roy
(&
ds
);

518 
	}
}

521 
	$p‹t_w©chî_ªgi°î_ˇŒback
(
p‹t_w©chî
 *
pw
,

522 
p‹t_ch™ged_cb_func
 *
p‹t_ch™ged
,

523 *
aux
)

525 
	`as£π
(
pw
->
n_cbs
 < 
	`ARRAY_SIZE
’w->
cbs
));

526 
pw
->
cbs
[pw->
n_cbs
].
p‹t_ch™ged
 =Öort_changed;

527 
pw
->
cbs
[pw->
n_cbs
].
aux
 =áux;

528 
pw
->
n_cbs
++;

529 
	}
}

532 
	$p‹t_w©chî_ªgi°î_loˇl_p‹t_ˇŒback
(
p‹t_w©chî
 *
pw
,

533 
loˇl_p‹t_ch™ged_cb_func
 *
cb
,

534 *
aux
)

536 
	`as£π
(
pw
->
n_loˇl_cbs
 < 
	`ARRAY_SIZE
’w->
loˇl_cbs
));

537 
pw
->
loˇl_cbs
[pw->
n_loˇl_cbs
].
loˇl_p‹t_ch™ged
 = 
cb
;

538 
pw
->
loˇl_cbs
[pw->
n_loˇl_cbs
].
aux
 =áux;

539 
pw
->
n_loˇl_cbs
++;

540 
	}
}

542 
uöt32_t


543 
	$p‹t_w©chî_gë_c⁄fig
(c⁄° 
p‹t_w©chî
 *
pw
, 
uöt32_t
 
p‹t_no
)

545 
oÂ_p‹t
 *
p
 = 
	`lookup_p‹t
(
pw
, 
p‹t_no
);

546  
p
 ? 
	`¡ohl
’->
c⁄fig
) : 0;

547 
	}
}

550 
	$p‹t_w©chî_gë_«me
(c⁄° 
p‹t_w©chî
 *
pw
, 
uöt32_t
 
p‹t_no
)

552 
oÂ_p‹t
 *
p
 = 
	`lookup_p‹t
(
pw
, 
p‹t_no
);

553  
p
 ? (c⁄° *Ëp->
«me
 : 
NULL
;

554 
	}
}

556 c⁄° 
uöt8_t
 *

557 
	$p‹t_w©chî_gë_hwaddr
(c⁄° 
p‹t_w©chî
 *
pw
, 
uöt32_t
 
p‹t_no
)

559 
oÂ_p‹t
 *
p
 = 
	`lookup_p‹t
(
pw
, 
p‹t_no
);

560  
p
 ?Ö->
hw_addr
 : 
NULL
;

561 
	}
}

564 
	$p‹t_w©chî_£t_Êags
(
p‹t_w©chî
 *
pw
, 
uöt32_t
 
p‹t_no
,

565 
uöt32_t
 
c⁄fig
, uöt32_à
c_mask
,

566 
uöt32_t
 
°©e
, uöt32_à
s_mask
)

568 
oÂ_p‹t
 
ﬁd
;

569 
oÂ_p‹t
 *
p
;

570 
oÂ_p‹t_mod
 *
›m
;

571 
oÂ_p‹t_°©us
 *
›s
;

572 
oÂbuf
 *
b
;

574 
p
 = 
	`lookup_p‹t
(
pw
, 
p‹t_no
);

575 i‡(!
p
) {

579 i‡(!((
	`¡ohl
(
p
->
°©e
Ë^ sèãË& 
s_mask
)

580 && (!((
	`¡ohl
(
p
->
c⁄fig
Ë^ c⁄figË& 
c_mask
))) {

583 
ﬁd
 = *
p
;

586 
p
->
c⁄fig
 = 
	`ht⁄l
((
	`¡ohl
’->c⁄figË& ~
c_mask
) | (config & c_mask));

587 
p
->
°©e
 = 
	`ht⁄l
((
	`¡ohl
’->°©eË& ~
s_mask
) | (state & s_mask));

588 
	`ˇŒ_p‹t_ch™ged_ˇŒbacks
(
pw
, 
p‹t_no
, &
ﬁd
, 
p
);

591 
›m
 = 
	`make_›íÊow
( *›m, 
OFPT_PORT_MOD
, &
b
);

592 
›m
->
p‹t_no
 = 
p
->port_no;

593 
	`mem˝y
(
›m
->
hw_addr
, 
p
->hw_addr, 
OFP_ETH_ALEN
);

594 
›m
->
c⁄fig
 = 
p
->config;

595 
›m
->
mask
 = 
	`ht⁄l
(
c_mask
);

596 
›m
->
advîti£
 = 
	`ht⁄l
(0);

597 
	`rc⁄n_£nd
(
pw
->
loˇl_rc⁄n
, 
b
, 
NULL
);

600 
›s
 = 
	`make_›íÊow
( *›s, 
OFPT_PORT_STATUS
, &
b
);

601 
›s
->
ªas⁄
 = 
OFPPR_MODIFY
;

602 
›s
->
desc
 = *
p
;

603 
	`rc⁄n_£nd
(
pw
->
ªmŸe_rc⁄n
, 
b
, 
NULL
);

604 
	}
}

606 
boﬁ


607 
	$p‹t_w©chî_is_ªady
(c⁄° 
p‹t_w©chî
 *
pw
)

609  
pw
->
gŸ_„©uª_ª∂y
;

610 
	}
}

612 
hook_˛ass
 
	gp‹t_w©chî_hook_˛ass
 = {

613 
p‹t_w©chî_loˇl_∑ckë_cb
,

614 
p‹t_w©chî_ªmŸe_∑ckë_cb
,

615 
p‹t_w©chî_≥riodic_cb
,

616 
p‹t_w©chî_waô_cb
,

617 
NULL
,

621 
	$p‹t_w©chî_°¨t
(
£cch™
 *secchan,

622 
rc⁄n
 *
loˇl_rc⁄n
, rc⁄¿*
ªmŸe_rc⁄n
,

623 
p‹t_w©chî
 **
pwp
)

625 
p‹t_w©chî
 *
pw
;

626 
ªtvÆ
;

628 
pw
 = *
pwp
 = 
	`xˇŒoc
(1,  *pw);

629 
pw
->
loˇl_rc⁄n
 =Üocal_rconn;

630 
pw
->
ªmŸe_rc⁄n
 =Ñemote_rconn;

631 
pw
->
œ°_„©uª_ªque°
 = 
TIME_MIN
;

632 
	`p‹t_¨øy_öô
(&
pw
->
p‹ts
);

633 
pw
->
loˇl_p‹t_«me
[0] = '\0';

634 
ªtvÆ
 = 
	`√tdev_m⁄ô‹_¸óã
(&
pw
->
m⁄
);

635 i‡(
ªtvÆ
) {

636 
	`oÂ_Áèl
(
ªtvÆ
, "failedÅo startÇetwork device monitoring");

638 
	`shash_öô
(&
pw
->
p‹t_by_«me
);

639 
	`p‹t_w©chî_ªgi°î_ˇŒback
(
pw
, 
log_p‹t_°©us
, 
NULL
);

640 
	`add_hook
(
£cch™
, &
p‹t_w©chî_hook_˛ass
, 
pw
);

641 
	}
}

	@secchan/port-watcher.h

34 #i‚de‡
PORT_WATCHER_H


35 
	#PORT_WATCHER_H
 1

	)

37 
	~<°döt.h
>

38 
	~"compûî.h
"

39 
	~"£cch™.h
"

41 
	goÂ_p‹t
;

42 
	gp‹t_w©chî
;

43 
	g£cch™
;

45 
p‹t_w©chî_°¨t
(
£cch™
 *,

46 
rc⁄n
 *
loˇl
, rc⁄¿*
ªmŸe
,

47 
p‹t_w©chî
 **);

48 
boﬁ
 
p‹t_w©chî_is_ªady
(c⁄° 
p‹t_w©chî
 *);

49 
uöt32_t
 
p‹t_w©chî_gë_c⁄fig
(c⁄° 
p‹t_w©chî
 *,

50 
uöt32_t
 
p‹t_no
);

51 c⁄° *
	$p‹t_w©chî_gë_«me
(c⁄° 
p‹t_w©chî
 *,

52 
uöt32_t
 
p‹t_no
Ë
UNUSED
;

53 c⁄° 
uöt8_t
 *
	`p‹t_w©chî_gë_hwaddr
(c⁄° 
p‹t_w©chî
 *,

54 
uöt32_t
 
p‹t_no
);

55 
	`p‹t_w©chî_£t_Êags
(
p‹t_w©chî
 *, 
uöt32_t
 
p‹t_no
,

56 
uöt32_t
 
c⁄fig
, uöt32_à
c_mask
,

57 
uöt32_t
 
°©e
, uöt32_à
s_mask
);

59 
	tp‹t_ch™ged_cb_func
(
	tuöt32_t
 
	tp‹t_no
,

60 c⁄° 
	toÂ_p‹t
 *
	tﬁd
,

61 c⁄° 
	toÂ_p‹t
 *
	t√w
,

62 *
	taux
);

64 
	`p‹t_w©chî_ªgi°î_ˇŒback
(
p‹t_w©chî
 *,

65 
p‹t_ch™ged_cb_func
 *
p‹t_ch™ged
,

66 *
aux
);

68 
	tloˇl_p‹t_ch™ged_cb_func
(c⁄° 
	toÂ_p‹t
 *
	t√w
,

69 *
	taux
);

71 
	`p‹t_w©chî_ªgi°î_loˇl_p‹t_ˇŒback
(
p‹t_w©chî
 *
pw
,

72 
loˇl_p‹t_ch™ged_cb_func
 *
cb
,

73 *
aux
);

75 
	`gë_p‹t_«me
(c⁄° 
oÂ_p‹t
 *, *
«me
, 
size_t
 
«me_size
);

	@secchan/ratelimit.c

34 
	~<c⁄fig.h
>

35 
	~"øãlimô.h
"

36 
	~<¨∑/öë.h
>

37 
	~<°dlib.h
>

38 
	~"oÂbuf.h
"

39 
	~"›íÊow/›íÊow.h
"

40 
	~"pﬁl-lo›.h
"

41 
	~"queue.h
"

42 
	~"rc⁄n.h
"

43 
	~"£cch™.h
"

44 
	~"°©us.h
"

45 
	~"timevÆ.h
"

46 
	~"vc⁄n.h
"

48 
	søã_limôî
 {

49 c⁄° 
£âögs
 *
	ms
;

50 
rc⁄n
 *
	mªmŸe_rc⁄n
;

53 
oÂ_queue
 
	mqueues
[65535];

54 
	mn_queued
;

55 
	m√xt_tx_p‹t
;

63 
	mœ°_fûl
;

64 
	mtokís
;

67 
	mn_txq
;

70 
	mn_n‹mÆ
;

71 
	mn_limôed
;

72 
	mn_queue_dr›≥d
;

73 
	mn_tx_dr›≥d
;

78 
	$dr›_∑ckë
(
øã_limôî
 *
æ
)

80 
oÂ_queue
 *
l⁄ge°
;

81 
n_l⁄ge°
;

82 
oÂ_queue
 *
q
;

84 
l⁄ge°
 = &
æ
->
queues
[0];

85 
n_l⁄ge°
 = 1;

86 
q
 = &
æ
->
queues
[0]; q < &æ->queues[
OFPP_MAX
]; q++) {

87 i‡(
l⁄ge°
->
n
 < 
q
->n) {

88 
l⁄ge°
 = 
q
;

89 
n_l⁄ge°
 = 1;

90 } i‡(
l⁄ge°
->
n
 =
q
->n) {

91 
n_l⁄ge°
++;

95 i‡(!
	`øndom_ønge
(
n_l⁄ge°
)) {

96 
l⁄ge°
 = 
q
;

102 
	`oÂbuf_dñëe
(
	`queue_p›_hód
(
l⁄ge°
));

103 
æ
->
n_queued
--;

104 
	}
}

107 
oÂbuf
 *

108 
	$dequeue_∑ckë
(
øã_limôî
 *
æ
)

110 
i
;

112 
i
 = 0; i < 
OFPP_MAX
; i++) {

113 
p‹t
 = (
æ
->
√xt_tx_p‹t
 + 
i
Ë% 
OFPP_MAX
;

114 
oÂ_queue
 *
q
 = &
æ
->
queues
[
p‹t
];

115 i‡(
q
->
n
) {

116 
æ
->
√xt_tx_p‹t
 = (
p‹t
 + 1Ë% 
OFPP_MAX
;

117 
æ
->
n_queued
--;

118  
	`queue_p›_hód
(
q
);

121 
	`NOT_REACHED
();

122 
	}
}

126 
	$ªfûl_buckë
(
øã_limôî
 *
æ
)

128 c⁄° 
£âögs
 *
s
 = 
æ
->s;

129 
now
 = 
	`time_m£c
();

130 
tokís
 = (
now
 - 
æ
->
œ°_fûl
Ë* 
s
->
øã_limô
 +Ñl->tokens;

131 i‡(
tokís
 >= 1000) {

132 
æ
->
œ°_fûl
 = 
now
;

133 
æ
->
tokís
 = 
	`MIN
—okís, 
s
->
bur°_limô
 * 1000);

135 
	}
}

140 
boﬁ


141 
	$gë_tokí
(
øã_limôî
 *
æ
)

143 i‡(
æ
->
tokís
 >= 1000) {

144 
æ
->
tokís
 -= 1000;

145  
åue
;

147  
Ál£
;

149 
	}
}

151 
boﬁ


152 
	$øã_limô_loˇl_∑ckë_cb
(
ªœy
 *
r
, *
æ_
)

154 
øã_limôî
 *
æ
 = 
æ_
;

155 c⁄° 
£âögs
 *
s
 = 
æ
->s;

156 
oÂ_∑ckë_ö
 *
›i
;

158 
›i
 = 
	`gë_oÂ_∑ckë_ö
(
r
);

159 i‡(!
›i
) {

160  
Ál£
;

163 i‡(
›i
->
ªas⁄
 =
OFPR_ACTION
) {

167  
Ál£
;

170 i‡(!
æ
->
n_queued
 && 
	`gë_tokí
(rl)) {

173 
æ
->
n_n‹mÆ
++;

174  
Ál£
;

177 
oÂbuf
 *
msg
 = 
r
->
hÆves
[
HALF_LOCAL
].
rxbuf
;

179 
p‹t
 = 0;

180 i‡(
æ
->
n_queued
 >
s
->
bur°_limô
) {

181 
	`dr›_∑ckë
(
æ
);

183 
	`queue_push_èû
(&
æ
->
queues
[
p‹t
], 
	`oÂbuf_˛⁄e
(
msg
));

184 
æ
->
n_queued
++;

185 
æ
->
n_limôed
++;

186  
åue
;

188 
	}
}

191 
	$øã_limô_°©us_cb
(
°©us_ª∂y
 *
§
, *
æ_
)

193 
øã_limôî
 *
æ
 = 
æ_
;

195 
	`°©us_ª∂y_put
(
§
, "n‹mÆ=%Œu", 
æ
->
n_n‹mÆ
);

196 
	`°©us_ª∂y_put
(
§
, "limôed=%Œu", 
æ
->
n_limôed
);

197 
	`°©us_ª∂y_put
(
§
, "queue-dr›≥d=%Œu", 
æ
->
n_queue_dr›≥d
);

198 
	`°©us_ª∂y_put
(
§
, "tx-dr›≥d=%Œu", 
æ
->
n_tx_dr›≥d
);

199 
	}
}

202 
	$øã_limô_≥riodic_cb
(*
æ_
)

204 
øã_limôî
 *
æ
 = 
æ_
;

205 
i
;

209 
	`ªfûl_buckë
(
æ
);

210 
i
 = 0; 
æ
->
n_queued
 && 
	`gë_tokí
(rl) && i < 50; i++) {

215 
oÂbuf
 *
b
 = 
	`dequeue_∑ckë
(
æ
);

216 i‡(
	`rc⁄n_£nd_wôh_limô
(
æ
->
ªmŸe_rc⁄n
, 
b
, &æ->
n_txq
, 10)) {

217 
æ
->
n_tx_dr›≥d
++;

220 
	}
}

223 
	$øã_limô_waô_cb
(*
æ_
)

225 
øã_limôî
 *
æ
 = 
æ_
;

226 i‡(
æ
->
n_queued
) {

227 i‡(
æ
->
tokís
 >= 1000) {

229 
	`pﬁl_immedüã_wake
();

233 
	`pﬁl_timî_waô
(
TIME_UPDATE_INTERVAL
 / 2);

236 
	}
}

238 
hook_˛ass
 
	gøã_limô_hook_˛ass
 = {

239 
øã_limô_loˇl_∑ckë_cb
,

240 
NULL
,

241 
øã_limô_≥riodic_cb
,

242 
øã_limô_waô_cb
,

243 
NULL
,

247 
	$øã_limô_°¨t
(
£cch™
 *£cch™, c⁄° 
£âögs
 *
s
,

248 
swôch_°©us
 *
ss
, 
rc⁄n
 *
ªmŸe
)

250 
øã_limôî
 *
æ
;

251 
size_t
 
i
;

253 
æ
 = 
	`xˇŒoc
(1,  *rl);

254 
æ
->
s
 = s;

255 
æ
->
ªmŸe_rc⁄n
 = 
ªmŸe
;

256 
i
 = 0; i < 
	`ARRAY_SIZE
(
æ
->
queues
); i++) {

257 
	`queue_öô
(&
æ
->
queues
[
i
]);

259 
æ
->
œ°_fûl
 = 
	`time_m£c
();

260 
æ
->
tokís
 = 
s
->
øã_limô
 * 100;

261 
	`swôch_°©us_ªgi°î_ˇãg‹y
(
ss
, "rate-limit",

262 
øã_limô_°©us_cb
, 
æ
);

263 
	`add_hook
(
£cch™
, &
øã_limô_hook_˛ass
, 
æ
);

264 
	}
}

	@secchan/ratelimit.h

34 #i‚de‡
RATELIMIT_H


35 
	#RATELIMIT_H
 1

	)

37 
	grc⁄n
;

38 
	g£cch™
;

39 
	g£âögs
;

40 
	gswôch_°©us
;

42 
øã_limô_°¨t
(
£cch™
 *, c⁄° 
£âögs
 *,

43 
swôch_°©us
 *, 
rc⁄n
 *
ªmŸe
);

	@secchan/secchan.c

34 
	~<c⁄fig.h
>

35 
	~"£cch™.h
"

36 
	~<as£π.h
>

37 
	~<î∫o.h
>

38 
	~<gë›t.h
>

39 
	~<√töë/ö.h
>

40 
	~<°dlib.h
>

41 
	~<sig«l.h
>

42 
	~<°rög.h
>

44 
	~"comm™d-löe.h
"

45 
	~"compûî.h
"

46 
	~"d´m⁄.h
"

47 
	~"dús.h
"

48 
	~"discovîy.h
"

49 
	~"Áûovî.h
"

50 
	~"Áu….h
"

51 
	~"ö-b™d.h
"

52 
	~"Àak-checkî.h
"

53 
	~"li°.h
"

54 
	~"oÂ.h
"

55 
	~"oÂbuf.h
"

56 
	~"›íÊow/›íÊow.h
"

57 
	~"∑ckës.h
"

58 
	~"p‹t-w©chî.h
"

59 
	~"pﬁl-lo›.h
"

60 
	~"øãlimô.h
"

61 
	~"rc⁄n.h
"

62 
	~"°p-£cch™.h
"

63 
	~"°©us.h
"

64 
	~"timevÆ.h
"

65 
	~"utû.h
"

66 
	~"vc⁄n-s¶.h
"

67 
	~"vc⁄n.h
"

68 
	~"vlog-sockë.h
"

69 
	~"vlog.h
"

71 
	#LOG_MODULE
 
VLM_£cch™


	)

73 
	shook
 {

74 c⁄° 
hook_˛ass
 *
	m˛ass
;

75 *
	maux
;

78 
	s£cch™
 {

79 
hook
 *
	mhooks
;

80 
size_t
 
	mn_hooks
, 
	mÆloˇãd_hooks
;

83 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(60, 60);

85 
∑r£_›ti⁄s
(
¨gc
, *
¨gv
[], 
£âögs
 *);

86 
	$ußge
(Ë
NO_RETURN
;

88 *
	`vc⁄n_«me_wôhout_subs¸ùti⁄
(const *);

89 
pvc⁄n
 *
	`›í_∑ssive_vc⁄n
(c⁄° *
«me
);

90 
vc⁄n
 *
	`ac˚±_vc⁄n
(
pvc⁄n
 *pvconn);

92 
ªœy
 *
	`ªœy_¸óã
(
rc⁄n
 *
async
,

93 
rc⁄n
 *
loˇl
, rc⁄¿*
ªmŸe
,

94 
boﬁ
 
is_mgmt_c⁄n
);

95 
ªœy
 *
	`ªœy_ac˚±
(c⁄° 
£âögs
 *, 
pvc⁄n
 *);

96 
	`ªœy_run
(
ªœy
 *, 
£cch™
 *);

97 
	`ªœy_waô
(
ªœy
 *);

98 
	`ªœy_de°roy
(
ªœy
 *);

101 
	$maö
(
¨gc
, *
¨gv
[])

103 
£âögs
 
s
;

105 
li°
 
ªœys
 = 
	`LIST_INITIALIZER
(&relays);

107 
£cch™
 secchan;

109 
pvc⁄n
 *
m⁄ô‹
;

111 
pvc⁄n
 *
li°íîs
[
MAX_MGMT
];

112 
size_t
 
n_li°íîs
;

114 *
loˇl_rc⁄n_«me
;

115 
rc⁄n
 *
async_rc⁄n
, *
loˇl_rc⁄n
, *
ªmŸe_rc⁄n
;

116 
ªœy
 *
c⁄åﬁÀr_ªœy
;

117 
discovîy
 *discovery;

118 
swôch_°©us
 *switch_status;

119 
p‹t_w©chî
 *
pw
;

120 
i
;

121 
ªtvÆ
;

123 
	`£t_¥ogøm_«me
(
¨gv
[0]);

124 
	`ªgi°î_Áu…_h™dÀrs
();

125 
	`time_öô
();

126 
	`vlog_öô
();

127 
	`∑r£_›ti⁄s
(
¨gc
, 
¨gv
, &
s
);

128 
	`sig«l
(
SIGPIPE
, 
SIG_IGN
);

130 
£cch™
.
hooks
 = 
NULL
;

131 
£cch™
.
n_hooks
 = 0;

132 
£cch™
.
Æloˇãd_hooks
 = 0;

135 
n_li°íîs
 = 0;

136 
i
 = 0; i < 
s
.
n_li°íîs
; i++) {

137 
li°íîs
[
n_li°íîs
++] = 
	`›í_∑ssive_vc⁄n
(
s
.
li°íî_«mes
[
i
]);

139 
m⁄ô‹
 = 
s
.
m⁄ô‹_«me
 ? 
	`›í_∑ssive_vc⁄n
(s.m⁄ô‹_«meË: 
NULL
;

142 
	`swôch_°©us_°¨t
(&
£cch™
, &
s
, &
swôch_°©us
);

144 
	`dõ_if_Æªady_ru¬ög
();

145 
	`d´m⁄ize
();

148 
ªtvÆ
 = 
	`vlog_£rvî_li°í
(
NULL
, NULL);

149 i‡(
ªtvÆ
) {

150 
	`oÂ_Áèl
(
ªtvÆ
, "CouldÇotÜisten for vlog connections");

153 
	`VLOG_INFO
(
LOG_MODULE
, "O≥nFlowÑe„ªn˚ im∂emíèti⁄ vîsi⁄ %s", 
VERSION
 
BUILDNR
);

154 
	`VLOG_INFO
(
LOG_MODULE
, "O≥nFlowÖrŸocﬁ vîsi⁄ 0x%02x", 
OFP_VERSION
);

157 i‡(
	`°∫cmp
(
s
.
dp_«me
, "nl:", 3) && strncmp(s.dp_name, "unix:", 5)

158 && !
s
.
c⁄åﬁÀr_«mes
[0]) {

159 
	`VLOG_WARN
(
LOG_MODULE
, "ControllerÇot specifiedánd datapath isÇotÇl: or "

163 i‡(!
	`°∫cmp
(
s
.
dp_«me
, "nl:", 3)) {

169 
async_rc⁄n
 = 
	`rc⁄n_¸óã
(0, 
s
.
max_backoff
);

170 
	`rc⁄n_c⁄√˘
(
async_rc⁄n
, 
s
.
dp_«me
);

171 
	`swôch_°©us_ªgi°î_ˇãg‹y
(
swôch_°©us
, "async",

172 
rc⁄n_°©us_cb
, 
async_rc⁄n
);

180 
async_rc⁄n
 = 
NULL
;

184 
loˇl_rc⁄n_«me
 = 
	`vc⁄n_«me_wôhout_subs¸ùti⁄
(
s
.
dp_«me
);

185 
loˇl_rc⁄n
 = 
	`rc⁄n_¸óã
(0, 
s
.
max_backoff
);

186 
	`rc⁄n_c⁄√˘
(
loˇl_rc⁄n
, 
loˇl_rc⁄n_«me
);

187 
	`‰ì
(
loˇl_rc⁄n_«me
);

188 
	`swôch_°©us_ªgi°î_ˇãg‹y
(
swôch_°©us
, "local",

189 
rc⁄n_°©us_cb
, 
loˇl_rc⁄n
);

192 
ªmŸe_rc⁄n
 = 
	`rc⁄n_¸óã
(
s
.
¥obe_öãrvÆ
, s.
max_backoff
);

193 i‡(
s
.
c⁄åﬁÀr_«mes
[0]) {

194 
ªtvÆ
 = 
	`rc⁄n_c⁄√˘
(
ªmŸe_rc⁄n
, 
s
.
c⁄åﬁÀr_«mes
[0]);

195 i‡(
ªtvÆ
 =
EAFNOSUPPORT
) {

196 
	`oÂ_Áèl
(0, "Nÿsuµ‹àf‹ %†vc⁄n", 
s
.
c⁄åﬁÀr_«mes
[0]);

199 
	`swôch_°©us_ªgi°î_ˇãg‹y
(
swôch_°©us
, "remote",

200 
rc⁄n_°©us_cb
, 
ªmŸe_rc⁄n
);

203 
c⁄åﬁÀr_ªœy
 = 
	`ªœy_¸óã
(
async_rc⁄n
, 
loˇl_rc⁄n
, 
ªmŸe_rc⁄n
,

204 
Ál£
);

205 
	`li°_push_back
(&
ªœys
, &
c⁄åﬁÀr_ªœy
->
node
);

208 
	`p‹t_w©chî_°¨t
(&
£cch™
, 
loˇl_rc⁄n
, 
ªmŸe_rc⁄n
, &
pw
);

209 
discovîy
 = 
s
.discovîy ? 
	`discovîy_öô
(&s, 
pw
, 
swôch_°©us
Ë: 
NULL
;

210 i‡(
s
.
íabÀ_°p
) {

211 
	`°p_°¨t
(&
£cch™
, 
pw
, 
loˇl_rc⁄n
, 
ªmŸe_rc⁄n
);

213 i‡(
s
.
ö_b™d
) {

214 
	`ö_b™d_°¨t
(&
£cch™
, &
s
, 
swôch_°©us
, 
pw
, 
ªmŸe_rc⁄n
);

216 i‡(
s
.
num_c⁄åﬁÀrs
 > 1) {

217 
	`Áûovî_°¨t
(&
£cch™
, &
s
, 
swôch_°©us
, 
ªmŸe_rc⁄n
);

219 i‡(
s
.
øã_limô
) {

220 
	`øã_limô_°¨t
(&
£cch™
, &
s
, 
swôch_°©us
, 
ªmŸe_rc⁄n
);

223 
s
.
discovîy
 || 
	`rc⁄n_is_Æive
(
ªmŸe_rc⁄n
)) {

224 
ªœy
 *
r
, *
n
;

225 
size_t
 
i
;

228 
	`LIST_FOR_EACH_SAFE
 (
r
, 
n
, 
ªœy
, 
node
, &
ªœys
) {

229 
	`ªœy_run
(
r
, &
£cch™
);

231 
i
 = 0; i < 
n_li°íîs
; i++) {

233 
ªœy
 *
r
 = 
	`ªœy_ac˚±
(&
s
, 
li°íîs
[
i
]);

234 i‡(!
r
) {

237 
	`li°_push_back
(&
ªœys
, &
r
->
node
);

240 i‡(
m⁄ô‹
) {

241 
vc⁄n
 *
√w
 = 
	`ac˚±_vc⁄n
(
m⁄ô‹
);

242 i‡(
√w
) {

245 
	`rc⁄n_add_m⁄ô‹
(
loˇl_rc⁄n
, 
√w
);

248 
i
 = 0; i < 
£cch™
.
n_hooks
; i++) {

249 i‡(
£cch™
.
hooks
[
i
].
˛ass
->
≥riodic_cb
) {

250 
£cch™
.
hooks
[
i
].
˛ass
->
	`≥riodic_cb
(£cch™.hooks[i].
aux
);

253 i‡(
s
.
discovîy
) {

254 *
c⁄åﬁÀr_«me
;

255 i‡(
	`rc⁄n_is_c⁄√˘ivôy_que°i⁄abÀ
(
ªmŸe_rc⁄n
)) {

256 
	`discovîy_que°i⁄_c⁄√˘ivôy
(
discovîy
);

258 i‡(
	`discovîy_run
(
discovîy
, &
c⁄åﬁÀr_«me
)) {

259 i‡(
c⁄åﬁÀr_«me
) {

260 
	`rc⁄n_c⁄√˘
(
ªmŸe_rc⁄n
, 
c⁄åﬁÀr_«me
);

262 
	`rc⁄n_disc⁄√˘
(
ªmŸe_rc⁄n
);

268 
	`LIST_FOR_EACH
 (
r
, 
ªœy
, 
node
, &
ªœys
) {

269 
	`ªœy_waô
(
r
);

271 
i
 = 0; i < 
n_li°íîs
; i++) {

272 
	`pvc⁄n_waô
(
li°íîs
[
i
]);

274 i‡(
m⁄ô‹
) {

275 
	`pvc⁄n_waô
(
m⁄ô‹
);

277 
i
 = 0; i < 
£cch™
.
n_hooks
; i++) {

278 i‡(
£cch™
.
hooks
[
i
].
˛ass
->
waô_cb
) {

279 
£cch™
.
hooks
[
i
].
˛ass
->
	`waô_cb
(£cch™.hooks[i].
aux
);

282 i‡(
discovîy
) {

283 
	`discovîy_waô
(
discovîy
);

285 
	`pﬁl_block
();

289 
	}
}

291 
pvc⁄n
 *

292 
	$›í_∑ssive_vc⁄n
(c⁄° *
«me
)

294 
pvc⁄n
 *pvconn;

295 
ªtvÆ
;

297 
ªtvÆ
 = 
	`pvc⁄n_›í
(
«me
, &
pvc⁄n
);

298 i‡(
ªtvÆ
 &&ÑëvÆ !
EAGAIN
) {

299 
	`oÂ_Áèl
(
ªtvÆ
, "›íög %s", 
«me
);

301  
pvc⁄n
;

302 
	}
}

304 
vc⁄n
 *

305 
	$ac˚±_vc⁄n
(
pvc⁄n
 *pvconn)

307 
vc⁄n
 *
√w
;

308 
ªtvÆ
;

310 
ªtvÆ
 = 
	`pvc⁄n_ac˚±
(
pvc⁄n
, 
OFP_VERSION
, &
√w
);

311 i‡(
ªtvÆ
 &&ÑëvÆ !
EAGAIN
) {

312 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "ac˚± faûed (%s)", 
	`°ªº‹
(
ªtvÆ
));

314  
√w
;

315 
	}
}

318 
	$add_hook
(
£cch™
 *£cch™, c⁄° 
hook_˛ass
 *
˛ass
, *
aux
)

320 
hook
 *hook;

322 i‡(
£cch™
->
n_hooks
 >£cch™->
Æloˇãd_hooks
) {

323 
£cch™
->
hooks
 = 
	`x2ƒóŒoc
(£cch™->hooks, &£cch™->
Æloˇãd_hooks
,

324  *
£cch™
->
hooks
);

326 
hook
 = &
£cch™
->
hooks
[£cch™->
n_hooks
++];

327 
hook
->
˛ass
 = class;

328 
hook
->
aux
 =áux;

329 
	}
}

331 
oÂ_∑ckë_ö
 *

332 
	$gë_oÂ_∑ckë_ö
(
ªœy
 *
r
)

334 
oÂbuf
 *
msg
 = 
r
->
hÆves
[
HALF_LOCAL
].
rxbuf
;

335 
oÂ_hódî
 *
oh
 = 
msg
->
d©a
;

336 i‡(
oh
->
ty≥
 =
OFPT_PACKET_IN
) {

338  
msg
->
d©a
;

344  
NULL
;

345 
	}
}

348 
boﬁ


349 
	$gë_oÂ_∑ckë_ëh_hódî
(
ªœy
 *
r
, 
oÂ_∑ckë_ö
 **
›ù
,

350 
ëh_hódî
 **
ëhp
)

352 c⁄° 
mö_Àn
 = 0;

353 
oÂ_∑ckë_ö
 *
›i
 = 
	`gë_oÂ_∑ckë_ö
(
r
);

354 i‡(
›i
 && 
	`¡ohs
(›i->
hódî
.
Àngth
Ë>
mö_Àn
) {

355 *
›ù
 = 
›i
;

357  
åue
;

359  
Ál£
;

360 
	}
}

368 
	$vc⁄n_«me_wôhout_subs¸ùti⁄
(c⁄° *
vc⁄n_«me
)

370 
∆_ödex
;

371 i‡(
	`ssˇnf
(
vc⁄n_«me
, "∆:%d", &
∆_ödex
) == 1) {

376  
	`xa•rötf
("∆:%d:0", 
∆_ödex
);

381 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "new management connection willÑeceive "

383  
	`x°rdup
(
vc⁄n_«me
);

385 
	}
}

387 
ªœy
 *

388 
	$ªœy_ac˚±
(c⁄° 
£âögs
 *
s
, 
pvc⁄n
 *pvconn)

390 
vc⁄n
 *
√w_ªmŸe
, *
√w_loˇl
;

391 
rc⁄n
 *
r1
, *
r2
;

392 *
vc⁄n_«me
;

393 
ªtvÆ
;

395 
√w_ªmŸe
 = 
	`ac˚±_vc⁄n
(
pvc⁄n
);

396 i‡(!
√w_ªmŸe
) {

397  
NULL
;

400 
vc⁄n_«me
 = 
	`vc⁄n_«me_wôhout_subs¸ùti⁄
(
s
->
dp_«me
);

401 
ªtvÆ
 = 
	`vc⁄n_›í
(
vc⁄n_«me
, 
OFP_VERSION
, &
√w_loˇl
);

402 i‡(
ªtvÆ
) {

403 
	`VLOG_ERR_RL
(
LOG_MODULE
, &
æ
, "couldÇot connectÅo %s (%s)",

404 
vc⁄n_«me
, 
	`°ªº‹
(
ªtvÆ
));

405 
	`vc⁄n_˛o£
(
√w_ªmŸe
);

406 
	`‰ì
(
vc⁄n_«me
);

407  
NULL
;

411 
r1
 = 
	`rc⁄n_¸óã
(0, 0);

412 
	`rc⁄n_c⁄√˘_uƒñübly
(
r1
, 
vc⁄n_«me
, 
√w_loˇl
);

413 
	`‰ì
(
vc⁄n_«me
);

415 
r2
 = 
	`rc⁄n_¸óã
(0, 0);

416 
	`rc⁄n_c⁄√˘_uƒñübly
(
r2
, "∑ssive", 
√w_ªmŸe
);

418  
	`ªœy_¸óã
(
NULL
, 
r1
, 
r2
, 
åue
);

419 
	}
}

421 
ªœy
 *

422 
	$ªœy_¸óã
(
rc⁄n
 *
async
, rc⁄¿*
loˇl
, rc⁄¿*
ªmŸe
,

423 
boﬁ
 
is_mgmt_c⁄n
)

425 
ªœy
 *
r
 = 
	`xˇŒoc
(1,  *r);

426 
r
->
hÆves
[
HALF_LOCAL
].
rc⁄n
 = 
loˇl
;

427 
r
->
hÆves
[
HALF_REMOTE
].
rc⁄n
 = 
ªmŸe
;

428 
r
->
is_mgmt_c⁄n
 = is_mgmt_conn;

429 
r
->
async_rc⁄n
 = 
async
;

430  
r
;

431 
	}
}

433 
boﬁ


434 
	$ˇŒ_loˇl_∑ckë_cbs
(
£cch™
 *£cch™, 
ªœy
 *
r
)

436 c⁄° 
hook
 *
h
;

437 
h
 = 
£cch™
->
hooks
; h < &£cch™->hooks[£cch™->
n_hooks
]; h++) {

438 
	`boﬁ
 (*
cb
)(
ªœy
 *, *
aux
Ë
h
->
˛ass
->
loˇl_∑ckë_cb
;

439 i‡(
cb
 && (cb)(
r
, 
h
->
aux
)) {

440  
åue
;

443  
Ál£
;

444 
	}
}

446 
boﬁ


447 
	$ˇŒ_ªmŸe_∑ckë_cbs
(
£cch™
 *£cch™, 
ªœy
 *
r
)

449 c⁄° 
hook
 *
h
;

450 
h
 = 
£cch™
->
hooks
; h < &£cch™->hooks[£cch™->
n_hooks
]; h++) {

451 
	`boﬁ
 (*
cb
)(
ªœy
 *, *
aux
Ë
h
->
˛ass
->
ªmŸe_∑ckë_cb
;

452 i‡(
cb
 && (cb)(
r
, 
h
->
aux
)) {

453  
åue
;

456  
Ál£
;

457 
	}
}

460 
	$ªœy_run
(
ªœy
 *
r
, 
£cch™
 *secchan)

462 
ôî©i⁄
;

463 
i
;

465 i‡(
r
->
async_rc⁄n
) {

466 
	`rc⁄n_run
(
r
->
async_rc⁄n
);

468 
i
 = 0; i < 2; i++) {

469 
	`rc⁄n_run
(
r
->
hÆves
[
i
].
rc⁄n
);

473 
ôî©i⁄
 = 0; iteration < 50; iteration++) {

474 
boﬁ
 
¥ogªss
 = 
Ál£
;

475 
i
 = 0; i < 2; i++) {

476 
hÆf
 *
this
 = &
r
->
hÆves
[
i
];

477 
hÆf
 *
≥î
 = &
r
->
hÆves
[!
i
];

479 i‡(!
this
->
rxbuf
) {

480 
this
->
rxbuf
 = 
	`rc⁄n_ªcv
—his->
rc⁄n
);

481 i‡(!
this
->
rxbuf
 && 
i
 =
HALF_LOCAL
 && 
r
->
async_rc⁄n
) {

482 
this
->
rxbuf
 = 
	`rc⁄n_ªcv
(
r
->
async_rc⁄n
);

484 i‡(
this
->
rxbuf
 && (
i
 =
HALF_REMOTE
 || !
r
->
is_mgmt_c⁄n
)) {

485 i‡(
i
 =
HALF_LOCAL


486 ? 
	`ˇŒ_loˇl_∑ckë_cbs
(
£cch™
, 
r
)

487 : 
	`ˇŒ_ªmŸe_∑ckë_cbs
(
£cch™
, 
r
))

489 
	`oÂbuf_dñëe
(
this
->
rxbuf
);

490 
this
->
rxbuf
 = 
NULL
;

491 
¥ogªss
 = 
åue
;

497 i‡(
this
->
rxbuf
 && !this->
n_txq
) {

498 
ªtvÆ
 = 
	`rc⁄n_£nd
(
≥î
->
rc⁄n
, 
this
->
rxbuf
,

499 &
this
->
n_txq
);

500 i‡(
ªtvÆ
 !
EAGAIN
) {

501 i‡(!
ªtvÆ
) {

502 
¥ogªss
 = 
åue
;

504 
	`oÂbuf_dñëe
(
this
->
rxbuf
);

506 
this
->
rxbuf
 = 
NULL
;

510 i‡(!
¥ogªss
) {

515 i‡(
r
->
is_mgmt_c⁄n
) {

516 
i
 = 0; i < 2; i++) {

517 
hÆf
 *
this
 = &
r
->
hÆves
[
i
];

518 i‡(!
	`rc⁄n_is_Æive
(
this
->
rc⁄n
)) {

519 
	`ªœy_de°roy
(
r
);

524 
	}
}

527 
	$ªœy_waô
(
ªœy
 *
r
)

529 
i
;

531 i‡(
r
->
async_rc⁄n
) {

532 
	`rc⁄n_run_waô
(
r
->
async_rc⁄n
);

534 
i
 = 0; i < 2; i++) {

535 
hÆf
 *
this
 = &
r
->
hÆves
[
i
];

537 
	`rc⁄n_run_waô
(
this
->
rc⁄n
);

538 i‡(!
this
->
rxbuf
) {

539 
	`rc⁄n_ªcv_waô
(
this
->
rc⁄n
);

540 i‡(
i
 =
HALF_LOCAL
 && 
r
->
async_rc⁄n
) {

541 
	`rc⁄n_ªcv_waô
(
r
->
async_rc⁄n
);

545 
	}
}

548 
	$ªœy_de°roy
(
ªœy
 *
r
)

550 
i
;

552 
	`li°_ªmove
(&
r
->
node
);

553 
	`rc⁄n_de°roy
(
r
->
async_rc⁄n
);

554 
i
 = 0; i < 2; i++) {

555 
hÆf
 *
this
 = &
r
->
hÆves
[
i
];

556 
	`rc⁄n_de°roy
(
this
->
rc⁄n
);

557 
	`oÂbuf_dñëe
(
this
->
rxbuf
);

559 
	`‰ì
(
r
);

560 
	}
}

565 
	$∑r£_›ti⁄s
(
¨gc
, *
¨gv
[], 
£âögs
 *
s
)

568 
OPT_ACCEPT_VCONN
 = 
UCHAR_MAX
 + 1,

569 
OPT_NO_RESOLV_CONF
,

570 
OPT_INACTIVITY_PROBE
,

571 
OPT_MAX_IDLE
,

572 
OPT_MAX_BACKOFF
,

573 
OPT_RATE_LIMIT
,

574 
OPT_BURST_LIMIT
,

575 
OPT_BOOTSTRAP_CA_CERT
,

576 
OPT_STP
,

577 
OPT_NO_STP
,

578 
OPT_OUT_OF_BAND
,

579 
OPT_IN_BAND
,

580 
VLOG_OPTION_ENUMS
,

581 
LEAK_CHECKER_OPTION_ENUMS


583 
›ti⁄
 
l⁄g_›ti⁄s
[] = {

584 {"ac˚±-vc⁄n", 
ªquúed_¨gumít
, 0, 
OPT_ACCEPT_VCONN
},

585 {"no-ªsﬁv-c⁄f", 
no_¨gumít
, 0, 
OPT_NO_RESOLV_CONF
},

586 {"Áû", 
ªquúed_¨gumít
, 0, 'F'},

587 {"öa˘ivôy-¥obe", 
ªquúed_¨gumít
, 0, 
OPT_INACTIVITY_PROBE
},

588 {"max-idÀ", 
ªquúed_¨gumít
, 0, 
OPT_MAX_IDLE
},

589 {"max-backoff", 
ªquúed_¨gumít
, 0, 
OPT_MAX_BACKOFF
},

590 {"li°í", 
ªquúed_¨gumít
, 0, 'l'},

591 {"m⁄ô‹", 
ªquúed_¨gumít
, 0, 'm'},

592 {"øã-limô", 
›ti⁄Æ_¨gumít
, 0, 
OPT_RATE_LIMIT
},

593 {"bur°-limô", 
ªquúed_¨gumít
, 0, 
OPT_BURST_LIMIT
},

594 {"°p", 
no_¨gumít
, 0, 
OPT_STP
},

595 {"no-°p", 
no_¨gumít
, 0, 
OPT_NO_STP
},

596 {"out-of-b™d", 
no_¨gumít
, 0, 
OPT_OUT_OF_BAND
},

597 {"ö-b™d", 
no_¨gumít
, 0, 
OPT_IN_BAND
},

598 {"vîbo£", 
›ti⁄Æ_¨gumít
, 0, 'v'},

599 {"hñp", 
no_¨gumít
, 0, 'h'},

600 {"vîsi⁄", 
no_¨gumít
, 0, 'V'},

601 
DAEMON_LONG_OPTIONS
,

602 
VLOG_LONG_OPTIONS
,

603 
LEAK_CHECKER_LONG_OPTIONS
,

604 #ifde‡
HAVE_OPENSSL


605 
VCONN_SSL_LONG_OPTIONS


606 {"boŸ°øp-ˇ-˚π", 
ªquúed_¨gumít
, 0, 
OPT_BOOTSTRAP_CA_CERT
},

610 *
sh‹t_›ti⁄s
 = 
	`l⁄g_›ti⁄s_to_sh‹t_›ti⁄s
(
l⁄g_›ti⁄s
);

611 *
ac˚±_ª
 = 
NULL
;

612 
ªtvÆ
;

615 
s
->
n_li°íîs
 = 0;

616 
s
->
m⁄ô‹_«me
 = 
NULL
;

617 
s
->
max_idÀ
 = 15;

618 
s
->
¥obe_öãrvÆ
 = 15;

619 
s
->
max_backoff
 = 4;

620 
s
->
upd©e_ªsﬁv_c⁄f
 = 
åue
;

621 
s
->
øã_limô
 = 0;

622 
s
->
bur°_limô
 = 0;

623 
s
->
íabÀ_°p
 = 
Ál£
;

624 
s
->
ö_b™d
 = 
åue
;

626 
c
;

628 
c
 = 
	`gë›t_l⁄g
(
¨gc
, 
¨gv
, 
sh‹t_›ti⁄s
, 
l⁄g_›ti⁄s
, 
NULL
);

629 i‡(
c
 == -1) {

633 
c
) {

634 
OPT_ACCEPT_VCONN
:

635 
ac˚±_ª
 = 
›èrg
[0] ='^' ? o±¨g : 
	`xa•rötf
("^%s", optarg);

638 
OPT_NO_RESOLV_CONF
:

639 
s
->
upd©e_ªsﬁv_c⁄f
 = 
Ál£
;

642 
OPT_INACTIVITY_PROBE
:

643 
s
->
¥obe_öãrvÆ
 = 
	`©oi
(
›èrg
);

644 i‡(
s
->
¥obe_öãrvÆ
 < 1) {

645 
	`oÂ_Áèl
(0, "--inactivity-probeárgument must beátÜeast 1");

649 
OPT_MAX_IDLE
:

650 i‡(!
	`°rcmp
(
›èrg
, "permanent")) {

651 
s
->
max_idÀ
 = 
OFP_FLOW_PERMANENT
;

653 
s
->
max_idÀ
 = 
	`©oi
(
›èrg
);

654 i‡(
s
->
max_idÀ
 < 1 || s->max_idle > 65535) {

655 
	`oÂ_Áèl
(0, "--max-idleárgument must be between 1ánd "

661 
OPT_MAX_BACKOFF
:

662 
s
->
max_backoff
 = 
	`©oi
(
›èrg
);

663 i‡(
s
->
max_backoff
 < 1) {

664 
	`oÂ_Áèl
(0, "--max-backoffárgument must beátÜeast 1");

665 } i‡(
s
->
max_backoff
 > 3600) {

666 
s
->
max_backoff
 = 3600;

670 
OPT_RATE_LIMIT
:

671 i‡(
›èrg
) {

672 
s
->
øã_limô
 = 
	`©oi
(
›èrg
);

673 i‡(
s
->
øã_limô
 < 1) {

674 
	`oÂ_Áèl
(0, "--rate-limitárgument must beátÜeast 1");

677 
s
->
øã_limô
 = 1000;

681 
OPT_BURST_LIMIT
:

682 
s
->
bur°_limô
 = 
	`©oi
(
›èrg
);

683 i‡(
s
->
bur°_limô
 < 1) {

684 
	`oÂ_Áèl
(0, "--burst-limitárgument must beátÜeast 1");

688 
OPT_STP
:

689 
s
->
íabÀ_°p
 = 
åue
;

692 
OPT_NO_STP
:

693 
s
->
íabÀ_°p
 = 
Ál£
;

696 
OPT_OUT_OF_BAND
:

697 
s
->
ö_b™d
 = 
Ál£
;

703 
OPT_IN_BAND
:

704 
s
->
ö_b™d
 = 
åue
;

708 i‡(
s
->
n_li°íîs
 >
MAX_MGMT
) {

709 
	`oÂ_Áèl
(0,

711 
MAX_MGMT
);

713 
s
->
li°íî_«mes
[s->
n_li°íîs
++] = 
›èrg
;

717 i‡(
s
->
m⁄ô‹_«me
) {

718 
	`oÂ_Áèl
(0, "-m or --monitor may only be specified once");

720 
s
->
m⁄ô‹_«me
 = 
›èrg
;

724 
	`ußge
();

727 
	`¥ötf
("%†%†compûed "
__DATE__
" "
__TIME__
"\n",

728 
¥ogøm_«me
, 
VERSION
 
BUILDNR
);

729 
	`exô
(
EXIT_SUCCESS
);

731 
DAEMON_OPTION_HANDLERS


733 
VLOG_OPTION_HANDLERS


735 
LEAK_CHECKER_OPTION_HANDLERS


737 #ifde‡
HAVE_OPENSSL


738 
VCONN_SSL_OPTION_HANDLERS


740 
OPT_BOOTSTRAP_CA_CERT
:

741 
	`vc⁄n_s¶_£t_ˇ_˚π_fûe
(
›èrg
, 
åue
);

746 
	`exô
(
EXIT_FAILURE
);

749 
	`ab‹t
();

752 
	`‰ì
(
sh‹t_›ti⁄s
);

754 
¨gc
 -
›töd
;

755 
¨gv
 +
›töd
;

756 i‡(
¨gc
 < 1 ||árgc > 2) {

757 
	`oÂ_Áèl
(0, "need one orÅwoÇon-optionárguments; "

762 
s
->
dp_«me
 = 
¨gv
[0];

764 *
cuº
;

765 *
ßve
;

766 
i
;

768 
s
->
num_c⁄åﬁÀrs
 = 0;

769 
i
 = 0; i < 
MAX_CONTROLLERS
; ++i)

770 
s
->
c⁄åﬁÀr_«mes
[
i
] = 
NULL
;

771 i‡(
¨gc
 > 1) {

772 
cuº
 = 
	`°πok_r
(
¨gv
[1], ",,", &
ßve
), 
i
 = 0;

773 
cuº
 && 
i
 < 
MAX_CONTROLLERS
;

774 
cuº
 = 
	`°πok_r
(
NULL
, ",,", &
ßve
), ++
i
) {

775 
s
->
c⁄åﬁÀr_«mes
[
i
] = 
	`x°rdup
(
cuº
);

776 ++
s
->
num_c⁄åﬁÀrs
;

782 i‡(!
ac˚±_ª
) {

783 
ac˚±_ª
 = 
	`vc⁄n_s¶_is_c⁄figuªd
() ? "^ssl:.*" : ".*";

785 
ªtvÆ
 = 
	`ªgcomp
(&
s
->
ac˚±_c⁄åﬁÀr_ªgex
, 
ac˚±_ª
,

786 
REG_NOSUB
 | 
REG_EXTENDED
);

787 i‡(
ªtvÆ
) {

788 
size_t
 
Àngth
 = 
	`ªgîr‹
(
ªtvÆ
, &
s
->
ac˚±_c⁄åﬁÀr_ªgex
, 
NULL
, 0);

789 *
buf„r
 = 
	`xmÆloc
(
Àngth
);

790 
	`ªgîr‹
(
ªtvÆ
, &
s
->
ac˚±_c⁄åﬁÀr_ªgex
, 
buf„r
, 
Àngth
);

791 
	`oÂ_Áèl
(0, "%s: %s", 
ac˚±_ª
, 
buf„r
);

793 
s
->
ac˚±_c⁄åﬁÀr_ª
 = 
ac˚±_ª
;

796 
s
->
discovîy
 = s->
c⁄åﬁÀr_«mes
[0] =
NULL
;

797 i‡(
s
->
discovîy
 && !s->
ö_b™d
) {

798 
	`oÂ_Áèl
(0, "CannotÖerform discovery with out-of-band control");

802 i‡(
s
->
øã_limô
) {

803 i‡(
s
->
øã_limô
 < 100) {

804 
	`VLOG_WARN
(
LOG_MODULE
, "RateÜimit setÅo unusuallyÜow value %d",

805 
s
->
øã_limô
);

807 i‡(!
s
->
bur°_limô
) {

808 
s
->
bur°_limô
 = s->
øã_limô
 / 4;

810 
s
->
bur°_limô
 = 
	`MAX
(s->burst_limit, 1);

811 
s
->
bur°_limô
 = 
	`MIN
(s->bur°_limô, 
INT_MAX
 / 1000);

813 
	}
}

816 
	$ußge
()

818 
	`¥ötf
("%s: secure channel,áÑelay for OpenFlow messages.\n"

823 
¥ogøm_«me
,Örogram_name);

824 
	`vc⁄n_ußge
(
åue
,Årue,Årue);

825 
	`¥ötf
("\nController discovery options:\n"

843 
	`d´m⁄_ußge
();

844 
	`vlog_ußge
();

845 
	`¥ötf
("\nOther options:\n"

848 
	`Àak_checkî_ußge
();

849 
	`exô
(
EXIT_SUCCESS
);

850 
	}
}

	@secchan/secchan.h

34 #i‚de‡
SECCHAN_H


35 
	#SECCHAN_H
 1

	)

37 
	~<ªgex.h
>

38 
	~<°dboﬁ.h
>

39 
	~<°ddef.h
>

40 
	~"li°.h
"

41 
	~"∑ckës.h
"

43 
	g£cch™
;

46 
	#MAX_MGMT
 8

	)

48 
	#MAX_CONTROLLERS
 3

	)

51 
	s£âögs
 {

53 
boﬁ
 
	mdiscovîy
;

54 
boﬁ
 
	mö_b™d
;

57 c⁄° *
	mdp_«me
;

58 
	mnum_c⁄åﬁÀrs
;

59 c⁄° *
	mc⁄åﬁÀr_«mes
[
MAX_CONTROLLERS
];

60 c⁄° *
	mli°íî_«mes
[
MAX_MGMT
];

61 
size_t
 
	mn_li°íîs
;

62 c⁄° *
	mm⁄ô‹_«me
;

65 
	mmax_idÀ
;

66 
	m¥obe_öãrvÆ
;

67 
	mmax_backoff
;

70 
	møã_limô
;

71 
	mbur°_limô
;

74 
ªgex_t
 
	mac˚±_c⁄åﬁÀr_ªgex
;

75 c⁄° *
	mac˚±_c⁄åﬁÀr_ª
;

76 
boﬁ
 
	mupd©e_ªsﬁv_c⁄f
;

79 
boﬁ
 
	míabÀ_°p
;

82 
	shÆf
 {

83 
rc⁄n
 *
	mrc⁄n
;

84 
oÂbuf
 *
	mrxbuf
;

85 
	mn_txq
;

88 
	sªœy
 {

89 
li°
 
	mnode
;

91 
	#HALF_LOCAL
 0

	)

92 
	#HALF_REMOTE
 1

	)

93 
hÆf
 
	mhÆves
[2];

105 
boﬁ
 
	mis_mgmt_c⁄n
;

106 
rc⁄n
 *
	masync_rc⁄n
;

109 
	shook_˛ass
 {

110 
boﬁ
 (*
loˇl_∑ckë_cb
)(
	mªœy
 *, *
	maux
);

111 
boﬁ
 (*
ªmŸe_∑ckë_cb
)(
	mªœy
 *, *
	maux
);

112 (*
	m≥riodic_cb
)(*
	maux
);

113 (*
	mwaô_cb
)(*
	maux
);

114 (*
	m˛osög_cb
)(
	mªœy
 *, *
	maux
);

117 
add_hook
(
£cch™
 *, c⁄° 
hook_˛ass
 *, *);

119 
oÂ_∑ckë_ö
 *
gë_oÂ_∑ckë_ö
(
ªœy
 *);

120 
boﬁ
 
gë_oÂ_∑ckë_ëh_hódî
(
ªœy
 *, 
oÂ_∑ckë_ö
 **,

121 
ëh_hódî
 **);

122 
gë_oÂ_∑ckë_∑ylﬂd
(
oÂ_∑ckë_ö
 *, 
oÂbuf
 *);

	@secchan/status.c

34 
	~<c⁄fig.h
>

35 
	~"°©us.h
"

36 
	~<¨∑/öë.h
>

37 
	~<as£π.h
>

38 
	~<î∫o.h
>

39 
	~<uni°d.h
>

40 
	~"dy«mic-°rög.h
"

41 
	~"›íÊow/nicúa-ext.h
"

42 
	~"oÂ.h
"

43 
	~"oÂbuf.h
"

44 
	~"›íÊow/›íÊow.h
"

45 
	~"rc⁄n.h
"

46 
	~"timevÆ.h
"

47 
	~"vlog.h
"

49 
	#LOG_MODULE
 
VLM_°©us


	)

52 
	sswôch_°©us_ˇãg‹y
 {

53 *
	m«me
;

54 (*
	mcb
)(
	m°©us_ª∂y
 *, *
	maux
);

55 *
	maux
;

58 
	sswôch_°©us
 {

59 c⁄° 
£âögs
 *
	ms
;

60 
time_t
 
	mboŸed
;

61 
swôch_°©us_ˇãg‹y
 *
	mˇãg‹õs
;

62 
size_t
 
	mn_ˇãg‹õs
, 
	mÆloˇãd_ˇãg‹õs
;

65 
	s°©us_ª∂y
 {

66 
swôch_°©us_ˇãg‹y
 *
	mˇãg‹y
;

67 
ds
 
	mªque°
;

68 
ds
 
	mouçut
;

71 
boﬁ


72 
	$swôch_°©us_ªmŸe_∑ckë_cb
(
ªœy
 *
r
, *
ss_
)

74 
swôch_°©us
 *
ss
 = 
ss_
;

75 
rc⁄n
 *
rc
 = 
r
->
hÆves
[
HALF_REMOTE
].rconn;

76 
oÂbuf
 *
msg
 = 
r
->
hÆves
[
HALF_REMOTE
].
rxbuf
;

77 
swôch_°©us_ˇãg‹y
 *
c
;

78 
nicúa_hódî
 *
ªque°
;

79 
nicúa_hódî
 *
ª∂y
;

80 
°©us_ª∂y
 
§
;

81 
oÂbuf
 *
b
;

82 
ªtvÆ
;

84 i‡(
msg
->
size
 < (
nicúa_hódî
)) {

85  
Ál£
;

87 
ªque°
 = 
msg
->
d©a
;

88 i‡(
ªque°
->
hódî
.
ty≥
 !
OFPT_EXPERIMENTER


89 || 
ªque°
->
víd‹
 !
	`ht⁄l
(
NX_VENDOR_ID
)

90 || 
ªque°
->
subty≥
 !
	`ht⁄l
(
NXT_STATUS_REQUEST
)) {

91  
Ál£
;

94 
§
.
ªque°
.
°rög
 = (*) (request + 1);

95 
§
.
ªque°
.
Àngth
 = 
msg
->
size
 -  *request;

96 
	`ds_öô
(&
§
.
ouçut
);

97 
c
 = 
ss
->
ˇãg‹õs
; c < &ss->ˇãg‹õs[ss->
n_ˇãg‹õs
]; c++) {

98 i‡(!
	`memcmp
(
c
->
«me
, 
§
.
ªque°
.
°rög
,

99 
	`MIN
(
	`°æí
(
c
->
«me
), 
§
.
ªque°
.
Àngth
))) {

100 
§
.
ˇãg‹y
 = 
c
;

101 
c
->
	`cb
(&
§
, c->
aux
);

104 
ª∂y
 = 
	`make_›íÊow_xid
( *ª∂y + 
§
.
ouçut
.
Àngth
,

105 
OFPT_EXPERIMENTER
, 
ªque°
->
hódî
.
xid
, &
b
);

106 
ª∂y
->
víd‹
 = 
	`ht⁄l
(
NX_VENDOR_ID
);

107 
ª∂y
->
subty≥
 = 
	`ht⁄l
(
NXT_STATUS_REPLY
);

108 
	`mem˝y
(
ª∂y
 + 1, 
§
.
ouçut
.
°rög
, sr.ouçut.
Àngth
);

109 
ªtvÆ
 = 
	`rc⁄n_£nd
(
rc
, 
b
, 
NULL
);

110 i‡(
ªtvÆ
 &&ÑëvÆ !
EAGAIN
) {

111 
	`VLOG_WARN
(
LOG_MODULE
, "£nd faûed (%s)", 
	`°ªº‹
(
ªtvÆ
));

113 
	`ds_de°roy
(&
§
.
ouçut
);

114  
åue
;

115 
	}
}

118 
	$rc⁄n_°©us_cb
(
°©us_ª∂y
 *
§
, *
rc⁄n_
)

120 
rc⁄n
 *rc⁄¿
rc⁄n_
;

121 
time_t
 
now
 = 
	`time_now
();

123 
	`°©us_ª∂y_put
(
§
, "«me=%s", 
	`rc⁄n_gë_«me
(
rc⁄n
));

124 
	`°©us_ª∂y_put
(
§
, "°©e=%s", 
	`rc⁄n_gë_°©e
(
rc⁄n
));

125 
	`°©us_ª∂y_put
(
§
, "backoff=%d", 
	`rc⁄n_gë_backoff
(
rc⁄n
));

126 
	`°©us_ª∂y_put
(
§
, "is-connected=%s",

127 
	`rc⁄n_is_c⁄√˘ed
(
rc⁄n
) ? "true" : "false");

128 
	`°©us_ª∂y_put
(
§
, "£¡-msgs=%u", 
	`rc⁄n_∑ckës_£¡
(
rc⁄n
));

129 
	`°©us_ª∂y_put
(
§
, "ª˚ived-msgs=%u", 
	`rc⁄n_∑ckës_ª˚ived
(
rc⁄n
));

130 
	`°©us_ª∂y_put
(
§
, "attempted-connections=%u",

131 
	`rc⁄n_gë_©ãm±ed_c⁄√˘i⁄s
(
rc⁄n
));

132 
	`°©us_ª∂y_put
(
§
, "successful-connections=%u",

133 
	`rc⁄n_gë_suc˚ssful_c⁄√˘i⁄s
(
rc⁄n
));

134 
	`°©us_ª∂y_put
(
§
, "last-connection=%ld",

135 (Ë(
now
 - 
	`rc⁄n_gë_œ°_c⁄√˘i⁄
(
rc⁄n
)));

136 
	`°©us_ª∂y_put
(
§
, "time-connected=%lu",

137 
	`rc⁄n_gë_tŸÆ_time_c⁄√˘ed
(
rc⁄n
));

138 
	`°©us_ª∂y_put
(
§
, "°©e-ñ≠£d=%u", 
	`rc⁄n_gë_°©e_ñ≠£d
(
rc⁄n
));

139 
	}
}

142 
	$c⁄fig_°©us_cb
(
°©us_ª∂y
 *
§
, *
s_
)

144 c⁄° 
£âögs
 *
s
 = 
s_
;

145 
size_t
 
i
;

147 
i
 = 0; i < 
s
->
n_li°íîs
; i++) {

148 
	`°©us_ª∂y_put
(
§
, "m™agemít%zu=%s", 
i
, 
s
->
li°íî_«mes
[i]);

150 i‡(
s
->
¥obe_öãrvÆ
) {

151 
	`°©us_ª∂y_put
(
§
, "¥obe-öãrvÆ=%d", 
s
->
¥obe_öãrvÆ
);

153 i‡(
s
->
max_backoff
) {

154 
	`°©us_ª∂y_put
(
§
, "max-backoff=%d", 
s
->
max_backoff
);

156 
	}
}

159 
	$swôch_°©us_cb
(
°©us_ª∂y
 *
§
, *
ss_
)

161 
swôch_°©us
 *
ss
 = 
ss_
;

162 
time_t
 
now
 = 
	`time_now
();

164 
	`°©us_ª∂y_put
(
§
, "now=%ld", (Ë
now
);

165 
	`°©us_ª∂y_put
(
§
, "u±ime=%ld", (Ë(
now
 - 
ss
->
boŸed
));

166 
	`°©us_ª∂y_put
(
§
, "pid=%ld", (Ë
	`gëpid
());

167 
	}
}

169 
hook_˛ass
 
	gswôch_°©us_hook_˛ass
 = {

170 
NULL
,

171 
swôch_°©us_ªmŸe_∑ckë_cb
,

172 
NULL
,

173 
NULL
,

174 
NULL
,

178 
	$swôch_°©us_°¨t
(
£cch™
 *£cch™, c⁄° 
£âögs
 *
s
,

179 
swôch_°©us
 **
s•
)

181 
swôch_°©us
 *
ss
 = 
	`xˇŒoc
(1,  *ss);

182 
ss
->
s
 = s;

183 
ss
->
boŸed
 = 
	`time_now
();

184 
	`swôch_°©us_ªgi°î_ˇãg‹y
(
ss
, "config",

185 
c⁄fig_°©us_cb
, (*Ë
s
);

186 
	`swôch_°©us_ªgi°î_ˇãg‹y
(
ss
, "swôch", 
swôch_°©us_cb
, ss);

187 *
s•
 = 
ss
;

188 
	`add_hook
(
£cch™
, &
swôch_°©us_hook_˛ass
, 
ss
);

189 
	}
}

192 
swôch_°©us_ªgi°î_ˇãg‹y
(
swôch_°©us
 *
ss
,

193 c⁄° *
ˇãg‹y
,

194 (*
cb
)(
°©us_ª∂y
 *, *
aux
),

195 *
aux
)

197 
swôch_°©us_ˇãg‹y
 *
c
;

198 i‡(
ss
->
n_ˇãg‹õs
 >ss->
Æloˇãd_ˇãg‹õs
) {

199 
ss
->
ˇãg‹õs
 = 
	`x2ƒóŒoc
(ss->ˇãg‹õs, &ss->
Æloˇãd_ˇãg‹õs
,

200  *
ss
->
ˇãg‹õs
);

202 
c
 = &
ss
->
ˇãg‹õs
[ss->
n_ˇãg‹õs
++];

203 
c
->
cb
 = cb;

204 
c
->
aux
 =áux;

205 
c
->
«me
 = 
	`x°rdup
(
ˇãg‹y
);

206 
	}
}

209 
	$°©us_ª∂y_put
(
°©us_ª∂y
 *
§
, c⁄° *
c⁄ã¡
, ...)

211 
size_t
 
ﬁd_Àngth
 = 
§
->
ouçut
.
Àngth
;

212 
size_t
 
added
;

213 
va_li°
 
¨gs
;

216 
	`ds_put_f‹m©
(&
§
->
ouçut
, "%s.", sr->
ˇãg‹y
->
«me
);

217 
	`va_°¨t
(
¨gs
, 
c⁄ã¡
);

218 
	`ds_put_f‹m©_vÆi°
(&
§
->
ouçut
, 
c⁄ã¡
, 
¨gs
);

219 
	`va_íd
(
¨gs
);

220 i‡(
	`ds_œ°
(&
§
->
ouçut
) != '\n') {

221 
	`ds_put_ch¨
(&
§
->
ouçut
, '\n');

225 
added
 = 
§
->
ouçut
.
Àngth
 - 
ﬁd_Àngth
;

226 i‡(
added
 < 
§
->
ªque°
.
Àngth


227 || 
	`memcmp
(&
§
->
ouçut
.
°rög
[
ﬁd_Àngth
],

228 
§
->
ªque°
.
°rög
, sr->ªque°.
Àngth
)) {

229 
	`ds_åunˇã
(&
§
->
ouçut
, 
ﬁd_Àngth
);

231 
	}
}

	@secchan/status.h

34 #i‚de‡
STATUS_H


35 
	#STATUS_H
 1

	)

37 
	~"£cch™.h
"

39 
	g£cch™
;

40 
	g°©us_ª∂y
;

41 
	gswôch_°©us
;

43 
swôch_°©us_°¨t
(
£cch™
 *, c⁄° 
£âögs
 *,

44 
swôch_°©us
 **);

45 
swôch_°©us_ªgi°î_ˇãg‹y
(
swôch_°©us
 *,

46 c⁄° *
ˇãg‹y
,

47 (*
cb
)(
°©us_ª∂y
 *,

48 *
aux
),

49 *
aux
);

51 
	$°©us_ª∂y_put
(
°©us_ª∂y
 *, const *, ...)

52 
	`PRINTF_FORMAT
(2, 3);

54 
	`rc⁄n_°©us_cb
(
°©us_ª∂y
 *, *
rc⁄n_
);

	@secchan/stp-secchan.c

34 
	~<c⁄fig.h
>

35 
	~"°p-£cch™.h
"

36 
	~<¨∑/öë.h
>

37 
	~<öây≥s.h
>

38 
	~"Êow.h
"

39 
	~"£cch™.h
"

40 
	~"oÂ.h
"

41 
	~"oÂbuf.h
"

42 
	~"›íÊow/›íÊow.h
"

43 
	~"pﬁl-lo›.h
"

44 
	~"p‹t-w©chî.h
"

45 
	~"rc⁄n.h
"

46 
	~"°p.h
"

47 
	~"timevÆ.h
"

48 
	~"vlog.h
"

50 
	#LOG_MODULE
 
VLM_°p_£cch™


	)

52 
	s°p_d©a
 {

53 
°p
 *
	m°p
;

54 
p‹t_w©chî
 *
	mpw
;

55 
rc⁄n
 *
	mloˇl_rc⁄n
;

56 
rc⁄n
 *
	mªmŸe_rc⁄n
;

57 
	mœ°_tick
;

58 
	mn_txq
;

61 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(60, 60);

63 
boﬁ


64 
	$°p_loˇl_∑ckë_cb
(
ªœy
 *
r
, *
°p_
)

66 
oÂbuf
 *
msg
 = 
r
->
hÆves
[
HALF_LOCAL
].
rxbuf
;

67 
oÂ_hódî
 *
oh
;

68 
°p_d©a
 *
°p
 = 
°p_
;

69 
oÂ_∑ckë_ö
 *
›i
;

70 
ëh_hódî
 *
ëh
;

71 
Œc_hódî
 *
Œc
;

72 
oÂbuf
 
∑ylﬂd
;

73 
uöt32_t
 
p‹t_no
;

74 
Êow
 flow;

76 
oh
 = 
msg
->
d©a
;

85 i‡(!
	`gë_oÂ_∑ckë_ëh_hódî
(
r
, &
›i
, &
ëh
)

86 || !
	`ëh_addr_equÆs
(
ëh
->
ëh_d°
, 
°p_ëh_addr
)) {

87  
Ál£
;

89 
p‹t_no
 = 0;

103 i‡(
›i
->
ªas⁄
 =
OFPR_ACTION
) {

105  
Ál£
;

108 
	`gë_oÂ_∑ckë_∑ylﬂd
(
›i
, &
∑ylﬂd
);

109 
	`Êow_exåa˘
(&
∑ylﬂd
, 
p‹t_no
, &
Êow
);

110 i‡(
Êow
.
dl_ty≥
 !
	`ht⁄s
(0x05ff)) {

111 
	`VLOG_DBG
(
LOG_MODULE
, "non-LLC frameÑeceived on STP multicastáddress");

112  
Ál£
;

114 
Œc
 = 
	`oÂbuf_©_as£π
(&
∑ylﬂd
,  *
ëh
,  *llc);

115 i‡(
Œc
->
Œc_dßp
 !
STP_LLC_DSAP
) {

116 
	`VLOG_DBG
(
LOG_MODULE
, "bad DSAP 0x%02"
PRIx8
"Ñeceived on STP multicastáddress",

117 
Œc
->
Œc_dßp
);

118  
Ál£
;

122 i‡(
∑ylﬂd
.
size
 > 
	`¡ohs
(
ëh
->
ëh_ty≥
Ë+ 
ETH_HEADER_LEN
) {

123 
∑ylﬂd
.
size
 = 
	`¡ohs
(
ëh
->
ëh_ty≥
Ë+ 
ETH_HEADER_LEN
;

125 i‡(
	`oÂbuf_åy_puŒ
(&
∑ylﬂd
, 
ETH_HEADER_LEN
 + 
LLC_HEADER_LEN
)) {

126 
°p_p‹t
 *
p
 = 
	`°p_gë_p‹t
(
°p
->°p, 
p‹t_no
);

127 
	`°p_ª˚ived_bpdu
(
p
, 
∑ylﬂd
.
d©a
,Öaylﬂd.
size
);

130  
åue
;

131 
	}
}

134 
	$°p_≥riodic_cb
(*
°p_
)

136 
°p_d©a
 *
°p
 = 
°p_
;

137 
now
 = 
	`time_m£c
();

138 
ñ≠£d
 = 
now
 - 
°p
->
œ°_tick
;

139 
°p_p‹t
 *
p
;

141 i‡(!
	`p‹t_w©chî_is_ªady
(
°p
->
pw
)) {

146 i‡(
ñ≠£d
 <= 0) {

150 
	`°p_tick
(
°p
->°p, 
	`MIN
(
INT_MAX
, 
ñ≠£d
));

151 
°p
->
œ°_tick
 = 
now
;

153 
	`°p_gë_ch™ged_p‹t
(
°p
->°p, &
p
)) {

154 
p‹t_no
 = 
	`°p_p‹t_no
(
p
);

155 
°p_°©e
 
s_°©e
 = 
	`°p_p‹t_gë_°©e
(
p
);

157 i‡(
s_°©e
 !
STP_DISABLED
) {

158 
	`VLOG_INFO
(
LOG_MODULE
, "STP: Port %dÉntered %s state",

159 
p‹t_no
, 
	`°p_°©e_«me
(
s_°©e
));

197 
	}
}

200 
	$°p_waô_cb
(*
°p_
 
UNUSED
)

202 
	`pﬁl_timî_waô
(1000);

203 
	}
}

206 
	$£nd_bpdu
(
oÂbuf
 *
pkt
, 
p‹t_no
, *
°p_
)

208 
°p_d©a
 *
°p
 = 
°p_
;

209 c⁄° 
uöt8_t
 *
p‹t_mac
 = 
	`p‹t_w©chî_gë_hwaddr
(
°p
->
pw
, 
p‹t_no
);

210 i‡(
p‹t_mac
) {

211 
ëh_hódî
 *
ëh
 = 
pkt
->
l2
;

212 
oÂbuf
 *
›o
;

214 
	`mem˝y
(
ëh
->
ëh_§c
, 
p‹t_mac
, 
ETH_ADDR_LEN
);

215 
›o
 = 
	`make_unbuf„ªd_∑ckë_out
(
pkt
, 
OFPP_ANY
, 
p‹t_no
);

217 
	`rc⁄n_£nd_wôh_limô
(
°p
->
loˇl_rc⁄n
, 
›o
, &°p->
n_txq
, 
OFPP_MAX
);

219 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "ˇ¬Ÿ síd BPDU o¿missögÖ‹à%d", 
p‹t_no
);

221 
	`oÂbuf_dñëe
(
pkt
);

222 
	}
}

224 
boﬁ


225 
	$°p_is_p‹t_suµ‹ãd
(
uöt32_t
 
p‹t_no
)

227  
p‹t_no
 < 
STP_MAX_PORTS
;

228 
	}
}

231 
	$°p_p‹t_ch™ged_cb
(
uöt32_t
 
p‹t_no
,

232 c⁄° 
oÂ_p‹t
 *
ﬁd
 
UNUSED
,

233 c⁄° 
oÂ_p‹t
 *
√w
,

234 *
°p_
)

236 
°p_d©a
 *
°p
 = 
°p_
;

237 
°p_p‹t
 *
p
;

239 i‡(!
	`°p_is_p‹t_suµ‹ãd
(
p‹t_no
)) {

243 
p
 = 
	`°p_gë_p‹t
(
°p
->°p, 
p‹t_no
);

244 i‡(!
√w


249 
	`°p_p‹t_dißbÀ
(
p
);

251 
•ìd
 = 0;

252 
	`°p_p‹t_íabÀ
(
p
);

253 i‡(
√w
->
cuº
 & (
OFPPF_10MB_HD
 | 
OFPPF_10MB_FD
)) {

254 
•ìd
 = 10;

255 } i‡(
√w
->
cuº
 & (
OFPPF_100MB_HD
 | 
OFPPF_100MB_FD
)) {

256 
•ìd
 = 100;

257 } i‡(
√w
->
cuº
 & (
OFPPF_1GB_HD
 | 
OFPPF_1GB_FD
)) {

258 
•ìd
 = 1000;

259 } i‡(
√w
->
cuº
 & 
OFPPF_10GB_FD
) {

260 
•ìd
 = 10000;

262 
	`°p_p‹t_£t_•ìd
(
p
, 
•ìd
);

264 
	}
}

267 
	$°p_loˇl_p‹t_ch™ged_cb
(c⁄° 
oÂ_p‹t
 *
p‹t
, *
°p_
)

269 
°p_d©a
 *
°p
 = 
°p_
;

270 i‡(
p‹t
) {

271 
	`°p_£t_bridge_id
(
°p
->°p, 
	`ëh_addr_to_uöt64
(
p‹t
->
hw_addr
));

273 
	}
}

275 
hook_˛ass
 
	g°p_hook_˛ass
 = {

276 
°p_loˇl_∑ckë_cb
,

277 
NULL
,

278 
°p_≥riodic_cb
,

279 
°p_waô_cb
,

280 
NULL
,

284 
	$°p_°¨t
(
£cch™
 *£cch™, 
p‹t_w©chî
 *
pw
,

285 
rc⁄n
 *
loˇl
, rc⁄¿*
ªmŸe
)

287 
uöt8_t
 
dpid
[
ETH_ADDR_LEN
];

288 
°p_d©a
 *
°p
;

290 
°p
 = 
	`xˇŒoc
(1,  *stp);

291 
	`ëh_addr_øndom
(
dpid
);

292 
°p
->°∞
	`°p_¸óã
("°p", 
	`ëh_addr_to_uöt64
(
dpid
), 
£nd_bpdu
, stp);

293 
°p
->
pw
 =Öw;

294 
°p
->
loˇl_rc⁄n
 = 
loˇl
;

295 
°p
->
ªmŸe_rc⁄n
 = 
ªmŸe
;

296 
°p
->
œ°_tick
 = 
	`time_m£c
();

298 
	`p‹t_w©chî_ªgi°î_ˇŒback
(
pw
, 
°p_p‹t_ch™ged_cb
, 
°p
);

299 
	`p‹t_w©chî_ªgi°î_loˇl_p‹t_ˇŒback
(
pw
, 
°p_loˇl_p‹t_ch™ged_cb
,

300 
°p
);

301 
	`add_hook
(
£cch™
, &
°p_hook_˛ass
, 
°p
);

302 
	}
}

	@secchan/stp-secchan.h

34 #i‚de‡
STP_SECCHAN_H


35 
	#STP_SECCHAN_H
 1

	)

39 
	#STP_EXTRA_BOOT_TIME
 30

	)

41 
	gp‹t_w©chî
;

42 
	grc⁄n
;

43 
	g£cch™
;

45 
°p_°¨t
(
£cch™
 *, 
p‹t_w©chî
 *,

46 
rc⁄n
 *
loˇl
, rc⁄¿*
ªmŸe
);

	@udatapath/action_set.c

31 
	~<°dlib.h
>

32 
	~"a˘i⁄_£t.h
"

33 
	~"dp_a˘i⁄s.h
"

34 
	~"d©≠©h.h
"

35 
	~"∑ckë.h
"

36 
	~"oÊib/oÊ.h
"

37 
	~"oÊib/oÊ-a˘i⁄s.h
"

38 
	~"oÊib/oÊ-¥öt.h
"

39 
	~"∑ckë.h
"

40 
	~"li°.h
"

41 
	~"utû.h
"

42 
	~"vlog.h
"

44 
	#LOG_MODULE
 
VLM_a˘i⁄_£t


	)

46 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(60, 60);

48 
	ga˘i⁄_£t_íåy
;

50 
	sa˘i⁄_£t
 {

51 
li°
 
	ma˘i⁄s
;

54 
oÊ_exp
 *
	mexp
;

57 
	sa˘i⁄_£t_íåy
 {

58 
li°
 
	mnode
;

60 
oÊ_a˘i⁄_hódî
 *
	ma˘i⁄
;

62 
	m‹dî
;

73 
	$a˘i⁄_£t_‹dî
(
oÊ_a˘i⁄_hódî
 *
a˘
) {

74 
a˘
->
ty≥
) {

75 (
OFPAT_COPY_TTL_OUT
):  40;

76 (
OFPAT_COPY_TTL_IN
):  10;

77 (
OFPAT_SET_FIELD
):  60;

78 (
OFPAT_SET_MPLS_TTL
):  60;

79 (
OFPAT_DEC_MPLS_TTL
):  50;

80 (
OFPAT_PUSH_PBB
):  30;

81 (
OFPAT_POP_PBB
):  20;

82 (
OFPAT_PUSH_VLAN
):  30;

83 (
OFPAT_POP_VLAN
):  20;

84 (
OFPAT_PUSH_MPLS
):  30;

85 (
OFPAT_POP_MPLS
):  20;

86 (
OFPAT_SET_QUEUE
):  70;

87 (
OFPAT_GROUP
):  80;

88 (
OFPAT_SET_NW_TTL
):  60;

89 (
OFPAT_DEC_NW_TTL
):  50;

90 (
OFPAT_OUTPUT
):  90;

91 (
OFPAT_EXPERIMENTER
):  75;

94 
	}
}

98 
a˘i⁄_£t
 *

99 
	$a˘i⁄_£t_¸óã
(
oÊ_exp
 *
exp
) {

100 
a˘i⁄_£t
 *
£t
 = 
	`xmÆloc
((action_set));

101 
	`li°_öô
(&
£t
->
a˘i⁄s
);

102 
£t
->
exp
 =Éxp;

104  
£t
;

105 
	}
}

107 
	$a˘i⁄_£t_de°roy
(
a˘i⁄_£t
 *
£t
) {

108 
	`a˘i⁄_£t_˛ór_a˘i⁄s
(
£t
);

109 
	`‰ì
(
£t
);

110 
	}
}

112 
a˘i⁄_£t_íåy
 *

113 
	$a˘i⁄_£t_¸óã_íåy
(
oÊ_a˘i⁄_hódî
 *
a˘
) {

114 
a˘i⁄_£t_íåy
 *
íåy
;

116 
íåy
 = 
	`xmÆloc
((
a˘i⁄_£t_íåy
));

117 
íåy
->
a˘i⁄
 = 
a˘
;

118 
íåy
->
‹dî
 = 
	`a˘i⁄_£t_‹dî
(
a˘
);

120  
íåy
;

121 
	}
}

123 
a˘i⁄_£t
 *

124 
	$a˘i⁄_£t_˛⁄e
(
a˘i⁄_£t
 *
£t
) {

125 
a˘i⁄_£t
 *
s
 = 
	`xmÆloc
((action_set));

126 
a˘i⁄_£t_íåy
 *
íåy
, *
√w_íåy
;

128 
	`li°_öô
(&
s
->
a˘i⁄s
);

129 
s
->
exp
 = 
£t
->exp;

131 
	`LIST_FOR_EACH
(
íåy
, 
a˘i⁄_£t_íåy
, 
node
, &
£t
->
a˘i⁄s
) {

132 
√w_íåy
 = 
	`a˘i⁄_£t_¸óã_íåy
(
íåy
->
a˘i⁄
);

133 
	`li°_push_back
(&
s
->
a˘i⁄s
, &
√w_íåy
->
node
);

136  
s
;

137 
	}
}

144 
	$a˘i⁄_£t_wrôe_a˘i⁄
(
a˘i⁄_£t
 *
£t
,

145 
oÊ_a˘i⁄_hódî
 *
a˘
) {

146 
a˘i⁄_£t_íåy
 *
íåy
, *
√w_íåy
;

148 
√w_íåy
 = 
	`a˘i⁄_£t_¸óã_íåy
(
a˘
);

150 
	`LIST_FOR_EACH
(
íåy
, 
a˘i⁄_£t_íåy
, 
node
, &
£t
->
a˘i⁄s
) {

151 i‡(
íåy
->
a˘i⁄
->
ty≥
 =
√w_íåy
->action->type) {

152 if(
íåy
->
a˘i⁄
->
ty≥
 =
OFPAT_SET_FIELD
){

153 
oÊ_a˘i⁄_£t_fõld
 *
√w_a˘
 =

154 (
oÊ_a˘i⁄_£t_fõld
*Ë
√w_íåy
->
a˘i⁄
;

155 
oÊ_a˘i⁄_£t_fõld
 *
a˘
 =

156 (
oÊ_a˘i⁄_£t_fõld
 *Ë
íåy
->
a˘i⁄
;

157 if(
a˘
->
fõld
->
hódî
 !
√w_a˘
->field->header){

162 
	`li°_ª∂a˚
(&
√w_íåy
->
node
, &
íåy
->node);

165 
	`‰ì
(
íåy
);

169 i‡(
√w_íåy
->
‹dî
 < 
íåy
->order) {

171 
	`li°_ö£π
(&
íåy
->
node
, &
√w_íåy
->node);

178 
	`li°_ö£π
(&
íåy
->
node
, &
√w_íåy
->node);

179 
	}
}

183 
	$a˘i⁄_£t_wrôe_a˘i⁄s
(
a˘i⁄_£t
 *
£t
,

184 
size_t
 
a˘i⁄s_num
,

185 
oÊ_a˘i⁄_hódî
 **
a˘i⁄s
) {

186 
size_t
 
i
;

187 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "WritingÅoáction set.");

188 
i
=0; i<
a˘i⁄s_num
; i++) {

189 
	`a˘i⁄_£t_wrôe_a˘i⁄
(
£t
, 
a˘i⁄s
[
i
]);

191 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, 
	`a˘i⁄_£t_to_°rög
(
£t
));

192 
	}
}

195 
	$a˘i⁄_£t_˛ór_a˘i⁄s
(
a˘i⁄_£t
 *
£t
) {

196 
a˘i⁄_£t_íåy
 *
íåy
, *
√xt
;

198 
	`LIST_FOR_EACH_SAFE
(
íåy
, 
√xt
, 
a˘i⁄_£t_íåy
, 
node
, &
£t
->
a˘i⁄s
) {

199 
	`li°_ªmove
(&
íåy
->
node
);

202 
	`‰ì
(
íåy
);

204 
	}
}

207 
	$a˘i⁄_£t_execuã
(
a˘i⁄_£t
 *
£t
, 
∑ckë
 *
pkt
, 
uöt64_t
 
cookõ
) {

208 
a˘i⁄_£t_íåy
 *
íåy
, *
√xt
;

210 
	`LIST_FOR_EACH_SAFE
(
íåy
, 
√xt
, 
a˘i⁄_£t_íåy
, 
node
, &
£t
->
a˘i⁄s
) {

211 
	`dp_execuã_a˘i⁄
(
pkt
, 
íåy
->
a˘i⁄
);

212 
	`li°_ªmove
(&
íåy
->
node
);

213 
	`‰ì
(
íåy
);

217 i‡(
pkt
->
out_group
 !
OFPG_ANY
) {

218 
uöt32_t
 
group_id
 = 
pkt
->
out_group
;

219 
pkt
->
out_group
 = 
OFPG_ANY
;

221 
	`a˘i⁄_£t_˛ór_a˘i⁄s
(
pkt
->
a˘i⁄_£t
);

222 
	`group_èbÀ_execuã
(
pkt
->
dp
->
groups
,Ökt, 
group_id
);

225 } i‡(
pkt
->
out_p‹t
 !
OFPP_ANY
) {

226 
uöt32_t
 
p‹t_id
 = 
pkt
->
out_p‹t
;

227 
uöt32_t
 
queue_id
 = 
pkt
->
out_queue
;

228 
uöt16_t
 
max_Àn
 = 
pkt
->
out_p‹t_max_Àn
;

229 
pkt
->
out_p‹t
 = 
OFPP_ANY
;

230 
pkt
->
out_p‹t_max_Àn
 = 0;

231 
pkt
->
out_queue
 = 0;

233 
	`a˘i⁄_£t_˛ór_a˘i⁄s
(
pkt
->
a˘i⁄_£t
);

234 
	`dp_a˘i⁄s_ouçut_p‹t
(
pkt
, 
p‹t_id
, 
queue_id
, 
max_Àn
, 
cookõ
);

238 
	}
}

241 
	$a˘i⁄_£t_to_°rög
(
a˘i⁄_£t
 *
£t
) {

242 *
°r
;

243 
size_t
 
°r_size
;

244 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

246 
	`a˘i⁄_£t_¥öt
(
°ªam
, 
£t
);

248 
	`f˛o£
(
°ªam
);

249  
°r
;

250 
	}
}

253 
	$a˘i⁄_£t_¥öt
(
FILE
 *
°ªam
, 
a˘i⁄_£t
 *
£t
) {

254 
a˘i⁄_£t_íåy
 *
íåy
;

256 
	`Ârötf
(
°ªam
, "[");

258 
	`LIST_FOR_EACH
(
íåy
, 
a˘i⁄_£t_íåy
, 
node
, &
£t
->
a˘i⁄s
) {

259 
	`oÊ_a˘i⁄_¥öt
(
°ªam
, 
íåy
->
a˘i⁄
, 
£t
->
exp
);

260 i‡(
íåy
->
node
.
√xt
 !&
£t
->
a˘i⁄s
Ë{ 
	`Ârötf
(
°ªam
, ", "); }

263 
	`Ârötf
(
°ªam
, "]");

264 
	}
}

	@udatapath/action_set.h

32 #i‚de‡
ACTION_SET_H


33 
	#ACTION_SET_H
 1

	)

35 
	~<sys/ty≥s.h
>

36 
	~<°dio.h
>

37 
	~"d©≠©h.h
"

38 
	~"∑ckë.h
"

39 
	~"oÊib/oÊ.h
"

40 
	~"oÊib/oÊ-a˘i⁄s.h
"

41 
	~"oÊib/oÊ-°ru˘s.h
"

43 
	ga˘i⁄_£t
;

44 
	gd©≠©h
;

45 
	g∑ckë
;

52 
a˘i⁄_£t
 *

53 
a˘i⁄_£t_¸óã
(
oÊ_exp
 *
exp
);

57 
a˘i⁄_£t_de°roy
(
a˘i⁄_£t
 *
£t
);

61 
a˘i⁄_£t
 *

62 
a˘i⁄_£t_˛⁄e
(
a˘i⁄_£t
 *
£t
);

67 
a˘i⁄_£t_wrôe_a˘i⁄s
(
a˘i⁄_£t
 *
£t
,

68 
size_t
 
a˘i⁄s_num
,

69 
oÊ_a˘i⁄_hódî
 **
a˘i⁄s
);

74 
a˘i⁄_£t_˛ór_a˘i⁄s
(
a˘i⁄_£t
 *
£t
);

79 
a˘i⁄_£t_execuã
(
a˘i⁄_£t
 *
£t
, 
∑ckë
 *
pkt
, 
uöt64_t
 
cookõ
);

83 
a˘i⁄_£t_to_°rög
(
a˘i⁄_£t
 *
£t
);

88 
a˘i⁄_£t_¥öt
(
FILE
 *
°ªam
, 
a˘i⁄_£t
 *
£t
);

	@udatapath/crc32.c

34 
	~<c⁄fig.h
>

35 
	~"¸c32.h
"

38 
	$¸c32_öô
(
¸c32
 *
¸c
, 
pﬁynomül
)

40 
i
;

42 
i
 = 0; i < 
CRC32_TABLE_SIZE
; ++i) {

43 
ªg
 = 
i
 << 24;

44 
j
;

45 
j
 = 0; j < 
CRC32_TABLE_BITS
; j++) {

46 
t›Bô
 = (
ªg
 & 0x80000000) != 0;

47 
ªg
 <<= 1;

48 i‡(
t›Bô
)

49 
ªg
 ^
pﬁynomül
;

51 
¸c
->
èbÀ
[
i
] = 
ªg
;

53 
	}
}

56 
	$¸c32_ˇlcuœã
(c⁄° 
¸c32
 *
¸c
, c⁄° *
d©a_
, 
size_t
 
n_byãs
)

58 c⁄° 
uöt8_t
 *
d©a
 = 
d©a_
;

59 
ªsu…
 = 0;

60 
size_t
 
i
;

62 
i
 = 0; i < 
n_byãs
; i++) {

63 
t›
 = 
ªsu…
 >> 24;

64 
t›
 ^
d©a
[
i
];

65 
ªsu…
 = (ªsu… << 8Ë^ 
¸c
->
èbÀ
[
t›
];

67  
ªsu…
;

68 
	}
}

	@udatapath/crc32.h

34 #i‚de‡
CRC32_H


35 
	#CRC32_H
 1

	)

37 
	~<°döt.h
>

38 
	~<°ddef.h
>

40 
	#CRC32_TABLE_BITS
 8

	)

41 
	#CRC32_TABLE_SIZE
 (1u << 
CRC32_TABLE_BITS
)

	)

43 
	s¸c32
 {

44 
	mèbÀ
[
CRC32_TABLE_SIZE
];

47 
¸c32_öô
(
¸c32
 *, 
pﬁynomül
);

48 
¸c32_ˇlcuœã
(c⁄° 
¸c32
 *, c⁄° *, 
size_t
);

	@udatapath/datapath.c

40 
	~"d©≠©h.h
"

41 
	~<as£π.h
>

42 
	~<î∫o.h
>

43 
	~<öây≥s.h
>

44 
	~<°dlib.h
>

45 
	~<°rög.h
>

46 
	~<uni°d.h
>

47 
	~"csum.h
"

48 
	~"dp_buf„rs.h
"

49 
	~"dp_c⁄åﬁ.h
"

50 
	~"oÂ.h
"

51 
	~"oÂbuf.h
"

52 
	~"group_èbÀ.h
"

53 
	~"mëî_èbÀ.h
"

54 
	~"oÊib/oÊ.h
"

55 
	~"oÊib-exp/oÊ-exp.h
"

56 
	~"oÊib-exp/oÊ-exp-nicúa.h
"

57 
	~"oÊib/oÊ-mesßges.h
"

58 
	~"oÊib/oÊ-log.h
"

59 
	~"›íÊow/›íÊow.h
"

60 
	~"›íÊow/nicúa-ext.h
"

61 
	~"›íÊow/¥iv©e-ext.h
"

62 
	~"›íÊow/›íÊow-ext.h
"

63 
	~"pùñöe.h
"

64 
	~"pﬁl-lo›.h
"

65 
	~"rc⁄n.h
"

66 
	~"°p.h
"

67 
	~"vc⁄n.h
"

69 
	#LOG_MODULE
 
VLM_dp


	)

71 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(60, 60);

74 
ªmŸe
 *
ªmŸe_¸óã
(
d©≠©h
 *
dp
, 
rc⁄n
 *rc⁄n, rc⁄¿*
rc⁄n_aux
);

75 
ªmŸe_run
(
d©≠©h
 *, 
ªmŸe
 *);

76 
ªmŸe_rc⁄n_run
(
d©≠©h
 *, 
ªmŸe
 *, 
uöt8_t
);

77 
ªmŸe_waô
(
ªmŸe
 *);

78 
ªmŸe_de°roy
(
ªmŸe
 *);

81 
	#MFR_DESC
 "Sènf‹d Univîsôy, Ericss⁄ Re£¨chánd CPqD Re£¨ch"

	)

82 
	#HW_DESC
 "O≥nFlow 1.3 Re„ªn˚ U£r•a˚ Swôch"

	)

83 
	#SW_DESC
 
__DATE__
" "
__TIME__


	)

84 
	#DP_DESC
 "O≥nFlow 1.3 Re„ªn˚ U£r•a˚ Swôch D©≠©h"

	)

85 
	#SERIAL_NUM
 "1"

	)

87 
	#MAIN_CONNECTION
 0

	)

88 
	#PTIN_CONNECTION
 1

	)

92 
oÊ_exp_msg
 
	gdp_exp_msg
 =

93 {.
∑ck
 = 
oÊ_exp_msg_∑ck
,

94 .
	gu≈ack
 = 
oÊ_exp_msg_u≈ack
,

95 .
	g‰ì
 = 
oÊ_exp_msg_‰ì
,

96 .
	gto_°rög
 = 
oÊ_exp_msg_to_°rög
};

98 
oÊ_exp
 
	gdp_exp
 =

99 {.
a˘
 = 
NULL
,

100 .
	gö°
 = 
NULL
,

101 .
	gm©ch
 = 
NULL
,

102 .
	g°©s
 = 
NULL
,

103 .
	gmsg
 = &
dp_exp_msg
};

106 
uöt64_t


107 
	$gí_d©≠©h_id
() {

108 
uöt8_t
 
ó
[
ETH_ADDR_LEN
];

109 
	`ëh_addr_øndom
(
ó
);

110  
	`ëh_addr_to_uöt64
(
ó
);

111 
	}
}

114 
d©≠©h
 *

115 
	$dp_√w
() {

116 
d©≠©h
 *
dp
;

117 
dp
 = 
	`xmÆloc
((
d©≠©h
));

119 
dp
->
m‰_desc
 = 
	`°∫˝y
(
	`xmÆloc
(
DESC_STR_LEN
), 
MFR_DESC
, DESC_STR_LEN);

120 
dp
->
m‰_desc
[
DESC_STR_LEN
-1] = 0x00;

121 
dp
->
hw_desc
 = 
	`°∫˝y
(
	`xmÆloc
(
DESC_STR_LEN
), 
HW_DESC
, DESC_STR_LEN);

122 
dp
->
hw_desc
[
DESC_STR_LEN
-1] = 0x00;

123 
dp
->
sw_desc
 = 
	`°∫˝y
(
	`xmÆloc
(
DESC_STR_LEN
), 
SW_DESC
, DESC_STR_LEN);

124 
dp
->
sw_desc
[
DESC_STR_LEN
-1] = 0x00;

125 
dp
->
dp_desc
 = 
	`°∫˝y
(
	`xmÆloc
(
DESC_STR_LEN
), 
DP_DESC
, DESC_STR_LEN);

126 
dp
->
dp_desc
[
DESC_STR_LEN
-1] = 0x00;

127 
dp
->
£rül_num
 = 
	`°∫˝y
(
	`xmÆloc
(
SERIAL_NUM_LEN
), 
SERIAL_NUM
, SERIAL_NUM_LEN);

128 
dp
->
£rül_num
[
SERIAL_NUM_LEN
-1] = 0x00;

131 
dp
->
id
 = 
	`gí_d©≠©h_id
();

133 
dp
->
gíî©i⁄_id
 = -1;

135 
dp
->
œ°_timeout
 = 
	`time_now
();

136 
	`li°_öô
(&
dp
->
ªmŸes
);

137 
dp
->
li°íîs
 = 
NULL
;

138 
dp
->
n_li°íîs
 = 0;

139 
dp
->
li°íîs_aux
 = 
NULL
;

140 
dp
->
n_li°íîs_aux
 = 0;

142 
	`mem£t
(
dp
->
p‹ts
, 0x00,  (dp->ports));

143 
dp
->
loˇl_p‹t
 = 
NULL
;

145 
dp
->
buf„rs
 = 
	`dp_buf„rs_¸óã
(dp);

146 
dp
->
pùñöe
 = 
	`pùñöe_¸óã
(dp);

147 
dp
->
groups
 = 
	`group_èbÀ_¸óã
(dp);

148 
dp
->
mëîs
 = 
	`mëî_èbÀ_¸óã
(dp);

150 
	`li°_öô
(&
dp
->
p‹t_li°
);

151 
dp
->
p‹ts_num
 = 0;

152 
dp
->
max_queues
 = 
NETDEV_MAX_QUEUES
;

154 
dp
->
exp
 = &
dp_exp
;

156 
dp
->
c⁄fig
.
Êags
 = 
OFPC_FRAG_NORMAL
;

157 
dp
->
c⁄fig
.
miss_£nd_Àn
 = 
OFP_DEFAULT_MISS_SEND_LEN
;

159 if(
	`°æí
(
dp
->
dp_desc
) == 0) {

161 
ho°«mëmp
[
DESC_STR_LEN
];

162 
	`gëho°«me
(
ho°«mëmp
, hostnametmp);

163 
	`¢¥ötf
(
dp
->
dp_desc
,  dp->dp_desc,"%†pid=%u",
ho°«mëmp
, 
	`gëpid
());

167 #i‡
	`deföed
(
OF_HW_PLAT
Ë&& (deföed(
UDATAPATH_AS_LIB
Ë|| deföed(
USE_NETDEV
))

168 
	`dp_hw_drv_öô
(
dp
);

171  
dp
;

172 
	}
}

176 
	$dp_add_pvc⁄n
(
d©≠©h
 *
dp
, 
pvc⁄n
 *pvc⁄n, pvc⁄¿*
pvc⁄n_aux
) {

177 
dp
->
li°íîs
 = 
	`xªÆloc
(dp->listeners,

178  *
dp
->
li°íîs
 * (dp->
n_li°íîs
 + 1));

179 
dp
->
li°íîs
[dp->
n_li°íîs
++] = 
pvc⁄n
;

181 
dp
->
li°íîs_aux
 = 
	`xªÆloc
(dp->listeners_aux,

182  *
dp
->
li°íîs_aux
 * (dp->
n_li°íîs_aux
 + 1));

183 
dp
->
li°íîs_aux
[dp->
n_li°íîs_aux
++] = 
pvc⁄n_aux
;

184 
	}
}

187 
	$dp_run
(
d©≠©h
 *
dp
) {

188 
time_t
 
now
 = 
	`time_now
();

189 
ªmŸe
 *
r
, *
∫
;

190 
size_t
 
i
;

192 i‡(
now
 !
dp
->
œ°_timeout
) {

193 
dp
->
œ°_timeout
 = 
now
;

194 
	`mëî_èbÀ_add_tokís
(
dp
->
mëîs
);

195 
	`pùñöe_timeout
(
dp
->
pùñöe
);

198 
	`pﬁl_timî_waô
(1000);

199 
	`dp_p‹ts_run
(
dp
);

202 
	`LIST_FOR_EACH_SAFE
 (
r
, 
∫
, 
ªmŸe
, 
node
, &
dp
->
ªmŸes
) {

203 
	`ªmŸe_run
(
dp
, 
r
);

206 
i
 = 0; i < 
dp
->
n_li°íîs
; ) {

207 
pvc⁄n
 *pvc⁄¿
dp
->
li°íîs
[
i
];

208 
vc⁄n
 *
√w_vc⁄n
;

210 
ªtvÆ
 = 
	`pvc⁄n_ac˚±
(
pvc⁄n
, 
OFP_VERSION
, &
√w_vc⁄n
);

211 i‡(!
ªtvÆ
) {

212 
rc⁄n
 * 
rc⁄n_aux
 = 
NULL
;

213 i‡(
dp
->
n_li°íîs_aux
 && dp->
li°íîs_aux
[
i
] !
NULL
) {

214 
pvc⁄n
 *
pvc⁄n_aux
 = 
dp
->
li°íîs_aux
[
i
];

215 
vc⁄n
 *
√w_vc⁄n_aux
;

216 
ªtvÆ_aux
 = 
	`pvc⁄n_ac˚±
(
pvc⁄n_aux
, 
OFP_VERSION
, &
√w_vc⁄n_aux
);

217 i‡(!
ªtvÆ_aux
)

218 
rc⁄n_aux
 = 
	`rc⁄n_√w_‰om_vc⁄n
("∑ssive_aux", 
√w_vc⁄n_aux
);

220 
	`ªmŸe_¸óã
(
dp
, 
	`rc⁄n_√w_‰om_vc⁄n
("∑ssive", 
√w_vc⁄n
), 
rc⁄n_aux
);

222 i‡(
ªtvÆ
 !
EAGAIN
) {

223 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "ac˚± faûed (%s)", 
	`°ªº‹
(
ªtvÆ
));

224 
dp
->
li°íîs
[
i
] = dp->li°íîs[--dp->
n_li°íîs
];

225 i‡(
dp
->
n_li°íîs_aux
) {

226 
dp
->
li°íîs_aux
[
i
] = dp->li°íîs_aux[--dp->
n_li°íîs_aux
];

230 
i
++;

232 
	}
}

235 
	$ªmŸe_run
(
d©≠©h
 *
dp
, 
ªmŸe
 *
r
)

237 
	`ªmŸe_rc⁄n_run
(
dp
, 
r
, 
MAIN_CONNECTION
);

239 i‡(!
	`rc⁄n_is_Æive
(
r
->
rc⁄n
)) {

240 
	`ªmŸe_de°roy
(
r
);

244 i‡(
r
->
rc⁄n_aux
 =
NULL
 || !
	`rc⁄n_is_Æive
(r->rconn_aux))

247 
	`ªmŸe_rc⁄n_run
(
dp
, 
r
, 
PTIN_CONNECTION
);

248 
	}
}

251 
	$ªmŸe_rc⁄n_run
(
d©≠©h
 *
dp
, 
ªmŸe
 *
r
, 
uöt8_t
 
c⁄n_id
) {

252 
rc⁄n
 *rconn;

253 
oÊ_îr
 
îr‹
;

254 
size_t
 
i
;

256 i‡(
c⁄n_id
 =
MAIN_CONNECTION
)

257 
rc⁄n
 = 
r
->rconn;

258 i‡(
c⁄n_id
 =
PTIN_CONNECTION
)

259 
rc⁄n
 = 
r
->
rc⁄n_aux
;

261 
	`rc⁄n_run
(
rc⁄n
);

264 
i
 = 0; i < 50; i++) {

265 i‡(!
r
->
cb_dump
) {

266 
oÂbuf
 *
buf„r
;

268 
buf„r
 = 
	`rc⁄n_ªcv
(
rc⁄n
);

269 i‡(
buf„r
 =
NULL
) {

272 
oÊ_msg_hódî
 *
msg
;

274 
£ndî
 sídî = {.
ªmŸe
 = 
r
, .
c⁄n_id
 = conn_id};

276 
îr‹
 = 
	`oÊ_msg_u≈ack
(
buf„r
->
d©a
, buf„r->
size
, &
msg
, &(
£ndî
.
xid
), 
dp
->
exp
);

278 i‡(!
îr‹
) {

279 
îr‹
 = 
	`h™dÀ_c⁄åﬁ_msg
(
dp
, 
msg
, &
£ndî
);

281 i‡(
îr‹
) {

282 
	`oÊ_msg_‰ì
(
msg
, 
dp
->
exp
);

286 i‡(
îr‹
) {

287 
oÊ_msg_îr‹
 
îr
 =

288 {{.
ty≥
 = 
OFPT_ERROR
},

289 .
ty≥
 = 
	`oÊ_îr‹_ty≥
(
îr‹
),

290 .
code
 = 
	`oÊ_îr‹_code
(
îr‹
),

291 .
d©a_Àngth
 = 
buf„r
->
size
,

292 .
d©a
 = 
buf„r
->data};

293 
	`dp_£nd_mesßge
(
dp
, (
oÊ_msg_hódî
 *)&
îr
, &
£ndî
);

296 
	`oÂbuf_dñëe
(
buf„r
);

299 i‡(
r
->
n_txq
 < 
TXQ_LIMIT
) {

300 
îr‹
 = 
r
->
	`cb_dump
(
dp
,Ñ->
cb_aux
);

301 i‡(
îr‹
 <= 0) {

302 i‡(
îr‹
) {

303 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "CallbackÉrror: %s.",

304 
	`°ªº‹
(-
îr‹
));

306 
r
->
	`cb_d⁄e
‘->
cb_aux
);

307 
r
->
cb_dump
 = 
NULL
;

314 
	}
}

317 
	$ªmŸe_waô
(
ªmŸe
 *
r
)

319 
	`rc⁄n_run_waô
(
r
->
rc⁄n
);

320 
	`rc⁄n_ªcv_waô
(
r
->
rc⁄n
);

322 i‡(
r
->
rc⁄n_aux
) {

323 
	`rc⁄n_run_waô
(
r
->
rc⁄n_aux
);

324 
	`rc⁄n_ªcv_waô
(
r
->
rc⁄n_aux
);

326 
	}
}

329 
	$ªmŸe_de°roy
(
ªmŸe
 *
r
)

331 i‡(
r
) {

332 i‡(
r
->
cb_dump
 &&Ñ->
cb_d⁄e
) {

333 
r
->
	`cb_d⁄e
‘->
cb_aux
);

335 
	`li°_ªmove
(&
r
->
node
);

336 i‡(
r
->
rc⁄n_aux
 !
NULL
) {

337 
	`rc⁄n_de°roy
(
r
->
rc⁄n_aux
);

339 
	`rc⁄n_de°roy
(
r
->
rc⁄n
);

340 
	`‰ì
(
r
);

342 
	}
}

344 
ªmŸe
 *

345 
	$ªmŸe_¸óã
(
d©≠©h
 *
dp
, 
rc⁄n
 *rc⁄n, rc⁄¿*
rc⁄n_aux
)

347 
size_t
 
i
;

348 
ªmŸe
 *ªmŸê
	`xmÆloc
( *remote);

349 
	`li°_push_back
(&
dp
->
ªmŸes
, &
ªmŸe
->
node
);

350 
ªmŸe
->
rc⁄n
 =Ñconn;

351 
ªmŸe
->
rc⁄n_aux
 =Ñconn_aux;

352 
ªmŸe
->
cb_dump
 = 
NULL
;

353 
ªmŸe
->
n_txq
 = 0;

354 
ªmŸe
->
rﬁe
 = 
OFPCR_ROLE_EQUAL
;

356 
i
 = 0; i < 2; i++){

357 
	`mem£t
(&
ªmŸe
->
c⁄fig
.
∑ckë_ö_mask
[
i
], 0x7, (
uöt32_t
));

358 
	`mem£t
(&
ªmŸe
->
c⁄fig
.
p‹t_°©us_mask
[
i
], 0x7, (
uöt32_t
));

359 
	`mem£t
(&
ªmŸe
->
c⁄fig
.
Êow_ªmoved_mask
[
i
], 0x1f, (
uöt32_t
));

361  
ªmŸe
;

362 
	}
}

366 
	$dp_waô
(
d©≠©h
 *
dp
)

368 
sw_p‹t
 *
p
;

369 
ªmŸe
 *
r
;

370 
size_t
 
i
;

372 
	`LIST_FOR_EACH
 (
p
, 
sw_p‹t
, 
node
, &
dp
->
p‹t_li°
) {

373 i‡(
	`IS_HW_PORT
(
p
)) {

376 
	`√tdev_ªcv_waô
(
p
->
√tdev
);

378 
	`LIST_FOR_EACH
 (
r
, 
ªmŸe
, 
node
, &
dp
->
ªmŸes
) {

379 
	`ªmŸe_waô
(
r
);

381 
i
 = 0; i < 
dp
->
n_li°íîs
; i++) {

382 
	`pvc⁄n_waô
(
dp
->
li°íîs
[
i
]);

384 
	}
}

387 
	$dp_£t_dpid
(
d©≠©h
 *
dp
, 
uöt64_t
 
dpid
) {

388 
dp
->
id
 = 
dpid
;

389 
	}
}

392 
	$dp_£t_m‰_desc
(
d©≠©h
 *
dp
, *
m‰_desc
) {

393 
	`°∫˝y
(
dp
->
m‰_desc
, m‰_desc, 
DESC_STR_LEN
);

394 
dp
->
m‰_desc
[
DESC_STR_LEN
-1] = 0x00;

395 
	}
}

398 
	$dp_£t_hw_desc
(
d©≠©h
 *
dp
, *
hw_desc
) {

399 
	`°∫˝y
(
dp
->
hw_desc
, hw_desc, 
DESC_STR_LEN
);

400 
dp
->
hw_desc
[
DESC_STR_LEN
-1] = 0x00;

401 
	}
}

404 
	$dp_£t_sw_desc
(
d©≠©h
 *
dp
, *
sw_desc
) {

405 
	`°∫˝y
(
dp
->
sw_desc
, sw_desc, 
DESC_STR_LEN
);

406 
dp
->
sw_desc
[
DESC_STR_LEN
-1] = 0x00;

407 
	}
}

410 
	$dp_£t_dp_desc
(
d©≠©h
 *
dp
, *
dp_desc
) {

411 
	`°∫˝y
(
dp
->
dp_desc
, dp_desc, 
DESC_STR_LEN
);

412 
dp
->
dp_desc
[
DESC_STR_LEN
-1] = 0x00;

413 
	}
}

416 
	$dp_£t_£rül_num
(
d©≠©h
 *
dp
, *
£rül_num
) {

417 
	`°∫˝y
(
dp
->
£rül_num
, sîül_num, 
SERIAL_NUM_LEN
);

418 
dp
->
£rül_num
[
SERIAL_NUM_LEN
-1] = 0x00;

419 
	}
}

422 
	$dp_£t_max_queues
(
d©≠©h
 *
dp
, 
uöt32_t
 
max_queues
) {

423 
dp
->
max_queues
 = max_queues;

424 
	}
}

428 
	$£nd_›íÊow_buf„r_to_ªmŸe
(
oÂbuf
 *
buf„r
, 
ªmŸe
 *remote) {

429 
rc⁄n
*Ñc⁄¿
ªmŸe
->rconn;

430 
ªtvÆ
;

431 i‡(
buf„r
->
c⁄n_id
 =
PTIN_CONNECTION
 &&

432 
ªmŸe
->
rc⁄n
 !
NULL
 &&

433 
ªmŸe
->
rc⁄n_aux
 !
NULL
 &&

434 
	`rc⁄n_is_c⁄√˘ed
(
ªmŸe
->
rc⁄n
) &&

435 
	`rc⁄n_is_c⁄√˘ed
(
ªmŸe
->
rc⁄n_aux
)) {

436 
rc⁄n
 = 
ªmŸe
->
rc⁄n_aux
;

438 
ªtvÆ
 = 
	`rc⁄n_£nd_wôh_limô
(
rc⁄n
, 
buf„r
, &
ªmŸe
->
n_txq
,

439 
TXQ_LIMIT
);

441 i‡(
ªtvÆ
) {

442 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "sendÅo %s failed: %s",

443 
	`rc⁄n_gë_«me
(
rc⁄n
), 
	`°ªº‹
(
ªtvÆ
));

446  
ªtvÆ
;

447 
	}
}

450 
	$£nd_›íÊow_buf„r
(
d©≠©h
 *
dp
, 
oÂbuf
 *
buf„r
,

451 c⁄° 
£ndî
 *sender) {

452 
	`upd©e_›íÊow_Àngth
(
buf„r
);

453 i‡(
£ndî
) {

455  
	`£nd_›íÊow_buf„r_to_ªmŸe
(
buf„r
, 
£ndî
->
ªmŸe
);

459 
ªmŸe
 *
r
, *
¥ev
 = 
NULL
;

460 
uöt8_t
 
msg_ty≥
;

462 
	`mem˝y
(&
msg_ty≥
,((* ) 
buf„r
->
d©a
Ë+ 1, (
uöt8_t
));

463 
	`LIST_FOR_EACH
 (
r
, 
ªmŸe
, 
node
, &
dp
->
ªmŸes
) {

465 i‡(
r
->
rﬁe
 =
OFPCR_ROLE_EQUAL
 ||Ñ->rﬁê=
OFPCR_ROLE_MASTER
){

467 
msg_ty≥
){

468 (
OFPT_PACKET_IN
):{

469 
oÂ_∑ckë_ö
 *
p
 = (oÂ_∑ckë_ö*)
buf„r
->
d©a
;

471 if((
p
->
ªas⁄
 =
OFPR_NO_MATCH
Ë&& !(
r
->
c⁄fig
.
∑ckë_ö_mask
[0] & 0x1))

473 if((
p
->
ªas⁄
 =
OFPR_ACTION
Ë&& !(
r
->
c⁄fig
.
∑ckë_ö_mask
[0] & 0x2))

475 if((
p
->
ªas⁄
 =
OFPR_INVALID_TTL
Ë&& !(
r
->
c⁄fig
.
∑ckë_ö_mask
[0] & 0x4))

479 (
OFPT_PORT_STATUS
):{

480 
oÂ_p‹t_°©us
 *
p
 = (oÂ_p‹t_°©us*)
buf„r
->
d©a
;

481 if((
p
->
ªas⁄
 =
OFPPR_ADD
Ë&& !(
r
->
c⁄fig
.
p‹t_°©us_mask
[0] & 0x1))

483 if((
p
->
ªas⁄
 =
OFPPR_DELETE
Ë&& !(
r
->
c⁄fig
.
p‹t_°©us_mask
[0] & 0x2))

485 if((
p
->
ªas⁄
 =
OFPPR_MODIFY
Ë&& !(
r
->
c⁄fig
.
∑ckë_ö_mask
[0] & 0x4))

488 (
OFPT_FLOW_REMOVED
):{

489 
oÂ_Êow_ªmoved
 *
p
(oÂ_Êow_ªmoved *)
buf„r
->
d©a
;

490 if((
p
->
ªas⁄
 =
OFPRR_IDLE_TIMEOUT
Ë&& !(
r
->
c⁄fig
.
p‹t_°©us_mask
[0] & 0x1))

492 if((
p
->
ªas⁄
 =
OFPRR_HARD_TIMEOUT
Ë&& !(
r
->
c⁄fig
.
p‹t_°©us_mask
[0] & 0x2))

494 if((
p
->
ªas⁄
 =
OFPRR_DELETE
Ë&& !(
r
->
c⁄fig
.
∑ckë_ö_mask
[0] & 0x4))

496 if((
p
->
ªas⁄
 =
OFPRR_GROUP_DELETE
Ë&& !(
r
->
c⁄fig
.
∑ckë_ö_mask
[0] & 0x8))

498 if((
p
->
ªas⁄
 =
OFPRR_METER_DELETE
Ë&& !(
r
->
c⁄fig
.
∑ckë_ö_mask
[0] & 0x10))

506 i‡(
r
->
rﬁe
 =
OFPCR_ROLE_SLAVE
 && 
msg_ty≥
 !
OFPT_PORT_STATUS
) {

510 
oÂ_p‹t_°©us
 *
p
 = (oÂ_p‹t_°©us*)
buf„r
->
d©a
;

511 if((
p
->
ªas⁄
 =
OFPPR_ADD
Ë&& !(
r
->
c⁄fig
.
p‹t_°©us_mask
[1] & 0x1))

513 if((
p
->
ªas⁄
 =
OFPPR_DELETE
Ë&& !(
r
->
c⁄fig
.
p‹t_°©us_mask
[1] & 0x2))

515 if((
p
->
ªas⁄
 =
OFPPR_MODIFY
Ë&& !(
r
->
c⁄fig
.
∑ckë_ö_mask
[1] & 0x4))

519 i‡(
¥ev
) {

520 
	`£nd_›íÊow_buf„r_to_ªmŸe
(
	`oÂbuf_˛⁄e
(
buf„r
), 
¥ev
);

522 
¥ev
 = 
r
;

524 i‡(
¥ev
) {

525 
	`£nd_›íÊow_buf„r_to_ªmŸe
(
buf„r
, 
¥ev
);

527 
	`oÂbuf_dñëe
(
buf„r
);

531 
	}
}

534 
	$dp_£nd_mesßge
(
d©≠©h
 *
dp
, 
oÊ_msg_hódî
 *
msg
,

535 c⁄° 
£ndî
 *sender) {

536 
oÂbuf
 *ofpbuf;

537 
uöt8_t
 *
buf
;

538 
size_t
 
buf_size
;

539 
îr‹
;

541 i‡(
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

542 *
msg_°r
 = 
	`oÊ_msg_to_°rög
(
msg
, 
dp
->
exp
);

543 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "£ndög: %.400s", 
msg_°r
);

544 
	`‰ì
(
msg_°r
);

547 
îr‹
 = 
	`oÊ_msg_∑ck
(
msg
, 
£ndî
 =
NULL
 ? 0 : sídî->
xid
, &
buf
, &
buf_size
, 
dp
->
exp
);

548 i‡(
îr‹
) {

549 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "There wasánÉrrorÖackingÅhe message!");

550  
îr‹
;

552 
oÂbuf
 = 
	`oÂbuf_√w
(0);

553 
	`oÂbuf_u£
(
oÂbuf
, 
buf
, 
buf_size
);

554 
	`oÂbuf_put_unöô
(
oÂbuf
, 
buf_size
);

562 
oÂbuf
->
c⁄n_id
 = 
MAIN_CONNECTION
;

563 i‡(
£ndî
 !
NULL
)

564 
oÂbuf
->
c⁄n_id
 = 
£ndî
->conn_id;

565 i‡(
msg
->
ty≥
 =
OFPT_PACKET_IN
)

566 
oÂbuf
->
c⁄n_id
 = 
PTIN_CONNECTION
;

568 
îr‹
 = 
	`£nd_›íÊow_buf„r
(
dp
, 
oÂbuf
, 
£ndî
);

569 i‡(
îr‹
) {

570 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "There wasánÉrror sendingÅhe message!");

572 
	`oÂbuf_dñëe
(
oÂbuf
);

573  
îr‹
;

576 
	}
}

578 
oÊ_îr


579 
	$dp_h™dÀ_£t_desc
(
d©≠©h
 *
dp
, 
oÊ_exp_›íÊow_msg_£t_dp_desc
 *
msg
,

580 c⁄° 
£ndî
 *£ndî 
UNUSED
) {

581 
	`dp_£t_dp_desc
(
dp
, 
msg
->
dp_desc
);

582 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
dp
->
exp
);

584 
	}
}

586 
oÊ_îr


587 
	$dp_check_gíî©i⁄_id
(
d©≠©h
 *
dp
, 
uöt64_t
 
√w_gí_id
){

589 if(
dp
->
gíî©i⁄_id
 >0 && ((
uöt64_t
)(
√w_gí_id
 - dp->generation_id) < 0) )

590  
	`oÊ_îr‹
(
OFPET_ROLE_REQUEST_FAILED
, 
OFPRRFC_STALE
);

591 
dp
->
gíî©i⁄_id
 = 
√w_gí_id
;

594 
	}
}

596 
oÊ_îr


597 
	$dp_h™dÀ_rﬁe_ªque°
(
d©≠©h
 *
dp
, 
oÊ_msg_rﬁe_ªque°
 *
msg
,

598 c⁄° 
£ndî
 *sender) {

599 
uöt32_t
 
rﬁe
 = 
msg
->role;

600 
uöt64_t
 
gíî©i⁄_id
 = 
msg
->generation_id;

601 
msg
->
rﬁe
) {

602 
OFPCR_ROLE_NOCHANGE
:{

603 
rﬁe
 = 
£ndî
->
ªmŸe
->role;

604 
gíî©i⁄_id
 = 
dp
->generation_id;

607 
OFPCR_ROLE_EQUAL
: {

608 
£ndî
->
ªmŸe
->
rﬁe
 = 
OFPCR_ROLE_EQUAL
;

611 
OFPCR_ROLE_MASTER
: {

612 
ªmŸe
 *
r
;

613 
îr‹
 = 
	`dp_check_gíî©i⁄_id
(
dp
,
msg
->
gíî©i⁄_id
);

614 i‡(
îr‹
) {

615 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "Role message generation id is smallerÅhanÅhe current id!");

616  
îr‹
;

619 
	`LIST_FOR_EACH
 (
r
, 
ªmŸe
, 
node
, &
dp
->
ªmŸes
) {

620 i‡(
r
->
rﬁe
 =
OFPCR_ROLE_MASTER
) {

621 
r
->
rﬁe
 = 
OFPCR_ROLE_SLAVE
;

624 
£ndî
->
ªmŸe
->
rﬁe
 = 
OFPCR_ROLE_MASTER
;

627 
OFPCR_ROLE_SLAVE
: {

628 
îr‹
 = 
	`dp_check_gíî©i⁄_id
(
dp
,
msg
->
gíî©i⁄_id
);

629 i‡(
îr‹
) {

630 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "Role message generation id is smallerÅhanÅhe current id!");

631  
îr‹
;

633 
£ndî
->
ªmŸe
->
rﬁe
 = 
OFPCR_ROLE_SLAVE
;

637 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "Rﬁêªque° wôh unknow¿rﬁê(%u).", 
msg
->
rﬁe
);

638  
	`oÊ_îr‹
(
OFPET_ROLE_REQUEST_FAILED
, 
OFPRRFC_BAD_ROLE
);

643 
oÊ_msg_rﬁe_ªque°
 
ª∂y
 =

644 {{.
ty≥
 = 
OFPT_ROLE_REPLY
},

645 .
rﬁe
 =Ñole,

646 .
gíî©i⁄_id
 = generation_id};

648 
	`dp_£nd_mesßge
(
dp
, (
oÊ_msg_hódî
 *)&
ª∂y
, 
£ndî
);

651 
	}
}

653 
oÊ_îr


654 
	$dp_h™dÀ_async_ªque°
(
d©≠©h
 *
dp
, 
oÊ_msg_async_c⁄fig
 *
msg
,

655 c⁄° 
£ndî
 *sender) {

657 
uöt16_t
 
async_ty≥
 = 
msg
->
hódî
.
ty≥
;

658 
async_ty≥
){

659 (
OFPT_GET_ASYNC_REQUEST
):{

660 
oÊ_msg_async_c⁄fig
 
ª∂y
 =

661 {{.
ty≥
 = 
OFPT_GET_ASYNC_REPLY
},

662 .
c⁄fig
 = &
£ndî
->
ªmŸe
->config};

663 
	`dp_£nd_mesßge
(
dp
, (
oÊ_msg_hódî
 *)&
ª∂y
, 
£ndî
);

665 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
*)
msg
, 
dp
->
exp
);

669 (
OFPT_SET_ASYNC
):{

670 
	`mem˝y
(&
£ndî
->
ªmŸe
->
c⁄fig
, 
msg
->c⁄fig, (
oÊ_async_c⁄fig
));

675 
	}
}

	@udatapath/datapath.h

39 #i‚de‡
DATAPATH_H


40 
	#DATAPATH_H
 1

	)

43 
	~<°dboﬁ.h
>

44 
	~<°döt.h
>

45 
	~"dp_buf„rs.h
"

46 
	~"dp_p‹ts.h
"

47 
	~"›íÊow/nicúa-ext.h
"

48 
	~"oÂbuf.h
"

49 
	~"oÊib/oÊ.h
"

50 
	~"oÊib/oÊ-mesßges.h
"

51 
	~"oÊib/oÊ-°ru˘s.h
"

52 
	~"oÊib-exp/oÊ-exp-nicúa.h
"

53 
	~"group_èbÀ.h
"

54 
	~"timevÆ.h
"

55 
	~"li°.h
"

58 
	grc⁄n
;

59 
	gpvc⁄n
;

60 
	g£ndî
;

67 
	sd©≠©h
 {

70 *
	mm‰_desc
;

71 *
	mhw_desc
;

72 *
	msw_desc
;

73 *
	mdp_desc
;

74 *
	m£rül_num
;

76 
uöt64_t
 
	mid
;

78 
li°
 
	mªmŸes
;

80 
uöt64_t
 
	mgíî©i⁄_id
;

83 
pvc⁄n
 **
	mli°íîs
;

84 
size_t
 
	mn_li°íîs
;

85 
pvc⁄n
 **
	mli°íîs_aux
;

86 
size_t
 
	mn_li°íîs_aux
;

88 
time_t
 
	mœ°_timeout
;

90 
dp_buf„rs
 *
	mbuf„rs
;

92 
pùñöe
 *
	mpùñöe
;

94 
group_èbÀ
 *
	mgroups
;

96 
mëî_èbÀ
 *
	mmëîs
;

98 
oÊ_c⁄fig
 
	mc⁄fig
;

102 
uöt32_t
 
	mmax_queues
;

103 
sw_p‹t
 
	mp‹ts
[
DP_MAX_PORTS
 + 1];

104 
sw_p‹t
 *
	mloˇl_p‹t
;

105 
li°
 
	mp‹t_li°
;

106 
size_t
 
	mp‹ts_num
;

109 
oÊ_exp
 *
	mexp
;

111 #i‡
deföed
(
OF_HW_PLAT
)

116 
of_hw_drivî_t
 *
	mhw_drv
;

117 
hw_pkt_q_íåy
 *
	mhw_pkt_li°_hód
, *
	mhw_pkt_li°_èû
;

122 
	s£ndî
 {

123 
ªmŸe
 *
	mªmŸe
;

124 
uöt8_t
 
	mc⁄n_id
;

125 
uöt32_t
 
	mxid
;

129 
	sªmŸe
 {

130 
li°
 
	mnode
;

131 
rc⁄n
 *
	mrc⁄n
;

132 
rc⁄n
 *
	mrc⁄n_aux
;

134 
	#TXQ_LIMIT
 128

	)

135 
	mn_txq
;

142 (*
	mcb_dump
)(
	md©≠©h
 *, *
	maux
);

143 (*
	mcb_d⁄e
)(*
	maux
);

144 *
	mcb_aux
;

146 
uöt32_t
 
	mrﬁe
;

147 
oÊ_async_c⁄fig
 
	mc⁄fig
;

152 
d©≠©h
 *

153 
dp_√w
();

156 
dp_add_pvc⁄n
(
d©≠©h
 *
dp
, 
pvc⁄n
 *pvc⁄n, pvc⁄¿*
pvc⁄n_aux
);

161 
dp_run
(
d©≠©h
 *
dp
);

167 
dp_waô
(
d©≠©h
 *
dp
);

172 
dp_£t_dpid
(
d©≠©h
 *
dp
, 
uöt64_t
 
dpid
);

175 
dp_£t_m‰_desc
(
d©≠©h
 *
dp
, *
m‰_desc
);

178 
dp_£t_hw_desc
(
d©≠©h
 *
dp
, *
hw_desc
);

181 
dp_£t_sw_desc
(
d©≠©h
 *
dp
, *
sw_desc
);

184 
dp_£t_dp_desc
(
d©≠©h
 *
dp
, *
dp_desc
);

187 
dp_£t_£rül_num
(
d©≠©h
 *
dp
, *
£rül_num
);

190 
dp_£t_max_queues
(
d©≠©h
 *
dp
, 
uöt32_t
 
max_queues
);

196 
dp_£nd_mesßge
(
d©≠©h
 *
dp
, 
oÊ_msg_hódî
 *
msg
,

197 c⁄° 
£ndî
 *sender);

202 
oÊ_îr


203 
dp_h™dÀ_£t_desc
(
d©≠©h
 *
dp
, 
oÊ_exp_›íÊow_msg_£t_dp_desc
 *
msg
,

204 c⁄° 
£ndî
 *sender);

207 
oÊ_îr


208 
dp_h™dÀ_rﬁe_ªque°
(
d©≠©h
 *
dp
, 
oÊ_msg_rﬁe_ªque°
 *
msg
,

209 c⁄° 
£ndî
 *sender);

212 
oÊ_îr


213 
dp_h™dÀ_async_ªque°
(
d©≠©h
 *
dp
, 
oÊ_msg_async_c⁄fig
 *
msg
,

214 c⁄° 
£ndî
 *sender);

	@udatapath/dp_actions.c

34 
	~<√töë/ö.h
>

35 
	~"csum.h
"

36 
	~"dp_exp.h
"

37 
	~"dp_a˘i⁄s.h
"

38 
	~"dp_buf„rs.h
"

39 
	~"d©≠©h.h
"

40 
	~"oÊib/oÊ.h
"

41 
	~"oÊib/oÊ-a˘i⁄s.h
"

42 
	~"oÊib/oÊ-log.h
"

43 
	~"∑ckë.h
"

44 
	~"∑ckës.h
"

45 
	~"pùñöe.h
"

46 
	~"utû.h
"

47 
	~"oÊib/oxm-m©ch.h
"

48 
	~"hash.h
"

50 
	#LOG_MODULE
 
VLM_dp_a˘s


	)

52 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(60, 60);

63 
	$ouçut
(
∑ckë
 *
pkt
, 
oÊ_a˘i⁄_ouçut
 *
a˘i⁄
) {

64 
pkt
->
out_p‹t
 = 
a˘i⁄
->
p‹t
;

66 i‡(
a˘i⁄
->
p‹t
 =
OFPP_CONTROLLER
) {

67 
pkt
->
out_p‹t_max_Àn
 = 
a˘i⁄
->
max_Àn
;

69 
	}
}

76 
	$£t_fõld
(
∑ckë
 *
pkt
, 
oÊ_a˘i⁄_£t_fõld
 *
a˘
 )

78 
	`∑ckë_h™dÀ_°d_vÆid©e
(
pkt
->
h™dÀ_°d
);

79 i‡(
pkt
->
h™dÀ_°d
->
vÆid
)

83 
a˘
->
fõld
->
hódî
){

84 
OXM_OF_ETH_DST
:{

85 
	`mem˝y
(
pkt
->
h™dÀ_°d
->
¥Ÿo
->
ëh
->
ëh_d°
,

86 
a˘
->
fõld
->
vÆue
, 
	`OXM_LENGTH
◊˘->fõld->
hódî
));

89 
OXM_OF_ETH_SRC
:{

90 
	`mem˝y
(
pkt
->
h™dÀ_°d
->
¥Ÿo
->
ëh
->
ëh_§c
,

91 
a˘
->
fõld
->
vÆue
, 
	`OXM_LENGTH
◊˘->fõld->
hódî
));

94 
OXM_OF_ETH_TYPE
:{

95 
uöt16_t
 *
v
 = (uöt16_t*Ë
a˘
->
fõld
->
vÆue
;

96 *
v
 = 
	`ht⁄s
(*v);

97 
	`mem˝y
(&
pkt
->
h™dÀ_°d
->
¥Ÿo
->
ëh
->
ëh_ty≥
,

98 
v
, 
	`OXM_LENGTH
(
a˘
->
fõld
->
hódî
));

101 
OXM_OF_VLAN_VID
:{

102 
vœn_hódî
 *
vœn
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->vlan;

104 if(
vœn
 !
NULL
){

105 
uöt16_t
 
v
 = (*(uöt16_t*)
a˘
->
fõld
->
vÆue
);

106 
vœn
->
vœn_tci
 = 
	`ht⁄s
((
	`¡ohs
(vœn->vœn_tciË& ~
VLAN_VID_MASK
)

107 | (
v
 & 
VLAN_VID_MASK
));

112 
OXM_OF_VLAN_PCP
:{

113 
vœn_hódî
 *
vœn
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->vlan;

115 if(
vœn
 !
NULL
){

116 
vœn
->
vœn_tci
 = (vœn->vœn_tcò& ~
	`ht⁄s
(
VLAN_PCP_MASK
))

117 | 
	`ht⁄s
(*
a˘
->
fõld
->
vÆue
 << 
VLAN_PCP_SHIFT
);

121 
OXM_OF_IP_DSCP
:{

122 
ù_hódî
 *
ùv4
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->ipv4;

123 
uöt8_t
 
tos
 = (
ùv4
->
ù_tos
 & ~
IP_DSCP_MASK
) |

124 (*
a˘
->
fõld
->
vÆue
 << 2);

126 
ùv4
->
ù_csum
 = 
	`ªˇlc_csum16
(ùv4->ù_csum, (
uöt16_t
)

127 (
ùv4
->
ù_tos
), (
uöt16_t
)
tos
);

128 
ùv4
->
ù_tos
 = 
tos
;

131 
OXM_OF_IP_ECN
:{

132 
ù_hódî
 *
ùv4
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->ipv4;

133 
uöt8_t
 
tos
 = (
ùv4
->
ù_tos
 & ~
IP_ECN_MASK
) |

134 (*
a˘
->
fõld
->
vÆue
 & 
IP_ECN_MASK
);

135 
ùv4
->
ù_csum
 = 
	`ªˇlc_csum16
(ùv4->ù_csum, (
uöt16_t
)

136 (
ùv4
->
ù_tos
), (
uöt16_t
)
tos
);

137 
ùv4
->
ù_tos
 = 
tos
;

140 
OXM_OF_IP_PROTO
:{

141 
pkt
->
h™dÀ_°d
->
¥Ÿo
->
ùv4
->
ù_¥Ÿo
 = *
a˘
->
fõld
->
vÆue
;

144 
OXM_OF_IPV4_SRC
:{

145 
ù_hódî
 *
ùv4
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->ipv4;

148 i‡(
pkt
->
h™dÀ_°d
->
¥Ÿo
->
t˝
 !
NULL
) {

149 
t˝_hódî
 *
t˝
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->tcp;

150 
t˝
->
t˝_csum
 = 
	`ªˇlc_csum32
(tcp->tcp_csum,

151 
ùv4
->
ù_§c
, *((
uöt32_t
*Ë
a˘
->
fõld
->
vÆue
));

152 } i‡(
pkt
->
h™dÀ_°d
->
¥Ÿo
->
udp
 !
NULL
) {

153 
udp_hódî
 *
udp
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->udp;

154 
udp
->
udp_csum
 = 
	`ªˇlc_csum32
(udp->udp_csum,

155 
ùv4
->
ù_§c
, *((
uöt32_t
*Ë
a˘
->
fõld
->
vÆue
));

158 
ùv4
->
ù_csum
 = 
	`ªˇlc_csum32
(ùv4->ù_csum, ipv4->
ù_§c
,

159 *((
uöt32_t
*Ë
a˘
->
fõld
->
vÆue
));

161 
ùv4
->
ù_§c
 = *((
uöt32_t
*Ë
a˘
->
fõld
->
vÆue
);

164 
OXM_OF_IPV4_DST
:{

165 
ù_hódî
 *
ùv4
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->ipv4;

168 i‡(
pkt
->
h™dÀ_°d
->
¥Ÿo
->
t˝
 !
NULL
) {

169 
t˝_hódî
 *
t˝
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->tcp;

170 
t˝
->
t˝_csum
 = 
	`ªˇlc_csum32
(tcp->tcp_csum,

171 
ùv4
->
ù_d°
, *((
uöt32_t
*Ë
a˘
->
fõld
->
vÆue
));

172 } i‡(
pkt
->
h™dÀ_°d
->
¥Ÿo
->
udp
 !
NULL
) {

173 
udp_hódî
 *
udp
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->udp;

174 
udp
->
udp_csum
 = 
	`ªˇlc_csum32
(udp->udp_csum,

175 
ùv4
->
ù_d°
, *((
uöt32_t
*Ë
a˘
->
fõld
->
vÆue
));

178 
ùv4
->
ù_csum
 = 
	`ªˇlc_csum32
(ùv4->ù_csum, ipv4->
ù_d°
,

179 *((
uöt32_t
*Ë
a˘
->
fõld
->
vÆue
));

181 
ùv4
->
ù_d°
 = *((
uöt32_t
*Ë
a˘
->
fõld
->
vÆue
);

184 
OXM_OF_TCP_SRC
:{

185 
t˝_hódî
 *
t˝
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->tcp;

186 
uöt16_t
 *
v
 = (uöt16_t*Ë
a˘
->
fõld
->
vÆue
;

187 *
v
 = 
	`ht⁄s
(*v);

188 
t˝
->
t˝_csum
 = 
	`ªˇlc_csum16
—˝->t˝_csum,Å˝->
t˝_§c
,*
v
);

189 
	`mem˝y
(&
t˝
->
t˝_§c
, 
v
, 
	`OXM_LENGTH
(
a˘
->
fõld
->
hódî
));

193 
OXM_OF_TCP_DST
:{

194 
t˝_hódî
 *
t˝
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->tcp;

195 
uöt16_t
 *
v
 = (uöt16_t*Ë
a˘
->
fõld
->
vÆue
;

196 *
v
 = 
	`ht⁄s
(*v);

197 
t˝
->
t˝_csum
 = 
	`ªˇlc_csum16
—˝->t˝_csum,Å˝->
t˝_d°
,*
v
);

198 
	`mem˝y
(&
t˝
->
t˝_d°
, 
v
, 
	`OXM_LENGTH
(
a˘
->
fõld
->
hódî
));

202 
OXM_OF_UDP_SRC
:{

203 
udp_hódî
 *
udp
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->udp;

204 
uöt16_t
 *
v
 = (uöt16_t*Ë
a˘
->
fõld
->
vÆue
;

205 *
v
 = 
	`ht⁄s
(*v);

206 
udp
->
udp_csum
 = 
	`ªˇlc_csum16
(udp->udp_csum, udp->
udp_d°
, *
v
);

207 
	`mem˝y
(&
udp
->
udp_§c
, 
v
, 
	`OXM_LENGTH
(
a˘
->
fõld
->
hódî
));

210 
OXM_OF_UDP_DST
:{

211 
udp_hódî
 *
udp
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->udp;

212 
uöt16_t
 *
v
 = (uöt16_t*Ë
a˘
->
fõld
->
vÆue
;

213 *
v
 = 
	`ht⁄s
(*v);

214 
udp
->
udp_csum
 = 
	`ªˇlc_csum16
(udp->udp_csum, udp->
udp_d°
, *
v
);

215 
	`mem˝y
(&
udp
->
udp_d°
, 
v
, 
	`OXM_LENGTH
(
a˘
->
fõld
->
hódî
));

219 
OXM_OF_SCTP_SRC
:{

220 
uöt16_t
 *
v
 = (uöt16_t*Ë
a˘
->
fõld
->
vÆue
;

221 *
v
 = 
	`ht⁄s
(*v);

222 
	`mem˝y
(&
pkt
->
h™dÀ_°d
->
¥Ÿo
->
s˘p
->
s˘p_§c
,

223 
v
, 
	`OXM_LENGTH
(
a˘
->
fõld
->
hódî
));

226 
OXM_OF_SCTP_DST
:{

227 
uöt16_t
 *
v
 = (uöt16_t*Ë
a˘
->
fõld
->
vÆue
;

228 *
v
 = 
	`ht⁄s
(*v);

229 
	`mem˝y
(&
pkt
->
h™dÀ_°d
->
¥Ÿo
->
s˘p
->
s˘p_d°
,

230 
v
, 
	`OXM_LENGTH
(
a˘
->
fõld
->
hódî
));

233 
OXM_OF_ICMPV4_TYPE
:

234 
OXM_OF_ICMPV6_TYPE
:{

235 
pkt
->
h™dÀ_°d
->
¥Ÿo
->
icmp
->
icmp_ty≥
 = *
a˘
->
fõld
->
vÆue
;

239 
OXM_OF_ICMPV4_CODE
:

240 
OXM_OF_ICMPV6_CODE
:{

241 
pkt
->
h™dÀ_°d
->
¥Ÿo
->
icmp
->
icmp_code
 = *
a˘
->
fõld
->
vÆue
;

244 
OXM_OF_ARP_OP
: {

245 
pkt
->
h™dÀ_°d
->
¥Ÿo
->
¨p
->
¨_›
 = 
	`ht⁄s
(*((
uöt16_t
*Ë
a˘
->
fõld
->
vÆue
));

248 
OXM_OF_ARP_SPA
:{

249 
pkt
->
h™dÀ_°d
->
¥Ÿo
->
¨p
->
¨_•a
 = *((
uöt32_t
*)

250 
a˘
->
fõld
->
vÆue
);

253 
OXM_OF_ARP_TPA
:{

254 
pkt
->
h™dÀ_°d
->
¥Ÿo
->
¨p
->
¨_ça
 = *((
uöt32_t
*)

255 
a˘
->
fõld
->
vÆue
);

258 
OXM_OF_ARP_SHA
:{

259 
	`mem˝y
(
pkt
->
h™dÀ_°d
->
¥Ÿo
->
¨p
->
¨_sha
,

260 
a˘
->
fõld
->
vÆue
, 
	`OXM_LENGTH
◊˘->fõld->
hódî
));

263 
OXM_OF_ARP_THA
:{

264 
	`mem˝y
(
pkt
->
h™dÀ_°d
->
¥Ÿo
->
¨p
->
¨_tha
,

265 
a˘
->
fõld
->
vÆue
, 
	`OXM_LENGTH
◊˘->fõld->
hódî
));

268 
OXM_OF_IPV6_SRC
:{

269 
	`mem˝y
(&
pkt
->
h™dÀ_°d
->
¥Ÿo
->
ùv6
->
ùv6_§c
,

270 
a˘
->
fõld
->
vÆue
, 
	`OXM_LENGTH
◊˘->fõld->
hódî
));

273 
OXM_OF_IPV6_DST
:{

274 
	`mem˝y
(&
pkt
->
h™dÀ_°d
->
¥Ÿo
->
ùv6
->
ùv6_d°
,

275 
a˘
->
fõld
->
vÆue
, 
	`OXM_LENGTH
◊˘->fõld->
hódî
));

278 
OXM_OF_IPV6_FLABEL
:{

279 
ùv6_hódî
 *
ùv6
 = (ipv6_header*)

280 
pkt
->
h™dÀ_°d
->
¥Ÿo
->
ùv6
;

281 
uöt32_t
 
v
 = *((uöt32_t*Ë
a˘
->
fõld
->
vÆue
);

282 
ùv6
->
ùv6_vî_tc_Ê
 = (ipv6->ipv6_ver_tc_fl &

283 ~
	`¡ohl
(
IPV6_FLABEL_MASK
)Ë|Çtohl(
v
 & IPV6_FLABEL_MASK);

287 
OXM_OF_IPV6_ND_TARGET
:{

288 
icmp_hódî
 *
icmp
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->icmp;

289 
uöt8_t
 
off£t
;

290 
uöt8_t
 *
d©a
 = (uöt8_t*)
icmp
;

292 
off£t
 = (
icmp_hódî
) + 4;

294 
	`mem˝y
(
d©a
 + 
off£t
, 
a˘
->
fõld
->
vÆue
,

295 
	`OXM_LENGTH
(
a˘
->
fõld
->
hódî
));

298 
OXM_OF_IPV6_ND_SLL
:{

299 
icmp_hódî
 *
icmp
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->icmp;

300 
uöt8_t
 
off£t
;

301 
ùv6_nd_›ti⁄s_hd
 *
›t
 = (ipv6_nd_options_hd*)

302 
icmp
 + (
icmp_hódî
);

303 
uöt8_t
 *
d©a
 = (uöt8_t*Ë
›t
;

305 
off£t
 = (
ùv6_nd_hódî
);

307 if(
›t
->
ty≥
 =
ND_OPT_SLL
){

308 
	`mem˝y
(
d©a
 + 
off£t
, 
a˘
->
fõld
->
vÆue
,

309 
	`OXM_LENGTH
(
a˘
->
fõld
->
hódî
));

313 
OXM_OF_IPV6_ND_TLL
:{

314 
icmp_hódî
 *
icmp
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->icmp;

315 
uöt8_t
 
off£t
;

316 
ùv6_nd_›ti⁄s_hd
 *
›t
 = (ipv6_nd_options_hd*)

317 
icmp
 + (
icmp_hódî
);

318 
uöt8_t
 *
d©a
 = (uöt8_t*Ë
›t
;

320 
off£t
 = (
ùv6_nd_hódî
);

322 if(
›t
->
ty≥
 =
ND_OPT_TLL
){

323 
	`mem˝y
(
d©a
 + 
off£t
, 
a˘
->
fõld
->
vÆue
,

324 
	`OXM_LENGTH
(
a˘
->
fõld
->
hódî
));

328 
OXM_OF_MPLS_LABEL
:{

329 
m∂s_hódî
 *
m∂s
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->mpls;

330 
uöt32_t
 
v
 = *((uöt32_t*Ë
a˘
->
fõld
->
vÆue
);

331 
m∂s
->
fõlds
 = (m∂s->fõld†& ~
	`¡ohl
(
MPLS_LABEL_MASK
)) |

332 
	`¡ohl
((
v
 << 
MPLS_LABEL_SHIFT
Ë& 
MPLS_LABEL_MASK
);

335 
OXM_OF_MPLS_TC
:{

336 
m∂s_hódî
 *
m∂s
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->mpls;

337 
m∂s
->
fõlds
 = (m∂s->fõld†& ~
	`¡ohl
(
MPLS_TC_MASK
))

338 | 
	`¡ohl
((*
a˘
->
fõld
->
vÆue
 << 
MPLS_TC_SHIFT
Ë& 
MPLS_TC_MASK
);

341 
OXM_OF_MPLS_BOS
:{

342 
m∂s_hódî
 *
m∂s
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->mpls;

343 
m∂s
->
fõlds
 = (m∂s->fõld†& ~
	`¡ohl
(
MPLS_S_MASK
))

344 | 
	`¡ohl
((*
a˘
->
fõld
->
vÆue
 << 
MPLS_S_SHIFT
Ë& 
MPLS_S_MASK
);

347 
OXM_OF_PBB_ISID
 :{

348 
pbb_hódî
 *
pbb
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->pbb;

349 
uöt32_t
 
v
 = *((uöt32_t*Ë
a˘
->
fõld
->
vÆue
);

350 
pbb
->
id
 = (pbb->id & ~
	`¡ohl
(
PBB_ISID_MASK
)) |

351 
	`¡ohl
(
v
 & 
PBB_ISID_MASK
);

355 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryingÅo set unknow field.");

358 
pkt
->
h™dÀ_°d
->
vÆid
 = 
Ál£
;

362 
	}
}

366 
	$c›y_âl_out
(
∑ckë
 *
pkt
, 
oÊ_a˘i⁄_hódî
 *
a˘
 
UNUSED
) {

367 
	`∑ckë_h™dÀ_°d_vÆid©e
(
pkt
->
h™dÀ_°d
);

368 i‡(
pkt
->
h™dÀ_°d
->
¥Ÿo
->
m∂s
 !
NULL
) {

369 
m∂s_hódî
 *
m∂s
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->mpls;

371 i‡((
	`¡ohl
(
m∂s
->
fõlds
Ë& 
MPLS_S_MASK
) == 0) {

373 
m∂s_hódî
 *
ö_m∂s
 = (m∂s_hódî *)((
uöt8_t
 *)
m∂s
 + 
MPLS_HEADER_LEN
);

375 
m∂s
->
fõlds
 = (m∂s->fõld†& ~
	`ht⁄l
(
MPLS_TTL_MASK
)Ë| (
ö_m∂s
->fields & htonl(MPLS_TTL_MASK));

377 } i‡(
pkt
->
buf„r
->
size
 >
ETH_HEADER_LEN
 + 
MPLS_HEADER_LEN
 + 
IP_HEADER_LEN
) {

379 
ù_hódî
 *
ùv4
 = (ù_hódî *)((
uöt8_t
 *)
m∂s
 + 
MPLS_HEADER_LEN
);

381 
m∂s
->
fõlds
 = (m∂s->fõld†& ~
	`ht⁄l
(
MPLS_TTL_MASK
)Ë| ht⁄l((
uöt32_t
)
ùv4
->
ù_âl
 & MPLS_TTL_MASK);

384 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryingÅoÉxecute copyÅtl ináction onÖacket with only one mpls.");

387 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryingÅoÉxecute COPY_TTL_OUTáction onÖacket withÇo mpls.");

389 
	}
}

393 
	$c›y_âl_ö
(
∑ckë
 *
pkt
, 
oÊ_a˘i⁄_hódî
 *
a˘
 
UNUSED
) {

394 
	`∑ckë_h™dÀ_°d_vÆid©e
(
pkt
->
h™dÀ_°d
);

395 i‡(
pkt
->
h™dÀ_°d
->
¥Ÿo
->
m∂s
 !
NULL
) {

396 
m∂s_hódî
 *
m∂s
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->mpls;

398 i‡((
	`¡ohl
(
m∂s
->
fõlds
Ë& 
MPLS_S_MASK
) == 0) {

400 
m∂s_hódî
 *
ö_m∂s
 = (m∂s_hódî *)((
uöt8_t
 *)
m∂s
 + 
MPLS_HEADER_LEN
);

402 
ö_m∂s
->
fõlds
 = (ö_m∂s->fõld†& ~
	`ht⁄l
(
MPLS_TTL_MASK
)Ë| (
m∂s
->fields & htonl(MPLS_TTL_MASK));

404 } i‡(
pkt
->
buf„r
->
size
 >
ETH_HEADER_LEN
 + 
MPLS_HEADER_LEN
 + 
IP_HEADER_LEN
) {

406 
ù_hódî
 *
ùv4
 = (ù_hódî *)((
uöt8_t
 *)
m∂s
 + 
MPLS_HEADER_LEN
);

408 
uöt8_t
 
√w_âl
 = (
	`¡ohl
(
m∂s
->
fõlds
Ë& 
MPLS_TTL_MASK
Ë>> 
MPLS_TTL_SHIFT
;

409 
uöt16_t
 
ﬁd_vÆ
 = 
	`ht⁄s
((
ùv4
->
ù_¥Ÿo
Ë+ (ùv4->
ù_âl
<<8));

410 
uöt16_t
 
√w_vÆ
 = 
	`ht⁄s
((
ùv4
->
ù_¥Ÿo
Ë+ (
√w_âl
<<8));

411 
ùv4
->
ù_csum
 = 
	`ªˇlc_csum16
(ùv4->ù_csum, 
ﬁd_vÆ
, 
√w_vÆ
);

412 
ùv4
->
ù_âl
 = 
√w_âl
;

415 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryingÅoÉxecute copyÅtl ináction onÖacket with only one mpls.");

418 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryingÅoÉxecute COPY_TTL_INáction onÖacket withÇo mpls.");

420 
	}
}

424 
	$push_vœn
(
∑ckë
 *
pkt
, 
oÊ_a˘i⁄_push
 *
a˘
) {

426 
	`∑ckë_h™dÀ_°d_vÆid©e
(
pkt
->
h™dÀ_°d
);

427 i‡(
pkt
->
h™dÀ_°d
->
¥Ÿo
->
ëh
 !
NULL
) {

428 
ëh_hódî
 *
ëh
, *
√w_ëh
;

429 
¢≠_hódî
 *
¢≠
, *
√w_¢≠
;

430 
vœn_hódî
 *
vœn
, *
√w_vœn
, *
push_vœn
;

431 
size_t
 
ëh_size
;

433 
ëh
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->eth;

434 
¢≠
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->
ëh_¢≠
;

435 
vœn
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->vlan;

437 
ëh_size
 = 
¢≠
 =
NULL


438 ? 
ETH_HEADER_LEN


439 : 
ETH_HEADER_LEN
 + 
LLC_HEADER_LEN
 + 
SNAP_HEADER_LEN
;

441 i‡(
	`oÂbuf_hódroom
(
pkt
->
buf„r
Ë>
VLAN_HEADER_LEN
) {

443 
pkt
->
buf„r
->
d©a
 = (
uöt8_t
 *)’kt->buf„r->d©aË- 
VLAN_HEADER_LEN
;

444 
pkt
->
buf„r
->
size
 +
VLAN_HEADER_LEN
;

446 
	`memmove
(
pkt
->
buf„r
->
d©a
, 
ëh
, 
ëh_size
);

448 
√w_ëh
 = (
ëh_hódî
 *)(
pkt
->
buf„r
->
d©a
);

449 
√w_¢≠
 = 
¢≠
 =
NULL
 ? NULL

450 : (
¢≠_hódî
 *)((
uöt8_t
 *)
√w_ëh


451 + 
ETH_HEADER_LEN
 + 
LLC_HEADER_LEN
);

452 
push_vœn
 = (
vœn_hódî
 *)((
uöt8_t
 *)
√w_ëh
 + 
ëh_size
);

453 
√w_vœn
 = 
vœn
;

458 
	`oÂbuf_put_unöô
(
pkt
->
buf„r
, 
VLAN_HEADER_LEN
);

460 
√w_ëh
 = (
ëh_hódî
 *)(
pkt
->
buf„r
->
d©a
);

461 
√w_¢≠
 = 
¢≠
 =
NULL
 ? NULL

462 : (
¢≠_hódî
 *)((
uöt8_t
 *)
√w_ëh


463 + 
ETH_HEADER_LEN
 + 
LLC_HEADER_LEN
);

464 
push_vœn
 = (
vœn_hódî
 *)((
uöt8_t
 *)
√w_ëh
 + 
ëh_size
);

467 
	`memmove
((
uöt8_t
 *)
push_vœn
 + 
VLAN_HEADER_LEN
,Öush_vlan,

468 
pkt
->
buf„r
->
size
 - 
ëh_size
);

470 
√w_vœn
 = 
vœn
 =
NULL
 ? NULL

471 : (
vœn_hódî
 *)((
uöt8_t
 *)
push_vœn
 + 
VLAN_HEADER_LEN
);

474 
push_vœn
->
vœn_tci
 = 
√w_vœn
 =
NULL
 ? 0x0000 :Çew_vlan->vlan_tci;

476 i‡(
√w_¢≠
 !
NULL
) {

477 
push_vœn
->
vœn_√xt_ty≥
 = 
√w_¢≠
->
¢≠_ty≥
;

478 
√w_¢≠
->
¢≠_ty≥
 = 
	`¡ohs
(
a˘
->
ëhîty≥
);

479 
√w_ëh
->
ëh_ty≥
 = 
	`ht⁄s
(
	`¡ohs
“ew_ëh->ëh_ty≥Ë+ 
VLAN_HEADER_LEN
);

481 
push_vœn
->
vœn_√xt_ty≥
 = 
√w_ëh
->
ëh_ty≥
;

482 
√w_ëh
->
ëh_ty≥
 = 
	`¡ohs
(
a˘
->
ëhîty≥
);

487 
pkt
->
h™dÀ_°d
->
vÆid
 = 
Ál£
;

490 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryingÅoÉxecuteÖush vlanáction onÖacket withÇoÉth.");

492 
	}
}

496 
	$p›_vœn
(
∑ckë
 *
pkt
, 
oÊ_a˘i⁄_hódî
 *
a˘
 
UNUSED
) {

497 
	`∑ckë_h™dÀ_°d_vÆid©e
(
pkt
->
h™dÀ_°d
);

498 i‡(
pkt
->
h™dÀ_°d
->
¥Ÿo
->
ëh
 !
NULL
 &&Ökt->h™dÀ_°d->¥Ÿo->
vœn
 != NULL) {

499 
ëh_hódî
 *
ëh
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->eth;

500 
¢≠_hódî
 *
ëh_¢≠
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->eth_snap;

501 
vœn_hódî
 *
vœn
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->vlan;

502 
size_t
 
move_size
;

504 i‡(
ëh_¢≠
 !
NULL
) {

505 
ëh_¢≠
->
¢≠_ty≥
 = 
vœn
->
vœn_√xt_ty≥
;

506 
ëh
->
ëh_ty≥
 = 
	`ht⁄s
(
	`¡ohs
”th->ëh_ty≥Ë- 
VLAN_HEADER_LEN
);

508 
ëh
->
ëh_ty≥
 = 
vœn
->
vœn_√xt_ty≥
;

511 
move_size
 = (
uöt8_t
 *)
vœn
 - (uöt8_à*)
ëh
;

513 
pkt
->
buf„r
->
d©a
 = (
uöt8_t
 *Ìkt->buf„r->d©®+ 
VLAN_HEADER_LEN
;

514 
pkt
->
buf„r
->
size
 -
VLAN_HEADER_LEN
;

516 
	`memmove
(
pkt
->
buf„r
->
d©a
, 
ëh
, 
move_size
);

519 
pkt
->
h™dÀ_°d
->
vÆid
 = 
Ál£
;

521 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryingÅoÉxecute POP_VLANáction onÖacket withÇoÉth/vlan.");

523 
	}
}

528 
	$£t_m∂s_âl
(
∑ckë
 *
pkt
, 
oÊ_a˘i⁄_m∂s_âl
 *
a˘
) {

529 
	`∑ckë_h™dÀ_°d_vÆid©e
(
pkt
->
h™dÀ_°d
);

530 i‡(
pkt
->
h™dÀ_°d
->
¥Ÿo
->
m∂s
 !
NULL
) {

531 
m∂s_hódî
 *
m∂s
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->mpls;

533 
m∂s
->
fõlds
 = (m∂s->fõld†& ~
	`¡ohl
(
MPLS_TTL_MASK
)Ë|Çtohl((
a˘
->
m∂s_âl
 << 
MPLS_TTL_SHIFT
) & MPLS_TTL_MASK);

536 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryingÅoÉxecute SET_MPLS_TTLáction onÖacket withÇo mpls.");

538 
	}
}

542 
	$dec_m∂s_âl
(
∑ckë
 *
pkt
, 
oÊ_a˘i⁄_hódî
 *
a˘
 
UNUSED
) {

543 
	`∑ckë_h™dÀ_°d_vÆid©e
(
pkt
->
h™dÀ_°d
);

544 i‡(
pkt
->
h™dÀ_°d
->
¥Ÿo
->
m∂s
 !
NULL
) {

545 
m∂s_hódî
 *
m∂s
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->mpls;

547 
uöt32_t
 
âl
 = 
	`¡ohl
(
m∂s
->
fõlds
Ë& 
MPLS_TTL_MASK
;

549 i‡(
âl
 > 0) {Åtl--; }

550 
m∂s
->
fõlds
 = (m∂s->fõld†& ~
	`¡ohl
(
MPLS_TTL_MASK
)Ë| 
	`ht⁄l
(
âl
);

553 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryingÅoÉxecute DEC_MPLS_TTLáction onÖacket withÇo mpls.");

555 
	}
}

559 
	$push_m∂s
(
∑ckë
 *
pkt
, 
oÊ_a˘i⁄_push
 *
a˘
) {

561 
	`∑ckë_h™dÀ_°d_vÆid©e
(
pkt
->
h™dÀ_°d
);

562 i‡(
pkt
->
h™dÀ_°d
->
¥Ÿo
->
ëh
 !
NULL
) {

563 
ëh_hódî
 *
ëh
, *
√w_ëh
;

564 
¢≠_hódî
 *
¢≠
, *
√w_¢≠
;

565 
m∂s_hódî
 *
m∂s
, *
√w_m∂s
, *
push_m∂s
;

566 
ù_hódî
 *
ùv4
;

567 
ùv6_hódî
 *
ùv6
;

568 
size_t
 
ëh_size
;

570 
ëh
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->eth;

571 
¢≠
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->
ëh_¢≠
;

572 
m∂s
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->mpls;

573 
ùv4
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->ipv4;

574 
ùv6
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->ipv6;

576 
ëh_size
 = 
¢≠
 =
NULL


577 ? 
ETH_HEADER_LEN


578 : 
ETH_HEADER_LEN
 + 
LLC_HEADER_LEN
 + 
SNAP_HEADER_LEN
;

580 i‡(
	`oÂbuf_hódroom
(
pkt
->
buf„r
Ë>
MPLS_HEADER_LEN
) {

582 
pkt
->
buf„r
->
d©a
 = (
uöt8_t
 *)’kt->buf„r->d©aË- 
MPLS_HEADER_LEN
;

583 
pkt
->
buf„r
->
size
 +
MPLS_HEADER_LEN
;

585 
	`memmove
(
pkt
->
buf„r
->
d©a
, 
ëh
, 
ëh_size
);

587 
√w_ëh
 = (
ëh_hódî
 *)(
pkt
->
buf„r
->
d©a
);

588 
√w_¢≠
 = 
¢≠
 =
NULL
 ? NULL

589 : (
¢≠_hódî
 *)((
uöt8_t
 *)
√w_ëh


590 + 
ETH_HEADER_LEN
 + 
MPLS_HEADER_LEN
 + 
LLC_HEADER_LEN
);

591 
push_m∂s
 = (
m∂s_hódî
 *)((
uöt8_t
 *)
√w_ëh
 + 
ëh_size
);

592 
√w_m∂s
 = 
m∂s
;

598 
	`oÂbuf_put_unöô
(
pkt
->
buf„r
, 
MPLS_HEADER_LEN
);

600 
√w_ëh
 = (
ëh_hódî
 *)(
pkt
->
buf„r
->
d©a
);

601 
√w_¢≠
 = 
¢≠
 =
NULL
 ? NULL

602 : (
¢≠_hódî
 *)((
uöt8_t
 *)
√w_ëh


603 + 
ETH_HEADER_LEN
 + 
MPLS_HEADER_LEN
 + 
LLC_HEADER_LEN
);

604 
push_m∂s
 = (
m∂s_hódî
 *)((
uöt8_t
 *)
√w_ëh
 + 
ETH_HEADER_LEN
);

607 
	`memmove
((
uöt8_t
 *)
push_m∂s
 + 
MPLS_HEADER_LEN
,Öush_mpls,

608 
pkt
->
buf„r
->
size
 - 
ETH_HEADER_LEN
);

610 
√w_m∂s
 = 
m∂s
 =
NULL
 ? NULL

611 : (
m∂s_hódî
 *)((
uöt8_t
 *)
push_m∂s
 + 
MPLS_HEADER_LEN
);

614 i‡(
√w_m∂s
 !
NULL
) {

615 
push_m∂s
->
fõlds
 = 
√w_m∂s
->fõld†& ~
	`ht⁄l
(
MPLS_S_MASK
);

616 } i‡(
ùv4
 !
NULL
) {

618 
push_m∂s
->
fõlds
 = 
	`ht⁄l
((
uöt32_t
)
ùv4
->
ù_âl
 & 
MPLS_TTL_MASK
Ë| ht⁄l(
MPLS_S_MASK
);

619 } i‡(
ùv6
 !
NULL
) {

621 
push_m∂s
->
fõlds
 = 
	`ht⁄l
((
uöt32_t
)
ùv6
->
ùv6_h›_limô
 & 
MPLS_TTL_MASK
Ë| ht⁄l(
MPLS_S_MASK
);

624 
push_m∂s
->
fõlds
 = 
	`ht⁄l
(
MPLS_S_MASK
);

627 i‡(
√w_¢≠
 !
NULL
) {

628 
√w_¢≠
->
¢≠_ty≥
 = 
	`¡ohs
(
a˘
->
ëhîty≥
);

630 
√w_ëh
->
ëh_ty≥
 = 
	`¡ohs
(
a˘
->
ëhîty≥
);

633 
pkt
->
h™dÀ_°d
->
vÆid
 = 
Ál£
;

636 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryingÅoÉxecute PUSH_MPLSáction onÖacket withÇoÉth.");

638 
	}
}

642 
	$p›_m∂s
(
∑ckë
 *
pkt
, 
oÊ_a˘i⁄_p›_m∂s
 *
a˘
) {

643 
	`∑ckë_h™dÀ_°d_vÆid©e
(
pkt
->
h™dÀ_°d
);

644 i‡(
pkt
->
h™dÀ_°d
->
¥Ÿo
->
ëh
 !
NULL
 &&Ökt->h™dÀ_°d->¥Ÿo->
m∂s
 != NULL) {

645 
ëh_hódî
 *
ëh
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->eth;

646 
¢≠_hódî
 *
¢≠
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->
ëh_¢≠
;

647 
vœn_hódî
 *
vœn_œ°
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->vlan_last;

648 
m∂s_hódî
 *
m∂s
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->mpls;

649 
size_t
 
move_size
;

651 i‡(
vœn_œ°
 !
NULL
) {

652 
vœn_œ°
->
vœn_√xt_ty≥
 = 
	`ht⁄s
(
a˘
->
ëhîty≥
);

653 } i‡(
¢≠
 !
NULL
) {

654 
¢≠
->
¢≠_ty≥
 = 
	`ht⁄s
(
a˘
->
ëhîty≥
);

656 
ëh
->
ëh_ty≥
 = 
	`ht⁄s
(
a˘
->
ëhîty≥
);

659 
move_size
 = (
uöt8_t
 *)
m∂s
 - (uöt8_à*)
ëh
;

661 
pkt
->
buf„r
->
d©a
 = (
uöt8_t
 *Ìkt->buf„r->d©®+ 
MPLS_HEADER_LEN
;

662 
pkt
->
buf„r
->
size
 -
MPLS_HEADER_LEN
;

664 
	`memmove
(
pkt
->
buf„r
->
d©a
, 
ëh
, 
move_size
);

666 i‡(
¢≠
 !
NULL
) {

667 
ëh_hódî
 *
√w_ëh
 = (ëh_hódî *)(
pkt
->
buf„r
->
d©a
);

668 
√w_ëh
->
ëh_ty≥
 = 
	`ht⁄s
(
	`¡ohs
“ew_ëh->ëh_ty≥Ë+ 
MPLS_HEADER_LEN
);

672 
pkt
->
h™dÀ_°d
->
vÆid
 = 
Ál£
;

674 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryingÅoÉxecute POP_MPLSáction onÖacket withÇoÉth/mpls.");

676 
	}
}

680 
	$push_pbb
(
∑ckë
 *
pkt
, 
oÊ_a˘i⁄_push
 *
a˘
) {

682 
	`∑ckë_h™dÀ_°d_vÆid©e
(
pkt
->
h™dÀ_°d
);

683 i‡(
pkt
->
h™dÀ_°d
->
¥Ÿo
->
ëh
 !
NULL
) {

684 
ëh_hódî
 *
ëh
, *
√w_ëh
;

685 
¢≠_hódî
 *
¢≠
, *
√w_¢≠
;

686 
pbb_hódî
 *
pbb
, *
√w_pbb
, *
push_pbb
;

687 
vœn_hódî
 * 
vœn
;

688 
size_t
 
ëh_size
;

690 
ëh
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->eth;

691 
¢≠
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->
ëh_¢≠
;

692 
pbb
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->pbb;

693 
vœn
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->vlan;

695 
ëh_size
 = 
¢≠
 =
NULL


696 ? 
ETH_HEADER_LEN


697 : 
ETH_HEADER_LEN
 + 
LLC_HEADER_LEN
 + 
SNAP_HEADER_LEN
;

699 i‡(
	`oÂbuf_hódroom
(
pkt
->
buf„r
Ë>
PBB_HEADER_LEN
) {

701 
pkt
->
buf„r
->
d©a
 = (
uöt8_t
 *)’kt->buf„r->d©aË- 
PBB_HEADER_LEN
;

702 
pkt
->
buf„r
->
size
 +
PBB_HEADER_LEN
;

704 
	`memmove
(
pkt
->
buf„r
->
d©a
, 
ëh
, 
ëh_size
);

706 
√w_ëh
 = (
ëh_hódî
 *)(
pkt
->
buf„r
->
d©a
);

707 
√w_¢≠
 = 
¢≠
 =
NULL
 ? NULL

708 : (
¢≠_hódî
 *)((
uöt8_t
 *)
√w_ëh


709 + 
ETH_HEADER_LEN
 + 
PBB_HEADER_LEN
 + 
LLC_HEADER_LEN
);

710 
push_pbb
 = (
pbb_hódî
 *)((
uöt8_t
 *)
√w_ëh
 + 
ëh_size
);

711 
√w_pbb
 = 
pbb
;

717 
	`oÂbuf_put_unöô
(
pkt
->
buf„r
, 
PBB_HEADER_LEN
);

719 
√w_ëh
 = (
ëh_hódî
 *)(
pkt
->
buf„r
->
d©a
);

720 
√w_¢≠
 = 
¢≠
 =
NULL
 ? NULL

721 : (
¢≠_hódî
 *)((
uöt8_t
 *)
√w_ëh


722 + 
ETH_HEADER_LEN
 + 
PBB_HEADER_LEN
 + 
LLC_HEADER_LEN
);

723 
push_pbb
 = (
pbb_hódî
 *)((
uöt8_t
 *)
√w_ëh
 + 
ETH_HEADER_LEN
);

726 
	`memmove
((
uöt8_t
 *)
push_pbb
 + 
PBB_HEADER_LEN
,Öush_pbb,

727 
pkt
->
buf„r
->
size
 - 
ETH_HEADER_LEN
);

729 
√w_pbb
 = 
pbb
 =
NULL
 ? NULL

730 : (
pbb_hódî
 *)((
uöt8_t
 *)
push_pbb
 + 
PBB_HEADER_LEN
);

733 
push_pbb
->
id
 = 
√w_pbb
 =
NULL
 ? 0x0000 :Çew_pbb->id;

734 
push_pbb
->
id
 = 
vœn
 =
NULL


735 ? 
push_pbb
->
id


736 : 
push_pbb
->
id
 & (((
uöt32_t
Ë(
vœn
->
vœn_tci
 & ~
	`ht⁄l
(
VLAN_PCP_MASK
)) )<< 16);

737 
	`mem˝y
(
push_pbb
->
c_ëh_d°
,
ëh
,
ETH_HEADER_LEN
);

739 i‡(
√w_¢≠
 !
NULL
) {

741 
push_pbb
->
pbb_√xt_ty≥
 = 
√w_¢≠
->
¢≠_ty≥
;

742 
√w_¢≠
->
¢≠_ty≥
 = 
	`¡ohs
(
a˘
->
ëhîty≥
);

743 
√w_ëh
->
ëh_ty≥
 = 
	`ht⁄s
(
	`¡ohs
“ew_ëh->ëh_ty≥Ë+ 
PBB_HEADER_LEN
);

745 
push_pbb
->
pbb_√xt_ty≥
 = 
√w_ëh
->
ëh_ty≥
;

746 
√w_ëh
->
ëh_ty≥
 = 
	`¡ohs
(
a˘
->
ëhîty≥
);

749 
pkt
->
h™dÀ_°d
->
vÆid
 = 
Ál£
;

752 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryingÅoÉxecuteÖushÖbbáction onÖacket withÇoÉth.");

754 
	}
}

759 
	$p›_pbb
(
∑ckë
 *
pkt
, 
oÊ_a˘i⁄_hódî
 *
a˘
 
UNUSED
) {

760 
	`∑ckë_h™dÀ_°d_vÆid©e
(
pkt
->
h™dÀ_°d
);

761 i‡(
pkt
->
h™dÀ_°d
->
¥Ÿo
->
ëh
 !
NULL
 &&Ökt->h™dÀ_°d->¥Ÿo->
pbb
 != NULL) {

762 
ëh_hódî
 *
ëh
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->eth;

763 
pbb_hódî
 *
pbb
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->pbb;

764 
size_t
 
move_size
;

766 
move_size
 = (
uöt8_t
 *Ë
pbb
->
c_ëh_d°
 - (uöt8_à*)
ëh
;

770 
	`memmove
(
pkt
->
buf„r
->
d©a
, 
pbb
->
c_ëh_d°
, (pkt->buf„r->
size
 - 
move_size
));

771 
pkt
->
buf„r
->
size
 -
move_size
;

773 
pkt
->
h™dÀ_°d
->
vÆid
 = 
Ál£
;

775 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryingÅoÉxecute POP_PBBáction onÖacket withÇo PBB header.");

777 
	}
}

782 
	$£t_queue
(
∑ckë
 *
pkt
 
UNUSED
, 
oÊ_a˘i⁄_£t_queue
 *
a˘
) {

783 
pkt
->
out_queue
 = 
a˘
->
queue_id
;

784 
	}
}

788 
	$group
(
∑ckë
 *
pkt
, 
oÊ_a˘i⁄_group
 *
a˘
) {

789 
pkt
->
out_group
 = 
a˘
->
group_id
;

790 
	}
}

795 
	$£t_nw_âl
(
∑ckë
 *
pkt
, 
oÊ_a˘i⁄_£t_nw_âl
 *
a˘
) {

796 
	`∑ckë_h™dÀ_°d_vÆid©e
(
pkt
->
h™dÀ_°d
);

797 i‡(
pkt
->
h™dÀ_°d
->
¥Ÿo
->
ùv4
 !
NULL
) {

798 
ù_hódî
 *
ùv4
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->ipv4;

800 
uöt16_t
 
ﬁd_vÆ
 = 
	`ht⁄s
((
ùv4
->
ù_¥Ÿo
Ë+ (ùv4->
ù_âl
<<8));

801 
uöt16_t
 
√w_vÆ
 = 
	`ht⁄s
((
ùv4
->
ù_¥Ÿo
Ë+ (
a˘
->
nw_âl
<<8));

802 
ùv4
->
ù_csum
 = 
	`ªˇlc_csum16
(ùv4->ù_csum, 
ﬁd_vÆ
, 
√w_vÆ
);

803 
ùv4
->
ù_âl
 = 
a˘
->
nw_âl
;

805 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryingÅoÉxecute SET_NW_TTLáction onÖacket withÇo ipv4.");

807 
	}
}

812 
	$dec_nw_âl
(
∑ckë
 *
pkt
, 
oÊ_a˘i⁄_hódî
 *
a˘
 
UNUSED
) {

813 
	`∑ckë_h™dÀ_°d_vÆid©e
(
pkt
->
h™dÀ_°d
);

814 i‡(
pkt
->
h™dÀ_°d
->
¥Ÿo
->
ùv4
 !
NULL
) {

816 
ù_hódî
 *
ùv4
 = 
pkt
->
h™dÀ_°d
->
¥Ÿo
->ipv4;

818 i‡(
ùv4
->
ù_âl
 > 0) {

819 
uöt8_t
 
√w_âl
 = 
ùv4
->
ù_âl
 - 1;

820 
uöt16_t
 
ﬁd_vÆ
 = 
	`ht⁄s
((
ùv4
->
ù_¥Ÿo
Ë+ (ùv4->
ù_âl
<<8));

821 
uöt16_t
 
√w_vÆ
 = 
	`ht⁄s
((
ùv4
->
ù_¥Ÿo
Ë+ (
√w_âl
<<8));

822 
ùv4
->
ù_csum
 = 
	`ªˇlc_csum16
(ùv4->ù_csum, 
ﬁd_vÆ
, 
√w_vÆ
);

823 
ùv4
->
ù_âl
 = 
√w_âl
;

826 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryingÅoÉxecute DEC_NW_TTLáction onÖacket withÇo ipv4.");

828 
	}
}

832 
	$dp_execuã_a˘i⁄
(
∑ckë
 *
pkt
,

833 
oÊ_a˘i⁄_hódî
 *
a˘i⁄
) {

835 i‡(
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

836 *
a
 = 
	`oÊ_a˘i⁄_to_°rög
(
a˘i⁄
, 
pkt
->
dp
->
exp
);

837 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "executögá˘i⁄ %s.", 
a
);

838 
	`‰ì
(
a
);

841 
a˘i⁄
->
ty≥
) {

842 (
OFPAT_SET_FIELD
): {

843 
	`£t_fõld
(
pkt
,(
oÊ_a˘i⁄_£t_fõld
*Ë
a˘i⁄
);

846 (
OFPAT_OUTPUT
): {

847 
	`ouçut
(
pkt
, (
oÊ_a˘i⁄_ouçut
 *)
a˘i⁄
);

850 (
OFPAT_COPY_TTL_OUT
): {

851 
	`c›y_âl_out
(
pkt
, 
a˘i⁄
);

854 (
OFPAT_COPY_TTL_IN
): {

855 
	`c›y_âl_ö
(
pkt
, 
a˘i⁄
);

858 (
OFPAT_SET_MPLS_TTL
): {

859 
	`£t_m∂s_âl
(
pkt
, (
oÊ_a˘i⁄_m∂s_âl
 *)
a˘i⁄
);

862 (
OFPAT_DEC_MPLS_TTL
): {

863 
	`dec_m∂s_âl
(
pkt
, 
a˘i⁄
);

866 (
OFPAT_PUSH_VLAN
): {

867 
	`push_vœn
(
pkt
, (
oÊ_a˘i⁄_push
 *)
a˘i⁄
);

870 (
OFPAT_POP_VLAN
): {

871 
	`p›_vœn
(
pkt
, 
a˘i⁄
);

874 (
OFPAT_PUSH_MPLS
): {

875 
	`push_m∂s
(
pkt
, (
oÊ_a˘i⁄_push
 *)
a˘i⁄
);

878 (
OFPAT_POP_MPLS
): {

879 
	`p›_m∂s
(
pkt
, (
oÊ_a˘i⁄_p›_m∂s
 *)
a˘i⁄
);

882 (
OFPAT_SET_QUEUE
): {

883 
	`£t_queue
(
pkt
, (
oÊ_a˘i⁄_£t_queue
 *)
a˘i⁄
);

886 (
OFPAT_GROUP
): {

887 
	`group
(
pkt
, (
oÊ_a˘i⁄_group
 *)
a˘i⁄
);

890 (
OFPAT_SET_NW_TTL
): {

891 
	`£t_nw_âl
(
pkt
, (
oÊ_a˘i⁄_£t_nw_âl
 *)
a˘i⁄
);

894 (
OFPAT_DEC_NW_TTL
): {

895 
	`dec_nw_âl
(
pkt
, 
a˘i⁄
);

898 (
OFPAT_PUSH_PBB
):{

899 
	`push_pbb
(
pkt
, (
oÊ_a˘i⁄_push
*)
a˘i⁄
);

902 (
OFPAT_POP_PBB
):{

903 
	`p›_pbb
(
pkt
, 
a˘i⁄
);

906 (
OFPAT_EXPERIMENTER
): {

907 
	`dp_exp_a˘i⁄
(
pkt
, (
oÊ_a˘i⁄_ex≥rimíãr
 *)
a˘i⁄
);

912 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryögÅÿexecuã unknow¿a˘i⁄Åy≥ (%u).", 
a˘i⁄
->
ty≥
);

915 i‡(
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

916 *
p
 = 
	`∑ckë_to_°rög
(
pkt
);

917 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "a˘i⁄Ñesu…: %s", 
p
);

918 
	`‰ì
(
p
);

921 
	}
}

926 
	$dp_execuã_a˘i⁄_li°
(
∑ckë
 *
pkt
,

927 
size_t
 
a˘i⁄s_num
, 
oÊ_a˘i⁄_hódî
 **
a˘i⁄s
, 
uöt64_t
 
cookõ
) {

928 
size_t
 
i
;

930 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "ExecutingáctionÜist.");

932 
i
=0; i < 
a˘i⁄s_num
; i++) {

933 
	`dp_execuã_a˘i⁄
(
pkt
, 
a˘i⁄s
[
i
]);

935 i‡(
pkt
->
out_group
 !
OFPG_ANY
) {

936 
uöt32_t
 
group
 = 
pkt
->
out_group
;

937 
pkt
->
out_group
 = 
OFPG_ANY
;

938 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "Grou∞a˘i⁄;Éxecutög grou∞(%u).", 
group
);

939 
	`group_èbÀ_execuã
(
pkt
->
dp
->
groups
,Ökt, 
group
);

941 } i‡(
pkt
->
out_p‹t
 !
OFPP_ANY
) {

942 
uöt32_t
 
p‹t
 = 
pkt
->
out_p‹t
;

943 
uöt32_t
 
queue
 = 
pkt
->
out_queue
;

944 
uöt16_t
 
max_Àn
 = 
pkt
->
out_p‹t_max_Àn
;

945 
pkt
->
out_p‹t
 = 
OFPP_ANY
;

946 
pkt
->
out_p‹t_max_Àn
 = 0;

947 
pkt
->
out_queue
 = 0;

948 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "P‹àa˘i⁄; sídögÅÿp‹à(%u).", 
p‹t
);

949 
	`dp_a˘i⁄s_ouçut_p‹t
(
pkt
, 
p‹t
, 
queue
, 
max_Àn
, 
cookõ
);

953 
	}
}

957 
	$dp_a˘i⁄s_ouçut_p‹t
(
∑ckë
 *
pkt
, 
uöt32_t
 
out_p‹t
, uöt32_à
out_queue
, 
uöt16_t
 
max_Àn
, 
uöt64_t
 
cookõ
) {

959 
out_p‹t
) {

960 (
OFPP_TABLE
): {

961 i‡(
pkt
->
∑ckë_out
) {

963 
	`¥ötf
("submitÖktÅo first flowÅable\n");

964 
pkt
->
∑ckë_out
 = 
Ál£
;

965 
	`pùñöe_¥o˚ss_∑ckë
(
pkt
->
dp
->
pùñöe
,Ökt);

967 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryingÅoÑesubmitÖacketÅoÖipeline.");

971 (
OFPP_IN_PORT
): {

972 
	`dp_p‹ts_ouçut
(
pkt
->
dp
,Ökt->
buf„r
,Ökt->
ö_p‹t
, 0);

975 (
OFPP_CONTROLLER
): {

976 
oÊ_msg_∑ckë_ö
 
msg
;

977 
msg
.
hódî
.
ty≥
 = 
OFPT_PACKET_IN
;

978 
msg
.
tŸÆ_Àn
 = 
pkt
->
buf„r
->
size
;

979 
msg
.
ªas⁄
 = 
pkt
->
h™dÀ_°d
->
èbÀ_miss
? 
OFPR_NO_MATCH
:
OFPR_ACTION
;

980 
msg
.
èbÀ_id
 = 
pkt
->table_id;

981 
msg
.
d©a
 = 
pkt
->
buf„r
->data;

982 
msg
.
cookõ
 = cookie;

984 i‡(
pkt
->
dp
->
c⁄fig
.
miss_£nd_Àn
 !
OFPCML_NO_BUFFER
){

985 
	`dp_buf„rs_ßve
(
pkt
->
dp
->
buf„rs
,Ökt);

986 
msg
.
buf„r_id
 = 
pkt
->buffer_id;

987 
msg
.
d©a_Àngth
 = 
	`MIN
(
max_Àn
, 
pkt
->
buf„r
->
size
);

990 
msg
.
buf„r_id
 = 
OFP_NO_BUFFER
;

991 
msg
.
d©a_Àngth
 = 
pkt
->
buf„r
->
size
;

994 i‡(!
pkt
->
h™dÀ_°d
->
vÆid
){

995 
	`∑ckë_h™dÀ_°d_vÆid©e
(
pkt
->
h™dÀ_°d
);

1000 
msg
.
m©ch
 = (
oÊ_m©ch_hódî
*Ë&
pkt
->
h™dÀ_°d
->match;

1001 
	`dp_£nd_mesßge
(
pkt
->
dp
, (
oÊ_msg_hódî
 *)&
msg
, 
NULL
);

1004 (
OFPP_FLOOD
):

1005 (
OFPP_ALL
): {

1006 
	`dp_p‹ts_ouçut_Æl
(
pkt
->
dp
,Ökt->
buf„r
,Ökt->
ö_p‹t
, 
out_p‹t
 =
OFPP_FLOOD
);

1009 (
OFPP_NORMAL
):

1011 (
OFPP_LOCAL
):

1013 i‡(
pkt
->
ö_p‹t
 =
out_p‹t
) {

1014 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "can't directly forwardÅo inputÖort.");

1016 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "OuçuâögÖackë o¿p‹à%u.", 
out_p‹t
);

1017 
	`dp_p‹ts_ouçut
(
pkt
->
dp
,Ökt->
buf„r
, 
out_p‹t
, 
out_queue
);

1021 
	}
}

1023 
boﬁ


1024 
	$dp_a˘i⁄s_li°_has_out_p‹t
(
size_t
 
a˘i⁄s_num
, 
oÊ_a˘i⁄_hódî
 **
a˘i⁄s
, 
uöt32_t
 
p‹t
) {

1025 
size_t
 
i
;

1027 
i
=0; i < 
a˘i⁄s_num
; i++) {

1028 i‡(
a˘i⁄s
[
i
]->
ty≥
 =
OFPAT_OUTPUT
) {

1029 
oÊ_a˘i⁄_ouçut
 *
ao
 = (oÊ_a˘i⁄_ouçuà*)
a˘i⁄s
[
i
];

1030 i‡(
ao
->
p‹t
 ==Öort) {

1031  
åue
;

1035  
Ál£
;

1036 
	}
}

1038 
boﬁ


1039 
	$dp_a˘i⁄s_li°_has_out_group
(
size_t
 
a˘i⁄s_num
, 
oÊ_a˘i⁄_hódî
 **
a˘i⁄s
, 
uöt32_t
 
group
) {

1040 
size_t
 
i
;

1042 
i
=0; i < 
a˘i⁄s_num
; i++) {

1043 i‡(
a˘i⁄s
[
i
]->
ty≥
 =
OFPAT_GROUP
) {

1044 
oÊ_a˘i⁄_group
 *
ag
 = (oÊ_a˘i⁄_grou∞*)
a˘i⁄s
[
i
];

1045 i‡(
ag
->
group_id
 =
group
) {

1046  
åue
;

1050  
Ál£
;

1051 
	}
}

1053 
oÊ_îr


1054 
	$dp_a˘i⁄s_vÆid©e
(
d©≠©h
 *
dp
, 
size_t
 
a˘i⁄s_num
, 
oÊ_a˘i⁄_hódî
 **
a˘i⁄s
) {

1055 
size_t
 
i
;

1057 
i
=0; i < 
a˘i⁄s_num
; i++) {

1058 i‡(
a˘i⁄s
[
i
]->
ty≥
 =
OFPAT_OUTPUT
) {

1059 
oÊ_a˘i⁄_ouçut
 *
ao
 = (oÊ_a˘i⁄_ouçuà*)
a˘i⁄s
[
i
];

1061 i‡(
ao
->
p‹t
 <
OFPP_MAX
 && 
	`dp_p‹ts_lookup
(
dp
,áo->p‹tË=
NULL
) {

1062 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "Ouçuàa˘i⁄ f‹ invÆidÖ‹à(%u).", 
ao
->
p‹t
);

1063  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_OUT_PORT
);

1066 i‡(
a˘i⁄s
[
i
]->
ty≥
 =
OFPAT_GROUP
) {

1067 
oÊ_a˘i⁄_group
 *
ag
 = (oÊ_a˘i⁄_grou∞*)
a˘i⁄s
[
i
];

1069 i‡(
ag
->
group_id
 <
OFPG_MAX
 && 
	`group_èbÀ_föd
(
dp
->
groups
,ág->group_idË=
NULL
) {

1070 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "Grou∞a˘i⁄ f‹ invÆid grou∞(%u).", 
ag
->
group_id
);

1071  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_BAD_OUT_GROUP
);

1077 
	}
}

1079 
oÊ_îr


1080 
	$dp_a˘i⁄s_check_£t_fõld_ªq
(
oÊ_msg_Êow_mod
 *
msg
, 
size_t
 
a˘i⁄s_num
, 
oÊ_a˘i⁄_hódî
 **
a˘i⁄s
){

1081 
size_t
 
i
;

1083 
i
=0; i < 
a˘i⁄s_num
; i++) {

1084 i‡(
a˘i⁄s
[
i
]->
ty≥
 =
OFPAT_SET_FIELD
) {

1085 
oÊ_a˘i⁄_£t_fõld
 *
as
 = (oÊ_a˘i⁄_£t_fõld*)
a˘i⁄s
[
i
];

1086 
oxm_fõld
 *
f
;

1088 
f
 = 
	`oxm_fõld_lookup
(
as
->
fõld
->
hódî
);

1091 i‡(
msg
->
m©ch
->
Àngth
 =0 && 
f
->
dl_ty≥
[0] != 0)

1092  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_MATCH_INCONSISTENT
);

1094 if(!
	`oxm_¥îeqs_ok
(
f
, (
oÊ_m©ch
*Ë
msg
->
m©ch
)) {

1095  
	`oÊ_îr‹
(
OFPET_BAD_ACTION
, 
OFPBAC_MATCH_INCONSISTENT
);

1101 
	}
}

	@udatapath/dp_actions.h

32 #i‚de‡
DP_ACTIONS_H


33 
	#DP_ACTIONS_H
 1

	)

35 
	~<sys/ty≥s.h
>

36 
	~"d©≠©h.h
"

37 
	~"∑ckë.h
"

38 
	~"oÊib/oÊ-a˘i⁄s.h
"

47 
dp_execuã_a˘i⁄
(
∑ckë
 *
pkt
,

48 
oÊ_a˘i⁄_hódî
 *
a˘i⁄
);

53 
dp_execuã_a˘i⁄_li°
(
∑ckë
 *
pkt
,

54 
size_t
 
a˘i⁄s_num
, 
oÊ_a˘i⁄_hódî
 **
a˘i⁄s
, 
uöt64_t
 
cookõ
);

58 
dp_a˘i⁄s_ouçut_p‹t
(
∑ckë
 *
pkt
, 
uöt32_t
 
out_p‹t
, uöt32_à
out_queue
, 
uöt16_t
 
max_Àn
, 
uöt64_t
 
cookõ
);

61 
boﬁ


62 
dp_a˘i⁄s_li°_has_out_p‹t
(
size_t
 
a˘i⁄s_num
, 
oÊ_a˘i⁄_hódî
 **
a˘i⁄s
, 
uöt32_t
 
p‹t
);

65 
boﬁ


66 
dp_a˘i⁄s_li°_has_out_group
(
size_t
 
a˘i⁄s_num
, 
oÊ_a˘i⁄_hódî
 **
a˘i⁄s
, 
uöt32_t
 
group
);

70 
oÊ_îr


71 
dp_a˘i⁄s_vÆid©e
(
d©≠©h
 *
dp
, 
size_t
 
a˘i⁄s_num
, 
oÊ_a˘i⁄_hódî
 **
a˘i⁄s
);

75 
oÊ_îr


76 
dp_a˘i⁄s_check_£t_fõld_ªq
(
oÊ_msg_Êow_mod
 *
msg
, 
size_t
 
a˘i⁄s_num
, 
oÊ_a˘i⁄_hódî
 **
a˘i⁄s
);

	@udatapath/dp_buffers.c

40 
	~<°dboﬁ.h
>

41 
	~<°döt.h
>

43 
	~"dp_buf„rs.h
"

44 
	~"timevÆ.h
"

45 
	~"∑ckë.h
"

46 
	~"vlog.h
"

48 
	#LOG_MODULE
 
VLM_dp_buf


	)

50 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(60, 60);

58 
	#PKT_BUFFER_BITS
 8

	)

59 
	#PKT_COOKIE_BITS
 (32 - 
PKT_BUFFER_BITS
)

	)

61 
	#N_PKT_BUFFERS
 (1 << 
PKT_BUFFER_BITS
)

	)

62 
	#PKT_BUFFER_MASK
 (
N_PKT_BUFFERS
 - 1)

	)

65 
	#OVERWRITE_SECS
 1

	)

67 
	s∑ckë_buf„r
 {

68 
∑ckë
 *
	mpkt
;

69 
uöt32_t
 
	mcookõ
;

70 
time_t
 
	mtimeout
;

79 
	sdp_buf„rs
 {

80 
d©≠©h
 *
	mdp
;

81 
size_t
 
	mbuf„r_idx
;

82 
size_t
 
	mbuf„rs_num
;

83 
∑ckë_buf„r
 
	mbuf„rs
[
N_PKT_BUFFERS
];

87 
dp_buf„rs
 *

88 
	$dp_buf„rs_¸óã
(
d©≠©h
 *
dp
) {

89 
dp_buf„rs
 *
dpb
 = 
	`xmÆloc
((dp_buffers));

90 
size_t
 
i
;

92 
dpb
->
dp
 = dp;

93 
dpb
->
buf„r_idx
 = (
size_t
)-1;

94 
dpb
->
buf„rs_num
 = 
N_PKT_BUFFERS
;

96 
i
=0; i<
N_PKT_BUFFERS
; i++) {

97 
dpb
->
buf„rs
[
i
].
pkt
 = 
NULL
;

98 
dpb
->
buf„rs
[
i
].
cookõ
 = 
UINT32_MAX
;

99 
dpb
->
buf„rs
[
i
].
timeout
 = 0;

102  
dpb
;

103 
	}
}

105 
size_t


106 
	$dp_buf„rs_size
(
dp_buf„rs
 *
dpb
) {

107  
dpb
->
buf„rs_num
;

108 
	}
}

110 
uöt32_t


111 
	$dp_buf„rs_ßve
(
dp_buf„rs
 *
dpb
, 
∑ckë
 *
pkt
) {

112 
∑ckë_buf„r
 *
p
;

113 
uöt32_t
 
id
;

116 i‡(
pkt
->
buf„r_id
 !
NO_BUFFER
) {

117 i‡(
	`dp_buf„rs_is_Æive
(
dpb
, 
pkt
->
buf„r_id
)) {

118  
pkt
->
buf„r_id
;

122 
dpb
->
buf„r_idx
 = (dpb->buf„r_idx + 1Ë& 
PKT_BUFFER_MASK
;

124 
p
 = &
dpb
->
buf„rs
[dpb->
buf„r_idx
];

125 i‡(
p
->
pkt
 !
NULL
) {

126 i‡(
	`time_now
(Ë< 
p
->
timeout
) {

127  
NO_BUFFER
;

129 
p
->
pkt
->
buf„r_id
 = 
NO_BUFFER
;

130 
	`∑ckë_de°roy
(
p
->
pkt
);

135 i‡(++
p
->
cookõ
 >(1u << 
PKT_COOKIE_BITS
) - 1)

136 
p
->
cookõ
 = 0;

137 
p
->
pkt
 =Ökt;

138 
p
->
timeout
 = 
	`time_now
(Ë+ 
OVERWRITE_SECS
;

139 
id
 = 
dpb
->
buf„r_idx
 | (
p
->
cookõ
 << 
PKT_BUFFER_BITS
);

141 
pkt
->
buf„r_id
 = 
id
;

143  
id
;

144 
	}
}

146 
∑ckë
 *

147 
	$dp_buf„rs_ªåõve
(
dp_buf„rs
 *
dpb
, 
uöt32_t
 
id
) {

148 
∑ckë
 *
pkt
 = 
NULL
;

149 
∑ckë_buf„r
 *
p
;

151 
p
 = &
dpb
->
buf„rs
[
id
 & 
PKT_BUFFER_MASK
];

152 i‡(
p
->
cookõ
 =
id
 >> 
PKT_BUFFER_BITS
 &&Ö->
pkt
 !
NULL
) {

153 
pkt
 = 
p
->pkt;

154 
pkt
->
buf„r_id
 = 
NO_BUFFER
;

155 
pkt
->
∑ckë_out
 = 
Ál£
;

157 
p
->
pkt
 = 
NULL
;

159 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "cookie mismatch: %x != %x\n",

160 
id
 >> 
PKT_BUFFER_BITS
, 
p
->
cookõ
);

163  
pkt
;

164 
	}
}

166 
boﬁ


167 
	$dp_buf„rs_is_Æive
(
dp_buf„rs
 *
dpb
, 
uöt32_t
 
id
) {

168 
∑ckë_buf„r
 *
p
;

170 
p
 = &
dpb
->
buf„rs
[
id
 & 
PKT_BUFFER_MASK
];

171  ((
p
->
cookõ
 =
id
 >> 
PKT_BUFFER_BITS
) &&

172 (
	`time_now
(Ë< 
p
->
timeout
));

173 
	}
}

177 
	$dp_buf„rs_disˇrd
(
dp_buf„rs
 *
dpb
, 
uöt32_t
 
id
, 
boﬁ
 
de°roy
) {

178 
∑ckë_buf„r
 *
p
;

180 
p
 = &
dpb
->
buf„rs
[
id
 & 
PKT_BUFFER_MASK
];

182 i‡(
p
->
cookõ
 =
id
 >> 
PKT_BUFFER_BITS
) {

183 i‡(
de°roy
) {

184 
p
->
pkt
->
buf„r_id
 = 
NO_BUFFER
;

185 
	`∑ckë_de°roy
(
p
->
pkt
);

187 
p
->
pkt
 = 
NULL
;

189 
	}
}

	@udatapath/dp_buffers.h

40 #i‚de‡
DP_BUFFERS_H


41 
	#DP_BUFFERS_H
 1

	)

43 
	~<°dboﬁ.h
>

44 
	~<°döt.h
>

45 
	~"oÂbuf.h
"

49 
	#NO_BUFFER
 0xffffffff

	)

55 
	gd©≠©h
;

56 
	g∑ckë
;

59 
dp_buf„rs
 *

60 
dp_buf„rs_¸óã
(
d©≠©h
 *
dp
);

63 
size_t


64 
dp_buf„rs_size
(
dp_buf„rs
 *
dpb
);

68 
uöt32_t


69 
dp_buf„rs_ßve
(
dp_buf„rs
 *
dpb
, 
∑ckë
 *
pkt
);

73 
∑ckë
 *

74 
dp_buf„rs_ªåõve
(
dp_buf„rs
 *
dpb
, 
uöt32_t
 
id
);

77 
boﬁ


78 
dp_buf„rs_is_Æive
(
dp_buf„rs
 *
dpb
, 
uöt32_t
 
id
);

82 
dp_buf„rs_disˇrd
(
dp_buf„rs
 *
dpb
, 
uöt32_t
 
id
, 
boﬁ
 
de°roy
);

	@udatapath/dp_capabilities.h

34 #i‚de‡
DP_CAPABILITIES_H


35 
	#DP_CAPABILITIES_H
 1

	)

38 
	~"›íÊow/›íÊow.h
"

45 
	#DP_SUPPORTED_CAPABILITIES
 ( 
OFPC_FLOW_STATS
 \

46 | 
OFPC_TABLE_STATS
 \

47 | 
OFPC_PORT_STATS
 \

48 | 
OFPC_GROUP_STATS
 \

50 | 
OFPC_QUEUE_STATS
 )

	)

53 
	#DP_SUPPORTED_ACTIONS
 ( (1 << 
OFPAT_OUTPUT
) \

54 | (2 << 
OFPAT_COPY_TTL_OUT
) \

55 | (3 << 
OFPAT_COPY_TTL_IN
) \

56 | (4 << 
OFPAT_SET_MPLS_TTL
) \

57 | (5 << 
OFPAT_DEC_MPLS_TTL
) \

58 | (6 << 
OFPAT_PUSH_VLAN
) \

59 | (7 << 
OFPAT_POP_VLAN
) \

60 | (8 << 
OFPAT_PUSH_MPLS
) \

61 | (9 << 
OFPAT_POP_MPLS
) \

62 | (10 << 
OFPAT_SET_QUEUE
) \

63 | (11 << 
OFPAT_GROUP
) \

64 | (12 << 
OFPAT_SET_NW_TTL
) \

65 | (13 << 
OFPAT_DEC_NW_TTL
Ë)

	)

67 
	#DP_SUPPORTED_MATCH_FIELDS
 ( 
OFPXMT_OFB_IN_PORT
 \

68 | 
OFPXMT_OFB_IN_PHY_PORT
 \

69 | 
OFPXMT_OFB_METADATA
 \

70 | 
OFPXMT_OFB_ETH_DST
 \

71 | 
OFPXMT_OFB_ETH_SRC
 \

72 | 
OFPXMT_OFB_ETH_TYPE
 \

73 | 
OFPXMT_OFB_VLAN_VID
 \

74 | 
OFPXMT_OFB_VLAN_PCP
 \

75 | 
OFPXMT_OFB_IP_DSCP
 \

76 | 
OFPXMT_OFB_IP_ECN
 \

77 | 
OFPXMT_OFB_IP_PROTO
 \

78 | 
OFPXMT_OFB_IPV4_SRC
 \

79 | 
OFPXMT_OFB_IPV4_DST
 \

80 | 
OFPXMT_OFB_TCP_SRC
 \

81 | 
OFPXMT_OFB_TCP_DST
 \

82 | 
OFPXMT_OFB_UDP_SRC
 \

83 | 
OFPXMT_OFB_UDP_DST
 \

84 | 
OFPXMT_OFB_SCTP_SRC
 \

85 | 
OFPXMT_OFB_SCTP_DST
 \

86 | 
OFPXMT_OFB_ICMPV4_CODE
 \

87 | 
OFPXMT_OFB_ICMPV4_TYPE
 \

88 | 
OFPXMT_OFB_ARP_OP
 \

89 | 
OFPXMT_OFB_ARP_SHA
 \

90 | 
OFPXMT_OFB_ARP_SPA
 \

91 | 
OFPXMT_OFB_ARP_THA
 \

92 | 
OFPXMT_OFB_ARP_TPA
 \

93 | 
OFPXMT_OFB_IPV6_SRC
 \

94 | 
OFPXMT_OFB_IPV6_DST
 \

95 | 
OFPXMT_OFB_IPV6_FLABEL
 \

96 | 
OFPXMT_OFB_ICMPV6_CODE
 \

97 | 
OFPXMT_OFB_ICMPV6_TYPE
 \

98 | 
OFPXMT_OFB_IPV6_ND_SLL
 \

99 | 
OFPXMT_OFB_IPV6_ND_TARGET
 \

100 | 
OFPXMT_OFB_IPV6_ND_TLL
 \

101 | 
OFPXMT_OFB_MPLS_LABEL
 \

102 | 
OFPXMT_OFB_MPLS_TC
 )

	)

104 
	#DP_SUPPORTED_GROUPS
 ( 
OFPGT_ALL
 \

105 | 
OFPGT_SELECT
 \

106 | 
OFPGT_INDIRECT
 \

107 | 
OFPGT_FF
)

	)

109 
	#DP_SUPPORTED_GROUP_CAPABILITIES
 ( 
OFPGFC_SELECT_WEIGHT
 \

110  )

	)

	@udatapath/dp_control.c

32 
	~"compûî.h
"

33 
	~"dp_ˇ∑bûôõs.h
"

34 
	~"dp_c⁄åﬁ.h
"

35 
	~"dp_a˘i⁄s.h
"

36 
	~"dp_buf„rs.h
"

37 
	~"dp_p‹ts.h
"

38 
	~"group_èbÀ.h
"

39 
	~"mëî_èbÀ.h
"

40 
	~"∑ckës.h
"

41 
	~"pùñöe.h
"

42 
	~"oÊib/oÊ.h
"

43 
	~"oÊib/oÊ-mesßges.h
"

44 
	~"oÊib/oÊ-log.h
"

45 
	~"›íÊow/›íÊow.h
"

47 
	~"vlog.h
"

48 
	#LOG_MODULE
 
VLM_dp_˘æ


	)

50 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(60, 60);

53 
oÊ_îr


54 
	$h™dÀ_c⁄åﬁ_b¨rõr_ªque°
(
d©≠©h
 *
dp
,

55 
oÊ_msg_hódî
 *
msg
, c⁄° 
£ndî
 *sender) {

59 
oÊ_msg_hódî
 
ª∂y
 =

60 {.
ty≥
 = 
OFPT_BARRIER_REPLY
};

62 
	`dp_£nd_mesßge
(
dp
, (
oÊ_msg_hódî
 *)&
ª∂y
, 
£ndî
);

63 
	`oÊ_msg_‰ì
(
msg
, 
dp
->
exp
);

66 
	}
}

69 
oÊ_îr


70 
	$h™dÀ_c⁄åﬁ_„©uªs_ªque°
(
d©≠©h
 *
dp
,

71 
oÊ_msg_hódî
 *
msg
, c⁄° 
£ndî
 *sender) {

73 
oÊ_msg_„©uªs_ª∂y
 
ª∂y
 =

74 {{.
ty≥
 = 
OFPT_FEATURES_REPLY
},

75 .
d©≠©h_id
 = 
dp
->
id
,

76 .
n_buf„rs
 = 
	`dp_buf„rs_size
(
dp
->
buf„rs
),

77 .
n_èbÀs
 = 
PIPELINE_TABLES
,

78 .
auxûüry_id
 = 
£ndî
->
c⁄n_id
,

79 .
ˇ∑bûôõs
 = 
DP_SUPPORTED_CAPABILITIES
,

80 .
ª£rved
 = 0x00000000};

82 
	`dp_£nd_mesßge
(
dp
, (
oÊ_msg_hódî
 *)&
ª∂y
, 
£ndî
);

84 
	`oÊ_msg_‰ì
(
msg
, 
dp
->
exp
);

87 
	}
}

91 
oÊ_îr


92 
	$h™dÀ_c⁄åﬁ_gë_c⁄fig_ªque°
(
d©≠©h
 *
dp
,

93 
oÊ_msg_hódî
 *
msg
, c⁄° 
£ndî
 *sender) {

95 
oÊ_msg_gë_c⁄fig_ª∂y
 
ª∂y
 =

96 {{.
ty≥
 = 
OFPT_GET_CONFIG_REPLY
},

97 .
c⁄fig
 = &
dp
->config};

98 
	`dp_£nd_mesßge
(
dp
, (
oÊ_msg_hódî
 *)&
ª∂y
, 
£ndî
);

100 
	`oÊ_msg_‰ì
(
msg
, 
dp
->
exp
);

102 
	}
}

105 
oÊ_îr


106 
	$h™dÀ_c⁄åﬁ_£t_c⁄fig
(
d©≠©h
 *
dp
, 
oÊ_msg_£t_c⁄fig
 *
msg
,

107 c⁄° 
£ndî
 *£ndî 
UNUSED
) {

108 
uöt16_t
 
Êags
;

110 
Êags
 = 
msg
->
c⁄fig
->Êag†& 
OFPC_FRAG_MASK
;

111 i‡((
Êags
 & 
OFPC_FRAG_MASK
Ë!
OFPC_FRAG_NORMAL


112 && (
Êags
 & 
OFPC_FRAG_MASK
Ë!
OFPC_FRAG_DROP
) {

113 
Êags
 = (Êag†& ~
OFPC_FRAG_MASK
Ë| 
OFPC_FRAG_DROP
;

116 
dp
->
c⁄fig
.
Êags
 = flags;

117 
dp
->
c⁄fig
.
miss_£nd_Àn
 = 
msg
->config->miss_send_len;

119 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
dp
->
exp
);

121 
	}
}

124 
oÊ_îr


125 
	$h™dÀ_c⁄åﬁ_∑ckë_out
(
d©≠©h
 *
dp
, 
oÊ_msg_∑ckë_out
 *
msg
,

126 c⁄° 
£ndî
 *sender) {

127 
∑ckë
 *
pkt
;

128 
îr‹
;

130 if(
£ndî
->
ªmŸe
->
rﬁe
 =
OFPCR_ROLE_SLAVE
)

131  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_IS_SLAVE
);

133 
îr‹
 = 
	`dp_a˘i⁄s_vÆid©e
(
dp
, 
msg
->
a˘i⁄s_num
, msg->
a˘i⁄s
);

134 i‡(
îr‹
) {

135  
îr‹
;

138 i‡(
msg
->
buf„r_id
 =
NO_BUFFER
) {

139 
oÂbuf
 *
buf
;

141 
buf
 = 
	`oÂbuf_√w
(0);

142 
	`oÂbuf_u£
(
buf
, 
msg
->
d©a
, msg->
d©a_Àngth
);

143 
	`oÂbuf_put_unöô
(
buf
, 
msg
->
d©a_Àngth
);

144 
pkt
 = 
	`∑ckë_¸óã
(
dp
, 
msg
->
ö_p‹t
, 
buf
, 
åue
);

147 
pkt
 = 
	`dp_buf„rs_ªåõve
(
dp
->
buf„rs
, 
msg
->
buf„r_id
);

150 i‡(
pkt
 =
NULL
) {

152  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BUFFER_EMPTY
);

155 
	`dp_execuã_a˘i⁄_li°
(
pkt
, 
msg
->
a˘i⁄s_num
, msg->
a˘i⁄s
, 0xffffffffffffffff);

157 
	`∑ckë_de°roy
(
pkt
);

158 
	`oÊ_msg_‰ì_∑ckë_out
(
msg
, 
Ál£
, 
dp
->
exp
);

160 
	}
}

164 
oÊ_îr


165 
	$h™dÀ_c⁄åﬁ_°©s_ªque°_desc
(
d©≠©h
 *
dp
,

166 
oÊ_msg_mu…ù¨t_ªque°_hódî
 *
msg
,

167 c⁄° 
£ndî
 *sender) {

168 
oÊ_msg_ª∂y_desc
 
ª∂y
 =

169 {{{.
ty≥
 = 
OFPT_MULTIPART_REPLY
},

170 .
ty≥
 = 
OFPMP_DESC
, .
Êags
 = 0x0000},

171 .
m‰_desc
 = 
dp
->mfr_desc,

172 .
hw_desc
 = 
dp
->hw_desc,

173 .
sw_desc
 = 
dp
->sw_desc,

174 .
£rül_num
 = 
dp
->serial_num,

175 .
dp_desc
 = 
dp
->dp_desc};

176 
	`dp_£nd_mesßge
(
dp
, (
oÊ_msg_hódî
 *)&
ª∂y
, 
£ndî
);

178 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
dp
->
exp
);

180 
	}
}

183 
oÊ_îr


184 
	$h™dÀ_c⁄åﬁ_°©s_ªque°
(
d©≠©h
 *
dp
,

185 
oÊ_msg_mu…ù¨t_ªque°_hódî
 *
msg
,

186 c⁄° 
£ndî
 *sender) {

187 
msg
->
ty≥
) {

188 (
OFPMP_DESC
): {

189  
	`h™dÀ_c⁄åﬁ_°©s_ªque°_desc
(
dp
, 
msg
, 
£ndî
);

191 (
OFPMP_FLOW
): {

192  
	`pùñöe_h™dÀ_°©s_ªque°_Êow
(
dp
->
pùñöe
, (
oÊ_msg_mu…ù¨t_ªque°_Êow
 *)
msg
, 
£ndî
);

194 (
OFPMP_AGGREGATE
): {

195  
	`pùñöe_h™dÀ_°©s_ªque°_aggªg©e
(
dp
->
pùñöe
, (
oÊ_msg_mu…ù¨t_ªque°_Êow
 *)
msg
, 
£ndî
);

197 (
OFPMP_TABLE
): {

198  
	`pùñöe_h™dÀ_°©s_ªque°_èbÀ
(
dp
->
pùñöe
, 
msg
, 
£ndî
);

200 (
OFPMP_TABLE_FEATURES
):{

201  
	`pùñöe_h™dÀ_°©s_ªque°_èbÀ_„©uªs_ªque°
(
dp
->
pùñöe
, 
msg
, 
£ndî
);

203 (
OFPMP_PORT_STATS
): {

204  
	`dp_p‹ts_h™dÀ_°©s_ªque°_p‹t
(
dp
, (
oÊ_msg_mu…ù¨t_ªque°_p‹t
 *)
msg
, 
£ndî
);

206 (
OFPMP_QUEUE
): {

207  
	`dp_p‹ts_h™dÀ_°©s_ªque°_queue
(
dp
, (
oÊ_msg_mu…ù¨t_ªque°_queue
 *)
msg
, 
£ndî
);

209 (
OFPMP_GROUP
): {

210  
	`group_èbÀ_h™dÀ_°©s_ªque°_group
(
dp
->
groups
, (
oÊ_msg_mu…ù¨t_ªque°_group
 *)
msg
, 
£ndî
);

212 (
OFPMP_GROUP_DESC
): {

213  
	`group_èbÀ_h™dÀ_°©s_ªque°_group_desc
(
dp
->
groups
, 
msg
, 
£ndî
);

215 (
OFPMP_GROUP_FEATURES
):{

216  
	`group_èbÀ_h™dÀ_°©s_ªque°_group_„©uªs
(
dp
->
groups
, 
msg
, 
£ndî
);

218 (
OFPMP_METER
):{

219  
	`mëî_èbÀ_h™dÀ_°©s_ªque°_mëî
(
dp
->
mëîs
,(
oÊ_msg_mu…ù¨t_mëî_ªque°
*)
msg
, 
£ndî
);

221 (
OFPMP_METER_CONFIG
):{

222  
	`mëî_èbÀ_h™dÀ_°©s_ªque°_mëî_c⁄f
(
dp
->
mëîs
,(
oÊ_msg_mu…ù¨t_mëî_ªque°
*)
msg
, 
£ndî
);

224 
OFPMP_METER_FEATURES
:{

225  
	`mëî_èbÀ_h™dÀ_„©uªs_ªque°
(
dp
->
mëîs
, 
msg
, 
£ndî
);

227 
OFPMP_PORT_DESC
:{

228  
	`dp_p‹ts_h™dÀ_p‹t_desc_ªque°
(
dp
, 
msg
, 
£ndî
);

230 (
OFPMP_EXPERIMENTER
): {

231  
	`dp_exp_°©s
(
dp
, (
oÊ_msg_mu…ù¨t_ªque°_ex≥rimíãr
 *)
msg
, 
£ndî
);

234  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_MULTIPART
);

237 
	}
}

241 
oÊ_îr


242 
	$h™dÀ_c⁄åﬁ_echo_ª∂y
(
d©≠©h
 *
dp
 
UNUSED
,

243 
oÊ_msg_echo
 *
msg
,

244 c⁄° 
£ndî
 *£ndî 
UNUSED
) {

246 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
dp
->
exp
);

248 
	}
}

251 
oÊ_îr


252 
	$h™dÀ_c⁄åﬁ_echo_ªque°
(
d©≠©h
 *
dp
,

253 
oÊ_msg_echo
 *
msg
,

254 c⁄° 
£ndî
 *sender) {

255 
oÊ_msg_echo
 
ª∂y
 =

256 {{.
ty≥
 = 
OFPT_ECHO_REPLY
},

257 .
d©a_Àngth
 = 
msg
->data_length,

258 .
d©a
 = 
msg
->data};

259 
	`dp_£nd_mesßge
(
dp
, (
oÊ_msg_hódî
 *)&
ª∂y
, 
£ndî
);

261 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
dp
->
exp
);

263 
	}
}

266 
oÊ_îr


267 
	$h™dÀ_c⁄åﬁ_msg
(
d©≠©h
 *
dp
, 
oÊ_msg_hódî
 *
msg
,

268 c⁄° 
£ndî
 *sender) {

270 i‡(
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

271 *
msg_°r
 = 
	`oÊ_msg_to_°rög
(
msg
, 
dp
->
exp
);

272 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "ª˚ived c⁄åﬁ msg: %.400s", 
msg_°r
);

273 
	`‰ì
(
msg_°r
);

280 
msg
->
ty≥
) {

281 
OFPT_HELLO
: {

282 
	`oÊ_msg_‰ì
(
msg
, 
dp
->
exp
);

285 
OFPT_ERROR
: {

286  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_TYPE
);

288 
OFPT_BARRIER_REQUEST
: {

289  
	`h™dÀ_c⁄åﬁ_b¨rõr_ªque°
(
dp
, 
msg
, 
£ndî
);

291 
OFPT_BARRIER_REPLY
: {

292 
	`oÊ_msg_‰ì
(
msg
, 
dp
->
exp
);

295 
OFPT_FEATURES_REQUEST
: {

296  
	`h™dÀ_c⁄åﬁ_„©uªs_ªque°
(
dp
, 
msg
, 
£ndî
);

298 
OFPT_FEATURES_REPLY
: {

299  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_TYPE
);

301 
OFPT_GET_CONFIG_REQUEST
: {

302  
	`h™dÀ_c⁄åﬁ_gë_c⁄fig_ªque°
(
dp
, 
msg
, 
£ndî
);

304 
OFPT_GET_CONFIG_REPLY
: {

305  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_TYPE
);

307 
OFPT_SET_CONFIG
: {

308  
	`h™dÀ_c⁄åﬁ_£t_c⁄fig
(
dp
, (
oÊ_msg_£t_c⁄fig
 *)
msg
, 
£ndî
);

310 
OFPT_PACKET_IN
: {

311  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_TYPE
);

313 
OFPT_PACKET_OUT
: {

314  
	`h™dÀ_c⁄åﬁ_∑ckë_out
(
dp
, (
oÊ_msg_∑ckë_out
 *)
msg
, 
£ndî
);

317 
OFPT_FLOW_REMOVED
: {

318  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_TYPE
);

320 
OFPT_PORT_STATUS
: {

321  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_TYPE
);

323 
OFPT_FLOW_MOD
: {

324  
	`pùñöe_h™dÀ_Êow_mod
(
dp
->
pùñöe
, (
oÊ_msg_Êow_mod
 *)
msg
, 
£ndî
);

326 
OFPT_STATE_MOD
: {

327  
	`pùñöe_h™dÀ_°©e_mod
(
dp
->
pùñöe
, (
oÊ_msg_°©e_mod
 *)
msg
, 
£ndî
);

329 
OFPT_GROUP_MOD
: {

330  
	`group_èbÀ_h™dÀ_group_mod
(
dp
->
groups
, (
oÊ_msg_group_mod
 *)
msg
, 
£ndî
);

332 
OFPT_PORT_MOD
: {

333  
	`dp_p‹ts_h™dÀ_p‹t_mod
(
dp
, (
oÊ_msg_p‹t_mod
 *)
msg
, 
£ndî
);

335 
OFPT_TABLE_MOD
: {

336  
	`pùñöe_h™dÀ_èbÀ_mod
(
dp
->
pùñöe
, (
oÊ_msg_èbÀ_mod
 *)
msg
, 
£ndî
);

338 
OFPT_MULTIPART_REQUEST
: {

339  
	`h™dÀ_c⁄åﬁ_°©s_ªque°
(
dp
, (
oÊ_msg_mu…ù¨t_ªque°_hódî
 *)
msg
, 
£ndî
);

341 
OFPT_MULTIPART_REPLY
: {

342  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_TYPE
);

344 
OFPT_ECHO_REQUEST
: {

345  
	`h™dÀ_c⁄åﬁ_echo_ªque°
(
dp
, (
oÊ_msg_echo
 *)
msg
, 
£ndî
);

347 
OFPT_ECHO_REPLY
: {

348  
	`h™dÀ_c⁄åﬁ_echo_ª∂y
(
dp
, (
oÊ_msg_echo
 *)
msg
, 
£ndî
);

350 
OFPT_QUEUE_GET_CONFIG_REQUEST
: {

351  
	`dp_p‹ts_h™dÀ_queue_gë_c⁄fig_ªque°
(
dp
, (
oÊ_msg_queue_gë_c⁄fig_ªque°
 *)
msg
, 
£ndî
);

353 
OFPT_ROLE_REQUEST
: {

354  
	`dp_h™dÀ_rﬁe_ªque°
(
dp
, (
oÊ_msg_rﬁe_ªque°
*)
msg
, 
£ndî
);

356 
OFPT_ROLE_REPLY
:{

357  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_TYPE
);

359 
OFPT_QUEUE_GET_CONFIG_REPLY
: {

360  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_TYPE
);

362 
OFPT_METER_MOD
:{

363  
	`mëî_èbÀ_h™dÀ_mëî_mod
(
dp
->
mëîs
, (
oÊ_msg_mëî_mod
 *)
msg
, 
£ndî
);

365 
OFPT_EXPERIMENTER
: {

366  
	`dp_exp_mesßge
(
dp
, (
oÊ_msg_ex≥rimíãr
 *)
msg
, 
£ndî
);

368 
OFPT_GET_ASYNC_REPLY
:{

369  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_TYPE
);

371 
OFPT_GET_ASYNC_REQUEST
:

372 
OFPT_SET_ASYNC
:{

373  
	`dp_h™dÀ_async_ªque°
(
dp
, (
oÊ_msg_async_c⁄fig
*)
msg
, 
£ndî
);

376  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_TYPE
);

379 
	}
}

	@udatapath/dp_control.h

32 #i‚de‡
DP_CONTROL_H


33 
	#DP_CONTROL_H
 1

	)

35 
	~"d©≠©h.h
"

36 
	~"oÊib/oÊ.h
"

37 
	~"oÊib/oÊ-mesßges.h
"

45 
	g£ndî
;

48 
oÊ_îr


49 
h™dÀ_c⁄åﬁ_msg
(
d©≠©h
 *
dp
, 
oÊ_msg_hódî
 *
msg
,

50 c⁄° 
£ndî
 *sender);

	@udatapath/dp_exp.c

32 
	~<°dlib.h
>

33 
	~<°rög.h
>

34 
	~"d©≠©h.h
"

35 
	~"dp_exp.h
"

36 
	~"∑ckë.h
"

37 
	~"oÊib/oÊ.h
"

38 
	~"oÊib/oÊ-a˘i⁄s.h
"

39 
	~"oÊib/oÊ-°ru˘s.h
"

40 
	~"oÊib/oÊ-mesßges.h
"

41 
	~"oÊib-exp/oÊ-exp-›íÊow.h
"

42 
	~"oÊib-exp/oÊ-exp-nicúa.h
"

43 
	~"›íÊow/›íÊow.h
"

44 
	~"›íÊow/›íÊow-ext.h
"

45 
	~"›íÊow/nicúa-ext.h
"

46 
	~"vlog.h
"

48 
	#LOG_MODULE
 
VLM_dp_exp


	)

50 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(60, 60);

53 
	$dp_exp_a˘i⁄
(
∑ckë
 * 
pkt
 
UNUSED
, 
oÊ_a˘i⁄_ex≥rimíãr
 *
a˘
) {

54 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryögÅÿexecuã unknow¿ex≥rimíã∏a˘i⁄ (%u).", 
a˘
->
ex≥rimíãr_id
);

55 
	}
}

58 
	$dp_exp_ö°
(
∑ckë
 *
pkt
 
UNUSED
, 
oÊ_ö°ru˘i⁄_ex≥rimíãr
 *
ö°
) {

59 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryögÅÿexecuã unknow¿ex≥rimíã∏ö°ru˘i⁄ (%u).", 
ö°
->
ex≥rimíãr_id
);

60 
	}
}

62 
oÊ_îr


63 
	$dp_exp_°©s
(
d©≠©h
 *
dp
 
UNUSED
,

64 
oÊ_msg_mu…ù¨t_ªque°_ex≥rimíãr
 *
msg
,

65 c⁄° 
£ndî
 *£ndî 
UNUSED
) {

66 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryögÅÿh™dÀ unknow¿ex≥rimíã∏°©†(%u).", 
msg
->
ex≥rimíãr_id
);

67  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_EXPERIMENTER
);

68 
	}
}

71 
oÊ_îr


72 
	$dp_exp_mesßge
(
d©≠©h
 *
dp
,

73 
oÊ_msg_ex≥rimíãr
 *
msg
,

74 c⁄° 
£ndî
 *sender) {

76 
msg
->
ex≥rimíãr_id
) {

77 (
OPENFLOW_VENDOR_ID
): {

78 
oÊ_exp_›íÊow_msg_hódî
 *
exp
 = (oÊ_exp_›íÊow_msg_hódî *)
msg
;

80 
exp
->
ty≥
) {

81 (
OFP_EXT_QUEUE_MODIFY
): {

82  
	`dp_p‹ts_h™dÀ_queue_modify
(
dp
, (
oÊ_exp_›íÊow_msg_queue
 *)
msg
, 
£ndî
);

84 (
OFP_EXT_QUEUE_DELETE
): {

85  
	`dp_p‹ts_h™dÀ_queue_dñëe
(
dp
, (
oÊ_exp_›íÊow_msg_queue
 *)
msg
, 
£ndî
);

87 (
OFP_EXT_SET_DESC
): {

88  
	`dp_h™dÀ_£t_desc
(
dp
, (
oÊ_exp_›íÊow_msg_£t_dp_desc
 *)
msg
, 
£ndî
);

91 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryögÅÿh™dÀ unknow¿ex≥rimíã∏ty≥ (%u).", 
exp
->
ty≥
);

92  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_EXPERIMENTER
);

97  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_EXPERIMENTER
);

100 
	}
}

	@udatapath/dp_exp.h

32 #i‚de‡
DP_EXP_H


33 
	#DP_EXP_H
 1

	)

35 
	~"∑ckë.h
"

36 
	~"oÊib/oÊ-mesßges.h
"

38 
	gd©≠©h
;

39 
	g£ndî
;

47 
dp_exp_a˘i⁄
(
∑ckë
 *
pkt
, 
oÊ_a˘i⁄_ex≥rimíãr
 *
a˘
);

51 
dp_exp_ö°
(
∑ckë
 *
pkt
, 
oÊ_ö°ru˘i⁄_ex≥rimíãr
 *
ö°
);

54 
oÊ_îr


55 
dp_exp_°©s
(
d©≠©h
 *
dp
, 
oÊ_msg_mu…ù¨t_ªque°_ex≥rimíãr
 *
msg
,

56 c⁄° 
£ndî
 *sender);

59 
oÊ_îr


60 
dp_exp_mesßge
(
d©≠©h
 *
dp
,

61 
oÊ_msg_ex≥rimíãr
 *
msg
,

62 c⁄° 
£ndî
 *sender);

	@udatapath/dp_ports.c

40 
	~<¨∑/öë.h
>

41 
	~<as£π.h
>

42 
	~<î∫o.h
>

43 
	~<öây≥s.h
>

44 
	~"dp_exp.h
"

45 
	~"dp_p‹ts.h
"

46 
	~"d©≠©h.h
"

47 
	~"∑ckës.h
"

48 
	~"pùñöe.h
"

49 
	~"oÊib/oÊ.h
"

50 
	~"oÊib/oÊ-mesßges.h
"

51 
	~"oÊib-exp/oÊ-exp-›íÊow.h
"

52 
	~"oÊib/oÊ-log.h
"

53 
	~"utû.h
"

55 
	~"vlog.h
"

56 
	#LOG_MODULE
 
VLM_dp_p‹ts


	)

58 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(60, 60);

60 #i‡
deföed
(
OF_HW_PLAT
)

61 
	~<›íÊow/of_hw_≠i.h
>

62 
	~<±hªad.h
>

66 #i‡
deföed
(
OF_HW_PLAT
Ë&& !deföed(
USE_NETDEV
)

69 
±hªad_muãx_t
 
	gpkt_q_muãx
 = 
PTHREAD_MUTEX_INITIALIZER
;

70 
	#PKT_Q_LOCK
 
	`±hªad_muãx_lock
(&
pkt_q_muãx
)

	)

71 
	#PKT_Q_UNLOCK
 
	`±hªad_muãx_u∆ock
(&
pkt_q_muãx
)

	)

74 
	$íqueue_pkt
(
d©≠©h
 *
dp
, 
oÂbuf
 *
buf„r
, 
of_p‹t_t
 
p‹t_no
,

75 
ªas⁄
)

77 
hw_pkt_q_íåy
 *
q_íåy
;

79 i‡((
q_íåy
 = 
	`xmÆloc
((*q_íåy))Ë=
NULL
) {

80 
	`VLOG_WARN
(
LOG_MODULE
, "CouldÇotálloc qÉntry\n");

84 
q_íåy
->
buf„r
 = buffer;

85 
q_íåy
->
√xt
 = 
NULL
;

86 
q_íåy
->
p‹t_no
 =Öort_no;

87 
q_íåy
->
ªas⁄
 =Ñeason;

88 
	`±hªad_muãx_lock
(&
pkt_q_muãx
);

89 i‡(
dp
->
hw_pkt_li°_hód
 =
NULL
) {

90 
dp
->
hw_pkt_li°_hód
 = 
q_íåy
;

92 
dp
->
hw_pkt_li°_èû
->
√xt
 = 
q_íåy
;

94 
dp
->
hw_pkt_li°_èû
 = 
q_íåy
;

95 
	`±hªad_muãx_u∆ock
(&
pkt_q_muãx
);

96 
	}
}

100 
	$dequeue_pkt
(
d©≠©h
 *
dp
, 
oÂbuf
 **
buf„r
, 
of_p‹t_t
 *
p‹t_no
,

101 *
ªas⁄
)

103 
hw_pkt_q_íåy
 *
q_íåy
;

104 
rv
 = 0;

106 
	`±hªad_muãx_lock
(&
pkt_q_muãx
);

107 
q_íåy
 = 
dp
->
hw_pkt_li°_hód
;

108 i‡(
dp
->
hw_pkt_li°_hód
 !
NULL
) {

109 
dp
->
hw_pkt_li°_hód
 = dp->hw_pkt_li°_hód->
√xt
;

110 i‡(
dp
->
hw_pkt_li°_hód
 =
NULL
) {

111 
dp
->
hw_pkt_li°_èû
 = 
NULL
;

114 
	`±hªad_muãx_u∆ock
(&
pkt_q_muãx
);

116 i‡(
q_íåy
 !
NULL
) {

117 
rv
 = 1;

118 *
buf„r
 = 
q_íåy
->buffer;

119 *
p‹t_no
 = 
q_íåy
->port_no;

120 *
ªas⁄
 = 
q_íåy
->reason;

121 
	`‰ì
(
q_íåy
);

124  
rv
;

125 
	}
}

130 #i‡
deföed
(
OF_HW_PLAT
Ë&& !deföed(
USE_NETDEV
Ë&& deföed(
UDATAPATH_AS_LIB
)

139 
	$hw_∑ckë_ö
(
of_p‹t_t
 
p‹t_no
, 
of_∑ckë_t
 *
∑ckë
, 
ªas⁄
,

140 *
cookõ
)

142 
sw_p‹t
 *
p‹t
;

143 
oÂbuf
 *
buf„r
 = 
NULL
;

144 
d©≠©h
 *
dp
 = (d©≠©h *)
cookõ
;

145 c⁄° 
hódroom
 = 128 + 2;

146 c⁄° 
h¨d_hódî
 = 
VLAN_ETH_HEADER_LEN
;

147 c⁄° 
èû_room
 = (
uöt32_t
);

149 
	`VLOG_INFO
(
LOG_MODULE
, "dpÑcvÖacket onÖort %d, size %d\n",

150 
p‹t_no
, 
∑ckë
->
Àngth
);

151 i‡((
p‹t_no
 < 1Ë||Ö‹t_nÿ> 
DP_MAX_PORTS
) {

152 
	`VLOG_ERR
(
LOG_MODULE
, "BadÑe˚ivêp‹à%d\n", 
p‹t_no
);

156 
p‹t
 = &
dp
->
p‹ts
[
p‹t_no
];

157 i‡(!
	`PORT_IN_USE
(
p‹t
)) {

158 
	`VLOG_WARN
(
LOG_MODULE
, "Re˚ivêp‹ànŸá˘ive: %d\n", 
p‹t_no
);

161 i‡(!
	`IS_HW_PORT
(
p‹t
)) {

162 
	`VLOG_ERR
(
LOG_MODULE
, "Re˚ivêp‹ànŸ c⁄åﬁÀd by HW: %d\n", 
p‹t_no
);

167 
p‹t
->
rx_∑ckës
++;

168 
p‹t
->
rx_byãs
 +
∑ckë
->
Àngth
;

172 
buf„r
 = 
	`oÂbuf_√w
(
hódroom
 + 
h¨d_hódî
 + 
∑ckë
->
Àngth
 + 
èû_room
);

173 i‡(
buf„r
 =
NULL
) {

174 
	`VLOG_WARN
(
LOG_MODULE
, "CouldÇotálloc ofpbuf on hwÖkt in\n");

175 
	`Ârötf
(
°dîr
, "CouldÇotálloc ofpbuf on hwÖkt in\n");

177 
buf„r
->
d©a
 = (*)buf„r->d©®+ 
hódroom
;

178 
buf„r
->
size
 = 
∑ckë
->
Àngth
;

179 
	`mem˝y
(
buf„r
->
d©a
, 
∑ckë
->d©a,Öackë->
Àngth
);

180 
	`íqueue_pkt
(
dp
, 
buf„r
, 
p‹t_no
, 
ªas⁄
);

181 
	`pﬁl_immedüã_wake
();

185 
	}
}

188 #i‡
deföed
(
OF_HW_PLAT
)

190 
	$dp_hw_drv_öô
(
d©≠©h
 *
dp
)

192 
dp
->
hw_pkt_li°_hód
 = 
NULL
;

193 
dp
->
hw_pkt_li°_èû
 = 
NULL
;

195 
dp
->
hw_drv
 = 
	`√w_of_hw_drivî
(dp);

196 i‡(
dp
->
hw_drv
 =
NULL
) {

197 
	`VLOG_ERR
(
LOG_MODULE
, "CouldÇot create HW driver");

200 #i‡!
	`deföed
(
USE_NETDEV
)

201 i‡(
dp
->
hw_drv
->
	`∑ckë_ª˚ive_ªgi°î
(dp->hw_drv,

202 
hw_∑ckë_ö
, 
dp
) < 0) {

203 
	`VLOG_ERR
(
LOG_MODULE
, "CouldÇotÑegister with HW driverÅoÑeceiveÖkts");

208 
	}
}

215 
	$¥o˚ss_buf„r
(
d©≠©h
 *
dp
, 
sw_p‹t
 *
p
, 
oÂbuf
 *
buf„r
) {

216 
∑ckë
 *
pkt
;

218 i‡(
p
->
c⁄f
->
c⁄fig
 & ((
OFPPC_NO_RECV
 | 
OFPPC_PORT_DOWN
) != 0)) {

219 
	`oÂbuf_dñëe
(
buf„r
);

222 
	`¥ötf
("run dpÖktÅhroughÖipeline (copy bufferÅoÖkt)\n");

224 
pkt
 = 
	`∑ckë_¸óã
(
dp
, 
p
->
°©s
->
p‹t_no
, 
buf„r
, 
Ál£
);

225 
	`pùñöe_¥o˚ss_∑ckë
(
dp
->
pùñöe
, 
pkt
);

226 
	}
}

229 
	$dp_p‹ts_run
(
d©≠©h
 *
dp
) {

231 
oÂbuf
 *
buf„r
 = 
NULL
;

233 
sw_p‹t
 *
p
, *
≤
;

235 #i‡
	`deföed
(
OF_HW_PLAT
Ë&& !deföed(
USE_NETDEV
)

237 
oÂbuf
 *
buf„r
;

238 
of_p‹t_t
 
p‹t_no
;

239 
ªas⁄
;

240 
sw_p‹t
 *
p
;

242 
	`dequeue_pkt
(
dp
, &
buf„r
, &
p‹t_no
, &
ªas⁄
)) {

243 
p
 = 
	`dp_p‹ts_lookup
(
dp
, 
p‹t_no
);

245 
	`¥o˚ss_∑ckë
(
dp
, 
p
, 
buf„r
);

250 
	`LIST_FOR_EACH_SAFE
 (
p
, 
≤
, 
sw_p‹t
, 
node
, &
dp
->
p‹t_li°
) {

251 
îr‹
;

253 i‡(
	`IS_HW_PORT
(
p
)) {

256 i‡(
buf„r
 =
NULL
) {

260 c⁄° 
hódroom
 = 128 + 2;

261 c⁄° 
h¨d_hódî
 = 
VLAN_ETH_HEADER_LEN
;

262 c⁄° 
mtu
 = 
	`√tdev_gë_mtu
(
p
->
√tdev
);

263 
buf„r
 = 
	`oÂbuf_√w_wôh_hódroom
(
h¨d_hódî
 + 
mtu
, 
hódroom
);

265 
îr‹
 = 
	`√tdev_ªcv
(
p
->
√tdev
, 
buf„r
);

266 i‡(
îr‹
 =
ENETDOWN
){

267 
	`VLOG_ERR
(
LOG_MODULE
, "N√£oÅenhoÇada masÅ√¥áqui...");

269 i‡(!
îr‹
) {

270 
p
->
°©s
->
rx_∑ckës
++;

271 
p
->
°©s
->
rx_byãs
 +
buf„r
->
size
;

273 
	`¥o˚ss_buf„r
(
dp
, 
p
, 
buf„r
);

274 
buf„r
 = 
NULL
;

275 } i‡(
îr‹
 !
EAGAIN
) {

276 if(
îr‹
 =
ENETDOWN
){

277 
p
->
c⁄f
->
°©e
 = 
OFPPS_LINK_DOWN
;

279 
	`VLOG_ERR_RL
(
LOG_MODULE
, &
æ
, "errorÑeceiving data from %s: %s",

280 
	`√tdev_gë_«me
(
p
->
√tdev
), 
	`°ªº‹
(
îr‹
));

284 
	}
}

287 
uöt32_t
 
	$p‹t_•ìd
(
uöt32_t
 
c⁄f
) {

288 i‡((
c⁄f
 & 
OFPPF_1TB_FD
) != 0)  1024 * 1024 * 1024;

289 i‡((
c⁄f
 & 
OFPPF_100GB_FD
) != 0)  100 * 1024 * 1024;

290 i‡((
c⁄f
 & 
OFPPF_40GB_FD
) != 0)  40 * 1024 * 1024;

291 i‡((
c⁄f
 & 
OFPPF_10GB_FD
) != 0)  10 * 1024 * 1024;

292 i‡((
c⁄f
 & 
OFPPF_1GB_FD
) != 0)  1024 * 1024;

293 i‡((
c⁄f
 & 
OFPPF_1GB_HD
) != 0)  1024 * 1024;

294 i‡((
c⁄f
 & 
OFPPF_100MB_FD
) != 0)  100 * 1024;

295 i‡((
c⁄f
 & 
OFPPF_100MB_HD
) != 0)  100 * 1024;

296 i‡((
c⁄f
 & 
OFPPF_10MB_FD
) != 0)  10 * 1024;

297 i‡((
c⁄f
 & 
OFPPF_10MB_HD
) != 0)  10 * 1024;

300 
	}
}

304 
	$√w_p‹t
(
d©≠©h
 *
dp
, 
sw_p‹t
 *
p‹t
, 
uöt32_t
 
p‹t_no
,

305 c⁄° *
√tdev_«me
, c⁄° 
uöt8_t
 *
√w_mac
, 
uöt32_t
 
max_queues
)

307 
√tdev
 *netdev;

308 
ö6_addr
 
ö6
;

309 
ö_addr
 
ö4
;

310 
îr‹
;

311 
uöt64_t
 
now
;

313 
now
 = 
	`time_m£c
();

315 
max_queues
 = 
	`MIN
(max_queues, 
NETDEV_MAX_QUEUES
);

317 
îr‹
 = 
	`√tdev_›í
(
√tdev_«me
, 
NETDEV_ETH_TYPE_ANY
, &
√tdev
);

318 i‡(
îr‹
) {

319  
îr‹
;

321 i‡(
√w_mac
 && !
	`ëh_addr_equÆs
(
	`√tdev_gë_ëhîaddr
(
√tdev
),Çew_mac)) {

325 
	`√tdev_£t_Êags
(
√tdev
, 0, 
Ál£
);

326 
îr‹
 = 
	`√tdev_£t_ëhîaddr
(
√tdev
, 
√w_mac
);

327 i‡(
îr‹
) {

328 
	`VLOG_WARN
(
LOG_MODULE
, "failedÅo change %s Ethernetáddress "

329 "tÿ"
ETH_ADDR_FMT
": %s",

330 
√tdev_«me
, 
	`ETH_ADDR_ARGS
(
√w_mac
), 
	`°ªº‹
(
îr‹
));

333 
îr‹
 = 
	`√tdev_£t_Êags
(
√tdev
, 
NETDEV_UP
 | 
NETDEV_PROMISC
, 
Ál£
);

334 i‡(
îr‹
) {

335 
	`VLOG_ERR
(
LOG_MODULE
, "ÁûedÅÿ£à¥omiscuou†modê⁄ %†devi˚", 
√tdev_«me
);

336 
	`√tdev_˛o£
(
√tdev
);

337  
îr‹
;

339 i‡(
	`√tdev_gë_ö4
(
√tdev
, &
ö4
)) {

340 
	`VLOG_ERR
(
LOG_MODULE
, "%s device hasássigned IPáddress %s",

341 
√tdev_«me
, 
	`öë_¡ﬂ
(
ö4
));

343 i‡(
	`√tdev_gë_ö6
(
√tdev
, &
ö6
)) {

344 
ö6_«me
[
INET6_ADDRSTRLEN
 + 1];

345 
	`öë_¡›
(
AF_INET6
, &
ö6
, 
ö6_«me
,  in6_name);

346 
	`VLOG_ERR
(
LOG_MODULE
, "%s device hasássigned IPv6áddress %s",

347 
√tdev_«me
, 
ö6_«me
);

350 i‡(
max_queues
 > 0) {

351 
îr‹
 = 
	`√tdev_£tup_¶icög
(
√tdev
, 
max_queues
);

352 i‡(
îr‹
) {

353 
	`VLOG_ERR
(
LOG_MODULE
, "failedÅo configure slicing on %s device: "\

356 
√tdev_«me
);

357 
	`√tdev_˛o£
(
√tdev
);

358  
îr‹
;

363 
	`mem£t
(
p‹t
, '\0',  *port);

365 
p‹t
->
dp
 = dp;

367 
p‹t
->
c⁄f
 = 
	`xmÆloc
((
oÊ_p‹t
));

368 
p‹t
->
c⁄f
->
p‹t_no
 =Öort_no;

369 
	`mem˝y
(
p‹t
->
c⁄f
->
hw_addr
, 
	`√tdev_gë_ëhîaddr
(
√tdev
), 
ETH_ADDR_LEN
);

370 
p‹t
->
c⁄f
->
«me
 = 
	`°r˝y
(
	`xmÆloc
(
	`°æí
(
√tdev_«me
) + 1),Çetdev_name);

371 
p‹t
->
c⁄f
->
c⁄fig
 = 0x00000000;

372 
p‹t
->
c⁄f
->
°©e
 = 0x00000000 | 
OFPPS_LIVE
;

373 
p‹t
->
c⁄f
->
cuº
 = 
	`√tdev_gë_„©uªs
(
√tdev
, 
NETDEV_FEAT_CURRENT
);

374 
p‹t
->
c⁄f
->
advîti£d
 = 
	`√tdev_gë_„©uªs
(
√tdev
, 
NETDEV_FEAT_ADVERTISED
);

375 
p‹t
->
c⁄f
->
suµ‹ãd
 = 
	`√tdev_gë_„©uªs
(
√tdev
, 
NETDEV_FEAT_SUPPORTED
);

376 
p‹t
->
c⁄f
->
≥î
 = 
	`√tdev_gë_„©uªs
(
√tdev
, 
NETDEV_FEAT_PEER
);

377 
p‹t
->
c⁄f
->
cuº_•ìd
 = 
	`p‹t_•ìd
’‹t->c⁄f->
cuº
);

378 
p‹t
->
c⁄f
->
max_•ìd
 = 
	`p‹t_•ìd
’‹t->c⁄f->
suµ‹ãd
);

380 i‡(
	`IS_HW_PORT
(
p
)) {

381 #i‡
	`deföed
(
OF_HW_PLAT
Ë&& !deföed(
USE_NETDEV
)

382 
of_hw_drivî_t
 *
hw_drv
;

384 
hw_drv
 = 
p
->
dp
->hw_drv;

385 
	`‰ì
(
p‹t
->
c⁄f
->
«me
);

386 
p‹t
->
c⁄f
->
«me
 = 
	`°r˝y
(
	`xmÆloc
(
	`°æí
(
p
->
hw_«me
) + 1),Ö->hw_name);

387 / * 
Upd©e
 
loˇl
 
p‹t
 
°©e
 * /

388 i‡(
hw_drv
->
	`p‹t_lök_gë
(hw_drv, 
p‹t_no
)) {

389 
p
->
°©e
 &~
OFPPS_LINK_DOWN
;

391 
p
->
°©e
 |
OFPPS_LINK_DOWN
;

393 i‡(
hw_drv
->
	`p‹t_íabÀ_gë
(hw_drv, 
p‹t_no
)) {

394 
p
->
c⁄fig
 &~
OFPPC_PORT_DOWN
;

396 
p
->
c⁄fig
 |
OFPPC_PORT_DOWN
;

398 / * 
FIXME
: 
Add
 
cuºít
, 
suµ‹ãd
 
™d
 
advîti£d
 
„©uªs
 * /

402 
p‹t
->
°©s
 = 
	`xmÆloc
((
oÊ_p‹t_°©s
));

403 
p‹t
->
°©s
->
p‹t_no
 =Öort_no;

404 
p‹t
->
°©s
->
rx_∑ckës
 = 0;

405 
p‹t
->
°©s
->
tx_∑ckës
 = 0;

406 
p‹t
->
°©s
->
rx_byãs
 = 0;

407 
p‹t
->
°©s
->
tx_byãs
 = 0;

408 
p‹t
->
°©s
->
rx_dr›≥d
 = 0;

409 
p‹t
->
°©s
->
tx_dr›≥d
 = 0;

410 
p‹t
->
°©s
->
rx_îr‹s
 = 0;

411 
p‹t
->
°©s
->
tx_îr‹s
 = 0;

412 
p‹t
->
°©s
->
rx_‰ame_îr
 = 0;

413 
p‹t
->
°©s
->
rx_ovî_îr
 = 0;

414 
p‹t
->
°©s
->
rx_¸c_îr
 = 0;

415 
p‹t
->
°©s
->
cﬁlisi⁄s
 = 0;

416 
p‹t
->
°©s
->
duøti⁄_£c
 = 0;

417 
p‹t
->
°©s
->
duøti⁄_n£c
 = 0;

418 
p‹t
->
Êags
 |
SWP_USED
;

419 
p‹t
->
√tdev
 =Çetdev;

420 
p‹t
->
max_queues
 = max_queues;

421 
p‹t
->
num_queues
 = 0;

422 
p‹t
->
¸óãd
 = 
now
;

424 
	`mem£t
(
p‹t
->
queues
, 0x00, (port->queues));

426 
	`li°_push_back
(&
dp
->
p‹t_li°
, &
p‹t
->
node
);

427 
dp
->
p‹ts_num
++;

431 
oÊ_msg_p‹t_°©us
 
msg
 =

432 {{.
ty≥
 = 
OFPT_PORT_STATUS
},

433 .
ªas⁄
 = 
OFPPR_ADD
, .
desc
 = 
p‹t
->
c⁄f
};

435 
	`dp_£nd_mesßge
(
dp
, (
oÊ_msg_hódî
 *)&
msg
, 
NULL
 );

439 
	}
}

442 #i‡
deföed
(
OF_HW_PLAT
Ë&& !deföed(
USE_NETDEV
)

444 
	$dp_p‹ts_add
(
d©≠©h
 *
dp
, c⁄° *
p‹t_«me
)

446 
p‹t_no
;

447 
rc
 = 0;

448 
sw_p‹t
 *
p‹t
;

450 
	`Ârötf
(
°dîr
, "AddögÖ‹à%s. hw_drv i†%p\n", 
p‹t_«me
, 
dp
->
hw_drv
);

451 i‡(
dp
->
hw_drv
 && dp->hw_drv->
p‹t_add
) {

452 
p‹t_no
 = 
dp
->
hw_drv
->
	`p‹t_add
(dp->hw_drv, -1, 
p‹t_«me
);

453 i‡(
p‹t_no
 >= 0) {

454 
p‹t
 = &
dp
->
p‹ts
[
p‹t_no
];

455 i‡(
p‹t
->
Êags
 & 
SWP_USED
) {

456 
	`VLOG_ERR
(
LOG_MODULE
, "HWÖort %s (%d)álready created\n",

457 
p‹t_«me
, 
p‹t_no
);

458 
rc
 = -1;

460 
	`Ârötf
(
°dîr
, "Adding HWÖort %sás OFÖortÇumber %d\n",

461 
p‹t_«me
, 
p‹t_no
);

463 
p‹t
->
Êags
 |
SWP_USED
 | 
SWP_HW_DRV_PORT
;

464 
p‹t
->
dp
 = dp;

465 
p‹t
->
p‹t_no
 =Öort_no;

466 
	`li°_öô
(&
p‹t
->
queue_li°
);

467 
p‹t
->
max_queues
 = max_queues;

468 
p‹t
->
num_queues
 = 0;

469 
	`°∫˝y
(
p‹t
->
hw_«me
, 
p‹t_«me
, (port->hw_name));

470 
	`li°_push_back
(&
dp
->
p‹t_li°
, &
p‹t
->
node
);

472 
oÊ_msg_p‹t_°©us
 
msg
 =

473 {{.
ty≥
 = 
OFPT_PORT_STATUS
},

474 .
ªas⁄
 = 
OFPPR_ADD
, .
desc
 = 
p
->
c⁄f
};

476 
	`dp_£nd_mesßge
(
dp
, (
oÊ_msg_hódî
 *)&
msg
, 
NULL
);

480 
	`VLOG_ERR
(
LOG_MODULE
, "P‹à%†nŸÑecognized by h¨dw¨êdrivî", 
p‹t_«me
);

481 
rc
 = -1;

484 
	`VLOG_ERR
(
LOG_MODULE
, "No hardware driver support; can'táddÖorts");

485 
rc
 = -1;

488  
rc
;

489 
	}
}

493 
	$dp_p‹ts_add
(
d©≠©h
 *
dp
, c⁄° *
√tdev
)

495 
uöt32_t
 
p‹t_no
;

496 
p‹t_no
 = 1;Ö‹t_nÿ< 
DP_MAX_PORTS
;Öort_no++) {

497 
sw_p‹t
 *
p‹t
 = &
dp
->
p‹ts
[
p‹t_no
];

498 i‡(
p‹t
->
√tdev
 =
NULL
) {

499  
	`√w_p‹t
(
dp
, 
p‹t
, 
p‹t_no
, 
√tdev
, 
NULL
, dp->
max_queues
);

502  
EXFULL
;

503 
	}
}

507 
	$dp_p‹ts_add_loˇl
(
d©≠©h
 *
dp
, c⁄° *
√tdev
)

509 i‡(!
dp
->
loˇl_p‹t
) {

510 
uöt8_t
 
ó
[
ETH_ADDR_LEN
];

511 
sw_p‹t
 *
p‹t
;

512 
îr‹
;

514 
p‹t
 = 
	`xˇŒoc
(1,  *port);

515 
	`ëh_addr_‰om_uöt64
(
dp
->
id
, 
ó
);

516 
îr‹
 = 
	`√w_p‹t
(
dp
, 
p‹t
, 
OFPP_LOCAL
, 
√tdev
, 
ó
, 0);

517 i‡(!
îr‹
) {

518 
dp
->
loˇl_p‹t
 = 
p‹t
;

520 
	`‰ì
(
p‹t
);

522  
îr‹
;

524  
EXFULL
;

526 
	}
}

529 
sw_p‹t
 *

530 
	$dp_p‹ts_lookup
(
d©≠©h
 *
dp
, 
uöt32_t
 
p‹t_no
) {

533 
uöt32_t
 
p‹ts_num
 = 
dp
->
loˇl_p‹t
 ? dp->ports_num -1 : dp->ports_num;

535 i‡(
p‹t_no
 =
OFPP_LOCAL
) {

536  
dp
->
loˇl_p‹t
;

539 i‡(
p‹t_no
 < 1 ||Ö‹t_nÿ> 
p‹ts_num
) {

540  
NULL
;

543  &
dp
->
p‹ts
[
p‹t_no
];

544 
	}
}

546 
sw_queue
 *

547 
	$dp_p‹ts_lookup_queue
(
sw_p‹t
 *
p
, 
uöt32_t
 
queue_id
)

549 
sw_queue
 *
q
;

551 i‡(
queue_id
 <
p
->
max_queues
) {

552 
q
 = &(
p
->
queues
[
queue_id
]);

554 i‡(
q
->
p‹t
 !
NULL
) {

555  
q
;

559  
NULL
;

560 
	}
}

563 
	$dp_p‹ts_ouçut
(
d©≠©h
 *
dp
, 
oÂbuf
 *
buf„r
, 
uöt32_t
 
out_p‹t
,

564 
uöt32_t
 
queue_id
)

566 
uöt16_t
 
˛ass_id
;

567 
sw_queue
 * 
q
;

568 
sw_p‹t
 *
p
;

570 
p
 = 
	`dp_p‹ts_lookup
(
dp
, 
out_p‹t
);

573 #i‡
	`deföed
(
OF_HW_PLAT
Ë&& !deföed(
USE_NETDEV
)

574 i‡((
p
 !
NULL
Ë&& 
	`IS_HW_PORT
(p)) {

575 i‡(
dp
 && dp->
hw_drv
) {

576 i‡(
dp
->
hw_drv
->
	`p‹t_lök_gë
(dp->hw_drv, 
p
->
p‹t_no
)) {

577 
of_∑ckë_t
 *
pkt
;

578 
rv
;

580 
pkt
 = 
	`ˇŒoc
(1, (*pkt));

581 
	`OF_PKT_INIT
(
pkt
, 
buf„r
);

582 
rv
 = 
dp
->
hw_drv
->
	`∑ckë_£nd
(dp->hw_drv, 
out_p‹t
, 
pkt
, 0);

583 i‡((
rv
 < 0Ë&& (rv !
OF_HW_PORT_DOWN
)) {

584 
	`VLOG_ERR
(
LOG_MODULE
, "Error %d sendingÖkt on HWÖort %d\n",

585 
rv
, 
out_p‹t
);

586 
	`oÂbuf_dñëe
(
buf„r
);

587 
	`‰ì
(
pkt
);

596 i‡(
p
 !
NULL
 &&Ö->
√tdev
 != NULL) {

597 i‡(!(
p
->
c⁄f
->
c⁄fig
 & 
OFPPC_PORT_DOWN
)) {

599 i‡(
queue_id
 == 0) {

600 
q
 = 
NULL
;

601 
˛ass_id
 = 0;

605 
q
 = 
	`dp_p‹ts_lookup_queue
(
p
, 
queue_id
);

606 i‡(
q
 !
NULL
) {

607 
˛ass_id
 = 
q
->class_id;

610 
îr‹
;

614 i‡(!
	`√tdev_£nd
(
p
->
√tdev
, 
buf„r
, 
˛ass_id
)) {

615 
p
->
°©s
->
tx_∑ckës
++;

616 
p
->
°©s
->
tx_byãs
 +
buf„r
->
size
;

617 i‡(
q
 !
NULL
) {

618 
q
->
°©s
->
tx_∑ckës
++;

619 
q
->
°©s
->
tx_byãs
 +
buf„r
->
size
;

622 
p
->
°©s
->
tx_dr›≥d
++;

629 
îr‹
:

631 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "ˇn'àf‹w¨dÅÿbadÖ‹t:queue(%d:%d)\n", 
out_p‹t
,

632 
queue_id
);

633 
	}
}

636 
	$dp_p‹ts_ouçut_Æl
(
d©≠©h
 *
dp
, 
oÂbuf
 *
buf„r
, 
ö_p‹t
, 
boﬁ
 
Êood
)

638 
sw_p‹t
 *
p
;

640 
	`LIST_FOR_EACH
 (
p
, 
sw_p‹t
, 
node
, &
dp
->
p‹t_li°
) {

641 i‡(
p
->
°©s
->
p‹t_no
 =
ö_p‹t
) {

644 i‡(
Êood
 && 
p
->
c⁄f
->
c⁄fig
 & 
OFPPC_NO_FWD
) {

648 
	`dp_p‹ts_ouçut
(
dp
, 
buf„r
, 
p
->
°©s
->
p‹t_no
, 0);

652 
	}
}

654 
oÊ_îr


655 
	$dp_p‹ts_h™dÀ_p‹t_mod
(
d©≠©h
 *
dp
, 
oÊ_msg_p‹t_mod
 *
msg
,

656 c⁄° 
£ndî
 *sender) {

658 
sw_p‹t
 *
p
;

660 if(
£ndî
->
ªmŸe
->
rﬁe
 =
OFPCR_ROLE_SLAVE
)

661  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_IS_SLAVE
);

663 
p
 = 
	`dp_p‹ts_lookup
(
dp
, 
msg
->
p‹t_no
);

665 i‡(
p
 =
NULL
) {

666  
	`oÊ_îr‹
(
OFPET_PORT_MOD_FAILED
,
OFPPMFC_BAD_PORT
);

670 i‡(
	`memcmp
(
msg
->
hw_addr
, 
	`√tdev_gë_ëhîaddr
(
p
->
√tdev
),

671 
ETH_ADDR_LEN
) != 0) {

672  
	`oÊ_îr‹
(
OFPET_PORT_MOD_FAILED
, 
OFPPMFC_BAD_HW_ADDR
);

676 i‡(
msg
->
mask
) {

677 
p
->
c⁄f
->
c⁄fig
 &~
msg
->
mask
;

678 
p
->
c⁄f
->
c⁄fig
 |
msg
->c⁄fig & msg->
mask
;

682 
oÊ_msg_p‹t_°©us
 
ªp_msg
 =

683 {{.
ty≥
 = 
OFPT_PORT_STATUS
},

684 .
ªas⁄
 = 
OFPPR_MODIFY
, .
desc
 = 
p
->
c⁄f
};

686 
	`dp_£nd_mesßge
(
dp
, (
oÊ_msg_hódî
 *)&
ªp_msg
, 
NULL
 );

688 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
dp
->
exp
);

690 
	}
}

693 
	$dp_p‹t_°©s_upd©e
(
sw_p‹t
 *
p‹t
) {

694 
p‹t
->
°©s
->
duøti⁄_£c
 = (
	`time_m£c
(Ë-Ö‹t->
¸óãd
) / 1000;

695 
p‹t
->
°©s
->
duøti⁄_n£c
 = ((
	`time_m£c
(Ë-Ö‹t->
¸óãd
) % 1000) * 1000;

696 
	}
}

698 
oÊ_îr


699 
	$dp_p‹ts_h™dÀ_°©s_ªque°_p‹t
(
d©≠©h
 *
dp
,

700 
oÊ_msg_mu…ù¨t_ªque°_p‹t
 *
msg
,

701 c⁄° 
£ndî
 *£ndî 
UNUSED
) {

702 
sw_p‹t
 *
p‹t
;

704 
oÊ_msg_mu…ù¨t_ª∂y_p‹t
 
ª∂y
 =

705 {{{.
ty≥
 = 
OFPT_MULTIPART_REPLY
},

706 .
ty≥
 = 
OFPMP_PORT_STATS
, .
Êags
 = 0x0000},

707 .
°©s_num
 = 0,

708 .
°©s
 = 
NULL
};

710 i‡(
msg
->
p‹t_no
 =
OFPP_ANY
) {

711 
size_t
 
i
 = 0;

713 
ª∂y
.
°©s_num
 = 
dp
->
p‹ts_num
;

714 
ª∂y
.
°©s
 = 
	`xmÆloc
((
oÊ_p‹t_°©s
 *Ë* 
dp
->
p‹ts_num
);

716 
	`LIST_FOR_EACH
(
p‹t
, 
sw_p‹t
, 
node
, &
dp
->
p‹t_li°
) {

717 
	`dp_p‹t_°©s_upd©e
(
p‹t
);

718 
ª∂y
.
°©s
[
i
] = 
p‹t
->stats;

719 
i
++;

723 
p‹t
 = 
	`dp_p‹ts_lookup
(
dp
, 
msg
->
p‹t_no
);

725 i‡(
p‹t
 !
NULL
 &&Ö‹t->
√tdev
 != NULL) {

726 
ª∂y
.
°©s_num
 = 1;

727 
ª∂y
.
°©s
 = 
	`xmÆloc
((
oÊ_p‹t_°©s
 *));

728 
	`dp_p‹t_°©s_upd©e
(
p‹t
);

729 
ª∂y
.
°©s
[0] = 
p‹t
->stats;

733 
	`dp_£nd_mesßge
(
dp
, (
oÊ_msg_hódî
 *)&
ª∂y
, 
£ndî
);

735 
	`‰ì
(
ª∂y
.
°©s
);

736 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
dp
->
exp
);

739 
	}
}

741 
oÊ_îr


742 
	$dp_p‹ts_h™dÀ_p‹t_desc_ªque°
(
d©≠©h
 *
dp
,

743 
oÊ_msg_mu…ù¨t_ªque°_hódî
 *
msg
 
UNUSED
,

744 c⁄° 
£ndî
 *£ndî 
UNUSED
){

745 
sw_p‹t
 *
p‹t
;

746 
size_t
 
i
 = 0;

749 
oÊ_msg_mu…ù¨t_ª∂y_p‹t_desc
 
ª∂y
 =

750 {{{.
ty≥
 = 
OFPT_MULTIPART_REPLY
},

751 .
ty≥
 = 
OFPMP_PORT_DESC
, .
Êags
 = 0x0000},

752 .
°©s_num
 = 0,

753 .
°©s
 = 
NULL
};

755 
ª∂y
.
°©s_num
 = 
dp
->
p‹ts_num
;

756 
ª∂y
.
°©s
 = 
	`xmÆloc
((
oÊ_p‹t
 *Ë* 
dp
->
p‹ts_num
);

758 
	`LIST_FOR_EACH
(
p‹t
, 
sw_p‹t
, 
node
, &
dp
->
p‹t_li°
) {

759 
ª∂y
.
°©s
[
i
] = 
p‹t
->
c⁄f
;

760 
i
++;

763 
	`dp_£nd_mesßge
(
dp
, (
oÊ_msg_hódî
 *)&
ª∂y
, 
£ndî
);

765 
	`‰ì
(
ª∂y
.
°©s
);

766 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
dp
->
exp
);

769 
	}
}

772 
	$dp_p‹ts_queue_upd©e
(
sw_queue
 *
queue
) {

773 
queue
->
°©s
->
duøti⁄_£c
 = (
	`time_m£c
(Ë- queue->
¸óãd
) / 1000;

774 
queue
->
°©s
->
duøti⁄_n£c
 = ((
	`time_m£c
(Ë- queue->
¸óãd
) % 1000) * 1000;

775 
	}
}

777 
oÊ_îr


778 
	$dp_p‹ts_h™dÀ_°©s_ªque°_queue
(
d©≠©h
 *
dp
,

779 
oÊ_msg_mu…ù¨t_ªque°_queue
 *
msg
,

780 c⁄° 
£ndî
 *sender) {

781 
sw_p‹t
 *
p‹t
;

783 
oÊ_msg_mu…ù¨t_ª∂y_queue
 
ª∂y
 =

784 {{{.
ty≥
 = 
OFPT_MULTIPART_REPLY
},

785 .
ty≥
 = 
OFPMP_QUEUE
, .
Êags
 = 0x0000},

786 .
°©s_num
 = 0,

787 .
°©s
 = 
NULL
};

789 i‡(
msg
->
p‹t_no
 =
OFPP_ANY
) {

790 
size_t
 
i
,
idx
 = 0, 
num
 = 0;

792 
	`LIST_FOR_EACH
(
p‹t
, 
sw_p‹t
, 
node
, &
dp
->
p‹t_li°
) {

793 i‡(
msg
->
queue_id
 =
OFPQ_ALL
) {

794 
num
 +
p‹t
->
num_queues
;

796 i‡(
msg
->
queue_id
 < 
p‹t
->
max_queues
) {

797 i‡(
p‹t
->
queues
[
msg
->
queue_id
].p‹à!
NULL
) {

798 
num
++;

804 
ª∂y
.
°©s_num
 = 
num
;

805 
ª∂y
.
°©s
 = 
	`xmÆloc
((
oÊ_p‹t_°©s
 *Ë* 
num
);

807 
	`LIST_FOR_EACH
(
p‹t
, 
sw_p‹t
, 
node
, &
dp
->
p‹t_li°
) {

808 i‡(
msg
->
queue_id
 =
OFPQ_ALL
) {

809 
i
=0; i<
p‹t
->
max_queues
; i++) {

810 i‡(
p‹t
->
queues
[
i
].p‹à!
NULL
) {

811 
	`dp_p‹ts_queue_upd©e
(&
p‹t
->
queues
[
i
]);

812 
ª∂y
.
°©s
[
idx
] = 
p‹t
->
queues
[
i
].stats;

813 
idx
++;

817 i‡(
msg
->
queue_id
 < 
p‹t
->
max_queues
) {

818 i‡(
p‹t
->
queues
[
msg
->
queue_id
].p‹à!
NULL
) {

819 
	`dp_p‹ts_queue_upd©e
(&
p‹t
->
queues
[
msg
->
queue_id
]);

820 
ª∂y
.
°©s
[
idx
] = 
p‹t
->
queues
[
msg
->
queue_id
].stats;

821 
idx
++;

828 
p‹t
 = 
	`dp_p‹ts_lookup
(
dp
, 
msg
->
p‹t_no
);

830 i‡(
p‹t
 !
NULL
 &&Ö‹t->
√tdev
 != NULL) {

831 
size_t
 
i
, 
idx
 = 0;

833 i‡(
msg
->
queue_id
 =
OFPQ_ALL
) {

834 
ª∂y
.
°©s_num
 = 
p‹t
->
num_queues
;

835 
ª∂y
.
°©s
 = 
	`xmÆloc
((
oÊ_p‹t_°©s
 *Ë* 
p‹t
->
num_queues
);

837 
i
=0; i<
p‹t
->
max_queues
; i++) {

838 i‡(
p‹t
->
queues
[
i
].p‹à!
NULL
) {

839 
	`dp_p‹ts_queue_upd©e
(&
p‹t
->
queues
[
i
]);

840 
ª∂y
.
°©s
[
idx
] = 
p‹t
->
queues
[
i
].stats;

841 
idx
++;

845 i‡(
msg
->
queue_id
 < 
p‹t
->
max_queues
) {

846 i‡(
p‹t
->
queues
[
msg
->
queue_id
].p‹à!
NULL
) {

847 
ª∂y
.
°©s_num
 = 1;

848 
ª∂y
.
°©s
 = 
	`xmÆloc
((
oÊ_p‹t_°©s
 *));

849 
	`dp_p‹ts_queue_upd©e
(&
p‹t
->
queues
[
msg
->
queue_id
]);

850 
ª∂y
.
°©s
[0] = 
p‹t
->
queues
[
msg
->
queue_id
].stats;

857 
	`dp_£nd_mesßge
(
dp
, (
oÊ_msg_hódî
 *)&
ª∂y
, 
£ndî
);

859 
	`‰ì
(
ª∂y
.
°©s
);

860 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
dp
->
exp
);

863 
	}
}

865 
oÊ_îr


866 
	$dp_p‹ts_h™dÀ_queue_gë_c⁄fig_ªque°
(
d©≠©h
 *
dp
,

867 
oÊ_msg_queue_gë_c⁄fig_ªque°
 *
msg
,

868 c⁄° 
£ndî
 *sender) {

869 
sw_p‹t
 *
p
;

871 
oÊ_msg_queue_gë_c⁄fig_ª∂y
 
ª∂y
 =

872 {{.
ty≥
 = 
OFPT_QUEUE_GET_CONFIG_REPLY
},

873 .
queues
 = 
NULL
};

875 i‡(
msg
->
p‹t
 =
OFPP_ANY
) {

876 
size_t
 
i
, 
idx
 = 0, 
num
 = 0;

878 
	`LIST_FOR_EACH
(
p
, 
sw_p‹t
, 
node
, &
dp
->
p‹t_li°
) {

879 
num
 +
p
->
num_queues
;

882 
ª∂y
.
p‹t
 = 
OFPP_ANY
;

883 
ª∂y
.
queues_num
 = 
num
;

884 
ª∂y
.
queues
 = 
	`xmÆloc
((
oÊ_∑ckë_queue
 *Ë* 
num
);

886 
	`LIST_FOR_EACH
(
p
, 
sw_p‹t
, 
node
, &
dp
->
p‹t_li°
) {

887 
i
=0; i<
p
->
max_queues
; i++) {

888 i‡(
p
->
queues
[
i
].
p‹t
 !
NULL
) {

889 
ª∂y
.
queues
[
idx
] = 
p
->queues[
i
].
¥›s
;

890 
idx
++;

895 
p
 = 
	`dp_p‹ts_lookup
(
dp
, 
msg
->
p‹t
);

897 i‡(
p
 =
NULL
 || (p->
°©s
->
p‹t_no
 !
msg
->
p‹t
)) {

898 
	`‰ì
(
ª∂y
.
queues
);

899 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
dp
->
exp
);

900  
	`oÊ_îr‹
(
OFPET_QUEUE_OP_FAILED
, 
OFPQOFC_BAD_PORT
);

902 
size_t
 
i
, 
idx
 = 0;

904 
ª∂y
.
p‹t
 = 
msg
->port;

905 
ª∂y
.
queues_num
 = 
p
->
num_queues
;

906 
ª∂y
.
queues
 = 
	`xmÆloc
((
oÊ_∑ckë_queue
 *Ë* 
p
->
num_queues
);

908 
i
=0; i<
p
->
max_queues
; i++) {

909 i‡(
p
->
queues
[
i
].
p‹t
 !
NULL
) {

910 
ª∂y
.
queues
[
idx
] = 
p
->queues[
i
].
¥›s
;

911 
idx
++;

917 
	`dp_£nd_mesßge
(
dp
, (
oÊ_msg_hódî
 *)&
ª∂y
, 
£ndî
);

919 
	`‰ì
(
ª∂y
.
queues
);

920 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
dp
->
exp
);

922 
	}
}

929 
	$√w_queue
(
sw_p‹t
 * 
p‹t
, 
sw_queue
 * 
queue
,

930 
uöt32_t
 
queue_id
, 
uöt16_t
 
˛ass_id
,

931 
oÊ_queue_¥›_mö_øã
 * 
mr
)

933 
uöt64_t
 
now
 = 
	`time_m£c
();

935 
	`mem£t
(
queue
, '\0',  *queue);

936 
queue
->
p‹t
 =Öort;

937 
queue
->
¸óãd
 = 
now
;

938 
queue
->
°©s
 = 
	`xmÆloc
((
oÊ_queue_°©s
));

940 
queue
->
°©s
->
p‹t_no
 = 
p‹t
->stats->port_no;

941 
queue
->
°©s
->
queue_id
 = queue_id;

942 
queue
->
°©s
->
tx_byãs
 = 0;

943 
queue
->
°©s
->
tx_∑ckës
 = 0;

944 
queue
->
°©s
->
tx_îr‹s
 = 0;

945 
queue
->
°©s
->
duøti⁄_£c
 = 0;

946 
queue
->
°©s
->
duøti⁄_n£c
 = 0;

953 
queue
->
˛ass_id
 = class_id;

955 
queue
->
¥›s
 = 
	`xmÆloc
((
oÊ_∑ckë_queue
));

956 
queue
->
¥›s
->
queue_id
 = queue_id;

957 
queue
->
¥›s
->
¥›îtõs
 = 
	`xmÆloc
((
oÊ_queue_¥›_hódî
 *));

958 
queue
->
¥›s
->
¥›îtõs_num
 = 1;

959 
queue
->
¥›s
->
¥›îtõs
[0] = 
	`xmÆloc
((
oÊ_queue_¥›_mö_øã
));

960 ((
oÊ_queue_¥›_mö_øã
 *)(
queue
->
¥›s
->
¥›îtõs
[0]))->
hódî
.
ty≥
 = 
OFPQT_MIN_RATE
;

961 ((
oÊ_queue_¥›_mö_øã
 *)(
queue
->
¥›s
->
¥›îtõs
[0]))->
øã
 = 
mr
->rate;

963 
p‹t
->
num_queues
++;

965 
	}
}

968 
	$p‹t_add_queue
(
sw_p‹t
 *
p
, 
uöt32_t
 
queue_id
,

969 
oÊ_queue_¥›_mö_øã
 * 
mr
)

971 i‡(
queue_id
 > 
p
->
max_queues
) {

972  
EXFULL
;

975 i‡(
p
->
queues
[
queue_id
].
p‹t
 !
NULL
) {

976  
EXFULL
;

979  
	`√w_queue
(
p
, &’->
queues
[
queue_id
]), queue_id, queue_id, 
mr
);

980 
	}
}

983 
	$p‹t_dñëe_queue
(
sw_p‹t
 *
p
, 
sw_queue
 *
q
)

985 
	`mem£t
(
q
,'\0',  *q);

986 
p
->
num_queues
--;

988 
	}
}

990 
oÊ_îr


991 
	$dp_p‹ts_h™dÀ_queue_modify
(
d©≠©h
 *
dp
, 
oÊ_exp_›íÊow_msg_queue
 *
msg
,

992 c⁄° 
£ndî
 *£ndî 
UNUSED
) {

994 
sw_p‹t
 *
p
;

995 
sw_queue
 *
q
;

997 
îr‹
 = 0;

999 
p
 = 
	`dp_p‹ts_lookup
(
dp
, 
msg
->
p‹t_id
);

1000 i‡(
	`PORT_IN_USE
(
p
)) {

1001 
q
 = 
	`dp_p‹ts_lookup_queue
(
p
, 
msg
->
queue
->
queue_id
);

1002 i‡(
q
 !
NULL
) {

1004 
îr‹
 = 
	`√tdev_ch™ge_˛ass
(
p
->
√tdev
,
q
->
˛ass_id
,

1005 ((
oÊ_queue_¥›_mö_øã
 *)
msg
->
queue
->
¥›îtõs
[0])->
øã
);

1006 i‡(
îr‹
) {

1007 
	`VLOG_ERR
(
LOG_MODULE
, "FaûedÅÿupd©êqueuê%d", 
msg
->
queue
->
queue_id
);

1008  
	`oÊ_îr‹
(
OFPET_QUEUE_OP_FAILED
, 
OFPQOFC_EPERM
);

1011 ((
oÊ_queue_¥›_mö_øã
 *)
q
->
¥›s
->
¥›îtõs
[0])->
øã
 =

1012 ((
oÊ_queue_¥›_mö_øã
 *)
msg
->
queue
->
¥›îtõs
[0])->
øã
;

1017 
îr‹
 = 
	`p‹t_add_queue
(
p
, 
msg
->
queue
->
queue_id
,

1018 (
oÊ_queue_¥›_mö_øã
 *)
msg
->
queue
->
¥›îtõs
[0]);

1019 i‡(
îr‹
 =
EXFULL
) {

1020  
	`oÊ_îr‹
(
OFPET_QUEUE_OP_FAILED
, 
OFPQOFC_EPERM
);

1023 
q
 = 
	`dp_p‹ts_lookup_queue
(
p
, 
msg
->
queue
->
queue_id
);

1024 
îr‹
 = 
	`√tdev_£tup_˛ass
(
p
->
√tdev
,
q
->
˛ass_id
,

1025 ((
oÊ_queue_¥›_mö_øã
 *)
msg
->
queue
->
¥›îtõs
[0])->
øã
);

1026 i‡(
îr‹
) {

1027 
	`VLOG_ERR
(
LOG_MODULE
, "FaûedÅÿc⁄figuª queuê%d", 
msg
->
queue
->
queue_id
);

1028  
	`oÊ_îr‹
(
OFPET_QUEUE_OP_FAILED
, 
OFPQOFC_BAD_QUEUE
);

1033 
	`VLOG_ERR
(
LOG_MODULE
, "FaûedÅÿ¸óã/modify queuê-Ö‹à%d d€¢'àexi°", 
msg
->
p‹t_id
);

1034  
	`oÊ_îr‹
(
OFPET_QUEUE_OP_FAILED
, 
OFPQOFC_BAD_PORT
);

1037 i‡(
	`IS_HW_PORT
(
p
)) {

1038 #i‡
	`deföed
(
OF_HW_PLAT
Ë&& !deföed(
USE_NETDEV
)

1039 
îr‹
 = 
dp
->
hw_drv
->
	`p‹t_queue_c⁄fig
(dp->hw_drv, 
p‹t_no
,

1040 
queue_id
, 
	`¡ohs
(
mr
->
øã
));

1041 i‡(
îr‹
 < 0) {

1042 
	`VLOG_ERR
(
LOG_MODULE
, "FailedÅo update HWÖort %d queue %d",

1043 
p‹t_no
, 
queue_id
);

1048 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
dp
->
exp
);

1050 
	}
}

1053 
oÊ_îr


1054 
	$dp_p‹ts_h™dÀ_queue_dñëe
(
d©≠©h
 *
dp
, 
oÊ_exp_›íÊow_msg_queue
 *
msg
,

1055 c⁄° 
£ndî
 *£ndî 
UNUSED
) {

1056 
sw_p‹t
 *
p
;

1057 
sw_queue
 *
q
;

1059 
p
 = 
	`dp_p‹ts_lookup
(
dp
, 
msg
->
p‹t_id
);

1060 i‡(
p
 !
NULL
 &&Ö->
√tdev
 != NULL) {

1061 
q
 = 
	`dp_p‹ts_lookup_queue
(
p
, 
msg
->
queue
->
queue_id
);

1062 i‡(
q
 !
NULL
) {

1063 
	`√tdev_dñëe_˛ass
(
p
->
√tdev
,
q
->
˛ass_id
);

1064 
	`p‹t_dñëe_queue
(
p
, 
q
);

1066 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
dp
->
exp
);

1069  
	`oÊ_îr‹
(
OFPET_QUEUE_OP_FAILED
, 
OFPQOFC_BAD_QUEUE
);

1073  
	`oÊ_îr‹
(
OFPET_QUEUE_OP_FAILED
, 
OFPQOFC_BAD_PORT
);

1074 
	}
}

	@udatapath/dp_ports.h

40 #i‚de‡
DP_PORTS_H


41 
	#DP_PORTS_H
 1

	)

43 
	~"li°.h
"

44 
	~"√tdev.h
"

45 
	~"dp_exp.h
"

46 
	~"oÊib/oÊ.h
"

47 
	~"oÊib/oÊ-°ru˘s.h
"

48 
	~"oÊib/oÊ-mesßges.h
"

49 
	~"oÊib-exp/oÊ-exp-›íÊow.h
"

58 #i‡
deföed
(
OF_HW_PLAT
)

59 
	~<›íÊow/of_hw_≠i.h
>

63 
	g£ndî
;

65 
	ssw_queue
 {

66 
sw_p‹t
 *
	mp‹t
;

67 
uöt16_t
 
	m˛ass_id
;

68 
uöt64_t
 
	m¸óãd
;

69 
oÊ_queue_°©s
 *
	m°©s
;

70 
oÊ_∑ckë_queue
 *
	m¥›s
;

74 
	#MAX_HW_NAME_LEN
 32

	)

75 
	esw_p‹t_Êags
 {

76 
	mSWP_USED
 = 1 << 0,

77 
	mSWP_HW_DRV_PORT
 = 1 << 1,

79 #i‡
deföed
(
OF_HW_PLAT
Ë&& !deföed(
USE_NETDEV
)

80 
	#IS_HW_PORT
(
p
Ë(’)->
Êags
 & 
SWP_HW_DRV_PORT
)

	)

82 
	#IS_HW_PORT
(
p
Ë0

	)

85 
	#PORT_IN_USE
(
p
Ë((’Ë!
NULL
Ë&& (p)->
Êags
 & 
SWP_USED
)

	)

87 
	ssw_p‹t
 {

88 
li°
 
	mnode
;

90 
uöt32_t
 
	mÊags
;

91 
d©≠©h
 *
	mdp
;

92 
√tdev
 *
	m√tdev
;

93 
oÊ_p‹t
 *
	mc⁄f
;

94 
oÊ_p‹t_°©s
 *
	m°©s
;

96 
uöt16_t
 
	mmax_queues
;

97 
uöt16_t
 
	mnum_queues
;

98 
uöt64_t
 
	m¸óãd
;

99 
sw_queue
 
	mqueues
[
NETDEV_MAX_QUEUES
];

103 #i‡
deföed
(
OF_HW_PLAT
)

104 
	shw_pkt_q_íåy
 {

105 
oÂbuf
 *
	mbuf„r
;

106 
hw_pkt_q_íåy
 *
	m√xt
;

107 
of_p‹t_t
 
	mp‹t_no
;

108 
	mªas⁄
;

112 
	#DP_MAX_PORTS
 255

	)

113 
BUILD_ASSERT_DECL
(
DP_MAX_PORTS
 <
OFPP_MAX
);

119 
dp_p‹ts_add
(
d©≠©h
 *
dp
, c⁄° *
√tdev
);

123 
dp_p‹ts_add_loˇl
(
d©≠©h
 *
dp
, c⁄° *
√tdev
);

127 
dp_p‹ts_run
(
d©≠©h
 *
dp
);

130 
sw_p‹t
 *

131 
dp_p‹ts_lookup
(
d©≠©h
 *, 
uöt32_t
);

134 
sw_queue
 *

135 
dp_p‹ts_lookup_queue
(
sw_p‹t
 *, 
uöt32_t
);

139 
dp_p‹ts_ouçut
(
d©≠©h
 *
dp
, 
oÂbuf
 *
buf„r
, 
uöt32_t
 
out_p‹t
,

140 
uöt32_t
 
queue_id
);

145 
dp_p‹ts_ouçut_Æl
(
d©≠©h
 *
dp
, 
oÂbuf
 *
buf„r
, 
ö_p‹t
, 
boﬁ
 
Êood
);

148 
oÊ_îr


149 
dp_p‹ts_h™dÀ_p‹t_mod
(
d©≠©h
 *
dp
, 
oÊ_msg_p‹t_mod
 *
msg
,

150 c⁄° 
£ndî
 *sender);

153 
oÊ_îr


154 
dp_p‹ts_h™dÀ_°©s_ªque°_p‹t
(
d©≠©h
 *
dp
,

155 
oÊ_msg_mu…ù¨t_ªque°_p‹t
 *
msg
,

156 c⁄° 
£ndî
 *sender);

159 
oÊ_îr


160 
dp_p‹ts_h™dÀ_p‹t_desc_ªque°
(
d©≠©h
 *
dp
,

161 
oÊ_msg_mu…ù¨t_ªque°_hódî
 *
msg
 
UNUSED
,

162 c⁄° 
£ndî
 *£ndî 
UNUSED
);

165 
oÊ_îr


166 
dp_p‹ts_h™dÀ_°©s_ªque°_queue
(
d©≠©h
 *
dp
,

167 
oÊ_msg_mu…ù¨t_ªque°_queue
 *
msg
,

168 c⁄° 
£ndî
 *sender);

171 
oÊ_îr


172 
dp_p‹ts_h™dÀ_queue_gë_c⁄fig_ªque°
(
d©≠©h
 *
dp
,

173 
oÊ_msg_queue_gë_c⁄fig_ªque°
 *
msg
,

174 c⁄° 
£ndî
 *sender);

177 
oÊ_îr


178 
dp_p‹ts_h™dÀ_queue_modify
(
d©≠©h
 *
dp
, 
oÊ_exp_›íÊow_msg_queue
 *
msg
,

179 c⁄° 
£ndî
 *sender);

182 
oÊ_îr


183 
dp_p‹ts_h™dÀ_queue_dñëe
(
d©≠©h
 *
dp
, 
oÊ_exp_›íÊow_msg_queue
 *
msg
,

184 c⁄° 
£ndî
 *sender);

	@udatapath/flow_entry.c

31 
	~<°dboﬁ.h
>

32 
	~<°dlib.h
>

33 
	~"d©≠©h.h
"

34 
	~"dp_a˘i⁄s.h
"

35 
	~"Êow_èbÀ.h
"

36 
	~"Êow_íåy.h
"

37 
	~"group_èbÀ.h
"

38 
	~"group_íåy.h
"

39 
	~"mëî_èbÀ.h
"

40 
	~"mëî_íåy.h
"

41 
	~"oÊib/oÊ-mesßges.h
"

42 
	~"oÊib/oÊ-°ru˘s.h
"

43 
	~"oÊib/oÊ-a˘i⁄s.h
"

44 
	~"oÊib/oÊ-utûs.h
"

45 
	~"∑ckës.h
"

46 
	~"timevÆ.h
"

47 
	~"utû.h
"

49 
	~"vlog.h
"

50 
	#LOG_MODULE
 
VLM_Êow_e


	)

52 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(60, 60);

54 
	sgroup_ªf_íåy
 {

55 
li°
 
	mnode
;

56 
uöt32_t
 
	mgroup_id
;

59 
	smëî_ªf_íåy
 {

60 
li°
 
	mnode
;

61 
uöt32_t
 
	mmëî_id
;

65 
öô_group_ªfs
(
Êow_íåy
 *
íåy
);

68 
dñ_group_ªfs
(
Êow_íåy
 *
íåy
);

71 
öô_mëî_ªfs
(
Êow_íåy
 *
íåy
);

74 
dñ_mëî_ªfs
(
Êow_íåy
 *
íåy
);

76 
boﬁ


77 
	$Êow_íåy_has_out_p‹t
(
Êow_íåy
 *
íåy
, 
uöt32_t
 
p‹t
) {

78 
size_t
 
i
;

80 
i
=0; i<
íåy
->
°©s
->
ö°ru˘i⁄s_num
; i++) {

81 i‡(
íåy
->
°©s
->
ö°ru˘i⁄s
[
i
]->
ty≥
 =
OFPIT_APPLY_ACTIONS
 ||

82 
íåy
->
°©s
->
ö°ru˘i⁄s
[
i
]->
ty≥
 =
OFPIT_WRITE_ACTIONS
) {

83 
oÊ_ö°ru˘i⁄_a˘i⁄s
 *
ü
 = (oÊ_ö°ru˘i⁄_a˘i⁄†*)
íåy
->
°©s
->
ö°ru˘i⁄s
[
i
];

84 i‡(
	`dp_a˘i⁄s_li°_has_out_p‹t
(
ü
->
a˘i⁄s_num
, ia->
a˘i⁄s
, 
p‹t
)) {

85  
åue
;

89  
Ál£
;

90 
	}
}

93 
boﬁ


94 
	$Êow_íåy_has_out_group
(
Êow_íåy
 *
íåy
, 
uöt32_t
 
group
) {

95 
size_t
 
i
;

97 
i
=0; i<
íåy
->
°©s
->
ö°ru˘i⁄s_num
; i++) {

98 i‡(
íåy
->
°©s
->
ö°ru˘i⁄s
[
i
]->
ty≥
 =
OFPIT_APPLY_ACTIONS
 ||

99 
íåy
->
°©s
->
ö°ru˘i⁄s
[
i
]->
ty≥
 =
OFPIT_WRITE_ACTIONS
) {

100 
oÊ_ö°ru˘i⁄_a˘i⁄s
 *
ü
 = (oÊ_ö°ru˘i⁄_a˘i⁄†*)
íåy
->
°©s
->
ö°ru˘i⁄s
[
i
];

101 i‡(
	`dp_a˘i⁄s_li°_has_out_group
(
ü
->
a˘i⁄s_num
, ia->
a˘i⁄s
, 
group
)) {

102  
åue
;

106  
Ál£
;

107 
	}
}

110 
boﬁ


111 
	$Êow_íåy_m©ches
(
Êow_íåy
 *
íåy
, 
oÊ_msg_Êow_mod
 *
mod
, 
boﬁ
 
°ri˘
, boﬁ 
check_cookõ
) {

112 i‡(
check_cookõ
 && ((
íåy
->
°©s
->
cookõ
 & 
mod
->
cookõ_mask
) != (mod->cookie & mod->cookie_mask))) {

113  
Ál£
;

116 i‡(
°ri˘
) {

117  ( (
íåy
->
°©s
->
¥i‹ôy
 =
mod
->priority) &&

118 
	`m©ch_°d_°ri˘
((
oÊ_m©ch
 *)
mod
->
m©ch
,

119 (
oÊ_m©ch
 *)
íåy
->
°©s
->
m©ch
));

121  
	`m©ch_°d_n⁄°ri˘
((
oÊ_m©ch
 *)
mod
->
m©ch
,

122 (
oÊ_m©ch
 *)
íåy
->
°©s
->
m©ch
);

124 
	}
}

126 
boﬁ


127 
	$Êow_íåy_ovîœps
(
Êow_íåy
 *
íåy
, 
oÊ_msg_Êow_mod
 *
mod
) {

128  (
íåy
->
°©s
->
¥i‹ôy
 =
mod
->priority &&

129 (
mod
->
out_p‹t
 =
OFPP_ANY
 || 
	`Êow_íåy_has_out_p‹t
(
íåy
, mod->out_port)) &&

130 (
mod
->
out_group
 =
OFPG_ANY
 || 
	`Êow_íåy_has_out_group
(
íåy
, mod->out_group)) &&

131 
	`m©ch_°d_ovîœp
((
oÊ_m©ch
 *)
íåy
->
°©s
->
m©ch
,

132 (
oÊ_m©ch
 *)
mod
->
m©ch
));

133 
	}
}

137 
	$Êow_íåy_ª∂a˚_ö°ru˘i⁄s
(
Êow_íåy
 *
íåy
,

138 
size_t
 
ö°ru˘i⁄s_num
,

139 
oÊ_ö°ru˘i⁄_hódî
 **
ö°ru˘i⁄s
) {

142 
	`dñ_group_ªfs
(
íåy
);

144 
	`OFL_UTILS_FREE_ARR_FUN2
(
íåy
->
°©s
->
ö°ru˘i⁄s
,É¡ry->°©s->
ö°ru˘i⁄s_num
,

145 
oÊ_°ru˘s_‰ì_ö°ru˘i⁄
, 
íåy
->
dp
->
exp
);

147 
íåy
->
°©s
->
ö°ru˘i⁄s_num
 = instructions_num;

148 
íåy
->
°©s
->
ö°ru˘i⁄s
 = instructions;

150 
	`öô_group_ªfs
(
íåy
);

151 
	}
}

153 
boﬁ


154 
	$Êow_íåy_idÀ_timeout
(
Êow_íåy
 *
íåy
) {

155 
boﬁ
 
timeout
;

157 
timeout
 = (
íåy
->
°©s
->
idÀ_timeout
 != 0) &&

158 (
	`time_m£c
(Ë> 
íåy
->
œ°_u£d
 +É¡ry->
°©s
->
idÀ_timeout
 * 1000);

160 i‡(
timeout
) {

161 
	`Êow_íåy_ªmove
(
íåy
, 
OFPRR_IDLE_TIMEOUT
);

163  
timeout
;

164 
	}
}

166 
boﬁ


167 
	$Êow_íåy_h¨d_timeout
(
Êow_íåy
 *
íåy
) {

168 
boﬁ
 
timeout
;

170 
timeout
 = (
íåy
->
ªmove_©
 !0Ë&& (
	`time_m£c
() >Éntry->remove_at);

172 i‡(
timeout
) {

173 
	`Êow_íåy_ªmove
(
íåy
, 
OFPRR_HARD_TIMEOUT
);

175  
timeout
;

176 
	}
}

179 
	$Êow_íåy_upd©e
(
Êow_íåy
 *
íåy
) {

180 
íåy
->
°©s
->
duøti⁄_£c
 = (
	`time_m£c
(Ë-É¡ry->
¸óãd
) / 1000;

181 
íåy
->
°©s
->
duøti⁄_n£c
 = ((
	`time_m£c
(Ë-É¡ry->
¸óãd
) % 1000) * 1000;

182 
	}
}

185 
boﬁ


186 
	$has_group_ªf
(
Êow_íåy
 *
íåy
, 
uöt32_t
 
group_id
) {

187 
group_ªf_íåy
 *
g
;

189 
	`LIST_FOR_EACH
(
g
, 
group_ªf_íåy
, 
node
, &
íåy
->
group_ªfs
) {

190 i‡(
g
->
group_id
 == group_id) {

191  
åue
;

194  
Ál£
;

195 
	}
}

199 
	$öô_group_ªfs
(
Êow_íåy
 *
íåy
) {

200 
group_ªf_íåy
 *
e
;

201 
size_t
 
i
,
j
;

202 
i
=0; i<
íåy
->
°©s
->
ö°ru˘i⁄s_num
; i++) {

203 i‡(
íåy
->
°©s
->
ö°ru˘i⁄s
[
i
]->
ty≥
 =
OFPIT_APPLY_ACTIONS
 ||

204 
íåy
->
°©s
->
ö°ru˘i⁄s
[
i
]->
ty≥
 =
OFPIT_WRITE_ACTIONS
) {

205 
oÊ_ö°ru˘i⁄_a˘i⁄s
 *
ü
 = (oÊ_ö°ru˘i⁄_a˘i⁄†*)
íåy
->
°©s
->
ö°ru˘i⁄s
[
i
];

207 
j
=0; j < 
ü
->
a˘i⁄s_num
; j++) {

208 i‡(
ü
->
a˘i⁄s
[
j
]->
ty≥
 =
OFPAT_GROUP
) {

209 
oÊ_a˘i⁄_group
 *
ag
 = (oÊ_a˘i⁄_grou∞*)(
ü
->
a˘i⁄s
[
j
]);

210 i‡(!
	`has_group_ªf
(
íåy
, 
ag
->
group_id
)) {

211 
group_ªf_íåy
 *
gª
 = 
	`xmÆloc
((group_ref_entry));

212 
gª
->
group_id
 = 
ag
->group_id;

213 
	`li°_ö£π
(&
íåy
->
group_ªfs
, &
gª
->
node
);

221 
	`LIST_FOR_EACH
(
e
, 
group_ªf_íåy
, 
node
, &
íåy
->
group_ªfs
) {

222 
group_íåy
 *
group
 = 
	`group_èbÀ_föd
(
íåy
->
dp
->
groups
, 
e
->
group_id
);

223 i‡(
group
 !
NULL
) {

224 
	`group_íåy_add_Êow_ªf
(
group
, 
íåy
);

226 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryögÅÿac˚s†n⁄-exi°ög group(%u).", 
e
->
group_id
);

229 
	}
}

234 
	$dñ_group_ªfs
(
Êow_íåy
 *
íåy
) {

235 
group_ªf_íåy
 *
gª
, *
√xt
;

237 
	`LIST_FOR_EACH_SAFE
(
gª
, 
√xt
, 
group_ªf_íåy
, 
node
, &
íåy
->
group_ªfs
) {

239 
group_íåy
 *
group
 = 
	`group_èbÀ_föd
(
íåy
->
dp
->
groups
, 
gª
->
group_id
);

240 i‡(
group
 !
NULL
) {

241 
	`group_íåy_dñ_Êow_ªf
(
group
, 
íåy
);

243 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryögÅÿac˚s†n⁄-exi°ög group(%u).", 
gª
->
group_id
);

245 
	`li°_ªmove
(&
gª
->
node
);

246 
	`‰ì
(
gª
);

248 
	}
}

252 
boﬁ


253 
	$has_mëî_ªf
(
Êow_íåy
 *
íåy
, 
uöt32_t
 
mëî_id
) {

254 
mëî_ªf_íåy
 *
m
;

256 
	`LIST_FOR_EACH
(
m
, 
mëî_ªf_íåy
, 
node
, &
íåy
->
mëî_ªfs
) {

257 i‡(
m
->
mëî_id
 == meter_id) {

258  
åue
;

261  
Ál£
;

262 
	}
}

266 
	$öô_mëî_ªfs
(
Êow_íåy
 *
íåy
) {

267 
mëî_ªf_íåy
 *
e
;

268 
size_t
 
i
;

270 
i
=0; i<
íåy
->
°©s
->
ö°ru˘i⁄s_num
; i++) {

271 i‡(
íåy
->
°©s
->
ö°ru˘i⁄s
[
i
]->
ty≥
 =
OFPIT_METER
 ) {

272 
oÊ_ö°ru˘i⁄_mëî
 *
ü
 = (oÊ_ö°ru˘i⁄_mëî *)
íåy
->
°©s
->
ö°ru˘i⁄s
[
i
];

274 i‡(!
	`has_mëî_ªf
(
íåy
, 
ü
->
mëî_id
)) {

275 
mëî_ªf_íåy
 *
mª
 = 
	`xmÆloc
((meter_ref_entry));

276 
mª
->
mëî_id
 = 
ü
->meter_id;

277 
	`li°_ö£π
(&
íåy
->
mëî_ªfs
, &
mª
->
node
);

284 
	`LIST_FOR_EACH
(
e
, 
mëî_ªf_íåy
, 
node
, &
íåy
->
mëî_ªfs
) {

285 
mëî_íåy
 *
mëî
 = 
	`mëî_èbÀ_föd
(
íåy
->
dp
->
mëîs
, 
e
->
mëî_id
);

286 i‡(
mëî
 !
NULL
) {

287 
	`mëî_íåy_add_Êow_ªf
(
mëî
, 
íåy
);

289 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryögÅÿac˚s†n⁄-exi°ög mëî(%u).", 
e
->
mëî_id
);

292 
	}
}

297 
	$dñ_mëî_ªfs
(
Êow_íåy
 *
íåy
) {

298 
mëî_ªf_íåy
 *
mª
, *
√xt
;

300 
	`LIST_FOR_EACH_SAFE
(
mª
, 
√xt
, 
mëî_ªf_íåy
, 
node
, &
íåy
->
mëî_ªfs
) {

302 
mëî_íåy
 *
mëî
 = 
	`mëî_èbÀ_föd
(
íåy
->
dp
->
mëîs
, 
mª
->
mëî_id
);

303 i‡(
mëî
 !
NULL
) {

304 
	`mëî_íåy_dñ_Êow_ªf
(
mëî
, 
íåy
);

306 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryögÅÿac˚s†n⁄-exi°ög mëî(%u).", 
mª
->
mëî_id
);

308 
	`li°_ªmove
(&
mª
->
node
);

309 
	`‰ì
(
mª
);

311 
	}
}

314 
Êow_íåy
 *

315 
	$Êow_íåy_¸óã
(
d©≠©h
 *
dp
, 
Êow_èbÀ
 *
èbÀ
, 
oÊ_msg_Êow_mod
 *
mod
) {

316 
Êow_íåy
 *
íåy
;

317 
uöt64_t
 
now
;

319 
now
 = 
	`time_m£c
();

321 
íåy
 = 
	`xmÆloc
((
Êow_íåy
));

322 
íåy
->
dp
 = dp;

323 
íåy
->
èbÀ
 =Åable;

325 
íåy
->
°©s
 = 
	`xmÆloc
((
oÊ_Êow_°©s
));

327 
íåy
->
°©s
->
èbÀ_id
 = 
mod
->table_id;

328 
íåy
->
°©s
->
duøti⁄_£c
 = 0;

329 
íåy
->
°©s
->
duøti⁄_n£c
 = 0;

330 
íåy
->
°©s
->
¥i‹ôy
 = 
mod
->priority;

331 
íåy
->
°©s
->
idÀ_timeout
 = 
mod
->idle_timeout;

332 
íåy
->
°©s
->
h¨d_timeout
 = 
mod
->hard_timeout;

333 
íåy
->
°©s
->
cookõ
 = 
mod
->cookie;

334 
íåy
->
no_pkt_cou¡
 = ((
mod
->
Êags
 & 
OFPFF_NO_PKT_COUNTS
) != 0 );

335 
íåy
->
no_byt_cou¡
 = ((
mod
->
Êags
 & 
OFPFF_NO_BYT_COUNTS
) != 0 );

336 i‡(
íåy
->
no_pkt_cou¡
)

337 
íåy
->
°©s
->
∑ckë_cou¡
 = 0xffffffffffffffff;

339 
íåy
->
°©s
->
∑ckë_cou¡
 = 0;

340 i‡(
íåy
->
no_byt_cou¡
)

341 
íåy
->
°©s
->
byã_cou¡
 = 0xffffffffffffffff;

343 
íåy
->
°©s
->
byã_cou¡
 = 0;

345 
íåy
->
°©s
->
m©ch
 = 
mod
->match;

346 
íåy
->
°©s
->
ö°ru˘i⁄s_num
 = 
mod
->instructions_num;

347 
íåy
->
°©s
->
ö°ru˘i⁄s
 = 
mod
->instructions;

349 
íåy
->
m©ch
 = 
mod
->match;

351 
íåy
->
¸óãd
 = 
now
;

352 
íåy
->
ªmove_©
 = 
mod
->
h¨d_timeout
 == 0 ? 0

353 : 
now
 + 
mod
->
h¨d_timeout
 * 1000;

354 
íåy
->
œ°_u£d
 = 
now
;

355 
íåy
->
£nd_ªmoved
 = ((
mod
->
Êags
 & 
OFPFF_SEND_FLOW_REM
) != 0);

356 
	`li°_öô
(&
íåy
->
m©ch_node
);

357 
	`li°_öô
(&
íåy
->
idÀ_node
);

358 
	`li°_öô
(&
íåy
->
h¨d_node
);

360 
	`li°_öô
(&
íåy
->
group_ªfs
);

361 
	`öô_group_ªfs
(
íåy
);

363 
	`li°_öô
(&
íåy
->
mëî_ªfs
);

364 
	`öô_mëî_ªfs
(
íåy
);

366  
íåy
;

367 
	}
}

370 
	$Êow_íåy_de°roy
(
Êow_íåy
 *
íåy
) {

373 
	`dñ_group_ªfs
(
íåy
);

374 
	`dñ_mëî_ªfs
(
íåy
);

375 
	`oÊ_°ru˘s_‰ì_Êow_°©s
(
íåy
->
°©s
,É¡ry->
dp
->
exp
);

378 
	`‰ì
(
íåy
);

379 
	}
}

382 
	$Êow_íåy_ªmove
(
Êow_íåy
 *
íåy
, 
uöt8_t
 
ªas⁄
) {

383 i‡(
íåy
->
£nd_ªmoved
) {

384 
	`Êow_íåy_upd©e
(
íåy
);

386 
oÊ_msg_Êow_ªmoved
 
msg
 =

387 {{.
ty≥
 = 
OFPT_FLOW_REMOVED
},

388 .
ªas⁄
 =Ñeason,

389 .
°©s
 = 
íåy
->stats};

391 
	`dp_£nd_mesßge
(
íåy
->
dp
, (
oÊ_msg_hódî
 *)&
msg
, 
NULL
);

395 
	`li°_ªmove
(&
íåy
->
m©ch_node
);

396 
	`li°_ªmove
(&
íåy
->
h¨d_node
);

397 
	`li°_ªmove
(&
íåy
->
idÀ_node
);

398 
íåy
->
èbÀ
->
°©s
->
a˘ive_cou¡
--;

399 
	`Êow_íåy_de°roy
(
íåy
);

400 
	}
}

	@udatapath/flow_entry.h

31 #i‚de‡
FLOW_íåy_H


32 
	#FLOW_íåy_H
 1

	)

35 
	~<°dboﬁ.h
>

36 
	~<sys/ty≥s.h
>

37 
	~"d©≠©h.h
"

38 
	~"li°.h
"

39 
	~"oÊib/oÊ-°ru˘s.h
"

40 
	~"oÊib/oÊ-mesßges.h
"

41 
	~"timevÆ.h
"

47 
	sÊow_íåy
 {

48 
li°
 
	mm©ch_node
;

49 
li°
 
	mh¨d_node
;

50 
li°
 
	midÀ_node
;

52 
d©≠©h
 *
	mdp
;

53 
Êow_èbÀ
 *
	mèbÀ
;

54 
oÊ_Êow_°©s
 *
	m°©s
;

55 
oÊ_m©ch_hódî
 *
	mm©ch
;

58 
uöt64_t
 
	m¸óãd
;

59 
uöt64_t
 
	mªmove_©
;

61 
uöt64_t
 
	mœ°_u£d
;

62 
boﬁ
 
	m£nd_ªmoved
;

65 
boﬁ
 
	mno_pkt_cou¡
;

66 
boﬁ
 
	mno_byt_cou¡
;

67 
li°
 
	mgroup_ªfs
;

68 
li°
 
	mmëî_ªfs
;

71 
	g∑ckë
;

74 
boﬁ


75 
Êow_íåy_m©ches
(
Êow_íåy
 *
íåy
, 
oÊ_msg_Êow_mod
 *
mod
, 
boﬁ
 
°ri˘
, boﬁ 
check_cookõ
);

78 
boﬁ


79 
Êow_íåy_ovîœps
(
Êow_íåy
 *
íåy
, 
oÊ_msg_Êow_mod
 *
mod
);

83 
Êow_íåy_ª∂a˚_ö°ru˘i⁄s
(
Êow_íåy
 *
íåy
,

84 
size_t
 
ö°ru˘i⁄s_num
,

85 
oÊ_ö°ru˘i⁄_hódî
 **
ö°ru˘i⁄s
);

89 
boﬁ


90 
Êow_íåy_idÀ_timeout
(
Êow_íåy
 *
íåy
);

94 
boﬁ


95 
Êow_íåy_h¨d_timeout
(
Êow_íåy
 *
íåy
);

98 
boﬁ


99 
Êow_íåy_has_out_p‹t
(
Êow_íåy
 *
íåy
, 
uöt32_t
 
p‹t
);

102 
boﬁ


103 
Êow_íåy_has_out_group
(
Êow_íåy
 *
íåy
, 
uöt32_t
 
group
);

108 
Êow_íåy_upd©e
(
Êow_íåy
 *
íåy
);

111 
Êow_íåy
 *

112 
Êow_íåy_¸óã
(
d©≠©h
 *
dp
, 
Êow_èbÀ
 *
èbÀ
, 
oÊ_msg_Êow_mod
 *
mod
);

116 
Êow_íåy_de°roy
(
Êow_íåy
 *
íåy
);

120 
Êow_íåy_ªmove
(
Êow_íåy
 *
íåy
, 
uöt8_t
 
ªas⁄
);

	@udatapath/flow_table.c

31 
	~<°dboﬁ.h
>

32 
	~<°rög.h
>

33 
	~"dy«mic-°rög.h
"

34 
	~"d©≠©h.h
"

35 
	~"Êow_èbÀ.h
"

36 
	~"Êow_íåy.h
"

37 
	~"oÊib/oÊ.h
"

38 
	~"oÊib/oxm-m©ch.h
"

39 
	~"time.h
"

40 
	~"dp_ˇ∑bûôõs.h
"

43 
	~"vlog.h
"

44 
	#LOG_MODULE
 
VLM_Êow_t


	)

46 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(60, 60);

48 
uöt32_t
 
	goxm_ids
[]={
OXM_OF_IN_PORT
,
OXM_OF_IN_PHY_PORT
,
OXM_OF_METADATA
,
OXM_OF_ETH_DST
,

49 
OXM_OF_ETH_SRC
,
OXM_OF_ETH_TYPE
, 
OXM_OF_VLAN_VID
, 
OXM_OF_VLAN_PCP
, 
OXM_OF_IP_DSCP
,

50 
OXM_OF_IP_ECN
, 
OXM_OF_IP_PROTO
, 
OXM_OF_IPV4_SRC
, 
OXM_OF_IPV4_DST
, 
OXM_OF_TCP_SRC
,

51 
OXM_OF_TCP_DST
, 
OXM_OF_UDP_SRC
, 
OXM_OF_UDP_DST
, 
OXM_OF_SCTP_SRC
, 
OXM_OF_SCTP_DST
,

52 
OXM_OF_ICMPV4_TYPE
, 
OXM_OF_ICMPV4_CODE
, 
OXM_OF_ARP_OP
, 
OXM_OF_ARP_SPA
,
OXM_OF_ARP_TPA
,

53 
OXM_OF_ARP_SHA
, 
OXM_OF_ARP_THA
, 
OXM_OF_IPV6_SRC
, 
OXM_OF_IPV6_DST
, 
OXM_OF_IPV6_FLABEL
,

54 
OXM_OF_ICMPV6_TYPE
, 
OXM_OF_ICMPV6_CODE
, 
OXM_OF_IPV6_ND_TARGET
, 
OXM_OF_IPV6_ND_SLL
,

55 
OXM_OF_IPV6_ND_TLL
, 
OXM_OF_MPLS_LABEL
, 
OXM_OF_MPLS_TC
, 
OXM_OF_MPLS_BOS
, 
OXM_OF_PBB_ISID
,

56 
OXM_OF_TUNNEL_ID
, 
OXM_OF_IPV6_EXTHDR
};

58 
uöt32_t
 
	gwûdˇrded
[] = {
OXM_OF_METADATA
, 
OXM_OF_ETH_DST
, 
OXM_OF_ETH_SRC
, 
OXM_OF_VLAN_VID
, 
OXM_OF_IPV4_SRC
,

59 
OXM_OF_IPV4_DST
, 
OXM_OF_ARP_SPA
, 
OXM_OF_ARP_TPA
, 
OXM_OF_ARP_SHA
, 
OXM_OF_ARP_THA
, 
OXM_OF_IPV6_SRC
,

60 
OXM_OF_IPV6_DST
 , 
OXM_OF_IPV6_FLABEL
, 
OXM_OF_PBB_ISID
, 
OXM_OF_TUNNEL_ID
, 
OXM_OF_IPV6_EXTHDR
};

63 
oÊ_ö°ru˘i⁄_hódî
 
	gö°ru˘i⁄s
[] = { {
OFPIT_GOTO_TABLE
},

64 {
OFPIT_WRITE_METADATA
 },{
OFPIT_WRITE_ACTIONS
},{
OFPIT_APPLY_ACTIONS
},

65 {
OFPIT_CLEAR_ACTIONS
},{
OFPIT_METER
}} ;

67 
oÊ_a˘i⁄_hódî
 
	ga˘i⁄s
[] = { {
OFPAT_OUTPUT
, 4},

68 {
OFPAT_COPY_TTL_OUT
, 4},{
OFPAT_COPY_TTL_IN
, 4},{
OFPAT_SET_MPLS_TTL
, 4},

69 {
OFPAT_DEC_MPLS_TTL
, 4},{
OFPAT_PUSH_VLAN
, 4},{
OFPAT_POP_VLAN
, 4}, {
OFPAT_PUSH_MPLS
, 4},

70 {
OFPAT_POP_MPLS
, 4},{
OFPAT_SET_QUEUE
, 4}, {
OFPAT_GROUP
, 4}, {
OFPAT_SET_NW_TTL
, 4}, {
OFPAT_DEC_NW_TTL
, 4},

71 {
OFPAT_SET_FIELD
, 4}, {
OFPAT_PUSH_PBB
, 4}, {
OFPAT_POP_PBB
, 4} } ;

76 
	$add_to_timeout_li°s
(
Êow_èbÀ
 *
èbÀ
, 
Êow_íåy
 *
íåy
) {

77 i‡(
íåy
->
°©s
->
idÀ_timeout
 > 0) {

78 
	`li°_ö£π
(&
èbÀ
->
idÀ_íåõs
, &
íåy
->
idÀ_node
);

81 i‡(
íåy
->
ªmove_©
 > 0) {

82 
Êow_íåy
 *
e
;

85 
	`LIST_FOR_EACH
 (
e
, 
Êow_íåy
, 
h¨d_node
, &
èbÀ
->
h¨d_íåõs
) {

86 i‡(
e
->
ªmove_©
 > 
íåy
->remove_at) {

87 
	`li°_ö£π
(&
e
->
h¨d_node
, &
íåy
->hard_node);

91 
	`li°_ö£π
(&
e
->
h¨d_node
, &
íåy
->hard_node);

93 
	}
}

96 
oÊ_îr


97 
	$Êow_èbÀ_add
(
Êow_èbÀ
 *
èbÀ
, 
oÊ_msg_Êow_mod
 *
mod
, 
boﬁ
 
check_ovîœp
, boﬁ *
m©ch_kït
, boﬁ *
ö°s_kït
) {

99 
Êow_íåy
 *
íåy
, *
√w_íåy
;

101 
	`LIST_FOR_EACH
 (
íåy
, 
Êow_íåy
, 
m©ch_node
, &
èbÀ
->
m©ch_íåõs
) {

102 i‡(
check_ovîœp
 && 
	`Êow_íåy_ovîœps
(
íåy
, 
mod
)) {

103  
	`oÊ_îr‹
(
OFPET_FLOW_MOD_FAILED
, 
OFPFMFC_OVERLAP
);

107 i‡(
	`Êow_íåy_m©ches
(
íåy
, 
mod
, 
åue
 , 
Ál£
 )) {

108 
√w_íåy
 = 
	`Êow_íåy_¸óã
(
èbÀ
->
dp
,ÅabÀ, 
mod
);

109 *
m©ch_kït
 = 
åue
;

110 *
ö°s_kït
 = 
åue
;

113 
	`li°_ª∂a˚
(&
√w_íåy
->
m©ch_node
, &
íåy
->match_node);

114 
	`li°_ªmove
(&
íåy
->
h¨d_node
);

115 
	`li°_ªmove
(&
íåy
->
idÀ_node
);

116 
	`Êow_íåy_de°roy
(
íåy
);

117 
	`add_to_timeout_li°s
(
èbÀ
, 
√w_íåy
);

121 i‡(
mod
->
¥i‹ôy
 > 
íåy
->
°©s
->priority) {

126 i‡(
èbÀ
->
°©s
->
a˘ive_cou¡
 =
FLOW_TABLE_MAX_ENTRIES
) {

127  
	`oÊ_îr‹
(
OFPET_FLOW_MOD_FAILED
, 
OFPFMFC_TABLE_FULL
);

129 
èbÀ
->
°©s
->
a˘ive_cou¡
++;

131 
√w_íåy
 = 
	`Êow_íåy_¸óã
(
èbÀ
->
dp
,ÅabÀ, 
mod
);

132 *
m©ch_kït
 = 
åue
;

133 *
ö°s_kït
 = 
åue
;

135 
	`li°_ö£π
(&
íåy
->
m©ch_node
, &
√w_íåy
->match_node);

136 
	`add_to_timeout_li°s
(
èbÀ
, 
√w_íåy
);

139 
	}
}

143 
oÊ_îr


144 
	$Êow_èbÀ_modify
(
Êow_èbÀ
 *
èbÀ
, 
oÊ_msg_Êow_mod
 *
mod
, 
boﬁ
 
°ri˘
, boﬁ *
ö°s_kït
) {

145 
Êow_íåy
 *
íåy
;

147 
	`LIST_FOR_EACH
 (
íåy
, 
Êow_íåy
, 
m©ch_node
, &
èbÀ
->
m©ch_íåõs
) {

148 i‡(
	`Êow_íåy_m©ches
(
íåy
, 
mod
, 
°ri˘
, 
åue
 )) {

149 
	`Êow_íåy_ª∂a˚_ö°ru˘i⁄s
(
íåy
, 
mod
->
ö°ru˘i⁄s_num
, mod->
ö°ru˘i⁄s
);

150 *
ö°s_kït
 = 
åue
;

155 
	}
}

158 
oÊ_îr


159 
	$Êow_èbÀ_dñëe
(
Êow_èbÀ
 *
èbÀ
, 
oÊ_msg_Êow_mod
 *
mod
, 
boﬁ
 
°ri˘
) {

160 
Êow_íåy
 *
íåy
, *
√xt
;

162 
	`LIST_FOR_EACH_SAFE
 (
íåy
, 
√xt
, 
Êow_íåy
, 
m©ch_node
, &
èbÀ
->
m©ch_íåõs
) {

163 i‡((
mod
->
out_p‹t
 =
OFPP_ANY
 || 
	`Êow_íåy_has_out_p‹t
(
íåy
, mod->out_port)) &&

164 (
mod
->
out_group
 =
OFPG_ANY
 || 
	`Êow_íåy_has_out_group
(
íåy
, mod->out_group)) &&

165 
	`Êow_íåy_m©ches
(
íåy
, 
mod
, 
°ri˘
, 
åue
 )) {

166 
	`Êow_íåy_ªmove
(
íåy
, 
OFPRR_DELETE
);

171 
	}
}

174 
oÊ_îr


175 
	$Êow_èbÀ_Êow_mod
(
Êow_èbÀ
 *
èbÀ
, 
oÊ_msg_Êow_mod
 *
mod
, 
boﬁ
 *
m©ch_kït
, boﬁ *
ö°s_kït
) {

176 
mod
->
comm™d
) {

177 (
OFPFC_ADD
): {

178 
boﬁ
 
ovîœp
 = ((
mod
->
Êags
 & 
OFPFF_CHECK_OVERLAP
) != 0);

179  
	`Êow_èbÀ_add
(
èbÀ
, 
mod
, 
ovîœp
, 
m©ch_kït
, 
ö°s_kït
);

181 (
OFPFC_MODIFY
): {

182  
	`Êow_èbÀ_modify
(
èbÀ
, 
mod
, 
Ál£
, 
ö°s_kït
);

184 (
OFPFC_MODIFY_STRICT
): {

185  
	`Êow_èbÀ_modify
(
èbÀ
, 
mod
, 
åue
, 
ö°s_kït
);

187 (
OFPFC_DELETE
): {

188  
	`Êow_èbÀ_dñëe
(
èbÀ
, 
mod
, 
Ál£
);

190 (
OFPFC_DELETE_STRICT
): {

191  
	`Êow_èbÀ_dñëe
(
èbÀ
, 
mod
, 
åue
);

194  
	`oÊ_îr‹
(
OFPET_FLOW_MOD_FAILED
, 
OFPFMFC_BAD_COMMAND
);

197 
	}
}

200 
Êow_íåy
 *

201 
	$Êow_èbÀ_lookup
(
Êow_èbÀ
 *
èbÀ
, 
∑ckë
 *
pkt
) {

202 
Êow_íåy
 *
íåy
;

204 
èbÀ
->
°©s
->
lookup_cou¡
++;

206 
	`LIST_FOR_EACH
(
íåy
, 
Êow_íåy
, 
m©ch_node
, &
èbÀ
->
m©ch_íåõs
) {

207 
oÊ_m©ch_hódî
 *
m
;

209 
m
 = 
íåy
->
m©ch
 =
NULL
 ?É¡ry->
°©s
->match :Éntry->match;

212 
m
->
ty≥
) {

213 (
OFPMT_OXM
): {

214 i‡(
	`∑ckë_h™dÀ_°d_m©ch
(
pkt
->
h™dÀ_°d
,

215 (
oÊ_m©ch
 *)
m
)) {

216 i‡(!
íåy
->
no_byt_cou¡
)

217 
íåy
->
°©s
->
byã_cou¡
 +
pkt
->
buf„r
->
size
;

218 i‡(!
íåy
->
no_pkt_cou¡
)

219 
íåy
->
°©s
->
∑ckë_cou¡
++;

220 
íåy
->
œ°_u£d
 = 
	`time_m£c
();

222 
èbÀ
->
°©s
->
m©ched_cou¡
++;

224  
íåy
;

231 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryögÅÿ¥o˚s†ÊowÉ¡ry wôh unknow¿m©chÅy≥ (%u).", 
m
->
ty≥
);

236  
NULL
;

237 
	}
}

242 
	$Êow_èbÀ_timeout
(
Êow_èbÀ
 *
èbÀ
) {

243 
Êow_íåy
 *
íåy
, *
√xt
;

247 
	`LIST_FOR_EACH_SAFE
 (
íåy
, 
√xt
, 
Êow_íåy
, 
h¨d_node
, &
èbÀ
->
h¨d_íåõs
) {

248 i‡(!
	`Êow_íåy_h¨d_timeout
(
íåy
)) {

253 
	`LIST_FOR_EACH_SAFE
 (
íåy
, 
√xt
, 
Êow_íåy
, 
idÀ_node
, &
èbÀ
->
idÀ_íåõs
) {

254 
	`Êow_íåy_idÀ_timeout
(
íåy
);

256 
	}
}

260 
	$Êow_èbÀ_¸óã_¥›îty
(
oÊ_èbÀ_„©uª_¥›_hódî
 **
¥›
, 
oÂ_èbÀ_„©uª_¥›_ty≥
 
ty≥
){

262 
ty≥
){

263 
OFPTFPT_INSTRUCTIONS
:

264 
OFPTFPT_INSTRUCTIONS_MISS
:{

265 
oÊ_èbÀ_„©uª_¥›_ö°ru˘i⁄s
 *
ö°_ˇ∑bûôõs
;

266 
ö°_ˇ∑bûôõs
 = 
	`xmÆloc
((
oÊ_èbÀ_„©uª_¥›_ö°ru˘i⁄s
));

267 
ö°_ˇ∑bûôõs
->
hódî
.
ty≥
 =Åype;

268 
ö°_ˇ∑bûôõs
->
ids_num
 = 
N_INSTRUCTIONS
;

269 
ö°_ˇ∑bûôõs
->
ö°ru˘i⁄_ids
 = 
ö°ru˘i⁄s
;

270 
ö°_ˇ∑bûôõs
->
hódî
.
Àngth
 = 
	`oÊ_°ru˘s_èbÀ_„©uªs_¥›îtõs_oÂ_Àn
(&ö°_ˇ∑bûôõs->hódî, 
NULL
);

271 (*
¥›
Ë(
oÊ_èbÀ_„©uª_¥›_hódî
*Ë
ö°_ˇ∑bûôõs
;

274 
OFPTFPT_NEXT_TABLES
:

275 
OFPTFPT_NEXT_TABLES_MISS
:{

276 
oÊ_èbÀ_„©uª_¥›_√xt_èbÀs
 *
tbl_ªachabÀ
;

277 
i
;

278 
tbl_ªachabÀ
 = 
	`xmÆloc
((
oÊ_èbÀ_„©uª_¥›_√xt_èbÀs
));

279 
tbl_ªachabÀ
->
hódî
.
ty≥
 =Åype;

280 
tbl_ªachabÀ
->
èbÀ_num
 = 
PIPELINE_TABLES
 ;

281 
tbl_ªachabÀ
->
√xt_èbÀ_ids
 = 
	`xmÆloc
((
uöt8_t
Ë*Åbl_ªachabÀ->
èbÀ_num
);

282 
i
=0; i < 
tbl_ªachabÀ
->
èbÀ_num
; i++)

283 
tbl_ªachabÀ
->
√xt_èbÀ_ids
[
i
] = i;

284 
tbl_ªachabÀ
->
hódî
.
Àngth
 = 
	`oÊ_°ru˘s_èbÀ_„©uªs_¥›îtõs_oÂ_Àn
(&tbl_ªachabÀ->hódî, 
NULL
);

285 *
¥›
 = (
oÊ_èbÀ_„©uª_¥›_hódî
*Ë
tbl_ªachabÀ
;

288 
OFPTFPT_APPLY_ACTIONS
:

289 
OFPTFPT_APPLY_ACTIONS_MISS
:

290 
OFPTFPT_WRITE_ACTIONS
:

291 
OFPTFPT_WRITE_ACTIONS_MISS
:{

292 
oÊ_èbÀ_„©uª_¥›_a˘i⁄s
 *
a˘_ˇ∑bûôõs
;

293 
a˘_ˇ∑bûôõs
 = 
	`xmÆloc
((
oÊ_èbÀ_„©uª_¥›_a˘i⁄s
));

294 
a˘_ˇ∑bûôõs
->
hódî
.
ty≥
 =Åype;

295 
a˘_ˇ∑bûôõs
->
a˘i⁄s_num

N_ACTIONS
;

296 
a˘_ˇ∑bûôõs
->
a˘i⁄_ids
 = 
a˘i⁄s
;

297 
a˘_ˇ∑bûôõs
->
hódî
.
Àngth
 = 
	`oÊ_°ru˘s_èbÀ_„©uªs_¥›îtõs_oÂ_Àn
(&a˘_ˇ∑bûôõs->hódî, 
NULL
);

298 *
¥›
 = (
oÊ_èbÀ_„©uª_¥›_hódî
*Ë
a˘_ˇ∑bûôõs
;

301 
OFPTFPT_MATCH
:

302 
OFPTFPT_APPLY_SETFIELD
:

303 
OFPTFPT_APPLY_SETFIELD_MISS
:

304 
OFPTFPT_WRITE_SETFIELD
:

305 
OFPTFPT_WRITE_SETFIELD_MISS
:{

306 
oÊ_èbÀ_„©uª_¥›_oxm
 *
oxm_ˇ∑bûôõs
;

307 
i
;

308 
oxm_ˇ∑bûôõs
 = 
	`xmÆloc
((
oÊ_èbÀ_„©uª_¥›_oxm
));

309 
oxm_ˇ∑bûôõs
->
hódî
.
ty≥
 =Åype;

310 
oxm_ˇ∑bûôõs
->
oxm_num
 = 
NUM_OXM_FIELDS
;

311 
oxm_ˇ∑bûôõs
->
oxm_ids
 = oxm_ids;

312 
oxm_ˇ∑bûôõs
->
hódî
.
Àngth
 = 
	`oÊ_°ru˘s_èbÀ_„©uªs_¥›îtõs_oÂ_Àn
(&oxm_ˇ∑bûôõs->hódî, 
NULL
);

313 *
¥›
 = (
oÊ_èbÀ_„©uª_¥›_hódî
*Ë
oxm_ˇ∑bûôõs
;

316 
OFPTFPT_WILDCARDS
:{

317 
oÊ_èbÀ_„©uª_¥›_oxm
 *
oxm_ˇ∑bûôõs
;

318 
oxm_ˇ∑bûôõs
 = 
	`xmÆloc
((
oÊ_èbÀ_„©uª_¥›_oxm
));

319 
oxm_ˇ∑bûôõs
->
hódî
.
ty≥
 =Åype;

320 
oxm_ˇ∑bûôõs
->
oxm_num
 = 
N_WILDCARDED
;

321 
oxm_ˇ∑bûôõs
->
oxm_ids
 = 
wûdˇrded
;

322 
oxm_ˇ∑bûôõs
->
hódî
.
Àngth
 = 
	`oÊ_°ru˘s_èbÀ_„©uªs_¥›îtõs_oÂ_Àn
(&oxm_ˇ∑bûôõs->hódî, 
NULL
);

323 *
¥›
 = (
oÊ_èbÀ_„©uª_¥›_hódî
*Ë
oxm_ˇ∑bûôõs
;

326 
OFPTFPT_EXPERIMENTER
:

327 
OFPTFPT_EXPERIMENTER_MISS
:{

331 
	}
}

334 
	$Êow_èbÀ_„©uªs
(
oÊ_èbÀ_„©uªs
 *
„©uªs
){

336 
ty≥
, 
j
;

337 
„©uªs
->
¥›îtõs
 = (
oÊ_èbÀ_„©uª_¥›_hódî
 **Ë
	`xmÆloc
((oÊ_èbÀ_„©uª_¥›_hódî *Ë* 
TABLE_FEATURES_NUM
);

338 
j
 = 0;

339 
ty≥
 = 
OFPTFPT_INSTRUCTIONS
;Åy≥ <
OFPTFPT_APPLY_SETFIELD_MISS
;Åype++){

341 
	`Êow_èbÀ_¸óã_¥›îty
(&
„©uªs
->
¥›îtõs
[
j
], 
ty≥
);

342 if(
ty≥
 =
OFPTFPT_MATCH
||Åy≥ =
OFPTFPT_WILDCARDS
){

343 
ty≥
++;

345 
j
++;

348 if(
j
 !
TABLE_FEATURES_NUM
) {

349 
	`VLOG_WARN
(
LOG_MODULE
, "InvÆidÇumbî o‡èbÀ fótuªs, %d in°ód o‡%d.", 
j
, 
TABLE_FEATURES_NUM
);

350 
	`ab‹t
();

352  
j
;

353 
	}
}

355 
Êow_èbÀ
 *

356 
	$Êow_èbÀ_¸óã
(
d©≠©h
 *
dp
, 
uöt8_t
 
èbÀ_id
) {

357 
Êow_èbÀ
 *
èbÀ
;

358 
ds
 
°rög
 = 
DS_EMPTY_INITIALIZER
;

360 
	`ds_put_f‹m©
(&
°rög
, "èbÀ_%u", 
èbÀ_id
);

362 
èbÀ
 = 
	`xmÆloc
((
Êow_èbÀ
));

363 
èbÀ
->
dp
 = dp;

366 
èbÀ
->
°©s
 = 
	`xmÆloc
((
oÊ_èbÀ_°©s
));

367 
èbÀ
->
°©s
->
èbÀ_id
 =Åable_id;

368 
èbÀ
->
°©s
->
a˘ive_cou¡
 = 0;

369 
èbÀ
->
°©s
->
lookup_cou¡
 = 0;

370 
èbÀ
->
°©s
->
m©ched_cou¡
 = 0;

373 
èbÀ
->
„©uªs
 = 
	`xmÆloc
((
oÊ_èbÀ_„©uªs
));

374 
èbÀ
->
„©uªs
->
èbÀ_id
 =Åable_id;

375 
èbÀ
->
„©uªs
->
«me
 = 
	`ds_c°r
(&
°rög
);

376 
èbÀ
->
„©uªs
->
mëad©a_m©ch
 = 0xffffffffffffffff;

377 
èbÀ
->
„©uªs
->
mëad©a_wrôe
 = 0xffffffffffffffff;

378 
èbÀ
->
„©uªs
->
c⁄fig
 = 
OFPTC_TABLE_MISS_CONTROLLER
;

379 
èbÀ
->
„©uªs
->
max_íåõs
 = 
FLOW_TABLE_MAX_ENTRIES
;

380 
èbÀ
->
„©uªs
->
¥›îtõs_num
 = 
	`Êow_èbÀ_„©uªs
(table->features);

382 
	`li°_öô
(&
èbÀ
->
m©ch_íåõs
);

383 
	`li°_öô
(&
èbÀ
->
h¨d_íåõs
);

384 
	`li°_öô
(&
èbÀ
->
idÀ_íåõs
);

386 
èbÀ
->
°©e_èbÀ
 = 
	`°©e_èbÀ_¸óã
();

388  
èbÀ
;

389 
	}
}

392 
	$Êow_èbÀ_de°roy
(
Êow_èbÀ
 *
èbÀ
) {

393 
Êow_íåy
 *
íåy
, *
√xt
;

395 
	`LIST_FOR_EACH_SAFE
 (
íåy
, 
√xt
, 
Êow_íåy
, 
m©ch_node
, &
èbÀ
->
m©ch_íåõs
) {

396 
	`Êow_íåy_de°roy
(
íåy
);

398 
	`‰ì
(
èbÀ
->
„©uªs
);

399 
	`‰ì
(
èbÀ
->
°©s
);

400 
	`°©e_èbÀ_de°roy
(
èbÀ
->
°©e_èbÀ
);

401 
	`‰ì
(
èbÀ
);

402 
	}
}

405 
	$Êow_èbÀ_°©s
(
Êow_èbÀ
 *
èbÀ
, 
oÊ_msg_mu…ù¨t_ªque°_Êow
 *
msg
,

406 
oÊ_Êow_°©s
 ***
°©s
, 
size_t
 *
°©s_size
, size_à*
°©s_num
) {

407 
Êow_íåy
 *
íåy
;

409 
	`LIST_FOR_EACH
(
íåy
, 
Êow_íåy
, 
m©ch_node
, &
èbÀ
->
m©ch_íåõs
) {

410 i‡((
msg
->
out_p‹t
 =
OFPP_ANY
 || 
	`Êow_íåy_has_out_p‹t
(
íåy
, msg->out_port)) &&

411 (
msg
->
out_group
 =
OFPG_ANY
 || 
	`Êow_íåy_has_out_group
(
íåy
, msg->out_group)) &&

412 
	`m©ch_°d_n⁄°ri˘
((
oÊ_m©ch
 *)
msg
->
m©ch
,

413 (
oÊ_m©ch
 *)
íåy
->
°©s
->
m©ch
)) {

415 
	`Êow_íåy_upd©e
(
íåy
);

416 i‡((*
°©s_size
Ë=(*
°©s_num
)) {

417 (*
°©s
Ë
	`xªÆloc
(*°©s, ((
oÊ_Êow_°©s
 *)Ë* (*
°©s_size
) * 2);

418 *
°©s_size
 *= 2;

420 (*
°©s
)[(*
°©s_num
)] = 
íåy
->stats;

421 (*
°©s_num
)++;

424 
	}
}

427 
	$Êow_èbÀ_aggªg©e_°©s
(
Êow_èbÀ
 *
èbÀ
, 
oÊ_msg_mu…ù¨t_ªque°_Êow
 *
msg
,

428 
uöt64_t
 *
∑ckë_cou¡
, uöt64_à*
byã_cou¡
, 
uöt32_t
 *
Êow_cou¡
) {

429 
Êow_íåy
 *
íåy
;

431 
	`LIST_FOR_EACH
(
íåy
, 
Êow_íåy
, 
m©ch_node
, &
èbÀ
->
m©ch_íåõs
) {

432 i‡((
msg
->
out_p‹t
 =
OFPP_ANY
 || 
	`Êow_íåy_has_out_p‹t
(
íåy
, msg->out_port)) &&

433 (
msg
->
out_group
 =
OFPG_ANY
 || 
	`Êow_íåy_has_out_group
(
íåy
, msg->out_group))) {

435 i‡(!
íåy
->
no_pkt_cou¡
)

436 (*
∑ckë_cou¡
Ë+
íåy
->
°©s
->packet_count;

437 i‡(!
íåy
->
no_byt_cou¡
)

438 (*
byã_cou¡
Ë+
íåy
->
°©s
->byte_count;

439 (*
Êow_cou¡
)++;

443 
	}
}

	@udatapath/flow_table.h

31 #i‚de‡
FLOW_TABLE_H


32 
	#FLOW_TABLE_H
 1

	)

33 
	~"oÊib/oÊ.h
"

34 
	~"oÊib/oÊ-mesßges.h
"

35 
	~"oÊib/oÊ-°ru˘s.h
"

36 
	~"pùñöe.h
"

37 
	~"timevÆ.h
"

38 
	~"°©e_èbÀ.h
"

41 
	#FLOW_TABLE_MAX_ENTRIES
 4096

	)

42 
	#TABLE_FEATURES_NUM
 14

	)

45 
	#N_INSTRUCTIONS
 6

	)

46 
	#N_ACTIONS
 16

	)

47 
	#N_WILDCARDED
 16

	)

54 
	sÊow_èbÀ
 {

55 
d©≠©h
 *
	mdp
;

56 
oÊ_èbÀ_„©uªs
 *
	m„©uªs
;

57 
oÊ_èbÀ_°©s
 *
	m°©s
;

59 
li°
 
	mm©ch_íåõs
;

60 
li°
 
	mh¨d_íåõs
;

62 
li°
 
	midÀ_íåõs
;

64 
°©e_èbÀ
 *
	m°©e_èbÀ
;

67 
uöt32_t
 
oxm_ids
[];

69 
uöt32_t
 
wûdˇrded
[];

71 
oÊ_ö°ru˘i⁄_hódî
 
ö°ru˘i⁄s
[];

73 
oÊ_a˘i⁄_hódî
 
a˘i⁄s
[];

75 
oÊ_îr


76 
Êow_èbÀ_Êow_mod
(
Êow_èbÀ
 *
èbÀ
, 
oÊ_msg_Êow_mod
 *
mod
, 
boﬁ
 *
m©ch_kït
, boﬁ *
ö°s_kït
);

79 
Êow_íåy
 *

80 
Êow_èbÀ_lookup
(
Êow_èbÀ
 *
èbÀ
, 
∑ckë
 *
pkt
);

84 
Êow_èbÀ_timeout
(
Êow_èbÀ
 *
èbÀ
);

87 
Êow_èbÀ
 *

88 
Êow_èbÀ_¸óã
(
d©≠©h
 *
dp
, 
uöt8_t
 
èbÀ_id
);

92 
Êow_èbÀ_de°roy
(
Êow_èbÀ
 *
èbÀ
);

96 
Êow_èbÀ_°©s
(
Êow_èbÀ
 *
èbÀ
, 
oÊ_msg_mu…ù¨t_ªque°_Êow
 *
msg
,

97 
oÊ_Êow_°©s
 ***
°©s
, 
size_t
 *
°©s_size
, size_à*
°©s_num
);

101 
Êow_èbÀ_aggªg©e_°©s
(
Êow_èbÀ
 *
èbÀ
, 
oÊ_msg_mu…ù¨t_ªque°_Êow
 *
msg
,

102 
uöt64_t
 *
∑ckë_cou¡
, uöt64_à*
byã_cou¡
, 
uöt32_t
 *
Êow_cou¡
);

	@udatapath/group_entry.c

31 
	~<°dboﬁ.h
>

32 
	~"Êow_íåy.h
"

33 
	~"group_íåy.h
"

34 
	~"group_èbÀ.h
"

35 
	~"dp_a˘i⁄s.h
"

36 
	~"d©≠©h.h
"

37 
	~"utû.h
"

38 
	~"oÊib/oÊ.h
"

39 
	~"oÊib/oÊ-°ru˘s.h
"

40 
	~"oÊib/oÊ-utûs.h
"

42 
	~"vlog.h
"

43 
	#LOG_MODULE
 
VLM_group_e


	)

45 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(60, 60);

49 
	ggroup_èbÀ
;

50 
	gd©≠©h
;

53 
	sÊow_ªf_íåy
 {

54 
li°
 
	mnode
;

55 
Êow_íåy
 *
	míåy
;

59 
	sgroup_íåy_wº_d©a
 {

60 
uöt16_t
 
	mmax_weight
;

61 
uöt16_t
 
	mgcd_weight
;

62 
uöt16_t
 
	mcuº_weight
;

63 
size_t
 
	mcuº_buckë
;

66 
uöt16_t


67 
gcd
(
uöt16_t
 
a
, uöt16_à
b
);

69 
boﬁ


70 
buckë_is_Æive
(
oÊ_buckë
 *
buckë
, 
d©≠©h
 *
dp
);

73 
öô_£À˘_group
(
group_íåy
 *
íåy
, 
oÊ_msg_group_mod
 *
mod
);

75 
size_t


76 
£À˘_‰om_£À˘_group
(
group_íåy
 *
íåy
);

78 
size_t


79 
£À˘_‰om_ff_group
(
group_íåy
 *
íåy
);

82 
group_íåy
 *

83 
	$group_íåy_¸óã
(
d©≠©h
 *
dp
, 
group_èbÀ
 *
èbÀ
, 
oÊ_msg_group_mod
 *
mod
) {

84 
group_íåy
 *
íåy
;

85 
size_t
 
i
;

86 
uöt64_t
 
now
;

88 
now
 = 
	`time_m£c
();

89 
íåy
 = 
	`xmÆloc
((
group_íåy
));

91 
íåy
->
dp
 = dp;

92 
íåy
->
èbÀ
 =Åable;

94 
íåy
->
desc
 = 
	`xmÆloc
((
oÊ_group_desc_°©s
));

95 
íåy
->
desc
->
ty≥
 = 
mod
->type;

96 
íåy
->
desc
->
group_id
 = 
mod
->group_id;

97 
íåy
->
desc
->
buckës_num
 = 
mod
->buckets_num;

98 
íåy
->
desc
->
buckës
 = 
mod
->buckets;

100 
íåy
->
°©s
 = 
	`xmÆloc
((
oÊ_group_°©s
));

101 
íåy
->
°©s
->
group_id
 = 
mod
->group_id;

102 
íåy
->
°©s
->
ªf_cou¡
 = 0;

103 
íåy
->
°©s
->
∑ckë_cou¡
 = 0;

104 
íåy
->
°©s
->
byã_cou¡
 = 0;

105 
íåy
->
°©s
->
cou¡îs_num
 = 
mod
->
buckës_num
;

106 
íåy
->
°©s
->
cou¡îs
 = (
oÊ_buckë_cou¡î
 **Ë
	`xmÆloc
((oÊ_buckë_cou¡î *Ë*É¡ry->°©s->
cou¡îs_num
);

107 
íåy
->
°©s
->
duøti⁄_£c
 = 0;

108 
íåy
->
°©s
->
duøti⁄_n£c
 = 0;

110 
i
=0; i<
íåy
->
°©s
->
cou¡îs_num
; i++) {

111 
íåy
->
°©s
->
cou¡îs
[
i
] = (
oÊ_buckë_cou¡î
 *Ë
	`xmÆloc
((ofl_bucket_counter));

112 
íåy
->
°©s
->
cou¡îs
[
i
]->
∑ckë_cou¡
 = 0;

113 
íåy
->
°©s
->
cou¡îs
[
i
]->
byã_cou¡
 = 0;

116 
mod
->
ty≥
) {

117 (
OFPGT_SELECT
): {

118 
	`öô_£À˘_group
(
íåy
, 
mod
);

122 
íåy
->
d©a
 = 
NULL
;

126 
	`li°_öô
(&
íåy
->
Êow_ªfs
);

128  
íåy
;

129 
	}
}

133 
	$group_íåy_de°roy
(
group_íåy
 *
íåy
) {

134 
Êow_ªf_íåy
 *
ªf
, *
√xt
;

137 
	`LIST_FOR_EACH_SAFE
(
ªf
, 
√xt
, 
Êow_ªf_íåy
, 
node
, &
íåy
->
Êow_ªfs
) {

138 
	`Êow_íåy_ªmove
(
ªf
->
íåy
, 
OFPRR_GROUP_DELETE
);

144 
	`oÊ_°ru˘s_‰ì_group_desc_°©s
(
íåy
->
desc
,É¡ry->
dp
->
exp
);

145 
	`oÊ_°ru˘s_‰ì_group_°©s
(
íåy
->
°©s
);

146 
	`‰ì
(
íåy
->
d©a
);

147 
	`‰ì
(
íåy
);

148 
	}
}

152 
	$execuã_Æl
(
group_íåy
 *
íåy
, 
∑ckë
 *
pkt
) {

153 
size_t
 
i
;

157 
i
=0; i<
íåy
->
desc
->
buckës_num
; i++) {

158 
oÊ_buckë
 *
buckë
 = 
íåy
->
desc
->
buckës
[
i
];

159 
∑ckë
 *
p
 = 
	`∑ckë_˛⁄e
(
pkt
);

161 i‡(
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

162 *
b
 = 
	`oÊ_°ru˘s_buckë_to_°rög
(
buckë
, 
íåy
->
dp
->
exp
);

163 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "Wrôög buckë: %s.", 
b
);

164 
	`‰ì
(
b
);

167 
	`a˘i⁄_£t_wrôe_a˘i⁄s
(
p
->
a˘i⁄_£t
, 
buckë
->
a˘i⁄s_num
, buckë->
a˘i⁄s
);

169 
íåy
->
°©s
->
byã_cou¡
 +
p
->
buf„r
->
size
;

170 
íåy
->
°©s
->
∑ckë_cou¡
++;

171 
íåy
->
°©s
->
cou¡îs
[
i
]->
byã_cou¡
 +
p
->
buf„r
->
size
;

172 
íåy
->
°©s
->
cou¡îs
[
i
]->
∑ckë_cou¡
++;

177 
	`a˘i⁄_£t_execuã
(
p
->
a˘i⁄_£t
,Ö, 0xffffffffffffffff);

179 
	`∑ckë_de°roy
(
p
);

181 
	}
}

185 
	$execuã_£À˘
(
group_íåy
 *
íåy
, 
∑ckë
 *
pkt
) {

186 
size_t
 
b
 = 
	`£À˘_‰om_£À˘_group
(
íåy
);

188 i‡(
b
 != -1) {

189 
oÊ_buckë
 *
buckë
 = 
íåy
->
desc
->
buckës
[
b
];

190 
∑ckë
 *
p
 = 
	`∑ckë_˛⁄e
(
pkt
);

192 i‡(
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

193 *
b
 = 
	`oÊ_°ru˘s_buckë_to_°rög
(
buckë
, 
íåy
->
dp
->
exp
);

194 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "Wrôög buckë: %s.", 
b
);

195 
	`‰ì
(
b
);

198 
	`a˘i⁄_£t_wrôe_a˘i⁄s
(
p
->
a˘i⁄_£t
, 
buckë
->
a˘i⁄s_num
, buckë->
a˘i⁄s
);

200 
íåy
->
°©s
->
byã_cou¡
 +
p
->
buf„r
->
size
;

201 
íåy
->
°©s
->
∑ckë_cou¡
++;

202 
íåy
->
°©s
->
cou¡îs
[
b
]->
byã_cou¡
 +
p
->
buf„r
->
size
;

203 
íåy
->
°©s
->
cou¡îs
[
b
]->
∑ckë_cou¡
++;

207 
	`a˘i⁄_£t_execuã
(
p
->
a˘i⁄_£t
,Ö, 0xffffffffffffffff);

208 
	`∑ckë_de°roy
(
p
);

210 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "No bucket in group.");

212 
	}
}

216 
	$execuã_ödúe˘
(
group_íåy
 *
íåy
, 
∑ckë
 *
pkt
) {

218 i‡(
íåy
->
desc
->
buckës_num
 > 0) {

219 
oÊ_buckë
 *
buckë
 = 
íåy
->
desc
->
buckës
[0];

220 
∑ckë
 *
p
 = 
	`∑ckë_˛⁄e
(
pkt
);

222 i‡(
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

223 *
b
 = 
	`oÊ_°ru˘s_buckë_to_°rög
(
buckë
, 
íåy
->
dp
->
exp
);

224 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "Wrôög buckë: %s.", 
b
);

225 
	`‰ì
(
b
);

228 
	`a˘i⁄_£t_wrôe_a˘i⁄s
(
p
->
a˘i⁄_£t
, 
buckë
->
a˘i⁄s_num
, buckë->
a˘i⁄s
);

230 
íåy
->
°©s
->
byã_cou¡
 +
p
->
buf„r
->
size
;

231 
íåy
->
°©s
->
∑ckë_cou¡
++;

232 
íåy
->
°©s
->
cou¡îs
[0]->
byã_cou¡
 +
p
->
buf„r
->
size
;

233 
íåy
->
°©s
->
cou¡îs
[0]->
∑ckë_cou¡
++;

237 
	`a˘i⁄_£t_execuã
(
p
->
a˘i⁄_£t
,Ö, 0xffffffffffffffff);

238 
	`∑ckë_de°roy
(
p
);

240 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "No bucket in group.");

242 
	}
}

246 
	$execuã_ff
(
group_íåy
 *
íåy
, 
∑ckë
 *
pkt
) {

247 
size_t
 
b
 = 
	`£À˘_‰om_ff_group
(
íåy
);

249 i‡(
b
 != -1) {

250 
oÊ_buckë
 *
buckë
 = 
íåy
->
desc
->
buckës
[
b
];

251 
∑ckë
 *
p
 = 
	`∑ckë_˛⁄e
(
pkt
);

253 i‡(
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

254 *
b
 = 
	`oÊ_°ru˘s_buckë_to_°rög
(
buckë
, 
íåy
->
dp
->
exp
);

255 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "Wrôög buckë: %s.", 
b
);

256 
	`‰ì
(
b
);

259 
	`a˘i⁄_£t_wrôe_a˘i⁄s
(
p
->
a˘i⁄_£t
, 
buckë
->
a˘i⁄s_num
, buckë->
a˘i⁄s
);

261 
íåy
->
°©s
->
byã_cou¡
 +
p
->
buf„r
->
size
;

262 
íåy
->
°©s
->
∑ckë_cou¡
++;

263 
íåy
->
°©s
->
cou¡îs
[
b
]->
byã_cou¡
 +
p
->
buf„r
->
size
;

264 
íåy
->
°©s
->
cou¡îs
[
b
]->
∑ckë_cou¡
++;

268 
	`a˘i⁄_£t_execuã
(
p
->
a˘i⁄_£t
,Ö, 0xffffffffffffffff);

269 
	`∑ckë_de°roy
(
p
);

271 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "No bucket in group.");

273 
	}
}

278 
	$group_íåy_execuã
(
group_íåy
 *
íåy
,

279 
∑ckë
 *packet) {

281 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "Executög grou∞%u.", 
íåy
->
°©s
->
group_id
);

287 
íåy
->
desc
->
ty≥
) {

288 (
OFPGT_ALL
): {

289 
	`execuã_Æl
(
íåy
, 
∑ckë
);

292 (
OFPGT_SELECT
): {

293 
	`execuã_£À˘
(
íåy
, 
∑ckë
);

296 (
OFPGT_INDIRECT
): {

297 
	`execuã_ödúe˘
(
íåy
, 
∑ckë
);

300 (
OFPGT_FF
): {

301 
	`execuã_ff
(
íåy
, 
∑ckë
);

305 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryögÅÿexecuã unknow¿grou∞ty≥ (%uËö grou∞(%u).", 
íåy
->
desc
->
ty≥
,É¡ry->
°©s
->
group_id
);

308 
	}
}

311 
	$group_íåy_upd©e
(
group_íåy
 *
íåy
){

312 
íåy
->
°©s
->
duøti⁄_£c
 = (
	`time_m£c
(Ë-É¡ry->
¸óãd
) / 1000;

313 
íåy
->
°©s
->
duøti⁄_n£c
 = ((
	`time_m£c
(Ë-É¡ry->
¸óãd
) % 1000) * 1000;

314 
	}
}

317 
boﬁ


318 
	$has_Êow_ªf
(
group_íåy
 *
íåy
, 
Êow_íåy
 *
„
) {

319 
Êow_ªf_íåy
 *
f
;

321 
	`LIST_FOR_EACH
(
f
, 
Êow_ªf_íåy
, 
node
, &
íåy
->
Êow_ªfs
) {

322 i‡(
f
->
íåy
 =
„
) {

323  
åue
;

326  
Ál£
;

327 
	}
}

329 
boﬁ


330 
	$group_íåy_has_out_group
(
group_íåy
 *
íåy
, 
uöt32_t
 
group_id
) {

331 
size_t
 
i
;

333 
i
=0; i<
íåy
->
desc
->
buckës_num
; i++) {

334 
oÊ_buckë
 *
b
 = (oÊ_buckë *)
íåy
->
desc
->
buckës
[
i
];

335 i‡(
	`dp_a˘i⁄s_li°_has_out_group
(
b
->
a˘i⁄s_num
, b->
a˘i⁄s
, 
group_id
)) {

336  
åue
;

339  
Ál£
;

340 
	}
}

343 
	$group_íåy_add_Êow_ªf
(
group_íåy
 *
íåy
, 
Êow_íåy
 *
„
) {

344 i‡(!(
	`has_Êow_ªf
(
íåy
, 
„
))) {

345 
Êow_ªf_íåy
 *
f
 = 
	`xmÆloc
((flow_ref_entry));

346 
f
->
íåy
 = 
„
;

347 
	`li°_ö£π
(&
íåy
->
Êow_ªfs
, &
f
->
node
);

348 
íåy
->
°©s
->
ªf_cou¡
++;

350 
	}
}

353 
	$group_íåy_dñ_Êow_ªf
(
group_íåy
 *
íåy
, 
Êow_íåy
 *
„
) {

354 
Êow_ªf_íåy
 *
f
, *
√xt
;

356 
	`LIST_FOR_EACH_SAFE
(
f
, 
√xt
, 
Êow_ªf_íåy
, 
node
, &
íåy
->
Êow_ªfs
) {

357 i‡(
f
->
íåy
 =
„
) {

358 
	`li°_ªmove
(&
f
->
node
);

359 
	`‰ì
(
f
);

360 
íåy
->
°©s
->
ªf_cou¡
--;

363 
	}
}

367 
boﬁ


368 
	$buckë_is_Æive
(
oÊ_buckë
 *
buckë
, 
d©≠©h
 *
dp
) {

369 
sw_p‹t
 *
p
 = 
	`dp_p‹ts_lookup
(
dp
, 
buckë
->
w©ch_p‹t
);

371 if(
buckë
->
w©ch_p‹t
 =
OFPP_ANY
 || (
p
->
c⁄f
->
c⁄fig
 & 
OFPPC_PORT_DOWN
) ||

372 (
p
->
c⁄f
->
°©e
 & 
OFPPS_LINK_DOWN
)){

373  
Ál£
;

376  
åue
;

377 
	}
}

382 
	$öô_£À˘_group
(
group_íåy
 *
íåy
, 
oÊ_msg_group_mod
 *
mod
) {

383 
group_íåy_wº_d©a
 *
d©a
;

384 
size_t
 
i
;

386 
íåy
->
d©a
 = 
	`xmÆloc
((
group_íåy_wº_d©a
));

387 
d©a
 = (
group_íåy_wº_d©a
 *)
íåy
->data;

389 
d©a
->
cuº_weight
 = 0;

390 
d©a
->
cuº_buckë
 = -1;

392 i‡(
mod
->
buckës_num
 == 0) {

393 
d©a
->
gcd_weight
 = 0;

394 
d©a
->
max_weight
 = 0;

396 
d©a
->
gcd_weight
 = 
íåy
->
desc
->
buckës
[0]->
weight
;

397 
d©a
->
max_weight
 = 
íåy
->
desc
->
buckës
[0]->
weight
;

399 
i
=1; i< 
íåy
->
desc
->
buckës_num
; i++) {

400 
d©a
->
gcd_weight
 = 
	`gcd
(d©a->gcd_weight, 
íåy
->
desc
->
buckës
[
i
]->
weight
);

401 
d©a
->
max_weight
 = 
	`MAX
(d©a->max_weight, 
íåy
->
desc
->
buckës
[
i
]->
weight
);

405 
	}
}

408 
size_t


409 
	$£À˘_‰om_£À˘_group
(
group_íåy
 *
íåy
) {

410 
group_íåy_wº_d©a
 *
d©a
;

411 
size_t
 
gu¨d
;

413 i‡(
íåy
->
desc
->
buckës_num
 == 0) {

417 
d©a
 = (
group_íåy_wº_d©a
 *)
íåy
->data;

418 
gu¨d
 = 0;

420 
gu¨d
 < 
íåy
->
desc
->
buckës_num
) {

421 
d©a
->
cuº_buckë
 = (d©a->cuº_buckë + 1Ë% 
íåy
->
desc
->
buckës_num
;

423 i‡(
d©a
->
cuº_buckë
 == 0) {

424 i‡(
d©a
->
cuº_weight
 <d©a->
gcd_weight
) {

425 
d©a
->
cuº_weight
 = d©a->
max_weight
;

427 
d©a
->
cuº_weight
 = d©a->cuº_weighà- d©a->
gcd_weight
;

431 i‡(
íåy
->
desc
->
buckës
[
d©a
->
cuº_buckë
]->
weight
 >d©a->
cuº_weight
) {

432  
d©a
->
cuº_buckë
;

434 
gu¨d
++;

436 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "CouldÇot select from select group.");

438 
	}
}

441 
size_t


442 
	$£À˘_‰om_ff_group
(
group_íåy
 *
íåy
) {

443 
size_t
 
i
;

445 
i
=0; i<
íåy
->
desc
->
buckës_num
; i++) {

446 i‡(
	`buckë_is_Æive
(
íåy
->
desc
->
buckës
[
i
],É¡ry->
dp
)) {

447  
i
;

451 
	}
}

454 
uöt16_t


455 
	$gcd
(
uöt16_t
 
a
, uöt16_à
b
) {

456 
uöt16_t
 
c
;

458 
a
 != 0) {

459 
c
 = 
a
;

460 
a
 = 
b
 %á;

461 
b
 = 
c
;

464  
b
;

465 
	}
}

	@udatapath/group_entry.h

32 #i‚de‡
GROUP_íåy_H


33 
	#GROUP_íåy_H
 1

	)

35 
	~<°dboﬁ.h
>

36 
	~"hm≠.h
"

37 
	~"∑ckë.h
"

38 
	~"group_èbÀ.h
"

39 
	~"oÊib/oÊ-°ru˘s.h
"

40 
	~"oÊib/oÊ-mesßges.h
"

48 
	g∑ckë
;

49 
	gd©≠©h
;

50 
	gÊow_íåy
;

52 
	sgroup_íåy
 {

53 
hm≠_node
 
	mnode
;

55 
d©≠©h
 *
	mdp
;

56 
group_èbÀ
 *
	mèbÀ
;

57 
oÊ_group_desc_°©s
 *
	mdesc
;

58 
oÊ_group_°©s
 *
	m°©s
;

59 
uöt64_t
 
	m¸óãd
;

60 *
	md©a
;

62 
li°
 
	mÊow_ªfs
;

65 
	g£ndî
;

66 
	ggroup_èbÀ
;

70 
group_íåy_execuã
(
group_íåy
 *
íåy
,

71 
∑ckë
 *packet);

74 
group_íåy
 *

75 
group_íåy_¸óã
(
d©≠©h
 *
dp
, 
group_èbÀ
 *
èbÀ
, 
oÊ_msg_group_mod
 *
mod
);

79 
group_íåy_de°roy
(
group_íåy
 *
íåy
);

82 
boﬁ


83 
group_íåy_has_out_group
(
group_íåy
 *
íåy
, 
uöt32_t
 
group_id
);

87 
group_íåy_add_Êow_ªf
(
group_íåy
 *
íåy
, 
Êow_íåy
 *
„
);

91 
group_íåy_dñ_Êow_ªf
(
group_íåy
 *
íåy
, 
Êow_íåy
 *
„
);

96 
group_íåy_upd©e
(
group_íåy
 *
íåy
);

	@udatapath/group_table.c

32 
	~<sys/ty≥s.h
>

33 
	~"compûî.h
"

34 
	~"group_èbÀ.h
"

35 
	~"d©≠©h.h
"

36 
	~"dp_a˘i⁄s.h
"

37 
	~"dp_ˇ∑bûôõs.h
"

38 
	~"hm≠.h
"

39 
	~"li°.h
"

40 
	~"∑ckë.h
"

41 
	~"utû.h
"

42 
	~"›íÊow/›íÊow.h
"

43 
	~"oÊib/oÊ.h
"

44 
	~"oÊib/oÊ-mesßges.h
"

46 
	~"vlog.h
"

47 
	#LOG_MODULE
 
VLM_group_t


	)

49 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(60, 60);

51 
boﬁ


52 
is_ö
(
uöt32_t
 
id
, 
li°
 *list);

55 
is_lo›_‰ì_visô
(
oÊ_buckë
 **
buckës
, 
size_t
 
buckës_num
, 
li°
 *
visôed
, li° *
to_be_visôed
);

57 
boﬁ


58 
is_lo›_‰ì
(
group_èbÀ
 *
èbÀ
, 
oÊ_msg_group_mod
 *
mod
);

61 
group_íåy
 *

62 
	$group_èbÀ_föd
(
group_èbÀ
 *
èbÀ
, 
uöt32_t
 
group_id
) {

63 
hm≠_node
 *
hnode
;

65 
hnode
 = 
	`hm≠_fú°_wôh_hash
(&
èbÀ
->
íåõs
, 
group_id
);

67 i‡(
hnode
 =
NULL
) {

68  
NULL
;

71  
	`CONTAINER_OF
(
hnode
, 
group_íåy
, 
node
);

72 
	}
}

75 
oÊ_îr


76 
	$group_èbÀ_add
(
group_èbÀ
 *
èbÀ
, 
oÊ_msg_group_mod
 *
mod
) {

78 
group_íåy
 *
íåy
;

80 i‡(
	`hm≠_fú°_wôh_hash
(&
èbÀ
->
íåõs
, 
mod
->
group_id
Ë!
NULL
) {

81  
	`oÊ_îr‹
(
OFPET_GROUP_MOD_FAILED
, 
OFPGMFC_GROUP_EXISTS
);

84 i‡(
èbÀ
->
íåõs_num
 =
GROUP_TABLE_MAX_ENTRIES
) {

85  
	`oÊ_îr‹
(
OFPET_GROUP_MOD_FAILED
, 
OFPGMFC_OUT_OF_GROUPS
);

88 i‡(
èbÀ
->
buckës_num
 + 
mod
->buckës_num > 
GROUP_TABLE_MAX_BUCKETS
) {

89  
	`oÊ_îr‹
(
OFPET_GROUP_MOD_FAILED
, 
OFPGMFC_OUT_OF_BUCKETS
);

92 
íåy
 = 
	`group_íåy_¸óã
(
èbÀ
->
dp
,ÅabÀ, 
mod
);

94 
	`hm≠_ö£π
(&
èbÀ
->
íåõs
, &
íåy
->
node
,É¡ry->
°©s
->
group_id
);

96 
èbÀ
->
íåõs_num
++;

97 
èbÀ
->
buckës_num
 +
íåy
->
desc
->buckets_num;

99 
	`oÊ_msg_‰ì_group_mod
(
mod
, 
Ál£
, 
èbÀ
->
dp
->
exp
);

101 
	}
}

104 
oÊ_îr


105 
	$group_èbÀ_modify
(
group_èbÀ
 *
èbÀ
, 
oÊ_msg_group_mod
 *
mod
) {

106 
group_íåy
 *
íåy
, *
√w_íåy
;

108 
íåy
 = 
	`group_èbÀ_föd
(
èbÀ
, 
mod
->
group_id
);

109 i‡(
íåy
 =
NULL
) {

110  
	`oÊ_îr‹
(
OFPET_GROUP_MOD_FAILED
, 
OFPGMFC_UNKNOWN_GROUP
);

113 i‡(
èbÀ
->
buckës_num
 - 
íåy
->
desc
->buckës_num + 
mod
->buckës_num > 
GROUP_TABLE_MAX_BUCKETS
) {

114  
	`oÊ_îr‹
(
OFPET_GROUP_MOD_FAILED
, 
OFPGMFC_OUT_OF_BUCKETS
);

117 i‡(!
	`is_lo›_‰ì
(
èbÀ
, 
mod
)) {

118  
	`oÊ_îr‹
(
OFPET_GROUP_MOD_FAILED
, 
OFPGMFC_LOOP
);

121 
√w_íåy
 = 
	`group_íåy_¸óã
(
èbÀ
->
dp
,ÅabÀ, 
mod
);

123 
	`hm≠_ªmove
(&
èbÀ
->
íåõs
, &
íåy
->
node
);

124 
	`hm≠_ö£π_Á°
(&
èbÀ
->
íåõs
, &
√w_íåy
->
node
, 
mod
->
group_id
);

126 
èbÀ
->
buckës_num
 =ÅabÀ->buckës_num - 
íåy
->
desc
->buckës_num + 
√w_íåy
->desc->buckets_num;

129 
	`li°_ª∂a˚
(&
√w_íåy
->
Êow_ªfs
, &
íåy
->flow_refs);

130 
	`li°_öô
(&
íåy
->
Êow_ªfs
);

132 
	`group_íåy_de°roy
(
íåy
);

134 
	`oÊ_msg_‰ì_group_mod
(
mod
, 
Ál£
, 
èbÀ
->
dp
->
exp
);

136 
	}
}

139 
oÊ_îr


140 
	$group_èbÀ_dñëe
(
group_èbÀ
 *
èbÀ
, 
oÊ_msg_group_mod
 *
mod
) {

141 i‡(
mod
->
group_id
 =
OFPG_ALL
) {

142 
group_íåy
 *
íåy
, *
√xt
;

144 
	`HMAP_FOR_EACH_SAFE
(
íåy
, 
√xt
, 
group_íåy
, 
node
, &
èbÀ
->
íåõs
) {

145 
	`group_íåy_de°roy
(
íåy
);

147 
	`hm≠_de°roy
(&
èbÀ
->
íåõs
);

148 
	`hm≠_öô
(&
èbÀ
->
íåõs
);

150 
èbÀ
->
íåõs_num
 = 0;

151 
èbÀ
->
buckës_num
 = 0;

153 
	`oÊ_msg_‰ì_group_mod
(
mod
, 
åue
, 
èbÀ
->
dp
->
exp
);

157 
group_íåy
 *
íåy
, *
e
;

159 
íåy
 = 
	`group_èbÀ_föd
(
èbÀ
, 
mod
->
group_id
);

161 i‡(
íåy
 !
NULL
) {

165 
	`HMAP_FOR_EACH
(
e
, 
group_íåy
, 
node
, &
èbÀ
->
íåõs
) {

166 i‡(
	`group_íåy_has_out_group
(
e
, 
íåy
->
°©s
->
group_id
)) {

167  
	`oÊ_îr‹
(
OFPET_GROUP_MOD_FAILED
, 
OFPGMFC_CHAINING_UNSUPPORTED
);

171 
èbÀ
->
íåõs_num
--;

172 
èbÀ
->
buckës_num
 -
íåy
->
desc
->buckets_num;

174 
	`hm≠_ªmove
(&
èbÀ
->
íåõs
, &
íåy
->
node
);

175 
	`group_íåy_de°roy
(
íåy
);

180 
	`oÊ_msg_‰ì_group_mod
(
mod
, 
åue
, 
èbÀ
->
dp
->
exp
);

183 
	}
}

185 
oÊ_îr


186 
	$group_èbÀ_h™dÀ_group_mod
(
group_èbÀ
 *
èbÀ
, 
oÊ_msg_group_mod
 *
mod
,

187 c⁄° 
£ndî
 *sender) {

188 
oÊ_îr
 
îr‹
;

189 
size_t
 
i
;

191 if(
£ndî
->
ªmŸe
->
rﬁe
 =
OFPCR_ROLE_SLAVE
)

192  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_IS_SLAVE
);

194 
i
=0; i< 
mod
->
buckës_num
; i++) {

195 
îr‹
 = 
	`dp_a˘i⁄s_vÆid©e
(
èbÀ
->
dp
, 
mod
->
buckës
[
i
]->
a˘i⁄s_num
, mod->buckës[i]->
a˘i⁄s
);

196 i‡(
îr‹
) {

197  
îr‹
;

201 
mod
->
comm™d
) {

202 (
OFPGC_ADD
): {

203  
	`group_èbÀ_add
(
èbÀ
, 
mod
);

205 (
OFPGC_MODIFY
): {

206  
	`group_èbÀ_modify
(
èbÀ
, 
mod
);

208 (
OFPGC_DELETE
): {

209  
	`group_èbÀ_dñëe
(
èbÀ
, 
mod
);

212  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_TYPE
);

215 
	}
}

217 
oÊ_îr


218 
	$group_èbÀ_h™dÀ_°©s_ªque°_group
(
group_èbÀ
 *
èbÀ
,

219 
oÊ_msg_mu…ù¨t_ªque°_group
 *
msg
,

220 c⁄° 
£ndî
 *£ndî 
UNUSED
) {

221 
group_íåy
 *
íåy
;

223 i‡(
msg
->
group_id
 =
OFPG_ALL
) {

224 
íåy
 = 
NULL
;

226 
íåy
 = 
	`group_èbÀ_föd
(
èbÀ
, 
msg
->
group_id
);

228 i‡(
íåy
 =
NULL
) {

229  
	`oÊ_îr‹
(
OFPET_GROUP_MOD_FAILED
, 
OFPGMFC_UNKNOWN_GROUP
);

234 
oÊ_msg_mu…ù¨t_ª∂y_group
 
ª∂y
 =

235 {{{.
ty≥
 = 
OFPT_MULTIPART_REPLY
},

236 .
ty≥
 = 
OFPMP_GROUP
, .
Êags
 = 0x0000},

237 .
°©s_num
 = 
msg
->
group_id
 =
OFPG_ALL
 ? 
èbÀ
->
íåõs_num
 : 1,

238 .
°©s
 = 
	`xmÆloc
((
oÊ_group_°©s
 *Ë* (
msg
->
group_id
 =
OFPG_ALL
 ? 
èbÀ
->
íåõs_num
 : 1))

241 i‡(
msg
->
group_id
 =
OFPG_ALL
) {

242 
group_íåy
 *
e
;

243 
size_t
 
i
 = 0;

245 
	`HMAP_FOR_EACH
(
e
, 
group_íåy
, 
node
, &
èbÀ
->
íåõs
) {

246 
	`group_íåy_upd©e
(
e
);

247 
ª∂y
.
°©s
[
i
] = 
e
->stats;

248 
i
++;

252 
	`group_íåy_upd©e
(
íåy
);

253 
ª∂y
.
°©s
[0] = 
íåy
->stats;

256 
	`dp_£nd_mesßge
(
èbÀ
->
dp
, (
oÊ_msg_hódî
 *)&
ª∂y
, 
£ndî
);

258 
	`‰ì
(
ª∂y
.
°©s
);

259 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
èbÀ
->
dp
->
exp
);

262 
	}
}

264 
oÊ_îr


265 
	$group_èbÀ_h™dÀ_°©s_ªque°_group_desc
(
group_èbÀ
 *
èbÀ
,

266 
oÊ_msg_mu…ù¨t_ªque°_hódî
 *
msg
 
UNUSED
,

267 c⁄° 
£ndî
 *sender) {

268 
group_íåy
 *
íåy
;

269 
size_t
 
i
 = 0;

271 
oÊ_msg_mu…ù¨t_ª∂y_group_desc
 
ª∂y
 =

272 {{{.
ty≥
 = 
OFPT_MULTIPART_REPLY
},

273 .
ty≥
 = 
OFPMP_GROUP_DESC
, .
Êags
 = 0x0000},

274 .
°©s_num
 = 
èbÀ
->
íåõs_num
,

275 .
°©s
 = 
	`xmÆloc
((
oÊ_group_desc_°©s
 *Ë* 
èbÀ
->
íåõs_num
)

278 
	`HMAP_FOR_EACH
(
íåy
, 
group_íåy
, 
node
, &
èbÀ
->
íåõs
) {

279 
ª∂y
.
°©s
[
i
] = 
íåy
->
desc
;

280 
i
++;

282 
	`dp_£nd_mesßge
(
èbÀ
->
dp
, (
oÊ_msg_hódî
 *)&
ª∂y
, 
£ndî
);

284 
	`‰ì
(
ª∂y
.
°©s
);

285 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
èbÀ
->
dp
->
exp
);

287 
	}
}

289 
oÊ_îr


290 
	$group_èbÀ_h™dÀ_°©s_ªque°_group_„©uªs
(
group_èbÀ
 *
èbÀ
,

291 
oÊ_msg_mu…ù¨t_ªque°_hódî
 *
msg
 
UNUSED
,

292 c⁄° 
£ndî
 *sender) {

293 
size_t
 
i
 = 0;

295 
oÊ_msg_mu…ù¨t_ª∂y_group_„©uªs
 
ª∂y
 =

296 {{{.
ty≥
 = 
OFPT_MULTIPART_REPLY
},

297 .
ty≥
 = 
OFPMP_GROUP_FEATURES
, .
Êags
 = 0x0000},

298 .
ty≥s
 = 
èbÀ
->
„©uªs
->types,

299 .
ˇ∑bûôõs
 = 
èbÀ
->
„©uªs
->capabilities

302 
i
 = 0; i < 4; i++){

303 
ª∂y
.
max_groups
[
i
] = 
èbÀ
->
„©uªs
->max_groups[i];

304 
ª∂y
.
a˘i⁄s
[
i
] = 
èbÀ
->
„©uªs
->actions[i];

307 
	`dp_£nd_mesßge
(
èbÀ
->
dp
, (
oÊ_msg_hódî
 *)&
ª∂y
, 
£ndî
);

309 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
èbÀ
->
dp
->
exp
);

311 
	}
}

314 
	$group_èbÀ_execuã
(
group_èbÀ
 *
èbÀ
, 
∑ckë
 *∑ckë, 
uöt32_t
 
group_id
) {

315 
group_íåy
 *
íåy
;

317 
íåy
 = 
	`group_èbÀ_föd
(
èbÀ
, 
group_id
);

319 i‡(
íåy
 =
NULL
) {

320 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryögÅÿexecuãÇ⁄-exi°ög grou∞(%u).", 
group_id
);

324 
	`group_íåy_execuã
(
íåy
, 
∑ckë
);

325 
	}
}

327 
group_èbÀ
 *

328 
	$group_èbÀ_¸óã
(
d©≠©h
 *
dp
) {

329 
group_èbÀ
 *
èbÀ
;

330 
size_t
 
i
;

332 
èbÀ
 = 
	`xmÆloc
((
group_èbÀ
));

333 
èbÀ
->
dp
 = dp;

335 
èbÀ
->
„©uªs
 = (
oÊ_msg_mu…ù¨t_ª∂y_group_„©uªs
*Ë
	`xmÆloc
((ofl_msg_multipart_reply_group_features));

336 
èbÀ
->
„©uªs
->
ty≥s
 = 
DP_SUPPORTED_GROUPS
;

337 
èbÀ
->
„©uªs
->
ˇ∑bûôõs
 = 
DP_SUPPORTED_GROUP_CAPABILITIES
;

338 
i
 = 0; i < 4; i++){

339 
èbÀ
->
„©uªs
->
max_groups
[
i
] = 255;

340 
èbÀ
->
„©uªs
->
a˘i⁄s
[
i
] = 
DP_SUPPORTED_ACTIONS
;

342 
èbÀ
->
íåõs_num
 = 0;

343 
	`hm≠_öô
(&
èbÀ
->
íåõs
);

344 
èbÀ
->
buckës_num
 = 0;

346  
èbÀ
;

347 
	}
}

350 
	$group_èbÀ_de°roy
(
group_èbÀ
 *
èbÀ
) {

351 
group_íåy
 *
íåy
, *
√xt
;

353 
	`HMAP_FOR_EACH_SAFE
(
íåy
, 
√xt
, 
group_íåy
, 
node
, &
èbÀ
->
íåõs
) {

354 
	`group_íåy_de°roy
(
íåy
);

357 
	`‰ì
(
èbÀ
);

358 
	}
}

361 
	sgroup_visô
 {

362 
li°
 
	mnode
;

363 
uöt32_t
 
	mgroup_id
;

366 
boﬁ


367 
	$is_ö
(
uöt32_t
 
id
, 
li°
 *list) {

368 
group_visô
 *
gv
;

370 
	`LIST_FOR_EACH
(
gv
, 
group_visô
, 
node
, 
li°
) {

371 i‡(
gv
->
group_id
 =
id
) {

372  
åue
;

375  
Ál£
;

376 
	}
}

379 
	$is_lo›_‰ì_visô
(
oÊ_buckë
 **
buckës
, 
size_t
 
buckës_num
, 
li°
 *
visôed
, li° *
to_be_visôed
) {

380 
size_t
 
ib
;

381 
ib
=0; ib<
buckës_num
; ib++) {

382 
size_t
 
ü
;

384 
ü
=0; ia<
buckës
[
ib
]->
a˘i⁄s_num
; ia++) {

385 i‡(
buckës
[
ib
]->
a˘i⁄s
[
ü
]->
ty≥
 =
OFPAT_GROUP
) {

386 
oÊ_a˘i⁄_group
 *
a˘
 = (oÊ_a˘i⁄_grou∞*Ë
buckës
[
ib
]->
a˘i⁄s
[
ü
];

387 i‡(!
	`is_ö
(
a˘
->
group_id
, 
visôed
) &&

388 !
	`is_ö
(
a˘
->
group_id
, 
to_be_visôed
)) {

389 
group_visô
 *
gv
 = 
	`xmÆloc
((group_visit));

391 
gv
->
group_id
 = 
a˘
->group_id;

392 
	`li°_ö£π
(
to_be_visôed
, &(
gv
->
node
));

399 
	}
}

402 
boﬁ


403 
	$is_lo›_‰ì
(
group_èbÀ
 *
èbÀ
, 
oÊ_msg_group_mod
 *
mod
) {

409 
li°
 
visôed
, 
to_be_visôed
;

410 
boﬁ
 
lo›_‰ì
;

411 
group_visô
 *
gv
, *
gvn
;

413 
	`li°_öô
(&
visôed
);

414 
	`li°_öô
(&
to_be_visôed
);

416 
	`is_lo›_‰ì_visô
(
mod
->
buckës
, mod->
buckës_num
, &
visôed
, &
to_be_visôed
);

418 !
	`li°_is_em±y
(&
to_be_visôed
)) {

419 
group_íåy
 *
íåy
;

422 i‡(
	`is_ö
(
mod
->
group_id
, &
to_be_visôed
)) {

426 
gv
 = 
	`CONTAINER_OF
(
	`li°_p›_‰⁄t
(&
to_be_visôed
), 
group_visô
, 
node
);

428 
íåy
 = 
	`group_èbÀ_föd
(
èbÀ
, 
gv
->
group_id
);

429 i‡(
íåy
 !
NULL
) {

430 
	`is_lo›_‰ì_visô
(
íåy
->
desc
->
buckës
,É¡ry->desc->
buckës_num
, &
visôed
, &
to_be_visôed
);

432 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "is_lo›_‰ì c™nŸ föd grou∞(%u).", 
gv
->
group_id
);

435 
	`li°_ö£π
(&
visôed
, &(
gv
->
node
));

438 
lo›_‰ì
 = 
	`li°_is_em±y
(&
to_be_visôed
);

441 
	`LIST_FOR_EACH_SAFE
(
gv
, 
gvn
, 
group_visô
, 
node
, &
visôed
) {

442 
	`‰ì
(
gv
);

444 
	`LIST_FOR_EACH_SAFE
(
gv
, 
gvn
, 
group_visô
, 
node
, &
to_be_visôed
) {

445 
	`‰ì
(
gv
);

449  
lo›_‰ì
;

450 
	}
}

	@udatapath/group_table.h

32 #i‚de‡
GROUP_TABLE_H


33 
	#GROUP_TABLE_H
 1

	)

35 
	~"d©≠©h.h
"

36 
	~"group_íåy.h
"

37 
	~"oÊib/oÊ.h
"

38 
	~"oÊib/oÊ-mesßges.h
"

39 
	~"∑ckë.h
"

47 
	#GROUP_TABLE_MAX_ENTRIES
 4096

	)

48 
	#GROUP_TABLE_MAX_BUCKETS
 8192

	)

50 
	gd©≠©h
;

51 
	g∑ckë
;

52 
	g£ndî
;

54 
	sgroup_èbÀ
 {

55 
d©≠©h
 *
	mdp
;

56 
oÊ_msg_mu…ù¨t_ª∂y_group_„©uªs
 *
	m„©uªs
;

57 
size_t
 
	míåõs_num
;

58 
hm≠
 
	míåõs
;

59 
size_t
 
	mbuckës_num
;

64 
oÊ_îr


65 
group_èbÀ_h™dÀ_group_mod
(
group_èbÀ
 *
èbÀ
, 
oÊ_msg_group_mod
 *
mod
, c⁄° 
£ndî
 *sender);

68 
oÊ_îr


69 
group_èbÀ_h™dÀ_°©s_ªque°_group
(
group_èbÀ
 *
èbÀ
,

70 
oÊ_msg_mu…ù¨t_ªque°_group
 *
msg
,

71 c⁄° 
£ndî
 *sender);

74 
oÊ_îr


75 
group_èbÀ_h™dÀ_°©s_ªque°_group_desc
(
group_èbÀ
 *
èbÀ
,

76 
oÊ_msg_mu…ù¨t_ªque°_hódî
 *
msg
,

77 c⁄° 
£ndî
 *sender);

80 
oÊ_îr


81 
group_èbÀ_h™dÀ_°©s_ªque°_group_„©uªs
(
group_èbÀ
 *
èbÀ
,

82 
oÊ_msg_mu…ù¨t_ªque°_hódî
 *
msg
 
UNUSED
,

83 c⁄° 
£ndî
 *sender);

86 
group_íåy
 *

87 
group_èbÀ_föd
(
group_èbÀ
 *
èbÀ
, 
uöt32_t
 
group_id
);

91 
group_èbÀ_execuã
(
group_èbÀ
 *
èbÀ
, 
∑ckë
 *∑ckë, 
uöt32_t
 
group_id
);

94 
group_èbÀ
 *

95 
group_èbÀ_¸óã
(
d©≠©h
 *
dp
);

99 
group_èbÀ_de°roy
(
group_èbÀ
 *
èbÀ
);

	@udatapath/match_std.c

32 
	~<°dboﬁ.h
>

33 
	~<°rög.h
>

34 
	~"lib/hash.h
"

35 
	~"oÊib/oxm-m©ch.h
"

36 
	~"m©ch_°d.h
"

39 
ölöe
 
boﬁ


40 
	$m©ch_8
(
uöt8_t
 *
a
, uöt8_à*
b
) {

41  (*
a
 =*
b
);

42 
	}
}

45 
ölöe
 
boﬁ


46 
	$m©ch_mask8
(
uöt8_t
 *
a
, uöt8_à*
am
, uöt8_à*
b
) {

47  ((~(
am
[0]Ë& (
a
[0] ^ 
b
[0])) == 0);

48 
	}
}

51 
ölöe
 
boﬁ


52 
	$m©ch_16
(
uöt8_t
 *
a
, uöt8_à*
b
) {

53 
uöt16_t
 *
a1
 = (uöt16_à*Ë
a
;

54 
uöt16_t
 *
b1
 = (uöt16_à*Ë
b
;

55  (*
a1
 =*
b1
);

56 
	}
}

59 
ölöe
 
boﬁ


60 
	$m©ch_mask16
(
uöt8_t
 *
a
, uöt8_à*
am
, uöt8_à*
b
) {

61 
uöt16_t
 *
a1
 = (uöt16_à*Ë
a
;

62 
uöt16_t
 *
b1
 = (uöt16_à*Ë
b
;

63 
uöt16_t
 *
mask
 = (uöt16_à*Ë
am
;

65  (((~*
mask
Ë& (*
a1
 ^ *
b1
)) == 0);

66 
	}
}

69 
ölöe
 
boﬁ


70 
	$m©ch_32
(
uöt8_t
 *
a
, uöt8_à*
b
) {

71 
uöt32_t
 *
a1
 = (uöt32_à*Ë
a
;

72 
uöt32_t
 *
b1
 = (uöt32_à*Ë
b
;

74  (*
a1
 =*
b1
);

75 
	}
}

78 
ölöe
 
boﬁ


79 
	$m©ch_mask32
(
uöt8_t
 *
a
, uöt8_à*
am
, uöt8_à*
b
) {

80 
uöt32_t
 *
a1
 = (uöt32_à*Ë
a
;

81 
uöt32_t
 *
b1
 = (uöt32_à*Ë
b
;

82 
uöt32_t
 *
mask
 = (uöt32_à*Ë
am
;

84  (((~*
mask
Ë& (*
a1
 ^ *
b1
)) == 0);

85 
	}
}

88 
ölöe
 
boﬁ


89 
	$m©ch_48
(
uöt8_t
 *
a
, uöt8_à*
b
) {

90  (
	`m©ch_32
(
a
, 
b
) &&

91 
	`m©ch_16
(
a
+4, 
b
+4));

92 
	}
}

95 
ölöe
 
boﬁ


96 
	$m©ch_mask48
(
uöt8_t
 *
a
, uöt8_à*
am
, uöt8_à*
b
) {

97  (
	`m©ch_mask32
(
a
, 
am
, 
b
) &&

98 
	`m©ch_mask16
(
a
+4, 
am
+4, 
b
+4));

99 
	}
}

102 
ölöe
 
boﬁ


103 
	$m©ch_64
(
uöt8_t
 *
a
, uöt8_à*
b
) {

104 
uöt64_t
 *
a1
 = (uöt64_à*Ë
a
;

105 
uöt64_t
 *
b1
 = (uöt64_à*Ë
b
;

107  (*
a1
 =*
b1
);

108 
	}
}

111 
ölöe
 
boﬁ


112 
	$m©ch_mask64
(
uöt8_t
 *
a
, uöt8_à*
am
, uöt8_à*
b
) {

113 
uöt64_t
 *
a1
 = (uöt64_à*Ë
a
;

114 
uöt64_t
 *
b1
 = (uöt64_à*Ë
b
;

115 
uöt64_t
 *
mask
 = (uöt64_à*Ë
am
;

117  (((~*
mask
Ë& (*
a1
 ^ *
b1
)) == 0);

118 
	}
}

121 
ölöe
 
boﬁ


122 
	$m©ch_128
(
uöt8_t
 *
a
, uöt8_à*
b
) {

123  (
	`m©ch_64
(
a
, 
b
) &&

124 
	`m©ch_64
(
a
+8, 
b
+8));

125 
	}
}

128 
ölöe
 
boﬁ


129 
	$m©ch_mask128
(
uöt8_t
 *
a
, uöt8_à*
am
, uöt8_à*
b
) {

130  (
	`m©ch_mask64
(
a
, 
am
, 
b
) &&

131 
	`m©ch_mask64
(
a
+8, 
am
+8, 
b
+8));

132 
	}
}

136 
boﬁ


137 
	$∑ckë_m©ch
(
oÊ_m©ch
 *
Êow_m©ch
, oÊ_m©ch *
∑ckë
){

139 
oÊ_m©ch_év
 *
f
;

140 
oÊ_m©ch_év
 *
∑ckë_f
;

141 
boﬁ
 
has_mask
;

142 
fõld_Àn
;

143 
∑ckë_hódî
;

144 
uöt8_t
 *
Êow_vÆ
, *
Êow_mask

NULL
;

145 
uöt8_t
 *
∑ckë_vÆ
;

147 i‡(
Êow_m©ch
->
hódî
.
Àngth
 == 0){

148  
åue
;

152 
	`HMAP_FOR_EACH
(
f
, 
oÊ_m©ch_év
, 
hm≠_node
, &
Êow_m©ch
->
m©ch_fõlds
)

155 
has_mask
 = 
	`OXM_HASMASK
(
f
->
hódî
);

156 
fõld_Àn
 = 
	`OXM_LENGTH
(
f
->
hódî
);

157 
∑ckë_hódî
 = 
f
->
hódî
;

158 
Êow_vÆ
 = 
f
->
vÆue
;

159 i‡(
has_mask
) {

161 
fõld_Àn
 /= 2;

162 
∑ckë_hódî
 &= 0xfffffe00;

163 
∑ckë_hódî
 |
fõld_Àn
;

164 
Êow_mask
 = 
f
->
vÆue
 + 
fõld_Àn
;

167 *
f_°r
 = 
	`oÊ_°ru˘s_oxm_év_to_°rög
(
f
);

168 
	`‰ì
(
f_°r
);

171 
∑ckë_f
 = 
	`oxm_m©ch_lookup
(
∑ckë_hódî
, 
∑ckë
);

172 i‡(!
∑ckë_f
) {

173 i‡(
f
->
hódî
==
OXM_OF_VLAN_VID
 &&

174 *((
uöt16_t
 *Ë
f
->
vÆue
)==
OFPVID_NONE
) {

178  
Ál£
;

182 
∑ckë_vÆ
 = 
∑ckë_f
->
vÆue
;

183 
fõld_Àn
) {

185 i‡(
has_mask
) {

186 i‡(!
	`m©ch_mask8
(
Êow_vÆ
, 
Êow_mask
, 
∑ckë_vÆ
))

187  
Ál£
;

190 i‡(!
	`m©ch_8
(
Êow_vÆ
, 
∑ckë_vÆ
))

191  
Ál£
;

195 
∑ckë_hódî
) {

196 
OXM_OF_VLAN_VID
: {

198 
uöt16_t
 *
Êow_vœn_id
 = (uöt16_t*Ë
Êow_vÆ
;

199 i‡(*
Êow_vœn_id
 =
OFPVID_NONE
) {

201  
Ál£
;

202 } i‡(*
Êow_vœn_id
 =
OFPVID_PRESENT
) {

206 *
Êow_vœn_id
 &
VLAN_VID_MASK
;

207 i‡(!
	`m©ch_16
(
Êow_vÆ
, 
∑ckë_vÆ
))

208  
Ál£
;

212 
OXM_OF_IPV6_EXTHDR
: {

214 
uöt16_t
 
Êow_eh
 = *((uöt16_à*Ë
Êow_vÆ
);

215 
uöt16_t
 
∑ckë_eh
 = *((uöt16_à*Ë
∑ckë_vÆ
);

216 i‡((
Êow_eh
 & 
∑ckë_eh
) != flow_eh) {

218  
Ál£
;

223 i‡(
has_mask
) {

224 i‡(!
	`m©ch_mask16
(
Êow_vÆ
, 
Êow_mask
, 
∑ckë_vÆ
))

225  
Ál£
;

228 i‡(!
	`m©ch_16
(
Êow_vÆ
, 
∑ckë_vÆ
))

229  
Ál£
;

235 i‡(
has_mask
) {

236 i‡(!
	`m©ch_mask32
(
Êow_vÆ
, 
Êow_mask
, 
∑ckë_vÆ
))

237  
Ál£
;

240 i‡(!
	`m©ch_32
(
Êow_vÆ
, 
∑ckë_vÆ
))

241  
Ál£
;

245 i‡(
has_mask
) {

246 i‡(!
	`m©ch_mask48
(
Êow_vÆ
, 
Êow_mask
, 
∑ckë_vÆ
))

247  
Ál£
;

250 i‡(!
	`m©ch_48
(
Êow_vÆ
, 
∑ckë_vÆ
))

251  
Ál£
;

255 i‡(
has_mask
) {

256 i‡(!
	`m©ch_mask64
(
Êow_vÆ
, 
Êow_mask
, 
∑ckë_vÆ
))

257  
Ál£
;

260 i‡(!
	`m©ch_64
(
Êow_vÆ
, 
∑ckë_vÆ
))

261  
Ál£
;

265 i‡(
has_mask
) {

266 i‡(!
	`m©ch_mask128
(
Êow_vÆ
, 
Êow_mask
, 
∑ckë_vÆ
))

267  
Ál£
;

270 i‡(!
	`m©ch_128
(
Êow_vÆ
, 
∑ckë_vÆ
))

271  
Ál£
;

280  
åue
;

281 
	}
}

284 
ölöe
 
boﬁ


285 
	$°ri˘_mask8
(
uöt8_t
 *
a
, uöt8_à*
b
, uöt8_à*
am
, uöt8_à*
bm
) {

286  ((
am
[0] =
bm
[0]Ë&& ((
a
[0] ^ 
b
[0]) & ~am[0])) == 0;

287 
	}
}

289 
ölöe
 
boﬁ


290 
	$°ri˘_mask16
(
uöt8_t
 *
a
, uöt8_à*
b
, uöt8_à*
am
, uöt8_à*
bm
) {

291 
uöt16_t
 *
a1
 = (uöt16_à*Ë
a
;

292 
uöt16_t
 *
b1
 = (uöt16_à*Ë
b
;

293 
uöt16_t
 *
mask_a
 = (uöt16_à*Ë
am
;

294 
uöt16_t
 *
mask_b
 = (uöt16_à*Ë
bm
;

295  ((*
mask_a
 =*
mask_b
Ë&& ((*
a1
 ^ *
b1
) & ~(*mask_a))) == 0;

296 
	}
}

298 
ölöe
 
boﬁ


299 
	$°ri˘_mask32
(
uöt8_t
 *
a
, uöt8_à*
b
, uöt8_à*
am
, uöt8_à*
bm
) {

300 
uöt32_t
 *
a1
 = (uöt32_à*Ë
a
;

301 
uöt32_t
 *
b1
 = (uöt32_à*Ë
b
;

302 
uöt32_t
 *
mask_a
 = (uöt32_à*Ë
am
;

303 
uöt32_t
 *
mask_b
 = (uöt32_à*Ë
bm
;

304  ((*
mask_a
 =*
mask_b
Ë&& ((*
a1
 ^ *
b1
) & ~(*mask_a))) == 0;

305 
	}
}

307 
ölöe
 
boﬁ


308 
	$°ri˘_mask48
(
uöt8_t
 *
a
, uöt8_à*
b
, uöt8_à*
am
, uöt8_à*
bm
) {

309  
	`°ri˘_mask32
(
a
, 
b
, 
am
, 
bm
) &&

310 
	`°ri˘_mask16
(
a
+4, 
b
+4, 
am
+4, 
bm
+4);

311 
	}
}

313 
ölöe
 
boﬁ


314 
	$°ri˘_mask64
(
uöt8_t
 *
a
, uöt8_à*
b
, uöt8_à*
am
, uöt8_à*
bm
) {

315 
uöt64_t
 *
a1
 = (uöt64_à*Ë
a
;

316 
uöt64_t
 *
b1
 = (uöt64_à*Ë
b
;

317 
uöt64_t
 *
mask_a
 = (uöt64_à*Ë
am
;

318 
uöt64_t
 *
mask_b
 = (uöt64_à*Ë
bm
;

319  ((*
mask_a
 =*
mask_b
Ë&& ((*
a1
 ^ *
b1
) & ~(*mask_a))) == 0;

320 
	}
}

322 
ölöe
 
boﬁ


323 
	$°ri˘_mask128
(
uöt8_t
 *
a
, uöt8_à*
b
, uöt8_à*
am
, uöt8_à*
bm
) {

324  
	`°ri˘_mask64
(
a
, 
b
, 
am
, 
bm
) &&

325 
	`°ri˘_mask64
(
a
+8, 
b
+8, 
am
+8, 
bm
+8);

327 
	}
}

336 
boﬁ


337 
	$m©ch_°d_°ri˘
(
oÊ_m©ch
 *
a
, oÊ_m©ch *
b
) {

339 
oÊ_m©ch_év
 *
Êow_mod_m©ch
;

340 
oÊ_m©ch_év
 *
Êow_íåy_m©ch
;

341 
fõld_Àn
;

342 
uöt8_t
 *
Êow_mod_vÆ
, *
Êow_mod_mask
=0;

343 
uöt8_t
 *
Êow_íåy_vÆ
, *
Êow_íåy_mask
=0;

344 
boﬁ
 
has_mask
;

347 if(!
a
->
hódî
.
Àngth
 && !
b
->header.length )

348  
åue
;

351 i‡(
a
->
hódî
.
Àngth
 !
b
->header.length)

352  
Ál£
;

355 
	`HMAP_FOR_EACH
(
Êow_mod_m©ch
, 
oÊ_m©ch_év
, 
hm≠_node
, &
a
->
m©ch_fõlds
)

358 
Êow_íåy_m©ch
 = 
	`oxm_m©ch_lookup
(
Êow_mod_m©ch
->
hódî
, 
b
);

359 i‡(!
Êow_íåy_m©ch
) {

360  
Ál£
;

364 
has_mask
 = 
	`OXM_HASMASK
(
Êow_mod_m©ch
->
hódî
);

365 
fõld_Àn
 = 
	`OXM_LENGTH
(
Êow_mod_m©ch
->
hódî
);

366 
Êow_mod_vÆ
 = 
Êow_mod_m©ch
->
vÆue
;

367 
Êow_íåy_vÆ
 = 
Êow_íåy_m©ch
->
vÆue
;

368 i‡(
has_mask
)

370 
fõld_Àn
 /= 2;

371 
Êow_mod_mask
 = 
Êow_mod_m©ch
->
vÆue
 + 
fõld_Àn
;

372 
Êow_íåy_mask
 = 
Êow_íåy_m©ch
->
vÆue
 + 
fõld_Àn
;

374 
fõld_Àn
) {

376 i‡(
has_mask
) {

377 i‡(!
	`°ri˘_mask8
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
, 
Êow_mod_mask
, 
Êow_íåy_mask
))

378  
Ál£
;

381 i‡(!
	`m©ch_8
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
))

382  
Ál£
;

386 i‡(
has_mask
) {

387 i‡(!
	`°ri˘_mask16
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
, 
Êow_mod_mask
, 
Êow_íåy_mask
))

388  
Ál£
;

391 i‡(!
	`m©ch_16
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
))

392  
Ál£
;

396 i‡(
has_mask
) {

397 i‡(!
	`°ri˘_mask32
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
, 
Êow_mod_mask
, 
Êow_íåy_mask
))

398  
Ál£
;

401 i‡(!
	`m©ch_32
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
))

402  
Ál£
;

406 i‡(
has_mask
) {

407 i‡(!
	`°ri˘_mask48
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
, 
Êow_mod_mask
, 
Êow_íåy_mask
))

408  
Ál£
;

411 i‡(!
	`m©ch_48
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
))

412  
Ál£
;

416 i‡(
has_mask
) {

417 i‡(!
	`°ri˘_mask64
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
, 
Êow_mod_mask
, 
Êow_íåy_mask
))

418  
Ál£
;

421 i‡(!
	`m©ch_64
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
))

422  
Ál£
;

426 i‡(
has_mask
) {

427 i‡(!
	`°ri˘_mask128
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
, 
Êow_mod_mask
, 
Êow_íåy_mask
))

428  
Ál£
;

431 i‡(!
	`m©ch_128
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
))

432  
Ál£
;

444  
åue
;

445 
	}
}

448 
ölöe
 
boﬁ


449 
	$n⁄°ri˘_mask8
(
uöt8_t
 *
a
, uöt8_à*
b
, uöt8_à*
am
, uöt8_à*
bm
) {

451  (~
am
[0] & (~
a
[0] | ~
b
[0] | 
bm
[0]) & (a[0] | b[0] | bm[0])) == 0;

452 
	}
}

454 
ölöe
 
boﬁ


455 
	$n⁄°ri˘_mask16
(
uöt8_t
 *
a
, uöt8_à*
b
, uöt8_à*
am
, uöt8_à*
bm
) {

456 
uöt16_t
 *
a1
 = (uöt16_à*Ë
a
;

457 
uöt16_t
 *
b1
 = (uöt16_à*Ë
b
;

458 
uöt16_t
 *
mask_a
 = (uöt16_à*Ë
am
;

459 
uöt16_t
 *
mask_b
 = (uöt16_à*Ë
bm
;

460  (~(*
mask_a
Ë& (~(*
a1
Ë| ~(*
b1
Ë| *
mask_b
) & (*a1| *b1 | *mask_b)) == 0;

461 
	}
}

463 
ölöe
 
boﬁ


464 
	$n⁄°ri˘_mask32
(
uöt8_t
 *
a
, uöt8_à*
b
, uöt8_à*
am
, uöt8_à*
bm
) {

465 
uöt32_t
 *
a1
 = (uöt32_à*Ë
a
;

466 
uöt32_t
 *
b1
 = (uöt32_à*Ë
b
;

467 
uöt32_t
 *
mask_a
 = (uöt32_à*Ë
am
;

468 
uöt32_t
 *
mask_b
 = (uöt32_à*Ë
bm
;

469  (~(*
mask_a
Ë& (~(*
a1
Ë| ~(*
b1
Ë| *
mask_b
) & (*a1| *b1 | *mask_b)) == 0;

470 
	}
}

472 
ölöe
 
boﬁ


473 
	$n⁄°ri˘_mask48
(
uöt8_t
 *
a
, uöt8_à*
b
, uöt8_à*
am
, uöt8_à*
bm
) {

474  
	`n⁄°ri˘_mask32
(
a
, 
b
, 
am
, 
bm
) &&

475 
	`n⁄°ri˘_mask16
(
a
+4, 
b
+4, 
am
+4, 
bm
+4);

476 
	}
}

478 
ölöe
 
boﬁ


479 
	$n⁄°ri˘_mask64
(
uöt8_t
 *
a
, uöt8_à*
b
, uöt8_à*
am
, uöt8_à*
bm
) {

480 
uöt64_t
 *
a1
 = (uöt64_à*Ë
a
;

481 
uöt64_t
 *
b1
 = (uöt64_à*Ë
b
;

482 
uöt64_t
 *
mask_a
 = (uöt64_à*Ë
am
;

483 
uöt64_t
 *
mask_b
 = (uöt64_à*Ë
bm
;

484  (~(*
mask_a
Ë& (~(*
a1
Ë| ~(*
b1
Ë| *
mask_b
) & (*a1| *b1 | *mask_b)) == 0;

485 
	}
}

487 
ölöe
 
boﬁ


488 
	$n⁄°ri˘_mask128
(
uöt8_t
 *
a
, uöt8_à*
b
, uöt8_à*
am
, uöt8_à*
bm
) {

489  
	`n⁄°ri˘_mask64
(
a
, 
b
, 
am
, 
bm
) &&

490 
	`n⁄°ri˘_mask64
(
a
+8, 
b
+8, 
am
+8, 
bm
+8);

491 
	}
}

502 
boﬁ


503 
	$m©ch_°d_n⁄°ri˘
(
oÊ_m©ch
 *
a
, oÊ_m©ch *
b
)

505 
oÊ_m©ch_év
 *
Êow_mod_m©ch
;

506 
oÊ_m©ch_év
 *
Êow_íåy_m©ch
;

507 
fõld_Àn
;

508 
uöt8_t
 *
Êow_mod_vÆ
, *
Êow_mod_mask
=0;

509 
uöt8_t
 *
Êow_íåy_vÆ
, *
Êow_íåy_mask
=0;

510 
boﬁ
 
has_mask
;

513 i‡(!
a
->
hódî
.
Àngth
)

514  
åue
;

517 
	`HMAP_FOR_EACH
(
Êow_mod_m©ch
, 
oÊ_m©ch_év
, 
hm≠_node
, &
a
->
m©ch_fõlds
)

520 
Êow_íåy_m©ch
 = 
	`oxm_m©ch_lookup
(
Êow_mod_m©ch
->
hódî
, 
b
);

521 i‡(!
Êow_íåy_m©ch
) {

522  
Ál£
;

526 
has_mask
 = 
	`OXM_HASMASK
(
Êow_mod_m©ch
->
hódî
);

527 
fõld_Àn
 = 
	`OXM_LENGTH
(
Êow_mod_m©ch
->
hódî
);

528 
Êow_mod_vÆ
 = 
Êow_mod_m©ch
->
vÆue
;

529 
Êow_íåy_vÆ
 = 
Êow_íåy_m©ch
->
vÆue
;

530 i‡(
has_mask
)

532 
fõld_Àn
 /= 2;

533 
Êow_mod_mask
 = 
Êow_mod_m©ch
->
vÆue
 + 
fõld_Àn
;

534 
Êow_íåy_mask
 = 
Êow_íåy_m©ch
->
vÆue
 + 
fõld_Àn
;

536 
fõld_Àn
) {

538 i‡(
has_mask
) {

539 i‡(!
	`n⁄°ri˘_mask8
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
, 
Êow_mod_mask
, 
Êow_íåy_mask
))

540  
Ál£
;

543 i‡(!
	`m©ch_8
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
))

544  
Ál£
;

548 i‡(
has_mask
) {

549 i‡(!
	`n⁄°ri˘_mask16
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
, 
Êow_mod_mask
, 
Êow_íåy_mask
))

550  
Ál£
;

553 i‡(!
	`m©ch_16
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
))

554  
Ál£
;

558 i‡(
has_mask
) {

559 i‡(!
	`n⁄°ri˘_mask32
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
, 
Êow_mod_mask
, 
Êow_íåy_mask
))

560  
Ál£
;

563 i‡(!
	`m©ch_32
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
))

564  
Ál£
;

568 i‡(
has_mask
) {

569 i‡(!
	`n⁄°ri˘_mask48
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
, 
Êow_mod_mask
, 
Êow_íåy_mask
))

570  
Ál£
;

573 i‡(!
	`m©ch_48
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
))

574  
Ál£
;

578 i‡(
has_mask
) {

579 i‡(!
	`n⁄°ri˘_mask64
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
, 
Êow_mod_mask
, 
Êow_íåy_mask
))

580  
Ál£
;

583 i‡(!
	`m©ch_64
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
))

584  
Ál£
;

588 i‡(
has_mask
) {

589 i‡(!
	`n⁄°ri˘_mask128
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
, 
Êow_mod_mask
, 
Êow_íåy_mask
))

590  
Ál£
;

593 i‡(!
	`m©ch_128
(
Êow_mod_vÆ
, 
Êow_íåy_vÆ
))

594  
Ál£
;

606  
åue
;

607 
	}
}

613 
ölöe
 
boﬁ


614 
	$öcom∑tibÀ_8
(
uöt8_t
 *
a
, uöt8_à*
b
, uöt8_à*
am
, uöt8_à*
bm
) {

616  (–~(*
am
|*
bm
Ë& (*
a
^*
b
) ) != 0);

617 
	}
}

619 
ölöe
 
boﬁ


620 
	$öcom∑tibÀ_16
(
uöt8_t
 *
a
, uöt8_à*
b
, uöt8_à*
am
, uöt8_à*
bm
) {

621 
uöt16_t
 *
a1
 = (uöt16_à*Ë
a
;

622 
uöt16_t
 *
b1
 = (uöt16_à*Ë
b
;

623 
uöt16_t
 *
mask_a
 = (uöt16_à*Ë
am
;

624 
uöt16_t
 *
mask_b
 = (uöt16_à*Ë
bm
;

626  (–~(*
mask_a
|*
mask_b
Ë& (*
a1
^*
b1
) ) != 0);

627 
	}
}

629 
ölöe
 
boﬁ


630 
	$öcom∑tibÀ_32
(
uöt8_t
 *
a
, uöt8_à*
b
, uöt8_à*
am
, uöt8_à*
bm
) {

631 
uöt32_t
 *
a1
 = (uöt32_à*Ë
a
;

632 
uöt32_t
 *
b1
 = (uöt32_à*Ë
b
;

633 
uöt32_t
 *
mask_a
 = (uöt32_à*Ë
am
;

634 
uöt32_t
 *
mask_b
 = (uöt32_à*Ë
bm
;

636  (–~(*
mask_a
|*
mask_b
Ë& (*
a1
^*
b1
) ) != 0);

637 
	}
}

639 
ölöe
 
boﬁ


640 
	$öcom∑tibÀ_48
(
uöt8_t
 *
a
, uöt8_à*
b
, uöt8_à*
am
, uöt8_à*
bm
) {

641  (
	`öcom∑tibÀ_32
(
a
, 
b
, 
am
, 
bm
) ||

642 
	`öcom∑tibÀ_16
(
a
+4, 
b
+4, 
am
+4, 
bm
+4));

643 
	}
}

645 
ölöe
 
boﬁ


646 
	$öcom∑tibÀ_64
(
uöt8_t
 *
a
, uöt8_à*
b
, uöt8_à*
am
, uöt8_à*
bm
) {

647 
uöt64_t
 *
a1
 = (uöt64_à*Ë
a
;

648 
uöt64_t
 *
b1
 = (uöt64_à*Ë
b
;

649 
uöt64_t
 *
mask_a
 = (uöt64_à*Ë
am
;

650 
uöt64_t
 *
mask_b
 = (uöt64_à*Ë
bm
;

652  (–~(*
mask_a
|*
mask_b
Ë& (*
a1
^*
b1
) ) != 0);

653 
	}
}

655 
ölöe
 
boﬁ


656 
	$öcom∑tibÀ_128
(
uöt8_t
 *
a
, uöt8_à*
b
, uöt8_à*
am
, uöt8_à*
bm
) {

657  (
	`öcom∑tibÀ_64
(
a
, 
b
, 
am
, 
bm
) ||

658 
	`öcom∑tibÀ_64
(
a
+8, 
b
+8, 
am
+8, 
bm
+8));

659 
	}
}

667 
boﬁ


668 
	$m©ch_°d_ovîœp
(
oÊ_m©ch
 *
a
, oÊ_m©ch *
b
)

670 
uöt64_t
 
Æl_mask
[2] = {0, 0};

671 
oÊ_m©ch_év
 *
f_a
;

672 
oÊ_m©ch_év
 *
f_b
;

673 
hódî
, 
hódî_m
;

674 
fõld_Àn
;

675 
uöt8_t
 *
vÆ_a
, *
mask_a
;

676 
uöt8_t
 *
vÆ_b
, *
mask_b
;

679 
	`HMAP_FOR_EACH
(
f_a
, 
oÊ_m©ch_év
, 
hm≠_node
, &
a
->
m©ch_fõlds
)

681 
fõld_Àn
 = 
	`OXM_LENGTH
(
f_a
->
hódî
);

682 
vÆ_a
 = 
f_a
->
vÆue
;

683 i‡(
	`OXM_HASMASK
(
f_a
->
hódî
)) {

684 
fõld_Àn
 /= 2;

685 
hódî
 = (
f_a
->hódî & 0xffff„00Ë| 
fõld_Àn
;

686 
hódî_m
 = 
f_a
->
hódî
;

687 
mask_a
 = 
f_a
->
vÆue
 + 
fõld_Àn
;

689 
hódî
 = 
f_a
->header;

690 
hódî_m
 = (
f_a
->
hódî
 & 0xffff„00Ë| 0x100 | (
fõld_Àn
 << 1);

692 
mask_a
 = (
uöt8_t
 *Ë
Æl_mask
;

697 
f_b
 = 
	`oxm_m©ch_lookup
(
hódî
, 
b
);

698 i‡(!
f_b
Ëf_b = 
	`oxm_m©ch_lookup
(
hódî_m
, 
b
);

700 i‡(
f_b
) {

701 
vÆ_b
 = 
f_b
->
vÆue
;

702 i‡(
	`OXM_HASMASK
(
f_b
->
hódî
)) {

703 
mask_b
 = 
f_b
->
vÆue
 + 
fõld_Àn
;

706 
mask_b
 = (
uöt8_t
 *Ë
Æl_mask
;

708 
fõld_Àn
) {

710 i‡(
	`öcom∑tibÀ_8
(
vÆ_a
, 
vÆ_b
, 
mask_a
, 
mask_b
)) {

711  
Ál£
;

715 i‡(
	`öcom∑tibÀ_16
(
vÆ_a
, 
vÆ_b
, 
mask_a
, 
mask_b
)) {

716  
Ál£
;

720 i‡(
	`öcom∑tibÀ_32
(
vÆ_a
, 
vÆ_b
, 
mask_a
, 
mask_b
)) {

721  
Ál£
;

725 i‡(
	`öcom∑tibÀ_48
(
vÆ_a
, 
vÆ_b
, 
mask_a
, 
mask_b
)) {

726  
Ál£
;

730 i‡(
	`öcom∑tibÀ_64
(
vÆ_a
, 
vÆ_b
, 
mask_a
, 
mask_b
)) {

731  
Ál£
;

735 i‡(
	`öcom∑tibÀ_128
(
vÆ_a
, 
vÆ_b
, 
mask_a
, 
mask_b
)) {

736  
Ál£
;

750  
åue
;

751 
	}
}

	@udatapath/match_std.h

32 #i‚de‡
MATCH_EXT_H


33 
	#MATCH_EXT_H
 1

	)

35 
	~<°dboﬁ.h
>

36 
	~"oÊib/oÊ-°ru˘s.h
"

42 
boﬁ


43 
m©ch_°d_ovîœp
(
oÊ_m©ch
 *
a
, oÊ_m©ch *
b
);

45 
boﬁ


46 
∑ckë_m©ch
(
oÊ_m©ch
 *
a
, oÊ_m©ch *
b
);

49 
boﬁ


50 
m©ch_°d_°ri˘
(
oÊ_m©ch
 *
a
, oÊ_m©ch *
b
);

53 
boﬁ


54 
m©ch_°d_n⁄°ri˘
(
oÊ_m©ch
 *
a
, oÊ_m©ch *
b
);

	@udatapath/meter_entry.c

32 
	~<°dboﬁ.h
>

33 
	~"Êow_íåy.h
"

34 
	~"mëî_íåy.h
"

35 
	~"mëî_èbÀ.h
"

36 
	~"dp_a˘i⁄s.h
"

37 
	~"d©≠©h.h
"

38 
	~"utû.h
"

39 
	~"oÊib/oÊ.h
"

40 
	~"oÊib/oÊ-°ru˘s.h
"

41 
	~"oÊib/oÊ-utûs.h
"

42 
	~"oÊib/oÊ-mesßges.h
"

43 
	~"timevÆ.h
"

44 
	~<m©h.h
>

45 
	~"vlog.h
"

46 
	#LOG_MODULE
 
VLM_mëî_e


	)

48 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(60, 60);

52 
	gmëî_èbÀ
;

53 
	gd©≠©h
;

56 
	sÊow_ªf_íåy
 {

57 
li°
 
	mnode
;

58 
Êow_íåy
 *
	míåy
;

63 
mëî_íåy
 *

64 
	$mëî_íåy_¸óã
(
d©≠©h
 *
dp
, 
mëî_èbÀ
 *
èbÀ
, 
oÊ_msg_mëî_mod
 *
mod
) {

65 
mëî_íåy
 *
íåy
;

66 
size_t
 
i
;

67 
uöt64_t
 
now
;

69 
now
 = 
	`time_m£c
();

70 
íåy
 = 
	`xmÆloc
((
mëî_íåy
));

72 
íåy
->
dp
 = dp;

73 
íåy
->
èbÀ
 =Åable;

76 
íåy
->
c⁄fig
 = 
	`xmÆloc
((
oÊ_mëî_c⁄fig
));

77 
íåy
->
c⁄fig
->
mëî_id
 = 
mod
->meter_id;

78 
íåy
->
c⁄fig
->
Êags
 = 
mod
->flags;

79 
íåy
->
c⁄fig
->
mëî_b™ds_num
 = 
mod
->meter_bands_num;

82 
íåy
->
c⁄fig
->
b™ds
 = (
oÊ_mëî_b™d_hódî
 **Ë
	`xmÆloc
((oÊ_mëî_b™d_hódî *Ë*É¡ry->c⁄fig->
mëî_b™ds_num
);

83 
i
 = 0; i < 
íåy
->
c⁄fig
->
mëî_b™ds_num
; i++){

84 
mod
->
b™ds
[
i
]->
ty≥
){

85 (
OFPMBT_DROP
):{

86 
oÊ_mëî_b™d_dr›
 *
b™d
 = 
	`xmÆloc
((ofl_meter_band_drop));

87 
b™d
->
ty≥
 = 
OFPMBT_DROP
;

88 
b™d
->
øã
 = 
mod
->
b™ds
[
i
]->rate;

89 
b™d
->
bur°_size
 = 
mod
->
b™ds
[
i
]->burst_size;

90 
íåy
->
c⁄fig
->
b™ds
[
i
] = (
oÊ_mëî_b™d_hódî
 *Ë
b™d
;

93 (
OFPMBT_DSCP_REMARK
):{

94 
oÊ_mëî_b™d_ds˝_ªm¨k
 *
b™d
 = 
	`xmÆloc
((ofl_meter_band_dscp_remark));

95 
oÊ_mëî_b™d_ds˝_ªm¨k
 *
ﬁd
 = (oÊ_mëî_b™d_ds˝_ªm¨k *Ë
mod
->
b™ds
[
i
];

96 
b™d
->
ty≥
 = 
OFPMBT_DSCP_REMARK
;

97 
b™d
->
øã
 = 
ﬁd
->rate;

98 
b™d
->
bur°_size
 = 
ﬁd
->burst_size;

99 
b™d
->
¥ec_Àvñ
 = 
ﬁd
->prec_level;

100 
íåy
->
c⁄fig
->
b™ds
[
i
] = (
oÊ_mëî_b™d_hódî
 *Ë
b™d
;

103 (
OFPMBT_EXPERIMENTER
):{

104 
oÊ_mëî_b™d_ex≥rimíãr
 *
b™d
 = 
	`xmÆloc
((ofl_meter_band_experimenter));

105 
oÊ_mëî_b™d_ex≥rimíãr
 *
ﬁd
 = (oÊ_mëî_b™d_ex≥rimíã∏*Ë
mod
->
b™ds
[
i
];

106 
b™d
->
ty≥
 = 
OFPMBT_EXPERIMENTER
;

107 
b™d
->
øã
 = 
ﬁd
->rate;

108 
b™d
->
bur°_size
 = 
ﬁd
->burst_size;

109 
b™d
->
ex≥rimíãr
 = 
ﬁd
->experimenter;

110 
íåy
->
c⁄fig
->
b™ds
[
i
] = (
oÊ_mëî_b™d_hódî
 *Ë
b™d
;

116 
íåy
->
°©s
 = 
	`xmÆloc
((
oÊ_mëî_°©s
));

117 
íåy
->
°©s
->
mëî_id
 = 
mod
->meter_id;

118 
íåy
->
°©s
->
byã_ö_cou¡
 = 0;

119 
íåy
->
°©s
->
Êow_cou¡
 = 0;

120 
íåy
->
°©s
->
∑ckë_ö_cou¡
 = 0;

121 
íåy
->
°©s
->
mëî_b™ds_num
 = 
mod
->meter_bands_num;

122 
íåy
->
°©s
->
duøti⁄_n£c
 = 0;

123 
íåy
->
°©s
->
duøti⁄_£c
 = 0;

124 
íåy
->
¸óãd
 = 
now
;

125 
íåy
->
°©s
->
b™d_°©s
 = (
oÊ_mëî_b™d_°©s
 **Ë
	`xmÆloc
((oÊ_mëî_b™d_°©†*Ë*É¡ry->°©s->
mëî_b™ds_num
);

128 
i
=0; i<
íåy
->
°©s
->
mëî_b™ds_num
; i++) {

129 
íåy
->
°©s
->
b™d_°©s
[
i
] = (
oÊ_mëî_b™d_°©s
 *Ë
	`xmÆloc
((ofl_meter_band_stats));

130 
íåy
->
°©s
->
b™d_°©s
[
i
]->
byã_b™d_cou¡
 = 0;

131 
íåy
->
°©s
->
b™d_°©s
[
i
]->
∑ckë_b™d_cou¡
 = 0;

132 
íåy
->
°©s
->
b™d_°©s
[
i
]->
œ°_fûl
 = 
	`time_m£c
();

133 
íåy
->
°©s
->
b™d_°©s
[
i
]->
tokís
 = 0;

136 
	`li°_öô
(&
íåy
->
Êow_ªfs
);

138  
íåy
;

139 
	}
}

142 
	$mëî_íåy_upd©e
(
mëî_íåy
 *
íåy
) {

143 
íåy
->
°©s
->
duøti⁄_£c
 = (
	`time_m£c
(Ë-É¡ry->
¸óãd
) / 1000;

144 
íåy
->
°©s
->
duøti⁄_n£c
 = ((
	`time_m£c
(Ë-É¡ry->
¸óãd
) % 1000) * 1000;

145 
	}
}

148 
	$mëî_íåy_de°roy
(
mëî_íåy
 *
íåy
) {

149 
Êow_ªf_íåy
 *
ªf
, *
√xt
;

152 
	`LIST_FOR_EACH_SAFE
(
ªf
, 
√xt
, 
Êow_ªf_íåy
, 
node
, &
íåy
->
Êow_ªfs
) {

153 
	`Êow_íåy_ªmove
(
ªf
->
íåy
, 
OFPRR_METER_DELETE
);

157 
	`OFL_UTILS_FREE_ARR_FUN
(
íåy
->
c⁄fig
->
b™ds
,É¡ry->c⁄fig->
mëî_b™ds_num
, 
oÊ_°ru˘s_‰ì_mëî_b™ds
);

158 
	`‰ì
(
íåy
->
c⁄fig
);

160 
	`OFL_UTILS_FREE_ARR
(
íåy
->
°©s
->
b™d_°©s
,É¡ry->°©s->
mëî_b™ds_num
);

161 
	`‰ì
(
íåy
->
°©s
);

162 
	`‰ì
(
íåy
);

163 
	}
}

165 
boﬁ


166 
	$c⁄sume_tokís
(
oÊ_mëî_b™d_°©s
 *
b™d
, 
uöt16_t
 
mëî_Êag
, 
∑ckë
 *
pkt
){

168 if(
mëî_Êag
 & 
OFPMF_KBPS
){

169 
uöt32_t
 
pkt_size
 = (
pkt
->
buf„r
->
size
*8)/1024;

170 i‡(
b™d
->
tokís
 >
pkt_size
) {

171 
b™d
->
tokís
 -
pkt_size
;

172  
åue
;

174  
Ál£
;

178 if(
mëî_Êag
 & 
OFPMF_PKTPS
) {

179 i‡(
b™d
->
tokís
 >= 1000) {

180 
b™d
->
tokís
 -= 1000;

181  
åue
;

183  
Ál£
;

186  
Ál£
;

187 
	}
}

189 
size_t


190 
	$choo£_b™d
(
mëî_íåy
 *
íåy
, 
∑ckë
 *
pkt
)

192 
size_t
 
i
;

193 
size_t
 
b™d_ödex
 = -1;

194 
uöt32_t
 
tmp_øã
 = 0;

195 
i
 = 0; i < 
íåy
->
°©s
->
mëî_b™ds_num
; i++)

197 
oÊ_mëî_b™d_hódî
 *
b™d_hódî
 = 
íåy
->
c⁄fig
->
b™ds
[
i
];

199 if(!
	`c⁄sume_tokís
(
íåy
->
°©s
->
b™d_°©s
[
i
],É¡ry->
c⁄fig
->
Êags
, 
pkt
Ë&& 
b™d_hódî
->
øã
 > 
tmp_øã
)

201 
tmp_øã
 = 
b™d_hódî
->
øã
;

202 
b™d_ödex
 = 
i
;

205  
b™d_ödex
;

206 
	}
}

211 
	$mëî_íåy_≠∂y
(
mëî_íåy
 *
íåy
, 
∑ckë
 **
pkt
){

213 
size_t
 
b
;

214 
boﬁ
 
dr›
 = 
Ál£
;

216 
íåy
->
°©s
->
∑ckë_ö_cou¡
++;

217 
íåy
->
°©s
->
byã_ö_cou¡
 +(*
pkt
)->
buf„r
->
size
;

219 
b
 = 
	`choo£_b™d
(
íåy
, *
pkt
);

220 if(
b
 != -1){

221 
oÊ_mëî_b™d_hódî
 *
b™d_hódî
 = (oÊ_mëî_b™d_hódî*Ë
íåy
->
c⁄fig
->
b™ds
[
b
];

222 
b™d_hódî
->
ty≥
){

223 
OFPMBT_DROP
:{

224 
dr›
 = 
åue
;

227 
OFPMBT_DSCP_REMARK
:{

228 
oÊ_mëî_b™d_ds˝_ªm¨k
 *
b™d_hódî
 = (oÊ_mëî_b™d_ds˝_ªm¨k *Ë
íåy
->
c⁄fig
->
b™ds
[
b
];

230 
uöt8_t
 
√w_ds˝
 = ((*
pkt
)->
h™dÀ_°d
->
¥Ÿo
->
ùv4
->
ù_tos
 >> 5Ë- 
b™d_hódî
->
¥ec_Àvñ
;

231 (*
pkt
)->
h™dÀ_°d
->
¥Ÿo
->
ùv4
->
ù_tos
 = (
√w_ds˝
 << 5) | ((*pkt)->handle_std->proto->ipv4->ip_tos & 0x1f);

234 
OFPMBT_EXPERIMENTER
:{

238 
íåy
->
°©s
->
b™d_°©s
[
b
]->
byã_b™d_cou¡
 +(*
pkt
)->
buf„r
->
size
;

239 
íåy
->
°©s
->
b™d_°©s
[
b
]->
∑ckë_b™d_cou¡
++;

240 i‡(
dr›
){

241 
	`VLOG_ERR_RL
(
LOG_MODULE
, &
æ
, "Dr›pögÖackë:Ñ©ê%d", 
b™d_hódî
->
øã
);

242 
	`∑ckë_de°roy
(*
pkt
);

243 *
pkt
 = 
NULL
;

247 
	}
}

251 
boﬁ


252 
	$has_Êow_ªf
(
mëî_íåy
 *
íåy
, 
Êow_íåy
 *
„
) {

253 
Êow_ªf_íåy
 *
f
;

255 
	`LIST_FOR_EACH
(
f
, 
Êow_ªf_íåy
, 
node
, &
íåy
->
Êow_ªfs
) {

256 i‡(
f
->
íåy
 =
„
) {

257  
åue
;

260  
Ál£
;

261 
	}
}

265 
	$mëî_íåy_add_Êow_ªf
(
mëî_íåy
 *
íåy
, 
Êow_íåy
 *
„
) {

266 i‡(!(
	`has_Êow_ªf
(
íåy
, 
„
))) {

267 
Êow_ªf_íåy
 *
f
 = 
	`xmÆloc
((flow_ref_entry));

268 
f
->
íåy
 = 
„
;

269 
	`li°_ö£π
(&
íåy
->
Êow_ªfs
, &
f
->
node
);

270 
íåy
->
°©s
->
Êow_cou¡
++;

272 
	}
}

275 
	$mëî_íåy_dñ_Êow_ªf
(
mëî_íåy
 *
íåy
, 
Êow_íåy
 *
„
) {

276 
Êow_ªf_íåy
 *
f
, *
√xt
;

278 
	`LIST_FOR_EACH_SAFE
(
f
, 
√xt
, 
Êow_ªf_íåy
, 
node
, &
íåy
->
Êow_ªfs
) {

279 i‡(
f
->
íåy
 =
„
) {

280 
	`li°_ªmove
(&
f
->
node
);

281 
	`‰ì
(
f
);

282 
íåy
->
°©s
->
Êow_cou¡
--;

285 
	}
}

289 
	$ªfûl_buckë
(
mëî_íåy
 *
íåy
)

291 
size_t
 
i
;

293 
i
 = 0; i < 
íåy
->
c⁄fig
->
mëî_b™ds_num
; i++) {

294 
now
 = 
	`time_m£c
();

295 
tokís
 = !(
íåy
->
c⁄fig
->
Êags
 & 
OFPMF_PKTPS
) ?

296 (
now
 - 
íåy
->
°©s
->
b™d_°©s
[
i
]->
œ°_fûl
) *

297 
íåy
->
c⁄fig
->
b™ds
[
i
]->
øã
 +É¡ry->
°©s
->
b™d_°©s
[i]->
tokís


298 : (
now
 - 
íåy
->
°©s
->
b™d_°©s
[
i
]->
œ°_fûl
) *

299 (
íåy
->
c⁄fig
->
b™ds
[
i
]->
øã
 * 1000Ë+É¡ry->
°©s
->
b™d_°©s
[i]->
tokís
;

301 i‡(!(
íåy
->
c⁄fig
->
Êags
 & 
OFPMF_BURST
)){

302 if(
íåy
->
c⁄fig
->
Êags
 & 
OFPMF_KBPS
 && 
tokís
 >= 1){

303 
íåy
->
°©s
->
b™d_°©s
[
i
]->
tokís
 = 
	`MIN
—okís,É¡ry->
c⁄fig
->
b™ds
[i]->
øã
);

304 
íåy
->
°©s
->
b™d_°©s
[
i
]->
œ°_fûl
 = 
now
;

308 if(
tokís
 >= 1000) {

309 
íåy
->
°©s
->
b™d_°©s
[
i
]->
tokís
 = 
	`MIN
—okís,É¡ry->
c⁄fig
->
b™ds
[i]->
øã
 * 1000);

310 
íåy
->
°©s
->
b™d_°©s
[
i
]->
œ°_fûl
 = 
now
;

316 if(
íåy
->
c⁄fig
->
Êags
 & 
OFPMF_KBPS
 && 
tokís
 >= 1 ) {

317 
íåy
->
°©s
->
b™d_°©s
[
i
]->
tokís
 = 
	`MIN
—okís,É¡ry->
c⁄fig
->
b™ds
[i]->
bur°_size
);

321 if(
tokís
 >= 1000) {

322 
íåy
->
°©s
->
b™d_°©s
[
i
]->
tokís
 = 
	`MIN
—okís,É¡ry->
c⁄fig
->
b™ds
[i]->
bur°_size
 * 1000);

327 
	}
}

	@udatapath/meter_entry.h

32 #i‚de‡
METER_ENTRY_H


33 
	#METER_ENTRY_H
 1

	)

35 
	~<°dboﬁ.h
>

36 
	~"hm≠.h
"

37 
	~"li°.h
"

38 
	~"∑ckë.h
"

39 
	~"oÊib/oÊ-°ru˘s.h
"

40 
	~"oÊib/oÊ-mesßges.h
"

41 
	~"mëî_èbÀ.h
"

51 
	g∑ckë
;

52 
	gd©≠©h
;

53 
	gÊow_íåy
;

54 
	g£ndî
;

57 
	smëî_íåy
 {

58 
hm≠_node
 
	mnode
;

60 
d©≠©h
 *
	mdp
;

61 
mëî_èbÀ
 *
	mèbÀ
;

63 
oÊ_mëî_°©s
 *
	m°©s
;

64 
oÊ_mëî_c⁄fig
 *
	mc⁄fig
;

66 
uöt64_t
 
	m¸óãd
;

68 
li°
 
	mÊow_ªfs
;

73 
mëî_íåy
 *

74 
mëî_íåy_¸óã
(
d©≠©h
 *
dp
, 
mëî_èbÀ
 *
èbÀ
, 
oÊ_msg_mëî_mod
 *
mod
);

78 
mëî_íåy_upd©e
(
mëî_íåy
 *
íåy
);

82 
mëî_íåy_de°roy
(
mëî_íåy
 *
íåy
);

86 
mëî_íåy_≠∂y
(
mëî_íåy
 *
íåy
, 
∑ckë
 **
pkt
);

91 
mëî_íåy_add_Êow_ªf
(
mëî_íåy
 *
íåy
, 
Êow_íåy
 *
„
);

95 
mëî_íåy_dñ_Êow_ªf
(
mëî_íåy
 *
íåy
, 
Êow_íåy
 *
„
);

98 
ªfûl_buckë
(
mëî_íåy
 *
íåy
);

	@udatapath/meter_table.c

32 
	~<sys/ty≥s.h
>

33 
	~"compûî.h
"

34 
	~"mëî_èbÀ.h
"

35 
	~"d©≠©h.h
"

36 
	~"dp_a˘i⁄s.h
"

37 
	~"hm≠.h
"

38 
	~"li°.h
"

39 
	~"∑ckë.h
"

40 
	~"utû.h
"

41 
	~"›íÊow/›íÊow.h
"

42 
	~"oÊib/oÊ.h
"

43 
	~"oÊib/oÊ-mesßges.h
"

45 
	~"vlog.h
"

46 
	#LOG_MODULE
 
VLM_mëî_t


	)

48 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(60, 60);

51 
mëî_èbÀ
 *

52 
	$mëî_èbÀ_¸óã
(
d©≠©h
 *
dp
) {

53 
mëî_èbÀ
 *
èbÀ
;

55 
èbÀ
 = 
	`xmÆloc
((
mëî_èbÀ
));

56 
èbÀ
->
dp
 = dp;

57 
èbÀ
->
íåõs_num
 = 0;

58 
	`hm≠_öô
(&
èbÀ
->
mëî_íåõs
);

60 
èbÀ
->
„©uªs
 = 
	`xmÆloc
((
oÊ_mëî_„©uªs
));

61 
èbÀ
->
„©uªs
->
max_mëî
 = 
DEFAULT_MAX_METER
;

62 
èbÀ
->
„©uªs
->
max_b™ds
 = 
DEFAULT_MAX_BAND_PER_METER
;

63 
èbÀ
->
„©uªs
->
max_cﬁ‹
 = 
DEFAULT_MAX_METER_COLOR
;

64 
èbÀ
->
„©uªs
->
ˇ∑bûôõs
 = 
OFPMF_KBPS
 | 
OFPMF_BURST
 | 
OFPMF_STATS
;

66 
èbÀ
->
„©uªs
->
b™d_ty≥s
 = 1;

68  
èbÀ
;

69 
	}
}

72 
	$mëî_èbÀ_de°roy
(
mëî_èbÀ
 *
èbÀ
) {

73 
mëî_íåy
 *
íåy
, *
√xt
;

75 
	`HMAP_FOR_EACH_SAFE
(
íåy
, 
√xt
, 
mëî_íåy
, 
node
, &
èbÀ
->
mëî_íåõs
) {

76 
	`mëî_íåy_de°roy
(
íåy
);

79 
	`‰ì
(
èbÀ
);

80 
	}
}

83 
mëî_íåy
 *

84 
	$mëî_èbÀ_föd
(
mëî_èbÀ
 *
èbÀ
, 
uöt32_t
 
mëî_id
) {

85 
hm≠_node
 *
hnode
;

87 
hnode
 = 
	`hm≠_fú°_wôh_hash
(&
èbÀ
->
mëî_íåõs
, 
mëî_id
);

89 i‡(
hnode
 =
NULL
) {

90  
NULL
;

93  
	`CONTAINER_OF
(
hnode
, 
mëî_íåy
, 
node
);

94 
	}
}

99 
	$mëî_èbÀ_≠∂y
(
mëî_èbÀ
 *
èbÀ
, 
∑ckë
 **∑ckë, 
uöt32_t
 
mëî_id
) {

100 
mëî_íåy
 *
íåy
;

102 
íåy
 = 
	`mëî_èbÀ_föd
(
èbÀ
, 
mëî_id
);

104 i‡(
íåy
 =
NULL
) {

105 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "TryögÅÿexecuãÇ⁄-exi°ög mëî (%u).", 
mëî_id
);

109 
	`mëî_íåy_≠∂y
(
íåy
, 
∑ckë
);

110 
	}
}

114 
oÊ_îr


115 
	$mëî_èbÀ_add
(
mëî_èbÀ
 *
èbÀ
, 
oÊ_msg_mëî_mod
 *
mod
) {

117 
mëî_íåy
 *
íåy
;

119 i‡(
	`hm≠_fú°_wôh_hash
(&
èbÀ
->
mëî_íåõs
, 
mod
->
mëî_id
Ë!
NULL
) {

120  
	`oÊ_îr‹
(
OFPET_METER_MOD_FAILED
, 
OFPMMFC_METER_EXISTS
);

123 i‡(
èbÀ
->
íåõs_num
 =
DEFAULT_MAX_METER
) {

124  
	`oÊ_îr‹
(
OFPET_METER_MOD_FAILED
, 
OFPMMFC_OUT_OF_METERS
);

127 i‡(
èbÀ
->
b™ds_num
 + 
mod
->
mëî_b™ds_num
 > 
METER_TABLE_MAX_BANDS
) {

128  
	`oÊ_îr‹
(
OFPET_METER_MOD_FAILED
, 
OFPMMFC_OUT_OF_BANDS
);

131 
íåy
 = 
	`mëî_íåy_¸óã
(
èbÀ
->
dp
,ÅabÀ, 
mod
);

133 
	`hm≠_ö£π
(&
èbÀ
->
mëî_íåõs
, &
íåy
->
node
,É¡ry->
°©s
->
mëî_id
);

135 
èbÀ
->
íåõs_num
++;

136 
èbÀ
->
b™ds_num
 +
íåy
->
°©s
->
mëî_b™ds_num
;

137 
	`oÊ_msg_‰ì_mëî_mod
(
mod
, 
Ál£
);

139 
	}
}

142 
oÊ_îr


143 
	$mëî_èbÀ_modify
(
mëî_èbÀ
 *
èbÀ
, 
oÊ_msg_mëî_mod
 *
mod
) {

144 
mëî_íåy
 *
íåy
, *
√w_íåy
;

146 
íåy
 = 
	`mëî_èbÀ_föd
(
èbÀ
, 
mod
->
mëî_id
);

147 i‡(
íåy
 =
NULL
) {

148  
	`oÊ_îr‹
(
OFPET_METER_MOD_FAILED
, 
OFPMMFC_UNKNOWN_METER
);

151 i‡(
èbÀ
->
b™ds_num
 - 
íåy
->
c⁄fig
->
mëî_b™ds_num
 + 
mod
->mëî_b™ds_num > 
METER_TABLE_MAX_BANDS
) {

152  
	`oÊ_îr‹
(
OFPET_METER_MOD_FAILED
, 
OFPMMFC_OUT_OF_BANDS
);

155 
√w_íåy
 = 
	`mëî_íåy_¸óã
(
èbÀ
->
dp
,ÅabÀ, 
mod
);

157 
	`hm≠_ªmove
(&
èbÀ
->
mëî_íåõs
, &
íåy
->
node
);

158 
	`hm≠_ö£π_Á°
(&
èbÀ
->
mëî_íåõs
, &
√w_íåy
->
node
, 
mod
->
mëî_id
);

160 
èbÀ
->
b™ds_num
 =ÅabÀ->b™ds_num - 
íåy
->
c⁄fig
->
mëî_b™ds_num
 + 
√w_íåy
->
°©s
->meter_bands_num;

163 
	`li°_ª∂a˚
(&
√w_íåy
->
Êow_ªfs
, &
íåy
->flow_refs);

164 
	`li°_öô
(&
íåy
->
Êow_ªfs
);

166 
	`mëî_íåy_de°roy
(
íåy
);

167 
	`oÊ_msg_‰ì_mëî_mod
(
mod
, 
Ál£
);

169 
	}
}

172 
oÊ_îr


173 
	$mëî_èbÀ_dñëe
(
mëî_èbÀ
 *
èbÀ
, 
oÊ_msg_mëî_mod
 *
mod
) {

174 i‡(
mod
->
mëî_id
 =
OFPM_ALL
) {

175 
mëî_íåy
 *
íåy
, *
√xt
;

177 
	`HMAP_FOR_EACH_SAFE
(
íåy
, 
√xt
, 
mëî_íåy
, 
node
, &
èbÀ
->
mëî_íåõs
) {

178 
	`mëî_íåy_de°roy
(
íåy
);

180 
	`hm≠_de°roy
(&
èbÀ
->
mëî_íåõs
);

181 
	`hm≠_öô
(&
èbÀ
->
mëî_íåõs
);

183 
èbÀ
->
íåõs_num
 = 0;

184 
èbÀ
->
b™ds_num
 = 0;

185 
	`oÊ_msg_‰ì_mëî_mod
(
mod
, 
Ál£
);

189 
mëî_íåy
 *
íåy
;

191 
íåy
 = 
	`mëî_èbÀ_föd
(
èbÀ
, 
mod
->
mëî_id
);

193 i‡(
íåy
 !
NULL
) {

195 
èbÀ
->
íåõs_num
--;

196 
èbÀ
->
b™ds_num
 -
íåy
->
°©s
->
mëî_b™ds_num
;

198 
	`hm≠_ªmove
(&
èbÀ
->
mëî_íåõs
, &
íåy
->
node
);

199 
	`mëî_íåy_de°roy
(
íåy
);

201 
	`oÊ_msg_‰ì_mëî_mod
(
mod
, 
Ál£
);

204 
	}
}

206 
oÊ_îr


207 
	$mëî_èbÀ_h™dÀ_mëî_mod
(
mëî_èbÀ
 *
èbÀ
, 
oÊ_msg_mëî_mod
 *
mod
,

208 c⁄° 
£ndî
 *sender) {

209 if(
£ndî
->
ªmŸe
->
rﬁe
 =
OFPCR_ROLE_SLAVE
)

210  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_IS_SLAVE
);

212 
mod
->
comm™d
) {

213 (
OFPMC_ADD
): {

214  
	`mëî_èbÀ_add
(
èbÀ
, 
mod
);

216 (
OFPMC_MODIFY
): {

217  
	`mëî_èbÀ_modify
(
èbÀ
, 
mod
);

219 (
OFPMC_DELETE
): {

220  
	`mëî_èbÀ_dñëe
(
èbÀ
, 
mod
);

223  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_BAD_TYPE
);

226 
	}
}

228 
oÊ_îr


229 
	$mëî_èbÀ_h™dÀ_°©s_ªque°_mëî
(
mëî_èbÀ
 *
èbÀ
,

230 
oÊ_msg_mu…ù¨t_mëî_ªque°
 *
msg
,

231 c⁄° 
£ndî
 *£ndî 
UNUSED
) {

232 
mëî_íåy
 *
íåy
;

234 i‡(
msg
->
mëî_id
 =
OFPM_ALL
) {

235 
íåy
 = 
NULL
;

237 
íåy
 = 
	`mëî_èbÀ_föd
(
èbÀ
, 
msg
->
mëî_id
);

239 i‡(
íåy
 =
NULL
) {

240  
	`oÊ_îr‹
(
OFPET_METER_MOD_FAILED
, 
OFPMMFC_UNKNOWN_METER
);

245 
oÊ_msg_mu…ù¨t_ª∂y_mëî
 
ª∂y
 =

246 {{{.
ty≥
 = 
OFPT_MULTIPART_REPLY
},

247 .
ty≥
 = 
OFPMP_METER
, .
Êags
 = 0x0000},

248 .
°©s_num
 = 
msg
->
mëî_id
 =
OFPM_ALL
 ? 
èbÀ
->
íåõs_num
 : 1,

249 .
°©s
 = 
	`xmÆloc
((
oÊ_mëî_°©s
 *Ë* (
msg
->
mëî_id
 =
OFPM_ALL
 ? 
èbÀ
->
íåõs_num
 : 1))

252 i‡(
msg
->
mëî_id
 =
OFPM_ALL
) {

253 
mëî_íåy
 *
e
;

254 
size_t
 
i
 = 0;

256 
	`HMAP_FOR_EACH
(
e
, 
mëî_íåy
, 
node
, &
èbÀ
->
mëî_íåõs
) {

257 
	`mëî_íåy_upd©e
(
e
);

258 
ª∂y
.
°©s
[
i
] = 
e
->stats;

259 
i
++;

263 
	`mëî_íåy_upd©e
(
íåy
);

264 
ª∂y
.
°©s
[0] = 
íåy
->stats;

267 
	`dp_£nd_mesßge
(
èbÀ
->
dp
, (
oÊ_msg_hódî
 *)&
ª∂y
, 
£ndî
);

269 
	`‰ì
(
ª∂y
.
°©s
);

270 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
èbÀ
->
dp
->
exp
);

273 
	}
}

275 
oÊ_îr


276 
	$mëî_èbÀ_h™dÀ_°©s_ªque°_mëî_c⁄f
(
mëî_èbÀ
 *
èbÀ
,

277 
oÊ_msg_mu…ù¨t_mëî_ªque°
 *
msg
 
UNUSED
,

278 c⁄° 
£ndî
 *sender) {

279 
mëî_íåy
 *
íåy
;

281 i‡(
msg
->
mëî_id
 =
OFPM_ALL
) {

282 
íåy
 = 
NULL
;

284 
íåy
 = 
	`mëî_èbÀ_föd
(
èbÀ
, 
msg
->
mëî_id
);

286 i‡(
íåy
 =
NULL
) {

287  
	`oÊ_îr‹
(
OFPET_METER_MOD_FAILED
, 
OFPMMFC_UNKNOWN_METER
);

291 
oÊ_msg_mu…ù¨t_ª∂y_mëî_c⁄f
 
ª∂y
 =

292 {{{.
ty≥
 = 
OFPT_MULTIPART_REPLY
},

293 .
ty≥
 = 
OFPMP_METER_CONFIG
, .
Êags
 = 0x0000},

294 .
°©s_num
 = 
èbÀ
->
íåõs_num
,

295 .
°©s
 = 
	`xmÆloc
((
oÊ_mëî_c⁄fig
 *Ë* (
msg
->
mëî_id
 =
OFPM_ALL
 ? 
èbÀ
->
íåõs_num
 : 1))

298 i‡(
msg
->
mëî_id
 =
OFPM_ALL
) {

299 
mëî_íåy
 *
e
;

300 
size_t
 
i
 = 0;

302 
	`HMAP_FOR_EACH
(
e
, 
mëî_íåy
, 
node
, &
èbÀ
->
mëî_íåõs
) {

303 
ª∂y
.
°©s
[
i
] = 
e
->
c⁄fig
;

304 
i
++;

308 
ª∂y
.
°©s
[0] = 
íåy
->
c⁄fig
;

311 
	`dp_£nd_mesßge
(
èbÀ
->
dp
, (
oÊ_msg_hódî
 *)&
ª∂y
, 
£ndî
);

313 
	`‰ì
(
ª∂y
.
°©s
);

314 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
èbÀ
->
dp
->
exp
);

316 
	}
}

318 
oÊ_îr


319 
	$mëî_èbÀ_h™dÀ_„©uªs_ªque°
(
mëî_èbÀ
 *
èbÀ
,

320 
oÊ_msg_mu…ù¨t_ªque°_hódî
 *
msg
 
UNUSED
,

321 c⁄° 
£ndî
 *sender) {

323 
oÊ_msg_mu…ù¨t_ª∂y_mëî_„©uªs
 
ª∂y
 =

324 {{{.
ty≥
 = 
OFPT_MULTIPART_REPLY
},

325 .
ty≥
 = 
OFPMP_METER_FEATURES
, .
Êags
 = 0x0000},

326 .
„©uªs
 = 
èbÀ
->features

328 
	`dp_£nd_mesßge
(
èbÀ
->
dp
, (
oÊ_msg_hódî
 *)&
ª∂y
, 
£ndî
);

330 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
èbÀ
->
dp
->
exp
);

333 
	}
}

336 
	$mëî_èbÀ_add_tokís
(
mëî_èbÀ
 *
èbÀ
){

338 
mëî_íåy
 *
íåy
;

339 
	`HMAP_FOR_EACH
(
íåy
, 
mëî_íåy
, 
node
, &
èbÀ
->
mëî_íåõs
){

340 
	`ªfûl_buckë
(
íåy
);

343 
	}
}

	@udatapath/meter_table.h

32 #i‚de‡
METER_TABLE_H


33 
	#METER_TABLE_H
 1

	)

35 
	~<°dboﬁ.h
>

36 
	~"hm≠.h
"

37 
	~"li°.h
"

38 
	~"∑ckë.h
"

39 
	~"oÊib/oÊ-°ru˘s.h
"

40 
	~"oÊib/oÊ-mesßges.h
"

41 
	~"mëî_íåy.h
"

43 
	#DEFAULT_MAX_METER
 256

	)

44 
	#DEFAULT_MAX_BAND_PER_METER
 16

	)

45 
	#DEFAULT_MAX_METER_COLOR
 8

	)

46 
	#METER_TABLE_MAX_BANDS
 1024

	)

54 
	smëî_èbÀ
 {

55 
d©≠©h
 *
	mdp
;

56 
oÊ_mëî_„©uªs
 *
	m„©uªs
;

57 
size_t
 
	míåõs_num
;

58 
hm≠
 
	mmëî_íåõs
;

59 
size_t
 
	mb™ds_num
;

65 
mëî_èbÀ
 *

66 
mëî_èbÀ_¸óã
(
d©≠©h
 *
dp
);

70 
mëî_èbÀ_de°roy
(
mëî_èbÀ
 *
èbÀ
);

73 
mëî_íåy
 *

74 
mëî_èbÀ_föd
(
mëî_èbÀ
 *
èbÀ
, 
uöt32_t
 
mëî_id
);

78 
mëî_èbÀ_≠∂y
(
mëî_èbÀ
 *
èbÀ
, 
∑ckë
 **∑ckë, 
uöt32_t
 
mëî_id
);

81 
oÊ_îr


82 
mëî_èbÀ_h™dÀ_mëî_mod
(
mëî_èbÀ
 *
èbÀ
, 
oÊ_msg_mëî_mod
 *
mod
, c⁄° 
£ndî
 *sender);

86 
oÊ_îr


87 
mëî_èbÀ_h™dÀ_°©s_ªque°_mëî
(
mëî_èbÀ
 *
èbÀ
,

88 
oÊ_msg_mu…ù¨t_mëî_ªque°
 *
msg
,

89 c⁄° 
£ndî
 *£ndî 
UNUSED
);

92 
oÊ_îr


93 
mëî_èbÀ_h™dÀ_°©s_ªque°_mëî_c⁄f
(
mëî_èbÀ
 *
èbÀ
,

94 
oÊ_msg_mu…ù¨t_mëî_ªque°
 *
msg
 
UNUSED
,

95 c⁄° 
£ndî
 *sender);

97 
oÊ_îr


98 
mëî_èbÀ_h™dÀ_„©uªs_ªque°
(
mëî_èbÀ
 *
èbÀ
,

99 
oÊ_msg_mu…ù¨t_ªque°_hódî
 *
msg
 
UNUSED
,

100 c⁄° 
£ndî
 *sender);

103 
mëî_èbÀ_add_tokís
(
mëî_èbÀ
 *
èbÀ
);

	@udatapath/packet.c

31 
	~<°dlib.h
>

32 
	~<°rög.h
>

33 
	~<°dboﬁ.h
>

34 
	~<sys/ty≥s.h
>

35 
	~"d©≠©h.h
"

36 
	~"dp_buf„rs.h
"

37 
	~"∑ckë.h
"

38 
	~"∑ckës.h
"

39 
	~"a˘i⁄_£t.h
"

40 
	~"oÂbuf.h
"

41 
	~"oÊib/oÊ-°ru˘s.h
"

42 
	~"oÊib/oÊ-¥öt.h
"

43 
	~"utû.h
"

46 
∑ckë
 *

47 
	$∑ckë_¸óã
(
d©≠©h
 *
dp
, 
uöt32_t
 
ö_p‹t
,

48 
oÂbuf
 *
buf
, 
boﬁ
 
∑ckë_out
) {

49 
∑ckë
 *
pkt
;

51 
pkt
 = 
	`xmÆloc
((
∑ckë
));

53 
pkt
->
dp
 = dp;

54 
pkt
->
buf„r
 = 
buf
;

55 
pkt
->
ö_p‹t
 = in_port;

56 
pkt
->
a˘i⁄_£t
 = 
	`a˘i⁄_£t_¸óã
(
dp
->
exp
);

58 
pkt
->
∑ckë_out
 =Öacket_out;

59 
pkt
->
out_group
 = 
OFPG_ANY
;

60 
pkt
->
out_p‹t
 = 
OFPP_ANY
;

61 
pkt
->
out_p‹t_max_Àn
 = 0;

62 
pkt
->
out_queue
 = 0;

63 
pkt
->
buf„r_id
 = 
NO_BUFFER
;

64 
pkt
->
èbÀ_id
 = 0;

66 
pkt
->
h™dÀ_°d
 = 
	`∑ckë_h™dÀ_°d_¸óã
(pkt);

67  
pkt
;

68 
	}
}

70 
∑ckë
 *

71 
	$∑ckë_˛⁄e
(
∑ckë
 *
pkt
) {

72 
∑ckë
 *
˛⁄e
;

74 
˛⁄e
 = 
	`xmÆloc
((
∑ckë
));

75 
˛⁄e
->
dp
 = 
pkt
->dp;

76 
˛⁄e
->
buf„r
 = 
	`oÂbuf_˛⁄e
(
pkt
->buffer);

77 
˛⁄e
->
ö_p‹t
 = 
pkt
->in_port;

78 
˛⁄e
->
a˘i⁄_£t
 = 
	`a˘i⁄_£t_˛⁄e
(
pkt
->action_set);

80 
˛⁄e
->
∑ckë_out
 = 
pkt
->packet_out;

81 
˛⁄e
->
out_group
 = 
OFPG_ANY
;

82 
˛⁄e
->
out_p‹t
 = 
OFPP_ANY
;

83 
˛⁄e
->
out_p‹t_max_Àn
 = 0;

84 
˛⁄e
->
out_queue
 = 0;

85 
˛⁄e
->
buf„r_id
 = 
NO_BUFFER
;

88 
˛⁄e
->
èbÀ_id
 = 
pkt
->table_id;

90 
˛⁄e
->
h™dÀ_°d
 = 
	`∑ckë_h™dÀ_°d_˛⁄e
(˛⁄e, 
pkt
->handle_std);

92  
˛⁄e
;

93 
	}
}

96 
	$∑ckë_de°roy
(
∑ckë
 *
pkt
) {

100 i‡(
pkt
->
buf„r_id
 !
NO_BUFFER
) {

101 i‡(
	`dp_buf„rs_is_Æive
(
pkt
->
dp
->
buf„rs
,Ökt->
buf„r_id
)) {

104 
	`dp_buf„rs_disˇrd
(
pkt
->
dp
->
buf„rs
,Ökt->
buf„r_id
, 
Ál£
);

108 
	`a˘i⁄_£t_de°roy
(
pkt
->
a˘i⁄_£t
);

109 
	`oÂbuf_dñëe
(
pkt
->
buf„r
);

110 
	`∑ckë_h™dÀ_°d_de°roy
(
pkt
->
h™dÀ_°d
);

111 
	`‰ì
(
pkt
);

112 
	}
}

115 
	$∑ckë_to_°rög
(
∑ckë
 *
pkt
) {

116 *
°r
;

117 
size_t
 
°r_size
;

118 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

120 
	`Ârötf
(
°ªam
, "pkt{in=\"");

121 
	`oÊ_p‹t_¥öt
(
°ªam
, 
pkt
->
ö_p‹t
);

122 
	`Ârötf
(
°ªam
, "\",áctset=");

123 
	`a˘i⁄_£t_¥öt
(
°ªam
, 
pkt
->
a˘i⁄_£t
);

124 
	`Ârötf
(
°ªam
, ",Öktout=\"%u\", ogΩ=\"", 
pkt
->
∑ckë_out
);

125 
	`oÊ_group_¥öt
(
°ªam
, 
pkt
->
out_group
);

126 
	`Ârötf
(
°ªam
, "\", oprt=\"");

127 
	`oÊ_p‹t_¥öt
(
°ªam
, 
pkt
->
out_p‹t
);

128 
	`Ârötf
(
°ªam
, "\", buffer=\"");

129 
	`oÊ_buf„r_¥öt
(
°ªam
, 
pkt
->
buf„r_id
);

130 
	`Ârötf
(
°ªam
, "\", std=");

132 
	`Ârötf
(
°ªam
, "}");

134 
	`f˛o£
(
°ªam
);

135  
°r
;

136 
	}
}

	@udatapath/packet.h

33 #i‚de‡
PACKET_H


34 
	#PACKET_H
 1

	)

36 
	~<°dboﬁ.h
>

37 
	~"a˘i⁄_£t.h
"

38 
	~"d©≠©h.h
"

39 
	~"∑ckë_h™dÀ_°d.h
"

40 
	~"oÂbuf.h
"

41 
	~"oÊib/oÊ-°ru˘s.h
"

42 
	~"∑ckës.h
"

51 
	s∑ckë
 {

52 
d©≠©h
 *
	mdp
;

53 
oÂbuf
 *
	mbuf„r
;

54 
uöt32_t
 
	mö_p‹t
;

55 
a˘i⁄_£t
 *
	ma˘i⁄_£t
;

56 
boﬁ
 
	m∑ckë_out
;

58 
uöt32_t
 
	mout_group
;

59 
uöt32_t
 
	mout_p‹t
;

60 
uöt16_t
 
	mout_p‹t_max_Àn
;

61 
uöt32_t
 
	mout_queue
;

62 
uöt8_t
 
	mèbÀ_id
;

63 
uöt32_t
 
	mbuf„r_id
;

66 
∑ckë_h™dÀ_°d
 *
	mh™dÀ_°d
;

70 
∑ckë
 *

71 
∑ckë_¸óã
(
d©≠©h
 *
dp
, 
uöt32_t
 
ö_p‹t
, 
oÂbuf
 *
buf
, 
boﬁ
 
∑ckë_out
);

75 
∑ckë_to_°rög
(
∑ckë
 *
pkt
);

79 
∑ckë_de°roy
(
∑ckë
 *
pkt
);

82 
∑ckë
 *

83 
∑ckë_˛⁄e
(
∑ckë
 *
pkt
);

	@udatapath/packet_handle_std.c

31 
	~<°dlib.h
>

32 
	~<°dboﬁ.h
>

33 
	~<°dio.h
>

34 
	~<sys/ty≥s.h
>

35 
	~<√töë/ö.h
>

36 
	~"∑ckë_h™dÀ_°d.h
"

37 
	~"∑ckë.h
"

38 
	~"∑ckës.h
"

39 
	~"oÊib/oÊ-°ru˘s.h
"

40 
	~"›íÊow/›íÊow.h
"

41 
	~"compûî.h
"

43 
	~"lib/hash.h
"

44 
	~"oÊib/oxm-m©ch.h
"

46 
	~"nbì_lök/nbì_lök.h
"

51 
	$∑ckë_h™dÀ_°d_vÆid©e
(
∑ckë_h™dÀ_°d
 *
h™dÀ
) {

53 if(
h™dÀ
->
vÆid
)

55 
oÊ_m©ch_év
 * 
ôî
, *
√xt
;

56 
	`HMAP_FOR_EACH_SAFE
(
ôî
, 
√xt
, 
oÊ_m©ch_év
, 
hm≠_node
, &
h™dÀ
->
m©ch
.
m©ch_fõlds
){

57 
	`‰ì
(
ôî
->
vÆue
);

58 
	`‰ì
(
ôî
);

60 
	`oÊ_°ru˘s_m©ch_öô
(&
h™dÀ
->
m©ch
);

62 i‡(
	`nblök_∑ckë_∑r£
(
h™dÀ
->
pkt
->
buf„r
,&h™dÀ->
m©ch
,

63 
h™dÀ
->
¥Ÿo
) < 0)

66 
h™dÀ
->
vÆid
 = 
åue
;

69 
	`oÊ_°ru˘s_m©ch_put32
(&
h™dÀ
->
m©ch
, 
OXM_OF_IN_PORT
, h™dÀ->
pkt
->
ö_p‹t
);

71 
	`oÊ_°ru˘s_m©ch_put64
(&
h™dÀ
->
m©ch
, 
OXM_OF_METADATA
, 0xffffffffffffffff);

73 
	}
}

76 
∑ckë_h™dÀ_°d
 *

77 
	$∑ckë_h™dÀ_°d_¸óã
(
∑ckë
 *
pkt
) {

78 
∑ckë_h™dÀ_°d
 *
h™dÀ
 = 
	`xmÆloc
((packet_handle_std));

79 
h™dÀ
->
¥Ÿo
 = 
	`xmÆloc
((
¥Ÿocﬁs_°d
));

80 
h™dÀ
->
pkt
 =Ökt;

82 
	`hm≠_öô
(&
h™dÀ
->
m©ch
.
m©ch_fõlds
);

84 
h™dÀ
->
vÆid
 = 
Ál£
;

85 
	`∑ckë_h™dÀ_°d_vÆid©e
(
h™dÀ
);

87  
h™dÀ
;

88 
	}
}

90 
∑ckë_h™dÀ_°d
 *

91 
	$∑ckë_h™dÀ_°d_˛⁄e
(
∑ckë
 *
pkt
, 
∑ckë_h™dÀ_°d
 *
h™dÀ
 
UNUSED
) {

92 
∑ckë_h™dÀ_°d
 *
˛⁄e
 = 
	`xmÆloc
((packet_handle_std));

94 
˛⁄e
->
pkt
 =Ökt;

95 
˛⁄e
->
¥Ÿo
 = 
	`xmÆloc
((
¥Ÿocﬁs_°d
));

96 
	`hm≠_öô
(&
˛⁄e
->
m©ch
.
m©ch_fõlds
);

97 
˛⁄e
->
vÆid
 = 
Ál£
;

100 
	`∑ckë_h™dÀ_°d_vÆid©e
(
˛⁄e
);

102  
˛⁄e
;

103 
	}
}

106 
	$∑ckë_h™dÀ_°d_de°roy
(
∑ckë_h™dÀ_°d
 *
h™dÀ
) {

108 
oÊ_m©ch_év
 * 
ôî
, *
√xt
;

109 
	`HMAP_FOR_EACH_SAFE
(
ôî
, 
√xt
, 
oÊ_m©ch_év
, 
hm≠_node
, &
h™dÀ
->
m©ch
.
m©ch_fõlds
){

110 
	`‰ì
(
ôî
->
vÆue
);

111 
	`‰ì
(
ôî
);

113 
	`‰ì
(
h™dÀ
->
¥Ÿo
);

114 
	`hm≠_de°roy
(&
h™dÀ
->
m©ch
.
m©ch_fõlds
);

115 
	`‰ì
(
h™dÀ
);

116 
	}
}

118 
boﬁ


119 
	$∑ckë_h™dÀ_°d_is_âl_vÆid
(
∑ckë_h™dÀ_°d
 *
h™dÀ
) {

120 
	`∑ckë_h™dÀ_°d_vÆid©e
(
h™dÀ
);

122 i‡(
h™dÀ
->
¥Ÿo
->
m∂s
 !
NULL
) {

123 
uöt32_t
 
âl
 = 
	`¡ohl
(
h™dÀ
->
¥Ÿo
->
m∂s
->
fõlds
Ë& 
MPLS_TTL_MASK
;

124 i‡(
âl
 <= 1) {

125  
Ál£
;

128 i‡(
h™dÀ
->
¥Ÿo
->
ùv4
 !
NULL
) {

129 i‡(
h™dÀ
->
¥Ÿo
->
ùv4
->
ù_âl
 < 1) {

130  
Ál£
;

133  
åue
;

134 
	}
}

136 
boﬁ


137 
	$∑ckë_h™dÀ_°d_is_‰agmít
(
∑ckë_h™dÀ_°d
 *
h™dÀ
) {

138 
	`∑ckë_h™dÀ_°d_vÆid©e
(
h™dÀ
);

140  
Ál£
;

143 
	}
}

146 
boﬁ


147 
	$∑ckë_h™dÀ_°d_m©ch
(
∑ckë_h™dÀ_°d
 *
h™dÀ
, 
oÊ_m©ch
 *
m©ch
){

149 i‡(!
h™dÀ
->
vÆid
){

150 
	`∑ckë_h™dÀ_°d_vÆid©e
(
h™dÀ
);

151 i‡(!
h™dÀ
->
vÆid
){

152  
Ál£
;

156  
	`∑ckë_m©ch
(
m©ch
 ,&
h™dÀ
->match );

157 
	}
}

162 
ölöe
 const *

163 
	$p°r
(*
±r
, c⁄° *
°r
) {

164  (
±r
 =
NULL
Ë? "" : 
°r
;

165 
	}
}

170 
	$¥Ÿo_¥öt
(
FILE
 *
°ªam
, 
¥Ÿocﬁs_°d
 *
p
) {

171 
	`Ârötf
(
°ªam
, "{%s%s%s%s%s%s%s%s%s}",

172 
	`p°r
(
p
->
ëh
, "ëh"),Ö°r’->
vœn
, ",vœn"),Ö°r’->
m∂s
, ",m∂s"),Ö°r’->
ùv4
, ",ipv4"),

173 
	`p°r
(
p
->
¨p
, ",¨p"),Ö°r’->
t˝
, ",t˝"),Ö°r’->
udp
, ",udp"),Ö°r’->
s˘p
, ",sctp"),

174 
	`p°r
(
p
->
icmp
, ",icmp"));

175 
	}
}

178 
	$∑ckë_h™dÀ_°d_to_°rög
(
∑ckë_h™dÀ_°d
 *
h™dÀ
) {

179 *
°r
;

180 
size_t
 
°r_size
;

181 
FILE
 *
°ªam
 = 
	`›í_mem°ªam
(&
°r
, &
°r_size
);

183 
	`∑ckë_h™dÀ_°d_¥öt
(
°ªam
, 
h™dÀ
);

185 
	`f˛o£
(
°ªam
);

186  
°r
;

187 
	}
}

190 
	$∑ckë_h™dÀ_°d_¥öt
(
FILE
 *
°ªam
, 
∑ckë_h™dÀ_°d
 *
h™dÀ
) {

191 
	`∑ckë_h™dÀ_°d_vÆid©e
(
h™dÀ
);

193 
	`Ârötf
(
°ªam
, "{proto=");

194 
	`¥Ÿo_¥öt
(
°ªam
, 
h™dÀ
->
¥Ÿo
);

196 
	`Ârötf
(
°ªam
, ", match=");

197 
	`oÊ_°ru˘s_m©ch_¥öt
(
°ªam
, (
oÊ_m©ch_hódî
 *)(&
h™dÀ
->
m©ch
), h™dÀ->
pkt
->
dp
->
exp
);

198 
	`Ârötf
(
°ªam
, "\"}");

199 
	}
}

	@udatapath/packet_handle_std.h

31 #i‚de‡
PACKET_HANDLE_STD_H


32 
	#PACKET_HANDLE_STD_H
 1

	)

34 
	~<°dboﬁ.h
>

35 
	~<°dio.h
>

36 
	~"∑ckë.h
"

37 
	~"∑ckës.h
"

38 
	~"m©ch_°d.h
"

39 
	~"oÊib/oÊ-°ru˘s.h
"

40 
	~"nbì_lök/nbì_lök.h
"

47 
	s∑ckë_h™dÀ_°d
 {

48 
∑ckë
 *
	mpkt
;

49 
¥Ÿocﬁs_°d
 *
	m¥Ÿo
;

50 
oÊ_m©ch
 
	mm©ch
;

53 
boﬁ
 
	mvÆid
;

56 
boﬁ
 
	mèbÀ_miss
;

61 
∑ckë_h™dÀ_°d
 *

62 
∑ckë_h™dÀ_°d_¸óã
(
∑ckë
 *
pkt
);

66 
∑ckë_h™dÀ_°d_de°roy
(
∑ckë_h™dÀ_°d
 *
h™dÀ
);

69 
boﬁ


70 
∑ckë_h™dÀ_°d_is_âl_vÆid
(
∑ckë_h™dÀ_°d
 *
h™dÀ
);

73 
boﬁ


74 
∑ckë_h™dÀ_°d_is_‰agmít
(
∑ckë_h™dÀ_°d
 *
h™dÀ
);

77 
boﬁ


78 
∑ckë_h™dÀ_°d_m©ch
(
∑ckë_h™dÀ_°d
 *
h™dÀ
, 
oÊ_m©ch
 *
m©ch
);

82 
∑ckë_h™dÀ_°d_to_°rög
(
∑ckë_h™dÀ_°d
 *
h™dÀ
);

85 
∑ckë_h™dÀ_°d_¥öt
(
FILE
 *
°ªam
, 
∑ckë_h™dÀ_°d
 *
h™dÀ
);

88 
∑ckë_h™dÀ_°d
 *

89 
∑ckë_h™dÀ_°d_˛⁄e
(
∑ckë
 *
pkt
, 
∑ckë_h™dÀ_°d
 *
h™dÀ
);

93 
∑ckë_h™dÀ_°d_vÆid©e
(
∑ckë_h™dÀ_°d
 *
h™dÀ
);

	@udatapath/pipeline.c

31 
	~<sys/ty≥s.h
>

32 
	~<°dboﬁ.h
>

33 
	~<°dlib.h
>

35 
	~"a˘i⁄_£t.h
"

36 
	~"compûî.h
"

37 
	~"dp_a˘i⁄s.h
"

38 
	~"dp_buf„rs.h
"

39 
	~"dp_exp.h
"

40 
	~"dp_p‹ts.h
"

41 
	~"d©≠©h.h
"

42 
	~"∑ckë.h
"

43 
	~"pùñöe.h
"

44 
	~"Êow_èbÀ.h
"

45 
	~"Êow_íåy.h
"

46 
	~"mëî_èbÀ.h
"

47 
	~"oÊib/oÊ.h
"

48 
	~"oÊib/oÊ-°ru˘s.h
"

49 
	~"nbì_lök/nbì_lök.h
"

50 
	~"utû.h
"

51 
	~"hash.h
"

52 
	~"oÊib/oxm-m©ch.h
"

53 
	~"vlog.h
"

54 
	~"°©e_èbÀ.h
"

57 
	#LOG_MODULE
 
VLM_pùñöe


	)

59 
vlog_øã_limô
 
	gæ
 = 
VLOG_RATE_LIMIT_INIT
(60, 60);

62 
execuã_íåy
(
pùñöe
 *
∂
, 
Êow_íåy
 *
íåy
,

63 
Êow_èbÀ
 **
èbÀ
, 
∑ckë
 **
pkt
);

65 
pùñöe
 *
	$pùñöe_¸óã
(
d©≠©h
 *
dp
) {

66 
pùñöe
 *
∂
;

67 
i
;

68 
	`¥ötf
("here isÅhe createÖipeline\n");

72 
∂
 = 
	`xmÆloc
((
pùñöe
));

74 
i
=0; i<
PIPELINE_TABLES
; i++)

76 
∂
->
èbÀs
[
i
] = 
	`Êow_èbÀ_¸óã
(
dp
, i);

79 
∂
->
dp
 = dp;

81 
	`nblök_öôülize
();

84 i‡(
∂
->
èbÀs
[0])

87 
∂
->
èbÀs
[0]->
„©uªs
->
c⁄fig
=
OFPTC_TABLE_STATEFUL
;

89 
°©e_èbÀ
 *
°abÀ
 = 
∂
->
èbÀs
[0]->state_table;

90 
key_exåa˘‹
 *
kext
;

91 
kext

	`xmÆloc
((
key_exåa˘‹
));

92 
kext
->
fõld_cou¡
=1;

94 
kext
->
fõlds
[0]=
OXM_OF_ETH_SRC
;

96 
upd©e
;

97 
upd©e
=0;update<2;++update)

99 
	`°©e_èbÀ_£t_exåa˘‹
(
°abÀ
,
kext
,
upd©e
);

101 
numbî_Êow_íåy
=0;

102 
numbî_Êow_íåy
;number_flow_entry<2;number_flow_entry++)

104 
oÊ_îr
 
îr‹
=0;

105 
boﬁ
 
m©ch_kït
 = 
Ál£
;

106 
boﬁ
 
ö°s_kït
 = 
Ál£
;

107 
oÊ_msg_Êow_mod
 *
msg
=
	`xmÆloc
((ofl_msg_flow_mod));

108 
oÊ_m©ch
 *
m
 = 
	`xmÆloc
((ofl_match));

109 
	`oÊ_°ru˘s_m©ch_öô
(
m
);

111 
msg
->
èbÀ_id
=0;

112 
msg
->
comm™d
=
OFPFC_ADD
;

114 
uöt64_t
 
mëad©a
=
numbî_Êow_íåy
;

115 
	`oÊ_°ru˘s_m©ch_put64
(
m
, 
OXM_OF_METADATA
, 
mëad©a
);

116 
msg
-> 
m©ch
 = (
oÊ_m©ch_hódî
 *)
m
;

119 
msg
->
ö°ru˘i⁄s_num
=1;

120 
msg
->
ö°ru˘i⁄s
=
	`xmÆloc
((
oÊ_ö°ru˘i⁄_hódî
 *Ë* msg->
ö°ru˘i⁄s_num
);

121 
oÊ_ö°ru˘i⁄_£t_°©e
 *
i
 = 
	`xmÆloc
((ofl_instruction_set_state ));

122 
i
->
hódî
.
ty≥
 = 
OFPIT_SET_STATE
;

123 
i
->
°©e
=
numbî_Êow_íåy
+1;

124 
msg
->
ö°ru˘i⁄s
[0](
oÊ_ö°ru˘i⁄_hódî
 *)
i
;

127 
msg
->
h¨d_timeout
=
OFP_FLOW_PERMANENT
;

128 
msg
->
idÀ_timeout
=
OFP_FLOW_PERMANENT
;

129 
msg
->
¥i‹ôy
 = 
OFP_DEFAULT_PRIORITY
;

132 
îr‹
=
	`Êow_èbÀ_Êow_mod
(
∂
->
èbÀs
[0],
msg
,&
m©ch_kït
,&
ö°s_kït
);

133 i‡(
îr‹
){

134 
	`¥ötf
("error for flow mod\n");

137 
	`oÊ_msg_‰ì_Êow_mod
(
msg
, !
m©ch_kït
, !
ö°s_kït
, 
∂
->
dp
->
exp
);

138 
	`¥ötf
("free flow mod msg\n");

146  
∂
;

147 
	}
}

168 
boﬁ


169 
	$is_èbÀ_miss
(
Êow_íåy
 *
íåy
){

172  ((
íåy
->
°©s
->
¥i‹ôy
Ë=0 && (íåy->
m©ch
->
Àngth
 <= 4));

174 
	}
}

179 
	$£nd_∑ckë_to_c⁄åﬁÀr
(
pùñöe
 *
∂
, 
∑ckë
 *
pkt
, 
uöt8_t
 
èbÀ_id
, uöt8_à
ªas⁄
) {

181 
	`¥ötf
("here is sendÖacketÅo controller\n");

182 
oÊ_msg_∑ckë_ö
 
msg
;

183 
oÊ_m©ch
 *
m
;

184 
msg
.
hódî
.
ty≥
 = 
OFPT_PACKET_IN
;

185 
msg
.
tŸÆ_Àn
 = 
pkt
->
buf„r
->
size
;

186 
msg
.
ªas⁄
 =Ñeason;

187 
msg
.
èbÀ_id
 =Åable_id;

188 
msg
.
cookõ
 = 0xffffffffffffffff;

189 
msg
.
d©a
 = 
pkt
->
buf„r
->data;

194 i‡(
∂
->
dp
->
c⁄fig
.
miss_£nd_Àn
 !
OFPCML_NO_BUFFER
){

195 
	`dp_buf„rs_ßve
(
∂
->
dp
->
buf„rs
, 
pkt
);

196 
msg
.
buf„r_id
 = 
pkt
->buffer_id;

197 
msg
.
d©a_Àngth
 = 
	`MIN
(
∂
->
dp
->
c⁄fig
.
miss_£nd_Àn
, 
pkt
->
buf„r
->
size
);

199 
msg
.
buf„r_id
 = 
OFP_NO_BUFFER
;

200 
msg
.
d©a_Àngth
 = 
pkt
->
buf„r
->
size
;

203 
m
 = &
pkt
->
h™dÀ_°d
->
m©ch
;

207 
msg
.
m©ch
 = (
oÊ_m©ch_hódî
*)
m
;

208 
	`dp_£nd_mesßge
(
∂
->
dp
, (
oÊ_msg_hódî
 *)&
msg
, 
NULL
);

209 
	`oÊ_°ru˘s_‰ì_m©ch
((
oÊ_m©ch_hódî
* ) 
m
, 
NULL
);

210 
	}
}

213 
	$pùñöe_¥o˚ss_∑ckë
(
pùñöe
 *
∂
, 
∑ckë
 *
pkt
) {

214 
Êow_èbÀ
 *
èbÀ
, *
√xt_èbÀ
;

218 i‡(
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

219 *
pkt_°r
 = 
	`∑ckë_to_°rög
(
pkt
);

220 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "¥o˚ssögÖackë: %s", 
pkt_°r
);

221 
	`‰ì
(
pkt_°r
);

224 i‡(!
	`∑ckë_h™dÀ_°d_is_âl_vÆid
(
pkt
->
h™dÀ_°d
)) {

225 i‡((
∂
->
dp
->
c⁄fig
.
Êags
 & 
OFPC_INVALID_TTL_TO_CONTROLLER
) != 0) {

226 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "Packet has invalid TTL, sendingÅo controller.");

228 
	`£nd_∑ckë_to_c⁄åﬁÀr
(
∂
, 
pkt
, 0 , 
OFPR_INVALID_TTL
);

230 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "Packet has invalid TTL, dropping.");

232 
	`∑ckë_de°roy
(
pkt
);

236 
√xt_èbÀ
 = 
∂
->
èbÀs
[0];

237 
√xt_èbÀ
 !
NULL
) {

238 
Êow_íåy
 *
íåy
;

239 
°©e_íåy
 *state_entry;

241 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "åyögÅabÀ %u.", 
√xt_èbÀ
->
°©s
->
èbÀ_id
);

243 
pkt
->
èbÀ_id
 = 
√xt_èbÀ
->
°©s
->table_id;

244 
èbÀ
 = 
√xt_èbÀ
;

245 
√xt_èbÀ
 = 
NULL
;

248 i‡(
èbÀ
->
„©uªs
->
c⁄fig
 &
OFPTC_TABLE_STATEFUL
) {

250 
°©e_íåy
 = 
	`°©e_èbÀ_lookup
(
èbÀ
->
°©e_èbÀ
, 
pkt
);

251 
	`°©e_èbÀ_wrôe_mëad©a
(
°©e_íåy
, 
pkt
);

256 i‡(
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

257 *
m
 = 
	`oÊ_°ru˘s_m©ch_to_°rög
((
oÊ_m©ch_hódî
*)&(
pkt
->
h™dÀ_°d
->
m©ch
),Ökt->
dp
->
exp
);

258 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "£¨chögÅabÀÉ¡ry f‹Öackë m©ch: %s.", 
m
);

259 
	`¥ötf
("searchingÅableÉntry forÖkt match\n");

260 
	`‰ì
(
m
);

263 
íåy
 = 
	`Êow_èbÀ_lookup
(
èbÀ
, 
pkt
);

265 i‡(
íåy
 !
NULL
) {

266 i‡(
	`VLOG_IS_DBG_ENABLED
(
LOG_MODULE
)) {

267 *
m
 = 
	`oÊ_°ru˘s_Êow_°©s_to_°rög
(
íåy
->
°©s
, 
pkt
->
dp
->
exp
);

268 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "found m©chögÉ¡ry: %s.", 
m
);

269 
	`‰ì
(
m
);

270 
	`¥ötf
("find matchingÉntry\n");

273 
pkt
->
h™dÀ_°d
->
èbÀ_miss
 = 
	`is_èbÀ_miss
(
íåy
);

274 
	`execuã_íåy
(
∂
, 
íåy
, &
√xt_èbÀ
, &
pkt
);

276 i‡(!
pkt
)

279 i‡(
√xt_èbÀ
 =
NULL
) {

283 
	`a˘i⁄_£t_execuã
(
pkt
->
a˘i⁄_£t
,Ökt, 0xffffffffffffffff);

284 
	`∑ckë_de°roy
(
pkt
);

290 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "No matchingÉntry found. DroppingÖacket.");

291 
	`∑ckë_de°roy
(
pkt
);

292 
	`¥ötf
("No matchingÉntry found. DroppingÖacket.\n");

296 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "Reached outside ofÖipelineÖrocessing cycle.");

297 
	}
}

300 
	$ö°_com∑ª
(c⁄° *
ö°1
, c⁄° *
ö°2
){

301 
	`¥ötf
("here is comparingÖriority instructions\n");

302 
oÊ_ö°ru˘i⁄_hódî
 * 
i1
 = *(oÊ_ö°ru˘i⁄_hódî **Ë
ö°1
;

303 
oÊ_ö°ru˘i⁄_hódî
 * 
i2
 = *(oÊ_ö°ru˘i⁄_hódî **Ë
ö°2
;

304 i‡((
i1
->
ty≥
 =
OFPIT_APPLY_ACTIONS
 && 
i2
->ty≥ =
OFPIT_CLEAR_ACTIONS
) ||

305 (
i1
->
ty≥
 =
OFPIT_CLEAR_ACTIONS
 && 
i2
->ty≥ =
OFPIT_APPLY_ACTIONS
))

306  
i1
->
ty≥
 > 
i2
->type;

308  
i1
->
ty≥
 < 
i2
->type;

309 
	}
}

311 
oÊ_îr


312 
	$pùñöe_h™dÀ_°©e_mod
(
pùñöe
 *
∂
, 
oÊ_msg_°©e_mod
 *
msg
,

313 c⁄° 
£ndî
 *sender) {

314 
	`¥ötf
("here is handle state mod func\n");

315 
oÊ_îr
 
îr‹
;

316 
°©e_èbÀ
 *
°
 = 
∂
->
èbÀs
[
msg
->
èbÀ_id
]->state_table;

318 i‡(
msg
->
comm™d
 =
OFPSC_SET_L_EXTRACTOR
 || msg->comm™d =
OFPSC_SET_U_EXTRACTOR
) {

319 
oÊ_msg_exåa˘i⁄
 *
p
 = (oÊ_msg_exåa˘i⁄ *Ë
msg
->
∑ylﬂd
;

321 
upd©e
 = 0;

322 i‡(
msg
->
comm™d
 =
OFPSC_SET_U_EXTRACTOR
)

323 
upd©e
 == 1;

325 
	`°©e_èbÀ_£t_exåa˘‹
(
°
, (
key_exåa˘‹
 *)
p
, 
upd©e
);

327 i‡(
msg
->
comm™d
 =
OFPSC_ADD_FLOW_STATE
) {

328 
oÊ_msg_°©e_íåy
 *
p
 = (oÊ_msg_°©e_íåy *Ë
msg
->
∑ylﬂd
;

330 
	`°©e_èbÀ_£t_°©e
(
°
, 
NULL
, 
p
->
°©e
,Ö->
key
,Ö->
key_Àn
);

332 i‡(
msg
->
comm™d
 =
OFPSC_DEL_FLOW_STATE
) {

333 
oÊ_msg_°©e_íåy
 *
p
 = (oÊ_msg_°©e_íåy *Ë
msg
->
∑ylﬂd
;

334 
	`°©e_èbÀ_dñ_°©e
(
°
, 
p
->
key
,Ö->
key_Àn
);

340 
	}
}

342 
oÊ_îr


343 
	$pùñöe_h™dÀ_Êow_mod
(
pùñöe
 *
∂
, 
oÊ_msg_Êow_mod
 *
msg
,

344 c⁄° 
£ndî
 *sender) {

345 
	`¥ötf
("here is handle flow mod func\n");

349 
oÊ_îr
 
îr‹
;

350 
size_t
 
i
;

351 
boﬁ
 
m©ch_kït
,
ö°s_kït
;

353 if(
£ndî
->
ªmŸe
->
rﬁe
 =
OFPCR_ROLE_SLAVE
)

354  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_IS_SLAVE
);

356 
m©ch_kït
 = 
Ál£
;

357 
ö°s_kït
 = 
Ál£
;

360 
	`qs‹t
(
msg
->
ö°ru˘i⁄s
, msg->
ö°ru˘i⁄s_num
,

361 (
oÊ_ö°ru˘i⁄_hódî
 *), 
ö°_com∑ª
);

364 
i
=0; i< 
msg
->
ö°ru˘i⁄s_num
; i++) {

365 i‡(
msg
->
ö°ru˘i⁄s
[
i
]->
ty≥
 =
OFPIT_APPLY_ACTIONS
 ||

366 
msg
->
ö°ru˘i⁄s
[
i
]->
ty≥
 =
OFPIT_WRITE_ACTIONS
) {

367 
oÊ_ö°ru˘i⁄_a˘i⁄s
 *
ü
 = (oÊ_ö°ru˘i⁄_a˘i⁄†*)
msg
->
ö°ru˘i⁄s
[
i
];

369 
îr‹
 = 
	`dp_a˘i⁄s_vÆid©e
(
∂
->
dp
, 
ü
->
a˘i⁄s_num
, ia->
a˘i⁄s
);

370 i‡(
îr‹
) {

371  
îr‹
;

373 
îr‹
 = 
	`dp_a˘i⁄s_check_£t_fõld_ªq
(
msg
, 
ü
->
a˘i⁄s_num
, ia->
a˘i⁄s
);

374 i‡(
îr‹
) {

375  
îr‹
;

380 i‡(
msg
->
èbÀ_id
 == 0xff) {

381 i‡(
msg
->
comm™d
 =
OFPFC_DELETE
 || msg->comm™d =
OFPFC_DELETE_STRICT
) {

382 
size_t
 
i
;

384 
îr‹
 = 0;

385 
i
=0; i < 
PIPELINE_TABLES
; i++) {

386 
îr‹
 = 
	`Êow_èbÀ_Êow_mod
(
∂
->
èbÀs
[
i
], 
msg
, &
m©ch_kït
, &
ö°s_kït
);

387 i‡(
îr‹
) {

391 i‡(
îr‹
) {

392  
îr‹
;

394 
	`oÊ_msg_‰ì_Êow_mod
(
msg
, !
m©ch_kït
, !
ö°s_kït
, 
∂
->
dp
->
exp
);

398  
	`oÊ_îr‹
(
OFPET_FLOW_MOD_FAILED
, 
OFPFMFC_BAD_TABLE_ID
);

401 
îr‹
 = 
	`Êow_èbÀ_Êow_mod
(
∂
->
èbÀs
[
msg
->
èbÀ_id
], msg, &
m©ch_kït
, &
ö°s_kït
);

402 i‡(
îr‹
) {

403  
îr‹
;

405 i‡((
msg
->
comm™d
 =
OFPFC_ADD
 || msg->comm™d =
OFPFC_MODIFY
 || msg->comm™d =
OFPFC_MODIFY_STRICT
) &&

406 
msg
->
buf„r_id
 !
NO_BUFFER
) {

408 
∑ckë
 *
pkt
;

410 
pkt
 = 
	`dp_buf„rs_ªåõve
(
∂
->
dp
->
buf„rs
, 
msg
->
buf„r_id
);

411 i‡(
pkt
 !
NULL
) {

412 
	`pùñöe_¥o˚ss_∑ckë
(
∂
, 
pkt
);

414 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "Thêbuf„∏Êow_modÑe„ºedÅÿwa†em±y (%u).", 
msg
->
buf„r_id
);

418 
	`oÊ_msg_‰ì_Êow_mod
(
msg
, !
m©ch_kït
, !
ö°s_kït
, 
∂
->
dp
->
exp
);

422 
	}
}

424 
oÊ_îr


425 
	$pùñöe_h™dÀ_èbÀ_mod
(
pùñöe
 *
∂
,

426 
oÊ_msg_èbÀ_mod
 *
msg
,

427 c⁄° 
£ndî
 *sender) {

429 
	`¥ötf
("here is handleÅable mod func\n");

430 if(
£ndî
->
ªmŸe
->
rﬁe
 =
OFPCR_ROLE_SLAVE
)

431  
	`oÊ_îr‹
(
OFPET_BAD_REQUEST
, 
OFPBRC_IS_SLAVE
);

433 i‡(
msg
->
èbÀ_id
 == 0xff) {

434 
size_t
 
i
;

436 
i
=0; i<
PIPELINE_TABLES
; i++) {

437 
∂
->
èbÀs
[
i
]->
„©uªs
->
c⁄fig
 = 
msg
->config;

440 
∂
->
èbÀs
[
msg
->
èbÀ_id
]->
„©uªs
->
c⁄fig
 = msg->config;

443 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
∂
->
dp
->
exp
);

445 
	}
}

447 
oÊ_îr


448 
	$pùñöe_h™dÀ_°©s_ªque°_Êow
(
pùñöe
 *
∂
,

449 
oÊ_msg_mu…ù¨t_ªque°_Êow
 *
msg
,

450 c⁄° 
£ndî
 *sender) {

452 
	`¥ötf
("here is handle statisticÑequest flow\n");

453 
oÊ_Êow_°©s
 **
°©s
 = 
	`xmÆloc
((ofl_flow_stats *));

454 
size_t
 
°©s_size
 = 1;

455 
size_t
 
°©s_num
 = 0;

457 i‡(
msg
->
èbÀ_id
 == 0xff) {

458 
size_t
 
i
;

459 
i
=0; i<
PIPELINE_TABLES
; i++) {

460 
	`Êow_èbÀ_°©s
(
∂
->
èbÀs
[
i
], 
msg
, &
°©s
, &
°©s_size
, &
°©s_num
);

463 
	`Êow_èbÀ_°©s
(
∂
->
èbÀs
[
msg
->
èbÀ_id
], msg, &
°©s
, &
°©s_size
, &
°©s_num
);

467 
oÊ_msg_mu…ù¨t_ª∂y_Êow
 
ª∂y
 =

468 {{{.
ty≥
 = 
OFPT_MULTIPART_REPLY
},

469 .
ty≥
 = 
OFPMP_FLOW
, .
Êags
 = 0x0000},

470 .
°©s
 = stats,

471 .
°©s_num
 = stats_num

474 
	`dp_£nd_mesßge
(
∂
->
dp
, (
oÊ_msg_hódî
 *)&
ª∂y
, 
£ndî
);

477 
	`‰ì
(
°©s
);

478 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
∂
->
dp
->
exp
);

480 
	}
}

482 
oÊ_îr


483 
	$pùñöe_h™dÀ_°©s_ªque°_èbÀ
(
pùñöe
 *
∂
,

484 
oÊ_msg_mu…ù¨t_ªque°_hódî
 *
msg
 
UNUSED
,

485 c⁄° 
£ndî
 *sender) {

486 
	`¥ötf
("here is handle statisticÑequestÅable\n");

487 
oÊ_èbÀ_°©s
 **
°©s
;

488 
size_t
 
i
;

490 
°©s
 = 
	`xmÆloc
((
oÊ_èbÀ_°©s
 *Ë* 
PIPELINE_TABLES
);

492 
i
=0; i<
PIPELINE_TABLES
; i++) {

493 
°©s
[
i
] = 
∂
->
èbÀs
[i]->stats;

497 
oÊ_msg_mu…ù¨t_ª∂y_èbÀ
 
ª∂y
 =

498 {{{.
ty≥
 = 
OFPT_MULTIPART_REPLY
},

499 .
ty≥
 = 
OFPMP_TABLE
, .
Êags
 = 0x0000},

500 .
°©s
 = stats,

501 .
°©s_num
 = 
PIPELINE_TABLES
};

503 
	`dp_£nd_mesßge
(
∂
->
dp
, (
oÊ_msg_hódî
 *)&
ª∂y
, 
£ndî
);

506 
	`‰ì
(
°©s
);

507 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
∂
->
dp
->
exp
);

509 
	}
}

511 
oÊ_îr


512 
	$pùñöe_h™dÀ_°©s_ªque°_èbÀ_„©uªs_ªque°
(
pùñöe
 *
∂
,

513 
oÊ_msg_mu…ù¨t_ªque°_hódî
 *
msg
,

514 c⁄° 
£ndî
 *sender) {

515 
	`¥ötf
("here is handle statisticÑequestÅable feature\n");

516 
size_t
 
i
, 
j
;

517 
oÊ_èbÀ_„©uªs
 **
„©uªs
;

518 
oÊ_msg_mu…ù¨t_ªque°_èbÀ_„©uªs
 *
„©
 =

519 (
oÊ_msg_mu…ù¨t_ªque°_èbÀ_„©uªs
 *Ë
msg
;

522 if(
„©
->
èbÀ_„©uªs
 !
NULL
){

525 
i
 = 0; i < 
„©
->
èbÀs_num
; i++){

526 
∂
->
èbÀs
[
„©
->
èbÀ_„©uªs
[
i
]->
èbÀ_id
]->
„©uªs
 = feat->table_features[i];

530 
j
 = 0;

532 
lo›
: ;

533 
„©uªs
 = (
oÊ_èbÀ_„©uªs
**Ë
	`xmÆloc
((ofl_table_features *) * 8);

534 
i
 = 0; i < 8; i++){

535 
„©uªs
[
i
] = 
∂
->
èbÀs
[
j
]->features;

536 
j
++;

539 
oÊ_msg_mu…ù¨t_ª∂y_èbÀ_„©uªs
 
ª∂y
 =

540 {{{.
ty≥
 = 
OFPT_MULTIPART_REPLY
},

541 .
ty≥
 = 
OFPMP_TABLE_FEATURES
, .
Êags
 = 
j
 =
PIPELINE_TABLES
? 0x00000000:
OFPMPF_REPLY_MORE
},

542 .
èbÀ_„©uªs
 = 
„©uªs
,

543 .
èbÀs_num
 = 8};

544 
	`dp_£nd_mesßge
(
∂
->
dp
, (
oÊ_msg_hódî
 *)&
ª∂y
, 
£ndî
);

546 i‡(
j
 < 
PIPELINE_TABLES
){

547 
lo›
;

551 
	}
}

553 
oÊ_îr


554 
	$pùñöe_h™dÀ_°©s_ªque°_aggªg©e
(
pùñöe
 *
∂
,

555 
oÊ_msg_mu…ù¨t_ªque°_Êow
 *
msg
,

556 c⁄° 
£ndî
 *sender) {

557 
	`¥ötf
("here is handle statisticÑequestággregatation\n");

558 
oÊ_msg_mu…ù¨t_ª∂y_aggªg©e
 
ª∂y
 =

559 {{{.
ty≥
 = 
OFPT_MULTIPART_REPLY
},

560 .
ty≥
 = 
OFPMP_AGGREGATE
, .
Êags
 = 0x0000},

561 .
∑ckë_cou¡
 = 0,

562 .
byã_cou¡
 = 0,

563 .
Êow_cou¡
 = 0};

565 i‡(
msg
->
èbÀ_id
 == 0xff) {

566 
size_t
 
i
;

568 
i
=0; i<
PIPELINE_TABLES
; i++) {

569 
	`Êow_èbÀ_aggªg©e_°©s
(
∂
->
èbÀs
[
i
], 
msg
,

570 &
ª∂y
.
∑ckë_cou¡
, &ª∂y.
byã_cou¡
, &ª∂y.
Êow_cou¡
);

574 
	`Êow_èbÀ_aggªg©e_°©s
(
∂
->
èbÀs
[
msg
->
èbÀ_id
], msg,

575 &
ª∂y
.
∑ckë_cou¡
, &ª∂y.
byã_cou¡
, &ª∂y.
Êow_cou¡
);

578 
	`dp_£nd_mesßge
(
∂
->
dp
, (
oÊ_msg_hódî
 *)&
ª∂y
, 
£ndî
);

580 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
msg
, 
∂
->
dp
->
exp
);

582 
	}
}

586 
	$pùñöe_de°roy
(
pùñöe
 *
∂
) {

587 
Êow_èbÀ
 *
èbÀ
;

588 
i
;

590 
	`¥ötf
("here is handle destroyÖipeline\n");

591 
i
=0; i<
PIPELINE_TABLES
; i++) {

592 
èbÀ
 = 
∂
->
èbÀs
[
i
];

593 i‡(
èbÀ
 !
NULL
) {

594 
	`Êow_èbÀ_de°roy
(
èbÀ
);

597 
	`‰ì
(
∂
);

598 
	}
}

602 
	$pùñöe_timeout
(
pùñöe
 *
∂
) {

603 
i
;

605 
	`¥ötf
("here is handleÅimeoutÖipeline\n");

606 
i
 = 0; i < 
PIPELINE_TABLES
; i++) {

607 
	`Êow_èbÀ_timeout
(
∂
->
èbÀs
[
i
]);

609 
	}
}

614 
	$execuã_íåy
(
pùñöe
 *
∂
, 
Êow_íåy
 *
íåy
,

615 
Êow_èbÀ
 **
√xt_èbÀ
, 
∑ckë
 **
pkt
) {

625 
	`¥ötf
("here is handleÉxecution of intruction forÉach flowÉntry\n");

626 
size_t
 
i
;

627 
oÊ_ö°ru˘i⁄_hódî
 *
ö°
;

629 
i
=0; i < 
íåy
->
°©s
->
ö°ru˘i⁄s_num
; i++) {

632 if(!(*
pkt
)){

636 
ö°
 = 
íåy
->
°©s
->
ö°ru˘i⁄s
[
i
];

637 
ö°
->
ty≥
) {

638 
OFPIT_GOTO_TABLE
: {

639 
oÊ_ö°ru˘i⁄_gŸo_èbÀ
 *
gi
 = (oÊ_ö°ru˘i⁄_gŸo_èbÀ *)
ö°
;

641 *
√xt_èbÀ
 = 
∂
->
èbÀs
[
gi
->
èbÀ_id
];

644 
OFPIT_WRITE_METADATA
: {

645 
oÊ_ö°ru˘i⁄_wrôe_mëad©a
 *
wi
 = (oÊ_ö°ru˘i⁄_wrôe_mëad©®*)
ö°
;

646 
oÊ_m©ch_év
 *
f
;

650 
	`∑ckë_h™dÀ_°d_vÆid©e
((*
pkt
)->
h™dÀ_°d
);

652 
	`HMAP_FOR_EACH_WITH_HASH
(
f
, 
oÊ_m©ch_év
,

653 
hm≠_node
, 
	`hash_öt
(
OXM_OF_METADATA
,0), &(*
pkt
)->
h™dÀ_°d
->
m©ch
.
m©ch_fõlds
){

654 
uöt64_t
 *
mëad©a
 = (uöt64_t*Ë
f
->
vÆue
;

655 *
mëad©a
 = (*mëad©®& ~
wi
->
mëad©a_mask
) | (wi->metadata & wi->metadata_mask);

656 
	`VLOG_DBG_RL
(
LOG_MODULE
, &
æ
, "Executög wrôêmëad©a: %Œx", *
mëad©a
);

660 
OFPIT_WRITE_ACTIONS
: {

661 
oÊ_ö°ru˘i⁄_a˘i⁄s
 *
wa
 = (oÊ_ö°ru˘i⁄_a˘i⁄†*)
ö°
;

662 
	`a˘i⁄_£t_wrôe_a˘i⁄s
((*
pkt
)->
a˘i⁄_£t
, 
wa
->
a˘i⁄s_num
, wa->
a˘i⁄s
);

665 
OFPIT_APPLY_ACTIONS
: {

666 
oÊ_ö°ru˘i⁄_a˘i⁄s
 *
ü
 = (oÊ_ö°ru˘i⁄_a˘i⁄†*)
ö°
;

667 
	`dp_execuã_a˘i⁄_li°
((*
pkt
), 
ü
->
a˘i⁄s_num
, ia->
a˘i⁄s
, 
íåy
->
°©s
->
cookõ
);

670 
OFPIT_CLEAR_ACTIONS
: {

671 
	`a˘i⁄_£t_˛ór_a˘i⁄s
((*
pkt
)->
a˘i⁄_£t
);

674 
OFPIT_METER
: {

675 
oÊ_ö°ru˘i⁄_mëî
 *
im
 = (oÊ_ö°ru˘i⁄_mëî *)
ö°
;

676 
	`mëî_èbÀ_≠∂y
(
∂
->
dp
->
mëîs
, 
pkt
, 
im
->
mëî_id
);

679 
OFPIT_EXPERIMENTER
: {

680 
	`dp_exp_ö°
((*
pkt
), (
oÊ_ö°ru˘i⁄_ex≥rimíãr
 *)
ö°
);

683 
OFPIT_SET_STATE
: {

684 
oÊ_ö°ru˘i⁄_£t_°©e
 *
wns
 = (oÊ_ö°ru˘i⁄_£t_°©ê*)
ö°
;

685 
°©e_èbÀ
 *
°
 = 
∂
->
èbÀs
[(*
pkt
)->
èbÀ_id
]->state_table;

686 
	`¥ötf
("executing instruction NEXT STATE\n");

687 
	`°©e_èbÀ_£t_°©e
(
°
, *
pkt
, 
wns
->
°©e
, 
NULL
, 0);

692 
	}
}

	@udatapath/pipeline.h

31 #i‚de‡
PIPELINE_H


32 
	#PIPELINE_H
 1

	)

35 
	~"d©≠©h.h
"

36 
	~"∑ckë.h
"

37 
	~"Êow_èbÀ.h
"

38 
	~"oÊib/oÊ.h
"

39 
	~"oÊib/oÊ-mesßges.h
"

42 
	g£ndî
;

50 
	spùñöe
 {

51 
d©≠©h
 *
	mdp
;

52 
Êow_èbÀ
 *
	mèbÀs
[
PIPELINE_TABLES
];

57 
pùñöe
 *

58 
pùñöe_¸óã
(
d©≠©h
 *
dp
);

62 
pùñöe_¥o˚ss_∑ckë
(
pùñöe
 *
∂
, 
∑ckë
 *
pkt
);

66 
oÊ_îr


67 
pùñöe_h™dÀ_Êow_mod
(
pùñöe
 *
∂
, 
oÊ_msg_Êow_mod
 *
msg
,

68 c⁄° 
£ndî
 *sender);

71 
oÊ_îr


72 
pùñöe_h™dÀ_èbÀ_mod
(
pùñöe
 *
∂
,

73 
oÊ_msg_èbÀ_mod
 *
msg
,

74 c⁄° 
£ndî
 *sender);

77 
oÊ_îr


78 
pùñöe_h™dÀ_°©s_ªque°_Êow
(
pùñöe
 *
∂
,

79 
oÊ_msg_mu…ù¨t_ªque°_Êow
 *
msg
,

80 c⁄° 
£ndî
 *sender);

83 
oÊ_îr


84 
pùñöe_h™dÀ_°©s_ªque°_èbÀ
(
pùñöe
 *
∂
,

85 
oÊ_msg_mu…ù¨t_ªque°_hódî
 *
msg
,

86 c⁄° 
£ndî
 *sender);

89 
oÊ_îr


90 
pùñöe_h™dÀ_°©s_ªque°_èbÀ_„©uªs_ªque°
(
pùñöe
 *
∂
,

91 
oÊ_msg_mu…ù¨t_ªque°_hódî
 *
msg
,

92 c⁄° 
£ndî
 *sender);

95 
oÊ_îr


96 
pùñöe_h™dÀ_°©s_ªque°_aggªg©e
(
pùñöe
 *
∂
,

97 
oÊ_msg_mu…ù¨t_ªque°_Êow
 *
msg
,

98 c⁄° 
£ndî
 *sender);

102 
oÊ_îr


103 
pùñöe_h™dÀ_°©e_mod
(
pùñöe
 *
∂
, 
oÊ_msg_°©e_mod
 *
msg
,

104 c⁄° 
£ndî
 *sender);

108 
pùñöe_timeout
(
pùñöe
 *
∂
);

112 
pùñöe_de°roy
(
pùñöe
 *
∂
);

	@udatapath/state_table.c

1 
	~"°©e_èbÀ.h
"

2 
	~"oÊib/oÊ-°ru˘s.h
"

3 
	~"oÊib/oxm-m©ch.h
"

4 
	~"lib/hash.h
"

6 
__exåa˘_key
(
uöt8_t
 *, 
key_exåa˘‹
 *, 
∑ckë
 *);

8 
°©e_èbÀ
 * 
	$°©e_èbÀ_¸óã
() {

9 
°©e_èbÀ
 *
èbÀ
 = 
	`mÆloc
((state_table));

10 
	`mem£t
(
èbÀ
, 0, (*table));

12 
èbÀ
->
°©e_íåõs
 = (
hm≠
Ë
	`HMAP_INITIALIZER
(&table->state_entries);

15 
èbÀ
->
deÁu…_°©e_íåy
.
°©e
 = 
STATE_DEFAULT
;

17  
èbÀ
;

18 
	}
}

20 
	$°©e_èbÀ_de°roy
(
°©e_èbÀ
 *
èbÀ
) {

21 
	`hm≠_de°roy
(&
èbÀ
->
°©e_íåõs
);

22 
	`‰ì
(
èbÀ
);

23 
	}
}

25 
	$__exåa˘_key
(
uöt8_t
 *
buf
, 
key_exåa˘‹
 *
exåa˘‹
, 
∑ckë
 *
pkt
) {

26 
i
, 
l
=0;

27 
oÊ_m©ch_év
 *
f
;

29 
i
=0; i<
exåa˘‹
->
fõld_cou¡
; i++) {

30 
uöt32_t
 
ty≥
 = ()
exåa˘‹
->
fõlds
[
i
];

32 
	`HMAP_FOR_EACH_WITH_HASH
(
f
, 
oÊ_m©ch_év
,

33 
hm≠_node
, 
	`hash_öt
(
ty≥
, 0), &
pkt
->
h™dÀ_°d
->
m©ch
.
m©ch_fõlds
){

36 i‡(
ty≥
 =
f
->
hódî
) {

37 
	`mem˝y
(&
buf
[
l
], 
f
->
vÆue
, 
	`OXM_LENGTH
(f->
hódî
));

38 
l
 =Ü + 
	`OXM_LENGTH
(
f
->
hódî
);

39 
	`¥ötf
("exåa˘ög key wôhÅy≥ %02X\n", 
ty≥
);

44 
	}
}

46 
°©e_íåy
 * 
	$°©e_èbÀ_lookup
(
°©e_èbÀ
* 
èbÀ
, 
∑ckë
 *
pkt
) {

47 
°©e_íåy
 * 
e
 = 
NULL
;

48 
uöt8_t
 
key
[
MAX_STATE_KEY_LEN
] = {0};

50 
	`__exåa˘_key
(
key
, &
èbÀ
->
ªad_key
, 
pkt
);

51 
h
;

52 
	`¥ötf
("ethernetáddress is:");

53 
h
=0;h<6;h++){

54 
	`¥ötf
("%02X", 
key
[
h
]);}

55 
	`¥ötf
("\n");

56 
	`HMAP_FOR_EACH_WITH_HASH
(
e
, 
°©e_íåy
,

57 
hm≠_node
, 
	`hash_byãs
(
key
, 
MAX_STATE_KEY_LEN
, 0), &
èbÀ
->
°©e_íåõs
){

59 i‡(!
	`memcmp
(
key
, 
e
->key, 
MAX_STATE_KEY_LEN
)){

60 
	`¥ötf
("föd c‹ª•⁄dög sèã %d \n",
e
->
°©e
);

61  
e
;

65 i‡(
e
 =
NULL
)

68 
	`¥ötf
("not foundÅhe corresponding state value\n");

69  &
èbÀ
->
deÁu…_°©e_íåy
;

72  
e
;

73 
	}
}

75 
	$°©e_èbÀ_wrôe_mëad©a
(
°©e_íåy
 *
íåy
, 
∑ckë
 *
pkt
) {

76 
oÊ_m©ch_év
 *
f
;

78 
	`HMAP_FOR_EACH_WITH_HASH
(
f
, 
oÊ_m©ch_év
,

79 
hm≠_node
, 
	`hash_öt
(
OXM_OF_METADATA
,0), &
pkt
->
h™dÀ_°d
->
m©ch
.
m©ch_fõlds
){

80 
uöt64_t
 *
mëad©a
 = (uöt64_t*Ë
f
->
vÆue
;

81 
	`¥ötf
("°©êvÆuêi†%X\n",
íåy
->
°©e
);

84 *
mëad©a
 = (*mëad©®& 0x0Ë| (
íåy
->
°©e
);

86 
	`¥ötf
("wrôög sèã mëad©®%X\n",*
mëad©a
);

88 
	}
}

89 
	$°©e_èbÀ_dñ_°©e
(
°©e_èbÀ
 *
èbÀ
, 
uöt8_t
 *
key
, 
uöt32_t
 
Àn
) {

90 
°©e_íåy
 *
e
;

91 
found
 = 0;

93 
	`HMAP_FOR_EACH_WITH_HASH
(
e
, 
°©e_íåy
,

94 
hm≠_node
, 
	`hash_byãs
(
key
, 
MAX_STATE_KEY_LEN
, 0), &
èbÀ
->
°©e_íåõs
){

95 i‡(!
	`memcmp
(
key
, 
e
->key, 
MAX_STATE_KEY_LEN
)){

96 
found
 = 1;

100 i‡(
found
)

101 
	`hm≠_ªmove_™d_shrök
(&
èbÀ
->
°©e_íåõs
, &
e
->
hm≠_node
);

102 
	}
}

103 
	$°©e_èbÀ_£t_exåa˘‹
(
°©e_èbÀ
 *
èbÀ
, 
key_exåa˘‹
 *
ke
, 
upd©e
) {

104 
key_exåa˘‹
 *
de°
;

105 i‡(
upd©e
)

106 
de°
 = &
èbÀ
->
wrôe_key
;

108 
de°
 = &
èbÀ
->
ªad_key
;

111 
de°
->
fõld_cou¡
 = 
ke
->field_count;

112 
	`mem˝y
(
de°
->
fõlds
, 
ke
->fõlds, 
MAX_EXTRACTION_FIELD_COUNT
);

116 
	}
}

118 
	$°©e_èbÀ_£t_°©e
(
°©e_èbÀ
 *
èbÀ
, 
∑ckë
 *
pkt
, 
uöt32_t
 
°©e
, 
uöt8_t
 *
k
, uöt32_à
Àn
) {

119 
uöt8_t
 
key
[
MAX_STATE_KEY_LEN
] = {0};

120 
°©e_íåy
 *
e
;

122 i‡(
pkt
)

123 
	`__exåa˘_key
(
key
, &
èbÀ
->
wrôe_key
, 
pkt
);

125 
	`mem˝y
(
key
, 
k
, 
MAX_STATE_KEY_LEN
);

127 
	`HMAP_FOR_EACH_WITH_HASH
(
e
, 
°©e_íåy
,

128 
hm≠_node
, 
	`hash_byãs
(
key
, 
MAX_STATE_KEY_LEN
, 0), &
èbÀ
->
°©e_íåõs
){

129 i‡(!
	`memcmp
(
key
, 
e
->key, 
MAX_STATE_KEY_LEN
)){

130 
e
->
°©e
 = state;

135 
e
 = 
	`mÆloc
((
°©e_íåy
));

136 
	`mem˝y
(
e
->
key
, key, 
MAX_STATE_KEY_LEN
);

137 
e
->
°©e
 = state;

138 
	`hm≠_ö£π
(&
èbÀ
->
°©e_íåõs
, &
e
->
hm≠_node
, 
	`hash_byãs
(
key
, 
MAX_STATE_KEY_LEN
, 0));

139 
	}
}

	@udatapath/state_table.h

1 #i‚de‡
STATE_TABLE_H


2 
	#STATE_TABLE_H
 1

	)

4 
	~"hm≠.h
"

5 
	~"∑ckë.h
"

7 
	#MAX_EXTRACTION_FIELD_COUNT
 8

	)

8 
	#MAX_STATE_KEY_LEN
 48

	)

10 
	#STATE_DEFAULT
 0

	)

12 
	skey_exåa˘‹
 {

13 
uöt32_t
 
	mfõld_cou¡
;

15 
uöt32_t
 
	mfõlds
[
MAX_EXTRACTION_FIELD_COUNT
];

18 
	s°©e_íåy
 {

19 
hm≠_node
 
	mhm≠_node
;

20 
uöt8_t
 
	mkey
[
MAX_STATE_KEY_LEN
];

22 
uöt64_t
 
	m°©e
;

25 
	s°©e_èbÀ
 {

26 
key_exåa˘‹
 
	mªad_key
;

27 
key_exåa˘‹
 
	mwrôe_key
;

28 
hm≠
 
	m°©e_íåõs
;

29 
°©e_íåy
 
	mdeÁu…_°©e_íåy
;

33 
°©e_èbÀ
 * 
°©e_èbÀ_¸óã
();

34 
°©e_èbÀ_de°roy
(
°©e_èbÀ
 *);

35 
°©e_íåy
 * 
°©e_èbÀ_lookup
(
°©e_èbÀ
*, 
∑ckë
 *);

36 
°©e_èbÀ_wrôe_mëad©a
(
°©e_íåy
 *, 
∑ckë
 *);

37 
°©e_èbÀ_£t_°©e
(
°©e_èbÀ
 *, 
∑ckë
 *, 
uöt32_t
, 
uöt8_t
 *, uint32_t);

38 
°©e_èbÀ_£t_exåa˘‹
(
°©e_èbÀ
 *, 
key_exåa˘‹
 *, );

39 
°©e_èbÀ_dñ_°©e
(
°©e_èbÀ
 *, 
uöt8_t
 *, 
uöt32_t
);

	@udatapath/udatapath.c

40 
	~<c⁄fig.h
>

41 
	~<î∫o.h
>

42 
	~<gë›t.h
>

43 
	~<limôs.h
>

44 
	~<sig«l.h
>

45 
	~<°döt.h
>

46 
	~<°dlib.h
>

47 
	~<°rög.h
>

49 
	~"comm™d-löe.h
"

50 
	~"d´m⁄.h
"

51 
	~"d©≠©h.h
"

52 
	~"Áu….h
"

53 
	~"›íÊow/›íÊow.h
"

54 
	~"pﬁl-lo›.h
"

55 
	~"queue.h
"

56 
	~"utû.h
"

57 
	~"rc⁄n.h
"

58 
	~"timevÆ.h
"

59 
	~"vc⁄n.h
"

60 
	~"dús.h
"

61 
	~"vc⁄n-s¶.h
"

62 
	~"vlog-sockë.h
"

64 #i‡
deföed
(
OF_HW_PLAT
)

65 
	~<›íÊow/of_hw_≠i.h
>

68 
	#THIS_MODULE
 
VLM_ud©≠©h


	)

69 
	~"vlog.h
"

71 
ud©≠©h_cmd
(
¨gc
, *
¨gv
[]);

73 
∑r£_›ti⁄s
(
d©≠©h
 *
dp
, 
¨gc
, *
¨gv
[]);

74 
	$ußge
(Ë
NO_RETURN
;

76 
d©≠©h
 *
dp
;

78 *
p‹t_li°
;

79 *
loˇl_p‹t
 = "tap:";

81 
	`add_p‹ts
(
d©≠©h
 *
dp
, *
p‹t_li°
);

83 
boﬁ
 
u£_mu…ùÀ_c⁄√˘i⁄s
 = 
Ál£
;

86 #i‡
	`deföed
(
UDATAPATH_AS_LIB
)

87 
	#OFP_FATAL
(
_î
, 
_°r
, 
¨gs
...) do { \

88 
	`Ârötf
(
°dîr
, 
_°r
, ## 
¨gs
); \

90 
	}
} 0)

	)

92 
	#OFP_FATAL
(
_î
, 
_°r
, 
¨gs
...Ë
	`oÂ_Áèl
(_î, _°r, ##árgs)

	)

95 #i‡!
deföed
(
UDATAPATH_AS_LIB
)

97 
	$maö
(
¨gc
, *
¨gv
[])

99  
	`ud©≠©h_cmd
(
¨gc
, 
¨gv
);

101 
	}
}

105 
	$ud©≠©h_cmd
(
¨gc
, *
¨gv
[])

107 
n_li°íîs
;

108 
îr‹
;

109 
i
;

111 
	`£t_¥ogøm_«me
(
¨gv
[0]);

112 
	`ªgi°î_Áu…_h™dÀrs
();

113 
	`time_öô
();

114 
	`vlog_öô
();

116 
dp
 = 
	`dp_√w
();

118 
	`∑r£_›ti⁄s
(
dp
, 
¨gc
, 
¨gv
);

119 
	`sig«l
(
SIGPIPE
, 
SIG_IGN
);

121 i‡(
¨gc
 - 
›töd
 < 1) {

122 
	`OFP_FATAL
(0, "atÜeast oneÜistenerárgument isÑequired; "

126 i‡(
u£_mu…ùÀ_c⁄√˘i⁄s
 && (
¨gc
 - 
›töd
) % 2 != 0)

127 
	`OFP_FATAL
(0, "when using multiple connections, you must specifyánÉvenÇumber ofÜisteners");

129 
n_li°íîs
 = 0;

130 
i
 = 
›töd
; i < 
¨gc
; i += 2) {

131 c⁄° *
pvc⁄n_«me
 = 
¨gv
[
i
];

132 c⁄° *
pvc⁄n_«me_aux
 = 
NULL
;

133 i‡(
u£_mu…ùÀ_c⁄√˘i⁄s
)

134 
pvc⁄n_«me_aux
 = 
¨gv
[
i
 + 1];

136 
pvc⁄n
 *pvc⁄n, *
pvc⁄n_aux
 = 
NULL
;

137 
ªtvÆ
, 
ªtvÆ_aux
;

139 
ªtvÆ
 = 
	`pvc⁄n_›í
(
pvc⁄n_«me
, &
pvc⁄n
);

140 i‡(!
ªtvÆ
 ||ÑëvÆ =
EAGAIN
) {

142 i‡(
u£_mu…ùÀ_c⁄√˘i⁄s
) {

143 
ªtvÆ_aux
 = 
	`pvc⁄n_›í
(
pvc⁄n_«me_aux
, &
pvc⁄n_aux
);

144 i‡(
ªtvÆ_aux
 &&ÑëvÆ_aux !
EAGAIN
) {

145 
	`oÂ_îr‹
(
ªtvÆ_aux
, "›íögáuxûüry %s", 
pvc⁄n_«me_aux
);

146 
pvc⁄n_aux
 = 
NULL
;

149 
	`dp_add_pvc⁄n
(
dp
, 
pvc⁄n
, 
pvc⁄n_aux
);

150 
n_li°íîs
++;

152 
	`oÂ_îr‹
(
ªtvÆ
, "›íög %s", 
pvc⁄n_«me
);

155 i‡(
n_li°íîs
 == 0) {

156 
	`OFP_FATAL
(0, "couldÇotÜisten forány connections");

159 i‡(
p‹t_li°
 !
NULL
) {

160 
	`add_p‹ts
(
dp
, 
p‹t_li°
);

162 i‡(
loˇl_p‹t
 !
NULL
) {

163 
îr‹
 = 
	`dp_p‹ts_add_loˇl
(
dp
, 
loˇl_p‹t
);

164 i‡(
îr‹
) {

165 
	`OFP_FATAL
(
îr‹
, "ÁûedÅÿaddÜoˇ»p‹à%s", 
loˇl_p‹t
);

169 
îr‹
 = 
	`vlog_£rvî_li°í
(
NULL
, NULL);

170 i‡(
îr‹
) {

171 
	`OFP_FATAL
(
îr‹
, "couldÇotÜisten for vlog connections");

174 
	`dõ_if_Æªady_ru¬ög
();

175 
	`d´m⁄ize
();

178 
	`dp_run
(
dp
);

179 
	`dp_waô
(
dp
);

180 
	`pﬁl_block
();

184 
	}
}

187 
	$add_p‹ts
(
d©≠©h
 *
dp
, *
p‹t_li°
)

189 *
p‹t
, *
ßve_±r
;

195 
p‹t
 = 
	`°πok_r
(
p‹t_li°
, ",,", &
ßve_±r
);Öort;

196 
p‹t
 = 
	`°πok_r
(
NULL
, ",,", &
ßve_±r
)) {

197 
îr‹
 = 
	`dp_p‹ts_add
(
dp
, 
p‹t
);

198 i‡(
îr‹
) {

199 
	`oÂ_Áèl
(
îr‹
, "ÁûedÅÿaddÖ‹à%s", 
p‹t
);

202 
	}
}

205 
	$∑r£_›ti⁄s
(
d©≠©h
 *
dp
, 
¨gc
, *
¨gv
[])

208 
OPT_MFR_DESC
 = 
UCHAR_MAX
 + 1,

209 
OPT_HW_DESC
,

210 
OPT_SW_DESC
,

211 
OPT_DP_DESC
,

212 
OPT_SERIAL_NUM
,

213 
OPT_BOOTSTRAP_CA_CERT
,

214 
OPT_NO_LOCAL_PORT
,

215 
OPT_NO_SLICING


218 
›ti⁄
 
l⁄g_›ti⁄s
[] = {

219 {"öãrÁ˚s", 
ªquúed_¨gumít
, 0, 'i'},

220 {"loˇl-p‹t", 
ªquúed_¨gumít
, 0, 'L'},

221 {"no-loˇl-p‹t", 
no_¨gumít
, 0, 
OPT_NO_LOCAL_PORT
},

222 {"d©≠©h-id", 
ªquúed_¨gumít
, 0, 'd'},

223 {"mu…ic⁄n", 
no_¨gumít
, 0, 'm'},

224 {"vîbo£", 
›ti⁄Æ_¨gumít
, 0, 'v'},

225 {"hñp", 
no_¨gumít
, 0, 'h'},

226 {"vîsi⁄", 
no_¨gumít
, 0, 'V'},

227 {"no-¶icög", 
no_¨gumít
, 0, 
OPT_NO_SLICING
},

228 {"m‰-desc", 
ªquúed_¨gumít
, 0, 
OPT_MFR_DESC
},

229 {"hw-desc", 
ªquúed_¨gumít
, 0, 
OPT_HW_DESC
},

230 {"sw-desc", 
ªquúed_¨gumít
, 0, 
OPT_SW_DESC
},

231 {"dp_desc", 
ªquúed_¨gumít
, 0, 
OPT_DP_DESC
},

232 {"£rül_num", 
ªquúed_¨gumít
, 0, 
OPT_SERIAL_NUM
},

233 
DAEMON_LONG_OPTIONS
,

234 #ifde‡
HAVE_OPENSSL


235 
VCONN_SSL_LONG_OPTIONS


236 {"boŸ°øp-ˇ-˚π", 
ªquúed_¨gumít
, 0, 
OPT_BOOTSTRAP_CA_CERT
},

240 *
sh‹t_›ti⁄s
 = 
	`l⁄g_›ti⁄s_to_sh‹t_›ti⁄s
(
l⁄g_›ti⁄s
);

243 
ödex±r
;

244 
c
;

246 
c
 = 
	`gë›t_l⁄g
(
¨gc
, 
¨gv
, 
sh‹t_›ti⁄s
, 
l⁄g_›ti⁄s
, &
ödex±r
);

247 i‡(
c
 == -1) {

251 
c
) {

253 
uöt64_t
 
dpid
;

254 i‡(
	`°æí
(
›èrg
) != 12

255 || 
	`°r•n
(
›èrg
, "0123456789abcdefABCDEF") != 12) {

256 
	`oÂ_Áèl
(0, "argumentÅo -d or --datapath-id must be "

259 
dpid
 = 
	`°πﬁl
(
›èrg
, 
NULL
, 16);

260 i‡(!
dpid
) {

261 
	`oÂ_Áèl
(0, "argumentÅo -d or --datapath-id must "

264 
	`dp_£t_dpid
(
dp
, 
dpid
);

269 
u£_mu…ùÀ_c⁄√˘i⁄s
 = 
åue
;

274 
	`ußge
();

277 
	`¥ötf
("%†%†compûed "
__DATE__
" "
__TIME__
"\n",

278 
¥ogøm_«me
, 
VERSION
 
BUILDNR
);

279 
	`exô
(
EXIT_SUCCESS
);

282 
	`vlog_£t_vîbosôy
(
›èrg
);

286 i‡(!
p‹t_li°
) {

287 
p‹t_li°
 = 
›èrg
;

289 
p‹t_li°
 = 
	`xa•rötf
("%s,%s",Ö‹t_li°, 
›èrg
);

294 
loˇl_p‹t
 = 
›èrg
;

297 
OPT_NO_LOCAL_PORT
:

298 
loˇl_p‹t
 = 
NULL
;

301 
OPT_MFR_DESC
:

302 
	`dp_£t_m‰_desc
(
dp
, 
›èrg
);

305 
OPT_HW_DESC
:

306 
	`dp_£t_hw_desc
(
dp
, 
›èrg
);

309 
OPT_SW_DESC
:

310 
	`dp_£t_sw_desc
(
dp
, 
›èrg
);

313 
OPT_DP_DESC
:

314 
	`dp_£t_dp_desc
(
dp
, 
›èrg
);

317 
OPT_SERIAL_NUM
:

318 
	`dp_£t_£rül_num
(
dp
, 
›èrg
);

321 
OPT_NO_SLICING
:

322 
	`dp_£t_max_queues
(
dp
, 0);

325 
DAEMON_OPTION_HANDLERS


327 #ifde‡
HAVE_OPENSSL


328 
VCONN_SSL_OPTION_HANDLERS


330 
OPT_BOOTSTRAP_CA_CERT
:

331 
	`vc⁄n_s¶_£t_ˇ_˚π_fûe
(
›èrg
, 
åue
);

336 
	`exô
(
EXIT_FAILURE
);

339 
	`ab‹t
();

342 
	`‰ì
(
sh‹t_›ti⁄s
);

343 
	}
}

346 
	$ußge
()

348 
	`¥ötf
("%s: userspace OpenFlow datapath\n"

352 
¥ogøm_«me
,Örogram_name);

353 
	`vc⁄n_ußge
(
Ál£
, 
åue
, false);

354 
	`¥ötf
("\nConfiguration options:\n"

372 
oÂ_rundú
);

373 
	`exô
(
EXIT_SUCCESS
);

374 
	}
}

	@utilities/dpctl.c

32 
	~<c⁄fig.h
>

33 
	~<¨∑/öë.h
>

34 
	~<î∫o.h
>

35 
	~<gë›t.h
>

36 
	~<öây≥s.h
>

37 
	~<√töë/ö.h
>

38 
	~<sig«l.h
>

39 
	~<°d¨g.h
>

40 
	~<°dboﬁ.h
>

41 
	~<°dlib.h
>

42 
	~<°rög.h
>

43 
	~<uni°d.h
>

44 
	~<sys/time.h
>

46 
	~"dp˘l.h
"

47 
	~"oÊib/oÊ-mesßges.h
"

48 
	~"oÊib/oÊ-°ru˘s.h
"

49 
	~"oÊib/oÊ-a˘i⁄s.h
"

50 
	~"oÊib/oÊ-¥öt.h
"

51 
	~"oÊib/oÊ.h
"

52 
	~"oÊib-exp/oÊ-exp.h
"

53 
	~"oÊib-exp/oÊ-exp-›íÊow.h
"

54 
	~"oÊib/oxm-m©ch.h
"

56 
	~"comm™d-löe.h
"

57 
	~"compûî.h
"

58 
	~"dpif.h
"

59 
	~"›íÊow/nicúa-ext.h
"

60 
	~"›íÊow/›íÊow-ext.h
"

61 
	~"oÂbuf.h
"

62 
	~"›íÊow/›íÊow.h
"

63 
	~"∑ckës.h
"

64 
	~"øndom.h
"

65 
	~"sockë-utû.h
"

66 
	~"timevÆ.h
"

67 
	~"utû.h
"

68 
	~"vc⁄n-s¶.h
"

69 
	~"vc⁄n.h
"

70 
	~"ùv6_utû.h
"

72 
	~"oÂ°©.h
"

73 
	~"›íÊow/¥iv©e-ext.h
"

75 
	~"vlog.h
"

77 
	#LOG_MODULE
 
VLM_dp˘l


	)

83 
	#XID
 0xf0ff00f0

	)

86 
	scomm™d
 {

87 *
	m«me
;

88 
	mmö_¨gs
;

89 
	mmax_¨gs
;

90 (*
	mh™dÀr
)(
vc⁄n
 *
	mvc⁄n
, 
	m¨gc
, *
	m¨gv
[]);

93 
comm™d
 
	gÆl_comm™ds
[];

96 
	$ußge
(Ë
NO_RETURN
;

99 
	`∑r£_›ti⁄s
(
¨gc
, *
¨gv
[]);

101 
uöt8_t
 
mask_Æl
[] = {0xff, 0xff, 0xff, 0xff, 0xff, 0xff
	}
};

106 
∑r£_Êow_mod_¨gs
(*
°r
, 
oÊ_msg_Êow_mod
 *
ªq
);

109 
∑r£_group_mod_¨gs
(*
°r
, 
oÊ_msg_group_mod
 *
ªq
);

112 
∑r£_mëî_mod_¨gs
(*
°r
, 
oÊ_msg_mëî_mod
 *
ªq
);

115 
∑r£_buckë
(*
°r
, 
oÊ_buckë
 *
b
);

118 
∑r£_Êow_°©_¨gs
(*
°r
, 
oÊ_msg_mu…ù¨t_ªque°_Êow
 *
ªq
);

121 
∑r£_m©ch
(*
°r
, 
oÊ_m©ch_hódî
 **
m©ch
);

124 
∑r£_ö°
(*
°r
, 
oÊ_ö°ru˘i⁄_hódî
 **
ö°
);

127 
∑r£_a˘i⁄s
(*
°r
, 
size_t
 *
a˘s_num
, 
oÊ_a˘i⁄_hódî
 ***
a˘s
);

130 
∑r£_c⁄fig
(*
°r
, 
oÊ_c⁄fig
 *
c⁄fig
);

133 
∑r£_p‹t_mod
(*
°r
, 
oÊ_msg_p‹t_mod
 *
msg
);

136 
∑r£_èbÀ_mod
(*
°r
, 
oÊ_msg_èbÀ_mod
 *
msg
);

139 
∑r£_b™d
(*
°r
, 
oÊ_msg_mëî_mod
 *
m
, 
oÊ_mëî_b™d_hódî
 **
b
);

142 
make_Æl_m©ch
(
oÊ_m©ch_hódî
 **
m©ch
);

148 
∑r£_p‹t
(*
°r
, 
uöt32_t
 *
p‹t
);

151 
∑r£_queue
(*
°r
, 
uöt32_t
 *
p‹t
);

154 
∑r£_group
(*
°r
, 
uöt32_t
 *
group
);

157 
∑r£_mëî
(*
°r
, 
uöt32_t
 *
mëî
);

160 
∑r£_èbÀ
(*
°r
, 
uöt8_t
 *
èbÀ
);

163 
∑r£_dl_addr
(*
°r
, 
uöt8_t
 *
addr
, uöt8_à**
mask
);

166 
∑r£_nw_addr
(*
°r
, 
uöt32_t
 *
addr
, uöt32_à**
mask
);

169 
∑r£_vœn_vid
(*
°r
, 
uöt16_t
 *
vid
);

172 
∑r£_ext_hdr
(*
°r
, 
uöt16_t
 *
ext_hdr
);

175 
∑r£8
(*
°r
, 
«mes8
 *
«mes
, 
size_t
 
«mes_num
, 
uöt8_t
 
max
, uöt8_à*
vÆ
);

178 
∑r£16
(*
°r
, 
«mes16
 *
«mes
, 
size_t
 
«mes_num
, 
uöt16_t
 
max
, uöt16_à*
vÆ
);

181 
∑r£16m
(*
°r
, 
«mes16
 *
«mes
, 
size_t
 
«mes_num
, 
uöt16_t
 
max
, uöt16_à*
vÆ
, uöt16_à*
mask
);

184 
∑r£32
(*
°r
, 
«mes32
 *
«mes
, 
size_t
 
«mes_num
, 
uöt32_t
 
max
, uöt32_à*
vÆ
);

187 
∑r£32m
(*
°r
, 
«mes32
 *
«mes
, 
size_t
 
«mes_num
, 
uöt32_t
 
max
, uöt32_à*
vÆ
, uöt32_à**
mask
);

189 
oÊ_exp_msg
 
	gdp˘l_exp_msg
 =

190 {.
∑ck
 = 
oÊ_exp_msg_∑ck
,

191 .
	gu≈ack
 = 
oÊ_exp_msg_u≈ack
,

192 .
	g‰ì
 = 
oÊ_exp_msg_‰ì
,

193 .
	gto_°rög
 = 
oÊ_exp_msg_to_°rög
};

195 
oÊ_exp
 
	gdp˘l_exp
 =

196 {.
a˘
 = 
NULL
,

197 .
	gö°
 = 
NULL
,

198 .
	gm©ch
 = 
NULL
,

199 .
	g°©s
 = 
NULL
,

200 .
	gmsg
 = &
dp˘l_exp_msg
};

204 
	$dp˘l_å™ß˘
(
vc⁄n
 *vc⁄n, 
oÊ_msg_hódî
 *
ªq
,

205 
oÊ_msg_hódî
 **
ª∂
) {

206 
oÂbuf
 *
oÂbu‰eq
, *
oÂbu‰ïl
;

207 
uöt8_t
 *
bu‰eq
;

208 
size_t
 
bu‰eq_size
;

209 
îr‹
;

211 
îr‹
 = 
	`oÊ_msg_∑ck
(
ªq
, 
XID
, &
bu‰eq
, &
bu‰eq_size
, &
dp˘l_exp
);

212 i‡(
îr‹
) {

213 
	`oÂ_Áèl
(0, "ErrorÖackingÑequest.");

216 
oÂbu‰eq
 = 
	`oÂbuf_√w
(0);

217 
	`oÂbuf_u£
(
oÂbu‰eq
, 
bu‰eq
, 
bu‰eq_size
);

218 
	`oÂbuf_put_unöô
(
oÂbu‰eq
, 
bu‰eq_size
);

219 
îr‹
 = 
	`vc⁄n_å™ß˘
(
vc⁄n
, 
oÂbu‰eq
, &
oÂbu‰ïl
);

220 i‡(
îr‹
) {

221 
	`oÂ_Áèl
(0, "Error duringÅransaction.");

223 
îr‹
 = 
	`oÊ_msg_u≈ack
(
oÂbu‰ïl
->
d©a
, oÂbu‰ïl->
size
, 
ª∂
, 
NULL
 , &
dp˘l_exp
);

225 i‡(
îr‹
) {

226 
	`oÂ_Áèl
(0, "Error unpackingÑeply.");

232 
oÂbu‰ïl
->
ba£
 = 
NULL
;

233 
oÂbu‰ïl
->
d©a
 = 
NULL
;

234 
	`oÂbuf_dñëe
(
oÂbu‰ïl
);

235 
	}
}

238 
	$dp˘l_å™ß˘_™d_¥öt
(
vc⁄n
 *vc⁄n, 
oÊ_msg_hódî
 *
ªq
,

239 
oÊ_msg_hódî
 **
ª∂
) {

240 
oÊ_msg_hódî
 *
ª∂y
;

241 *
°r
;

243 
°r
 = 
	`oÊ_msg_to_°rög
(
ªq
, &
dp˘l_exp
);

244 
	`¥ötf
("\nSENDING:\n%s\n\n", 
°r
);

245 
	`‰ì
(
°r
);

246 
	`dp˘l_å™ß˘
(
vc⁄n
, 
ªq
, &
ª∂y
);

247 
°r
 = 
	`oÊ_msg_to_°rög
(
ª∂y
, &
dp˘l_exp
);

248 
	`¥ötf
("\nRECEIVED:\n%s\n\n", 
°r
);

249 
	`‰ì
(
°r
);

251 i‡(
ª∂
 !
NULL
) {

252 (*
ª∂
Ë
ª∂y
;

254 
	`oÊ_msg_‰ì
(
ª∂y
, &
dp˘l_exp
);

256 
	}
}

259 
	$dp˘l_b¨rõr
(
vc⁄n
 *vconn) {

260 
oÊ_msg_hódî
 *
ª∂y
;

261 *
°r
;

263 
oÊ_msg_hódî
 
ªq
 =

264 {.
ty≥
 = 
OFPT_BARRIER_REQUEST
};

266 
	`dp˘l_å™ß˘
(
vc⁄n
, &
ªq
, &
ª∂y
);

268 i‡(
ª∂y
->
ty≥
 =
OFPT_BARRIER_REPLY
) {

269 
°r
 = 
	`oÊ_msg_to_°rög
(
ª∂y
, &
dp˘l_exp
);

270 
	`¥ötf
("\nOK.\n\n");

271 
	`‰ì
(
°r
);

273 
°r
 = 
	`oÊ_msg_to_°rög
(
ª∂y
, &
dp˘l_exp
);

274 
	`¥ötf
("\nRECEIVED:\n%s\n\n", 
°r
);

275 
	`‰ì
(
°r
);

278 
	}
}

281 
	$dp˘l_£nd
(
vc⁄n
 *vc⁄n, 
oÊ_msg_hódî
 *
msg
) {

282 
oÂbuf
 *ofpbuf;

283 
uöt8_t
 *
buf
;

284 
size_t
 
buf_size
;

285 
îr‹
;

287 
îr‹
 = 
	`oÊ_msg_∑ck
(
msg
, 
XID
, &
buf
, &
buf_size
, &
dp˘l_exp
);

288 i‡(
îr‹
) {

289 
	`oÂ_Áèl
(0, "ErrorÖackingÑequest.");

292 
oÂbuf
 = 
	`oÂbuf_√w
(0);

293 
	`oÂbuf_u£
(
oÂbuf
, 
buf
, 
buf_size
);

294 
	`oÂbuf_put_unöô
(
oÂbuf
, 
buf_size
);

296 
îr‹
 = 
	`vc⁄n_£nd_block
(
vc⁄n
, 
oÂbuf
);

297 i‡(
îr‹
) {

298 
	`oÂ_Áèl
(0, "Error duringÅransaction.");

301 
	`dp˘l_b¨rõr
(
vc⁄n
);

302 
	}
}

305 
	$dp˘l_£nd_™d_¥öt
(
vc⁄n
 *vc⁄n, 
oÊ_msg_hódî
 *
msg
) {

306 *
°r
;

307 
°r
 = 
	`oÊ_msg_to_°rög
(
msg
, &
dp˘l_exp
);

308 
	`¥ötf
("\nSENDING:\n%s\n\n", 
°r
);

309 
	`‰ì
(
°r
);

311 
	`dp˘l_£nd
(
vc⁄n
, 
msg
);

312 
	}
}

315 
	$pög
(
vc⁄n
 *vc⁄n, 
¨gc
, *
¨gv
[]) {

316 
uöt16_t
 
∑ylﬂd_size
 = 0;

317 
size_t
 
times
 = 0, 
i
;

318 
oÊ_msg_echo
 *
ª∂y
;

320 
oÊ_msg_echo
 
ªq
 =

321 {{.
ty≥
 = 
OFPT_ECHO_REQUEST
},

322 .
d©a_Àngth
 = 0,

323 .
d©a
 = 
NULL
};

325 i‡(
¨gc
 > 0) {

326 
times
 = 
	`©oi
(
¨gv
[0]);

328 i‡(
times
 == 0) {

329 
times
 = 4;

331 i‡(
¨gc
 > 1) {

332 
∑ylﬂd_size
 = 
	`©oi
(
¨gv
[1]);

334 
∑ylﬂd_size
 = 1024;

336 i‡(
∑ylﬂd_size
 > 
UINT16_MAX
 - (
oÂ_hódî
)) {

337 
	`oÂ_Áèl
(0, "∑ylﬂd mu° bêbëwì¿0ánd %zu byãs.", 
UINT16_MAX
 - (
oÂ_hódî
));

340 
ªq
.
d©a_Àngth
 = 
∑ylﬂd_size
;

341 
ªq
.
d©a
 = 
	`xmÆloc
(
∑ylﬂd_size
);

343 
i
=0; i<
times
; i++) {

344 
timevÆ
 
°¨t
, 
íd
;

346 
	`øndom_byãs
(
ªq
.
d©a
, 
∑ylﬂd_size
);

348 
	`gëtimeofday
(&
°¨t
, 
NULL
);

349 
	`dp˘l_å™ß˘
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
ªq
, (oÊ_msg_hódî **)&
ª∂y
);

350 
	`gëtimeofday
(&
íd
, 
NULL
);

352 i‡((
ªq
.
d©a_Àngth
 !
ª∂y
->data_length) ||

353 (
	`memcmp
(
ªq
.
d©a
, 
ª∂y
->d©a,Ñeq.
d©a_Àngth
) != 0)) {

354 
	`oÂ_Áèl
(0, "Reply doesÇot matchÑequest.");

357 
	`¥ötf
("%zu bytes from %s:Åime=%.1f ms\n",

358 (
ª∂y
->
d©a_Àngth
 - (
oÂ_hódî
)),

359 
	`vc⁄n_gë_«me
(
vc⁄n
),

360 (1000*()(
íd
.
tv_£c
 - 
°¨t
.tv_£c)Ë+ (.001*”nd.
tv_u£c
 - start.tv_usec)));

364 
	`‰ì
(
ªq
.
d©a
);

365 
	`oÊ_msg_‰ì
((
oÊ_msg_hódî
 *)
ª∂y
, &
dp˘l_exp
);

366 
	}
}

369 
	$m⁄ô‹
(
vc⁄n
 *vc⁄n, 
¨gc
 
UNUSED
, *
¨gv
[] UNUSED) {

370 
oÂbuf
 *
buf
;

371 
oÊ_msg_hódî
 *
msg
;

372 *
°r
;

373 
îr‹
;

375 
	`¥ötf
("MONITORING %s...\n\n", 
	`vc⁄n_gë_«me
(
vc⁄n
));

378 i‡(
	`vc⁄n_ªcv_block
(
vc⁄n
, &
buf
) == 0) {

380 
îr‹
 = 
	`oÊ_msg_u≈ack
(
buf
->
d©a
, buf->
size
, &
msg
, 
NULL
 , &
dp˘l_exp
);

381 i‡(
îr‹
) {

382 
	`oÂ_Áèl
(0, "Error unpackingÑeply.");

388 
buf
->
ba£
 = 
NULL
;

389 
buf
->
d©a
 = 
NULL
;

390 
	`oÂbuf_dñëe
(
buf
);

392 
°r
 = 
	`oÊ_msg_to_°rög
(
msg
, &
dp˘l_exp
);

393 
	`¥ötf
("\nRECEIVED:\n%s\n\n", 
°r
);

394 
	`‰ì
(
°r
);

396 
	`oÊ_msg_‰ì
(
msg
, &
dp˘l_exp
);

399 
	}
}

402 
	$èbÀ_„©uªs
(
vc⁄n
 *vc⁄n, 
¨gc
 
UNUSED
, *
¨gv
[] UNUSED) {

403 
oÊ_msg_mu…ù¨t_ªque°_èbÀ_„©uªs
 
ªq
 =

404 {{{.
ty≥
 = 
OFPT_MULTIPART_REQUEST
},

405 .
ty≥
 = 
OFPMP_TABLE_FEATURES
, .
Êags
 = 0x0000},

406 .
èbÀs_num
 = 0,

407 .
èbÀ_„©uªs
 = 
NULL
,

410 
	`dp˘l_å™ß˘_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
ªq
, 
NULL
);

411 
	}
}

415 
	$„©uªs
(
vc⁄n
 *vc⁄n, 
¨gc
 
UNUSED
, *
¨gv
[] UNUSED) {

416 
oÊ_msg_hódî
 
ªq
 =

417 {.
ty≥
 = 
OFPT_FEATURES_REQUEST
};

419 
	`dp˘l_å™ß˘_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
ªq
, 
NULL
);

420 
	}
}

423 
	$gë_c⁄fig
(
vc⁄n
 *vc⁄n, 
¨gc
 
UNUSED
, *
¨gv
[] UNUSED) {

424 
oÊ_msg_hódî
 
ªq
 =

425 {.
ty≥
 = 
OFPT_GET_CONFIG_REQUEST
};

427 
	`dp˘l_å™ß˘_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
ªq
, 
NULL
);

428 
	}
}

433 
	$°©s_desc
(
vc⁄n
 *vc⁄n, 
¨gc
 
UNUSED
, *
¨gv
[] UNUSED) {

434 
oÊ_msg_mu…ù¨t_ªque°_hódî
 
ªq
 =

435 {{.
ty≥
 = 
OFPT_MULTIPART_REQUEST
},

436 .
ty≥
 = 
OFPMP_DESC
, .
Êags
 = 0x0000};

438 
	`dp˘l_å™ß˘_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
ªq
, 
NULL
);

439 
	}
}

442 
	$p‹t_desc
(
vc⁄n
 *vc⁄n, 
¨gc
 
UNUSED
, *
¨gv
[] UNUSED) {

443 
oÊ_msg_mu…ù¨t_ªque°_hódî
 
ªq
 =

444 {{.
ty≥
 = 
OFPT_MULTIPART_REQUEST
},

445 .
ty≥
 = 
OFPMP_PORT_DESC
, .
Êags
 = 0x0000};

447 
	`dp˘l_å™ß˘_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
ªq
, 
NULL
);

448 
	}
}

451 
	$°©s_Êow
(
vc⁄n
 *vc⁄n, 
¨gc
, *
¨gv
[]) {

452 
oÊ_msg_mu…ù¨t_ªque°_Êow
 
ªq
 =

453 {{{.
ty≥
 = 
OFPT_MULTIPART_REQUEST
},

454 .
ty≥
 = 
OFPMP_FLOW
, .
Êags
 = 0x0000},

455 .
cookõ
 = 0x0000000000000000ULL,

456 .
cookõ_mask
 = 0x0000000000000000ULL,

457 .
èbÀ_id
 = 0xff,

458 .
out_p‹t
 = 
OFPP_ANY
,

459 .
out_group
 = 
OFPG_ANY
,

460 .
m©ch
 = 
NULL
};

461 i‡(
¨gc
 > 0) {

462 
	`∑r£_Êow_°©_¨gs
(
¨gv
[0], &
ªq
);

464 i‡(
¨gc
 > 1) {

465 
	`∑r£_m©ch
(
¨gv
[1], &(
ªq
.
m©ch
));

467 
	`make_Æl_m©ch
(&(
ªq
.
m©ch
));

470 
	`dp˘l_å™ß˘_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
ªq
, 
NULL
);

471 
	}
}

474 
	$°©s_aggr
(
vc⁄n
 *vc⁄n, 
¨gc
, *
¨gv
[]) {

475 
oÊ_msg_mu…ù¨t_ªque°_Êow
 
ªq
 =

476 {{{.
ty≥
 = 
OFPT_MULTIPART_REQUEST
},

477 .
ty≥
 = 
OFPMP_AGGREGATE
, .
Êags
 = 0x0000},

478 .
cookõ
 = 0x0000000000000000ULL,

479 .
cookõ_mask
 = 0x0000000000000000ULL,

480 .
èbÀ_id
 = 0xff,

481 .
out_p‹t
 = 
OFPP_ANY
,

482 .
out_group
 = 
OFPG_ANY
,

483 .
m©ch
 = 
NULL
};

485 i‡(
¨gc
 > 0) {

486 
	`∑r£_Êow_°©_¨gs
(
¨gv
[0], &
ªq
);

488 i‡(
¨gc
 > 1) {

489 
	`∑r£_m©ch
(
¨gv
[1], &(
ªq
.
m©ch
));

491 
	`make_Æl_m©ch
(&(
ªq
.
m©ch
));

494 
	`dp˘l_å™ß˘_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
ªq
, 
NULL
);

495 
	}
}

498 
	$°©s_èbÀ
(
vc⁄n
 *vc⁄n, 
¨gc
 
UNUSED
, *
¨gv
[] UNUSED) {

499 
oÊ_msg_mu…ù¨t_ªque°_hódî
 
ªq
 =

500 {{.
ty≥
 = 
OFPT_MULTIPART_REQUEST
},

501 .
ty≥
 = 
OFPMP_TABLE
, .
Êags
 = 0x0000};

503 
	`dp˘l_å™ß˘_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
ªq
, 
NULL
);

504 
	}
}

509 
	$°©s_p‹t
(
vc⁄n
 *vc⁄n, 
¨gc
, *
¨gv
[]) {

510 
oÊ_msg_mu…ù¨t_ªque°_p‹t
 
ªq
 =

511 {{{.
ty≥
 = 
OFPT_MULTIPART_REQUEST
},

512 .
ty≥
 = 
OFPMP_PORT_STATS
, .
Êags
 = 0x0000},

513 .
p‹t_no
 = 
OFPP_ANY
};

515 i‡(
¨gc
 > 0 && 
	`∑r£_p‹t
(
¨gv
[0], &
ªq
.
p‹t_no
)) {

516 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÖ‹t: %s.", 
¨gv
[0]);

519 
	`dp˘l_å™ß˘_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
ªq
, 
NULL
);

520 
	}
}

525 
	$°©s_queue
(
vc⁄n
 *vc⁄n, 
¨gc
, *
¨gv
[]) {

526 
oÊ_msg_mu…ù¨t_ªque°_queue
 
ªq
 =

527 {{{.
ty≥
 = 
OFPT_MULTIPART_REQUEST
},

528 .
ty≥
 = 
OFPMP_QUEUE
, .
Êags
 = 0x0000},

529 .
p‹t_no
 = 
OFPP_ANY
,

530 .
queue_id
 = 
OFPQ_ALL
};

532 i‡(
¨gc
 > 0 && 
	`∑r£_p‹t
(
¨gv
[0], &
ªq
.
p‹t_no
)) {

533 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÖ‹t: %s.", 
¨gv
[0]);

535 i‡(
¨gc
 > 1 && 
	`∑r£_queue
(
¨gv
[1], &
ªq
.
queue_id
)) {

536 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög queue: %s.", 
¨gv
[1]);

539 
	`dp˘l_å™ß˘_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
ªq
, 
NULL
);

540 
	}
}

545 
	$°©s_group
(
vc⁄n
 *vc⁄n, 
¨gc
, *
¨gv
[]) {

546 
oÊ_msg_mu…ù¨t_ªque°_group
 
ªq
 =

547 {{{.
ty≥
 = 
OFPT_MULTIPART_REQUEST
},

548 .
ty≥
 = 
OFPMP_GROUP
, .
Êags
 = 0x0000},

549 .
group_id
 = 
OFPG_ALL
};

551 i‡(
¨gc
 > 0 && 
	`∑r£_group
(
¨gv
[0], &
ªq
.
group_id
)) {

552 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög group: %s.", 
¨gv
[0]);

555 
	`dp˘l_å™ß˘_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
ªq
, 
NULL
);

556 
	}
}

561 
	$°©s_group_desc
(
vc⁄n
 *vc⁄n, 
¨gc
, *
¨gv
[]) {

562 
oÊ_msg_mu…ù¨t_ªque°_group
 
ªq
 =

563 {{{.
ty≥
 = 
OFPT_MULTIPART_REQUEST
},

564 .
ty≥
 = 
OFPMP_GROUP_DESC
, .
Êags
 = 0x0000},

565 .
group_id
 = 
OFPG_ALL
};

567 i‡(
¨gc
 > 0 && 
	`∑r£_group
(
¨gv
[0], &
ªq
.
group_id
)) {

568 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög group: %s.", 
¨gv
[0]);

571 
	`dp˘l_å™ß˘_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
ªq
, 
NULL
);

572 
	}
}

575 
	$£t_c⁄fig
(
vc⁄n
 *vc⁄n, 
¨gc
 
UNUSED
, *
¨gv
[]) {

576 
oÊ_msg_£t_c⁄fig
 
msg
 =

577 {{.
ty≥
 = 
OFPT_SET_CONFIG
},

578 .
c⁄fig
 = 
NULL
};

580 
msg
.
c⁄fig
 = 
	`xmÆloc
((
oÊ_c⁄fig
));

581 
msg
.
c⁄fig
->
Êags
 = 
OFPC_FRAG_NORMAL
;

582 
msg
.
c⁄fig
->
miss_£nd_Àn
 = 
OFP_DEFAULT_MISS_SEND_LEN
;

584 
	`∑r£_c⁄fig
(
¨gv
[0], 
msg
.
c⁄fig
);

586 
	`dp˘l_£nd_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
msg
);

587 
	}
}

592 
	$Êow_mod
(
vc⁄n
 *vc⁄n, 
¨gc
, *
¨gv
[]) {

593 
oÊ_msg_Êow_mod
 
msg
 =

594 {{.
ty≥
 = 
OFPT_FLOW_MOD
},

595 .
cookõ
 = 0x0000000000000000ULL,

596 .
cookõ_mask
 = 0x0000000000000000ULL,

597 .
èbÀ_id
 = 0xff,

598 .
comm™d
 = 
OFPFC_ADD
,

599 .
idÀ_timeout
 = 
OFP_FLOW_PERMANENT
,

600 .
h¨d_timeout
 = 
OFP_FLOW_PERMANENT
,

601 .
¥i‹ôy
 = 
OFP_DEFAULT_PRIORITY
,

602 .
buf„r_id
 = 0xffffffff,

603 .
out_p‹t
 = 
OFPP_ANY
,

604 .
out_group
 = 
OFPG_ANY
,

605 .
Êags
 = 0x0000,

606 .
m©ch
 = 
NULL
,

607 .
ö°ru˘i⁄s_num
 = 0,

608 .
ö°ru˘i⁄s
 = 
NULL
};

610 
	`∑r£_Êow_mod_¨gs
(
¨gv
[0], &
msg
);

611 i‡(
¨gc
 > 1) {

612 
size_t
 
i
, 
j
;

613 
size_t
 
ö°_num
 = 0;

614 i‡(
¨gc
 > 2){

615 
ö°_num
 = 
¨gc
 - 2;

616 
j
 = 2;

617 
	`∑r£_m©ch
(
¨gv
[1], &(
msg
.
m©ch
));

620 if(
msg
.
comm™d
 =
OFPFC_DELETE
)

621 
ö°_num
 = 0;

627 *
˝y
 = 
	`mÆloc
(
	`°æí
(
¨gv
[1]));

628 
	`mem˝y
(
˝y
, 
¨gv
[1], 
	`°æí
(argv[1]));

629 
	`∑r£_m©ch
(
˝y
, &(
msg
.
m©ch
));

630 
	`‰ì
(
˝y
);

631 if(
msg
.
m©ch
->
Àngth
 <= 4){

632 
ö°_num
 = 
¨gc
 - 1;

633 
j
 = 1;

638 
msg
.
ö°ru˘i⁄s_num
 = 
ö°_num
;

639 
msg
.
ö°ru˘i⁄s
 = 
	`xmÆloc
((
oÊ_ö°ru˘i⁄_hódî
 *Ë* 
ö°_num
);

640 
i
=0; i < 
ö°_num
; i++) {

641 
	`∑r£_ö°
(
¨gv
[
j
+
i
], &(
msg
.
ö°ru˘i⁄s
[i]));

644 
	`make_Æl_m©ch
(&(
msg
.
m©ch
));

646 
	`dp˘l_£nd_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
msg
);

647 
	}
}

651 
	$group_mod
(
vc⁄n
 *vc⁄n, 
¨gc
, *
¨gv
[]) {

652 
oÊ_msg_group_mod
 
msg
 =

653 {{.
ty≥
 = 
OFPT_GROUP_MOD
},

654 .
comm™d
 = 
OFPGC_ADD
,

655 .
ty≥
 = 
OFPGT_ALL
,

656 .
group_id
 = 
OFPG_ALL
,

657 .
buckës_num
 = 0,

658 .
buckës
 = 
NULL
};

660 
	`∑r£_group_mod_¨gs
(
¨gv
[0], &
msg
);

662 i‡(
¨gc
 > 1) {

663 
size_t
 
i
;

664 
size_t
 
buckës_num
 = (
¨gc
 - 1) / 2;

666 
msg
.
buckës_num
 = buckets_num;

667 
msg
.
buckës
 = 
	`xmÆloc
((
oÊ_buckë
 *Ë* 
buckës_num
);

669 
i
=0; i < 
buckës_num
; i++) {

670 
msg
.
buckës
[
i
] = 
	`xmÆloc
((
oÊ_buckë
));

671 
msg
.
buckës
[
i
]->
weight
 = 0;

672 
msg
.
buckës
[
i
]->
w©ch_p‹t
 = 
OFPP_ANY
;

673 
msg
.
buckës
[
i
]->
w©ch_group
 = 
OFPG_ANY
;

674 
msg
.
buckës
[
i
]->
a˘i⁄s_num
 = 0;

675 
msg
.
buckës
[
i
]->
a˘i⁄s
 = 
NULL
;

677 
	`∑r£_buckë
(
¨gv
[
i
*2+1], 
msg
.
buckës
[i]);

678 
	`∑r£_a˘i⁄s
(
¨gv
[
i
*2+2], &(
msg
.
buckës
[i]->
a˘i⁄s_num
), &(msg.buckës[i]->
a˘i⁄s
));

682 
	`dp˘l_£nd_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
msg
);

683 
	}
}

686 
	$group_„©uªs
(
vc⁄n
 *vc⁄n, 
¨gc
 
UNUSED
, *
¨gv
[] UNUSED){

688 
oÊ_msg_mu…ù¨t_ªque°_hódî
 
ªq
 =

689 {{.
ty≥
 = 
OFPT_MULTIPART_REQUEST
},

690 .
ty≥
 = 
OFPMP_GROUP_FEATURES
, .
Êags
 = 0x0000};

692 
	`dp˘l_å™ß˘_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
ªq
, 
NULL
);

693 
	}
}

695 
	$mëî_mod
(
vc⁄n
 *vc⁄n, 
¨gc
, *
¨gv
[]){

697 
oÊ_msg_mëî_mod
 
msg
 =

698 {{.
ty≥
 = 
OFPT_METER_MOD
},

699 .
comm™d
 = 
OFPMC_ADD
,

700 .
Êags
 = 
OFPMF_KBPS
,

701 .
mëî_id
 = 0,

702 .
mëî_b™ds_num
 = 0,

703 .
b™ds
 = 
NULL
};

705 
	`∑r£_mëî_mod_¨gs
(
¨gv
[0], &
msg
);

707 i‡(
¨gc
 > 1){

708 
size_t
 
i
;

709 
size_t
 
b™ds_num
 = 
¨gc
 - 1;

710 
msg
.
mëî_b™ds_num
 = 
b™ds_num
;

711 
msg
.
b™ds
 = 
	`xmÆloc
((
oÊ_mëî_b™d_hódî
 *Ë* 
b™ds_num
);

712 
i
=0; i < 
b™ds_num
; i++) {

713 
	`∑r£_b™d
(
¨gv
[
i
+1], &
msg
, &msg.
b™ds
[i]);

716 
	`dp˘l_£nd_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
msg
);

718 
	}
}

721 
	$°©s_mëî
(
vc⁄n
 *vc⁄n, 
¨gc
 
UNUSED
, *
¨gv
[]){

723 
oÊ_msg_mu…ù¨t_mëî_ªque°
 
ªq
 =

724 {{{.
ty≥
 = 
OFPT_MULTIPART_REQUEST
},

725 .
ty≥
 = 
OFPMP_METER
, .
Êags
 = 0x0000},

726 .
mëî_id
 = 
OFPM_ALL
};

728 i‡(
¨gc
 > 0 && 
	`∑r£_mëî
(
¨gv
[0], &
ªq
.
mëî_id
)) {

729 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög mëî: %s.", 
¨gv
[0]);

732 
	`dp˘l_å™ß˘_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
ªq
, 
NULL
);

734 
	}
}

737 
	$mëî_c⁄fig
(
vc⁄n
 *vc⁄n, 
¨gc
 
UNUSED
, *
¨gv
[]){

739 
oÊ_msg_mu…ù¨t_mëî_ªque°
 
ªq
 =

740 {{{.
ty≥
 = 
OFPT_MULTIPART_REQUEST
},

741 .
ty≥
 = 
OFPMP_METER_CONFIG
, .
Êags
 = 0x0000},

742 .
mëî_id
 = 
OFPM_ALL
};

744 i‡(
¨gc
 > 0 && 
	`∑r£_mëî
(
¨gv
[0], &
ªq
.
mëî_id
)) {

745 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög mëî: %s.", 
¨gv
[0]);

748 
	`dp˘l_å™ß˘_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
ªq
, 
NULL
);

749 
	}
}

752 
	$mëî_„©uªs
(
vc⁄n
 *vc⁄n, 
¨gc
 
UNUSED
, *
¨gv
[] UNUSED){

754 
oÊ_msg_mu…ù¨t_ªque°_hódî
 
ªq
 =

755 {{.
ty≥
 = 
OFPT_MULTIPART_REQUEST
},

756 .
ty≥
 = 
OFPMP_METER_FEATURES
, .
Êags
 = 0x0000};

758 
	`dp˘l_å™ß˘_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
ªq
, 
NULL
);

759 
	}
}

762 
	$p‹t_mod
(
vc⁄n
 *vc⁄n, 
¨gc
 
UNUSED
, *
¨gv
[]) {

763 
oÊ_msg_p‹t_mod
 
msg
 =

764 {{.
ty≥
 = 
OFPT_PORT_MOD
},

765 .
p‹t_no
 = 
OFPP_ANY
,

766 .
c⁄fig
 = 0x00000000,

767 .
mask
 = 0x00000000,

768 .
advîti£
 = 0x00000000

770 
	`mem˝y
(
msg
.
hw_addr
, 
mask_Æl
, 
OFP_ETH_ALEN
);

772 
	`∑r£_p‹t_mod
(
¨gv
[0], &
msg
);

774 
	`dp˘l_£nd_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
msg
);

775 
	}
}

780 
	$èbÀ_mod
(
vc⁄n
 *vc⁄n, 
¨gc
 
UNUSED
, *
¨gv
[]) {

781 
oÊ_msg_èbÀ_mod
 
msg
 =

782 {{.
ty≥
 = 
OFPT_TABLE_MOD
},

783 .
èbÀ_id
 = 0xff,

784 .
c⁄fig
 = 0x00};

786 
	`∑r£_èbÀ_mod
(
¨gv
[0], &
msg
);

788 
	`dp˘l_£nd_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
msg
);

789 
	}
}

794 
	$queue_gë_c⁄fig
(
vc⁄n
 *vc⁄n, 
¨gc
 
UNUSED
, *
¨gv
[]) {

795 
oÊ_msg_queue_gë_c⁄fig_ªque°
 
msg
 =

796 {{.
ty≥
 = 
OFPT_QUEUE_GET_CONFIG_REQUEST
},

797 .
p‹t
 = 
OFPP_ALL
};

799 i‡(
	`∑r£_p‹t
(
¨gv
[0], &
msg
.
p‹t
)) {

800 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög queue_gë_c⁄figÖ‹t: %s.", 
¨gv
[0]);

803 
	`dp˘l_å™ß˘_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
msg
, 
NULL
);

804 
	}
}

809 
	$£t_desc
(
vc⁄n
 *vc⁄n, 
¨gc
 
UNUSED
, *
¨gv
[]) {

810 
oÊ_exp_›íÊow_msg_£t_dp_desc
 
msg
 =

811 {{{{.
ty≥
 = 
OFPT_EXPERIMENTER
},

812 .
ex≥rimíãr_id
 = 
OPENFLOW_VENDOR_ID
},

813 .
ty≥
 = 
OFP_EXT_SET_DESC
},

814 .
dp_desc
 = 
¨gv
[0]};

816 
	`dp˘l_£nd_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
msg
);

817 
	}
}

822 
	$queue_mod
(
vc⁄n
 *vc⁄n, 
¨gc
 
UNUSED
, *
¨gv
[]) {

823 
oÊ_∑ckë_queue
 *
pq
;

824 
oÊ_queue_¥›_mö_øã
 *
p
;

826 
oÊ_exp_›íÊow_msg_queue
 
msg
 =

827 {{{{.
ty≥
 = 
OFPT_EXPERIMENTER
},

828 .
ex≥rimíãr_id
 = 
OPENFLOW_VENDOR_ID
},

829 .
ty≥
 = 
OFP_EXT_QUEUE_MODIFY
},

830 .
p‹t_id
 = 
OFPP_ANY
,

831 .
queue
 = 
NULL
};

833 i‡(
	`∑r£_p‹t
(
¨gv
[0], &
msg
.
p‹t_id
)) {

834 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög queue_modÖ‹t: %s.", 
¨gv
[0]);

837 
pq
 = 
	`xmÆloc
((
oÊ_∑ckë_queue
));

838 
msg
.
queue
 = 
pq
;

839 i‡(
	`∑r£_queue
(
¨gv
[1], &
pq
->
queue_id
)) {

840 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög queue_mod queue: %s.", 
¨gv
[1]);

843 
pq
->
¥›îtõs_num
 = 1;

844 
pq
->
¥›îtõs
 = 
	`xmÆloc
((
oÊ_queue_¥›_hódî
 *));

846 
p
 = 
	`xmÆloc
((
oÊ_queue_¥›_mö_øã
));

847 
pq
->
¥›îtõs
[0] = (
oÊ_queue_¥›_hódî
 *)
p
;

848 
p
->
hódî
.
ty≥
 = 
OFPQT_MIN_RATE
;

850 i‡(
	`∑r£16
(
¨gv
[2], 
NULL
,0, 
UINT16_MAX
, &
p
->
øã
)) {

851 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög queue_mod bw: %s.", 
¨gv
[2]);

855 
	`dp˘l_£nd_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
msg
);

856 
	}
}

861 
	$queue_dñ
(
vc⁄n
 *vc⁄n, 
¨gc
 
UNUSED
, *
¨gv
[]) {

862 
oÊ_∑ckë_queue
 *
pq
;

864 
oÊ_exp_›íÊow_msg_queue
 
msg
 =

865 {{{{.
ty≥
 = 
OFPT_EXPERIMENTER
},

866 .
ex≥rimíãr_id
 = 
OPENFLOW_VENDOR_ID
},

867 .
ty≥
 = 
OFP_EXT_QUEUE_DELETE
},

868 .
p‹t_id
 = 
OFPP_ANY
,

869 .
queue
 = 
NULL
};

871 i‡(
	`∑r£_p‹t
(
¨gv
[0], &
msg
.
p‹t_id
)) {

872 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög queue_modÖ‹t: %s.", 
¨gv
[0]);

875 
pq
 = 
	`xmÆloc
((
oÊ_∑ckë_queue
));

876 
msg
.
queue
 = 
pq
;

877 i‡(
	`∑r£_queue
(
¨gv
[1], &
pq
->
queue_id
)) {

878 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög queue_mod queue: %s.", 
¨gv
[1]);

881 
pq
->
¥›îtõs_num
 = 0;

882 
pq
->
¥›îtõs
 = 
NULL
;

884 
	`dp˘l_£nd_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
msg
);

885 
	}
}

888 
	$gë_async
(
vc⁄n
 *vc⁄n, 
¨gc
 
UNUSED
, *
¨gv
[] UNUSED){

890 
oÊ_msg_async_c⁄fig
 
msg
 =

891 {{.
ty≥
 = 
OFPT_GET_ASYNC_REQUEST
},

892 .
c⁄fig
 = 
NULL
};

894 
	`dp˘l_å™ß˘_™d_¥öt
(
vc⁄n
, (
oÊ_msg_hódî
 *)&
msg
, 
NULL
);

895 
	}
}

897 
comm™d
 
	gÆl_comm™ds
[] = {

898 {"pög", 0, 2, 
pög
},

899 {"m⁄ô‹", 0, 0, 
m⁄ô‹
},

901 {"„©uªs", 0, 0, 
„©uªs
 },

902 {"gë-c⁄fig", 0, 0, 
gë_c⁄fig
},

903 {"èbÀ-„©uªs", 0, 0, 
èbÀ_„©uªs
},

904 {"group-„©uªs", 0, 0, 
group_„©uªs
},

905 {"mëî-„©uªs", 0, 0, 
mëî_„©uªs
},

906 {"°©s-desc", 0, 0, 
°©s_desc
 },

907 {"°©s-Êow", 0, 2, 
°©s_Êow
},

908 {"°©s-aggr", 0, 2, 
°©s_aggr
},

909 {"°©s-èbÀ", 0, 0, 
°©s_èbÀ
 },

910 {"°©s-p‹t", 0, 1, 
°©s_p‹t
 },

911 {"°©s-queue", 0, 2, 
°©s_queue
 },

912 {"°©s-group", 0, 1, 
°©s_group
 },

913 {"°©s-group-desc", 0, 1, 
°©s_group_desc
 },

914 {"°©s-mëî", 0, 1, 
°©s_mëî
},

915 {"mëî-c⁄fig", 0, 1, 
mëî_c⁄fig
},

916 {"p‹t-desc", 0, 0, 
p‹t_desc
},

917 {"£t-c⁄fig", 1, 1, 
£t_c⁄fig
},

918 {"Êow-mod", 1, 8 , 
Êow_mod
 },

919 {"group-mod", 1, 
UINT8_MAX
, 
group_mod
 },

920 {"mëî-mod", 1, 
UINT8_MAX
, 
mëî_mod
},

921 {"gë-async",0,0, 
gë_async
},

922 {"p‹t-mod", 1, 1, 
p‹t_mod
 },

923 {"èbÀ-mod", 1, 1, 
èbÀ_mod
 },

924 {"queue-gë-c⁄fig", 1, 1, 
queue_gë_c⁄fig
},

925 {"£t-desc", 1, 1, 
£t_desc
},

927 {"queue-mod", 3, 3, 
queue_mod
},

928 {"queue-dñ", 2, 2, 
queue_dñ
}

932 
	$maö
(
¨gc
, *
¨gv
[])

934 
comm™d
 *
p
;

935 
vc⁄n
 *vconn;

936 
size_t
 
i
;

937 
îr‹
;

939 
	`£t_¥ogøm_«me
(
¨gv
[0]);

940 
	`time_öô
();

941 
	`vlog_öô
();

942 
	`∑r£_›ti⁄s
(
¨gc
, 
¨gv
);

943 
	`sig«l
(
SIGPIPE
, 
SIG_IGN
);

945 
¨gc
 -
›töd
;

946 
¨gv
 +
›töd
;

947 i‡(
¨gc
 < 1)

948 
	`oÂ_Áèl
(0, "missing SWITCH; use --help for help");

949 i‡(
¨gc
 < 2)

950 
	`oÂ_Áèl
(0, "missing COMMAND; use --help for help");

952 
îr‹
 = 
	`vc⁄n_›í_block
(
¨gv
[0], 
OFP_VERSION
, &
vc⁄n
);

953 i‡(
îr‹
) {

954 
	`oÂ_Áèl
(
îr‹
, "Eº‹ c⁄√˘ögÅÿswôch %s.", 
¨gv
[0]);

956 
¨gc
 -= 1;

957 
¨gv
 += 1;

959 
i
=0; i<
	`NUM_ELEMS
(
Æl_comm™ds
); i++) {

960 
p
 = &
Æl_comm™ds
[
i
];

961 i‡(
	`°rcmp
(
p
->
«me
, 
¨gv
[0]) == 0) {

962 
¨gc
 -= 1;

963 
¨gv
 += 1;

964 i‡(
¨gc
 < 
p
->
mö_¨gs
)

965 
	`oÂ_Áèl
(0, "'%s' commandÑequiresátÜeast %dárguments",

966 
p
->
«me
,Ö->
mö_¨gs
);

967 i‡(
¨gc
 > 
p
->
max_¨gs
)

968 
	`oÂ_Áèl
(0, "'%s' commandÅakesát most %dárguments",

969 
p
->
«me
,Ö->
max_¨gs
);

971 
p
->
	`h™dÀr
(
vc⁄n
, 
¨gc
, 
¨gv
);

972 i‡(
	`„º‹
(
°dout
)) {

973 
	`oÂ_Áèl
(0, "writeÅo stdout failed");

975 i‡(
	`„º‹
(
°dîr
)) {

976 
	`oÂ_Áèl
(0, "writeÅo stderr failed");

978 
	`vc⁄n_˛o£
(
vc⁄n
);

979 
	`exô
(0);

983 
	`oÂ_Áèl
(0, "unknow¿comm™d '%s'; u£ --hñ∞f‹ hñp", 
¨gv
[0]);

984 
	`vc⁄n_˛o£
(
vc⁄n
);

986 
	}
}

989 
	$∑r£_›ti⁄s
(
¨gc
, *
¨gv
[])

992 
OPT_STRICT
 = 
UCHAR_MAX
 + 1

994 
›ti⁄
 
l⁄g_›ti⁄s
[] = {

995 {"timeout", 
ªquúed_¨gumít
, 0, 't'},

996 {"vîbo£", 
›ti⁄Æ_¨gumít
, 0, 'v'},

997 {"°ri˘", 
no_¨gumít
, 0, 
OPT_STRICT
},

998 {"hñp", 
no_¨gumít
, 0, 'h'},

999 {"vîsi⁄", 
no_¨gumít
, 0, 'V'},

1000 
VCONN_SSL_LONG_OPTIONS


1003 *
sh‹t_›ti⁄s
 = 
	`l⁄g_›ti⁄s_to_sh‹t_›ti⁄s
(
l⁄g_›ti⁄s
);

1006 
timeout
;

1007 
c
;

1009 
c
 = 
	`gë›t_l⁄g
(
¨gc
, 
¨gv
, 
sh‹t_›ti⁄s
, 
l⁄g_›ti⁄s
, 
NULL
);

1010 i‡(
c
 == -1) {

1014 
c
) {

1016 
timeout
 = 
	`°πoul
(
›èrg
, 
NULL
, 10);

1017 i‡(
timeout
 <= 0) {

1018 
	`oÂ_Áèl
(0, "value %s on -t or --timeout isÇotátÜeast 1",

1019 
›èrg
);

1021 
	`time_Æ¨m
(
timeout
);

1026 
	`ußge
();

1029 
	`¥ötf
("%†%†compûed "
__DATE__
" "
__TIME__
"\n",

1030 
¥ogøm_«me
, 
VERSION
 
BUILDNR
);

1031 
	`exô
(
EXIT_SUCCESS
);

1034 
	`vlog_£t_vîbosôy
(
›èrg
);

1037 
VCONN_SSL_OPTION_HANDLERS


1040 
	`exô
(
EXIT_FAILURE
);

1043 
	`ab‹t
();

1046 
	`‰ì
(
sh‹t_›ti⁄s
);

1047 
	}
}

1052 
	$ußge
()

1054 
	`¥ötf
("%s: OpenFlow switch management utility\n"

1086 
¥ogøm_«me
,Örogram_name);

1087 
	`vc⁄n_ußge
(
åue
, 
Ál£
, false);

1088 
	`vlog_ußge
();

1089 
	`¥ötf
("\nOther options:\n"

1094 
	`exô
(
EXIT_SUCCESS
);

1095 
	}
}

1098 
	$∑r£_m©ch
(*
°r
, 
oÊ_m©ch_hódî
 **
m©ch
) {

1100 *
tokí
, *
ßvïå
 = 
NULL
;

1101 
oÊ_m©ch
 *
m
 = 
	`xmÆloc
((ofl_match));

1102 
	`oÊ_°ru˘s_m©ch_öô
(
m
);

1104 
tokí
 = 
	`°πok_r
(
°r
, 
KEY_SEP
, &
ßvïå
);Åokí !
NULL
;Åoken = strtok_r(NULL, KEY_SEP, &saveptr)) {

1105 i‡(
	`°∫cmp
(
tokí
, "≠∂y", 
	`°æí
("apply")) == 0 || strncmp(token, "write", strlen("write")) == 0 ) {

1109 i‡(
	`°∫cmp
(
tokí
, 
MATCH_IN_PORT
 
KEY_VAL
, 
	`°æí
(MATCH_IN_PORT KEY_VAL)) == 0) {

1110 
uöt32_t
 
ö_p‹t
;

1111 i‡(
	`∑r£_p‹t
(
tokí
 + 
	`°æí
(
MATCH_IN_PORT
 
KEY_VAL
), &
ö_p‹t
)) {

1112 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÖ‹t: %s.", 
tokí
);

1114 
	`oÊ_°ru˘s_m©ch_put32
(
m
,
OXM_OF_IN_PORT
,
ö_p‹t
);

1119 i‡(
	`°∫cmp
(
tokí
, 
MATCH_DL_SRC
 
KEY_VAL
, 
	`°æí
(MATCH_DL_SRC KEY_VAL)) == 0) {

1120 
uöt8_t
 
ëh_§c
[6];

1121 
uöt8_t
 *
mask
;

1122 i‡(
	`∑r£_dl_addr
(
tokí
 + 
	`°æí
(
MATCH_DL_SRC
 
KEY_VAL
), 
ëh_§c
, &
mask
)) {

1123 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög dl_§c: %s.", 
tokí
);

1126 i‡(
mask
 =
NULL
)

1127 
	`oÊ_°ru˘s_m©ch_put_ëh
(
m
,
OXM_OF_ETH_SRC
,
ëh_§c
);

1129 
	`oÊ_°ru˘s_m©ch_put_ëh_m
(
m
,
OXM_OF_ETH_SRC_W
,
ëh_§c
,
mask
);

1133 i‡(
	`°∫cmp
(
tokí
, 
MATCH_DL_DST
 
KEY_VAL
, 
	`°æí
(MATCH_DL_DST KEY_VAL)) == 0) {

1134 
uöt8_t
 
ëh_d°
[6];

1135 
uöt8_t
 *
mask
;

1136 i‡(
	`∑r£_dl_addr
(
tokí
 + 
	`°æí
(
MATCH_DL_DST
 
KEY_VAL
), 
ëh_d°
, &
mask
)) {

1137 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög dl_d°: %s.", 
tokí
);

1140 i‡(
mask
 =
NULL
)

1141 
	`oÊ_°ru˘s_m©ch_put_ëh
(
m
,
OXM_OF_ETH_DST
,
ëh_d°
);

1143 
	`oÊ_°ru˘s_m©ch_put_ëh_m
(
m
,
OXM_OF_ETH_DST_W
,
ëh_d°
, 
mask
);

1148 i‡(
	`°∫cmp
(
tokí
, 
MATCH_ARP_SHA
 
KEY_VAL
, 
	`°æí
(MATCH_ARP_SHA KEY_VAL)) == 0) {

1149 
uöt8_t
 
¨p_sha
[6];

1150 
uöt8_t
 *
mask
;

1151 i‡(
	`∑r£_dl_addr
(
tokí
 + 
	`°æí
(
MATCH_ARP_SHA
 
KEY_VAL
), 
¨p_sha
, &
mask
)) {

1152 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögáΩ_sha: %s.", 
tokí
);

1155 i‡(
mask
 =
NULL
)

1156 
	`oÊ_°ru˘s_m©ch_put_ëh
(
m
, 
OXM_OF_ARP_SHA
, 
¨p_sha
);

1158 
	`oÊ_°ru˘s_m©ch_put_ëh_m
(
m
, 
OXM_OF_ARP_SHA_W
, 
¨p_sha
, 
mask
);

1162 i‡(
	`°∫cmp
(
tokí
, 
MATCH_ARP_THA
 
KEY_VAL
, 
	`°æí
(MATCH_ARP_THA KEY_VAL)) == 0) {

1163 
uöt8_t
 
¨p_tha
[6];

1164 
uöt8_t
 *
mask
;

1165 i‡(
	`∑r£_dl_addr
(
tokí
 + 
	`°æí
(
MATCH_ARP_THA
 
KEY_VAL
), 
¨p_tha
, &
mask
)) {

1166 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögáΩ_th®%s.", 
tokí
);

1169 i‡(
mask
 =
NULL
)

1170 
	`oÊ_°ru˘s_m©ch_put_ëh
(
m
,
OXM_OF_ARP_THA
, 
¨p_tha
);

1172 
	`oÊ_°ru˘s_m©ch_put_ëh_m
(
m
,
OXM_OF_ARP_THA_W
, 
¨p_tha
, 
mask
);

1176 i‡(
	`°∫cmp
(
tokí
, 
MATCH_ARP_SPA
 
KEY_VAL
, 
	`°æí
(MATCH_ARP_SPA KEY_VAL)) == 0) {

1177 
uöt32_t
 
¨p_§c
;

1178 
uöt32_t
 *
mask
;

1179 i‡(
	`∑r£_nw_addr
(
tokí
 + 
	`°æí
(
MATCH_ARP_SPA
 
KEY_VAL
), &(
¨p_§c
), &
mask
)) {

1180 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögáΩ_§c: %s.", 
tokí
);

1183 i‡(
mask
 =
NULL
)

1184 
	`oÊ_°ru˘s_m©ch_put32
(
m
, 
OXM_OF_ARP_SPA
,
¨p_§c
);

1186 
	`oÊ_°ru˘s_m©ch_put32m
(
m
, 
OXM_OF_ARP_SPA_W
, 
¨p_§c
, *
mask
);

1190 i‡(
	`°∫cmp
(
tokí
, 
MATCH_ARP_TPA
 
KEY_VAL
, 
	`°æí
(MATCH_ARP_TPA KEY_VAL)) == 0) {

1191 
uöt32_t
 
¨p_èrgë
;

1192 
uöt32_t
 *
mask
;

1193 i‡(
	`∑r£_nw_addr
(
tokí
 + 
	`°æí
(
MATCH_ARP_TPA
 
KEY_VAL
), &(
¨p_èrgë
), &
mask
)) {

1194 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögáΩ_èrgë: %s.", 
tokí
);

1197 i‡(
mask
 =
NULL
)

1198 
	`oÊ_°ru˘s_m©ch_put32
(
m
, 
OXM_OF_ARP_TPA
, 
¨p_èrgë
);

1200 
	`oÊ_°ru˘s_m©ch_put32m
(
m
, 
OXM_OF_ARP_TPA_W
, 
¨p_èrgë
, *
mask
);

1204 i‡(
	`°∫cmp
(
tokí
, 
MATCH_ARP_OP
 
KEY_VAL
, 
	`°æí
(MATCH_ARP_OP KEY_VAL)) == 0) {

1205 
uöt16_t
 
¨p_›
;

1206 i‡(
	`∑r£16
(
tokí
 + 
	`°æí
(
MATCH_ARP_OP
 
KEY_VAL
), 
NULL
, 0, 0x7, &
¨p_›
)){

1207 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögáΩ_›: %s.", 
tokí
);

1209 
	`oÊ_°ru˘s_m©ch_put16
(
m
, 
OXM_OF_ARP_OP
, 
¨p_›
);

1215 i‡(
	`°∫cmp
(
tokí
, 
MATCH_DL_VLAN
 
KEY_VAL
, 
	`°æí
(MATCH_DL_VLAN KEY_VAL)) == 0) {

1216 
uöt16_t
 
dl_vœn
;

1217 *
°r
 = 
tokí
 + 
	`°æí
(
MATCH_DL_VLAN
 
KEY_VAL
);

1219 i‡(
	`°rcmp
(
°r
, "any") == 0)

1220 
	`oÊ_°ru˘s_m©ch_put16m
(
m
,
OXM_OF_VLAN_VID_W
, 
OFPVID_PRESENT
, OFPVID_PRESENT);

1221 i‡(
	`°rcmp
(
°r
, "none") == 0)

1222 
	`oÊ_°ru˘s_m©ch_put16
(
m
,
OXM_OF_VLAN_VID
, 
OFPVID_NONE
);

1223 i‡(
	`∑r£16
(
°r
, 
NULL
, 0, 0xfff, &
dl_vœn
))

1224 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög vœ¿œbñ: %s.", 
tokí
);

1226 
	`oÊ_°ru˘s_m©ch_put16
(
m
,
OXM_OF_VLAN_VID
, 
dl_vœn
 | 
OFPVID_PRESENT
);

1230 i‡(
	`°∫cmp
(
tokí
, 
MATCH_DL_VLAN_PCP
 
KEY_VAL
, 
	`°æí
(MATCH_DL_VLAN_PCP KEY_VAL)) == 0) {

1231 
uöt8_t
 
p˝
;

1232 i‡(
	`∑r£8
(
tokí
 + 
	`°æí
(
MATCH_DL_VLAN_PCP
 
KEY_VAL
), 
NULL
, 0, 0x7, &
p˝
)) {

1233 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög vœ¿p˝: %s.", 
tokí
);

1235 
	`oÊ_°ru˘s_m©ch_put8
(
m
, 
OXM_OF_VLAN_PCP
, 
p˝
);

1240 i‡(
	`°∫cmp
(
tokí
, 
MATCH_DL_TYPE
 
KEY_VAL
, 
	`°æí
(MATCH_DL_TYPE KEY_VAL)) == 0) {

1241 
uöt16_t
 
dl_ty≥
;

1242 i‡(
	`∑r£16
(
tokí
 + 
	`°æí
(
MATCH_DL_TYPE
 
KEY_VAL
), 
NULL
, 0, 0xffff, &
dl_ty≥
)) {

1243 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÉth_ty≥: %s.", 
tokí
);

1246 
	`oÊ_°ru˘s_m©ch_put16
(
m
, 
OXM_OF_ETH_TYPE
,
dl_ty≥
);

1251 i‡(
	`°∫cmp
(
tokí
, 
MATCH_IP_ECN
 
KEY_VAL
, 
	`°æí
(MATCH_IP_ECN KEY_VAL)) == 0) {

1252 
uöt8_t
 
ù_e˙
;

1253 i‡(
	`∑r£8
(
tokí
 + 
	`°æí
(
MATCH_IP_ECN
 
KEY_VAL
), 
NULL
, 0, 0x3f, &
ù_e˙
)) {

1254 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÇw_tos: %s.", 
tokí
);

1257 
	`oÊ_°ru˘s_m©ch_put8
(
m
, 
OXM_OF_IP_ECN
, 
ù_e˙
);

1260 i‡(
	`°∫cmp
(
tokí
, 
MATCH_IP_DSCP
 
KEY_VAL
, 
	`°æí
(MATCH_IP_DSCP KEY_VAL)) == 0) {

1261 
uöt8_t
 
ù_ds˝
;

1262 i‡(
	`∑r£8
(
tokí
 + 
	`°æí
(
MATCH_IP_DSCP
 
KEY_VAL
), 
NULL
, 0, 0x3f, &
ù_ds˝
)) {

1263 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÇw_tos: %s.", 
tokí
);

1266 
	`oÊ_°ru˘s_m©ch_put8
(
m
, 
OXM_OF_IP_DSCP
, 
ù_ds˝
);

1269 i‡(
	`°∫cmp
(
tokí
, 
MATCH_NW_PROTO
 
KEY_VAL
, 
	`°æí
(MATCH_NW_PROTO KEY_VAL)) == 0) {

1270 
uöt8_t
 
nw_¥Ÿo
;

1271 i‡(
	`∑r£8
(
tokí
 + 
	`°æí
(
MATCH_NW_PROTO
 
KEY_VAL
), 
NULL
, 0, 0xff, &
nw_¥Ÿo
)) {

1272 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög ip_¥Ÿo: %s.", 
tokí
);

1274 
	`oÊ_°ru˘s_m©ch_put8
(
m
,
OXM_OF_IP_PROTO
, 
nw_¥Ÿo
);

1277 i‡(
	`°∫cmp
(
tokí
, 
MATCH_NW_SRC
 
KEY_VAL
, 
	`°æí
(MATCH_NW_SRC KEY_VAL)) == 0) {

1278 
uöt32_t
 
nw_§c
;

1279 
uöt32_t
 *
mask
;

1280 i‡(
	`∑r£_nw_addr
(
tokí
 + 
	`°æí
(
MATCH_NW_SRC
 
KEY_VAL
), &(
nw_§c
), &
mask
)) {

1281 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög ip_§c: %s.", 
tokí
);

1284 i‡(
mask
 =
NULL
)

1285 
	`oÊ_°ru˘s_m©ch_put32
(
m
, 
OXM_OF_IPV4_SRC
,
nw_§c
);

1287 
	`oÊ_°ru˘s_m©ch_put32m
(
m
, 
OXM_OF_IPV4_SRC_W
, 
nw_§c
, *
mask
);

1291 i‡(
	`°∫cmp
(
tokí
, 
MATCH_NW_DST
 
KEY_VAL
, 
	`°æí
(MATCH_NW_DST KEY_VAL)) == 0) {

1292 
uöt32_t
 
nw_d°
;

1293 
uöt32_t
 *
mask
;

1294 i‡(
	`∑r£_nw_addr
(
tokí
 + 
	`°æí
(
MATCH_NW_DST
 
KEY_VAL
), &
nw_d°
, &
mask
)) {

1295 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög ip_d°: %s.", 
tokí
);

1298 i‡(
mask
 =
NULL
)

1299 
	`oÊ_°ru˘s_m©ch_put32
(
m
, 
OXM_OF_IPV4_DST
,
nw_d°
);

1301 
	`oÊ_°ru˘s_m©ch_put32m
(
m
, 
OXM_OF_IPV4_DST_W
,
nw_d°
, *
mask
);

1307 i‡(
	`°∫cmp
(
tokí
, 
MATCH_ICMPV4_CODE
 
KEY_VAL
, 
	`°æí
(MATCH_ICMPV4_CODE KEY_VAL)) == 0) {

1308 
uöt8_t
 
icmpv4_code
;

1309 i‡(
	`∑r£8
(
tokí
 + 
	`°æí
(
MATCH_ICMPV4_CODE
 
KEY_VAL
), 
NULL
, 0, 0x3f, &
icmpv4_code
)) {

1310 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög icmpv4_code: %s.", 
tokí
);

1313 
	`oÊ_°ru˘s_m©ch_put8
(
m
, 
OXM_OF_ICMPV4_CODE
, 
icmpv4_code
);

1316 i‡(
	`°∫cmp
(
tokí
, 
MATCH_ICMPV4_TYPE
 
KEY_VAL
, 
	`°æí
(MATCH_ICMPV4_TYPE KEY_VAL)) == 0) {

1317 
uöt8_t
 
icmpv4_ty≥
;

1318 i‡(
	`∑r£8
(
tokí
 + 
	`°æí
(
MATCH_ICMPV4_TYPE
 
KEY_VAL
), 
NULL
, 0, 0x3f, &
icmpv4_ty≥
)) {

1319 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög icmpv4_ty≥: %s.", 
tokí
);

1322 
	`oÊ_°ru˘s_m©ch_put8
(
m
, 
OXM_OF_ICMPV4_TYPE
, 
icmpv4_ty≥
);

1327 i‡(
	`°∫cmp
(
tokí
, 
MATCH_TP_SRC
 
KEY_VAL
, 
	`°æí
(MATCH_TP_SRC KEY_VAL)) == 0) {

1328 
uöt16_t
 
ç_§c
;

1329 i‡(
	`∑r£16
(
tokí
 + 
	`°æí
(
MATCH_TP_SRC
 
KEY_VAL
), 
NULL
, 0, 0xffff, &
ç_§c
)) {

1330 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÅ˝_§c: %s.", 
tokí
);

1332 
	`oÊ_°ru˘s_m©ch_put16
(
m
, 
OXM_OF_TCP_SRC
,
ç_§c
);

1335 i‡(
	`°∫cmp
(
tokí
, 
MATCH_TP_DST
 
KEY_VAL
, 
	`°æí
(MATCH_TP_DST KEY_VAL)) == 0) {

1336 
uöt16_t
 
ç_d°
;

1337 i‡(
	`∑r£16
(
tokí
 + 
	`°æí
(
MATCH_TP_DST
 
KEY_VAL
), 
NULL
, 0, 0xffff, &
ç_d°
)) {

1338 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÅ˝_d°: %s.", 
tokí
);

1340 
	`oÊ_°ru˘s_m©ch_put16
(
m
, 
OXM_OF_TCP_DST
,
ç_d°
);

1345 i‡(
	`°∫cmp
(
tokí
, 
MATCH_UDP_SRC
 
KEY_VAL
, 
	`°æí
(MATCH_UDP_SRC KEY_VAL)) == 0) {

1346 
uöt16_t
 
udp_§c
;

1347 i‡(
	`∑r£16
(
tokí
 + 
	`°æí
(
MATCH_UDP_SRC
 
KEY_VAL
), 
NULL
, 0, 0xffff, &
udp_§c
)) {

1348 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög udp_§c: %s.", 
tokí
);

1350 
	`oÊ_°ru˘s_m©ch_put16
(
m
, 
OXM_OF_UDP_SRC
,
udp_§c
);

1353 i‡(
	`°∫cmp
(
tokí
, 
MATCH_UDP_DST
 
KEY_VAL
, 
	`°æí
(MATCH_UDP_DST KEY_VAL)) == 0) {

1354 
uöt16_t
 
udp_d°
;

1355 i‡(
	`∑r£16
(
tokí
 + 
	`°æí
(
MATCH_UDP_DST
 
KEY_VAL
), 
NULL
, 0, 0xffff, &
udp_d°
)) {

1356 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög udp_d°: %s.", 
tokí
);

1358 
	`oÊ_°ru˘s_m©ch_put16
(
m
, 
OXM_OF_UDP_DST
,
udp_d°
);

1363 i‡(
	`°∫cmp
(
tokí
, 
MATCH_SCTP_SRC
 
KEY_VAL
, 
	`°æí
(MATCH_SCTP_SRC KEY_VAL)) == 0) {

1364 
uöt16_t
 
s˘p_§c
;

1365 i‡(
	`∑r£16
(
tokí
 + 
	`°æí
(
MATCH_SCTP_SRC
 
KEY_VAL
), 
NULL
, 0, 0xffff, &
s˘p_§c
)) {

1366 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög s˘p_§c: %s.", 
tokí
);

1368 
	`oÊ_°ru˘s_m©ch_put16
(
m
, 
OXM_OF_SCTP_SRC
,
s˘p_§c
);

1371 i‡(
	`°∫cmp
(
tokí
, 
MATCH_SCTP_DST
 
KEY_VAL
, 
	`°æí
(MATCH_SCTP_DST KEY_VAL)) == 0) {

1372 
uöt16_t
 
s˘p_d°
;

1373 i‡(
	`∑r£16
(
tokí
 + 
	`°æí
(
MATCH_SCTP_DST
 
KEY_VAL
), 
NULL
, 0, 0xffff, &
s˘p_d°
)) {

1374 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög s˘p_d°: %s.", 
tokí
);

1376 
	`oÊ_°ru˘s_m©ch_put16
(
m
, 
OXM_OF_SCTP_DST
,
s˘p_d°
);

1380 i‡(
	`°∫cmp
(
tokí
, 
MATCH_MPLS_LABEL
 
KEY_VAL
, 
	`°æí
(MATCH_MPLS_LABEL KEY_VAL)) == 0) {

1381 
uöt32_t
 
m∂s_œbñ
;

1382 i‡(
	`∑r£32
(
tokí
 + 
	`°æí
(
MATCH_MPLS_LABEL
 
KEY_VAL
), 
NULL
, 0, 0xfffff, &
m∂s_œbñ
)) {

1383 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög m∂s_œbñ: %s.", 
tokí
);

1385 
	`oÊ_°ru˘s_m©ch_put32
(
m
,
OXM_OF_MPLS_LABEL
,
m∂s_œbñ
);

1388 i‡(
	`°∫cmp
(
tokí
, 
MATCH_MPLS_TC
 
KEY_VAL
, 
	`°æí
(MATCH_MPLS_TC KEY_VAL)) == 0) {

1389 
uöt8_t
 
m∂s_tc
;

1390 i‡(
	`∑r£8
(
tokí
 + 
	`°æí
(
MATCH_MPLS_TC
 
KEY_VAL
), 
NULL
, 0, 0x07, &
m∂s_tc
)) {

1391 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög m∂s_tc: %s.", 
tokí
);

1394 
	`oÊ_°ru˘s_m©ch_put8
(
m
, 
OXM_OF_MPLS_TC
, 
m∂s_tc
);

1397 i‡(
	`°∫cmp
(
tokí
, 
MATCH_MPLS_BOS
 
KEY_VAL
, 
	`°æí
(MATCH_MPLS_BOS KEY_VAL)) == 0) {

1398 
uöt8_t
 
m∂s_bos
;

1399 i‡(
	`∑r£8
(
tokí
 + 
	`°æí
(
MATCH_MPLS_BOS
 
KEY_VAL
), 
NULL
, 0, 0x1, &
m∂s_bos
)) {

1400 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög m∂s_tc: %s.", 
tokí
);

1403 
	`oÊ_°ru˘s_m©ch_put8
(
m
, 
OXM_OF_MPLS_BOS
, 
m∂s_bos
);

1407 i‡(
	`°∫cmp
(
tokí
, 
MATCH_NW_SRC_IPV6
 
KEY_VAL
 , 
	`°æí
(MATCH_NW_SRC_IPV6 KEY_VAL)) == 0) {

1408 
ö6_addr
 
addr
, 
mask
;

1409 
ö6_addr
 
ö6addr_zîo
 = 
IN6ADDR_ZERO_INIT
;

1410 i‡(
	`°r_to_ùv6
(
tokí
 + 
	`°æí
(
MATCH_NW_DST_IPV6
)+1, &
addr
, &
mask
) < 0) {

1411 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÇw_§c_ùv6: %s.", 
tokí
);

1414 if(
	`ùv6_addr_equÆs
(&
mask
, &
ö6addr_zîo
)){

1415 
	`oÊ_°ru˘s_m©ch_put_ùv6
(
m
, 
OXM_OF_IPV6_SRC
, 
addr
.
s6_addr
);

1418 
	`oÊ_°ru˘s_m©ch_put_ùv6m
(
m
, 
OXM_OF_IPV6_SRC_W
,
addr
.
s6_addr
, 
mask
.s6_addr);

1423 i‡(
	`°∫cmp
(
tokí
, 
MATCH_NW_DST_IPV6
 
KEY_VAL
 , 
	`°æí
(MATCH_NW_DST_IPV6 KEY_VAL)) == 0) {

1424 
ö6_addr
 
addr
, 
mask
;

1425 
ö6_addr
 
ö6addr_zîo
 = 
IN6ADDR_ZERO_INIT
;

1426 i‡(
	`°r_to_ùv6
(
tokí
 + 
	`°æí
(
MATCH_NW_DST_IPV6
)+1, &
addr
, &
mask
) < 0) {

1427 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÇw_§c_ùv6: %s.", 
tokí
);

1430 if(
	`ùv6_addr_equÆs
(&
mask
, &
ö6addr_zîo
)){

1431 
	`oÊ_°ru˘s_m©ch_put_ùv6
(
m
, 
OXM_OF_IPV6_DST
, 
addr
.
s6_addr
);

1434 
	`oÊ_°ru˘s_m©ch_put_ùv6m
(
m
, 
OXM_OF_IPV6_DST_W
, 
addr
.
s6_addr
, 
mask
.s6_addr);

1439 i‡(
	`°∫cmp
(
tokí
, 
MATCH_IPV6_FLABEL
 
KEY_VAL
, 
	`°æí
(MATCH_IPV6_FLABEL KEY_VAL)) == 0) {

1440 
uöt32_t
 
ùv6_œbñ
;

1441 
uöt32_t
 *
mask
;

1442 i‡(
	`∑r£32m
(
tokí
 + 
	`°æí
(
MATCH_IPV6_FLABEL
 
KEY_VAL
), 
NULL
, 0, 0xfffff, &
ùv6_œbñ
, &
mask
)) {

1443 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög ipv6_œbñ: %s.", 
tokí
);

1446 if(
mask
 =
NULL
)

1447 
	`oÊ_°ru˘s_m©ch_put32
(
m
, 
OXM_OF_IPV6_FLABEL
, 
ùv6_œbñ
);

1449 
	`oÊ_°ru˘s_m©ch_put32m
(
m
, 
OXM_OF_IPV6_FLABEL_W
, 
ùv6_œbñ
, *
mask
);

1454 i‡(
	`°∫cmp
(
tokí
, 
MATCH_ICMPV6_CODE
 
KEY_VAL
, 
	`°æí
(MATCH_ICMPV6_CODE KEY_VAL)) == 0) {

1455 
uöt8_t
 
icmpv6_code
;

1456 i‡(
	`∑r£8
(
tokí
 + 
	`°æí
(
MATCH_ICMPV6_CODE
 
KEY_VAL
), 
NULL
, 0, 0x3f, &
icmpv6_code
)) {

1457 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög icmpv6_code: %s.", 
tokí
);

1460 
	`oÊ_°ru˘s_m©ch_put8
(
m
, 
OXM_OF_ICMPV6_CODE
, 
icmpv6_code
);

1463 i‡(
	`°∫cmp
(
tokí
, 
MATCH_ICMPV6_TYPE
 
KEY_VAL
, 
	`°æí
(MATCH_ICMPV6_TYPE KEY_VAL)) == 0) {

1464 
uöt8_t
 
icmpv6_ty≥
;

1465 i‡(
	`∑r£8
(
tokí
 + 
	`°æí
(
MATCH_ICMPV6_TYPE
 
KEY_VAL
), 
NULL
, 0, 0x3f, &
icmpv6_ty≥
)) {

1466 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög icmpv6_ty≥: %s.", 
tokí
);

1469 
	`oÊ_°ru˘s_m©ch_put8
(
m
, 
OXM_OF_ICMPV6_TYPE
, 
icmpv6_ty≥
);

1474 i‡(
	`°∫cmp
(
tokí
, 
MATCH_IPV6_ND_TARGET
 
KEY_VAL
 , 
	`°æí
(MATCH_IPV6_ND_TARGET KEY_VAL)) == 0) {

1475 
ö6_addr
 
addr
, 
mask
;

1476 i‡(
	`°r_to_ùv6
(
tokí
 + 
	`°æí
(
MATCH_IPV6_ND_TARGET
)+1, &
addr
, &
mask
) < 0) {

1477 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög ipv6_nd_èrgë %s.", 
tokí
);

1480 
	`oÊ_°ru˘s_m©ch_put_ùv6
(
m
, 
OXM_OF_IPV6_ND_TARGET
, 
addr
.
s6_addr
);

1484 i‡(
	`°∫cmp
(
tokí
, 
MATCH_IPV6_ND_SLL
 
KEY_VAL
, 
	`°æí
(MATCH_IPV6_ND_SLL KEY_VAL)) == 0) {

1485 
uöt8_t
 
ëh_§c
[6];

1486 
uöt8_t
 *
mask
;

1487 i‡(
	`∑r£_dl_addr
(
tokí
 + 
	`°æí
(
MATCH_IPV6_ND_SLL
 
KEY_VAL
), 
ëh_§c
, &
mask
)) {

1488 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög ipv6_nd_¶l: %s.", 
tokí
);

1491 
	`oÊ_°ru˘s_m©ch_put_ëh
(
m
,
OXM_OF_IPV6_ND_SLL
, 
ëh_§c
);

1495 i‡(
	`°∫cmp
(
tokí
, 
MATCH_IPV6_ND_TLL
 
KEY_VAL
, 
	`°æí
(MATCH_IPV6_ND_TLL KEY_VAL)) == 0) {

1496 
uöt8_t
 
ëh_d°
[6];

1497 
uöt8_t
 *
mask
;

1498 i‡(
	`∑r£_dl_addr
(
tokí
 + 
	`°æí
(
MATCH_IPV6_ND_TLL
 
KEY_VAL
), 
ëh_d°
, &
mask
)) {

1499 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög ipv_nd_él: %s.", 
tokí
);

1502 
	`oÊ_°ru˘s_m©ch_put_ëh
(
m
, 
OXM_OF_IPV6_ND_TLL
,
ëh_d°
);

1508 i‡(
	`°∫cmp
(
tokí
, 
MATCH_METADATA
 
KEY_VAL
, 
	`°æí
(MATCH_METADATA KEY_VAL)) == 0) {

1509 
uöt64_t
 
mëad©a
;

1510 i‡(
	`ssˇnf
(
tokí
, 
MATCH_METADATA
 
KEY_VAL
 "0x%"
SCNx64
"", (&
mëad©a
)) != 1) {

1511 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög %s: %s.", 
MATCH_METADATA
, 
tokí
);

1513 
	`oÊ_°ru˘s_m©ch_put64
(
m
, 
OXM_OF_METADATA
, 
mëad©a
);

1517 i‡(
	`°∫cmp
(
tokí
, 
MATCH_PBB_ISID
 
KEY_VAL
, 
	`°æí
(MATCH_PBB_ISID KEY_VAL)) == 0) {

1518 
uöt32_t
 
pbb_isid
;

1519 i‡(
	`∑r£32
(
tokí
 + 
	`°æí
(
MATCH_PBB_ISID
 
KEY_VAL
), 
NULL
, 0, 0x1000000, &
pbb_isid
)) {

1520 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÖbb_isid: %s.", 
tokí
);

1522 
	`oÊ_°ru˘s_m©ch_put32
(
m
, 
OXM_OF_PBB_ISID
, 
pbb_isid
);

1526 i‡(
	`°∫cmp
(
tokí
, 
MATCH_TUNNEL_ID
 
KEY_VAL
, 
	`°æí
(MATCH_TUNNEL_ID KEY_VAL)) == 0) {

1527 
uöt64_t
 
tu¬_id
;

1528 i‡(
	`ssˇnf
(
tokí
, 
MATCH_TUNNEL_ID
 
KEY_VAL
 "0x%"
SCNx64
"", (&
tu¬_id
)) != 1) {

1529 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög %s: %s.", 
MATCH_TUNNEL_ID
, 
tokí
);

1531 
	`oÊ_°ru˘s_m©ch_put64
(
m
, 
OXM_OF_TUNNEL_ID
, 
tu¬_id
);

1535 i‡(
	`°∫cmp
(
tokí
, 
MATCH_EXT_HDR
 
KEY_VAL
, 
	`°æí
(MATCH_EXT_HDR KEY_VAL)) == 0) {

1536 
uöt16_t
 
ext_hdr
;

1537 i‡(
	`∑r£_ext_hdr
(
tokí
 + 
	`°æí
(
MATCH_EXT_HDR
 
KEY_VAL
), &
ext_hdr
)) {

1538 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÉxt_hd∏%s.", 
tokí
);

1540 
	`oÊ_°ru˘s_m©ch_put16
(
m
, 
OXM_OF_IPV6_EXTHDR
, 
ext_hdr
);

1543 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög m©chárg: %s.", 
tokí
);

1546 (*
m©ch
Ë(
oÊ_m©ch_hódî
 *)
m
;

1547 
	}
}

1550 
	$∑r£_£t_fõld
(*
tokí
, 
oÊ_a˘i⁄_£t_fõld
 *
a˘
) {

1553 i‡(
	`°∫cmp
(
tokí
, 
MATCH_DL_SRC
 
KEY_VAL2
, 
	`°æí
(MATCH_DL_SRC KEY_VAL2)) == 0) {

1554 
uöt8_t
* 
dl_§c
 = 
	`xmÆloc
(6);

1555 
uöt8_t
 *
mask
 = 
NULL
;

1556 i‡(
	`∑r£_dl_addr
(
tokí
 + 
	`°æí
(
MATCH_DL_SRC
 
KEY_VAL2
), 
dl_§c
, &
mask
)) {

1557 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög dl_§c: %s.", 
tokí
);

1559 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1560 
a˘
->
fõld
->
hódî
 = 
OXM_OF_ETH_SRC
;

1561 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
dl_§c
;

1565 i‡(
	`°∫cmp
(
tokí
, 
MATCH_DL_DST
 
KEY_VAL2
, 
	`°æí
(MATCH_DL_DST KEY_VAL2)) == 0) {

1566 
uöt8_t
* 
dl_d°
 = 
	`xmÆloc
(6);

1567 
uöt8_t
 *
mask
 = 
NULL
;

1568 i‡(
	`∑r£_dl_addr
(
tokí
 + 
	`°æí
(
MATCH_DL_DST
 
KEY_VAL2
), 
dl_d°
, &
mask
)) {

1569 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög dl_§c: %s.", 
tokí
);

1571 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1572 
a˘
->
fõld
->
hódî
 = 
OXM_OF_ETH_DST
;

1573 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
dl_d°
;

1577 i‡(
	`°∫cmp
(
tokí
, 
MATCH_DL_TYPE
 
KEY_VAL2
, 
	`°æí
(MATCH_DL_TYPE KEY_VAL2)) == 0) {

1578 
uöt16_t
* 
dl_ty≥
 = 
	`xmÆloc
((uint16_t));

1579 i‡(
	`∑r£16
(
tokí
 + 
	`°æí
(
MATCH_DL_TYPE
 
KEY_VAL2
), 
NULL
, 0, 0xffff, 
dl_ty≥
)) {

1580 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög dl_ty≥: %s.", 
tokí
);

1583 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1584 
a˘
->
fõld
->
hódî
 = 
OXM_OF_ETH_TYPE
;

1585 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
dl_ty≥
;

1591 i‡(
	`°∫cmp
(
tokí
, 
MATCH_ARP_SHA
 
KEY_VAL2
, 
	`°æí
(MATCH_ARP_SHA KEY_VAL2)) == 0) {

1592 
uöt8_t
 
¨p_sha
[6];

1593 
uöt8_t
 *
mask
;

1594 i‡(
	`∑r£_dl_addr
(
tokí
 + 
	`°æí
(
MATCH_ARP_SHA
 
KEY_VAL2
), 
¨p_sha
, &
mask
)) {

1595 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögáΩ_sha: %s.", 
tokí
);

1598 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1599 
a˘
->
fõld
->
hódî
 = 
OXM_OF_ARP_SHA
;

1600 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
¨p_sha
;

1604 i‡(
	`°∫cmp
(
tokí
, 
MATCH_ARP_THA
 
KEY_VAL2
, 
	`°æí
(MATCH_ARP_THA KEY_VAL2)) == 0) {

1605 
uöt8_t
 
¨p_tha
[6];

1606 
uöt8_t
 *
mask
;

1607 i‡(
	`∑r£_dl_addr
(
tokí
 + 
	`°æí
(
MATCH_ARP_THA
 
KEY_VAL2
), 
¨p_tha
, &
mask
)) {

1608 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögáΩ_th®%s.", 
tokí
);

1611 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1612 
a˘
->
fõld
->
hódî
 = 
OXM_OF_ARP_THA
;

1613 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
¨p_tha
;

1617 i‡(
	`°∫cmp
(
tokí
, 
MATCH_ARP_SPA
 
KEY_VAL2
, 
	`°æí
(MATCH_ARP_SPA KEY_VAL2)) == 0) {

1618 
uöt32_t
 *
¨p_§c
 = 
	`mÆloc
((uint32_t));

1619 
uöt32_t
 *
mask
;

1620 i‡(
	`∑r£_nw_addr
(
tokí
 + 
	`°æí
(
MATCH_ARP_SPA
 
KEY_VAL2
), 
¨p_§c
, &
mask
)) {

1621 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögáΩ_§c: %s.", 
tokí
);

1624 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1625 
a˘
->
fõld
->
hódî
 = 
OXM_OF_ARP_SPA
;

1626 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
¨p_§c
;

1630 i‡(
	`°∫cmp
(
tokí
, 
MATCH_ARP_TPA
 
KEY_VAL2
, 
	`°æí
(MATCH_ARP_TPA KEY_VAL2)) == 0) {

1631 
uöt32_t
 *
¨p_èrgë
 = 
	`mÆloc
((uint32_t));

1632 
uöt32_t
 *
mask
;

1633 i‡(
	`∑r£_nw_addr
(
tokí
 + 
	`°æí
(
MATCH_ARP_TPA
 
KEY_VAL2
), 
¨p_èrgë
, &
mask
)) {

1634 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögáΩ_èrgë: %s.", 
tokí
);

1637 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1638 
a˘
->
fõld
->
hódî
 = 
OXM_OF_ARP_TPA
;

1639 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
¨p_èrgë
;

1643 i‡(
	`°∫cmp
(
tokí
, 
MATCH_ARP_OP
 
KEY_VAL2
, 
	`°æí
(MATCH_ARP_OP KEY_VAL2)) == 0) {

1644 
uöt16_t
 *
¨p_›
 = 
	`xmÆloc
((uint16_t));

1645 i‡(
	`∑r£16
(
tokí
 + 
	`°æí
(
MATCH_ARP_OP
 
KEY_VAL2
), 
NULL
, 0, 0x7, 
¨p_›
)){

1646 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögáΩ_›: %s.", 
tokí
);

1649 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1650 
a˘
->
fõld
->
hódî
 = 
OXM_OF_ARP_OP
;

1651 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
¨p_›
;

1655 i‡(
	`°∫cmp
(
tokí
, 
MATCH_DL_VLAN
 
KEY_VAL2
, 
	`°æí
(MATCH_DL_VLAN KEY_VAL2)) == 0) {

1656 
uöt16_t
 *
dl_vœn
 = 
	`mÆloc
((uint16_t));

1657 i‡(
	`∑r£_vœn_vid
(
tokí
 + 
	`°æí
(
MATCH_DL_VLAN
 
KEY_VAL2
), 
dl_vœn
)) {

1658 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög vœ¿œbñ: %s.", 
tokí
);

1661 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1662 
a˘
->
fõld
->
hódî
 = 
OXM_OF_VLAN_VID
;

1663 *
dl_vœn
 = *dl_vœ¿| 
OFPVID_PRESENT
;

1664 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
dl_vœn
;

1668 i‡(
	`°∫cmp
(
tokí
, 
MATCH_DL_VLAN_PCP
 
KEY_VAL2
, 
	`°æí
(MATCH_DL_VLAN_PCP KEY_VAL2)) == 0) {

1669 
uöt8_t
 *
p˝
 = 
	`mÆloc
((uint8_t));

1670 i‡(
	`∑r£8
(
tokí
 + 
	`°æí
(
MATCH_DL_VLAN_PCP
 
KEY_VAL2
), 
NULL
, 0, 0x7, 
p˝
)) {

1671 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög vœ¿p˝: %s.", 
tokí
);

1673 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1674 
a˘
->
fõld
->
hódî
 = 
OXM_OF_VLAN_PCP
;

1675 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
p˝
;

1679 i‡(
	`°∫cmp
(
tokí
, 
MATCH_PBB_ISID
 
KEY_VAL2
, 
	`°æí
(MATCH_PBB_ISID KEY_VAL2)) == 0) {

1680 
uöt32_t
 *
pbb_isid
 = 
	`mÆloc
((uint32_t));

1681 i‡(
	`∑r£32
(
tokí
 + 
	`°æí
(
MATCH_PBB_ISID
 
KEY_VAL2
), 
NULL
, 0, 0x1000000, 
pbb_isid
)) {

1682 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÖbb sîvi˚ id: %s.", 
tokí
);

1685 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1686 
a˘
->
fõld
->
hódî
 = 
OXM_OF_PBB_ISID
;

1687 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
pbb_isid
;

1691 i‡(
	`°∫cmp
(
tokí
, 
MATCH_MPLS_LABEL
 
KEY_VAL2
, 
	`°æí
(MATCH_MPLS_LABEL KEY_VAL2)) == 0) {

1692 
uöt32_t
 *
m∂s_œbñ
 = 
	`mÆloc
((uint32_t));

1693 i‡(
	`∑r£32
(
tokí
 + 
	`°æí
(
MATCH_MPLS_LABEL
 
KEY_VAL2
), 
NULL
, 0, 0x1000000, 
m∂s_œbñ
)) {

1694 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög m∂†œbñ id: %s.", 
tokí
);

1697 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1698 
a˘
->
fõld
->
hódî
 = 
OXM_OF_MPLS_LABEL
;

1699 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
m∂s_œbñ
;

1703 i‡(
	`°∫cmp
(
tokí
, 
MATCH_MPLS_TC
 
KEY_VAL2
, 
	`°æí
(MATCH_MPLS_TC KEY_VAL2)) == 0) {

1704 
uöt8_t
 *
m∂s_tc
 = (uöt8_t*Ë
	`mÆloc
((uint8_t));

1705 i‡(
	`∑r£8
(
tokí
 + 
	`°æí
(
MATCH_MPLS_TC
 
KEY_VAL2
), 
NULL
, 0, 0x07, 
m∂s_tc
)) {

1706 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög m∂s_tc: %s.", 
tokí
);

1709 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1710 
a˘
->
fõld
->
hódî
 = 
OXM_OF_MPLS_TC
;

1711 
a˘
->
fõld
->
vÆue
 = 
m∂s_tc
;

1715 i‡(
	`°∫cmp
(
tokí
, 
MATCH_MPLS_BOS
 
KEY_VAL2
, 
	`°æí
(MATCH_MPLS_BOS KEY_VAL2)) == 0) {

1716 
uöt8_t
 *
m∂s_bos
 = (uöt8_t*Ë
	`mÆloc
((uint8_t));

1717 i‡(
	`∑r£8
(
tokí
 + 
	`°æí
(
MATCH_MPLS_BOS
 
KEY_VAL2
), 
NULL
, 0, 0x01, 
m∂s_bos
)) {

1718 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög m∂s_bos: %s.", 
tokí
);

1721 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1722 
a˘
->
fõld
->
hódî
 = 
OXM_OF_MPLS_BOS
;

1723 
a˘
->
fõld
->
vÆue
 = 
m∂s_bos
;

1727 i‡(
	`°∫cmp
(
tokí
, 
MATCH_DL_VLAN_PCP
 
KEY_VAL2
, 
	`°æí
(MATCH_DL_VLAN_PCP KEY_VAL2)) == 0) {

1728 
uöt8_t
* 
vœn_p˝
 = 
	`mÆloc
((uint8_t));

1729 i‡(
	`∑r£8
(
tokí
 + 
	`°æí
(
MATCH_DL_VLAN_PCP
 
KEY_VAL2
), 
NULL
, 0, 0x7, 
vœn_p˝
)) {

1730 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög vœ¿p˝: %s.", 
tokí
);

1733 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1734 
a˘
->
fõld
->
hódî
 = 
OXM_OF_VLAN_PCP
;

1735 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
vœn_p˝
;

1739 i‡(
	`°∫cmp
(
tokí
, 
MATCH_NW_SRC
 
KEY_VAL2
, 
	`°æí
(MATCH_NW_SRC KEY_VAL2)) == 0) {

1740 
uöt32_t
* 
nw_§c
 = 
	`mÆloc
((uint32_t));

1741 
uöt32_t
 *
mask
;

1743 i‡(
	`∑r£_nw_addr
(
tokí
 + 
	`°æí
(
MATCH_NW_SRC
 
KEY_VAL2
), 
nw_§c
, &
mask
)) {

1744 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög ip_§c: %s.", 
tokí
);

1747 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1748 
a˘
->
fõld
->
hódî
 = 
OXM_OF_IPV4_SRC
;

1749 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
nw_§c
;

1753 i‡(
	`°∫cmp
(
tokí
, 
MATCH_NW_DST
 
KEY_VAL2
, 
	`°æí
(MATCH_NW_DST KEY_VAL2)) == 0) {

1754 
uöt32_t
 * 
nw_d°
 = 
	`mÆloc
((uint32_t));

1755 
uöt32_t
 *
mask
;

1757 i‡(
	`∑r£_nw_addr
(
tokí
 + 
	`°æí
(
MATCH_NW_DST
 
KEY_VAL2
), 
nw_d°
, &
mask
)) {

1758 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög ip_d°: %s.", 
tokí
);

1761 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1762 
a˘
->
fõld
->
hódî
 = 
OXM_OF_IPV4_DST
;

1763 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
nw_d°
;

1767 i‡(
	`°∫cmp
(
tokí
, 
MATCH_IP_ECN
 
KEY_VAL2
, 
	`°æí
(
MATCH_NW_DST
 KEY_VAL2)) == 0) {

1768 
uöt8_t
 *
ù_e˙
 = 
	`mÆloc
((uint8_t));

1769 i‡(
	`∑r£8
(
tokí
 + 
	`°æí
(
MATCH_IP_ECN
 
KEY_VAL2
), 
NULL
, 0, 0x3, 
ù_e˙
)) {

1770 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÇw_tos: %s.", 
tokí
);

1773 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1774 
a˘
->
fõld
->
hódî
 = 
OXM_OF_IP_ECN
;

1775 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
ù_e˙
;

1779 i‡(
	`°∫cmp
(
tokí
, 
MATCH_IP_DSCP
 
KEY_VAL2
, 
	`°æí
(
MATCH_NW_DST
 KEY_VAL2)) == 0) {

1780 
uöt8_t
 * 
ds˝
 = 
	`mÆloc
((uint8_t));

1782 i‡(
	`∑r£8
(
tokí
 + 
	`°æí
(
MATCH_IP_DSCP
 
KEY_VAL2
), 
NULL
, 0, 0x40, 
ds˝
)) {

1783 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÇw_tos: %s.", 
tokí
);

1786 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1787 
a˘
->
fõld
->
hódî
 = 
OXM_OF_IP_DSCP
;

1788 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
ds˝
;

1792 i‡(
	`°∫cmp
(
tokí
, 
MATCH_NW_PROTO
 
KEY_VAL2
, 
	`°æí
(MATCH_NW_PROTO KEY_VAL2)) == 0) {

1793 
uöt8_t
 *
nw_¥Ÿo
 = 
	`mÆloc
((uint8_t));

1794 i‡(
	`∑r£8
(
tokí
 + 
	`°æí
(
MATCH_NW_PROTO
 
KEY_VAL2
), 
NULL
, 0, 0xff, 
nw_¥Ÿo
)) {

1795 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög ip_¥Ÿo: %s.", 
tokí
);

1798 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1799 
a˘
->
fõld
->
hódî
 = 
OXM_OF_IP_PROTO
;

1800 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
nw_¥Ÿo
;

1804 i‡(
	`°∫cmp
(
tokí
, 
MATCH_TP_SRC
 
KEY_VAL2
, 
	`°æí
(MATCH_TP_SRC KEY_VAL2)) == 0) {

1805 
uöt16_t
* 
ç_§c
 = 
	`xmÆloc
(2);

1806 i‡(
	`∑r£16
(
tokí
+ 
	`°æí
(
MATCH_TP_SRC
 
KEY_VAL2
), 
NULL
, 0, 0xffff, 
ç_§c
)) {

1807 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÅ˝_§c: %s.", 
tokí
);

1809 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1810 
a˘
->
fõld
->
hódî
 = 
OXM_OF_TCP_SRC
;

1811 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
ç_§c
;

1815 i‡(
	`°∫cmp
(
tokí
, 
MATCH_TP_DST
 
KEY_VAL2
, 
	`°æí
(MATCH_TP_DST KEY_VAL2)) == 0) {

1816 
uöt16_t
* 
ç_d°
 = 
	`xmÆloc
(2);

1817 i‡(
	`∑r£16
(
tokí
 + 
	`°æí
(
MATCH_TP_SRC
 
KEY_VAL2
), 
NULL
, 0, 0xffff, 
ç_d°
)) {

1818 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÅ˝_§c: %s.", 
tokí
);

1820 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1821 
a˘
->
fõld
->
hódî
 = 
OXM_OF_TCP_DST
;

1822 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
ç_d°
;

1826 i‡(
	`°∫cmp
(
tokí
, 
MATCH_NW_SRC_IPV6
 
KEY_VAL2
 , 
	`°æí
(MATCH_NW_SRC_IPV6 KEY_VAL2)) == 0) {

1827 
ö6_addr
 *
addr
 = (ö6_addr*Ë
	`mÆloc
((in6_addr));

1828 
ö6_addr
 
mask
;

1829 i‡(
	`°r_to_ùv6
(
tokí
 + 
	`°æí
(
MATCH_NW_SRC_IPV6
)+1, 
addr
, &
mask
) < 0) {

1830 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÇw_§c_ùv6: %s.", 
tokí
);

1833 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1834 
a˘
->
fõld
->
hódî
 = 
OXM_OF_IPV6_SRC
;

1835 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
addr
->
s6_addr
;

1839 i‡(
	`°∫cmp
(
tokí
, 
MATCH_NW_DST_IPV6
 
KEY_VAL2
 , 
	`°æí
(MATCH_NW_DST_IPV6 KEY_VAL2)) == 0) {

1840 
ö6_addr
 *
addr
 = (ö6_addr*Ë
	`mÆloc
((in6_addr));

1841 
ö6_addr
 
mask
;

1842 i‡(
	`°r_to_ùv6
(
tokí
 + 
	`°æí
(
MATCH_NW_DST_IPV6
)+1, 
addr
, &
mask
) < 0) {

1843 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÇw_§c_ùv6: %s.", 
tokí
);

1846 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1847 
a˘
->
fõld
->
hódî
 = 
OXM_OF_IPV6_DST
;

1848 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
addr
->
s6_addr
;

1852 i‡(
	`°∫cmp
(
tokí
, 
MATCH_IPV6_FLABEL
 
KEY_VAL2
, 
	`°æí
(MATCH_IPV6_FLABEL KEY_VAL2)) == 0) {

1853 
uöt32_t
 *
ùv6_œbñ
 = 
	`mÆloc
((uint32_t));

1854 i‡(
	`∑r£32
(
tokí
 + 
	`°æí
(
MATCH_IPV6_FLABEL
 
KEY_VAL2
), 
NULL
, 0, 0x000fffff, 
ùv6_œbñ
)) {

1855 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög ipv6_œbñ: %s.", 
tokí
);

1858 
a˘
->
fõld
 = (
oÊ_m©ch_év
*Ë
	`mÆloc
((ofl_match_tlv));

1859 
a˘
->
fõld
->
hódî
 = 
OXM_OF_IPV6_FLABEL
;

1860 
a˘
->
fõld
->
vÆue
 = (
uöt8_t
*Ë
ùv6_œbñ
;

1864 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög së_fõldárg: %s.", 
tokí
);

1865 
	}
}

1868 
	$make_Æl_m©ch
(
oÊ_m©ch_hódî
 **
m©ch
) {

1869 
oÊ_m©ch
 *
m
 = 
	`xmÆloc
((ofl_match));

1871 
	`oÊ_°ru˘s_m©ch_öô
(
m
);

1873 (*
m©ch
Ë(
oÊ_m©ch_hódî
 *)
m
;

1874 
	}
}

1878 
	$∑r£_a˘i⁄
(
uöt16_t
 
ty≥
, *
°r
, 
oÊ_a˘i⁄_hódî
 **
a˘
) {

1879 
ty≥
) {

1880 (
OFPAT_OUTPUT
): {

1881 *
tokí
, *
ßvïå
 = 
NULL
;

1882 
oÊ_a˘i⁄_ouçut
 *
a
 = 
	`xmÆloc
((ofl_action_output));

1884 
tokí
 = 
	`°πok_r
(
°r
, 
KEY_VAL2
, &
ßvïå
);

1885 i‡(
	`∑r£_p‹t
(
tokí
, &(
a
->
p‹t
))) {

1886 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÖ‹àö ouçuàa˘i⁄: %s.", 
°r
);

1888 
tokí
 = 
	`°πok_r
(
NULL
, 
KEY_VAL2
, &
ßvïå
);

1889 i‡(
tokí
 =
NULL
) {

1890 
a
->
max_Àn
 = 0;

1892 i‡(
	`∑r£16
(
tokí
, 
NULL
, 0, 0xfff‡- (
oÂ_hódî
), &(
a
->
max_Àn
))) {

1893 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög max_À¿ö ouçuàa˘i⁄: %s.", 
°r
);

1896 (*
a˘
Ë(
oÊ_a˘i⁄_hódî
 *)
a
;

1899 (
OFPAT_SET_FIELD
):{

1900 
oÊ_a˘i⁄_£t_fõld
 *
a
 = 
	`xmÆloc
( (ofl_action_set_field));

1901 i‡(
	`∑r£_£t_fõld
(
°r
, 
a
)) {

1902 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög fõld i¿£t_fõldá˘i⁄: %s.", 
°r
);

1904 (*
a˘
Ë(
oÊ_a˘i⁄_hódî
 *)
a
;

1907 (
OFPAT_COPY_TTL_OUT
):

1908 (
OFPAT_COPY_TTL_IN
): {

1909 
oÊ_a˘i⁄_hódî
 *
a
 = 
	`xmÆloc
((ofl_action_header));

1910 (*
a˘
Ë
a
;

1913 (
OFPAT_SET_MPLS_TTL
): {

1914 
oÊ_a˘i⁄_m∂s_âl
 *
a
 = 
	`xmÆloc
((ofl_action_mpls_ttl));

1915 i‡(
	`∑r£8
(
°r
, 
NULL
, 0, 255, &(
a
->
m∂s_âl
))) {

1916 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÅé i¿m∂s_â»a˘i⁄: %s.", 
°r
);

1918 (*
a˘
Ë(
oÊ_a˘i⁄_hódî
 *)
a
;

1921 (
OFPAT_DEC_MPLS_TTL
): {

1922 
oÊ_a˘i⁄_hódî
 *
a
 = 
	`xmÆloc
((ofl_action_header));

1923 (*
a˘
Ë
a
;

1926 (
OFPAT_PUSH_VLAN
):

1927 (
OFPAT_PUSH_PBB
):

1928 (
OFPAT_PUSH_MPLS
): {

1929 
oÊ_a˘i⁄_push
 *
a
 = 
	`xmÆloc
((ofl_action_push));

1930 i‡(
	`ssˇnf
(
°r
, "0x%"
SCNx16
"", &(
a
->
ëhîty≥
)) != 1) {

1931 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÉthîty≥ i¿push_m∂s/vœn/pbbá˘i⁄: %s.", 
°r
);

1933 (*
a˘
Ë(
oÊ_a˘i⁄_hódî
 *)
a
;

1936 (
OFPAT_POP_VLAN
):

1937 (
OFPAT_POP_PBB
): {

1938 
oÊ_a˘i⁄_hódî
 *
a
 = 
	`xmÆloc
((ofl_action_header));

1939 (*
a˘
Ë
a
;

1942 (
OFPAT_POP_MPLS
): {

1943 
oÊ_a˘i⁄_p›_m∂s
 *
a
 = 
	`xmÆloc
((ofl_action_pop_mpls));

1944 i‡(
	`ssˇnf
(
°r
, "0x%"
SCNx16
"", &(
a
->
ëhîty≥
)) != 1) {

1945 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÉthîty≥ i¿p›_m∂†a˘i⁄: %s.", 
°r
);

1947 (*
a˘
Ë(
oÊ_a˘i⁄_hódî
 *)
a
;

1950 (
OFPAT_SET_QUEUE
): {

1951 
oÊ_a˘i⁄_£t_queue
 *
a
 = 
	`xmÆloc
((ofl_action_set_queue));

1952 i‡(
	`∑r£32
(
°r
, 
NULL
, 0, 0xffffffff, &(
a
->
queue_id
))) {

1953 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög queuêö queuêa˘i⁄: %s.", 
°r
);

1955 (*
a˘
Ë(
oÊ_a˘i⁄_hódî
 *)
a
;

1958 (
OFPAT_GROUP
): {

1959 
oÊ_a˘i⁄_group
 *
a
 = 
	`xmÆloc
((ofl_action_group));

1960 i‡(
	`∑r£_group
(
°r
, &(
a
->
group_id
))) {

1961 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög grou∞ö grou∞a˘i⁄: %s.", 
°r
);

1963 (*
a˘
Ë(
oÊ_a˘i⁄_hódî
 *)
a
;

1966 (
OFPAT_SET_NW_TTL
): {

1967 
oÊ_a˘i⁄_£t_nw_âl
 *
a
 = 
	`xmÆloc
((ofl_action_set_nw_ttl));

1968 i‡(
	`∑r£8
(
°r
, 
NULL
, 0, 255, &(
a
->
nw_âl
))) {

1969 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÅé i¿m∂s_â»a˘i⁄: %s.", 
°r
);

1971 (*
a˘
Ë(
oÊ_a˘i⁄_hódî
 *)
a
;

1974 (
OFPAT_DEC_NW_TTL
): {

1975 
oÊ_a˘i⁄_hódî
 *
a
 = 
	`xmÆloc
((ofl_action_header));

1976 (*
a˘
Ë
a
;

1980 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögá˘i⁄: %s.", 
°r
);

1983 (*
a˘
)->
ty≥
 =Åype;

1984 
	}
}

1987 
	$∑r£_a˘i⁄s
(*
°r
, 
size_t
 *
a˘s_num
, 
oÊ_a˘i⁄_hódî
 ***
a˘s
) {

1988 *
tokí
, *
ßvïå
 = 
NULL
;

1989 *
s
;

1990 
size_t
 
i
;

1991 
boﬁ
 
found
;

1992 
oÊ_a˘i⁄_hódî
 *
a˘
 = 
NULL
;

1994 
tokí
 = 
	`°πok_r
(
°r
, 
KEY_SEP
, &
ßvïå
);Åokí !
NULL
;Åoken = strtok_r(NULL, KEY_SEP, &saveptr)) {

1995 
found
 = 
Ál£
;

1997 
i
=0; i<
	`NUM_ELEMS
(
a˘i⁄_«mes
); i++) {

1998 i‡(
	`°∫cmp
(
tokí
, 
a˘i⁄_«mes
[
i
].
«me
, 
	`°æí
(action_names[i].name)) == 0) {

1999 
s
 = 
tokí
 + 
	`°æí
(
a˘i⁄_«mes
[
i
].
«me
);

2001 i‡(
	`°∫cmp
(
s
, 
KEY_VAL
, 
	`°æí
(KEY_VAL)) == 0) {

2002 
s
+
	`°æí
(
KEY_VAL
);

2004 
	`∑r£_a˘i⁄
(
a˘i⁄_«mes
[
i
].
code
, 
s
, &
a˘
);

2005 (*
a˘s_num
)++;

2006 (*
a˘s
Ë
	`xªÆloc
((*a˘s), (
oÊ_a˘i⁄_hódî
 *Ë* (*
a˘s_num
));

2007 (*
a˘s
)[(*
a˘s_num
)-1] = 
a˘
;

2008 
found
 = 
åue
;

2012 i‡(!
found
) {

2013 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögá˘i⁄: %s.", 
tokí
);

2017 
	}
}

2022 
	$∑r£_ö°
(*
°r
, 
oÊ_ö°ru˘i⁄_hódî
 **
ö°
) {

2023 
size_t
 
i
;

2024 *
s
;

2025 
i
=0; i<
	`NUM_ELEMS
(
ö°_«mes
); i++) {

2026 i‡(
	`°∫cmp
(
°r
, 
ö°_«mes
[
i
].
«me
, 
	`°æí
(inst_names[i].name)) == 0) {

2028 
s
 = 
°r
 + 
	`°æí
(
ö°_«mes
[
i
].
«me
);

2029 i‡(
	`°∫cmp
(
s
, 
KEY_VAL2
, 
	`°æí
(KEY_VAL2)) != 0) {

2030 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög in°ru˘i⁄: %s.", 
°r
);

2032 
s
+
	`°æí
(
KEY_VAL2
);

2033 
ö°_«mes
[
i
].
code
) {

2034 (
OFPIT_GOTO_TABLE
): {

2035 
oÊ_ö°ru˘i⁄_gŸo_èbÀ
 *
i
 = 
	`xmÆloc
((ofl_instruction_goto_table));

2036 
i
->
hódî
.
ty≥
 = 
OFPIT_GOTO_TABLE
;

2037 i‡(
	`∑r£_èbÀ
(
s
, &(
i
->
èbÀ_id
))) {

2038 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÅabÀ i¿gŸÿö°ru˘i⁄: %s.", 
s
);

2040 (*
ö°
Ë(
oÊ_ö°ru˘i⁄_hódî
 *)
i
;

2043 (
OFPIT_WRITE_METADATA
): {

2044 *
tokí
, *
ßvïå
 = 
NULL
;

2045 
oÊ_ö°ru˘i⁄_wrôe_mëad©a
 *
i
 = 
	`xmÆloc
((ofl_instruction_write_metadata));

2046 
i
->
hódî
.
ty≥
 = 
OFPIT_WRITE_METADATA
;

2047 
tokí
 = 
	`°πok_r
(
s
, 
KEY_SEP
, &
ßvïå
);

2048 i‡(
	`ssˇnf
(
tokí
, "0x%"
SCNx64
"", &(
i
->
mëad©a
)) != 1) {

2049 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög mëad©®ö wrôêmëad©®ö°ru˘i⁄: %s.", 
s
);

2051 
tokí
 = 
	`°πok_r
(
NULL
, 
KEY_SEP
, &
ßvïå
);

2052 i‡(
tokí
 =
NULL
) {

2053 
i
->
mëad©a_mask
 = 0xffffffffffffffffULL;

2055 i‡(
	`ssˇnf
(
tokí
, "0x%"
SCNx64
"", &(
i
->
mëad©a_mask
)) != 1) {

2056 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög mëad©a_mask i¿wrôêmëad©®ö°ru˘i⁄: %s.", 
s
);

2059 (*
ö°
Ë(
oÊ_ö°ru˘i⁄_hódî
 *)
i
;

2062 (
OFPIT_WRITE_ACTIONS
): {

2063 
oÊ_ö°ru˘i⁄_a˘i⁄s
 *
i
 = 
	`xmÆloc
((ofl_instruction_actions));

2064 
i
->
hódî
.
ty≥
 = 
OFPIT_WRITE_ACTIONS
;

2065 
i
->
a˘i⁄s
 = 
NULL
;

2066 
i
->
a˘i⁄s_num
 = 0;

2067 
	`∑r£_a˘i⁄s
(
s
, &(
i
->
a˘i⁄s_num
), &(i->
a˘i⁄s
));

2068 (*
ö°
Ë(
oÊ_ö°ru˘i⁄_hódî
 *)
i
;

2071 (
OFPIT_APPLY_ACTIONS
): {

2072 
oÊ_ö°ru˘i⁄_a˘i⁄s
 *
i
 = 
	`xmÆloc
((ofl_instruction_actions));

2073 
i
->
hódî
.
ty≥
 = 
OFPIT_APPLY_ACTIONS
;

2074 
i
->
a˘i⁄s
 = 
NULL
;

2075 
i
->
a˘i⁄s_num
 = 0;

2076 
	`∑r£_a˘i⁄s
(
s
, &(
i
->
a˘i⁄s_num
), &(i->
a˘i⁄s
));

2077 (*
ö°
Ë(
oÊ_ö°ru˘i⁄_hódî
 *)
i
;

2080 (
OFPIT_METER
): {

2081 
oÊ_ö°ru˘i⁄_mëî
 *
i
 = 
	`xmÆloc
((ofl_instruction_meter));

2082 
i
->
hódî
.
ty≥
 = 
OFPIT_METER
;

2083 if(
	`∑r£32
(
s
, 
NULL
, 0, 
OFPM_MAX
 ,&
i
->
mëî_id
)){

2084 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög mëî in°ru˘i⁄: %s.", 
s
);

2086 (*
ö°
Ë(
oÊ_ö°ru˘i⁄_hódî
 *)
i
;

2089 (
OFPIT_CLEAR_ACTIONS
): {

2090 
oÊ_ö°ru˘i⁄_hódî
 *
i
 = 
	`xmÆloc
((ofl_instruction_header));

2091 
i
->
ty≥
 = 
OFPIT_CLEAR_ACTIONS
;

2092 (*
ö°
Ë(
oÊ_ö°ru˘i⁄_hódî
 *)
i
;

2098 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög in°ru˘i⁄: %s.", 
°r
);

2099 
	}
}

2103 
	$∑r£_Êow_°©_¨gs
(*
°r
, 
oÊ_msg_mu…ù¨t_ªque°_Êow
 *
ªq
) {

2104 *
tokí
, *
ßvïå
 = 
NULL
;

2106 
tokí
 = 
	`°πok_r
(
°r
, 
KEY_SEP
, &
ßvïå
);Åokí !
NULL
;Åoken = strtok_r(NULL, KEY_SEP, &saveptr)) {

2107 i‡(
	`°∫cmp
(
tokí
, 
FLOW_MOD_COOKIE
 
KEY_VAL
, 
	`°æí
(FLOW_MOD_COOKIE KEY_VAL)) == 0) {

2108 i‡(
	`ssˇnf
(
tokí
, 
FLOW_MOD_COOKIE
 
KEY_VAL
 "0x%"
SCNx64
"", &(
ªq
->
cookõ
)) != 1) {

2109 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög flow_°© cookõ: %s.", 
tokí
);

2113 i‡(
	`°∫cmp
(
tokí
, 
FLOW_MOD_COOKIE_MASK
 
KEY_VAL
, 
	`°æí
(FLOW_MOD_COOKIE_MASK KEY_VAL)) == 0) {

2114 i‡(
	`ssˇnf
(
tokí
, 
FLOW_MOD_COOKIE
 
KEY_VAL
 "0x%"
SCNx64
"", &(
ªq
->
cookõ
)) != 1) {

2115 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög flow_°© cookõ mask: %s.", 
tokí
);

2119 i‡(
	`°∫cmp
(
tokí
, 
FLOW_MOD_TABLE_ID
 
KEY_VAL
, 
	`°æí
(FLOW_MOD_TABLE_ID KEY_VAL)) == 0) {

2120 i‡(
	`∑r£8
(
tokí
 + 
	`°æí
(
FLOW_MOD_TABLE_ID
 
KEY_VAL
), 
èbÀ_«mes
, 
	`NUM_ELEMS
—abÀ_«mes), 254, &
ªq
->
èbÀ_id
)) {

2121 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög flow_°©ÅabÀ: %s.", 
tokí
);

2125 i‡(
	`°∫cmp
(
tokí
, 
FLOW_MOD_OUT_PORT
 
KEY_VAL
, 
	`°æí
(FLOW_MOD_OUT_PORT KEY_VAL)) == 0) {

2126 i‡(
	`∑r£_p‹t
(
tokí
 + 
	`°æí
(
FLOW_MOD_OUT_PORT
 
KEY_VAL
), &
ªq
->
out_p‹t
)) {

2127 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög flow_°©Ö‹t: %s.", 
tokí
);

2131 i‡(
	`°∫cmp
(
tokí
, 
FLOW_MOD_OUT_GROUP
 
KEY_VAL
, 
	`°æí
(FLOW_MOD_OUT_GROUP KEY_VAL)) == 0) {

2132 i‡(
	`∑r£_group
(
tokí
 + 
	`°æí
(
FLOW_MOD_OUT_GROUP
 
KEY_VAL
), &
ªq
->
out_p‹t
)) {

2133 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög flow_°© group: %s.", 
tokí
);

2137 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög flow_°©árg: %s.", 
tokí
);

2139 
	}
}

2144 
	$∑r£_Êow_mod_¨gs
(*
°r
, 
oÊ_msg_Êow_mod
 *
ªq
) {

2145 *
tokí
, *
ßvïå
 = 
NULL
;

2147 
tokí
 = 
	`°πok_r
(
°r
, 
KEY_SEP
, &
ßvïå
);Åokí !
NULL
;Åoken = strtok_r(NULL, KEY_SEP, &saveptr)) {

2148 i‡(
	`°∫cmp
(
tokí
, 
FLOW_MOD_COMMAND
 
KEY_VAL
, 
	`°æí
(FLOW_MOD_COMMAND KEY_VAL)) == 0) {

2149 
uöt8_t
 
comm™d
;

2150 i‡(
	`∑r£8
(
tokí
 + 
	`°æí
(
FLOW_MOD_COMMAND
 
KEY_VAL
), 
Êow_mod_cmd_«mes
, 
	`NUM_ELEMS
(Êow_mod_cmd_«mes),0, &
comm™d
)) {

2151 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög flow_mod comm™d: %s.", 
tokí
);

2153 
ªq
->
comm™d
 = command;

2156 i‡(
	`°∫cmp
(
tokí
, 
FLOW_MOD_COOKIE
 
KEY_VAL
, 
	`°æí
(FLOW_MOD_COOKIE KEY_VAL)) == 0) {

2157 i‡(
	`ssˇnf
(
tokí
, 
FLOW_MOD_COOKIE
 
KEY_VAL
 "0x%"
SCNx64
"", &(
ªq
->
cookõ
)) != 1) {

2158 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög flow_mod cookõ: %s.", 
tokí
);

2162 i‡(
	`°∫cmp
(
tokí
, 
FLOW_MOD_COOKIE_MASK
 
KEY_VAL
, 
	`°æí
(FLOW_MOD_COOKIE_MASK KEY_VAL)) == 0) {

2163 i‡(
	`ssˇnf
(
tokí
, 
FLOW_MOD_COOKIE
 
KEY_VAL
 "0x%"
SCNx64
"", &(
ªq
->
cookõ
)) != 1) {

2164 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög flow_mod cookõ mask: %s.", 
tokí
);

2168 i‡(
	`°∫cmp
(
tokí
, 
FLOW_MOD_TABLE_ID
 
KEY_VAL
, 
	`°æí
(FLOW_MOD_TABLE_ID KEY_VAL)) == 0) {

2169 i‡(
	`∑r£8
(
tokí
 + 
	`°æí
(
FLOW_MOD_TABLE_ID
 
KEY_VAL
), 
èbÀ_«mes
, 
	`NUM_ELEMS
—abÀ_«mes), 254, &
ªq
->
èbÀ_id
)) {

2170 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög flow_modÅabÀ: %s.", 
tokí
);

2174 i‡(
	`°∫cmp
(
tokí
, 
FLOW_MOD_IDLE
 
KEY_VAL
, 
	`°æí
(FLOW_MOD_IDLE KEY_VAL)) == 0) {

2175 i‡(
	`ssˇnf
(
tokí
, 
FLOW_MOD_IDLE
 
KEY_VAL
 "%"
SCNu16
"", &(
ªq
->
idÀ_timeout
)) != 1) {

2176 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög %s: %s.", 
FLOW_MOD_IDLE
, 
tokí
);

2180 i‡(
	`°∫cmp
(
tokí
, 
FLOW_MOD_HARD
 
KEY_VAL
, 
	`°æí
(FLOW_MOD_HARD KEY_VAL)) == 0) {

2181 i‡(
	`ssˇnf
(
tokí
, 
FLOW_MOD_HARD
 
KEY_VAL
 "%"
SCNu16
"", &(
ªq
->
h¨d_timeout
)) != 1) {

2182 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög %s: %s.", 
FLOW_MOD_HARD
, 
tokí
);

2186 i‡(
	`°∫cmp
(
tokí
, 
FLOW_MOD_PRIO
 
KEY_VAL
, 
	`°æí
(FLOW_MOD_PRIO KEY_VAL)) == 0) {

2187 i‡(
	`ssˇnf
(
tokí
, 
FLOW_MOD_PRIO
 
KEY_VAL
 "%"
SCNu16
"", &(
ªq
->
¥i‹ôy
)) != 1) {

2188 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög %s: %s.", 
FLOW_MOD_PRIO
, 
tokí
);

2192 i‡(
	`°∫cmp
(
tokí
, 
FLOW_MOD_BUFFER
 
KEY_VAL
, 
	`°æí
(FLOW_MOD_BUFFER KEY_VAL)) == 0) {

2193 i‡(
	`∑r£32
(
tokí
 + 
	`°æí
(
FLOW_MOD_BUFFER
 
KEY_VAL
), 
buf„r_«mes
, 
	`NUM_ELEMS
(buf„r_«mes), 
UINT32_MAX
, &
ªq
->
buf„r_id
)) {

2194 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög flow_mod buf„r: %s.", 
tokí
);

2198 i‡(
	`°∫cmp
(
tokí
, 
FLOW_MOD_OUT_PORT
 
KEY_VAL
, 
	`°æí
(FLOW_MOD_OUT_PORT KEY_VAL)) == 0) {

2199 i‡(
	`∑r£_p‹t
(
tokí
 + 
	`°æí
(
FLOW_MOD_OUT_PORT
 
KEY_VAL
), &
ªq
->
out_p‹t
)) {

2200 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög flow_modÖ‹t: %s.", 
tokí
);

2204 i‡(
	`°∫cmp
(
tokí
, 
FLOW_MOD_OUT_GROUP
 
KEY_VAL
, 
	`°æí
(FLOW_MOD_OUT_GROUP KEY_VAL)) == 0) {

2205 i‡(
	`∑r£_group
(
tokí
 + 
	`°æí
(
FLOW_MOD_OUT_GROUP
 
KEY_VAL
), &
ªq
->
out_p‹t
)) {

2206 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög flow_mod group: %s.", 
tokí
);

2210 i‡(
	`°∫cmp
(
tokí
, 
FLOW_MOD_FLAGS
 
KEY_VAL
, 
	`°æí
(FLOW_MOD_FLAGS KEY_VAL)) == 0) {

2211 i‡(
	`ssˇnf
(
tokí
, 
FLOW_MOD_FLAGS
 
KEY_VAL
 "0x%"
SCNx16
"", &(
ªq
->
Êags
)) != 1) {

2212 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög %s: %s.", 
FLOW_MOD_FLAGS
, 
tokí
);

2216 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög flow_modárg: %s.", 
tokí
);

2218 
	}
}

2221 
	$∑r£_group_mod_¨gs
(*
°r
, 
oÊ_msg_group_mod
 *
ªq
) {

2222 *
tokí
, *
ßvïå
 = 
NULL
;

2224 
tokí
 = 
	`°πok_r
(
°r
, 
KEY_SEP
, &
ßvïå
);Åokí !
NULL
;Åoken = strtok_r(NULL, KEY_SEP, &saveptr)) {

2225 i‡(
	`°∫cmp
(
tokí
, 
GROUP_MOD_COMMAND
 
KEY_VAL
, 
	`°æí
(GROUP_MOD_COMMAND KEY_VAL)) == 0) {

2226 
uöt16_t
 
comm™d
;

2227 i‡(
	`∑r£16
(
tokí
 + 
	`°æí
(
GROUP_MOD_COMMAND
 
KEY_VAL
), 
group_mod_cmd_«mes
, 
	`NUM_ELEMS
(group_mod_cmd_«mes),0, &
comm™d
)) {

2228 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög group_mod comm™d: %s.", 
tokí
);

2230 
ªq
->
comm™d
 = command;

2233 i‡(
	`°∫cmp
(
tokí
, 
GROUP_MOD_GROUP
 
KEY_VAL
, 
	`°æí
(GROUP_MOD_GROUP KEY_VAL)) == 0) {

2234 i‡(
	`∑r£_group
(
tokí
 + 
	`°æí
(
GROUP_MOD_GROUP
 
KEY_VAL
), &
ªq
->
group_id
)) {

2235 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög group_mod group: %s.", 
tokí
);

2239 i‡(
	`°∫cmp
(
tokí
, 
GROUP_MOD_TYPE
 
KEY_VAL
, 
	`°æí
(GROUP_MOD_TYPE KEY_VAL)) == 0) {

2240 
uöt8_t
 
ty≥
;

2241 i‡(
	`∑r£8
(
tokí
 + 
	`°æí
(
GROUP_MOD_TYPE
 
KEY_VAL
), 
group_ty≥_«mes
, 
	`NUM_ELEMS
(group_ty≥_«mes), 
UINT8_MAX
, &
ty≥
)) {

2242 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög group_modÅy≥: %s.", 
tokí
);

2244 
ªq
->
ty≥
 =Åype;

2247 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög group_modárg: %s.", 
tokí
);

2249 
	}
}

2252 
	$∑r£_buckë
(*
°r
, 
oÊ_buckë
 *
b
) {

2253 *
tokí
, *
ßvïå
 = 
NULL
;

2255 
tokí
 = 
	`°πok_r
(
°r
, 
KEY_SEP
, &
ßvïå
);Åokí !
NULL
;Åoken = strtok_r(NULL, KEY_SEP, &saveptr)) {

2256 i‡(
	`°∫cmp
(
tokí
, 
BUCKET_WEIGHT
 
KEY_VAL
, 
	`°æí
(BUCKET_WEIGHT KEY_VAL)) == 0) {

2257 i‡(
	`∑r£16
(
tokí
 + 
	`°æí
(
BUCKET_WEIGHT
 
KEY_VAL
), 
NULL
, 0, 
UINT16_MAX
, &
b
->
weight
)) {

2258 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög buckë_weight: %s.", 
tokí
);

2262 i‡(
	`°∫cmp
(
tokí
, 
BUCKET_WATCH_PORT
 
KEY_VAL
, 
	`°æí
(BUCKET_WATCH_PORT KEY_VAL)) == 0) {

2263 i‡(
	`∑r£_p‹t
(
tokí
 + 
	`°æí
(
BUCKET_WATCH_PORT
 
KEY_VAL
), &
b
->
w©ch_p‹t
)) {

2264 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög buckë w©chÖ‹t: %s.", 
tokí
);

2268 i‡(
	`°∫cmp
(
tokí
, 
BUCKET_WATCH_GROUP
 
KEY_VAL
, 
	`°æí
(BUCKET_WATCH_GROUP KEY_VAL)) == 0) {

2269 i‡(
	`∑r£_group
(
tokí
 + 
	`°æí
(
BUCKET_WATCH_GROUP
 
KEY_VAL
), &
b
->
w©ch_group
)) {

2270 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög buckë w©ch group: %s.", 
tokí
);

2274 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög buckëárg: %s.", 
tokí
);

2276 
	}
}

2279 
	$∑r£_mëî_mod_¨gs
(*
°r
, 
oÊ_msg_mëî_mod
 *
ªq
){

2280 *
tokí
, *
ßvïå
 = 
NULL
;

2282 
tokí
 = 
	`°πok_r
(
°r
, 
KEY_SEP
, &
ßvïå
);Åokí !
NULL
;Åoken = strtok_r(NULL, KEY_SEP, &saveptr)) {

2283 i‡(
	`°∫cmp
(
tokí
, 
METER_MOD_COMMAND
 
KEY_VAL
, 
	`°æí
(METER_MOD_COMMAND KEY_VAL)) == 0) {

2284 
uöt16_t
 
comm™d
;

2285 i‡(
	`∑r£16
(
tokí
 + 
	`°æí
(
METER_MOD_COMMAND
 
KEY_VAL
), 
mëî_mod_cmd_«mes
, 
	`NUM_ELEMS
(mëî_mod_cmd_«mes),0, &
comm™d
)) {

2286 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög mëî_mod comm™d: %s.", 
tokí
);

2288 
ªq
->
comm™d
 = command;

2291 i‡(
	`°∫cmp
(
tokí
, 
METER_MOD_FLAGS
 
KEY_VAL
, 
	`°æí
(METER_MOD_FLAGS KEY_VAL)) == 0) {

2292 i‡(
	`∑r£16
(
tokí
 + 
	`°æí
(
METER_MOD_FLAGS
 
KEY_VAL
), 
NULL
, 0, 0xffff, &
ªq
->
Êags
)) {

2293 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög mëî_mod fœgs: %s.", 
tokí
);

2297 i‡(
	`°∫cmp
(
tokí
, 
METER_MOD_METER
 
KEY_VAL
, 
	`°æí
(METER_MOD_METER KEY_VAL)) == 0) {

2298 
uöt32_t
 
mëî_id
;

2299 i‡(
	`∑r£32
(
tokí
 + 
	`°æí
(
METER_MOD_METER
 
KEY_VAL
), 
NULL
, 0, 1024, &
mëî_id
)) {

2300 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög mëî_mod id: %s.", 
tokí
);

2302 
ªq
->
mëî_id
 = meter_id;

2305 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög group_modárg: %s.", 
tokí
);

2308 
	}
}

2311 
	$∑r£_b™d_¨gs
(*
°r
, 
oÊ_msg_mëî_mod
 *
m
, 
oÊ_mëî_b™d_hódî
 *
b
){

2312 *
tokí
, *
ßvïå
 = 
NULL
;

2313 
tokí
 = 
	`°πok_r
(
°r
, 
KEY_SEP
, &
ßvïå
);Åokí !
NULL
;Åoken = strtok_r(NULL, KEY_SEP, &saveptr)) {

2314 i‡(
	`°∫cmp
(
tokí
, 
BAND_RATE
 
KEY_VAL
, 
	`°æí
(BAND_RATE KEY_VAL)) == 0) {

2315 i‡(
	`∑r£32
(
tokí
 + 
	`°æí
(
BAND_RATE
 
KEY_VAL
), 
NULL
, 0, 
UINT32_MAX
, &
b
->
øã
)) {

2316 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög b™dÑ©e: %s.", 
tokí
);

2320 i‡(
	`°∫cmp
(
tokí
, 
BAND_BURST_SIZE
 
KEY_VAL
, 
	`°æí
(BAND_BURST_SIZE KEY_VAL)) == 0) {

2321 if(
m
->
Êags
 & 
OFPMF_BURST
){

2322 i‡(
	`∑r£32
(
tokí
 + 
	`°æí
(
BAND_BURST_SIZE
 
KEY_VAL
), 
NULL
, 0, 
UINT32_MAX
, &
b
->
bur°_size
)) {

2323 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög b™d bur°_size: %s.", 
tokí
);

2327 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög bur° size. Mëî fœg†should c⁄èö %x.", 
OFPMF_BURST
);

2329 i‡(
	`°∫cmp
(
tokí
, 
BAND_PREC_LEVEL
 
KEY_VAL
, 
	`°æí
(BAND_PREC_LEVEL KEY_VAL)) == 0) {

2330 
oÊ_mëî_b™d_ds˝_ªm¨k
 *
d
 = (oÊ_mëî_b™d_ds˝_ªm¨k*Ë
b
;

2331 i‡(
	`∑r£8
(
tokí
 + 
	`°æí
(
BAND_PREC_LEVEL
 
KEY_VAL
), 
NULL
, 0, 
UINT8_MAX
, &
d
->
¥ec_Àvñ
)) {

2332 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög b™dÑ©e: %s.", 
tokí
);

2336 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög b™dárg: %s.", 
tokí
);

2338 
	}
}

2341 
	$∑r£_b™d
(*
°r
, 
oÊ_msg_mëî_mod
 *
m
, 
oÊ_mëî_b™d_hódî
 **
b
){

2342 *
s
;

2343 
size_t
 
i
;

2344 
i
=0; i<
	`NUM_ELEMS
(
b™d_«mes
); i++) {

2346 i‡(
	`°∫cmp
(
°r
, 
b™d_«mes
[
i
].
«me
, 
	`°æí
(band_names[i].name)) == 0) {

2347 
s
 = 
°r
 + 
	`°æí
(
b™d_«mes
[
i
].
«me
);

2349 i‡(
	`°∫cmp
(
s
, 
KEY_VAL2
, 
	`°æí
(KEY_VAL2)) != 0) {

2350 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög mëî b™d: %s.", 
°r
);

2353 
s
+
	`°æí
(
KEY_VAL2
);

2354 
b™d_«mes
[
i
].
code
){

2355 (
OFPMBT_DROP
):{

2356 
oÊ_mëî_b™d_dr›
 *
d
 = (oÊ_mëî_b™d_dr›*Ë
	`xmÆloc
((ofl_meter_band_drop));

2357 
d
->
ty≥
 = 
OFPMBT_DROP
;

2358 
d
->
øã
 = 0;

2359 
d
->
bur°_size
 = 0;

2360 
	`∑r£_b™d_¨gs
(
s
, 
m
, (
oÊ_mëî_b™d_hódî
*)
d
);

2361 *
b
 = (
oÊ_mëî_b™d_hódî
*Ë
d
;

2364 (
OFPMBT_DSCP_REMARK
):{

2365 
oÊ_mëî_b™d_ds˝_ªm¨k
 *
d
 = (oÊ_mëî_b™d_ds˝_ªm¨k*Ë
	`xmÆloc
((ofl_meter_band_dscp_remark));

2366 
d
->
ty≥
 = 
OFPMBT_DSCP_REMARK
;

2367 
d
->
øã
 = 0;

2368 
d
->
bur°_size
 = 0;

2369 
d
->
¥ec_Àvñ
 = 0;

2370 
	`∑r£_b™d_¨gs
(
s
, 
m
, (
oÊ_mëî_b™d_hódî
*)
d
);

2371 *
b
 = (
oÊ_mëî_b™d_hódî
*Ë
d
;

2377 
	}
}

2381 
	$∑r£_c⁄fig
(*
°r
, 
oÊ_c⁄fig
 *
c
) {

2382 *
tokí
, *
ßvïå
 = 
NULL
;

2384 
tokí
 = 
	`°πok_r
(
°r
, 
KEY_SEP
, &
ßvïå
);Åokí !
NULL
;Åoken = strtok_r(NULL, KEY_SEP, &saveptr)) {

2385 i‡(
	`°∫cmp
(
tokí
, 
CONFIG_FLAGS
 
KEY_VAL
, 
	`°æí
(CONFIG_FLAGS KEY_VAL)) == 0) {

2386 i‡(
	`ssˇnf
(
tokí
 + 
	`°æí
(
CONFIG_FLAGS
 
KEY_VAL
), "0x%"
SCNx16
"", &
c
->
Êags
) != 1) {

2387 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög c⁄fig fœgs: %s.", 
tokí
);

2391 i‡(
	`°∫cmp
(
tokí
, 
CONFIG_MISS
 
KEY_VAL
, 
	`°æí
(CONFIG_MISS KEY_VAL)) == 0) {

2392 i‡(
	`∑r£16
(
tokí
 + 
	`°æí
(
CONFIG_MISS
 
KEY_VAL
), 
NULL
, 0, 
UINT16_MAX
 - (
oÂ_∑ckë_ö
), &
c
->
miss_£nd_Àn
)) {

2393 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög c⁄fig mis†£ndÜí: %s.", 
tokí
);

2397 
	`oÂ_Áèl
(0, "Eº‹Ö¨sög c⁄figárg: %s.", 
tokí
);

2399 
	}
}

2402 
	$∑r£_p‹t_mod
(*
°r
, 
oÊ_msg_p‹t_mod
 *
msg
) {

2403 *
tokí
, *
ßvïå
 = 
NULL
;

2405 
tokí
 = 
	`°πok_r
(
°r
, 
KEY_SEP
, &
ßvïå
);Åokí !
NULL
;Åoken = strtok_r(NULL, KEY_SEP, &saveptr)) {

2406 i‡(
	`°∫cmp
(
tokí
, 
PORT_MOD_PORT
 
KEY_VAL
, 
	`°æí
(PORT_MOD_PORT KEY_VAL)) == 0) {

2407 i‡(
	`∑r£_p‹t
(
tokí
 + 
	`°æí
(
PORT_MOD_PORT
 
KEY_VAL
), &
msg
->
p‹t_no
)) {

2408 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÖ‹t_modÖ‹t: %s.", 
tokí
);

2412 i‡(
	`°∫cmp
(
tokí
, 
PORT_MOD_HW_ADDR
 
KEY_VAL
, 
	`°æí
(PORT_MOD_HW_ADDR KEY_VAL)) == 0) {

2413 
uöt8_t
 *
mask
 = 
NULL
;

2414 i‡(
	`∑r£_dl_addr
(
tokí
 + 
	`°æí
(
PORT_MOD_HW_ADDR
 
KEY_VAL
), 
msg
->
hw_addr
, &
mask
)) {

2415 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÖ‹t_mod hw_addr: %s.", 
tokí
);

2419 i‡(
	`°∫cmp
(
tokí
, 
PORT_MOD_HW_CONFIG
 
KEY_VAL
, 
	`°æí
(PORT_MOD_HW_CONFIG KEY_VAL)) == 0) {

2420 i‡(
	`ssˇnf
(
tokí
 + 
	`°æí
(
PORT_MOD_HW_CONFIG
 
KEY_VAL
), "0x%"
SCNx32
"", &
msg
->
c⁄fig
) != 1) {

2421 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÖ‹t_mod c⁄f: %s.", 
tokí
);

2425 i‡(
	`°∫cmp
(
tokí
, 
PORT_MOD_MASK
 
KEY_VAL
, 
	`°æí
(PORT_MOD_MASK KEY_VAL)) == 0) {

2426 i‡(
	`ssˇnf
(
tokí
 + 
	`°æí
(
PORT_MOD_MASK
 
KEY_VAL
), "0x%"
SCNx32
"", &
msg
->
mask
) != 1) {

2427 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÖ‹t_mod mask: %s.", 
tokí
);

2431 i‡(
	`°∫cmp
(
tokí
, 
PORT_MOD_ADVERTISE
 
KEY_VAL
, 
	`°æí
(PORT_MOD_ADVERTISE KEY_VAL)) == 0) {

2432 i‡(
	`ssˇnf
(
tokí
 + 
	`°æí
(
PORT_MOD_ADVERTISE
 
KEY_VAL
), "0x%"
SCNx32
"", &
msg
->
advîti£
) != 1) {

2433 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÖ‹t_modádvîti£: %s.", 
tokí
);

2437 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÖ‹t_modárg: %s.", 
tokí
);

2439 
	}
}

2443 
	$∑r£_èbÀ_mod
(*
°r
, 
oÊ_msg_èbÀ_mod
 *
msg
) {

2444 *
tokí
, *
ßvïå
 = 
NULL
;

2446 
tokí
 = 
	`°πok_r
(
°r
, 
KEY_SEP
, &
ßvïå
);Åokí !
NULL
;Åoken = strtok_r(NULL, KEY_SEP, &saveptr)) {

2447 i‡(
	`°∫cmp
(
tokí
, 
TABLE_MOD_TABLE
 
KEY_VAL
, 
	`°æí
(TABLE_MOD_TABLE KEY_VAL)) == 0) {

2448 i‡(
	`∑r£_èbÀ
(
tokí
 + 
	`°æí
(
TABLE_MOD_TABLE
 
KEY_VAL
), &
msg
->
èbÀ_id
)) {

2449 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÅabÀ_modÅabÀ: %s.", 
tokí
);

2453 i‡(
	`°∫cmp
(
tokí
, 
TABLE_MOD_CONFIG
 
KEY_VAL
, 
	`°æí
(TABLE_MOD_CONFIG KEY_VAL)) == 0) {

2454 i‡(
	`ssˇnf
(
tokí
 + 
	`°æí
(
TABLE_MOD_CONFIG
 
KEY_VAL
), "0x%"
SCNx32
"", &
msg
->
c⁄fig
) != 1) {

2455 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÅabÀ_mod c⁄f: %s.", 
tokí
);

2459 
	`oÂ_Áèl
(0, "Eº‹Ö¨sögÅabÀ_modárg: %s.", 
tokí
);

2461 
	}
}

2465 
	$∑r£_p‹t
(*
°r
, 
uöt32_t
 *
p‹t
) {

2466  
	`∑r£32
(
°r
, 
p‹t_«mes
, 
	`NUM_ELEMS
’‹t_«mes), 
OFPP_MAX
, 
p‹t
);

2467 
	}
}

2470 
	$∑r£_queue
(*
°r
, 
uöt32_t
 *
p‹t
) {

2471  
	`∑r£32
(
°r
, 
queue_«mes
, 
	`NUM_ELEMS
(queue_«mes), 0xffffff„, 
p‹t
);

2472 
	}
}

2475 
	$∑r£_group
(*
°r
, 
uöt32_t
 *
group
) {

2476  
	`∑r£32
(
°r
, 
group_«mes
, 
	`NUM_ELEMS
(group_«mes), 
OFPG_MAX
, 
group
);

2477 
	}
}

2480 
	$∑r£_mëî
(*
°r
, 
uöt32_t
 *
mëî
) {

2481  
	`∑r£32
(
°r
, 
NULL
, 0, 
OFPM_MAX
, 
mëî
);

2482 
	}
}

2485 
	$∑r£_èbÀ
(*
°r
, 
uöt8_t
 *
èbÀ
) {

2486  
	`∑r£8
(
°r
, 
èbÀ_«mes
, 
	`NUM_ELEMS
—abÀ_«mes), 0x„, 
èbÀ
);

2487 
	}
}

2490 
	$∑r£_dl_addr
(*
°r
, 
uöt8_t
 *
addr
, uöt8_à**
mask
) {

2491 *
ßvïå
 = 
NULL
;

2492 i‡(
	`ssˇnf
(
°r
, "%"
SCNx8
":%"SCNx8":%"SCNx8":%"SCNx8":%"SCNx8":%"SCNx8,

2493 
addr
,áddr+1,áddr+2,áddr+3,áddr+4,áddr+5) != 6){

2496 
	`°πok_r
(
°r
, 
MASK_SEP
, &
ßvïå
);

2498 if(
	`°rcmp
(
ßvïå
,"") == 0){

2499 *
mask
 = 
NULL
;

2503 *
mask
 = (
uöt8_t
*Ë
	`mÆloc
 ((
OFP_ETH_ALEN
));

2504 i‡(
	`ssˇnf
(
ßvïå
, "%"
SCNx8
":%"SCNx8":%"SCNx8":%"SCNx8":%"SCNx8":%"SCNx8,

2505 *
mask
, *mask+1, *mask+2, *mask+3, *mask+4, *mask+5) != 6){

2510 
	}
}

2513 
	$∑r£_nw_addr
(*
°r
, 
uöt32_t
 *
addr
, uöt32_à**
mask
) {

2515 
uöt8_t
 
a
[4],
b
[4];

2516 
uöt32_t
 
√tmask
;

2517 *
ßvïå
 = 
NULL
;

2519 i‡(
	`ssˇnf
(
°r
, "%"
SCNu8
".%"SCNu8".%"SCNu8".%"SCNu8,

2520 &
a
[0], &a[1], &a[2], &a[3]) == 4) {

2521 *
addr
 = (
a
[3] << 24) | (a[2] << 16) | (a[1] << 8) |á[0];

2526 
	`°πok_r
(
°r
, 
MASK_SEP
, &
ßvïå
);

2527 if(
	`°rcmp
(
ßvïå
,"") == 0){

2528 *
mask
 = 
NULL
;

2531 *
mask
 = (
uöt32_t
*Ë
	`mÆloc
((uint32_t));

2532 
√tmask
 = 0xffffffff;

2533 if(
	`°æí
(
ßvïå
) <= 2){

2535 
uöt8_t
 
sub√t_mask
;

2536 
	`ssˇnf
(
ßvïå
, "%"
SCNu8
"",

2537 &
sub√t_mask
);

2538 i‡(
sub√t_mask
 > 32)

2540 i‡(
sub√t_mask
 == 0)

2541 
√tmask
 = 0x00000000;

2542 
√tmask
 =Çëmask << (32 - 
sub√t_mask
);

2543 **
mask
 = 
	`ht⁄l
(
√tmask
);

2547 i‡(
	`ssˇnf
(
ßvïå
, "%"
SCNu8
".%"SCNu8".%"SCNu8".%"SCNu8,

2548 &
b
[0], &b[1], &b[2], &b[3]) == 4) {

2549 **
mask
 = (
b
[3] << 24) | (b[2] << 16) | (b[1] << 8) | b[0];

2557 
	}
}

2560 
	$∑r£_vœn_vid
(*
°r
, 
uöt16_t
 *
vid
) {

2561  
	`∑r£16
(
°r
, 
vœn_vid_«mes
, 
	`NUM_ELEMS
(vœn_vid_«mes), 0xfff, 
vid
);

2562 
	}
}

2565 
	$∑r£_ext_hdr
(*
°r
, 
uöt16_t
 *
ext_hdr
){

2566 *
tokí
, *
ßvïå
 = 
NULL
;

2567 
size_t
 
i
;

2568 
	`mem£t
(
ext_hdr
, 0x0, (
uöt16_t
));

2569 
tokí
 = 
	`°πok_r
(
°r
, 
ADD
, &
ßvïå
);Åokí !
NULL
;Åoken = strtok_r(NULL, ADD, &saveptr)) {

2570 
i
=0; i < 9; i++) {

2571 i‡(
	`°rcmp
(
tokí
, 
ext_hódî_«mes
[
i
].
«me
) == 0) {

2572 *
ext_hdr
 = *ext_hd∏^ 
ext_hódî_«mes
[
i
].
code
;

2576 if(
i
 == 9)

2580 
	}
}

2583 
	$∑r£8
(*
°r
, 
«mes8
 *
«mes
, 
size_t
 
«mes_num
, 
uöt8_t
 
max
, uöt8_à*
vÆ
) {

2584 
size_t
 
i
;

2586 
i
=0; i<
«mes_num
; i++) {

2587 i‡(
	`°rcmp
(
°r
, 
«mes
[
i
].
«me
) == 0) {

2588 *
vÆ
 = 
«mes
[
i
].
code
;

2593 i‡((
max
 > 0Ë&& (
	`ssˇnf
(
°r
, "%"
SCNu8
"", 
vÆ
)) == 1 && ((*val) <= max)) {

2597 
	}
}

2600 
	$∑r£16
(*
°r
, 
«mes16
 *
«mes
, 
size_t
 
«mes_num
, 
uöt16_t
 
max
, uöt16_à*
vÆ
) {

2601 
size_t
 
i
;

2603 
i
=0; i<
«mes_num
; i++) {

2604 i‡(
	`°rcmp
(
°r
, 
«mes
[
i
].
«me
) == 0) {

2605 *
vÆ
 = 
«mes
[
i
].
code
;

2611 if–
°r
[1] == 'x'){

2612 i‡((
max
 > 0Ë&& (
	`ssˇnf
(
°r
, "%"
SCNx16
"", 
vÆ
)) == 1 && (*val <= max)) {

2617 i‡((
max
 > 0Ë&& (
	`ssˇnf
(
°r
, "%"
SCNu16
"", 
vÆ
)) == 1 && (*val <= max)) {

2622 
	}
}

2625 
	$∑r£16m
(*
°r
, 
«mes16
 *
«mes
, 
size_t
 
«mes_num
, 
uöt16_t
 
max
, uöt16_à*
vÆ
, uöt16_à*
mask
){

2627 
size_t
 
i
;

2628 *
tokí
, *
ßvïå
 = 
NULL
;

2630 
i
=0; i<
«mes_num
; i++) {

2631 i‡(
	`°rcmp
(
°r
, 
«mes
[
i
].
«me
) == 0) {

2632 *
vÆ
 = 
«mes
[
i
].
code
;

2636 i‡((
max
 > 0Ë&& (*
vÆ
 <= max)) {

2637 i‡(!
	`ssˇnf
(
°r
, "%"
SCNu16
"", 
vÆ
))

2641 
tokí
 = 
	`°πok_r
(
°r
, 
MASK_SEP
, &
ßvïå
);

2642 if(
tokí
 =
NULL
)

2643 
mask
 = 
NULL
;

2645 
mask
 = (
uöt16_t
*Ë
	`mÆloc
((uint16_t));

2646 
	`ssˇnf
(
tokí
, "%"
SCNu16
"", 
mask
);

2650 
	}
}

2653 
	$∑r£32
(*
°r
, 
«mes32
 *
«mes
, 
size_t
 
«mes_num
, 
uöt32_t
 
max
, uöt32_à*
vÆ
) {

2654 
size_t
 
i
;

2656 
i
=0; i<
«mes_num
; i++) {

2657 i‡(
	`°rcmp
(
°r
, 
«mes
[
i
].
«me
) == 0) {

2658 *
vÆ
 = 
«mes
[
i
].
code
;

2663 i‡((
max
 > 0Ë&& (
	`ssˇnf
(
°r
, "%"
SCNu32
"", 
vÆ
)) == 1 && ((*val) <= max)) {

2667 
	}
}

2670 
	$∑r£32m
(*
°r
, 
«mes32
 *
«mes
, 
size_t
 
«mes_num
, 
uöt32_t
 
max
, uöt32_à*
vÆ
, uöt32_à**
mask
){

2672 
size_t
 
i
;

2673 *
ßvïå
 = 
NULL
;

2675 
i
=0; i<
«mes_num
; i++) {

2676 i‡(
	`°rcmp
(
°r
, 
«mes
[
i
].
«me
) == 0) {

2677 *
vÆ
 = 
«mes
[
i
].
code
;

2681 i‡((
max
 > 0Ë&& (*
vÆ
 <= max)) {

2682 i‡(!
	`ssˇnf
(
°r
, "%"
SCNu32
"", 
vÆ
))

2686 
	`°πok_r
(
°r
, 
MASK_SEP
, &
ßvïå
);

2688 if(
ßvïå
 =
NULL
)

2689 *
mask
 = 
NULL
;

2691 *
mask
 = (
uöt32_t
*Ë
	`mÆloc
((uint32_t));

2692 
	`ssˇnf
(
ßvïå
, "%"
SCNu32
"", *
mask
);

2695 
	}
}

	@utilities/dpctl.h

32 #i‚de‡
DPCTL_H


33 
	#DPCTL_H
 1

	)

35 
	~"›íÊow/›íÊow.h
"

37 
	s«mes8
 {

38 
uöt8_t
 
	mcode
;

39 *
	m«me
;

42 
	s«mes16
 {

43 
uöt16_t
 
	mcode
;

44 *
	m«me
;

47 
	s«mes32
 {

48 
uöt32_t
 
	mcode
;

49 *
	m«me
;

54 
«mes32
 
	gp‹t_«mes
[] = {

55 {
OFPP_IN_PORT
, "in_port"},

56 {
OFPP_TABLE
, "table"},

57 {
OFPP_NORMAL
, "normal"},

58 {
OFPP_FLOOD
, "flood"},

59 {
OFPP_ALL
, "all"},

60 {
OFPP_CONTROLLER
, "ctrl"},

61 {
OFPP_LOCAL
, "local"},

62 {
OFPP_ANY
, "any"}

65 
«mes32
 
	gqueue_«mes
[] = {

66 {
OFPQ_ALL
, "all"}

69 
«mes32
 
	ggroup_«mes
[] = {

70 {
OFPG_ALL
, "all"},

71 {
OFPG_ANY
, "any"}

74 
«mes16
 
	gext_hódî_«mes
[] = {

75 {
OFPIEH_NONEXT
, "no_next"},

76 {
OFPIEH_ESP
, "esp"},

77 {
OFPIEH_AUTH
, "auth"},

78 {
OFPIEH_DEST
, "dest"},

79 {
OFPIEH_FRAG
, "frag"},

80 {
OFPIEH_ROUTER
, "router"},

81 {
OFPIEH_HOP
, "hop"},

82 {
OFPIEH_UNREP
, "unrep"},

83 {
OFPIEH_UNSEQ
, "unseq"}

86 
«mes8
 
	ggroup_ty≥_«mes
[] = {

87 {
OFPGT_ALL
, "all"},

88 {
OFPGT_SELECT
, "sel"},

89 {
OFPGT_INDIRECT
, "ind"},

90 {
OFPGT_FF
, "ff"}

93 
«mes16
 
	ggroup_mod_cmd_«mes
[] = {

94 {
OFPGC_ADD
, "add"},

95 {
OFPGC_MODIFY
, "mod"},

96 {
OFPGC_DELETE
, "del"}

99 
«mes16
 
	gmëî_mod_cmd_«mes
[] = {

100 {
OFPMC_ADD
, "add"},

101 {
OFPMC_MODIFY
, "mod"},

102 {
OFPMC_DELETE
, "del"}

105 
«mes8
 
	gèbÀ_«mes
[] = {

109 
«mes16
 
	gö°_«mes
[] = {

110 {
OFPIT_GOTO_TABLE
, "goto"},

111 {
OFPIT_WRITE_METADATA
, "meta"},

112 {
OFPIT_WRITE_ACTIONS
, "write"},

113 {
OFPIT_APPLY_ACTIONS
, "apply"},

114 {
OFPIT_CLEAR_ACTIONS
, "clear"},

115 {
OFPIT_METER
, "meter"}

118 
«mes8
 
	gÊow_mod_cmd_«mes
[] = {

119 {
OFPFC_ADD
, "add"},

120 {
OFPFC_MODIFY
, "mod"},

121 {
OFPFC_MODIFY_STRICT
, "mods"},

122 {
OFPFC_DELETE
, "del"},

123 {
OFPFC_DELETE_STRICT
, "dels"}

126 
«mes32
 
	gbuf„r_«mes
[] = {

130 
«mes16
 
	gvœn_vid_«mes
[] = {

131 {
OFPVID_PRESENT
, "any"},

132 {
OFPVID_NONE
, "none"}

136 
«mes16
 
	ga˘i⁄_«mes
[] = {

137 {
OFPAT_OUTPUT
, "output"},

138 {
OFPAT_COPY_TTL_OUT
, "ttl_out"},

139 {
OFPAT_COPY_TTL_IN
, "ttl_in"},

140 {
OFPAT_SET_MPLS_TTL
, "mpls_ttl"},

141 {
OFPAT_DEC_MPLS_TTL
, "mpls_dec"},

142 {
OFPAT_PUSH_VLAN
, "push_vlan"},

143 {
OFPAT_POP_VLAN
, "pop_vlan"},

144 {
OFPAT_PUSH_PBB
, "push_pbb"},

145 {
OFPAT_POP_PBB
, "pop_pbb"},

146 {
OFPAT_PUSH_MPLS
, "push_mpls"},

147 {
OFPAT_POP_MPLS
, "pop_mpls"},

148 {
OFPAT_SET_QUEUE
, "queue"},

149 {
OFPAT_GROUP
, "group"},

150 {
OFPAT_SET_NW_TTL
, "nw_ttl"},

151 {
OFPAT_DEC_NW_TTL
, "nw_dec"},

152 {
OFPAT_SET_FIELD
, "set_field"}

155 
«mes16
 
	gb™d_«mes
[] = {

156 {
OFPMBT_DROP
, "drop"},

157 {
OFPMBT_DSCP_REMARK
, "dscp_remark"}

160 
	#FLOW_MOD_COMMAND
 "cmd"

	)

161 
	#FLOW_MOD_COOKIE
 "cookõ"

	)

162 
	#FLOW_MOD_COOKIE_MASK
 "cookõ_mask"

	)

163 
	#FLOW_MOD_TABLE_ID
 "èbÀ"

	)

164 
	#FLOW_MOD_IDLE
 "idÀ"

	)

165 
	#FLOW_MOD_HARD
 "h¨d"

	)

166 
	#FLOW_MOD_PRIO
 "¥io"

	)

167 
	#FLOW_MOD_BUFFER
 "buf„r"

	)

168 
	#FLOW_MOD_OUT_PORT
 "out_p‹t"

	)

169 
	#FLOW_MOD_OUT_GROUP
 "out_group"

	)

170 
	#FLOW_MOD_FLAGS
 "Êags"

	)

171 
	#FLOW_MOD_MATCH
 "m©ch"

	)

174 
	#MATCH_IN_PORT
 "ö_p‹t"

	)

175 
	#MATCH_DL_SRC
 "ëh_§c"

	)

176 
	#MATCH_DL_SRC_MASK
 "ëh_§c_mask"

	)

177 
	#MATCH_DL_DST
 "ëh_d°"

	)

178 
	#MATCH_DL_DST_MASK
 "ëh_d°_mask"

	)

179 
	#MATCH_DL_VLAN
 "vœn_vid"

	)

180 
	#MATCH_IP_DSCP
 "ù_ds˝"

	)

181 
	#MATCH_IP_ECN
 "ù_e˙"

	)

182 
	#MATCH_DL_VLAN_PCP
 "vœn_p˝"

	)

183 
	#MATCH_DL_TYPE
 "ëh_ty≥"

	)

184 
	#MATCH_NW_PROTO
 "ù_¥Ÿo"

	)

185 
	#MATCH_NW_SRC
 "ù_§c"

	)

186 
	#MATCH_NW_SRC_MASK
 "nw_§c_mask"

	)

187 
	#MATCH_NW_DST
 "ù_d°"

	)

188 
	#MATCH_NW_DST_MASK
 "ùv4_d°_mask"

	)

189 
	#MATCH_TP_SRC
 "t˝_§c"

	)

190 
	#MATCH_TP_DST
 "t˝_d°"

	)

191 
	#MATCH_UDP_SRC
 "udp_§c"

	)

192 
	#MATCH_UDP_DST
 "udp_d°"

	)

193 
	#MATCH_SCTP_SRC
 "s˘p_§c"

	)

194 
	#MATCH_SCTP_DST
 "s˘p_d°"

	)

195 
	#MATCH_ICMPV4_CODE
 "icmp_code"

	)

196 
	#MATCH_ICMPV4_TYPE
 "icmp_ty≥"

	)

197 
	#MATCH_ARP_OP
 "¨p_›"

	)

198 
	#MATCH_ARP_SHA
 "¨p_sha"

	)

199 
	#MATCH_ARP_THA
 "¨p_tha"

	)

200 
	#MATCH_ARP_SPA
 "¨p_•a"

	)

201 
	#MATCH_ARP_TPA
 "¨p_ça"

	)

202 
	#MATCH_NW_SRC_IPV6
 "ùv6_§c"

	)

203 
	#MATCH_NW_DST_IPV6
 "ùv6_d°"

	)

204 
	#MATCH_ICMPV6_CODE
 "icmpv6_code"

	)

205 
	#MATCH_ICMPV6_TYPE
 "icmpv6_ty≥"

	)

206 
	#MATCH_IPV6_FLABEL
 "ùv6_Êabñ"

	)

207 
	#MATCH_IPV6_ND_TARGET
 "ùv6_nd_èrgë"

	)

208 
	#MATCH_IPV6_ND_SLL
 "ùv6_nd_¶l"

	)

209 
	#MATCH_IPV6_ND_TLL
 "ùv6_nd_él"

	)

210 
	#MATCH_MPLS_LABEL
 "m∂s_œbñ"

	)

211 
	#MATCH_MPLS_TC
 "m∂s_tc"

	)

212 
	#MATCH_MPLS_BOS
 "m∂s_bos"

	)

213 
	#MATCH_METADATA
 "mëa"

	)

214 
	#MATCH_METADATA_MASK
 "mëa_mask"

	)

215 
	#MATCH_PBB_ISID
 "pbb_isid"

	)

216 
	#MATCH_TUNNEL_ID
 "tu¬_id"

	)

217 
	#MATCH_EXT_HDR
 "ext_hdr"

	)

219 
	#GROUP_MOD_COMMAND
 "cmd"

	)

220 
	#GROUP_MOD_TYPE
 "ty≥"

	)

221 
	#GROUP_MOD_GROUP
 "group"

	)

223 
	#BUCKET_WEIGHT
 "weight"

	)

224 
	#BUCKET_WATCH_PORT
 "p‹t"

	)

225 
	#BUCKET_WATCH_GROUP
 "group"

	)

227 
	#METER_MOD_COMMAND
 "cmd"

	)

228 
	#METER_MOD_FLAGS
 "Êags"

	)

229 
	#METER_MOD_METER
 "mëî"

	)

231 
	#BAND_RATE
 "øã"

	)

232 
	#BAND_BURST_SIZE
 "bur°"

	)

233 
	#BAND_PREC_LEVEL
 "¥ec_Àvñ"

	)

235 
	#CONFIG_FLAGS
 "Êags"

	)

236 
	#CONFIG_MISS
 "miss"

	)

239 
	#PORT_MOD_PORT
 "p‹t"

	)

240 
	#PORT_MOD_HW_ADDR
 "addr"

	)

241 
	#PORT_MOD_HW_CONFIG
 "c⁄f"

	)

242 
	#PORT_MOD_MASK
 "mask"

	)

243 
	#PORT_MOD_ADVERTISE
 "adv"

	)

246 
	#TABLE_MOD_TABLE
 "èbÀ"

	)

247 
	#TABLE_MOD_CONFIG
 "c⁄f"

	)

249 
	#KEY_VAL
 "="

	)

250 
	#KEY_VAL2
 ":"

	)

251 
	#KEY_SEP
 ","

	)

252 
	#MASK_SEP
 "/"

	)

254 
	#ADD
 "+"

	)

255 
	#WILDCARD_SUB
 '-'

	)

259 
	#NUM_ELEMS
–
x
 ) ((xË/ (x[0]))

	)

	@utilities/ofp-discover.c

34 
	~<c⁄fig.h
>

35 
	~<gë›t.h
>

36 
	~<limôs.h
>

37 
	~<ªgex.h
>

38 
	~<sig«l.h
>

39 
	~<°dlib.h
>

40 
	~<uni°d.h
>

41 
	~"comm™d-löe.h
"

42 
	~"d´m⁄.h
"

43 
	~"dh˝-˛õ¡.h
"

44 
	~"dh˝.h
"

45 
	~"dús.h
"

46 
	~"dy«mic-°rög.h
"

47 
	~"Áèl-sig«l.h
"

48 
	~"√tdev.h
"

49 
	~"pﬁl-lo›.h
"

50 
	~"timevÆ.h
"

51 
	~"utû.h
"

52 
	~"vlog-sockë.h
"

53 
	~"vlog.h
"

55 
	#LOG_MODULE
 
VLM_oÂ_discovî


	)

57 
	siÁ˚
 {

58 c⁄° *
	m«me
;

59 
dh˛õ¡
 *
	mdh˝
;

63 
iÁ˚
 *
	giÁ˚s
;

64 
	gn_iÁ˚s
;

68 c⁄° *
	gac˚±_c⁄åﬁÀr_ª
 = ".*";

69 
ªgex_t
 
	gac˚±_c⁄åﬁÀr_ªgex
;

73 
boﬁ
 
	gexô_wôhout_böd
;

77 
boﬁ
 
	gexô_a·î_böd
;

79 
boﬁ
 
iÁ˚_öô
(
iÁ˚
 *, c⁄° *
√tdev_«me
);

80 
ªÀa£_iÁ˚s
(*
aux
 
UNUSED
);

82 
∑r£_›ti⁄s
(
¨gc
, *
¨gv
[]);

83 
	$ußge
(Ë
NO_RETURN
;

85 
	`modify_dh˝_ªque°
(
dh˝_msg
 *, *
aux
);

86 
boﬁ
 
	`vÆid©e_dh˝_of„r
(c⁄° 
dh˝_msg
 *, *
aux
);

89 
	$maö
(
¨gc
, *
¨gv
[])

91 
ªtvÆ
;

92 
i
;

94 
	`£t_¥ogøm_«me
(
¨gv
[0]);

95 
	`time_öô
();

96 
	`vlog_öô
();

97 
	`∑r£_›ti⁄s
(
¨gc
, 
¨gv
);

99 
¨gc
 -
›töd
;

100 
¨gv
 +
›töd
;

101 i‡(
¨gc
 < 1) {

102 
	`oÂ_Áèl
(0, "needátÜeast oneÇon-optionárgument; "

106 
iÁ˚s
 = 
	`xmÆloc
(
¨gc
 *  *ifaces);

107 
n_iÁ˚s
 = 0;

108 
i
 = 0; i < 
¨gc
; i++) {

109 i‡(
	`iÁ˚_öô
(&
iÁ˚s
[
n_iÁ˚s
], 
¨gv
[
i
])) {

110 
n_iÁ˚s
++;

113 i‡(!
n_iÁ˚s
) {

114 
	`oÂ_Áèl
(0, "failedÅo initializeány DHCP clients");

117 
i
 = 0; i < 
n_iÁ˚s
; i++) {

118 
iÁ˚
 *iÁ˚ = &
iÁ˚s
[
i
];

119 
	`dh˛õ¡_öô
(
iÁ˚
->
dh˝
, 0);

121 
	`Áèl_sig«l_add_hook
(
ªÀa£_iÁ˚s
, 
NULL
, 
åue
);

123 
ªtvÆ
 = 
	`ªgcomp
(&
ac˚±_c⁄åﬁÀr_ªgex
, 
ac˚±_c⁄åﬁÀr_ª
,

124 
REG_NOSUB
 | 
REG_EXTENDED
);

125 i‡(
ªtvÆ
) {

126 
size_t
 
Àngth
 = 
	`ªgîr‹
(
ªtvÆ
, &
ac˚±_c⁄åﬁÀr_ªgex
, 
NULL
, 0);

127 *
buf„r
 = 
	`xmÆloc
(
Àngth
);

128 
	`ªgîr‹
(
ªtvÆ
, &
ac˚±_c⁄åﬁÀr_ªgex
, 
buf„r
, 
Àngth
);

129 
	`oÂ_Áèl
(0, "%s: %s", 
ac˚±_c⁄åﬁÀr_ª
, 
buf„r
);

132 
ªtvÆ
 = 
	`vlog_£rvî_li°í
(
NULL
, NULL);

133 i‡(
ªtvÆ
) {

134 
	`oÂ_Áèl
(
ªtvÆ
, "CouldÇotÜisten for vlog connections");

137 
	`dõ_if_Æªady_ru¬ög
();

139 
	`sig«l
(
SIGPIPE
, 
SIG_IGN
);

141 
	`Áèl_sig«l_block
();

142 
i
 = 0; i < 
n_iÁ˚s
; i++) {

143 
iÁ˚
 *iÁ˚ = &
iÁ˚s
[
i
];

144 
	`dh˛õ¡_run
(
iÁ˚
->
dh˝
);

145 i‡(
	`dh˛õ¡_ch™ged
(
iÁ˚
->
dh˝
)) {

146 
boﬁ
 
is_bound
 = 
	`dh˛õ¡_is_bound
(
iÁ˚
->
dh˝
);

147 
j
;

150 i‡(!
exô_wôhout_böd
) {

151 
	`dh˛õ¡_c⁄figuª_√tdev
(
iÁ˚
->
dh˝
);

152 
	`dh˛õ¡_upd©e_ªsﬁv_c⁄f
(
iÁ˚
->
dh˝
);

155 i‡(
is_bound
) {

156 
boﬁ
 
dëached
 = 
Ál£
;

157 
ds
 ds;

160 
	`time_Æ¨m
(0);

163 
	`ds_öô
(&
ds
);

164 
	`dh˝_msg_to_°rög
(
	`dh˛õ¡_gë_c⁄fig
(
iÁ˚
->
dh˝
),

165 
åue
, &
ds
);

166 
	`Âuts
(
	`ds_c°r
(&
ds
), 
°dout
);

167 
	`putch¨
('\n');

168 
	`fÊush
(
°dout
);

169 
	`ds_de°roy
(&
ds
);

172 i‡(
exô_wôhout_böd
) {

173 
	`VLOG_DBG
(
LOG_MODULE
, "exiting because of successful binding on %s "

175 
iÁ˚
->
«me
);

176 
	`exô
(0);

178 i‡(
exô_a·î_böd
) {

179 
	`VLOG_DBG
(
LOG_MODULE
, "exiting because of successful binding on %s "

181 
iÁ˚
->
«me
);

182 
	`exô
(0);

186 i‡(!
dëached
) {

187 
dëached
 = 
åue
;

188 
	`d´m⁄ize
();

196 
j
 = 0; j < 
n_iÁ˚s
; j++) {

197 
iÁ˚
 *
if2
 = &
iÁ˚s
[
j
];

198 i‡(
iÁ˚
 !
if2
) {

199 i‡(
is_bound
) {

200 
	`dh˛õ¡_ªÀa£
(
if2
->
dh˝
);

202 
	`dh˛õ¡_öô
(
if2
->
dh˝
, 0);

208 
i
 = 0; i < 
n_iÁ˚s
; i++) {

209 
iÁ˚
 *iÁ˚ = &
iÁ˚s
[
i
];

210 
	`dh˛õ¡_waô
(
iÁ˚
->
dh˝
);

212 
	`Áèl_sig«l_unblock
();

213 
	`pﬁl_block
();

217 
	}
}

219 
boﬁ


220 
	$iÁ˚_öô
(
iÁ˚
 *iÁ˚, c⁄° *
√tdev_«me
)

222 
ªtvÆ
;

224 
iÁ˚
->
«me
 = 
√tdev_«me
;

225 
iÁ˚
->
dh˝
 = 
NULL
;

227 i‡(
exô_a·î_böd
) {

230 
√tdev
 *netdev;

232 
ªtvÆ
 = 
	`√tdev_›í
(
iÁ˚
->
«me
, 
NETDEV_ETH_TYPE_NONE
, &
√tdev
);

233 i‡(
ªtvÆ
) {

234 
	`oÂ_îr‹
(
ªtvÆ
, "CouldÇŸ o≥¿%†devi˚", 
iÁ˚
->
«me
);

235  
Ál£
;

237 
ªtvÆ
 = 
	`√tdev_tu∫_Êags_⁄
(
√tdev
, 
NETDEV_UP
, 
åue
);

238 i‡(
ªtvÆ
) {

239 
	`oÂ_îr‹
(
ªtvÆ
, "CouldÇŸ brög %†devi˚ up", 
iÁ˚
->
«me
);

240  
Ál£
;

242 
	`√tdev_˛o£
(
√tdev
);

245 
ªtvÆ
 = 
	`dh˛õ¡_¸óã
(
iÁ˚
->
«me
, 
modify_dh˝_ªque°
,

246 
vÆid©e_dh˝_of„r
, 
NULL
, &
iÁ˚
->
dh˝
);

247 i‡(
ªtvÆ
) {

248 
	`oÂ_îr‹
(
ªtvÆ
, "%s: faûedÅÿöôülizêDHCP clõ¡", 
iÁ˚
->
«me
);

249  
Ál£
;

252  
åue
;

253 
	}
}

256 
	$ªÀa£_iÁ˚s
(*
aux
 
UNUSED
)

258 
i
;

260 
i
 = 0; i < 
n_iÁ˚s
; i++) {

261 
dh˛õ¡
 *
dh˝
 = 
iÁ˚s
[
i
].dhcp;

262 
	`dh˛õ¡_ªÀa£
(
dh˝
);

263 i‡(
	`dh˛õ¡_ch™ged
(
dh˝
)) {

264 
	`dh˛õ¡_c⁄figuª_√tdev
(
dh˝
);

267 
	}
}

270 
	$modify_dh˝_ªque°
(
dh˝_msg
 *
msg
, *
aux
 
UNUSED
)

272 
	`dh˝_msg_put_°rög
(
msg
, 
DHCP_CODE_VENDOR_CLASS
, "OpenFlow");

273 
	}
}

275 
boﬁ


276 
	$vÆid©e_dh˝_of„r
(c⁄° 
dh˝_msg
 *
msg
, *
aux
 
UNUSED
)

278 
vlog_øã_limô
 
æ
 = 
	`VLOG_RATE_LIMIT_INIT
(60, 60);

279 *
vc⁄n_«me
;

280 
boﬁ
 
ac˚±
;

282 
vc⁄n_«me
 = 
	`dh˝_msg_gë_°rög
(
msg
, 
DHCP_CODE_OFP_CONTROLLER_VCONN
);

283 i‡(!
vc⁄n_«me
) {

284 
	`VLOG_WARN_RL
(
LOG_MODULE
, &
æ
, "rejecting DHCP offer missing controller vconn");

285  
Ál£
;

287 
ac˚±
 = !
	`ªgexec
(&
ac˚±_c⁄åﬁÀr_ªgex
, 
vc⁄n_«me
, 0, 
NULL
, 0);

288 
	`‰ì
(
vc⁄n_«me
);

289  
ac˚±
;

290 
	}
}

293 
	$∑r£_›ti⁄s
(
¨gc
, *
¨gv
[])

296 
OPT_ACCEPT_VCONN
 = 
UCHAR_MAX
 + 1,

297 
OPT_EXIT_WITHOUT_BIND
,

298 
OPT_EXIT_AFTER_BIND
,

299 
OPT_NO_DETACH
,

301 
›ti⁄
 
l⁄g_›ti⁄s
[] = {

302 {"ac˚±-vc⁄n", 
ªquúed_¨gumít
, 0, 
OPT_ACCEPT_VCONN
},

303 {"exô-wôhout-böd", 
no_¨gumít
, 0, 
OPT_EXIT_WITHOUT_BIND
},

304 {"exô-a·î-böd", 
no_¨gumít
, 0, 
OPT_EXIT_AFTER_BIND
},

305 {"no-dëach", 
no_¨gumít
, 0, 
OPT_NO_DETACH
},

306 {"timeout", 
ªquúed_¨gumít
, 0, 't'},

307 {"pidfûe", 
›ti⁄Æ_¨gumít
, 0, 'P'},

308 {"f‹˚", 
no_¨gumít
, 0, 'f'},

309 {"vîbo£", 
›ti⁄Æ_¨gumít
, 0, 'v'},

310 {"hñp", 
no_¨gumít
, 0, 'h'},

311 {"vîsi⁄", 
no_¨gumít
, 0, 'V'},

314 *
sh‹t_›ti⁄s
 = 
	`l⁄g_›ti⁄s_to_sh‹t_›ti⁄s
(
l⁄g_›ti⁄s
);

315 
boﬁ
 
dëach_a·î_böd
 = 
åue
;

318 
timeout
;

319 
c
;

321 
c
 = 
	`gë›t_l⁄g
(
¨gc
, 
¨gv
, 
sh‹t_›ti⁄s
, 
l⁄g_›ti⁄s
, 
NULL
);

322 i‡(
c
 == -1) {

326 
c
) {

327 
OPT_ACCEPT_VCONN
:

328 
ac˚±_c⁄åﬁÀr_ª
 = (
›èrg
[0] == '^'

329 ? 
›èrg


330 : 
	`xa•rötf
("^%s", 
›èrg
));

333 
OPT_EXIT_WITHOUT_BIND
:

334 
exô_wôhout_böd
 = 
åue
;

337 
OPT_EXIT_AFTER_BIND
:

338 
exô_a·î_böd
 = 
åue
;

341 
OPT_NO_DETACH
:

342 
dëach_a·î_böd
 = 
Ál£
;

346 
	`£t_pidfûe
(
›èrg
);

350 
	`ign‹e_exi°ög_pidfûe
();

354 
timeout
 = 
	`°πoul
(
›èrg
, 
NULL
, 10);

355 i‡(
timeout
 <= 0) {

356 
	`oÂ_Áèl
(0, "value %s on -t or --timeout isÇotátÜeast 1",

357 
›èrg
);

359 
	`time_Æ¨m
(
timeout
);

361 
	`sig«l
(
SIGALRM
, 
SIG_DFL
);

365 
	`ußge
();

368 
	`¥ötf
("%†%†compûed "
__DATE__
" "
__TIME__
"\n",

369 
¥ogøm_«me
, 
VERSION
 
BUILDNR
);

370 
	`exô
(
EXIT_SUCCESS
);

373 
	`vlog_£t_vîbosôy
(
›èrg
);

377 
	`exô
(
EXIT_FAILURE
);

380 
	`ab‹t
();

383 
	`‰ì
(
sh‹t_›ti⁄s
);

385 i‡((
exô_wôhout_böd
 + 
exô_a·î_böd
 + !
dëach_a·î_böd
) > 1) {

386 
	`oÂ_Áèl
(0, "--exit-without-bind, --exit-after-bind,ánd --no-detach "

389 i‡(
dëach_a·î_böd
) {

390 
	`£t_dëach
();

392 
	}
}

395 
	$ußge
()

397 
	`¥ötf
("%s:áÅool for discovering OpenFlow controllers.\n"

410 
¥ogøm_«me
,Örogram_name);

411 
	`vlog_ußge
();

412 
	`¥ötf
("\nOther options:\n"

418 
oÂ_rundú
, 
¥ogøm_«me
);

419 
	`exô
(
EXIT_SUCCESS
);

420 
	}
}

	@utilities/ofp-kill.c

34 
	~<c⁄fig.h
>

35 
	~<î∫o.h
>

36 
	~<f˙é.h
>

37 
	~<gë›t.h
>

38 
	~<sig«l.h
>

39 
	~<°d¨g.h
>

40 
	~<°dlib.h
>

41 
	~<°rög.h
>

42 
	~"comm™d-löe.h
"

43 
	~"d´m⁄.h
"

44 
	~"timevÆ.h
"

45 
	~"utû.h
"

46 
	~"vlog.h
"

49 
	gsig_ƒ
 = 
SIGTERM
;

52 
boﬁ
 
	gf‹˚
;

54 
	$c⁄d_îr‹
(
îr_no
, c⁄° *, ...Ë
	`PRINTF_FORMAT
(2, 3);

56 
	`∑r£_›ti⁄s
(
¨gc
, *
¨gv
[]);

57 
	`ußge
();

60 
	$maö
(
¨gc
, *
¨gv
[])

62 
boﬁ
 
ok
 = 
åue
;

63 
i
;

65 
	`£t_¥ogøm_«me
(
¨gv
[0]);

66 
	`time_öô
();

67 
	`vlog_öô
();

68 
	`∑r£_›ti⁄s
(
¨gc
, 
¨gv
);

70 
¨gc
 -
›töd
;

71 
¨gv
 +
›töd
;

72 i‡(
¨gc
 < 1) {

73 i‡(!
f‹˚
) {

74 
	`oÂ_Áèl
(0, "needátÜeast oneÇon-optionárgument; "

79 
i
 = 0; i < 
¨gc
; i++) {

80 *
pidfûe
;

81 
pid_t
 
pid
;

83 
pidfûe
 = 
	`make_pidfûe_«me
(
¨gv
[
i
]);

84 
pid
 = 
	`ªad_pidfûe
(
pidfûe
);

85 i‡(
pid
 >= 0) {

86 i‡(
	`kûl
(
pid
, 
sig_ƒ
) < 0) {

87 
	`c⁄d_îr‹
(
î∫o
, "%s: kûl(%ld)", 
pidfûe
, (Ë
pid
);

90 
	`c⁄d_îr‹
(-
pid
, "couldÇŸÑód %s", 
pidfûe
);

92 
	`‰ì
(
pidfûe
);

95  
ok
 || 
f‹˚
 ? 
EXIT_SUCCESS
 : 
EXIT_FAILURE
;

96 
	}
}

99 
	$∑r£_›ti⁄s
(
¨gc
, *
¨gv
[])

101 
›ti⁄
 
l⁄g_›ti⁄s
[] = {

102 {"sig«l", 
ªquúed_¨gumít
, 0, 's'},

103 {"f‹˚", 
no_¨gumít
, 0, 'f'},

104 {"hñp", 
no_¨gumít
, 0, 'h'},

105 {"vîsi⁄", 
no_¨gumít
, 0, 'V'},

108 *
sh‹t_›ti⁄s
 = 
	`l⁄g_›ti⁄s_to_sh‹t_›ti⁄s
(
l⁄g_›ti⁄s
);

111 
c
;

113 
c
 = 
	`gë›t_l⁄g
(
¨gc
, 
¨gv
, 
sh‹t_›ti⁄s
, 
l⁄g_›ti⁄s
, 
NULL
);

114 i‡(
c
 == -1) {

118 
c
) {

120 i‡(
	`©oi
(
›èrg
Ë|| !
	`°rcmp
(optarg, "0")) {

121 
sig_ƒ
 = 
	`©oi
(
›èrg
);

123 
	ssig«l_«me
 {

124 c⁄° *
«me
;

125 
numbî
;

128 c⁄° 
sig«l_«me
 
sig«ls
[] = {

129 
	#SIGNAL
(
NAME
Ë{ #NAME, NAME }

	)

130 
	`SIGNAL
(
SIGABRT
),

131 
	`SIGNAL
(
SIGALRM
),

132 
	`SIGNAL
(
SIGBUS
),

133 
	`SIGNAL
(
SIGCHLD
),

134 
	`SIGNAL
(
SIGCONT
),

135 
	`SIGNAL
(
SIGFPE
),

136 
	`SIGNAL
(
SIGHUP
),

137 
	`SIGNAL
(
SIGILL
),

138 
	`SIGNAL
(
SIGINT
),

139 
	`SIGNAL
(
SIGKILL
),

140 
	`SIGNAL
(
SIGPIPE
),

141 
	`SIGNAL
(
SIGQUIT
),

142 
	`SIGNAL
(
SIGSEGV
),

143 
	`SIGNAL
(
SIGSTOP
),

144 
	`SIGNAL
(
SIGTERM
),

145 
	`SIGNAL
(
SIGTSTP
),

146 
	`SIGNAL
(
SIGTTIN
),

147 
	`SIGNAL
(
SIGTTOU
),

148 
	`SIGNAL
(
SIGUSR1
),

149 
	`SIGNAL
(
SIGUSR2
),

150 #ifde‡
SIGPOLL


151 
	`SIGNAL
(
SIGPOLL
),

153 
	`SIGNAL
(
SIGPROF
),

154 
	`SIGNAL
(
SIGSYS
),

155 
	`SIGNAL
(
SIGTRAP
),

156 
	`SIGNAL
(
SIGURG
),

157 
	`SIGNAL
(
SIGVTALRM
),

158 
	`SIGNAL
(
SIGXCPU
),

159 
	`SIGNAL
(
SIGXFSZ
),

160 #unde‡
SIGNAL


162 
i
;

164 
i
 = 0; i < 
	`ARRAY_SIZE
(
sig«ls
); i++) {

165 c⁄° 
sig«l_«me
 *
s
 = &
sig«ls
[
i
];

166 i‡(!
	`°rcmp
(
›èrg
, 
s
->
«me
)

167 || !
	`°rcmp
(
›èrg
, 
s
->
«me
 + 3)) {

168 
sig_ƒ
 = 
s
->
numbî
;

169 
gŸ_«me
;

172 
	`oÂ_Áèl
(0, "unknow¿sig«»\"%s\"", 
›èrg
);

173 
gŸ_«me
: ;

178 
f‹˚
 = 
åue
;

182 
	`ußge
();

185 
	`¥ötf
("%†%†compûed "
__DATE__
" "
__TIME__
"\n",

186 
¥ogøm_«me
, 
VERSION
 
BUILDNR
);

187 
	`exô
(
EXIT_SUCCESS
);

190 
	`exô
(
EXIT_FAILURE
);

193 
	`ab‹t
();

196 
	`‰ì
(
sh‹t_›ti⁄s
);

197 
	}
}

200 
	$ußge
()

202 
	`¥ötf
("%s: killsáÖrogram usingáÖidfile\n"

210 
¥ogøm_«me
,Örogram_name);

211 
	`exô
(
EXIT_SUCCESS
);

212 
	}
}

215 
	$c⁄d_îr‹
(
îr_no
, c⁄° *
f‹m©
, ...)

217 i‡(!
f‹˚
) {

218 
va_li°
 
¨gs
;

220 
	`Ârötf
(
°dîr
, "%s: ", 
¥ogøm_«me
);

221 
	`va_°¨t
(
¨gs
, 
f‹m©
);

222 
	`vÂrötf
(
°dîr
, 
f‹m©
, 
¨gs
);

223 
	`va_íd
(
¨gs
);

224 i‡(
îr_no
 != 0)

225 
	`Ârötf
(
°dîr
, " (%s)", 
	`°ªº‹
(
îr_no
));

226 
	`putc
('\n', 
°dîr
);

228 
	}
}

	@utilities/ofp-read.c

30 
	~<c⁄fig.h
>

31 
	~<°dlib.h
>

32 
	~<°dio.h
>

34 
	~"oÊib/oÊ-mesßges.h
"

36 
	~"timevÆ.h
"

37 
	~"vlog.h
"

39 
size_t
 
	$ªad_Æl
(
FILE
 *
fûe
, 
uöt8_t
 **
buf
)

41 
size_t
 
buf_Àn
;

42 
uöt8_t
 *
d©a
;

43 *
buf
 = 
NULL
;

45 
	`f£ek
(
fûe
, 0, 
SEEK_END
);

46 
buf_Àn
 = 
	`·ñl
(
fûe
);

47 
	`ªwöd
(
fûe
);

49 
d©a
 = (
uöt8_t
*Ë
	`mÆloc
(
buf_Àn
);

50 
	`‰ód
(
d©a
, 
buf_Àn
, 1, 
fûe
);

51 i‡(
	`„º‹
(
fûe
)) {

52 
	`Ârötf
(
°dîr
, "CannotÑead msg file.\n");

55 *
buf
 = 
d©a
;

56  
buf_Àn
;

57 
	}
}

59 
	$maö
(
¨gc
, **
¨gv
)

61 
uöt8_t
 *
buf
 ,*
buf0
;

62 
size_t
 
buf_Àn
 = 0;

63 
oÊ_îr
 
îr
;

64 
oÊ_msg_hódî
 *
msg
 = 
NULL
;

65 
uöt32_t
 
xid
;

66 
FILE
 *
msg_fûe
;

67 
oÂ_hódî
 *
oh
;

69 i‡(
¨gc
 < 2) {

70 
	`Ârötf
(
°dîr
, "Expecting msg file.\n");

74 
	`time_öô
();

75 
	`vlog_öô
();

76 
	`vlog_£t_vîbosôy
(
NULL
);

78 
msg_fûe
 = 
	`f›í
(
¨gv
[1], "r");

79 i‡(
msg_fûe
 =
NULL
) {

80 
	`Ârötf
(
°dîr
, "Cannot open msg file.\n");

83 
buf_Àn
 = 
	`ªad_Æl
(
msg_fûe
, &
buf
);

84 
buf0
 = 
buf
;

87 
buf_Àn
 > 0) {

88 
oh
 = (
oÂ_hódî
 *)
buf
;

89 
îr
 = 
	`oÊ_msg_u≈ack
(
buf
, 
	`¡ohs
(
oh
->
Àngth
), &
msg
, &
xid
, 
NULL
);

90 i‡(
îr
 == 0) {

92 
	`oÊ_msg_¥öt
(
°dout
, 
msg
, 
NULL
);

93 
	`¥ötf
("\n\n");

94 
	`oÊ_msg_‰ì
(
msg
, 
NULL
);

96 
	`‰ì
(
buf
);

97 
	`¥ötf
("Faûed :-–îr‹Åy≥: %d codê%d\n", 
	`oÊ_îr‹_ty≥
(
îr
), 
	`oÊ_îr‹_code
(err));

100 
buf_Àn
 -
	`¡ohs
(
oh
->
Àngth
);

101 
buf
 +
	`¡ohs
(
oh
->
Àngth
);

103 
	`‰ì
(
buf0
);

105 
	}
}

	@utilities/vlogconf.c

33 
	~<c⁄fig.h
>

34 
	~"vlog.h
"

36 
	~<dúít.h
>

37 
	~<î∫o.h
>

38 
	~<gë›t.h
>

39 
	~<°d¨g.h
>

40 
	~<°dio.h
>

41 
	~<°rög.h
>

42 
	~<°dlib.h
>

44 
	~"comm™d-löe.h
"

45 
	~"compûî.h
"

46 
	~"timevÆ.h
"

47 
	~"utû.h
"

48 
	~"vlog-sockë.h
"

51 
	$ußge
(*
¥og_«me
, 
exô_code
)

53 
	`¥ötf
("Usage: %s [TARGET] [ACTION...]\n"

68 
¥og_«me
);

69 
	`exô
(
exô_code
);

70 
	}
}

73 
	$å™ß˘
(
vlog_˛õ¡
 *
˛õ¡
, c⁄° *
ªque°
, 
boﬁ
 *
ok
)

75 *
ª∂y
;

76 
îr‹
 = 
	`vlog_˛õ¡_å™ß˘
(
˛õ¡
, 
ªque°
, &
ª∂y
);

77 i‡(
îr‹
) {

78 
	`Ârötf
(
°dîr
, "%s:ÅransactionÉrror: %s\n",

79 
	`vlog_˛õ¡_èrgë
(
˛õ¡
), 
	`°ªº‹
(
îr‹
));

80 *
ok
 = 
Ál£
;

82  
ª∂y
 ?Ñïly : 
	`x°rdup
("");

83 
	}
}

86 
	$å™ß˘_ack
(
vlog_˛õ¡
 *
˛õ¡
, c⁄° * 
ªque°
, 
boﬁ
 *
ok
)

88 *
ª∂y
;

89 
îr‹
 = 
	`vlog_˛õ¡_å™ß˘
(
˛õ¡
, 
ªque°
, &
ª∂y
);

90 i‡(
îr‹
) {

91 
	`Ârötf
(
°dîr
, "%s:ÅransactionÉrror: %s\n",

92 
	`vlog_˛õ¡_èrgë
(
˛õ¡
), 
	`°ªº‹
(
îr‹
));

93 *
ok
 = 
Ál£
;

94 } i‡(
	`°rcmp
(
ª∂y
, "ack")) {

95 
	`Ârötf
(
°dîr
, "Received unexpectedÑeply from %s: %s\n",

96 
	`vlog_˛õ¡_èrgë
(
˛õ¡
), 
ª∂y
);

97 *
ok
 = 
Ál£
;

99 
	`‰ì
(
ª∂y
);

100 
	}
}

103 
	$add_èrgë
(
vlog_˛õ¡
 ***
˛õ¡s
, 
size_t
 *
n_˛õ¡s
,

104 c⁄° *
∑th
, 
boﬁ
 *
ok
)

106 
vlog_˛õ¡
 *
˛õ¡
;

107 
îr‹
 = 
	`vlog_˛õ¡_c⁄√˘
(
∑th
, &
˛õ¡
);

108 i‡(
îr‹
) {

109 
	`Ârötf
(
°dîr
, "Error connectingÅo \"%s\": %s\n",

110 
∑th
, 
	`°ªº‹
(
îr‹
));

111 *
ok
 = 
Ál£
;

113 *
˛õ¡s
 = 
	`xªÆloc
(*˛õ¡s,  *˛õ¡†* (*
n_˛õ¡s
 + 1));

114 (*
˛õ¡s
)[*
n_˛õ¡s
] = 
˛õ¡
;

115 ++*
n_˛õ¡s
;

117 
	}
}

120 
	$add_Æl_èrgës
(
vlog_˛õ¡
 ***
˛õ¡s
, 
size_t
 *
n_˛õ¡s
, 
boﬁ
 *
ok
)

122 
DIR
 *
dúe˘‹y
;

123 
dúít
* 
de
;

125 
dúe˘‹y
 = 
	`›ídú
("/tmp");

126 i‡(!
dúe˘‹y
) {

127 
	`Ârötf
(
°dîr
, "/tmp: o≥ndú: %s\n", 
	`°ªº‹
(
î∫o
));

130 (
de
 = 
	`ªaddú
(
dúe˘‹y
)Ë!
NULL
) {

131 i‡(!
	`°∫cmp
(
de
->
d_«me
, "vlogs.", 5)) {

132 *
∑th
 = 
	`xa•rötf
("/tmp/%s", 
de
->
d_«me
);

133 
	`add_èrgë
(
˛õ¡s
, 
n_˛õ¡s
, 
∑th
, 
ok
);

134 
	`‰ì
(
∑th
);

138 
	`˛o£dú
(
dúe˘‹y
);

139 
	}
}

141 
	$maö
(
¨gc
, *
¨gv
[])

143 c⁄° 
›ti⁄
 
l⁄g_›ti⁄s
[] = {

145 {"Æl", 
no_¨gumít
, 
NULL
, 'a'},

146 {"èrgë", 
ªquúed_¨gumít
, 
NULL
, 't'},

147 {"hñp", 
no_¨gumít
, 
NULL
, 'h'},

150 {"li°", 
no_¨gumít
, 
NULL
, 'l'},

151 {"£t", 
ªquúed_¨gumít
, 
NULL
, 's'},

152 {"ª›í", 
no_¨gumít
, 
NULL
, 'r'},

155 *
sh‹t_›ti⁄s
;

158 
boﬁ
 
ok
 = 
åue
;

159 
n_a˘i⁄s
 = 0;

160 
vlog_˛õ¡
 **
˛õ¡s
 = 
NULL
;

161 
size_t
 
n_˛õ¡s
 = 0;

163 
	`£t_¥ogøm_«me
(
¨gv
[0]);

164 
	`time_öô
();

166 
sh‹t_›ti⁄s
 = 
	`l⁄g_›ti⁄s_to_sh‹t_›ti⁄s
(
l⁄g_›ti⁄s
);

168 
›ti⁄
;

169 
size_t
 
i
;

171 
›ti⁄
 = 
	`gë›t_l⁄g
(
¨gc
, 
¨gv
, 
sh‹t_›ti⁄s
, 
l⁄g_›ti⁄s
, 
NULL
);

172 i‡(
›ti⁄
 == -1) {

175 i‡(!
	`°rchr
("©h", 
›ti⁄
Ë&& 
n_˛õ¡s
 == 0) {

176 
	`oÂ_Áèl
(0, "noÅargets specified (use --help for help)");

178 ++
n_a˘i⁄s
;

180 
›ti⁄
) {

182 
	`add_Æl_èrgës
(&
˛õ¡s
, &
n_˛õ¡s
, &
ok
);

186 
	`add_èrgë
(&
˛õ¡s
, &
n_˛õ¡s
, 
›èrg
, &
ok
);

190 
i
 = 0; i < 
n_˛õ¡s
; i++) {

191 
vlog_˛õ¡
 *
˛õ¡
 = 
˛õ¡s
[
i
];

192 *
ª∂y
;

194 
	`¥ötf
("%s:\n", 
	`vlog_˛õ¡_èrgë
(
˛õ¡
));

195 
ª∂y
 = 
	`å™ß˘
(
˛õ¡
, "li°", &
ok
);

196 
	`Âuts
(
ª∂y
, 
°dout
);

197 
	`‰ì
(
ª∂y
);

202 
i
 = 0; i < 
n_˛õ¡s
; i++) {

203 
vlog_˛õ¡
 *
˛õ¡
 = 
˛õ¡s
[
i
];

204 *
ªque°
 = 
	`xa•rötf
("£à%s", 
›èrg
);

205 
	`å™ß˘_ack
(
˛õ¡
, 
ªque°
, &
ok
);

206 
	`‰ì
(
ªque°
);

211 
i
 = 0; i < 
n_˛õ¡s
; i++) {

212 
vlog_˛õ¡
 *
˛õ¡
 = 
˛õ¡s
[
i
];

213 *
ªque°
 = 
	`x°rdup
("reopen");

214 
	`å™ß˘_ack
(
˛õ¡
, 
ªque°
, &
ok
);

215 
	`‰ì
(
ªque°
);

220 
	`ußge
(
¨gv
[0], 
EXIT_SUCCESS
);

224 
	`exô
(
EXIT_FAILURE
);

227 
	`NOT_REACHED
();

230 i‡(!
n_a˘i⁄s
) {

231 
	`Ârötf
(
°dîr
,

234 
	`exô
(
ok
 ? 0 : 1);

235 
	}
}

	@/usr/include/arpa/inet.h

18 #i‚de‡
_ARPA_INET_H


19 
	#_ARPA_INET_H
 1

	)

21 
	~<„©uªs.h
>

22 
	~<√töë/ö.h
>

25 #i‚de‡
__sockÀn_t_deföed


26 
__sockÀn_t
 
	tsockÀn_t
;

27 
	#__sockÀn_t_deföed


	)

30 
__BEGIN_DECLS


34 
ö_addr_t
 
	$öë_addr
 (c⁄° *
__˝
Ë
__THROW
;

37 
ö_addr_t
 
	$öë_ aof
 (
ö_addr
 
__ö
Ë
__THROW
;

41 
ö_addr
 
	$öë_makóddr
 (
ö_addr_t
 
__√t
, in_addr_à
__ho°
)

42 
__THROW
;

45 
ö_addr_t
 
	$öë_√tof
 (
ö_addr
 
__ö
Ë
__THROW
;

49 
ö_addr_t
 
	$öë_√tw‹k
 (c⁄° *
__˝
Ë
__THROW
;

53 *
	$öë_¡ﬂ
 (
ö_addr
 
__ö
Ë
__THROW
;

58 
	$öë_±⁄
 (
__af
, c⁄° *
__ª°ri˘
 
__˝
,

59 *
__ª°ri˘
 
__buf
Ë
__THROW
;

64 c⁄° *
	$öë_¡›
 (
__af
, c⁄° *
__ª°ri˘
 
__˝
,

65 *
__ª°ri˘
 
__buf
, 
sockÀn_t
 
__Àn
)

66 
__THROW
;

70 #ifde‡
__USE_MISC


73 
	$öë_©⁄
 (c⁄° *
__˝
, 
ö_addr
 *
__öp
Ë
__THROW
;

77 *
	$öë_√è
 (
ö_addr_t
 
__√t
, *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

82 *
	$öë_√t_¡›
 (
__af
, c⁄° *
__˝
, 
__bôs
,

83 *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

88 
	$öë_√t_±⁄
 (
__af
, c⁄° *
__˝
,

89 *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

94 
	$öë_nßp_addr
 (c⁄° *
__˝
,

95 *
__buf
, 
__Àn
Ë
__THROW
;

99 *
	$öë_nßp_¡ﬂ
 (
__Àn
, c⁄° *
__˝
,

100 *
__buf
Ë
__THROW
;

103 
__END_DECLS


	@/usr/include/assert.h

23 #ifdef 
_ASSERT_H


25 #unde‡
_ASSERT_H


26 #unde‡
as£π


27 #unde‡
__ASSERT_VOID_CAST


29 #ifdef 
__USE_GNU


30 #unde‡
as£π_≥º‹


35 
	#_ASSERT_H
 1

	)

36 
	~<„©uªs.h
>

38 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,95)

39 
	#__ASSERT_VOID_CAST
 
°©ic_ˇ°
<>

	)

41 
	#__ASSERT_VOID_CAST
 ()

	)

49 #ifdef 
NDEBUG


51 
	#as£π
(
ex¥
Ë(
	`__ASSERT_VOID_CAST
 (0))

	)

59 #ifdef 
__USE_GNU


60 
	#as£π_≥º‹
(
î∫um
Ë(
	`__ASSERT_VOID_CAST
 (0))

	)

65 #i‚de‡
_ASSERT_H_DECLS


66 
	#_ASSERT_H_DECLS


	)

67 
__BEGIN_DECLS


70 
	$__as£π_Áû
 (c⁄° *
__as£πi⁄
, c⁄° *
__fûe
,

71 
__löe
, c⁄° *
__fun˘i⁄
)

72 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

75 
	$__as£π_≥º‹_Áû
 (
__î∫um
, c⁄° *
__fûe
,

76 
__löe
, c⁄° *
__fun˘i⁄
)

77 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

82 
	$__as£π
 (c⁄° *
__as£πi⁄
, c⁄° *
__fûe
, 
__löe
)

83 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

86 
__END_DECLS


89 
	#as£π
(
ex¥
) \

90 ((
ex¥
) \

91 ? 
	`__ASSERT_VOID_CAST
 (0) \

92 : 
	`__as£π_Áû
 (
	`__STRING
(
ex¥
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

94 #ifdef 
__USE_GNU


95 
	#as£π_≥º‹
(
î∫um
) \

96 (!(
î∫um
) \

97 ? 
	`__ASSERT_VOID_CAST
 (0) \

98 : 
	`__as£π_≥º‹_Áû
 ((
î∫um
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

106 #i‡
deföed
 
__˝lu•lus
 ? 
	`__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

107 
	#__ASSERT_FUNCTION
 
__PRETTY_FUNCTION__


	)

109 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

110 
	#__ASSERT_FUNCTION
 
__func__


	)

112 
	#__ASSERT_FUNCTION
 ((c⁄° *Ë0)

	)

119 #i‡
deföed
 
__USE_ISOC11
 && !deföed 
__˝lu•lus


121 #unde‡
°©ic_as£π


122 
	#°©ic_as£π
 
_Sètic_as£π


	)

	@/usr/include/boost/static_assert.hpp

14 #i‚de‡
BOOST_STATIC_ASSERT_HPP


15 
	#BOOST_STATIC_ASSERT_HPP


	)

17 
	~<boo°/c⁄fig.hµ
>

18 
	~<boo°/dëaû/w‹k¨ound.hµ
>

20 #i‚de‡
BOOST_NO_CXX11_STATIC_ASSERT


21 
	#BOOST_STATIC_ASSERT_MSG
–
B
, 
Msg
 ) 
	`°©ic_as£π
(B, Msg)

	)

23 
	#BOOST_STATIC_ASSERT_MSG
–
B
, 
Msg
 ) 
	`BOOST_STATIC_ASSERT
–B )

	)

26 #ifde‡
__BORLANDC__


29 
	#BOOST_BUGGY_INTEGRAL_CONSTANT_EXPRESSIONS


	)

32 #i‡
deföed
(
__GNUC__
Ë&& (__GNUC__ =3Ë&& ((
__GNUC_MINOR__
 == 3) || (__GNUC_MINOR__ == 4))

34 
	#BOOST_SA_GCC_WORKAROUND


	)

41 #i‡
deföed
(
__GNUC__
Ë&& ((__GNUC__ > 3Ë|| ((__GNUC__ =3Ë&& (
__GNUC_MINOR__
 >= 4)))

42 
	#BOOST_STATIC_ASSERT_BOOL_CAST
–
x
 ) ((xË=0 ? 
Ál£
 : 
åue
)

	)

44 
	#BOOST_STATIC_ASSERT_BOOL_CAST
(
x
Ë(
boﬁ
)(x)

	)

49 #i‡
deföed
(
__GNUC__
Ë&& ((__GNUC__ > 4Ë|| ((__GNUC__ =4Ë&& (
__GNUC_MINOR__
 >= 7)))

50 
	#BOOST_STATIC_ASSERT_UNUSED_ATTRIBUTE
 
	`__©åibuã__
((
unu£d
))

	)

52 
	#BOOST_STATIC_ASSERT_UNUSED_ATTRIBUTE


	)

55 #i‚de‡
BOOST_NO_CXX11_STATIC_ASSERT


56 
	#BOOST_STATIC_ASSERT
–
B
 ) 
	`°©ic_as£π
(B, #B)

	)

59 
«me•a˚
 
	gboo°
{

62 
	gãm∂©e
 <
boﬁ
 
	gx
> 
	gSTATIC_ASSERTION_FAILURE
;

64 
	gãm∂©e
 <> 
	gSTATIC_ASSERTION_FAILURE
<
	gåue
> {Énum { 
	gvÆue
 = 1 }; };

67 
	gãm∂©e
<
	gx
> 
	s°©ic_as£π_ã°
{};

93 #i‡!
deföed
(
BOOST_BUGGY_INTEGRAL_CONSTANT_EXPRESSIONS
)

95 #i‡
deföed
(
BOOST_MSVC
) && (BOOST_MSVC < 1300)

98 
	#BOOST_STATIC_ASSERT
–
B
 ) \

99 ::
boo°
::
	t°©ic_as£π_ã°
<\

100 (::
	tboo°
::
	tSTATIC_ASSERTION_FAILURE
< (
	tboﬁ
)–
	tB
 ) >)\

101 > 
	tboo°_°©ic_as£π_ty≥def_


	)

102 #ñi‡
	tdeföed
(
	tBOOST_MSVC
)

103 
	tBOOST_STATIC_ASSERT
–
	tB
 ) \

104 ::
boo°
::
	t°©ic_as£π_ã°
<\

105 (::
	tboo°
::
	tSTATIC_ASSERTION_FAILURE
< 
	tBOOST_STATIC_ASSERT_BOOL_CAST
 ( 
	tB
 ) >)>\

106 
	tBOOST_JOIN
(
	tboo°_°©ic_as£π_ty≥def_
, 
	t__COUNTER__
)

	)

107 #ñi‡
	tdeföed
(
	tBOOST_INTEL_CXX_VERSION
Ë|| deföed(
	tBOOST_SA_GCC_WORKAROUND
)

110 
	tBOOST_STATIC_ASSERT
–
	tB
 ) \

111 
	tBOOST_JOIN
(
	tboo°_°©ic_as£π_ty≥def_
, 
	t__LINE__
) \

112 [ ::
boo°
::
STATIC_ASSERTION_FAILURE
< 
	`BOOST_STATIC_ASSERT_BOOL_CAST
–
B
 ) >::
vÆue
 ]

	)

113 #ñi‡
	tdeföed
(
	t__sgi
)

115 
	tBOOST_STATIC_ASSERT
–
	tB
 ) \

116 
	tBOOST_STATIC_CONSTANT
(
	tboﬁ
, \

117 
	tBOOST_JOIN
(
	tboo°_°©ic_as£π_ã°_
, 
	t__LINE__
Ë–
	tB
 )); \

118 ::
boo°
::
	t°©ic_as£π_ã°
<\

119 (::
	tboo°
::
	tSTATIC_ASSERTION_FAILURE
< \

120 
	tBOOST_JOIN
(
	tboo°_°©ic_as£π_ã°_
, 
	t__LINE__
) >)>\

121 
	tBOOST_JOIN
(
	tboo°_°©ic_as£π_ty≥def_
, 
	t__LINE__
)

	)

122 #ñi‡
	tBOOST_WORKAROUND
(
	t__MWERKS__
, <= 0x3003)

124 
	tBOOST_STATIC_ASSERT
–
	tB
 ) \

125 
	tBOOST_STATIC_CONSTANT
(, \

126 
	tBOOST_JOIN
(
	tboo°_°©ic_as£π_ã°_
, 
	t__LINE__
) = \

127 (::
	tboo°
::
	tSTATIC_ASSERTION_FAILURE
< 
	tBOOST_STATIC_ASSERT_BOOL_CAST
–
	tB
 ) >Ë)

	)

130 
	tBOOST_STATIC_ASSERT
–
	tB
 ) \

131 ::
boo°
::
	t°©ic_as£π_ã°
<\

132 (::
	tboo°
::
	tSTATIC_ASSERTION_FAILURE
< 
	tBOOST_STATIC_ASSERT_BOOL_CAST
–
	tB
 ) >)>\

133 
	tBOOST_JOIN
(
	tboo°_°©ic_as£π_ty≥def_
, 
	t__LINE__
Ë
	tBOOST_STATIC_ASSERT_UNUSED_ATTRIBUTE


	)

138 
	tBOOST_STATIC_ASSERT
–
	tB
 ) \

139 íum { 
	`BOOST_JOIN
(
boo°_°©ic_as£π_íum_
, 
__LINE__
) \

140 (::
boo°
::
STATIC_ASSERTION_FAILURE
< (
boﬁ
)–
B
 ) >Ë}

	)

	@/usr/include/ctype.h

23 #i‚def 
_CTYPE_H


24 
	#_CTYPE_H
 1

	)

26 
	~<„©uªs.h
>

27 
	~<bôs/ty≥s.h
>

29 
	g__BEGIN_DECLS


31 #i‚de‡
_ISbô


40 
	~<ídün.h
>

41 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


42 
	#_ISbô
(
bô
Ë(1 << (bô))

	)

44 
	#_ISbô
(
bô
Ë((bôË< 8 ? ((1 << (bô)Ë<< 8Ë: ((1 << (bô)Ë>> 8))

	)

49 
	m_ISuµî
 = 
_ISbô
 (0),

50 
	m_ISlowî
 = 
_ISbô
 (1),

51 
	m_ISÆpha
 = 
_ISbô
 (2),

52 
	m_ISdigô
 = 
_ISbô
 (3),

53 
	m_ISxdigô
 = 
_ISbô
 (4),

54 
	m_IS•a˚
 = 
_ISbô
 (5),

55 
	m_IS¥öt
 = 
_ISbô
 (6),

56 
	m_ISgøph
 = 
_ISbô
 (7),

57 
	m_ISbœnk
 = 
_ISbô
 (8),

58 
	m_IS˙ål
 = 
_ISbô
 (9),

59 
	m_ISpun˘
 = 
_ISbô
 (10),

60 
	m_ISÆnum
 = 
_ISbô
 (11)

80 c⁄° **
	$__˘y≥_b_loc
 ()

81 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

82 c⁄° 
__öt32_t
 **
	$__˘y≥_tﬁowî_loc
 ()

83 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

84 c⁄° 
__öt32_t
 **
	$__˘y≥_touµî_loc
 ()

85 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

88 #i‚de‡
__˝lu•lus


89 
	#__is˘y≥
(
c
, 
ty≥
) \

90 ((*
	`__˘y≥_b_loc
 ())[(Ë(
c
)] & (Ë
ty≥
)

	)

91 #ñi‡
deföed
 
__USE_EXTERN_INLINES


92 
	#__is˘y≥_f
(
ty≥
) \

93 
__exã∫_ölöe
 \

94 
is
##
	`ty≥
 (
__c
Ë
__THROW
 \

96  (*
	`__˘y≥_b_loc
 ())[(Ë(
__c
)] & (Ë
_IS
##
ty≥
; \

97 
	}

	)
}

100 
	#__ißscii
(
c
Ë(((cË& ~0x7fË=0Ë

	)

101 
	#__tﬂscii
(
c
Ë((cË& 0x7fË

	)

103 
	#__ex˘y≥
(
«me
Ë
	`«me
 (Ë
__THROW


	)

105 
__BEGIN_NAMESPACE_STD


111 
__ex˘y≥
 (
iß um
);

112 
__ex˘y≥
 (
ißÕha
);

113 
__ex˘y≥
 (
is˙ål
);

114 
__ex˘y≥
 (
isdigô
);

115 
__ex˘y≥
 (
i¶owî
);

116 
__ex˘y≥
 (
isgøph
);

117 
__ex˘y≥
 (
i•röt
);

118 
__ex˘y≥
 (
i•un˘
);

119 
__ex˘y≥
 (
is•a˚
);

120 
__ex˘y≥
 (
isuµî
);

121 
__ex˘y≥
 (
isxdigô
);

125 
	$tﬁowî
 (
__c
Ë
__THROW
;

128 
	$touµî
 (
__c
Ë
__THROW
;

130 
__END_NAMESPACE_STD


134 #ifdef 
__USE_ISOC99


135 
__BEGIN_NAMESPACE_C99


137 
	`__ex˘y≥
 (
isbœnk
);

139 
__END_NAMESPACE_C99


142 #ifde‡
__USE_GNU


144 
	$is˘y≥
 (
__c
, 
__mask
Ë
__THROW
;

147 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


151 
	$ißscii
 (
__c
Ë
__THROW
;

155 
	$tﬂscii
 (
__c
Ë
__THROW
;

159 
	`__ex˘y≥
 (
_touµî
);

160 
	`__ex˘y≥
 (
_tﬁowî
);

164 
	#__tobody
(
c
, 
f
, 
a
, 
¨gs
) \

165 (
__exãnsi⁄__
 \

166 ({ 
__ªs
; \

167 i‡( (
c
) > 1) \

169 i‡(
	`__buûtö_c⁄°™t_p
 (
c
)) \

171 
__c
 = (
c
); \

172 
__ªs
 = 
__c
 < -128 || __¯> 255 ? __¯: (
a
)[__c]; \

175 
__ªs
 = 
f
 
¨gs
; \

178 
__ªs
 = (
a
)[(Ë(
c
)]; \

179 
__ªs
; 
	}
}))

	)

181 #i‡!
deföed
 
__NO_CTYPE


182 #ifde‡
__is˘y≥_f


183 
	$__is˘y≥_f
 (
Ænum
)

184 
	$__is˘y≥_f
 (
Æpha
)

185 
	$__is˘y≥_f
 (
˙ål
)

186 
	$__is˘y≥_f
 (
digô
)

187 
	$__is˘y≥_f
 (
lowî
)

188 
	$__is˘y≥_f
 (
gøph
)

189 
	$__is˘y≥_f
 (
¥öt
)

190 
	$__is˘y≥_f
 (
pun˘
)

191 
	$__is˘y≥_f
 (
•a˚
)

192 
	$__is˘y≥_f
 (
uµî
)

193 
	$__is˘y≥_f
 (
xdigô
)

194 #ifde‡
__USE_ISOC99


195 
	$__is˘y≥_f
 (
bœnk
)

197 #ñi‡
deföed
 
__is˘y≥


198 
	#iß um
(
c
Ë
	`__is˘y≥
((c), 
_ISÆnum
)

	)

199 
	#ißÕha
(
c
Ë
	`__is˘y≥
((c), 
_ISÆpha
)

	)

200 
	#is˙ål
(
c
Ë
	`__is˘y≥
((c), 
_IS˙ål
)

	)

201 
	#isdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISdigô
)

	)

202 
	#i¶owî
(
c
Ë
	`__is˘y≥
((c), 
_ISlowî
)

	)

203 
	#isgøph
(
c
Ë
	`__is˘y≥
((c), 
_ISgøph
)

	)

204 
	#i•röt
(
c
Ë
	`__is˘y≥
((c), 
_IS¥öt
)

	)

205 
	#i•un˘
(
c
Ë
	`__is˘y≥
((c), 
_ISpun˘
)

	)

206 
	#is•a˚
(
c
Ë
	`__is˘y≥
((c), 
_IS•a˚
)

	)

207 
	#isuµî
(
c
Ë
	`__is˘y≥
((c), 
_ISuµî
)

	)

208 
	#isxdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISxdigô
)

	)

209 #ifde‡
__USE_ISOC99


210 
	#isbœnk
(
c
Ë
	`__is˘y≥
((c), 
_ISbœnk
)

	)

214 #ifde‡
__USE_EXTERN_INLINES


215 
__exã∫_ölöe
 

216 
	`__NTH
 (
	$tﬁowî
 (
__c
))

218  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_tﬁowî_loc
 ())[__c] : __c;

219 
	}
}

221 
__exã∫_ölöe
 

222 
__NTH
 (
	$touµî
 (
__c
))

224  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_touµî_loc
 ())[__c] : __c;

225 
	}
}

228 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


229 
	#tﬁowî
(
c
Ë
	`__tobody
 (c, 
tﬁowî
, *
	`__˘y≥_tﬁowî_loc
 (), (c))

	)

230 
	#touµî
(
c
Ë
	`__tobody
 (c, 
touµî
, *
	`__˘y≥_touµî_loc
 (), (c))

	)

233 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


234 
	#ißscii
(
c
Ë
	`__ißscii
 (c)

	)

235 
	#tﬂscii
(
c
Ë
	`__tﬂscii
 (c)

	)

237 
	#_tﬁowî
(
c
Ë((Ë(*
	`__˘y≥_tﬁowî_loc
 ())[(Ë(c)])

	)

238 
	#_touµî
(
c
Ë((Ë(*
	`__˘y≥_touµî_loc
 ())[(Ë(c)])

	)

244 #ifde‡
__USE_XOPEN2K8


258 
	~<xloˇÀ.h
>

262 
	#__is˘y≥_l
(
c
, 
ty≥
, 
loˇÀ
) \

263 ((
loˇÀ
)->
__˘y≥_b
[(Ë(
c
)] & (Ë
ty≥
)

	)

265 
	#__ex˘y≥_l
(
«me
) \

266 
	`«me
 (, 
__loˇÀ_t
Ë
__THROW


	)

272 
__ex˘y≥_l
 (
iß um_l
);

273 
__ex˘y≥_l
 (
ißÕha_l
);

274 
__ex˘y≥_l
 (
is˙ål_l
);

275 
__ex˘y≥_l
 (
isdigô_l
);

276 
__ex˘y≥_l
 (
i¶owî_l
);

277 
__ex˘y≥_l
 (
isgøph_l
);

278 
__ex˘y≥_l
 (
i•röt_l
);

279 
__ex˘y≥_l
 (
i•un˘_l
);

280 
__ex˘y≥_l
 (
is•a˚_l
);

281 
__ex˘y≥_l
 (
isuµî_l
);

282 
__ex˘y≥_l
 (
isxdigô_l
);

284 
__ex˘y≥_l
 (
isbœnk_l
);

288 
	$__tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

289 
	$tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

292 
	$__touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

293 
	$touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

295 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


296 
	#__tﬁowî_l
(
c
, 
loˇÀ
) \

297 
	`__tobody
 (
c
, 
__tﬁowî_l
, (
loˇÀ
)->
__˘y≥_tﬁowî
, (c,ÜoˇÀ))

	)

298 
	#__touµî_l
(
c
, 
loˇÀ
) \

299 
	`__tobody
 (
c
, 
__touµî_l
, (
loˇÀ
)->
__˘y≥_touµî
, (c,ÜoˇÀ))

	)

300 
	#tﬁowî_l
(
c
, 
loˇÀ
Ë
	`__tﬁowî_l
 ((c), (loˇÀ))

	)

301 
	#touµî_l
(
c
, 
loˇÀ
Ë
	`__touµî_l
 ((c), (loˇÀ))

	)

305 #i‚de‡
__NO_CTYPE


306 
	#__iß um_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆnum
, (l))

	)

307 
	#__ißÕha_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆpha
, (l))

	)

308 
	#__is˙ål_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS˙ål
, (l))

	)

309 
	#__isdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISdigô
, (l))

	)

310 
	#__i¶owî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISlowî
, (l))

	)

311 
	#__isgøph_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISgøph
, (l))

	)

312 
	#__i•röt_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS¥öt
, (l))

	)

313 
	#__i•un˘_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISpun˘
, (l))

	)

314 
	#__is•a˚_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS•a˚
, (l))

	)

315 
	#__isuµî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISuµî
, (l))

	)

316 
	#__isxdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISxdigô
, (l))

	)

318 
	#__isbœnk_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISbœnk
, (l))

	)

320 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


321 
	#__ißscii_l
(
c
,
l
Ë(÷), 
	`__ißscii
 (c))

	)

322 
	#__tﬂscii_l
(
c
,
l
Ë(÷), 
	`__tﬂscii
 (c))

	)

325 
	#iß um_l
(
c
,
l
Ë
	`__iß um_l
 ((c), (l))

	)

326 
	#ißÕha_l
(
c
,
l
Ë
	`__ißÕha_l
 ((c), (l))

	)

327 
	#is˙ål_l
(
c
,
l
Ë
	`__is˙ål_l
 ((c), (l))

	)

328 
	#isdigô_l
(
c
,
l
Ë
	`__isdigô_l
 ((c), (l))

	)

329 
	#i¶owî_l
(
c
,
l
Ë
	`__i¶owî_l
 ((c), (l))

	)

330 
	#isgøph_l
(
c
,
l
Ë
	`__isgøph_l
 ((c), (l))

	)

331 
	#i•röt_l
(
c
,
l
Ë
	`__i•röt_l
 ((c), (l))

	)

332 
	#i•un˘_l
(
c
,
l
Ë
	`__i•un˘_l
 ((c), (l))

	)

333 
	#is•a˚_l
(
c
,
l
Ë
	`__is•a˚_l
 ((c), (l))

	)

334 
	#isuµî_l
(
c
,
l
Ë
	`__isuµî_l
 ((c), (l))

	)

335 
	#isxdigô_l
(
c
,
l
Ë
	`__isxdigô_l
 ((c), (l))

	)

337 
	#isbœnk_l
(
c
,
l
Ë
	`__isbœnk_l
 ((c), (l))

	)

339 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


340 
	#ißscii_l
(
c
,
l
Ë
	`__ißscii_l
 ((c), (l))

	)

341 
	#tﬂscii_l
(
c
,
l
Ë
	`__tﬂscii_l
 ((c), (l))

	)

348 
__END_DECLS


	@/usr/include/dirent.h

23 #i‚def 
_DIRENT_H


24 
	#_DIRENT_H
 1

	)

26 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


30 
	~<bôs/ty≥s.h
>

32 #ifde‡
__USE_XOPEN


33 #i‚de‡
__öo_t_deföed


34 #i‚de‡
__USE_FILE_OFFSET64


35 
__öo_t
 
	töo_t
;

37 
__öo64_t
 
	töo_t
;

39 
	#__öo_t_deföed


	)

41 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__öo64_t_deföed


42 
__öo64_t
 
	töo64_t
;

43 
	#__öo64_t_deföed


	)

62 
	~<bôs/dúít.h
>

64 #i‡(
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
Ë&& !deföed 
d_fûío


65 
	#d_öo
 
d_fûío


	)

82 #ifde‡
_DIRENT_HAVE_D_NAMLEN


83 
	#_D_EXACT_NAMLEN
(
d
Ë((d)->
d_«mÀn
)

	)

84 
	#_D_ALLOC_NAMLEN
(
d
Ë(
	`_D_EXACT_NAMLEN
 (dË+ 1)

	)

86 
	#_D_EXACT_NAMLEN
(
d
Ë(
	`°æí
 ((d)->
d_«me
))

	)

87 #ifde‡
_DIRENT_HAVE_D_RECLEN


88 
	#_D_ALLOC_NAMLEN
(
d
Ë(((*Ë(dË+ (d)->
d_ª˛í
Ë- &(d)->
d_«me
[0])

	)

90 
	#_D_ALLOC_NAMLEN
(
d
Ë( (d)->
d_«me
 > 1 ?  (d)->d_name : \

91 
	`_D_EXACT_NAMLEN
 (
d
Ë+ 1)

	)

96 #ifde‡
__USE_BSD


100 
	mDT_UNKNOWN
 = 0,

101 
	#DT_UNKNOWN
 
DT_UNKNOWN


	)

102 
	mDT_FIFO
 = 1,

103 
	#DT_FIFO
 
DT_FIFO


	)

104 
	mDT_CHR
 = 2,

105 
	#DT_CHR
 
DT_CHR


	)

106 
	mDT_DIR
 = 4,

107 
	#DT_DIR
 
DT_DIR


	)

108 
	mDT_BLK
 = 6,

109 
	#DT_BLK
 
DT_BLK


	)

110 
	mDT_REG
 = 8,

111 
	#DT_REG
 
DT_REG


	)

112 
	mDT_LNK
 = 10,

113 
	#DT_LNK
 
DT_LNK


	)

114 
	mDT_SOCK
 = 12,

115 
	#DT_SOCK
 
DT_SOCK


	)

116 
	mDT_WHT
 = 14

117 
	#DT_WHT
 
DT_WHT


	)

121 
	#IFTODT
(
mode
Ë(((modeË& 0170000Ë>> 12)

	)

122 
	#DTTOIF
(
dúty≥
Ë((dúty≥Ë<< 12)

	)

128 
__dú°ªam
 
	tDIR
;

135 
DIR
 *
	$›ídú
 (c⁄° *
__«me
Ë
	`__n⁄nuŒ
 ((1));

137 #ifde‡
__USE_XOPEN2K8


142 
DIR
 *
	`fd›ídú
 (
__fd
);

150 
	$˛o£dú
 (
DIR
 *
__dúp
Ë
	`__n⁄nuŒ
 ((1));

162 #i‚de‡
__USE_FILE_OFFSET64


163 
dúít
 *
	$ªaddú
 (
DIR
 *
__dúp
Ë
	`__n⁄nuŒ
 ((1));

165 #ifde‡
__REDIRECT


166 
dúít
 *
	`__REDIRECT
 (
ªaddú
, (
DIR
 *
__dúp
), 
ªaddú64
)

167 
	`__n⁄nuŒ
 ((1));

169 
	#ªaddú
 
ªaddú64


	)

173 #ifde‡
__USE_LARGEFILE64


174 
dúít64
 *
	$ªaddú64
 (
DIR
 *
__dúp
Ë
	`__n⁄nuŒ
 ((1));

177 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


183 #i‚de‡
__USE_FILE_OFFSET64


184 
	$ªaddú_r
 (
DIR
 *
__ª°ri˘
 
__dúp
,

185 
dúít
 *
__ª°ri˘
 
__íåy
,

186 
dúít
 **
__ª°ri˘
 
__ªsu…
)

187 
	`__n⁄nuŒ
 ((1, 2, 3));

189 #ifde‡
__REDIRECT


190 
	`__REDIRECT
 (
ªaddú_r
,

191 (
DIR
 *
__ª°ri˘
 
__dúp
,

192 
dúít
 *
__ª°ri˘
 
__íåy
,

193 
dúít
 **
__ª°ri˘
 
__ªsu…
),

194 
ªaddú64_r
Ë
	`__n⁄nuŒ
 ((1, 2, 3));

196 
	#ªaddú_r
 
ªaddú64_r


	)

200 #ifde‡
__USE_LARGEFILE64


201 
	$ªaddú64_r
 (
DIR
 *
__ª°ri˘
 
__dúp
,

202 
dúít64
 *
__ª°ri˘
 
__íåy
,

203 
dúít64
 **
__ª°ri˘
 
__ªsu…
)

204 
	`__n⁄nuŒ
 ((1, 2, 3));

209 
	$ªwöddú
 (
DIR
 *
__dúp
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

211 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


212 
	~<bôs/ty≥s.h
>

215 
	$£ekdú
 (
DIR
 *
__dúp
, 
__pos
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

218 
	$ãŒdú
 (
DIR
 *
__dúp
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

221 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN2K8


224 
	$dúfd
 (
DIR
 *
__dúp
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

226 #i‡
deföed
 
__OPTIMIZE__
 && deföed 
_DIR_dúfd


227 
	#dúfd
(
dúp
Ë
	`_DIR_dúfd
 (dúp)

	)

230 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC


231 #i‚de‡
MAXNAMLEN


233 
	~<bôs/posix1_lim.h
>

236 #ifde‡
NAME_MAX


237 
	#MAXNAMLEN
 
NAME_MAX


	)

239 
	#MAXNAMLEN
 255

	)

244 
	#__√ed_size_t


	)

245 
	~<°ddef.h
>

254 #i‚de‡
__USE_FILE_OFFSET64


255 
	`sˇndú
 (c⁄° *
__ª°ri˘
 
__dú
,

256 
dúít
 ***
__ª°ri˘
 
__«mñi°
,

257 (*
__£À˘‹
Ë(c⁄° 
dúít
 *),

258 (*
__cmp
Ë(c⁄° 
dúít
 **,

259 c⁄° 
dúít
 **))

260 
	`__n⁄nuŒ
 ((1, 2));

262 #ifde‡
__REDIRECT


263 
	`__REDIRECT
 (
sˇndú
,

264 (c⁄° *
__ª°ri˘
 
__dú
,

265 
dúít
 ***
__ª°ri˘
 
__«mñi°
,

266 (*
__£À˘‹
Ë(c⁄° 
dúít
 *),

267 (*
__cmp
Ë(c⁄° 
dúít
 **,

268 c⁄° 
dúít
 **)),

269 
sˇndú64
Ë
	`__n⁄nuŒ
 ((1, 2));

271 
	#sˇndú
 
sˇndú64


	)

275 #i‡
deföed
 
__USE_GNU
 && deföed 
__USE_LARGEFILE64


278 
	`sˇndú64
 (c⁄° *
__ª°ri˘
 
__dú
,

279 
dúít64
 ***
__ª°ri˘
 
__«mñi°
,

280 (*
__£À˘‹
Ë(c⁄° 
dúít64
 *),

281 (*
__cmp
Ë(c⁄° 
dúít64
 **,

282 c⁄° 
dúít64
 **))

283 
	`__n⁄nuŒ
 ((1, 2));

286 #ifde‡
__USE_GNU


292 #i‚de‡
__USE_FILE_OFFSET64


293 
	`sˇndú©
 (
__dfd
, c⁄° *
__ª°ri˘
 
__dú
,

294 
dúít
 ***
__ª°ri˘
 
__«mñi°
,

295 (*
__£À˘‹
Ë(c⁄° 
dúít
 *),

296 (*
__cmp
Ë(c⁄° 
dúít
 **,

297 c⁄° 
dúít
 **))

298 
	`__n⁄nuŒ
 ((2, 3));

300 #ifde‡
__REDIRECT


301 
	`__REDIRECT
 (
sˇndú©
,

302 (
__dfd
, c⁄° *
__ª°ri˘
 
__dú
,

303 
dúít
 ***
__ª°ri˘
 
__«mñi°
,

304 (*
__£À˘‹
Ë(c⁄° 
dúít
 *),

305 (*
__cmp
Ë(c⁄° 
dúít
 **,

306 c⁄° 
dúít
 **)),

307 
sˇndú©64
Ë
	`__n⁄nuŒ
 ((2, 3));

309 
	#sˇndú©
 
sˇndú©64


	)

315 
	`sˇndú©64
 (
__dfd
, c⁄° *
__ª°ri˘
 
__dú
,

316 
dúít64
 ***
__ª°ri˘
 
__«mñi°
,

317 (*
__£À˘‹
Ë(c⁄° 
dúít64
 *),

318 (*
__cmp
Ë(c⁄° 
dúít64
 **,

319 c⁄° 
dúít64
 **))

320 
	`__n⁄nuŒ
 ((2, 3));

324 #i‚de‡
__USE_FILE_OFFSET64


325 
	$Æphas‹t
 (c⁄° 
dúít
 **
__e1
,

326 c⁄° 
dúít
 **
__e2
)

327 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

329 #ifde‡
__REDIRECT


330 
	`__REDIRECT_NTH
 (
Æphas‹t
,

331 (c⁄° 
dúít
 **
__e1
,

332 c⁄° 
dúít
 **
__e2
),

333 
Æphas‹t64
Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

335 
	#Æphas‹t
 
Æphas‹t64


	)

339 #i‡
deföed
 
__USE_GNU
 && deföed 
__USE_LARGEFILE64


340 
	$Æphas‹t64
 (c⁄° 
dúít64
 **
__e1
,

341 c⁄° 
dúít64
 **
__e2
)

342 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

347 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC


352 #i‚de‡
__USE_FILE_OFFSET64


353 
__ssize_t
 
	$gëdúíåõs
 (
__fd
, *
__ª°ri˘
 
__buf
,

354 
size_t
 
__nbyãs
,

355 
__off_t
 *
__ª°ri˘
 
__ba£p
)

356 
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

358 #ifde‡
__REDIRECT


359 
__ssize_t
 
	`__REDIRECT_NTH
 (
gëdúíåõs
,

360 (
__fd
, *
__ª°ri˘
 
__buf
,

361 
size_t
 
__nbyãs
,

362 
__off64_t
 *
__ª°ri˘
 
__ba£p
),

363 
gëdúíåõs64
Ë
	`__n⁄nuŒ
 ((2, 4));

365 
	#gëdúíåõs
 
gëdúíåõs64


	)

369 #ifde‡
__USE_LARGEFILE64


370 
__ssize_t
 
	$gëdúíåõs64
 (
__fd
, *
__ª°ri˘
 
__buf
,

371 
size_t
 
__nbyãs
,

372 
__off64_t
 *
__ª°ri˘
 
__ba£p
)

373 
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

377 #ifde‡
__USE_GNU


379 #i‚de‡
__USE_FILE_OFFSET64


380 
	$vîsi⁄s‹t
 (c⁄° 
dúít
 **
__e1
,

381 c⁄° 
dúít
 **
__e2
)

382 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

384 #ifde‡
__REDIRECT


385 
	`__REDIRECT_NTH
 (
vîsi⁄s‹t
,

386 (c⁄° 
dúít
 **
__e1
,

387 c⁄° 
dúít
 **
__e2
),

388 
vîsi⁄s‹t64
)

389 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

391 
	#vîsi⁄s‹t
 
vîsi⁄s‹t64


	)

395 #ifde‡
__USE_LARGEFILE64


396 
	$vîsi⁄s‹t64
 (c⁄° 
dúít64
 **
__e1
,

397 c⁄° 
dúít64
 **
__e2
)

398 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

402 
__END_DECLS


	@/usr/include/dlfcn.h

20 #i‚def 
_DLFCN_H


21 
	#_DLFCN_H
 1

	)

23 
	~<„©uªs.h
>

24 
	#__√ed_size_t


	)

25 
	~<°ddef.h
>

28 
	~<bôs/dlf˙.h
>

31 #ifde‡
__USE_GNU


36 
	#RTLD_NEXT
 ((*Ë-1l)

	)

41 
	#RTLD_DEFAULT
 ((*Ë0)

	)

45 
	tLmid_t
;

48 
	#LM_ID_BASE
 0

	)

49 
	#LM_ID_NEWLM
 -1

	)

53 
__BEGIN_DECLS


57 *
	$dl›í
 (c⁄° *
__fûe
, 
__mode
Ë
__THROW
;

61 
	$dl˛o£
 (*
__h™dÀ
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

65 *
	$dlsym
 (*
__ª°ri˘
 
__h™dÀ
,

66 c⁄° *
__ª°ri˘
 
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

68 #ifde‡
__USE_GNU


70 *
	$dlm›í
 (
Lmid_t
 
__nsid
, c⁄° *
__fûe
, 
__mode
Ë
__THROW
;

74 *
	$dlvsym
 (*
__ª°ri˘
 
__h™dÀ
,

75 c⁄° *
__ª°ri˘
 
__«me
,

76 c⁄° *
__ª°ri˘
 
__vîsi⁄
)

77 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

83 *
	$dÀº‹
 (Ë
__THROW
;

86 #ifde‡
__USE_GNU


91 c⁄° *
dli_‚ame
;

92 *
dli_fba£
;

93 c⁄° *
dli_¢ame
;

94 *
dli_ßddr
;

95 } 
	tDl_öfo
;

99 
	$dœddr
 (c⁄° *
__addªss
, 
Dl_öfo
 *
__öfo
)

100 
__THROW
 
	`__n⁄nuŒ
 ((2));

103 
	$dœddr1
 (c⁄° *
__addªss
, 
Dl_öfo
 *
__öfo
,

104 **
__exåa_öfo
, 
__Êags
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

112 
RTLD_DL_SYMENT
 = 1,

115 
RTLD_DL_LINKMAP
 = 2

124 
	$dlöfo
 (*
__ª°ri˘
 
__h™dÀ
,

125 
__ªque°
, *
__ª°ri˘
 
__¨g
)

126 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

132 
RTLD_DI_LMID
 = 1,

136 
RTLD_DI_LINKMAP
 = 2,

138 
RTLD_DI_CONFIGADDR
 = 3,

145 
RTLD_DI_SERINFO
 = 4,

146 
RTLD_DI_SERINFOSIZE
 = 5,

150 
RTLD_DI_ORIGIN
 = 6,

152 
RTLD_DI_PROFILENAME
 = 7,

153 
RTLD_DI_PROFILEOUT
 = 8,

158 
RTLD_DI_TLS_MODID
 = 9,

164 
RTLD_DI_TLS_DATA
 = 10,

166 
RTLD_DI_MAX
 = 10

174 *
dls_«me
;

175 
dls_Êags
;

176 } 
	tDl_£Ω©h
;

182 
size_t
 
dls_size
;

183 
dls_˙t
;

184 
Dl_£Ω©h
 
dls_£Ω©h
[1];

185 } 
	tDl_£röfo
;

189 
__END_DECLS


	@/usr/include/endian.h

18 #i‚def 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<„©uªs.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<bôs/ídün.h
>

40 #i‚de‡
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_BSD


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËLO, 
	)
HI

53 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËHI, 
	)
LO

58 #i‡
deföed
 
__USE_BSD
 && !deföed 
__ASSEMBLER__


60 
	~<bôs/byãsw≠.h
>

62 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


63 
	#htobe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

64 
	#htﬁe16
(
x
Ë(x)

	)

65 
	#be16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

66 
	#À16toh
(
x
Ë(x)

	)

68 
	#htobe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

69 
	#htﬁe32
(
x
Ë(x)

	)

70 
	#be32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

71 
	#À32toh
(
x
Ë(x)

	)

73 #i‡
__GLIBC_HAVE_LONG_LONG


74 
	#htobe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

75 
	#htﬁe64
(
x
Ë(x)

	)

76 
	#be64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

77 
	#À64toh
(
x
Ë(x)

	)

81 
	#htobe16
(
x
Ë(x)

	)

82 
	#htﬁe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

83 
	#be16toh
(
x
Ë(x)

	)

84 
	#À16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

86 
	#htobe32
(
x
Ë(x)

	)

87 
	#htﬁe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

88 
	#be32toh
(
x
Ë(x)

	)

89 
	#À32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

91 #i‡
__GLIBC_HAVE_LONG_LONG


92 
	#htobe64
(
x
Ë(x)

	)

93 
	#htﬁe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

94 
	#be64toh
(
x
Ë(x)

	)

95 
	#À64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

	@/usr/include/errno.h

22 #i‚def 
_ERRNO_H


26 #i‚def 
__√ed_Em©h


27 
	#_ERRNO_H
 1

	)

28 
	~<„©uªs.h
>

31 
	g__BEGIN_DECLS


35 
	~<bôs/î∫o.h
>

36 #unde‡
__√ed_Em©h


38 #ifdef 
_ERRNO_H


45 #i‚def 
î∫o


46 
î∫o
;

49 #ifde‡
__USE_GNU


54 *
¥ogøm_övoˇti⁄_«me
, *
¥ogøm_övoˇti⁄_sh‹t_«me
;

58 
	g__END_DECLS


66 #i‡
deföed
 
__USE_GNU
 || deföed 
__√ed_îr‹_t


67 #i‚de‡
__îr‹_t_deföed


68 
	tîr‹_t
;

69 
	#__îr‹_t_deföed
 1

	)

71 #unde‡
__√ed_îr‹_t


	@/usr/include/fcntl.h

22 #i‚def 
_FCNTL_H


23 
	#_FCNTL_H
 1

	)

25 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


31 
	~<bôs/ty≥s.h
>

35 
	~<bôs/f˙é.h
>

40 #i‚de‡
__mode_t_deföed


41 
__mode_t
 
	tmode_t
;

42 
	#__mode_t_deföed


	)

45 #i‚de‡
__off_t_deföed


46 #i‚de‡
__USE_FILE_OFFSET64


47 
__off_t
 
	toff_t
;

49 
__off64_t
 
	toff_t
;

51 
	#__off_t_deföed


	)

54 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


55 
__off64_t
 
	toff64_t
;

56 
	#__off64_t_deföed


	)

59 #i‚de‡
__pid_t_deföed


60 
__pid_t
 
	tpid_t
;

61 
	#__pid_t_deföed


	)

65 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


66 
	#__√ed_time•ec


	)

67 
	~<time.h
>

68 
	~<bôs/°©.h
>

70 
	#S_IFMT
 
__S_IFMT


	)

71 
	#S_IFDIR
 
__S_IFDIR


	)

72 
	#S_IFCHR
 
__S_IFCHR


	)

73 
	#S_IFBLK
 
__S_IFBLK


	)

74 
	#S_IFREG
 
__S_IFREG


	)

75 #ifde‡
__S_IFIFO


76 
	#S_IFIFO
 
__S_IFIFO


	)

78 #ifde‡
__S_IFLNK


79 
	#S_IFLNK
 
__S_IFLNK


	)

81 #i‡(
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8
Ë&& deföed 
__S_IFSOCK


82 
	#S_IFSOCK
 
__S_IFSOCK


	)

87 
	#S_ISUID
 
__S_ISUID


	)

88 
	#S_ISGID
 
__S_ISGID


	)

90 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


92 
	#S_ISVTX
 
__S_ISVTX


	)

95 
	#S_IRUSR
 
__S_IREAD


	)

96 
	#S_IWUSR
 
__S_IWRITE


	)

97 
	#S_IXUSR
 
__S_IEXEC


	)

99 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

101 
	#S_IRGRP
 (
S_IRUSR
 >> 3Ë

	)

102 
	#S_IWGRP
 (
S_IWUSR
 >> 3Ë

	)

103 
	#S_IXGRP
 (
S_IXUSR
 >> 3Ë

	)

105 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

107 
	#S_IROTH
 (
S_IRGRP
 >> 3Ë

	)

108 
	#S_IWOTH
 (
S_IWGRP
 >> 3Ë

	)

109 
	#S_IXOTH
 (
S_IXGRP
 >> 3Ë

	)

111 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

114 #ifdef 
__USE_MISC


115 #i‚de‡
R_OK


118 
	#R_OK
 4

	)

119 
	#W_OK
 2

	)

120 
	#X_OK
 1

	)

121 
	#F_OK
 0

	)

126 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


127 
	#SEEK_SET
 0

	)

128 
	#SEEK_CUR
 1

	)

129 
	#SEEK_END
 2

	)

137 
f˙é
 (
__fd
, 
__cmd
, ...);

145 #i‚de‡
__USE_FILE_OFFSET64


146 
	$›í
 (c⁄° *
__fûe
, 
__oÊag
, ...Ë
	`__n⁄nuŒ
 ((1));

148 #ifde‡
__REDIRECT


149 
	`__REDIRECT
 (
›í
, (c⁄° *
__fûe
, 
__oÊag
, ...), 
›í64
)

150 
	`__n⁄nuŒ
 ((1));

152 
	#›í
 
›í64


	)

155 #ifde‡
__USE_LARGEFILE64


156 
	$›í64
 (c⁄° *
__fûe
, 
__oÊag
, ...Ë
	`__n⁄nuŒ
 ((1));

159 #ifde‡
__USE_ATFILE


169 #i‚de‡
__USE_FILE_OFFSET64


170 
	$›í©
 (
__fd
, c⁄° *
__fûe
, 
__oÊag
, ...)

171 
	`__n⁄nuŒ
 ((2));

173 #ifde‡
__REDIRECT


174 
	`__REDIRECT
 (
›í©
, (
__fd
, c⁄° *
__fûe
, 
__oÊag
,

175 ...), 
›í©64
Ë
	`__n⁄nuŒ
 ((2));

177 
	#›í©
 
›í©64


	)

180 #ifde‡
__USE_LARGEFILE64


181 
	$›í©64
 (
__fd
, c⁄° *
__fûe
, 
__oÊag
, ...)

182 
	`__n⁄nuŒ
 ((2));

191 #i‚de‡
__USE_FILE_OFFSET64


192 
	$¸ót
 (c⁄° *
__fûe
, 
mode_t
 
__mode
Ë
	`__n⁄nuŒ
 ((1));

194 #ifde‡
__REDIRECT


195 
	`__REDIRECT
 (
¸ót
, (c⁄° *
__fûe
, 
mode_t
 
__mode
),

196 
¸ót64
Ë
	`__n⁄nuŒ
 ((1));

198 
	#¸ót
 
¸ót64


	)

201 #ifde‡
__USE_LARGEFILE64


202 
	$¸ót64
 (c⁄° *
__fûe
, 
mode_t
 
__mode
Ë
	`__n⁄nuŒ
 ((1));

205 #i‡!
deföed
 
F_LOCK
 && (deföed 
__USE_MISC
 || (deföed 
__USE_XOPEN_EXTENDED
 \

206 && !
deföed
 
__USE_POSIX
))

215 
	#F_ULOCK
 0

	)

216 
	#F_LOCK
 1

	)

217 
	#F_TLOCK
 2

	)

218 
	#F_TEST
 3

	)

220 #i‚de‡
__USE_FILE_OFFSET64


221 
	`lockf
 (
__fd
, 
__cmd
, 
off_t
 
__Àn
);

223 #ifde‡
__REDIRECT


224 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
), 
lockf64
);

226 
	#lockf
 
lockf64


	)

229 #ifde‡
__USE_LARGEFILE64


230 
	`lockf64
 (
__fd
, 
__cmd
, 
off64_t
 
__Àn
);

234 #ifde‡
__USE_XOPEN2K


237 #i‚de‡
__USE_FILE_OFFSET64


238 
	$posix_Ádvi£
 (
__fd
, 
off_t
 
__off£t
, off_à
__Àn
,

239 
__advi£
Ë
__THROW
;

241 #ifde‡
__REDIRECT_NTH


242 
	`__REDIRECT_NTH
 (
posix_Ádvi£
, (
__fd
, 
__off64_t
 
__off£t
,

243 
__off64_t
 
__Àn
, 
__advi£
),

244 
posix_Ádvi£64
);

246 
	#posix_Ádvi£
 
posix_Ádvi£64


	)

249 #ifde‡
__USE_LARGEFILE64


250 
	$posix_Ádvi£64
 (
__fd
, 
off64_t
 
__off£t
, off64_à
__Àn
,

251 
__advi£
Ë
__THROW
;

259 #i‚de‡
__USE_FILE_OFFSET64


260 
	`posix_ÁŒoˇã
 (
__fd
, 
off_t
 
__off£t
, off_à
__Àn
);

262 #ifde‡
__REDIRECT


263 
	`__REDIRECT
 (
posix_ÁŒoˇã
, (
__fd
, 
__off64_t
 
__off£t
,

264 
__off64_t
 
__Àn
),

265 
posix_ÁŒoˇã64
);

267 
	#posix_ÁŒoˇã
 
posix_ÁŒoˇã64


	)

270 #ifde‡
__USE_LARGEFILE64


271 
	`posix_ÁŒoˇã64
 (
__fd
, 
off64_t
 
__off£t
, off64_à
__Àn
);

277 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄
 \

278 && 
deföed
 
__va_¨g_∑ck_Àn


279 
	~<bôs/f˙é2.h
>

282 
__END_DECLS


	@/usr/include/getopt.h

20 #i‚de‡
_GETOPT_H


22 #i‚de‡
__√ed_gë›t


23 
	#_GETOPT_H
 1

	)

33 #i‡!
deföed
 
__GNU_LIBRARY__


34 
	~<˘y≥.h
>

37 #i‚de‡
__THROW


38 #i‚de‡
__GNUC_PREREQ


39 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë(0)

	)

41 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,8)

42 
	#__THROW
 
	`throw
 ()

	)

44 
	#__THROW


	)

48 #ifdef 
__˝lu•lus


58 *
›èrg
;

72 
›töd
;

77 
›ãº
;

81 
›t›t
;

83 #i‚de‡
__√ed_gë›t


105 
	s›ti⁄


107 c⁄° *
	g«me
;

110 
	ghas_¨g
;

111 *
	gÊag
;

112 
	gvÆ
;

117 
	#no_¨gumít
 0

	)

118 
	#ªquúed_¨gumít
 1

	)

119 
	#›ti⁄Æ_¨gumít
 2

	)

147 #ifde‡
__GNU_LIBRARY__


151 
gë›t
 (
___¨gc
, *c⁄° *
___¨gv
, c⁄° *
__sh‹t›ts
)

152 
__THROW
;

154 #i‡
deföed
 
__√ed_gë›t
 && deföed 
__USE_POSIX2
 \

155 && !
deföed
 
	g__USE_POSIX_IMPLICITLY
 && !deföed 
	g__USE_GNU


159 #ifde‡
__REDIRECT


160 
__REDIRECT_NTH
 (
gë›t
, (
___¨gc
, *c⁄° *
___¨gv
,

161 c⁄° *
__sh‹t›ts
),

162 
__posix_gë›t
);

164 
__posix_gë›t
 (
___¨gc
, *c⁄° *
___¨gv
,

165 c⁄° *
__sh‹t›ts
Ë
__THROW
;

166 
	#gë›t
 
__posix_gë›t


	)

170 
gë›t
 ();

173 #i‚de‡
__√ed_gë›t


174 
gë›t_l⁄g
 (
___¨gc
, *c⁄° *
___¨gv
,

175 c⁄° *
__sh‹t›ts
,

176 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
)

177 
__THROW
;

178 
gë›t_l⁄g_⁄ly
 (
___¨gc
, *c⁄° *
___¨gv
,

179 c⁄° *
__sh‹t›ts
,

180 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
)

181 
__THROW
;

185 #ifdef 
__˝lu•lus


190 #unde‡
__√ed_gë›t


	@/usr/include/inttypes.h

22 #i‚de‡
_INTTYPES_H


23 
	#_INTTYPES_H
 1

	)

25 
	~<„©uªs.h
>

27 
	~<°döt.h
>

30 #i‚de‡
____gwch¨_t_deföed


31 #ifde‡
__˝lu•lus


32 
	#__gwch¨_t
 
wch¨_t


	)

33 #ñi‡
deföed
 
__WCHAR_TYPE__


34 
__WCHAR_TYPE__
 
	t__gwch¨_t
;

36 
	#__√ed_wch¨_t


	)

37 
	~<°ddef.h
>

38 
wch¨_t
 
	t__gwch¨_t
;

40 
	#____gwch¨_t_deföed
 1

	)

46 #i‡!
deföed
 
__˝lu•lus
 || deföed 
__STDC_FORMAT_MACROS


48 #i‡
__WORDSIZE
 == 64

49 
	#__PRI64_PREFIX
 "l"

	)

50 
	#__PRIPTR_PREFIX
 "l"

	)

52 
	#__PRI64_PREFIX
 "Œ"

	)

53 
	#__PRIPTR_PREFIX


	)

59 
	#PRId8
 "d"

	)

60 
	#PRId16
 "d"

	)

61 
	#PRId32
 "d"

	)

62 
	#PRId64
 
__PRI64_PREFIX
 "d"

	)

64 
	#PRIdLEAST8
 "d"

	)

65 
	#PRIdLEAST16
 "d"

	)

66 
	#PRIdLEAST32
 "d"

	)

67 
	#PRIdLEAST64
 
__PRI64_PREFIX
 "d"

	)

69 
	#PRIdFAST8
 "d"

	)

70 
	#PRIdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

71 
	#PRIdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

72 
	#PRIdFAST64
 
__PRI64_PREFIX
 "d"

	)

75 
	#PRIi8
 "i"

	)

76 
	#PRIi16
 "i"

	)

77 
	#PRIi32
 "i"

	)

78 
	#PRIi64
 
__PRI64_PREFIX
 "i"

	)

80 
	#PRIiLEAST8
 "i"

	)

81 
	#PRIiLEAST16
 "i"

	)

82 
	#PRIiLEAST32
 "i"

	)

83 
	#PRIiLEAST64
 
__PRI64_PREFIX
 "i"

	)

85 
	#PRIiFAST8
 "i"

	)

86 
	#PRIiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

87 
	#PRIiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

88 
	#PRIiFAST64
 
__PRI64_PREFIX
 "i"

	)

91 
	#PRIo8
 "o"

	)

92 
	#PRIo16
 "o"

	)

93 
	#PRIo32
 "o"

	)

94 
	#PRIo64
 
__PRI64_PREFIX
 "o"

	)

96 
	#PRIoLEAST8
 "o"

	)

97 
	#PRIoLEAST16
 "o"

	)

98 
	#PRIoLEAST32
 "o"

	)

99 
	#PRIoLEAST64
 
__PRI64_PREFIX
 "o"

	)

101 
	#PRIoFAST8
 "o"

	)

102 
	#PRIoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

103 
	#PRIoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

104 
	#PRIoFAST64
 
__PRI64_PREFIX
 "o"

	)

107 
	#PRIu8
 "u"

	)

108 
	#PRIu16
 "u"

	)

109 
	#PRIu32
 "u"

	)

110 
	#PRIu64
 
__PRI64_PREFIX
 "u"

	)

112 
	#PRIuLEAST8
 "u"

	)

113 
	#PRIuLEAST16
 "u"

	)

114 
	#PRIuLEAST32
 "u"

	)

115 
	#PRIuLEAST64
 
__PRI64_PREFIX
 "u"

	)

117 
	#PRIuFAST8
 "u"

	)

118 
	#PRIuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

119 
	#PRIuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

120 
	#PRIuFAST64
 
__PRI64_PREFIX
 "u"

	)

123 
	#PRIx8
 "x"

	)

124 
	#PRIx16
 "x"

	)

125 
	#PRIx32
 "x"

	)

126 
	#PRIx64
 
__PRI64_PREFIX
 "x"

	)

128 
	#PRIxLEAST8
 "x"

	)

129 
	#PRIxLEAST16
 "x"

	)

130 
	#PRIxLEAST32
 "x"

	)

131 
	#PRIxLEAST64
 
__PRI64_PREFIX
 "x"

	)

133 
	#PRIxFAST8
 "x"

	)

134 
	#PRIxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

135 
	#PRIxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

136 
	#PRIxFAST64
 
__PRI64_PREFIX
 "x"

	)

139 
	#PRIX8
 "X"

	)

140 
	#PRIX16
 "X"

	)

141 
	#PRIX32
 "X"

	)

142 
	#PRIX64
 
__PRI64_PREFIX
 "X"

	)

144 
	#PRIXLEAST8
 "X"

	)

145 
	#PRIXLEAST16
 "X"

	)

146 
	#PRIXLEAST32
 "X"

	)

147 
	#PRIXLEAST64
 
__PRI64_PREFIX
 "X"

	)

149 
	#PRIXFAST8
 "X"

	)

150 
	#PRIXFAST16
 
__PRIPTR_PREFIX
 "X"

	)

151 
	#PRIXFAST32
 
__PRIPTR_PREFIX
 "X"

	)

152 
	#PRIXFAST64
 
__PRI64_PREFIX
 "X"

	)

156 
	#PRIdMAX
 
__PRI64_PREFIX
 "d"

	)

157 
	#PRIiMAX
 
__PRI64_PREFIX
 "i"

	)

158 
	#PRIoMAX
 
__PRI64_PREFIX
 "o"

	)

159 
	#PRIuMAX
 
__PRI64_PREFIX
 "u"

	)

160 
	#PRIxMAX
 
__PRI64_PREFIX
 "x"

	)

161 
	#PRIXMAX
 
__PRI64_PREFIX
 "X"

	)

165 
	#PRIdPTR
 
__PRIPTR_PREFIX
 "d"

	)

166 
	#PRIiPTR
 
__PRIPTR_PREFIX
 "i"

	)

167 
	#PRIoPTR
 
__PRIPTR_PREFIX
 "o"

	)

168 
	#PRIuPTR
 
__PRIPTR_PREFIX
 "u"

	)

169 
	#PRIxPTR
 
__PRIPTR_PREFIX
 "x"

	)

170 
	#PRIXPTR
 
__PRIPTR_PREFIX
 "X"

	)

176 
	#SCNd8
 "hhd"

	)

177 
	#SCNd16
 "hd"

	)

178 
	#SCNd32
 "d"

	)

179 
	#SCNd64
 
__PRI64_PREFIX
 "d"

	)

181 
	#SCNdLEAST8
 "hhd"

	)

182 
	#SCNdLEAST16
 "hd"

	)

183 
	#SCNdLEAST32
 "d"

	)

184 
	#SCNdLEAST64
 
__PRI64_PREFIX
 "d"

	)

186 
	#SCNdFAST8
 "hhd"

	)

187 
	#SCNdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

188 
	#SCNdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

189 
	#SCNdFAST64
 
__PRI64_PREFIX
 "d"

	)

192 
	#SCNi8
 "hhi"

	)

193 
	#SCNi16
 "hi"

	)

194 
	#SCNi32
 "i"

	)

195 
	#SCNi64
 
__PRI64_PREFIX
 "i"

	)

197 
	#SCNiLEAST8
 "hhi"

	)

198 
	#SCNiLEAST16
 "hi"

	)

199 
	#SCNiLEAST32
 "i"

	)

200 
	#SCNiLEAST64
 
__PRI64_PREFIX
 "i"

	)

202 
	#SCNiFAST8
 "hhi"

	)

203 
	#SCNiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

204 
	#SCNiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

205 
	#SCNiFAST64
 
__PRI64_PREFIX
 "i"

	)

208 
	#SCNu8
 "hhu"

	)

209 
	#SCNu16
 "hu"

	)

210 
	#SCNu32
 "u"

	)

211 
	#SCNu64
 
__PRI64_PREFIX
 "u"

	)

213 
	#SCNuLEAST8
 "hhu"

	)

214 
	#SCNuLEAST16
 "hu"

	)

215 
	#SCNuLEAST32
 "u"

	)

216 
	#SCNuLEAST64
 
__PRI64_PREFIX
 "u"

	)

218 
	#SCNuFAST8
 "hhu"

	)

219 
	#SCNuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

220 
	#SCNuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

221 
	#SCNuFAST64
 
__PRI64_PREFIX
 "u"

	)

224 
	#SCNo8
 "hho"

	)

225 
	#SCNo16
 "ho"

	)

226 
	#SCNo32
 "o"

	)

227 
	#SCNo64
 
__PRI64_PREFIX
 "o"

	)

229 
	#SCNoLEAST8
 "hho"

	)

230 
	#SCNoLEAST16
 "ho"

	)

231 
	#SCNoLEAST32
 "o"

	)

232 
	#SCNoLEAST64
 
__PRI64_PREFIX
 "o"

	)

234 
	#SCNoFAST8
 "hho"

	)

235 
	#SCNoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

236 
	#SCNoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

237 
	#SCNoFAST64
 
__PRI64_PREFIX
 "o"

	)

240 
	#SCNx8
 "hhx"

	)

241 
	#SCNx16
 "hx"

	)

242 
	#SCNx32
 "x"

	)

243 
	#SCNx64
 
__PRI64_PREFIX
 "x"

	)

245 
	#SCNxLEAST8
 "hhx"

	)

246 
	#SCNxLEAST16
 "hx"

	)

247 
	#SCNxLEAST32
 "x"

	)

248 
	#SCNxLEAST64
 
__PRI64_PREFIX
 "x"

	)

250 
	#SCNxFAST8
 "hhx"

	)

251 
	#SCNxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

252 
	#SCNxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

253 
	#SCNxFAST64
 
__PRI64_PREFIX
 "x"

	)

257 
	#SCNdMAX
 
__PRI64_PREFIX
 "d"

	)

258 
	#SCNiMAX
 
__PRI64_PREFIX
 "i"

	)

259 
	#SCNoMAX
 
__PRI64_PREFIX
 "o"

	)

260 
	#SCNuMAX
 
__PRI64_PREFIX
 "u"

	)

261 
	#SCNxMAX
 
__PRI64_PREFIX
 "x"

	)

264 
	#SCNdPTR
 
__PRIPTR_PREFIX
 "d"

	)

265 
	#SCNiPTR
 
__PRIPTR_PREFIX
 "i"

	)

266 
	#SCNoPTR
 
__PRIPTR_PREFIX
 "o"

	)

267 
	#SCNuPTR
 
__PRIPTR_PREFIX
 "u"

	)

268 
	#SCNxPTR
 
__PRIPTR_PREFIX
 "x"

	)

273 
	g__BEGIN_DECLS


275 #i‡
__WORDSIZE
 == 64

280 
	mquŸ
;

281 
	mªm
;

282 } 
	timaxdiv_t
;

289 
	mquŸ
;

290 
	mªm
;

291 } 
	timaxdiv_t
;

297 
ötmax_t
 
	$imaxabs
 (
ötmax_t
 
__n
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

300 
imaxdiv_t
 
	$imaxdiv
 (
ötmax_t
 
__numî
, i¡max_à
__díom
)

301 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

304 
ötmax_t
 
	$°πoimax
 (c⁄° *
__ª°ri˘
 
__≈å
,

305 **
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

308 
uötmax_t
 
	$°πoumax
 (c⁄° *
__ª°ri˘
 
__≈å
,

309 ** 
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

312 
ötmax_t
 
	$wc°oimax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
__≈å
,

313 
__gwch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

314 
__THROW
;

317 
uötmax_t
 
	$wc°oumax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
__≈å
,

318 
__gwch¨_t
 ** 
__ª°ri˘
 
__íd±r
, 
__ba£
)

319 
__THROW
;

321 #ifde‡
__USE_EXTERN_INLINES


323 #i‡
__WORDSIZE
 == 64

325 
	$__°πﬁ_öã∫Æ
 (c⁄° *
__ª°ri˘
 
__≈å
,

326 **
__ª°ri˘
 
__íd±r
,

327 
__ba£
, 
__group
)

328 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

330 
__exã∫_ölöe
 
ötmax_t


331 
	`__NTH
 (
	$°πoimax
 (c⁄° *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

332 
ba£
))

334  
	`__°πﬁ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

335 
	}
}

337 
	$__°πoul_öã∫Æ
 (c⁄° *
__ª°ri˘
 
__≈å
,

338 ** 
__ª°ri˘
 
__íd±r
,

339 
__ba£
, 
__group
)

340 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

342 
__exã∫_ölöe
 
uötmax_t


343 
	`__NTH
 (
	$°πoumax
 (c⁄° *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

344 
ba£
))

346  
	`__°πoul_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

347 
	}
}

349 
	$__wc°ﬁ_öã∫Æ
 (c⁄° 
__gwch¨_t
 * 
__ª°ri˘
 
__≈å
,

350 
__gwch¨_t
 **
__ª°ri˘
 
__íd±r
,

351 
__ba£
, 
__group
)

352 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

354 
__exã∫_ölöe
 
ötmax_t


355 
	`__NTH
 (
	$wc°oimax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

356 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

358  
	`__wc°ﬁ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

359 
	}
}

361 
	$__wc°oul_öã∫Æ
 (c⁄° 
__gwch¨_t
 *

362 
__ª°ri˘
 
__≈å
,

363 
__gwch¨_t
 **

364 
__ª°ri˘
 
__íd±r
,

365 
__ba£
, 
__group
)

366 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

368 
__exã∫_ölöe
 
uötmax_t


369 
	`__NTH
 (
	$wc°oumax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

370 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

372  
	`__wc°oul_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

373 
	}
}

377 
__exãnsi⁄__


378 
	$__°πﬁl_öã∫Æ
 (c⁄° *
__ª°ri˘
 
__≈å
,

379 **
__ª°ri˘
 
__íd±r
,

380 
__ba£
, 
__group
)

381 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

383 
__exã∫_ölöe
 
ötmax_t


384 
	`__NTH
 (
	$°πoimax
 (c⁄° *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

385 
ba£
))

387  
	`__°πﬁl_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

388 
	}
}

390 
__exãnsi⁄__


391 
	$__°πouŒ_öã∫Æ
 (const *

392 
__ª°ri˘
 
__≈å
,

394 
__ª°ri˘
 
__íd±r
,

395 
__ba£
,

396 
__group
)

397 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

399 
__exã∫_ölöe
 
uötmax_t


400 
	`__NTH
 (
	$°πoumax
 (c⁄° *
__ª°ri˘
 
≈å
, **__ª°ri˘ 
íd±r
,

401 
ba£
))

403  
	`__°πouŒ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

404 
	}
}

406 
__exãnsi⁄__


407 
	$__wc°ﬁl_öã∫Æ
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
__≈å
,

408 
__gwch¨_t
 **
__ª°ri˘
 
__íd±r
,

409 
__ba£
, 
__group
)

410 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

412 
__exã∫_ölöe
 
ötmax_t


413 
	`__NTH
 (
	$wc°oimax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

414 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

416  
	`__wc°ﬁl_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

417 
	}
}

420 
__exãnsi⁄__


421 
	$__wc°ouŒ_öã∫Æ
 (c⁄° 
__gwch¨_t
 *

422 
__ª°ri˘
 
__≈å
,

423 
__gwch¨_t
 **

424 
__ª°ri˘
 
__íd±r
,

425 
__ba£
,

426 
__group
)

427 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

429 
__exã∫_ölöe
 
uötmax_t


430 
	`__NTH
 (
	$wc°oumax
 (c⁄° 
__gwch¨_t
 *
__ª°ri˘
 
≈å
,

431 
__gwch¨_t
 **
__ª°ri˘
 
íd±r
, 
ba£
))

433  
	`__wc°ouŒ_öã∫Æ
 (
≈å
, 
íd±r
, 
ba£
, 0);

434 
	}
}

439 
	g__END_DECLS


	@/usr/include/limits.h

23 #i‚de‡
_LIBC_LIMITS_H_


24 
	#_LIBC_LIMITS_H_
 1

	)

26 
	~<„©uªs.h
>

32 
	#MB_LEN_MAX
 16

	)

37 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2

42 #i‚de‡
_LIMITS_H


43 
	#_LIMITS_H
 1

	)

45 
	~<bôs/w‹dsize.h
>

54 
	#CHAR_BIT
 8

	)

57 
	#SCHAR_MIN
 (-128)

	)

58 
	#SCHAR_MAX
 127

	)

61 
	#UCHAR_MAX
 255

	)

64 #ifde‡
__CHAR_UNSIGNED__


65 
	#CHAR_MIN
 0

	)

66 
	#CHAR_MAX
 
UCHAR_MAX


	)

68 
	#CHAR_MIN
 
SCHAR_MIN


	)

69 
	#CHAR_MAX
 
SCHAR_MAX


	)

73 
	#SHRT_MIN
 (-32768)

	)

74 
	#SHRT_MAX
 32767

	)

77 
	#USHRT_MAX
 65535

	)

80 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

81 
	#INT_MAX
 2147483647

	)

84 
	#UINT_MAX
 4294967295U

	)

87 #i‡
__WORDSIZE
 == 64

88 
	#LONG_MAX
 9223372036854775807L

	)

90 
	#LONG_MAX
 2147483647L

	)

92 
	#LONG_MIN
 (-
LONG_MAX
 - 1L)

	)

95 #i‡
__WORDSIZE
 == 64

96 
	#ULONG_MAX
 18446744073709551615UL

	)

98 
	#ULONG_MAX
 4294967295UL

	)

101 #ifde‡
__USE_ISOC99


104 
	#LLONG_MAX
 9223372036854775807LL

	)

105 
	#LLONG_MIN
 (-
LLONG_MAX
 - 1LL)

	)

108 
	#ULLONG_MAX
 18446744073709551615ULL

	)

122 #i‡
deföed
 
__GNUC__
 && !deföed 
_GCC_LIMITS_H_


124 #ö˛ude_√xà<
limôs
.
h
>

130 #i‡
deföed
 
__USE_ISOC99
 && deföed 
__GNUC__


131 #i‚de‡
LLONG_MIN


132 
	#LLONG_MIN
 (-
LLONG_MAX
-1)

	)

134 #i‚de‡
LLONG_MAX


135 
	#LLONG_MAX
 
__LONG_LONG_MAX__


	)

137 #i‚de‡
ULLONG_MAX


138 
	#ULLONG_MAX
 (
LLONG_MAX
 * 2ULL + 1)

	)

142 #ifdef 
__USE_POSIX


144 
	~<bôs/posix1_lim.h
>

147 #ifdef 
__USE_POSIX2


148 
	~<bôs/posix2_lim.h
>

151 #ifdef 
__USE_XOPEN


152 
	~<bôs/x›í_lim.h
>

	@/usr/include/linux/ethtool.h

13 #i‚de‡
_LINUX_ETHTOOL_H


14 
	#_LINUX_ETHTOOL_H


	)

16 
	~<löux/ty≥s.h
>

17 
	~<löux/if_ëhî.h
>

20 
	sëhtoﬁ_cmd
 {

21 
__u32
 
	mcmd
;

22 
__u32
 
	msuµ‹ãd
;

23 
__u32
 
	madvîtisög
;

24 
__u16
 
	m•ìd
;

28 
__u8
 
	mdu∂ex
;

29 
__u8
 
	mp‹t
;

30 
__u8
 
	mphy_addªss
;

34 
__u8
 
	må™s˚ivî
;

35 
__u8
 
	maut⁄eg
;

36 
__u8
 
	mmdio_suµ‹t
;

39 
__u32
 
	mmaxtxpkt
;

40 
__u32
 
	mmaxrxpkt
;

41 
__u16
 
	m•ìd_hi
;

45 
__u8
 
	mëh_ç_mdix
;

46 
__u8
 
	mëh_ç_mdix_˘æ
;

49 
__u32
 
	mÕ_advîtisög
;

50 
__u32
 
	mª£rved
[2];

53 
__ölöe__
 
	$ëhtoﬁ_cmd_•ìd_£t
(
ëhtoﬁ_cmd
 *
ï
,

54 
__u32
 
•ìd
)

57 
ï
->
•ìd
 = (
__u16
)speed;

58 
ï
->
•ìd_hi
 = (
__u16
)(
•ìd
 >> 16);

59 
	}
}

61 
__ölöe__
 
__u32
 
	$ëhtoﬁ_cmd_•ìd
(c⁄° 
ëhtoﬁ_cmd
 *
ï
)

63  (
ï
->
•ìd_hi
 << 16Ë|Ép->
•ìd
;

64 
	}
}

71 
	#ETH_MDIO_SUPPORTS_C22
 1

	)

78 
	#ETH_MDIO_SUPPORTS_C45
 2

	)

80 
	#ETHTOOL_FWVERS_LEN
 32

	)

81 
	#ETHTOOL_BUSINFO_LEN
 32

	)

83 
	sëhtoﬁ_drvöfo
 {

84 
__u32
 
	mcmd
;

85 
	mdrivî
[32];

86 
	mvîsi⁄
[32];

87 
	mfw_vîsi⁄
[
ETHTOOL_FWVERS_LEN
];

88 
	mbus_öfo
[
ETHTOOL_BUSINFO_LEN
];

90 
	mª£rved1
[32];

91 
	mª£rved2
[12];

99 
__u32
 
	mn_¥iv_Êags
;

100 
__u32
 
	mn_°©s
;

101 
__u32
 
	mã°öfo_Àn
;

102 
__u32
 
	mìdump_Àn
;

103 
__u32
 
	mªgdump_Àn
;

106 
	#SOPASS_MAX
 6

	)

108 
	sëhtoﬁ_wﬁöfo
 {

109 
__u32
 
	mcmd
;

110 
__u32
 
	msuµ‹ãd
;

111 
__u32
 
	mwﬁ›ts
;

112 
__u8
 
	ms›ass
[
SOPASS_MAX
];

116 
	sëhtoﬁ_vÆue
 {

117 
__u32
 
	mcmd
;

118 
__u32
 
	md©a
;

122 
	sëhtoﬁ_ªgs
 {

123 
__u32
 
	mcmd
;

124 
__u32
 
	mvîsi⁄
;

125 
__u32
 
	mÀn
;

126 
__u8
 
	md©a
[0];

130 
	sëhtoﬁ_ì¥om
 {

131 
__u32
 
	mcmd
;

132 
__u32
 
	mmagic
;

133 
__u32
 
	moff£t
;

134 
__u32
 
	mÀn
;

135 
__u8
 
	md©a
[0];

155 
	sëhtoﬁ_ìe
 {

156 
__u32
 
	mcmd
;

157 
__u32
 
	msuµ‹ãd
;

158 
__u32
 
	madvîti£d
;

159 
__u32
 
	mÕ_advîti£d
;

160 
__u32
 
	mìe_a˘ive
;

161 
__u32
 
	mìe_íabÀd
;

162 
__u32
 
	mtx_Õi_íabÀd
;

163 
__u32
 
	mtx_Õi_timî
;

164 
__u32
 
	mª£rved
[2];

177 
	sëhtoﬁ_modöfo
 {

178 
__u32
 
	mcmd
;

179 
__u32
 
	mty≥
;

180 
__u32
 
	mì¥om_Àn
;

181 
__u32
 
	mª£rved
[8];

256 
	sëhtoﬁ_cﬂÀs˚
 {

257 
__u32
 
	mcmd
;

258 
__u32
 
	mrx_cﬂÀs˚_u£cs
;

259 
__u32
 
	mrx_max_cﬂÀs˚d_‰ames
;

260 
__u32
 
	mrx_cﬂÀs˚_u£cs_úq
;

261 
__u32
 
	mrx_max_cﬂÀs˚d_‰ames_úq
;

262 
__u32
 
	mtx_cﬂÀs˚_u£cs
;

263 
__u32
 
	mtx_max_cﬂÀs˚d_‰ames
;

264 
__u32
 
	mtx_cﬂÀs˚_u£cs_úq
;

265 
__u32
 
	mtx_max_cﬂÀs˚d_‰ames_úq
;

266 
__u32
 
	m°©s_block_cﬂÀs˚_u£cs
;

267 
__u32
 
	mu£_ad≠tive_rx_cﬂÀs˚
;

268 
__u32
 
	mu£_ad≠tive_tx_cﬂÀs˚
;

269 
__u32
 
	mpkt_øã_low
;

270 
__u32
 
	mrx_cﬂÀs˚_u£cs_low
;

271 
__u32
 
	mrx_max_cﬂÀs˚d_‰ames_low
;

272 
__u32
 
	mtx_cﬂÀs˚_u£cs_low
;

273 
__u32
 
	mtx_max_cﬂÀs˚d_‰ames_low
;

274 
__u32
 
	mpkt_øã_high
;

275 
__u32
 
	mrx_cﬂÀs˚_u£cs_high
;

276 
__u32
 
	mrx_max_cﬂÀs˚d_‰ames_high
;

277 
__u32
 
	mtx_cﬂÀs˚_u£cs_high
;

278 
__u32
 
	mtx_max_cﬂÀs˚d_‰ames_high
;

279 
__u32
 
	møã_ßm∂e_öãrvÆ
;

283 
	sëhtoﬁ_rög∑øm
 {

284 
__u32
 
	mcmd
;

290 
__u32
 
	mrx_max_≥ndög
;

291 
__u32
 
	mrx_möi_max_≥ndög
;

292 
__u32
 
	mrx_jumbo_max_≥ndög
;

293 
__u32
 
	mtx_max_≥ndög
;

298 
__u32
 
	mrx_≥ndög
;

299 
__u32
 
	mrx_möi_≥ndög
;

300 
__u32
 
	mrx_jumbo_≥ndög
;

301 
__u32
 
	mtx_≥ndög
;

320 
	sëhtoﬁ_ch™√ls
 {

321 
__u32
 
	mcmd
;

322 
__u32
 
	mmax_rx
;

323 
__u32
 
	mmax_tx
;

324 
__u32
 
	mmax_Ÿhî
;

325 
__u32
 
	mmax_comböed
;

326 
__u32
 
	mrx_cou¡
;

327 
__u32
 
	mtx_cou¡
;

328 
__u32
 
	mŸhî_cou¡
;

329 
__u32
 
	mcomböed_cou¡
;

333 
	sëhtoﬁ_∑u£∑øm
 {

334 
__u32
 
	mcmd
;

346 
__u32
 
	maut⁄eg
;

347 
__u32
 
	mrx_∑u£
;

348 
__u32
 
	mtx_∑u£
;

351 
	#ETH_GSTRING_LEN
 32

	)

352 
	eëhtoﬁ_°rög£t
 {

353 
	mETH_SS_TEST
 = 0,

354 
	mETH_SS_STATS
,

355 
	mETH_SS_PRIV_FLAGS
,

356 
	mETH_SS_NTUPLE_FILTERS
,

357 
	mETH_SS_FEATURES
,

361 
	sëhtoﬁ_g°rögs
 {

362 
__u32
 
	mcmd
;

363 
__u32
 
	m°rög_£t
;

364 
__u32
 
	mÀn
;

365 
__u8
 
	md©a
[0];

368 
	sëhtoﬁ_s£t_öfo
 {

369 
__u32
 
	mcmd
;

370 
__u32
 
	mª£rved
;

371 
__u64
 
	ms£t_mask
;

373 
__u32
 
	md©a
[0];

389 
	eëhtoﬁ_ã°_Êags
 {

390 
	mETH_TEST_FL_OFFLINE
 = (1 << 0),

391 
	mETH_TEST_FL_FAILED
 = (1 << 1),

392 
	mETH_TEST_FL_EXTERNAL_LB
 = (1 << 2),

393 
	mETH_TEST_FL_EXTERNAL_LB_DONE
 = (1 << 3),

397 
	sëhtoﬁ_ã°
 {

398 
__u32
 
	mcmd
;

399 
__u32
 
	mÊags
;

400 
__u32
 
	mª£rved
;

401 
__u32
 
	mÀn
;

402 
__u64
 
	md©a
[0];

406 
	sëhtoﬁ_°©s
 {

407 
__u32
 
	mcmd
;

408 
__u32
 
	mn_°©s
;

409 
__u64
 
	md©a
[0];

412 
	sëhtoﬁ_≥rm_addr
 {

413 
__u32
 
	mcmd
;

414 
__u32
 
	msize
;

415 
__u8
 
	md©a
[0];

427 
	eëhtoﬁ_Êags
 {

428 
	mETH_FLAG_TXVLAN
 = (1 << 7),

429 
	mETH_FLAG_RXVLAN
 = (1 << 8),

430 
	mETH_FLAG_LRO
 = (1 << 15),

431 
	mETH_FLAG_NTUPLE
 = (1 << 27),

432 
	mETH_FLAG_RXHASH
 = (1 << 28),

451 
	sëhtoﬁ_t˝ù4_•ec
 {

452 
__be32
 
	mù4§c
;

453 
__be32
 
	mù4d°
;

454 
__be16
 
	mp§c
;

455 
__be16
 
	mpd°
;

456 
__u8
 
	mtos
;

468 
	sëhtoﬁ_ah_e•ù4_•ec
 {

469 
__be32
 
	mù4§c
;

470 
__be32
 
	mù4d°
;

471 
__be32
 
	m•i
;

472 
__u8
 
	mtos
;

475 
	#ETH_RX_NFC_IP4
 1

	)

486 
	sëhtoﬁ_u§ù4_•ec
 {

487 
__be32
 
	mù4§c
;

488 
__be32
 
	mù4d°
;

489 
__be32
 
	ml4_4_byãs
;

490 
__u8
 
	mtos
;

491 
__u8
 
	mù_vî
;

492 
__u8
 
	m¥Ÿo
;

495 
	uëhtoﬁ_Êow_uni⁄
 {

496 
ëhtoﬁ_t˝ù4_•ec
 
	mt˝_ù4_•ec
;

497 
ëhtoﬁ_t˝ù4_•ec
 
	mudp_ù4_•ec
;

498 
ëhtoﬁ_t˝ù4_•ec
 
	ms˘p_ù4_•ec
;

499 
ëhtoﬁ_ah_e•ù4_•ec
 
	mah_ù4_•ec
;

500 
ëhtoﬁ_ah_e•ù4_•ec
 
	me•_ù4_•ec
;

501 
ëhtoﬁ_u§ù4_•ec
 
	mu§_ù4_•ec
;

502 
ëhhdr
 
	mëhî_•ec
;

503 
__u8
 
	mhd©a
[52];

517 
	sëhtoﬁ_Êow_ext
 {

518 
__u8
 
	m∑ddög
[2];

519 
	mh_de°
[
ETH_ALEN
];

520 
__be16
 
	mvœn_ëy≥
;

521 
__be16
 
	mvœn_tci
;

522 
__be32
 
	md©a
[2];

541 
	sëhtoﬁ_rx_Êow_•ec
 {

542 
__u32
 
	mÊow_ty≥
;

543 
ëhtoﬁ_Êow_uni⁄
 
	mh_u
;

544 
ëhtoﬁ_Êow_ext
 
	mh_ext
;

545 
ëhtoﬁ_Êow_uni⁄
 
	mm_u
;

546 
ëhtoﬁ_Êow_ext
 
	mm_ext
;

547 
__u64
 
	mrög_cookõ
;

548 
__u32
 
	mloˇti⁄
;

603 
	sëhtoﬁ_rxnfc
 {

604 
__u32
 
	mcmd
;

605 
__u32
 
	mÊow_ty≥
;

606 
__u64
 
	md©a
;

607 
ëhtoﬁ_rx_Êow_•ec
 
	mfs
;

608 
__u32
 
	mruÀ_˙t
;

609 
__u32
 
	mruÀ_locs
[0];

626 
	sëhtoﬁ_rxfh_ödú
 {

627 
__u32
 
	mcmd
;

628 
__u32
 
	msize
;

629 
__u32
 
	mrög_ödex
[0];

648 
	sëhtoﬁ_rx_¡u∂e_Êow_•ec
 {

649 
__u32
 
	mÊow_ty≥
;

651 
ëhtoﬁ_t˝ù4_•ec
 
	mt˝_ù4_•ec
;

652 
ëhtoﬁ_t˝ù4_•ec
 
	mudp_ù4_•ec
;

653 
ëhtoﬁ_t˝ù4_•ec
 
	ms˘p_ù4_•ec
;

654 
ëhtoﬁ_ah_e•ù4_•ec
 
	mah_ù4_•ec
;

655 
ëhtoﬁ_ah_e•ù4_•ec
 
	me•_ù4_•ec
;

656 
ëhtoﬁ_u§ù4_•ec
 
	mu§_ù4_•ec
;

657 
ëhhdr
 
	mëhî_•ec
;

658 
__u8
 
	mhd©a
[72];

659 } 
	mh_u
, 
	mm_u
;

661 
__u16
 
	mvœn_èg
;

662 
__u16
 
	mvœn_èg_mask
;

663 
__u64
 
	md©a
;

664 
__u64
 
	md©a_mask
;

666 
__s32
 
	ma˘i⁄
;

667 
	#ETHTOOL_RXNTUPLE_ACTION_DROP
 (-1Ë

	)

668 
	#ETHTOOL_RXNTUPLE_ACTION_CLEAR
 (-2Ë

	)

676 
	sëhtoﬁ_rx_¡u∂e
 {

677 
__u32
 
	mcmd
;

678 
ëhtoﬁ_rx_¡u∂e_Êow_•ec
 
	mfs
;

681 
	#ETHTOOL_FLASH_MAX_FILENAME
 128

	)

682 
	eëhtoﬁ_Êash_›_ty≥
 {

683 
	mETHTOOL_FLASH_ALL_REGIONS
 = 0,

687 
	sëhtoﬁ_Êash
 {

688 
__u32
 
	mcmd
;

689 
__u32
 
	mªgi⁄
;

690 
	md©a
[
ETHTOOL_FLASH_MAX_FILENAME
];

708 
	#ETH_FW_DUMP_DISABLE
 0

	)

710 
	sëhtoﬁ_dump
 {

711 
__u32
 
	mcmd
;

712 
__u32
 
	mvîsi⁄
;

713 
__u32
 
	mÊag
;

714 
__u32
 
	mÀn
;

715 
__u8
 
	md©a
[0];

727 
	sëhtoﬁ_gë_„©uªs_block
 {

728 
__u32
 
	mavaûabÀ
;

729 
__u32
 
	mªque°ed
;

730 
__u32
 
	ma˘ive
;

731 
__u32
 
	m√vî_ch™ged
;

741 
	sëhtoﬁ_g„©uªs
 {

742 
__u32
 
	mcmd
;

743 
__u32
 
	msize
;

744 
ëhtoﬁ_gë_„©uªs_block
 
	m„©uªs
[0];

752 
	sëhtoﬁ_£t_„©uªs_block
 {

753 
__u32
 
	mvÆid
;

754 
__u32
 
	mªque°ed
;

763 
	sëhtoﬁ_s„©uªs
 {

764 
__u32
 
	mcmd
;

765 
__u32
 
	msize
;

766 
ëhtoﬁ_£t_„©uªs_block
 
	m„©uªs
[0];

782 
	sëhtoﬁ_ts_öfo
 {

783 
__u32
 
	mcmd
;

784 
__u32
 
	mso_time°ampög
;

785 
__s32
 
	mphc_ödex
;

786 
__u32
 
	mtx_ty≥s
;

787 
__u32
 
	mtx_ª£rved
[3];

788 
__u32
 
	mrx_fûãrs
;

789 
__u32
 
	mrx_ª£rved
[3];

817 
	eëhtoﬁ_s„©uªs_ªtvÆ_bôs
 {

818 
	mETHTOOL_F_UNSUPPORTED__BIT
,

819 
	mETHTOOL_F_WISH__BIT
,

820 
	mETHTOOL_F_COMPAT__BIT
,

823 
	#ETHTOOL_F_UNSUPPORTED
 (1 << 
ETHTOOL_F_UNSUPPORTED__BIT
)

	)

824 
	#ETHTOOL_F_WISH
 (1 << 
ETHTOOL_F_WISH__BIT
)

	)

825 
	#ETHTOOL_F_COMPAT
 (1 << 
ETHTOOL_F_COMPAT__BIT
)

	)

829 
	#ETHTOOL_GSET
 0x00000001

	)

830 
	#ETHTOOL_SSET
 0x00000002

	)

831 
	#ETHTOOL_GDRVINFO
 0x00000003

	)

832 
	#ETHTOOL_GREGS
 0x00000004

	)

833 
	#ETHTOOL_GWOL
 0x00000005

	)

834 
	#ETHTOOL_SWOL
 0x00000006

	)

835 
	#ETHTOOL_GMSGLVL
 0x00000007

	)

836 
	#ETHTOOL_SMSGLVL
 0x00000008

	)

837 
	#ETHTOOL_NWAY_RST
 0x00000009

	)

840 
	#ETHTOOL_GLINK
 0x0000000a

	)

841 
	#ETHTOOL_GEEPROM
 0x0000000b

	)

842 
	#ETHTOOL_SEEPROM
 0x0000000¯

	)

843 
	#ETHTOOL_GCOALESCE
 0x0000000ê

	)

844 
	#ETHTOOL_SCOALESCE
 0x0000000‡

	)

845 
	#ETHTOOL_GRINGPARAM
 0x00000010

	)

846 
	#ETHTOOL_SRINGPARAM
 0x00000011

	)

847 
	#ETHTOOL_GPAUSEPARAM
 0x00000012

	)

848 
	#ETHTOOL_SPAUSEPARAM
 0x00000013

	)

849 
	#ETHTOOL_GRXCSUM
 0x00000014

	)

850 
	#ETHTOOL_SRXCSUM
 0x00000015

	)

851 
	#ETHTOOL_GTXCSUM
 0x00000016

	)

852 
	#ETHTOOL_STXCSUM
 0x00000017

	)

853 
	#ETHTOOL_GSG
 0x00000018

	)

855 
	#ETHTOOL_SSG
 0x00000019

	)

857 
	#ETHTOOL_TEST
 0x0000001®

	)

858 
	#ETHTOOL_GSTRINGS
 0x0000001b

	)

859 
	#ETHTOOL_PHYS_ID
 0x0000001¯

	)

860 
	#ETHTOOL_GSTATS
 0x0000001d

	)

861 
	#ETHTOOL_GTSO
 0x0000001ê

	)

862 
	#ETHTOOL_STSO
 0x0000001‡

	)

863 
	#ETHTOOL_GPERMADDR
 0x00000020

	)

864 
	#ETHTOOL_GUFO
 0x00000021

	)

865 
	#ETHTOOL_SUFO
 0x00000022

	)

866 
	#ETHTOOL_GGSO
 0x00000023

	)

867 
	#ETHTOOL_SGSO
 0x00000024

	)

868 
	#ETHTOOL_GFLAGS
 0x00000025

	)

869 
	#ETHTOOL_SFLAGS
 0x00000026

	)

870 
	#ETHTOOL_GPFLAGS
 0x00000027

	)

871 
	#ETHTOOL_SPFLAGS
 0x00000028

	)

873 
	#ETHTOOL_GRXFH
 0x00000029

	)

874 
	#ETHTOOL_SRXFH
 0x0000002®

	)

875 
	#ETHTOOL_GGRO
 0x0000002b

	)

876 
	#ETHTOOL_SGRO
 0x0000002¯

	)

877 
	#ETHTOOL_GRXRINGS
 0x0000002d

	)

878 
	#ETHTOOL_GRXCLSRLCNT
 0x0000002ê

	)

879 
	#ETHTOOL_GRXCLSRULE
 0x0000002‡

	)

880 
	#ETHTOOL_GRXCLSRLALL
 0x00000030

	)

881 
	#ETHTOOL_SRXCLSRLDEL
 0x00000031

	)

882 
	#ETHTOOL_SRXCLSRLINS
 0x00000032

	)

883 
	#ETHTOOL_FLASHDEV
 0x00000033

	)

884 
	#ETHTOOL_RESET
 0x00000034

	)

885 
	#ETHTOOL_SRXNTUPLE
 0x00000035

	)

886 
	#ETHTOOL_GRXNTUPLE
 0x00000036

	)

887 
	#ETHTOOL_GSSET_INFO
 0x00000037

	)

888 
	#ETHTOOL_GRXFHINDIR
 0x00000038

	)

889 
	#ETHTOOL_SRXFHINDIR
 0x00000039

	)

891 
	#ETHTOOL_GFEATURES
 0x0000003®

	)

892 
	#ETHTOOL_SFEATURES
 0x0000003b

	)

893 
	#ETHTOOL_GCHANNELS
 0x0000003¯

	)

894 
	#ETHTOOL_SCHANNELS
 0x0000003d

	)

895 
	#ETHTOOL_SET_DUMP
 0x0000003ê

	)

896 
	#ETHTOOL_GET_DUMP_FLAG
 0x0000003‡

	)

897 
	#ETHTOOL_GET_DUMP_DATA
 0x00000040

	)

898 
	#ETHTOOL_GET_TS_INFO
 0x00000041

	)

899 
	#ETHTOOL_GMODULEINFO
 0x00000042

	)

900 
	#ETHTOOL_GMODULEEEPROM
 0x00000043

	)

901 
	#ETHTOOL_GEEE
 0x00000044

	)

902 
	#ETHTOOL_SEEE
 0x00000045

	)

905 
	#SPARC_ETH_GSET
 
ETHTOOL_GSET


	)

906 
	#SPARC_ETH_SSET
 
ETHTOOL_SSET


	)

909 
	#SUPPORTED_10ba£T_HÆf
 (1 << 0)

	)

910 
	#SUPPORTED_10ba£T_FuŒ
 (1 << 1)

	)

911 
	#SUPPORTED_100ba£T_HÆf
 (1 << 2)

	)

912 
	#SUPPORTED_100ba£T_FuŒ
 (1 << 3)

	)

913 
	#SUPPORTED_1000ba£T_HÆf
 (1 << 4)

	)

914 
	#SUPPORTED_1000ba£T_FuŒ
 (1 << 5)

	)

915 
	#SUPPORTED_Aut⁄eg
 (1 << 6)

	)

916 
	#SUPPORTED_TP
 (1 << 7)

	)

917 
	#SUPPORTED_AUI
 (1 << 8)

	)

918 
	#SUPPORTED_MII
 (1 << 9)

	)

919 
	#SUPPORTED_FIBRE
 (1 << 10)

	)

920 
	#SUPPORTED_BNC
 (1 << 11)

	)

921 
	#SUPPORTED_10000ba£T_FuŒ
 (1 << 12)

	)

922 
	#SUPPORTED_Pau£
 (1 << 13)

	)

923 
	#SUPPORTED_Asym_Pau£
 (1 << 14)

	)

924 
	#SUPPORTED_2500ba£X_FuŒ
 (1 << 15)

	)

925 
	#SUPPORTED_Back∂™e
 (1 << 16)

	)

926 
	#SUPPORTED_1000ba£KX_FuŒ
 (1 << 17)

	)

927 
	#SUPPORTED_10000ba£KX4_FuŒ
 (1 << 18)

	)

928 
	#SUPPORTED_10000ba£KR_FuŒ
 (1 << 19)

	)

929 
	#SUPPORTED_10000ba£R_FEC
 (1 << 20)

	)

930 
	#SUPPORTED_20000ba£MLD2_FuŒ
 (1 << 21)

	)

931 
	#SUPPORTED_20000ba£KR2_FuŒ
 (1 << 22)

	)

932 
	#SUPPORTED_40000ba£KR4_FuŒ
 (1 << 23)

	)

933 
	#SUPPORTED_40000ba£CR4_FuŒ
 (1 << 24)

	)

934 
	#SUPPORTED_40000ba£SR4_FuŒ
 (1 << 25)

	)

935 
	#SUPPORTED_40000ba£LR4_FuŒ
 (1 << 26)

	)

938 
	#ADVERTISED_10ba£T_HÆf
 (1 << 0)

	)

939 
	#ADVERTISED_10ba£T_FuŒ
 (1 << 1)

	)

940 
	#ADVERTISED_100ba£T_HÆf
 (1 << 2)

	)

941 
	#ADVERTISED_100ba£T_FuŒ
 (1 << 3)

	)

942 
	#ADVERTISED_1000ba£T_HÆf
 (1 << 4)

	)

943 
	#ADVERTISED_1000ba£T_FuŒ
 (1 << 5)

	)

944 
	#ADVERTISED_Aut⁄eg
 (1 << 6)

	)

945 
	#ADVERTISED_TP
 (1 << 7)

	)

946 
	#ADVERTISED_AUI
 (1 << 8)

	)

947 
	#ADVERTISED_MII
 (1 << 9)

	)

948 
	#ADVERTISED_FIBRE
 (1 << 10)

	)

949 
	#ADVERTISED_BNC
 (1 << 11)

	)

950 
	#ADVERTISED_10000ba£T_FuŒ
 (1 << 12)

	)

951 
	#ADVERTISED_Pau£
 (1 << 13)

	)

952 
	#ADVERTISED_Asym_Pau£
 (1 << 14)

	)

953 
	#ADVERTISED_2500ba£X_FuŒ
 (1 << 15)

	)

954 
	#ADVERTISED_Back∂™e
 (1 << 16)

	)

955 
	#ADVERTISED_1000ba£KX_FuŒ
 (1 << 17)

	)

956 
	#ADVERTISED_10000ba£KX4_FuŒ
 (1 << 18)

	)

957 
	#ADVERTISED_10000ba£KR_FuŒ
 (1 << 19)

	)

958 
	#ADVERTISED_10000ba£R_FEC
 (1 << 20)

	)

959 
	#ADVERTISED_20000ba£MLD2_FuŒ
 (1 << 21)

	)

960 
	#ADVERTISED_20000ba£KR2_FuŒ
 (1 << 22)

	)

961 
	#ADVERTISED_40000ba£KR4_FuŒ
 (1 << 23)

	)

962 
	#ADVERTISED_40000ba£CR4_FuŒ
 (1 << 24)

	)

963 
	#ADVERTISED_40000ba£SR4_FuŒ
 (1 << 25)

	)

964 
	#ADVERTISED_40000ba£LR4_FuŒ
 (1 << 26)

	)

973 
	#SPEED_10
 10

	)

974 
	#SPEED_100
 100

	)

975 
	#SPEED_1000
 1000

	)

976 
	#SPEED_2500
 2500

	)

977 
	#SPEED_10000
 10000

	)

978 
	#SPEED_UNKNOWN
 -1

	)

981 
	#DUPLEX_HALF
 0x00

	)

982 
	#DUPLEX_FULL
 0x01

	)

983 
	#DUPLEX_UNKNOWN
 0xff

	)

986 
	#PORT_TP
 0x00

	)

987 
	#PORT_AUI
 0x01

	)

988 
	#PORT_MII
 0x02

	)

989 
	#PORT_FIBRE
 0x03

	)

990 
	#PORT_BNC
 0x04

	)

991 
	#PORT_DA
 0x05

	)

992 
	#PORT_NONE
 0xef

	)

993 
	#PORT_OTHER
 0xff

	)

996 
	#XCVR_INTERNAL
 0x00

	)

997 
	#XCVR_EXTERNAL
 0x01

	)

998 
	#XCVR_DUMMY1
 0x02

	)

999 
	#XCVR_DUMMY2
 0x03

	)

1000 
	#XCVR_DUMMY3
 0x04

	)

1005 
	#AUTONEG_DISABLE
 0x00

	)

1006 
	#AUTONEG_ENABLE
 0x01

	)

1011 
	#ETH_TP_MDI_INVALID
 0x00

	)

1012 
	#ETH_TP_MDI
 0x01

	)

1013 
	#ETH_TP_MDI_X
 0x02

	)

1014 
	#ETH_TP_MDI_AUTO
 0x03

	)

1017 
	#WAKE_PHY
 (1 << 0)

	)

1018 
	#WAKE_UCAST
 (1 << 1)

	)

1019 
	#WAKE_MCAST
 (1 << 2)

	)

1020 
	#WAKE_BCAST
 (1 << 3)

	)

1021 
	#WAKE_ARP
 (1 << 4)

	)

1022 
	#WAKE_MAGIC
 (1 << 5)

	)

1023 
	#WAKE_MAGICSECURE
 (1 << 6Ë

	)

1026 
	#TCP_V4_FLOW
 0x01

	)

1027 
	#UDP_V4_FLOW
 0x02

	)

1028 
	#SCTP_V4_FLOW
 0x03

	)

1029 
	#AH_ESP_V4_FLOW
 0x04

	)

1030 
	#TCP_V6_FLOW
 0x05

	)

1031 
	#UDP_V6_FLOW
 0x06

	)

1032 
	#SCTP_V6_FLOW
 0x07

	)

1033 
	#AH_ESP_V6_FLOW
 0x08

	)

1034 
	#AH_V4_FLOW
 0x09

	)

1035 
	#ESP_V4_FLOW
 0x0®

	)

1036 
	#AH_V6_FLOW
 0x0b

	)

1037 
	#ESP_V6_FLOW
 0x0¯

	)

1038 
	#IP_USER_FLOW
 0x0d

	)

1039 
	#IPV4_FLOW
 0x10

	)

1040 
	#IPV6_FLOW
 0x11

	)

1041 
	#ETHER_FLOW
 0x12

	)

1043 
	#FLOW_EXT
 0x80000000

	)

1044 
	#FLOW_MAC_EXT
 0x40000000

	)

1047 
	#RXH_L2DA
 (1 << 1)

	)

1048 
	#RXH_VLAN
 (1 << 2)

	)

1049 
	#RXH_L3_PROTO
 (1 << 3)

	)

1050 
	#RXH_IP_SRC
 (1 << 4)

	)

1051 
	#RXH_IP_DST
 (1 << 5)

	)

1052 
	#RXH_L4_B_0_1
 (1 << 6Ë

	)

1053 
	#RXH_L4_B_2_3
 (1 << 7Ë

	)

1054 
	#RXH_DISCARD
 (1 << 31)

	)

1056 
	#RX_CLS_FLOW_DISC
 0xffffffffffffffffULL

	)

1059 
	#RX_CLS_LOC_SPECIAL
 0x80000000

	)

1060 
	#RX_CLS_LOC_ANY
 0xffffffff

	)

1061 
	#RX_CLS_LOC_FIRST
 0xffffff„

	)

1062 
	#RX_CLS_LOC_LAST
 0xfffffffd

	)

1065 
	#ETH_MODULE_SFF_8079
 0x1

	)

1066 
	#ETH_MODULE_SFF_8079_LEN
 256

	)

1067 
	#ETH_MODULE_SFF_8472
 0x2

	)

1068 
	#ETH_MODULE_SFF_8472_LEN
 512

	)

1077 
	eëhtoﬁ_ª£t_Êags
 {

1083 
	mETH_RESET_MGMT
 = 1 << 0,

1084 
	mETH_RESET_IRQ
 = 1 << 1,

1085 
	mETH_RESET_DMA
 = 1 << 2,

1086 
	mETH_RESET_FILTER
 = 1 << 3,

1087 
	mETH_RESET_OFFLOAD
 = 1 << 4,

1088 
	mETH_RESET_MAC
 = 1 << 5,

1089 
	mETH_RESET_PHY
 = 1 << 6,

1090 
	mETH_RESET_RAM
 = 1 << 7,

1093 
	mETH_RESET_DEDICATED
 = 0x0000ffff,

1095 
	mETH_RESET_ALL
 = 0xffffffff,

1098 
	#ETH_RESET_SHARED_SHIFT
 16

	)

	@/usr/include/linux/if_packet.h

1 #i‚de‡
__LINUX_IF_PACKET_H


2 
	#__LINUX_IF_PACKET_H


	)

4 
	~<löux/ty≥s.h
>

6 
	ssockaddr_pkt
 {

7 
	m•kt_Ámûy
;

8 
	m•kt_devi˚
[14];

9 
__be16
 
	m•kt_¥Ÿocﬁ
;

12 
	ssockaddr_Œ
 {

13 
	m¶l_Ámûy
;

14 
__be16
 
	m¶l_¥Ÿocﬁ
;

15 
	m¶l_ifödex
;

16 
	m¶l_h©y≥
;

17 
	m¶l_pkây≥
;

18 
	m¶l_hÆí
;

19 
	m¶l_addr
[8];

24 
	#PACKET_HOST
 0

	)

25 
	#PACKET_BROADCAST
 1

	)

26 
	#PACKET_MULTICAST
 2

	)

27 
	#PACKET_OTHERHOST
 3

	)

28 
	#PACKET_OUTGOING
 4

	)

30 
	#PACKET_LOOPBACK
 5

	)

31 
	#PACKET_FASTROUTE
 6

	)

35 
	#PACKET_ADD_MEMBERSHIP
 1

	)

36 
	#PACKET_DROP_MEMBERSHIP
 2

	)

37 
	#PACKET_RECV_OUTPUT
 3

	)

39 
	#PACKET_RX_RING
 5

	)

40 
	#PACKET_STATISTICS
 6

	)

41 
	#PACKET_COPY_THRESH
 7

	)

42 
	#PACKET_AUXDATA
 8

	)

43 
	#PACKET_ORIGDEV
 9

	)

44 
	#PACKET_VERSION
 10

	)

45 
	#PACKET_HDRLEN
 11

	)

46 
	#PACKET_RESERVE
 12

	)

47 
	#PACKET_TX_RING
 13

	)

48 
	#PACKET_LOSS
 14

	)

49 
	#PACKET_VNET_HDR
 15

	)

50 
	#PACKET_TX_TIMESTAMP
 16

	)

51 
	#PACKET_TIMESTAMP
 17

	)

52 
	#PACKET_FANOUT
 18

	)

53 
	#PACKET_TX_HAS_OFF
 19

	)

55 
	#PACKET_FANOUT_HASH
 0

	)

56 
	#PACKET_FANOUT_LB
 1

	)

57 
	#PACKET_FANOUT_CPU
 2

	)

58 
	#PACKET_FANOUT_ROLLOVER
 3

	)

59 
	#PACKET_FANOUT_FLAG_ROLLOVER
 0x1000

	)

60 
	#PACKET_FANOUT_FLAG_DEFRAG
 0x8000

	)

62 
	sçackë_°©s
 {

63 
	mç_∑ckës
;

64 
	mç_dr›s
;

67 
	sçackë_°©s_v3
 {

68 
	mç_∑ckës
;

69 
	mç_dr›s
;

70 
	mç_‰ìze_q_˙t
;

73 
	uçackë_°©s_u
 {

74 
çackë_°©s
 
	m°©s1
;

75 
çackë_°©s_v3
 
	m°©s3
;

78 
	sçackë_auxd©a
 {

79 
__u32
 
	mç_°©us
;

80 
__u32
 
	mç_Àn
;

81 
__u32
 
	mç_¢≠Àn
;

82 
__u16
 
	mç_mac
;

83 
__u16
 
	mç_√t
;

84 
__u16
 
	mç_vœn_tci
;

85 
__u16
 
	mç_∑ddög
;

89 
	#TP_STATUS_KERNEL
 0

	)

90 
	#TP_STATUS_USER
 (1 << 0)

	)

91 
	#TP_STATUS_COPY
 (1 << 1)

	)

92 
	#TP_STATUS_LOSING
 (1 << 2)

	)

93 
	#TP_STATUS_CSUMNOTREADY
 (1 << 3)

	)

94 
	#TP_STATUS_VLAN_VALID
 (1 << 4Ë

	)

95 
	#TP_STATUS_BLK_TMO
 (1 << 5)

	)

98 
	#TP_STATUS_AVAILABLE
 0

	)

99 
	#TP_STATUS_SEND_REQUEST
 (1 << 0)

	)

100 
	#TP_STATUS_SENDING
 (1 << 1)

	)

101 
	#TP_STATUS_WRONG_FORMAT
 (1 << 2)

	)

104 
	#TP_STATUS_TS_SOFTWARE
 (1 << 29)

	)

105 
	#TP_STATUS_TS_SYS_HARDWARE
 (1 << 30)

	)

106 
	#TP_STATUS_TS_RAW_HARDWARE
 (1 << 31)

	)

109 
	#TP_FT_REQ_FILL_RXHASH
 0x1

	)

111 
	sçackë_hdr
 {

112 
	mç_°©us
;

113 
	mç_Àn
;

114 
	mç_¢≠Àn
;

115 
	mç_mac
;

116 
	mç_√t
;

117 
	mç_£c
;

118 
	mç_u£c
;

121 
	#TPACKET_ALIGNMENT
 16

	)

122 
	#TPACKET_ALIGN
(
x
Ë(((x)+
TPACKET_ALIGNMENT
-1)&~(TPACKET_ALIGNMENT-1))

	)

123 
	#TPACKET_HDRLEN
 (
	`TPACKET_ALIGN
((
çackë_hdr
)Ë+ (
sockaddr_Œ
))

	)

125 
	sçackë2_hdr
 {

126 
__u32
 
	mç_°©us
;

127 
__u32
 
	mç_Àn
;

128 
__u32
 
	mç_¢≠Àn
;

129 
__u16
 
	mç_mac
;

130 
__u16
 
	mç_√t
;

131 
__u32
 
	mç_£c
;

132 
__u32
 
	mç_n£c
;

133 
__u16
 
	mç_vœn_tci
;

134 
__u16
 
	mç_∑ddög
;

137 
	sçackë_hdr_v¨ü¡1
 {

138 
__u32
 
	mç_rxhash
;

139 
__u32
 
	mç_vœn_tci
;

142 
	sçackë3_hdr
 {

143 
__u32
 
	mç_√xt_off£t
;

144 
__u32
 
	mç_£c
;

145 
__u32
 
	mç_n£c
;

146 
__u32
 
	mç_¢≠Àn
;

147 
__u32
 
	mç_Àn
;

148 
__u32
 
	mç_°©us
;

149 
__u16
 
	mç_mac
;

150 
__u16
 
	mç_√t
;

153 
çackë_hdr_v¨ü¡1
 
	mhv1
;

157 
	sçackë_bd_ts
 {

158 
	mts_£c
;

160 
	mts_u£c
;

161 
	mts_n£c
;

165 
	sçackë_hdr_v1
 {

166 
__u32
 
	mblock_°©us
;

167 
__u32
 
	mnum_pkts
;

168 
__u32
 
	moff£t_to_fú°_pkt
;

173 
__u32
 
	mblk_Àn
;

184 
__Æig√d_u64
 
	m£q_num
;

211 
çackë_bd_ts
 
	mts_fú°_pkt
, 
	mts_œ°_pkt
;

214 
	uçackë_bd_hódî_u
 {

215 
çackë_hdr_v1
 
	mbh1
;

218 
	sçackë_block_desc
 {

219 
__u32
 
	mvîsi⁄
;

220 
__u32
 
	moff£t_to_¥iv
;

221 
çackë_bd_hódî_u
 
	mhdr
;

224 
	#TPACKET2_HDRLEN
 (
	`TPACKET_ALIGN
((
çackë2_hdr
)Ë+ (
sockaddr_Œ
))

	)

225 
	#TPACKET3_HDRLEN
 (
	`TPACKET_ALIGN
((
çackë3_hdr
)Ë+ (
sockaddr_Œ
))

	)

227 
	eçackë_vîsi⁄s
 {

228 
	mTPACKET_V1
,

229 
	mTPACKET_V2
,

230 
	mTPACKET_V3


246 
	sçackë_ªq
 {

247 
	mç_block_size
;

248 
	mç_block_ƒ
;

249 
	mç_‰ame_size
;

250 
	mç_‰ame_ƒ
;

253 
	sçackë_ªq3
 {

254 
	mç_block_size
;

255 
	mç_block_ƒ
;

256 
	mç_‰ame_size
;

257 
	mç_‰ame_ƒ
;

258 
	mç_ªtúe_blk_tov
;

259 
	mç_sizeof_¥iv
;

260 
	mç_„©uª_ªq_w‹d
;

263 
	uçackë_ªq_u
 {

264 
çackë_ªq
 
	mªq
;

265 
çackë_ªq3
 
	mªq3
;

268 
	s∑ckë_mªq
 {

269 
	mmr_ifödex
;

270 
	mmr_ty≥
;

271 
	mmr_Æí
;

272 
	mmr_addªss
[8];

275 
	#PACKET_MR_MULTICAST
 0

	)

276 
	#PACKET_MR_PROMISC
 1

	)

277 
	#PACKET_MR_ALLMULTI
 2

	)

278 
	#PACKET_MR_UNICAST
 3

	)

	@/usr/include/linux/if_tun.h

16 #i‚de‡
__IF_TUN_H


17 
	#__IF_TUN_H


	)

19 
	~<löux/ty≥s.h
>

20 
	~<löux/if_ëhî.h
>

21 
	~<löux/fûãr.h
>

24 
	#TUN_READQ_SIZE
 500

	)

27 
	#TUN_TUN_DEV
 0x0001

	)

28 
	#TUN_TAP_DEV
 0x0002

	)

29 
	#TUN_TYPE_MASK
 0x000f

	)

31 
	#TUN_FASYNC
 0x0010

	)

32 
	#TUN_NOCHECKSUM
 0x0020

	)

33 
	#TUN_NO_PI
 0x0040

	)

35 
	#TUN_ONE_QUEUE
 0x0080

	)

36 
	#TUN_PERSIST
 0x0100

	)

37 
	#TUN_VNET_HDR
 0x0200

	)

38 
	#TUN_TAP_MQ
 0x0400

	)

41 
	#TUNSETNOCSUM
 
	`_IOW
('T', 200, )

	)

42 
	#TUNSETDEBUG
 
	`_IOW
('T', 201, )

	)

43 
	#TUNSETIFF
 
	`_IOW
('T', 202, )

	)

44 
	#TUNSETPERSIST
 
	`_IOW
('T', 203, )

	)

45 
	#TUNSETOWNER
 
	`_IOW
('T', 204, )

	)

46 
	#TUNSETLINK
 
	`_IOW
('T', 205, )

	)

47 
	#TUNSETGROUP
 
	`_IOW
('T', 206, )

	)

48 
	#TUNGETFEATURES
 
	`_IOR
('T', 207, )

	)

49 
	#TUNSETOFFLOAD
 
	`_IOW
('T', 208, )

	)

50 
	#TUNSETTXFILTER
 
	`_IOW
('T', 209, )

	)

51 
	#TUNGETIFF
 
	`_IOR
('T', 210, )

	)

52 
	#TUNGETSNDBUF
 
	`_IOR
('T', 211, )

	)

53 
	#TUNSETSNDBUF
 
	`_IOW
('T', 212, )

	)

54 
	#TUNATTACHFILTER
 
	`_IOW
('T', 213, 
sock_Ârog
)

	)

55 
	#TUNDETACHFILTER
 
	`_IOW
('T', 214, 
sock_Ârog
)

	)

56 
	#TUNGETVNETHDRSZ
 
	`_IOR
('T', 215, )

	)

57 
	#TUNSETVNETHDRSZ
 
	`_IOW
('T', 216, )

	)

58 
	#TUNSETQUEUE
 
	`_IOW
('T', 217, )

	)

61 
	#IFF_TUN
 0x0001

	)

62 
	#IFF_TAP
 0x0002

	)

63 
	#IFF_NO_PI
 0x1000

	)

65 
	#IFF_ONE_QUEUE
 0x2000

	)

66 
	#IFF_VNET_HDR
 0x4000

	)

67 
	#IFF_TUN_EXCL
 0x8000

	)

68 
	#IFF_MULTI_QUEUE
 0x0100

	)

69 
	#IFF_ATTACH_QUEUE
 0x0200

	)

70 
	#IFF_DETACH_QUEUE
 0x0400

	)

72 
	#IFF_PERSIST
 0x0800

	)

75 
	#TUN_F_CSUM
 0x01

	)

76 
	#TUN_F_TSO4
 0x02

	)

77 
	#TUN_F_TSO6
 0x04

	)

78 
	#TUN_F_TSO_ECN
 0x08

	)

79 
	#TUN_F_UFO
 0x10

	)

82 
	#TUN_PKT_STRIP
 0x0001

	)

83 
	stun_pi
 {

84 
__u16
 
	mÊags
;

85 
__be16
 
	m¥Ÿo
;

96 
	#TUN_FLT_ALLMULTI
 0x0001

	)

97 
	stun_fûãr
 {

98 
__u16
 
	mÊags
;

99 
__u16
 
	mcou¡
;

100 
__u8
 
	maddr
[0][
ETH_ALEN
];

	@/usr/include/linux/rtnetlink.h

1 #i‚de‡
__LINUX_RTNETLINK_H


2 
	#__LINUX_RTNETLINK_H


	)

4 
	~<löux/ty≥s.h
>

5 
	~<löux/√éök.h
>

6 
	~<löux/if_lök.h
>

7 
	~<löux/if_addr.h
>

8 
	~<löux/√ighbour.h
>

13 
	#RTNL_FAMILY_IPMR
 128

	)

14 
	#RTNL_FAMILY_IP6MR
 129

	)

15 
	#RTNL_FAMILY_MAX
 129

	)

24 
	mRTM_BASE
 = 16,

25 
	#RTM_BASE
 
RTM_BASE


	)

27 
	mRTM_NEWLINK
 = 16,

28 
	#RTM_NEWLINK
 
RTM_NEWLINK


	)

29 
	mRTM_DELLINK
,

30 
	#RTM_DELLINK
 
RTM_DELLINK


	)

31 
	mRTM_GETLINK
,

32 
	#RTM_GETLINK
 
RTM_GETLINK


	)

33 
	mRTM_SETLINK
,

34 
	#RTM_SETLINK
 
RTM_SETLINK


	)

36 
	mRTM_NEWADDR
 = 20,

37 
	#RTM_NEWADDR
 
RTM_NEWADDR


	)

38 
	mRTM_DELADDR
,

39 
	#RTM_DELADDR
 
RTM_DELADDR


	)

40 
	mRTM_GETADDR
,

41 
	#RTM_GETADDR
 
RTM_GETADDR


	)

43 
	mRTM_NEWROUTE
 = 24,

44 
	#RTM_NEWROUTE
 
RTM_NEWROUTE


	)

45 
	mRTM_DELROUTE
,

46 
	#RTM_DELROUTE
 
RTM_DELROUTE


	)

47 
	mRTM_GETROUTE
,

48 
	#RTM_GETROUTE
 
RTM_GETROUTE


	)

50 
	mRTM_NEWNEIGH
 = 28,

51 
	#RTM_NEWNEIGH
 
RTM_NEWNEIGH


	)

52 
	mRTM_DELNEIGH
,

53 
	#RTM_DELNEIGH
 
RTM_DELNEIGH


	)

54 
	mRTM_GETNEIGH
,

55 
	#RTM_GETNEIGH
 
RTM_GETNEIGH


	)

57 
	mRTM_NEWRULE
 = 32,

58 
	#RTM_NEWRULE
 
RTM_NEWRULE


	)

59 
	mRTM_DELRULE
,

60 
	#RTM_DELRULE
 
RTM_DELRULE


	)

61 
	mRTM_GETRULE
,

62 
	#RTM_GETRULE
 
RTM_GETRULE


	)

64 
	mRTM_NEWQDISC
 = 36,

65 
	#RTM_NEWQDISC
 
RTM_NEWQDISC


	)

66 
	mRTM_DELQDISC
,

67 
	#RTM_DELQDISC
 
RTM_DELQDISC


	)

68 
	mRTM_GETQDISC
,

69 
	#RTM_GETQDISC
 
RTM_GETQDISC


	)

71 
	mRTM_NEWTCLASS
 = 40,

72 
	#RTM_NEWTCLASS
 
RTM_NEWTCLASS


	)

73 
	mRTM_DELTCLASS
,

74 
	#RTM_DELTCLASS
 
RTM_DELTCLASS


	)

75 
	mRTM_GETTCLASS
,

76 
	#RTM_GETTCLASS
 
RTM_GETTCLASS


	)

78 
	mRTM_NEWTFILTER
 = 44,

79 
	#RTM_NEWTFILTER
 
RTM_NEWTFILTER


	)

80 
	mRTM_DELTFILTER
,

81 
	#RTM_DELTFILTER
 
RTM_DELTFILTER


	)

82 
	mRTM_GETTFILTER
,

83 
	#RTM_GETTFILTER
 
RTM_GETTFILTER


	)

85 
	mRTM_NEWACTION
 = 48,

86 
	#RTM_NEWACTION
 
RTM_NEWACTION


	)

87 
	mRTM_DELACTION
,

88 
	#RTM_DELACTION
 
RTM_DELACTION


	)

89 
	mRTM_GETACTION
,

90 
	#RTM_GETACTION
 
RTM_GETACTION


	)

92 
	mRTM_NEWPREFIX
 = 52,

93 
	#RTM_NEWPREFIX
 
RTM_NEWPREFIX


	)

95 
	mRTM_GETMULTICAST
 = 58,

96 
	#RTM_GETMULTICAST
 
RTM_GETMULTICAST


	)

98 
	mRTM_GETANYCAST
 = 62,

99 
	#RTM_GETANYCAST
 
RTM_GETANYCAST


	)

101 
	mRTM_NEWNEIGHTBL
 = 64,

102 
	#RTM_NEWNEIGHTBL
 
RTM_NEWNEIGHTBL


	)

103 
	mRTM_GETNEIGHTBL
 = 66,

104 
	#RTM_GETNEIGHTBL
 
RTM_GETNEIGHTBL


	)

105 
	mRTM_SETNEIGHTBL
,

106 
	#RTM_SETNEIGHTBL
 
RTM_SETNEIGHTBL


	)

108 
	mRTM_NEWNDUSEROPT
 = 68,

109 
	#RTM_NEWNDUSEROPT
 
RTM_NEWNDUSEROPT


	)

111 
	mRTM_NEWADDRLABEL
 = 72,

112 
	#RTM_NEWADDRLABEL
 
RTM_NEWADDRLABEL


	)

113 
	mRTM_DELADDRLABEL
,

114 
	#RTM_DELADDRLABEL
 
RTM_DELADDRLABEL


	)

115 
	mRTM_GETADDRLABEL
,

116 
	#RTM_GETADDRLABEL
 
RTM_GETADDRLABEL


	)

118 
	mRTM_GETDCB
 = 78,

119 
	#RTM_GETDCB
 
RTM_GETDCB


	)

120 
	mRTM_SETDCB
,

121 
	#RTM_SETDCB
 
RTM_SETDCB


	)

123 
	mRTM_NEWNETCONF
 = 80,

124 
	#RTM_NEWNETCONF
 
RTM_NEWNETCONF


	)

125 
	mRTM_GETNETCONF
 = 82,

126 
	#RTM_GETNETCONF
 
RTM_GETNETCONF


	)

128 
	mRTM_NEWMDB
 = 84,

129 
	#RTM_NEWMDB
 
RTM_NEWMDB


	)

130 
	mRTM_DELMDB
 = 85,

131 
	#RTM_DELMDB
 
RTM_DELMDB


	)

132 
	mRTM_GETMDB
 = 86,

133 
	#RTM_GETMDB
 
RTM_GETMDB


	)

135 
	m__RTM_MAX
,

136 
	#RTM_MAX
 (((
__RTM_MAX
 + 3Ë& ~3Ë- 1)

	)

139 
	#RTM_NR_MSGTYPES
 (
RTM_MAX
 + 1 - 
RTM_BASE
)

	)

140 
	#RTM_NR_FAMILIES
 (
RTM_NR_MSGTYPES
 >> 2)

	)

141 
	#RTM_FAM
(
cmd
Ë(((cmdË- 
RTM_BASE
Ë>> 2)

	)

149 
	sπ©å
 {

150 
	mπa_Àn
;

151 
	mπa_ty≥
;

156 
	#RTA_ALIGNTO
 4

	)

157 
	#RTA_ALIGN
(
Àn
Ë–(÷í)+
RTA_ALIGNTO
-1Ë& ~(RTA_ALIGNTO-1Ë)

	)

158 
	#RTA_OK
(
πa
,
Àn
Ë(÷íË>()(
π©å
) && \

159 (
πa
)->
πa_Àn
 >(
π©å
) && \

160 (
πa
)->
πa_Àn
 <(
Àn
))

	)

161 
	#RTA_NEXT
(
πa
,
©åÀn
Ë(◊âæíË-
	`RTA_ALIGN
(‘è)->
πa_Àn
), \

162 (
π©å
*)(((*)(
πa
)Ë+ 
	`RTA_ALIGN
(‘è)->
πa_Àn
)))

	)

163 
	#RTA_LENGTH
(
Àn
Ë(
	`RTA_ALIGN
((
π©å
)Ë+ (Àn))

	)

164 
	#RTA_SPACE
(
Àn
Ë
	`RTA_ALIGN
(
	`RTA_LENGTH
÷í))

	)

165 
	#RTA_DATA
(
πa
Ë((*)(((*)‘è)Ë+ 
	`RTA_LENGTH
(0)))

	)

166 
	#RTA_PAYLOAD
(
πa
Ë(()(‘è)->
πa_Àn
Ë- 
	`RTA_LENGTH
(0))

	)

175 
	sπmsg
 {

176 
	mπm_Ámûy
;

177 
	mπm_d°_Àn
;

178 
	mπm_§c_Àn
;

179 
	mπm_tos
;

181 
	mπm_èbÀ
;

182 
	mπm_¥Ÿocﬁ
;

183 
	mπm_sc›e
;

184 
	mπm_ty≥
;

186 
	mπm_Êags
;

192 
	mRTN_UNSPEC
,

193 
	mRTN_UNICAST
,

194 
	mRTN_LOCAL
,

195 
	mRTN_BROADCAST
,

197 
	mRTN_ANYCAST
,

199 
	mRTN_MULTICAST
,

200 
	mRTN_BLACKHOLE
,

201 
	mRTN_UNREACHABLE
,

202 
	mRTN_PROHIBIT
,

203 
	mRTN_THROW
,

204 
	mRTN_NAT
,

205 
	mRTN_XRESOLVE
,

206 
	m__RTN_MAX


209 
	#RTN_MAX
 (
__RTN_MAX
 - 1)

	)

214 
	#RTPROT_UNSPEC
 0

	)

215 
	#RTPROT_REDIRECT
 1

	)

217 
	#RTPROT_KERNEL
 2

	)

218 
	#RTPROT_BOOT
 3

	)

219 
	#RTPROT_STATIC
 4

	)

228 
	#RTPROT_GATED
 8

	)

229 
	#RTPROT_RA
 9

	)

230 
	#RTPROT_MRT
 10

	)

231 
	#RTPROT_ZEBRA
 11

	)

232 
	#RTPROT_BIRD
 12

	)

233 
	#RTPROT_DNROUTED
 13

	)

234 
	#RTPROT_XORP
 14

	)

235 
	#RTPROT_NTK
 15

	)

236 
	#RTPROT_DHCP
 16

	)

237 
	#RTPROT_MROUTED
 17

	)

250 
	eπ_sc›e_t
 {

251 
	mRT_SCOPE_UNIVERSE
=0,

253 
	mRT_SCOPE_SITE
=200,

254 
	mRT_SCOPE_LINK
=253,

255 
	mRT_SCOPE_HOST
=254,

256 
	mRT_SCOPE_NOWHERE
=255

261 
	#RTM_F_NOTIFY
 0x100

	)

262 
	#RTM_F_CLONED
 0x200

	)

263 
	#RTM_F_EQUALIZE
 0x400

	)

264 
	#RTM_F_PREFIX
 0x800

	)

268 
	eπ_˛ass_t
 {

269 
	mRT_TABLE_UNSPEC
=0,

271 
	mRT_TABLE_COMPAT
=252,

272 
	mRT_TABLE_DEFAULT
=253,

273 
	mRT_TABLE_MAIN
=254,

274 
	mRT_TABLE_LOCAL
=255,

275 
	mRT_TABLE_MAX
=0xFFFFFFFF

281 
	eπ©å_ty≥_t
 {

282 
	mRTA_UNSPEC
,

283 
	mRTA_DST
,

284 
	mRTA_SRC
,

285 
	mRTA_IIF
,

286 
	mRTA_OIF
,

287 
	mRTA_GATEWAY
,

288 
	mRTA_PRIORITY
,

289 
	mRTA_PREFSRC
,

290 
	mRTA_METRICS
,

291 
	mRTA_MULTIPATH
,

292 
	mRTA_PROTOINFO
,

293 
	mRTA_FLOW
,

294 
	mRTA_CACHEINFO
,

295 
	mRTA_SESSION
,

296 
	mRTA_MP_ALGO
,

297 
	mRTA_TABLE
,

298 
	mRTA_MARK
,

299 
	mRTA_MFC_STATS
,

300 
	m__RTA_MAX


303 
	#RTA_MAX
 (
__RTA_MAX
 - 1)

	)

305 
	#RTM_RTA
(
r
Ë((
π©å
*)(((*)‘)Ë+ 
	`NLMSG_ALIGN
((
πmsg
))))

	)

306 
	#RTM_PAYLOAD
(
n
Ë
	`NLMSG_PAYLOAD
“,(
πmsg
))

	)

317 
	sπ√xth›
 {

318 
	mπnh_Àn
;

319 
	mπnh_Êags
;

320 
	mπnh_h›s
;

321 
	mπnh_ifödex
;

326 
	#RTNH_F_DEAD
 1

	)

327 
	#RTNH_F_PERVASIVE
 2

	)

328 
	#RTNH_F_ONLINK
 4

	)

332 
	#RTNH_ALIGNTO
 4

	)

333 
	#RTNH_ALIGN
(
Àn
Ë–(÷í)+
RTNH_ALIGNTO
-1Ë& ~(RTNH_ALIGNTO-1Ë)

	)

334 
	#RTNH_OK
(
πnh
,
Àn
Ë(‘äh)->
πnh_Àn
 >(
π√xth›
) && \

335 (()(
πnh
)->
πnh_Àn
Ë<(
Àn
))

	)

336 
	#RTNH_NEXT
(
πnh
Ë((
π√xth›
*)(((*)‘äh)Ë+ 
	`RTNH_ALIGN
(‘äh)->
πnh_Àn
)))

	)

337 
	#RTNH_LENGTH
(
Àn
Ë(
	`RTNH_ALIGN
((
π√xth›
)Ë+ (Àn))

	)

338 
	#RTNH_SPACE
(
Àn
Ë
	`RTNH_ALIGN
(
	`RTNH_LENGTH
÷í))

	)

339 
	#RTNH_DATA
(
πnh
Ë((
π©å
*)(((*)‘äh)Ë+ 
	`RTNH_LENGTH
(0)))

	)

343 
	sπa_ˇcheöfo
 {

344 
__u32
 
	mπa_˛¡ªf
;

345 
__u32
 
	mπa_œ°u£
;

346 
__s32
 
	mπa_expúes
;

347 
__u32
 
	mπa_îr‹
;

348 
__u32
 
	mπa_u£d
;

350 
	#RTNETLINK_HAVE_PEERINFO
 1

	)

351 
__u32
 
	mπa_id
;

352 
__u32
 
	mπa_ts
;

353 
__u32
 
	mπa_tßge
;

359 
	mRTAX_UNSPEC
,

360 
	#RTAX_UNSPEC
 
RTAX_UNSPEC


	)

361 
	mRTAX_LOCK
,

362 
	#RTAX_LOCK
 
RTAX_LOCK


	)

363 
	mRTAX_MTU
,

364 
	#RTAX_MTU
 
RTAX_MTU


	)

365 
	mRTAX_WINDOW
,

366 
	#RTAX_WINDOW
 
RTAX_WINDOW


	)

367 
	mRTAX_RTT
,

368 
	#RTAX_RTT
 
RTAX_RTT


	)

369 
	mRTAX_RTTVAR
,

370 
	#RTAX_RTTVAR
 
RTAX_RTTVAR


	)

371 
	mRTAX_SSTHRESH
,

372 
	#RTAX_SSTHRESH
 
RTAX_SSTHRESH


	)

373 
	mRTAX_CWND
,

374 
	#RTAX_CWND
 
RTAX_CWND


	)

375 
	mRTAX_ADVMSS
,

376 
	#RTAX_ADVMSS
 
RTAX_ADVMSS


	)

377 
	mRTAX_REORDERING
,

378 
	#RTAX_REORDERING
 
RTAX_REORDERING


	)

379 
	mRTAX_HOPLIMIT
,

380 
	#RTAX_HOPLIMIT
 
RTAX_HOPLIMIT


	)

381 
	mRTAX_INITCWND
,

382 
	#RTAX_INITCWND
 
RTAX_INITCWND


	)

383 
	mRTAX_FEATURES
,

384 
	#RTAX_FEATURES
 
RTAX_FEATURES


	)

385 
	mRTAX_RTO_MIN
,

386 
	#RTAX_RTO_MIN
 
RTAX_RTO_MIN


	)

387 
	mRTAX_INITRWND
,

388 
	#RTAX_INITRWND
 
RTAX_INITRWND


	)

389 
	mRTAX_QUICKACK
,

390 
	#RTAX_QUICKACK
 
RTAX_QUICKACK


	)

391 
	m__RTAX_MAX


394 
	#RTAX_MAX
 (
__RTAX_MAX
 - 1)

	)

396 
	#RTAX_FEATURE_ECN
 0x00000001

	)

397 
	#RTAX_FEATURE_SACK
 0x00000002

	)

398 
	#RTAX_FEATURE_TIMESTAMP
 0x00000004

	)

399 
	#RTAX_FEATURE_ALLFRAG
 0x00000008

	)

401 
	sπa_£ssi⁄
 {

402 
__u8
 
	m¥Ÿo
;

403 
__u8
 
	m∑d1
;

404 
__u16
 
	m∑d2
;

408 
__u16
 
	m•‹t
;

409 
__u16
 
	mdp‹t
;

410 } 
	mp‹ts
;

413 
__u8
 
	mty≥
;

414 
__u8
 
	mcode
;

415 
__u16
 
	midít
;

416 } 
	micm±
;

418 
__u32
 
	m•i
;

419 } 
	mu
;

422 
	sπa_mfc_°©s
 {

423 
__u64
 
	mmfcs_∑ckës
;

424 
__u64
 
	mmfcs_byãs
;

425 
__u64
 
	mmfcs_wr⁄g_if
;

432 
	sπgímsg
 {

433 
	mπgí_Ámûy
;

445 
	siföfomsg
 {

446 
	mifi_Ámûy
;

447 
	m__ifi_∑d
;

448 
	mifi_ty≥
;

449 
	mifi_ödex
;

450 
	mifi_Êags
;

451 
	mifi_ch™ge
;

458 
	s¥efixmsg
 {

459 
	m¥efix_Ámûy
;

460 
	m¥efix_∑d1
;

461 
	m¥efix_∑d2
;

462 
	m¥efix_ifödex
;

463 
	m¥efix_ty≥
;

464 
	m¥efix_Àn
;

465 
	m¥efix_Êags
;

466 
	m¥efix_∑d3
;

471 
	mPREFIX_UNSPEC
,

472 
	mPREFIX_ADDRESS
,

473 
	mPREFIX_CACHEINFO
,

474 
	m__PREFIX_MAX


477 
	#PREFIX_MAX
 (
__PREFIX_MAX
 - 1)

	)

479 
	s¥efix_ˇcheöfo
 {

480 
__u32
 
	m¥e„ºed_time
;

481 
__u32
 
	mvÆid_time
;

489 
	stcmsg
 {

490 
	mtcm_Ámûy
;

491 
	mtcm__∑d1
;

492 
	mtcm__∑d2
;

493 
	mtcm_ifödex
;

494 
__u32
 
	mtcm_h™dÀ
;

495 
__u32
 
	mtcm_∑ª¡
;

496 
__u32
 
	mtcm_öfo
;

500 
	mTCA_UNSPEC
,

501 
	mTCA_KIND
,

502 
	mTCA_OPTIONS
,

503 
	mTCA_STATS
,

504 
	mTCA_XSTATS
,

505 
	mTCA_RATE
,

506 
	mTCA_FCNT
,

507 
	mTCA_STATS2
,

508 
	mTCA_STAB
,

509 
	m__TCA_MAX


512 
	#TCA_MAX
 (
__TCA_MAX
 - 1)

	)

514 
	#TCA_RTA
(
r
Ë((
π©å
*)(((*)‘)Ë+ 
	`NLMSG_ALIGN
((
tcmsg
))))

	)

515 
	#TCA_PAYLOAD
(
n
Ë
	`NLMSG_PAYLOAD
“,(
tcmsg
))

	)

521 
	sndu£r›tmsg
 {

522 
	mndu£r›t_Ámûy
;

523 
	mndu£r›t_∑d1
;

524 
	mndu£r›t_›ts_Àn
;

525 
	mndu£r›t_ifödex
;

526 
__u8
 
	mndu£r›t_icmp_ty≥
;

527 
__u8
 
	mndu£r›t_icmp_code
;

528 
	mndu£r›t_∑d2
;

529 
	mndu£r›t_∑d3
;

534 
	mNDUSEROPT_UNSPEC
,

535 
	mNDUSEROPT_SRCADDR
,

536 
	m__NDUSEROPT_MAX


539 
	#NDUSEROPT_MAX
 (
__NDUSEROPT_MAX
 - 1)

	)

542 
	#RTMGRP_LINK
 1

	)

543 
	#RTMGRP_NOTIFY
 2

	)

544 
	#RTMGRP_NEIGH
 4

	)

545 
	#RTMGRP_TC
 8

	)

547 
	#RTMGRP_IPV4_IFADDR
 0x10

	)

548 
	#RTMGRP_IPV4_MROUTE
 0x20

	)

549 
	#RTMGRP_IPV4_ROUTE
 0x40

	)

550 
	#RTMGRP_IPV4_RULE
 0x80

	)

552 
	#RTMGRP_IPV6_IFADDR
 0x100

	)

553 
	#RTMGRP_IPV6_MROUTE
 0x200

	)

554 
	#RTMGRP_IPV6_ROUTE
 0x400

	)

555 
	#RTMGRP_IPV6_IFINFO
 0x800

	)

557 
	#RTMGRP_DEC√t_IFADDR
 0x1000

	)

558 
	#RTMGRP_DEC√t_ROUTE
 0x4000

	)

560 
	#RTMGRP_IPV6_PREFIX
 0x20000

	)

563 
	eπ√éök_groups
 {

564 
	mRTNLGRP_NONE
,

565 
	#RTNLGRP_NONE
 
RTNLGRP_NONE


	)

566 
	mRTNLGRP_LINK
,

567 
	#RTNLGRP_LINK
 
RTNLGRP_LINK


	)

568 
	mRTNLGRP_NOTIFY
,

569 
	#RTNLGRP_NOTIFY
 
RTNLGRP_NOTIFY


	)

570 
	mRTNLGRP_NEIGH
,

571 
	#RTNLGRP_NEIGH
 
RTNLGRP_NEIGH


	)

572 
	mRTNLGRP_TC
,

573 
	#RTNLGRP_TC
 
RTNLGRP_TC


	)

574 
	mRTNLGRP_IPV4_IFADDR
,

575 
	#RTNLGRP_IPV4_IFADDR
 
RTNLGRP_IPV4_IFADDR


	)

576 
	mRTNLGRP_IPV4_MROUTE
,

577 
	#RTNLGRP_IPV4_MROUTE
 
RTNLGRP_IPV4_MROUTE


	)

578 
	mRTNLGRP_IPV4_ROUTE
,

579 
	#RTNLGRP_IPV4_ROUTE
 
RTNLGRP_IPV4_ROUTE


	)

580 
	mRTNLGRP_IPV4_RULE
,

581 
	#RTNLGRP_IPV4_RULE
 
RTNLGRP_IPV4_RULE


	)

582 
	mRTNLGRP_IPV6_IFADDR
,

583 
	#RTNLGRP_IPV6_IFADDR
 
RTNLGRP_IPV6_IFADDR


	)

584 
	mRTNLGRP_IPV6_MROUTE
,

585 
	#RTNLGRP_IPV6_MROUTE
 
RTNLGRP_IPV6_MROUTE


	)

586 
	mRTNLGRP_IPV6_ROUTE
,

587 
	#RTNLGRP_IPV6_ROUTE
 
RTNLGRP_IPV6_ROUTE


	)

588 
	mRTNLGRP_IPV6_IFINFO
,

589 
	#RTNLGRP_IPV6_IFINFO
 
RTNLGRP_IPV6_IFINFO


	)

590 
	mRTNLGRP_DEC√t_IFADDR
,

591 
	#RTNLGRP_DEC√t_IFADDR
 
RTNLGRP_DEC√t_IFADDR


	)

592 
	mRTNLGRP_NOP2
,

593 
	mRTNLGRP_DEC√t_ROUTE
,

594 
	#RTNLGRP_DEC√t_ROUTE
 
RTNLGRP_DEC√t_ROUTE


	)

595 
	mRTNLGRP_DEC√t_RULE
,

596 
	#RTNLGRP_DEC√t_RULE
 
RTNLGRP_DEC√t_RULE


	)

597 
	mRTNLGRP_NOP4
,

598 
	mRTNLGRP_IPV6_PREFIX
,

599 
	#RTNLGRP_IPV6_PREFIX
 
RTNLGRP_IPV6_PREFIX


	)

600 
	mRTNLGRP_IPV6_RULE
,

601 
	#RTNLGRP_IPV6_RULE
 
RTNLGRP_IPV6_RULE


	)

602 
	mRTNLGRP_ND_USEROPT
,

603 
	#RTNLGRP_ND_USEROPT
 
RTNLGRP_ND_USEROPT


	)

604 
	mRTNLGRP_PHONET_IFADDR
,

605 
	#RTNLGRP_PHONET_IFADDR
 
RTNLGRP_PHONET_IFADDR


	)

606 
	mRTNLGRP_PHONET_ROUTE
,

607 
	#RTNLGRP_PHONET_ROUTE
 
RTNLGRP_PHONET_ROUTE


	)

608 
	mRTNLGRP_DCB
,

609 
	#RTNLGRP_DCB
 
RTNLGRP_DCB


	)

610 
	mRTNLGRP_IPV4_NETCONF
,

611 
	#RTNLGRP_IPV4_NETCONF
 
RTNLGRP_IPV4_NETCONF


	)

612 
	mRTNLGRP_IPV6_NETCONF
,

613 
	#RTNLGRP_IPV6_NETCONF
 
RTNLGRP_IPV6_NETCONF


	)

614 
	mRTNLGRP_MDB
,

615 
	#RTNLGRP_MDB
 
RTNLGRP_MDB


	)

616 
	m__RTNLGRP_MAX


618 
	#RTNLGRP_MAX
 (
__RTNLGRP_MAX
 - 1)

	)

621 
	stˇmsg
 {

622 
	mtˇ_Ámûy
;

623 
	mtˇ__∑d1
;

624 
	mtˇ__∑d2
;

626 
	#TA_RTA
(
r
Ë((
π©å
*)(((*)‘)Ë+ 
	`NLMSG_ALIGN
((
tˇmsg
))))

	)

627 
	#TA_PAYLOAD
(
n
Ë
	`NLMSG_PAYLOAD
“,(
tˇmsg
))

	)

628 
	#TCA_ACT_TAB
 1

	)

629 
	#TCAA_MAX
 1

	)

632 
	#RTEXT_FILTER_VF
 (1 << 0)

	)

633 
	#RTEXT_FILTER_BRVLAN
 (1 << 1)

	)

	@/usr/include/linux/sockios.h

18 #i‚de‡
_LINUX_SOCKIOS_H


19 
	#_LINUX_SOCKIOS_H


	)

21 
	~<asm/sockios.h
>

24 
	#SIOCINQ
 
FIONREAD


	)

25 
	#SIOCOUTQ
 
TIOCOUTQ


	)

28 
	#SIOCADDRT
 0x890B

	)

29 
	#SIOCDELRT
 0x890C

	)

30 
	#SIOCRTMSG
 0x890D

	)

33 
	#SIOCGIFNAME
 0x8910

	)

34 
	#SIOCSIFLINK
 0x8911

	)

35 
	#SIOCGIFCONF
 0x8912

	)

36 
	#SIOCGIFFLAGS
 0x8913

	)

37 
	#SIOCSIFFLAGS
 0x8914

	)

38 
	#SIOCGIFADDR
 0x8915

	)

39 
	#SIOCSIFADDR
 0x8916

	)

40 
	#SIOCGIFDSTADDR
 0x8917

	)

41 
	#SIOCSIFDSTADDR
 0x8918

	)

42 
	#SIOCGIFBRDADDR
 0x8919

	)

43 
	#SIOCSIFBRDADDR
 0x891®

	)

44 
	#SIOCGIFNETMASK
 0x891b

	)

45 
	#SIOCSIFNETMASK
 0x891¯

	)

46 
	#SIOCGIFMETRIC
 0x891d

	)

47 
	#SIOCSIFMETRIC
 0x891ê

	)

48 
	#SIOCGIFMEM
 0x891‡

	)

49 
	#SIOCSIFMEM
 0x8920

	)

50 
	#SIOCGIFMTU
 0x8921

	)

51 
	#SIOCSIFMTU
 0x8922

	)

52 
	#SIOCSIFNAME
 0x8923

	)

53 
	#SIOCSIFHWADDR
 0x8924

	)

54 
	#SIOCGIFENCAP
 0x8925

	)

55 
	#SIOCSIFENCAP
 0x8926

	)

56 
	#SIOCGIFHWADDR
 0x8927

	)

57 
	#SIOCGIFSLAVE
 0x8929

	)

58 
	#SIOCSIFSLAVE
 0x8930

	)

59 
	#SIOCADDMULTI
 0x8931

	)

60 
	#SIOCDELMULTI
 0x8932

	)

61 
	#SIOCGIFINDEX
 0x8933

	)

62 
	#SIOGIFINDEX
 
SIOCGIFINDEX


	)

63 
	#SIOCSIFPFLAGS
 0x8934

	)

64 
	#SIOCGIFPFLAGS
 0x8935

	)

65 
	#SIOCDIFADDR
 0x8936

	)

66 
	#SIOCSIFHWBROADCAST
 0x8937

	)

67 
	#SIOCGIFCOUNT
 0x8938

	)

69 
	#SIOCGIFBR
 0x8940

	)

70 
	#SIOCSIFBR
 0x8941

	)

72 
	#SIOCGIFTXQLEN
 0x8942

	)

73 
	#SIOCSIFTXQLEN
 0x8943

	)

78 
	#SIOCETHTOOL
 0x8946

	)

80 
	#SIOCGMIIPHY
 0x8947

	)

81 
	#SIOCGMIIREG
 0x8948

	)

82 
	#SIOCSMIIREG
 0x8949

	)

84 
	#SIOCWANDEV
 0x894A

	)

86 
	#SIOCOUTQNSD
 0x894B

	)

90 
	#SIOCDARP
 0x8953

	)

91 
	#SIOCGARP
 0x8954

	)

92 
	#SIOCSARP
 0x8955

	)

95 
	#SIOCDRARP
 0x8960

	)

96 
	#SIOCGRARP
 0x8961

	)

97 
	#SIOCSRARP
 0x8962

	)

101 
	#SIOCGIFMAP
 0x8970

	)

102 
	#SIOCSIFMAP
 0x8971

	)

106 
	#SIOCADDDLCI
 0x8980

	)

107 
	#SIOCDELDLCI
 0x8981

	)

109 
	#SIOCGIFVLAN
 0x8982

	)

110 
	#SIOCSIFVLAN
 0x8983

	)

114 
	#SIOCBONDENSLAVE
 0x8990

	)

115 
	#SIOCBONDRELEASE
 0x8991

	)

116 
	#SIOCBONDSETHWADDR
 0x8992

	)

117 
	#SIOCBONDSLAVEINFOQUERY
 0x8993

	)

118 
	#SIOCBONDINFOQUERY
 0x8994

	)

119 
	#SIOCBONDCHANGEACTIVE
 0x8995

	)

122 
	#SIOCBRADDBR
 0x89a0

	)

123 
	#SIOCBRDELBR
 0x89a1

	)

124 
	#SIOCBRADDIF
 0x89a2

	)

125 
	#SIOCBRDELIF
 0x89a3

	)

128 
	#SIOCSHWTSTAMP
 0x89b0

	)

141 
	#SIOCDEVPRIVATE
 0x89F0

	)

147 
	#SIOCPROTOPRIVATE
 0x89E0

	)

	@/usr/include/linux/types.h

1 #i‚de‡
_LINUX_TYPES_H


2 
	#_LINUX_TYPES_H


	)

4 
	~<asm/ty≥s.h
>

6 #i‚de‡
__ASSEMBLY__


8 
	~<löux/posix_ty≥s.h
>

16 #ifde‡
__CHECKER__


17 
	#__bôwi£__
 
	`__©åibuã__
((
bôwi£
))

	)

19 
	#__bôwi£__


	)

21 #ifde‡
__CHECK_ENDIAN__


22 
	#__bôwi£
 
__bôwi£__


	)

24 
	#__bôwi£


	)

27 
__u16
 
	t__bôwi£
 
	t__À16
;

28 
__u16
 
	t__bôwi£
 
	t__be16
;

29 
__u32
 
	t__bôwi£
 
	t__À32
;

30 
__u32
 
	t__bôwi£
 
	t__be32
;

31 
__u64
 
	t__bôwi£
 
	t__À64
;

32 
__u64
 
	t__bôwi£
 
	t__be64
;

34 
__u16
 
	t__bôwi£
 
	t__sum16
;

35 
__u32
 
	t__bôwi£
 
	t__wsum
;

46 
	#__Æig√d_u64
 
__u64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

47 
	#__Æig√d_be64
 
__be64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

48 
	#__Æig√d_À64
 
__À64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

	@/usr/include/linux/version.h

1 
	#LINUX_VERSION_CODE
 199434

	)

2 
	#KERNEL_VERSION
(
a
,
b
,
c
Ë((◊Ë<< 16Ë+ ((bË<< 8Ë+ (c))

	)

	@/usr/include/malloc.h

20 #i‚de‡
_MALLOC_H


21 
	#_MALLOC_H
 1

	)

23 
	~<„©uªs.h
>

24 
	~<°ddef.h
>

25 
	~<°dio.h
>

26 
	#__mÆloc_±r_t
 *

	)

29 
	#__mÆloc_size_t
 
size_t


	)

30 
	#__mÆloc_±rdiff_t
 
±rdiff_t


	)

32 #ifde‡
__GNUC__


34 
	#__MALLOC_P
(
¨gs
Ë¨g†
__THROW


	)

37 
	#__MALLOC_PMT
(
¨gs
Ë
	)
args

39 #ifde‡
_LIBC


40 
	#__MALLOC_HOOK_VOLATILE


	)

41 
	#__MALLOC_DEPRECATED


	)

43 
	#__MALLOC_HOOK_VOLATILE
 vﬁ©ûe

	)

44 
	#__MALLOC_DEPRECATED
 
__©åibuã_dïªˇãd__


	)

49 
	#__MALLOC_P
(
¨gs
Ë
	)
args

50 
	#__MALLOC_PMT
(
¨gs
Ë
	)
args

51 
	#__MALLOC_HOOK_VOLATILE


	)

52 
	#__MALLOC_DEPRECATED
 
__©åibuã_dïªˇãd__


	)

57 
__BEGIN_DECLS


60 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

63 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

64 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

71 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
)

72 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

75 
	$‰ì
 (*
__±r
Ë
__THROW
;

78 
	$c‰ì
 (*
__±r
Ë
__THROW
;

81 *
	$memÆign
 (
size_t
 
__Æignmít
, size_à
__size
)

82 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

85 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

89 * 
	$pvÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

93 *(*
__m‹ec‹e
Ë(
±rdiff_t
 
__size
);

96 *
	$__deÁu…_m‹ec‹e
 (
±rdiff_t
 
__size
)

97 
__THROW
 
__©åibuã_mÆloc__
;

101 
	smÆlöfo


103 
¨ía
;

104 
‹dblks
;

105 
smblks
;

106 
hblks
;

107 
hblkhd
;

108 
usmblks
;

109 
fsmblks
;

110 
u‹dblks
;

111 
f‹dblks
;

112 
kìpco°
;

116 
mÆlöfo
 
	$mÆlöfo
 (Ë
__THROW
;

119 #i‚de‡
M_MXFAST


120 
	#M_MXFAST
 1

	)

122 #i‚de‡
M_NLBLKS


123 
	#M_NLBLKS
 2

	)

125 #i‚de‡
M_GRAIN


126 
	#M_GRAIN
 3

	)

128 #i‚de‡
M_KEEP


129 
	#M_KEEP
 4

	)

133 
	#M_TRIM_THRESHOLD
 -1

	)

134 
	#M_TOP_PAD
 -2

	)

135 
	#M_MMAP_THRESHOLD
 -3

	)

136 
	#M_MMAP_MAX
 -4

	)

137 
	#M_CHECK_ACTION
 -5

	)

138 
	#M_PERTURB
 -6

	)

139 
	#M_ARENA_TEST
 -7

	)

140 
	#M_ARENA_MAX
 -8

	)

143 
	$mÆl›t
 (
__∑øm
, 
__vÆ
Ë
__THROW
;

147 
	$mÆloc_åim
 (
size_t
 
__∑d
Ë
__THROW
;

151 
size_t
 
	$mÆloc_ußbÀ_size
 (*
__±r
Ë
__THROW
;

154 
	$mÆloc_°©s
 (Ë
__THROW
;

157 
	$mÆloc_öfo
 (
__›ti⁄s
, 
FILE
 *
__Â
Ë
__THROW
;

160 *
	$mÆloc_gë_°©e
 (Ë
__THROW
;

164 
	$mÆloc_£t_°©e
 (*
__±r
Ë
__THROW
;

169 (*
__MALLOC_HOOK_VOLATILE
 
__mÆloc_öôülize_hook
) ()

170 
__MALLOC_DEPRECATED
;

172 (*
__MALLOC_HOOK_VOLATILE
 
__‰ì_hook
Ë(*
__±r
,

173 c⁄° 
__mÆloc_±r_t
)

174 
__MALLOC_DEPRECATED
;

175 *(*
__MALLOC_HOOK_VOLATILE
 
__mÆloc_hook
Ë(
size_t
 
__size
,

176 c⁄° 
__mÆloc_±r_t
)

177 
__MALLOC_DEPRECATED
;

178 *(*
__MALLOC_HOOK_VOLATILE
 
__ªÆloc_hook
Ë(*
__±r
,

179 
size_t
 
__size
,

180 c⁄° 
__mÆloc_±r_t
)

181 
__MALLOC_DEPRECATED
;

182 *(*
__MALLOC_HOOK_VOLATILE
 
__memÆign_hook
Ë(
size_t
 
__Æignmít
,

183 
size_t
 
__size
,

184 c⁄° 
__mÆloc_±r_t
)

185 
__MALLOC_DEPRECATED
;

186 (*
__MALLOC_HOOK_VOLATILE
 
__a·î_m‹ec‹e_hook
) ();

189 
	$__mÆloc_check_öô
 (Ë
__THROW
 
__MALLOC_DEPRECATED
;

192 
__END_DECLS


	@/usr/include/math.h

24 #i‚def 
_MATH_H


25 
	#_MATH_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


33 
	~<bôs/huge_vÆ.h
>

34 #ifde‡
__USE_ISOC99


35 
	~<bôs/huge_vÆf.h
>

36 
	~<bôs/huge_vÆl.h
>

39 
	~<bôs/öf.h
>

42 
	~<bôs/«n.h
>

46 
	~<bôs/m©hdef.h
>

53 
	#__MATHCALL
(
fun˘i⁄
,
suffix
, 
¨gs
) \

54 
	`__MATHDECL
 (
_MdoubÀ_
,
fun˘i⁄
,
suffix
, 
¨gs
)

	)

55 
	#__MATHDECL
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

56 
	`__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
); \

57 
	`__MATHDECL_1
(
ty≥
, 
	`__CONCAT
(
__
,
fun˘i⁄
),
suffix
, 
¨gs
)

	)

58 
	#__MATHCALLX
(
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
) \

59 
	`__MATHDECLX
 (
_MdoubÀ_
,
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
)

	)

60 
	#__MATHDECLX
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
) \

61 
	`__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
Ë
	`__©åibuã__
 (
©åib
); \

62 
	`__MATHDECL_1
(
ty≥
, 
	`__CONCAT
(
__
,
fun˘i⁄
),
suffix
, 
¨gs
Ë
	`__©åibuã__
 (
©åib
)

	)

63 
	#__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

64 
ty≥
 
	`__MATH_PRECNAME
(
fun˘i⁄
,
suffix
Ë
¨gs
 
__THROW


	)

66 
	#_MdoubÀ_
 

	)

67 
	#__MATH_PRECNAME
(
«me
,
r
Ë
	`__CONCAT
“ame,r)

	)

68 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_STD


	)

69 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_STD


	)

70 
	~<bôs/m©hˇŒs.h
>

71 #unde‡
_MdoubÀ_


72 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


73 #unde‡
_MdoubÀ_END_NAMESPACE


74 #unde‡
__MATH_PRECNAME


76 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


82 #i‚de‡
_MÊﬂt_


83 
	#_MÊﬂt_
 

	)

85 
	#_MdoubÀ_
 
_MÊﬂt_


	)

86 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
f
##
	)
r

87 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

88 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

89 
	~<bôs/m©hˇŒs.h
>

90 #unde‡
_MdoubÀ_


91 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


92 #unde‡
_MdoubÀ_END_NAMESPACE


93 #unde‡
__MATH_PRECNAME


95 #i‡!(
deföed
 
__NO_LONG_DOUBLE_MATH
 && deföed 
_LIBC
) \

96 || 
deföed
 
__LDBL_COMPAT


97 #ifde‡
__LDBL_COMPAT


99 #ifde‡
__USE_ISOC99


100 
	$__∆dbl_√xâow¨df
 (
__x
, 
__y
)

101 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

102 #ifde‡
__REDIRECT_NTH


103 
	`__REDIRECT_NTH
 (
√xâow¨df
, (
__x
, 
__y
),

104 
__∆dbl_√xâow¨df
)

105 
	`__©åibuã__
 ((
__c⁄°__
));

106 
	`__REDIRECT_NTH
 (
√xâow¨d
, (
__x
, 
__y
),

107 
√xè·î
Ë
	`__©åibuã__
 ((
__c⁄°__
));

108 
	`__REDIRECT_NTH
 (
√xâow¨dl
,

109 (
__x
, 
__y
),

110 
√xè·î
Ë
	`__©åibuã__
 ((
__c⁄°__
));

115 #i‡
deföed
 
__LDBL_COMPAT
 || deföed 
__NO_LONG_DOUBLE_MATH


117 #unde‡
__MATHDECL_1


118 
	#__MATHDECL_2
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
Æüs
) \

119 
ty≥
 
	`__REDIRECT_NTH
(
	`__MATH_PRECNAME
(
fun˘i⁄
,
suffix
), \

120 
¨gs
, 
Æüs
)

	)

121 
	#__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

122 
	`__MATHDECL_2
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
	`__CONCAT
(fun˘i⁄,suffix))

	)

128 #i‚de‡
_Ml⁄g_doubÀ_


129 
	#_Ml⁄g_doubÀ_
 

	)

131 
	#_MdoubÀ_
 
_Ml⁄g_doubÀ_


	)

132 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
l
##
	)
r

133 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

134 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

135 
	#__MATH_DECLARE_LDOUBLE
 1

	)

136 
	~<bôs/m©hˇŒs.h
>

137 #unde‡
_MdoubÀ_


138 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


139 #unde‡
_MdoubÀ_END_NAMESPACE


140 #unde‡
__MATH_PRECNAME


145 #unde‡
__MATHDECL_1


146 #unde‡
__MATHDECL


147 #unde‡
__MATHCALL


150 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


152 
signgam
;

157 #ifde‡
__USE_ISOC99


195 
FP_NAN
 =

196 
	#FP_NAN
 0

	)

197 
FP_NAN
,

198 
FP_INFINITE
 =

199 
	#FP_INFINITE
 1

	)

200 
FP_INFINITE
,

201 
FP_ZERO
 =

202 
	#FP_ZERO
 2

	)

203 
FP_ZERO
,

204 
FP_SUBNORMAL
 =

205 
	#FP_SUBNORMAL
 3

	)

206 
FP_SUBNORMAL
,

207 
FP_NORMAL
 =

208 
	#FP_NORMAL
 4

	)

209 
FP_NORMAL


213 #ifde‡
__NO_LONG_DOUBLE_MATH


214 
	#Â˛assify
(
x
) \

215 ( (
x
Ë= (Ë? 
	`__Â˛assifyf
 (xË: 
	`__Â˛assify
 (x))

	)

217 
	#Â˛assify
(
x
) \

218 ( (
x
) ==  () \

219 ? 
	`__Â˛assifyf
 (
x
) \

220 :  (
x
) ==  () \

221 ? 
	`__Â˛assify
 (
x
Ë: 
	`__Â˛assifyl
 (x))

	)

225 #ifde‡
__NO_LONG_DOUBLE_MATH


226 
	#signbô
(
x
) \

227 ( (
x
Ë= (Ë? 
	`__signbôf
 (xË: 
	`__signbô
 (x))

	)

229 
	#signbô
(
x
) \

230 ( (
x
) ==  () \

231 ? 
	`__signbôf
 (
x
) \

232 :  (
x
) ==  () \

233 ? 
	`__signbô
 (
x
Ë: 
	`__signbôl
 (x))

	)

237 #ifde‡
__NO_LONG_DOUBLE_MATH


238 
	#isföôe
(
x
) \

239 ( (
x
Ë= (Ë? 
	`__föôef
 (xË: 
	`__föôe
 (x))

	)

241 
	#isföôe
(
x
) \

242 ( (
x
) ==  () \

243 ? 
	`__föôef
 (
x
) \

244 :  (
x
) ==  () \

245 ? 
	`__föôe
 (
x
Ë: 
	`__föôñ
 (x))

	)

249 
	#i¢‹mÆ
(
x
Ë(
	`Â˛assify
 (xË=
FP_NORMAL
)

	)

253 #ifde‡
__NO_LONG_DOUBLE_MATH


254 
	#i¢™
(
x
) \

255 ( (
x
Ë= (Ë? 
	`__i¢™f
 (xË: 
	`__i¢™
 (x))

	)

257 
	#i¢™
(
x
) \

258 ( (
x
) ==  () \

259 ? 
	`__i¢™f
 (
x
) \

260 :  (
x
) ==  () \

261 ? 
	`__i¢™
 (
x
Ë: 
	`__i¢™l
 (x))

	)

265 #ifde‡
__NO_LONG_DOUBLE_MATH


266 
	#isöf
(
x
) \

267 ( (
x
Ë= (Ë? 
	`__isöff
 (xË: 
	`__isöf
 (x))

	)

269 
	#isöf
(
x
) \

270 ( (
x
) ==  () \

271 ? 
	`__isöff
 (
x
) \

272 :  (
x
) ==  () \

273 ? 
	`__isöf
 (
x
Ë: 
	`__isöÊ
 (x))

	)

277 
	#MATH_ERRNO
 1

	)

278 
	#MATH_ERREXCEPT
 2

	)

283 #i‚de‡
__FAST_MATH__


284 
	#m©h_îrh™dlög
 (
MATH_ERRNO
 | 
MATH_ERREXCEPT
)

	)

289 #ifdef 
__USE_MISC


293 
_IEEE_
 = -1,

294 
_SVID_
,

295 
_XOPEN_
,

296 
_POSIX_
,

297 
_ISOC_


298 } 
	t_LIB_VERSION_TYPE
;

303 
_LIB_VERSION_TYPE
 
_LIB_VERSION
;

307 #ifde‡
__USE_SVID


313 #ifde‡
__˝lu•lus


314 
__ex˚±i⁄


316 
ex˚±i⁄


319 
ty≥
;

320 *
«me
;

321 
¨g1
;

322 
¨g2
;

323 
ªtvÆ
;

324 
	}
};

326 #ifde‡
__˝lu•lus


327 
	$m©hîr
 (
__ex˚±i⁄
 *
__exc
Ë
	`throw
 ();

329 
	`m©hîr
 (
ex˚±i⁄
 *
__exc
);

332 
	#X_TLOSS
 1.41484755040568800000e+16

	)

335 
	#DOMAIN
 1

	)

336 
	#SING
 2

	)

337 
	#OVERFLOW
 3

	)

338 
	#UNDERFLOW
 4

	)

339 
	#TLOSS
 5

	)

340 
	#PLOSS
 6

	)

343 
	#HUGE
 3.40282347e+38F

	)

347 #ifde‡
__USE_XOPEN


349 
	#MAXFLOAT
 3.40282347e+38F

	)

356 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN


357 
	#M_E
 2.7182818284590452354

	)

358 
	#M_LOG2E
 1.4426950408889634074

	)

359 
	#M_LOG10E
 0.43429448190325182765

	)

360 
	#M_LN2
 0.69314718055994530942

	)

361 
	#M_LN10
 2.30258509299404568402

	)

362 
	#M_PI
 3.14159265358979323846

	)

363 
	#M_PI_2
 1.57079632679489661923

	)

364 
	#M_PI_4
 0.78539816339744830962

	)

365 
	#M_1_PI
 0.31830988618379067154

	)

366 
	#M_2_PI
 0.63661977236758134308

	)

367 
	#M_2_SQRTPI
 1.12837916709551257390

	)

368 
	#M_SQRT2
 1.41421356237309504880

	)

369 
	#M_SQRT1_2
 0.70710678118654752440

	)

375 #ifde‡
__USE_GNU


376 
	#M_El
 2.718281828459045235360287471352662498L

	)

377 
	#M_LOG2El
 1.442695040888963407359924681001892137L

	)

378 
	#M_LOG10El
 0.434294481903251827651128918916605082L

	)

379 
	#M_LN2l
 0.693147180559945309417232121458176568L

	)

380 
	#M_LN10l
 2.302585092994045684017991454684364208L

	)

381 
	#M_PIl
 3.141592653589793238462643383279502884L

	)

382 
	#M_PI_2l
 1.570796326794896619231321691639751442L

	)

383 
	#M_PI_4l
 0.785398163397448309615660845819875721L

	)

384 
	#M_1_PIl
 0.318309886183790671537767526745028724L

	)

385 
	#M_2_PIl
 0.636619772367581343075535053490057448L

	)

386 
	#M_2_SQRTPIl
 1.128379167095512573896158903121545172L

	)

387 
	#M_SQRT2l
 1.414213562373095048801688724209698079L

	)

388 
	#M_SQRT1_2l
 0.707106781186547524400844362104849039L

	)

395 #i‡
deföed
 
__STRICT_ANSI__
 && !deföed 
__NO_MATH_INLINES


396 
	#__NO_MATH_INLINES
 1

	)

399 #i‡
deföed
 
__USE_ISOC99
 && 
	`__GNUC_PREREQ
(2,97)

406 
	#isgª©î
(
x
, 
y
Ë
	`__buûtö_isgª©î
(x, y)

	)

407 
	#isgª©îequÆ
(
x
, 
y
Ë
	`__buûtö_isgª©îequÆ
(x, y)

	)

408 
	#i¶ess
(
x
, 
y
Ë
	`__buûtö_i¶ess
(x, y)

	)

409 
	#i¶es£quÆ
(
x
, 
y
Ë
	`__buûtö_i¶es£quÆ
(x, y)

	)

410 
	#i¶essgª©î
(
x
, 
y
Ë
	`__buûtö_i¶essgª©î
(x, y)

	)

411 
	#isun‹dîed
(
u
, 
v
Ë
	`__buûtö_isun‹dîed
(u, v)

	)

415 #ifde‡
__USE_EXTERN_INLINES


416 
	~<bôs/m©hölöe.h
>

421 #i‡
deföed
 
__FINITE_MATH_ONLY__
 && __FINITE_MATH_ONLY__ > 0

422 
	~<bôs/m©h-föôe.h
>

425 #ifde‡
__USE_ISOC99


429 #i‚de‡
isgª©î


430 
	#isgª©î
(
x
, 
y
) \

431 (
__exãnsi⁄__
 \

432 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

433 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x > __y; 
	}
}))

	)

437 #i‚de‡
isgª©îequÆ


438 
	#isgª©îequÆ
(
x
, 
y
) \

439 (
__exãnsi⁄__
 \

440 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

441 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x >__y; }))

	)

445 #i‚de‡
i¶ess


446 
	#i¶ess
(
x
, 
y
) \

447 (
__exãnsi⁄__
 \

448 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

449 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x < __y; }))

	)

453 #i‚de‡
i¶es£quÆ


454 
	#i¶es£quÆ
(
x
, 
y
) \

455 (
__exãnsi⁄__
 \

456 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

457 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x <__y; }))

	)

461 #i‚de‡
i¶essgª©î


462 
	#i¶essgª©î
(
x
, 
y
) \

463 (
__exãnsi⁄__
 \

464 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

465 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& (__x < __y || __y < __x); }))

	)

469 #i‚de‡
isun‹dîed


470 
	#isun‹dîed
(
u
, 
v
) \

471 (
__exãnsi⁄__
 \

472 ({ 
	`__ty≥of__
(
u
Ë
__u
 = (u); __ty≥of__(
v
Ë
__v
 = (v); \

473 
	`Â˛assify
 (
__u
Ë=
FP_NAN
 || fp˛assify (
__v
Ë=FP_NAN; }))

	)

478 
	g__END_DECLS


	@/usr/include/net/ethernet.h

21 #i‚de‡
__NET_ETHERNET_H


22 
	#__NET_ETHERNET_H
 1

	)

24 
	~<sys/cdefs.h
>

25 
	~<sys/ty≥s.h
>

26 
	~<löux/if_ëhî.h
>

28 
__BEGIN_DECLS


32 
	sëhî_addr


34 
u_öt8_t
 
	mëhî_addr_o˘ë
[
ETH_ALEN
];

35 } 
__©åibuã__
 ((
__∑cked__
));

38 
	sëhî_hódî


40 
u_öt8_t
 
	mëhî_dho°
[
ETH_ALEN
];

41 
u_öt8_t
 
	mëhî_sho°
[
ETH_ALEN
];

42 
u_öt16_t
 
	mëhî_ty≥
;

43 } 
__©åibuã__
 ((
__∑cked__
));

46 
	#ETHERTYPE_PUP
 0x0200

	)

47 
	#ETHERTYPE_SPRITE
 0x0500

	)

48 
	#ETHERTYPE_IP
 0x0800

	)

49 
	#ETHERTYPE_ARP
 0x0806

	)

50 
	#ETHERTYPE_REVARP
 0x8035

	)

51 
	#ETHERTYPE_AT
 0x809B

	)

52 
	#ETHERTYPE_AARP
 0x80F3

	)

53 
	#ETHERTYPE_VLAN
 0x8100

	)

54 
	#ETHERTYPE_IPX
 0x8137

	)

55 
	#ETHERTYPE_IPV6
 0x86dd

	)

56 
	#ETHERTYPE_LOOPBACK
 0x9000

	)

59 
	#ETHER_ADDR_LEN
 
ETH_ALEN


	)

60 
	#ETHER_TYPE_LEN
 2

	)

61 
	#ETHER_CRC_LEN
 4

	)

62 
	#ETHER_HDR_LEN
 
ETH_HLEN


	)

63 
	#ETHER_MIN_LEN
 (
ETH_ZLEN
 + 
ETHER_CRC_LEN
Ë

	)

64 
	#ETHER_MAX_LEN
 (
ETH_FRAME_LEN
 + 
ETHER_CRC_LEN
Ë

	)

67 
	#ETHER_IS_VALID_LEN
(
foo
) \

68 ((
foo
Ë>
ETHER_MIN_LEN
 && (fooË<
ETHER_MAX_LEN
)

	)

75 
	#ETHERTYPE_TRAIL
 0x1000

	)

76 
	#ETHERTYPE_NTRAILER
 16

	)

78 
	#ETHERMTU
 
ETH_DATA_LEN


	)

79 
	#ETHERMIN
 (
ETHER_MIN_LEN
 - 
ETHER_HDR_LEN
 - 
ETHER_CRC_LEN
)

	)

81 
	g__END_DECLS


	@/usr/include/net/if.h

19 #i‚de‡
_NET_IF_H


20 
	#_NET_IF_H
 1

	)

22 
	~<„©uªs.h
>

24 #ifde‡
__USE_MISC


25 
	~<sys/ty≥s.h
>

26 
	~<sys/sockë.h
>

31 
	#IF_NAMESIZE
 16

	)

33 
	sif_«meödex


35 
	mif_ödex
;

36 *
	mif_«me
;

40 #ifde‡
__USE_MISC


44 
	mIFF_UP
 = 0x1,

45 
	#IFF_UP
 
IFF_UP


	)

46 
	mIFF_BROADCAST
 = 0x2,

47 
	#IFF_BROADCAST
 
IFF_BROADCAST


	)

48 
	mIFF_DEBUG
 = 0x4,

49 
	#IFF_DEBUG
 
IFF_DEBUG


	)

50 
	mIFF_LOOPBACK
 = 0x8,

51 
	#IFF_LOOPBACK
 
IFF_LOOPBACK


	)

52 
	mIFF_POINTOPOINT
 = 0x10,

53 
	#IFF_POINTOPOINT
 
IFF_POINTOPOINT


	)

54 
	mIFF_NOTRAILERS
 = 0x20,

55 
	#IFF_NOTRAILERS
 
IFF_NOTRAILERS


	)

56 
	mIFF_RUNNING
 = 0x40,

57 
	#IFF_RUNNING
 
IFF_RUNNING


	)

58 
	mIFF_NOARP
 = 0x80,

59 
	#IFF_NOARP
 
IFF_NOARP


	)

60 
	mIFF_PROMISC
 = 0x100,

61 
	#IFF_PROMISC
 
IFF_PROMISC


	)

64 
	mIFF_ALLMULTI
 = 0x200,

65 
	#IFF_ALLMULTI
 
IFF_ALLMULTI


	)

67 
	mIFF_MASTER
 = 0x400,

68 
	#IFF_MASTER
 
IFF_MASTER


	)

69 
	mIFF_SLAVE
 = 0x800,

70 
	#IFF_SLAVE
 
IFF_SLAVE


	)

72 
	mIFF_MULTICAST
 = 0x1000,

73 
	#IFF_MULTICAST
 
IFF_MULTICAST


	)

75 
	mIFF_PORTSEL
 = 0x2000,

76 
	#IFF_PORTSEL
 
IFF_PORTSEL


	)

77 
	mIFF_AUTOMEDIA
 = 0x4000,

78 
	#IFF_AUTOMEDIA
 
IFF_AUTOMEDIA


	)

79 
	mIFF_DYNAMIC
 = 0x8000

80 
	#IFF_DYNAMIC
 
IFF_DYNAMIC


	)

88 
	siÁddr


90 
sockaddr
 
	miÁ_addr
;

93 
sockaddr
 
	mifu_brﬂdaddr
;

94 
sockaddr
 
	mifu_d°addr
;

95 } 
	miÁ_ifu
;

96 
iÁ˚
 *
	miÁ_iÂ
;

97 
iÁddr
 *
	miÁ_√xt
;

100 
	#iÁ_brﬂdaddr
 
iÁ_ifu
.
ifu_brﬂdaddr


	)

101 
	#iÁ_d°addr
 
iÁ_ifu
.
ifu_d°addr


	)

111 
	sifm≠


113 
	mmem_°¨t
;

114 
	mmem_íd
;

115 
	mba£_addr
;

116 
	múq
;

117 
	mdma
;

118 
	mp‹t
;

126 
	si‰eq


128 
	#IFHWADDRLEN
 6

	)

129 
	#IFNAMSIZ
 
IF_NAMESIZE


	)

132 
	mi‰n_«me
[
IFNAMSIZ
];

133 } 
	mi‰_i‰n
;

137 
sockaddr
 
	mi‰u_addr
;

138 
sockaddr
 
	mi‰u_d°addr
;

139 
sockaddr
 
	mi‰u_brﬂdaddr
;

140 
sockaddr
 
	mi‰u_√tmask
;

141 
sockaddr
 
	mi‰u_hwaddr
;

142 
	mi‰u_Êags
;

143 
	mi‰u_ivÆue
;

144 
	mi‰u_mtu
;

145 
ifm≠
 
	mi‰u_m≠
;

146 
	mi‰u_¶ave
[
IFNAMSIZ
];

147 
	mi‰u_√w«me
[
IFNAMSIZ
];

148 
__ˇddr_t
 
	mi‰u_d©a
;

149 } 
	mi‰_i‰u
;

151 
	#i‰_«me
 
i‰_i‰n
.
i‰n_«me


	)

152 
	#i‰_hwaddr
 
i‰_i‰u
.
i‰u_hwaddr


	)

153 
	#i‰_addr
 
i‰_i‰u
.
i‰u_addr


	)

154 
	#i‰_d°addr
 
i‰_i‰u
.
i‰u_d°addr


	)

155 
	#i‰_brﬂdaddr
 
i‰_i‰u
.
i‰u_brﬂdaddr


	)

156 
	#i‰_√tmask
 
i‰_i‰u
.
i‰u_√tmask


	)

157 
	#i‰_Êags
 
i‰_i‰u
.
i‰u_Êags


	)

158 
	#i‰_mëric
 
i‰_i‰u
.
i‰u_ivÆue


	)

159 
	#i‰_mtu
 
i‰_i‰u
.
i‰u_mtu


	)

160 
	#i‰_m≠
 
i‰_i‰u
.
i‰u_m≠


	)

161 
	#i‰_¶ave
 
i‰_i‰u
.
i‰u_¶ave


	)

162 
	#i‰_d©a
 
i‰_i‰u
.
i‰u_d©a


	)

163 
	#i‰_ifödex
 
i‰_i‰u
.
i‰u_ivÆue


	)

164 
	#i‰_b™dwidth
 
i‰_i‰u
.
i‰u_ivÆue


	)

165 
	#i‰_qÀn
 
i‰_i‰u
.
i‰u_ivÆue


	)

166 
	#i‰_√w«me
 
i‰_i‰u
.
i‰u_√w«me


	)

167 
	#_IOT_i‰eq
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),16,0,0)

	)

168 
	#_IOT_i‰eq_sh‹t
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),1,0,0)

	)

169 
	#_IOT_i‰eq_öt
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),1,0,0)

	)

176 
	sifc⁄f


178 
	mifc_Àn
;

181 
__ˇddr_t
 
	mifcu_buf
;

182 
i‰eq
 *
	mifcu_ªq
;

183 } 
	mifc_ifcu
;

185 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

186 
	#ifc_ªq
 
ifc_ifcu
.
ifcu_ªq


	)

187 
	#_IOT_ifc⁄f
 
	`_IOT
(
	`_IOTS
(
ifc⁄f
),1,0,0,0,0Ë

	)

190 
__BEGIN_DECLS


193 
	$if_«mëoödex
 (c⁄° *
__i‚ame
Ë
__THROW
;

194 *
	$if_ödext⁄ame
 (
__ifödex
, *
__i‚ame
Ë
__THROW
;

197 
if_«meödex
 *
	$if_«meödex
 (Ë
__THROW
;

200 
	$if_‰ì«meödex
 (
if_«meödex
 *
__±r
Ë
__THROW
;

202 
__END_DECLS


	@/usr/include/net/if_arp.h

22 #i‚de‡
_NET_IF_ARP_H


24 
	#_NET_IF_ARP_H
 1

	)

25 
	~<sys/cdefs.h
>

27 
	~<sys/ty≥s.h
>

28 
	~<sys/sockë.h
>

30 
	g__BEGIN_DECLS


33 
	#MAX_ADDR_LEN
 7

	)

39 
	#ARPOP_REQUEST
 1

	)

40 
	#ARPOP_REPLY
 2

	)

41 
	#ARPOP_RREQUEST
 3

	)

42 
	#ARPOP_RREPLY
 4

	)

43 
	#ARPOP_InREQUEST
 8

	)

44 
	#ARPOP_InREPLY
 9

	)

45 
	#ARPOP_NAK
 10

	)

54 
	s¨phdr


56 
	m¨_hrd
;

57 
	m¨_¥o
;

58 
	m¨_h 
;

59 
	m¨_∂n
;

60 
	m¨_›
;

64 
	m__¨_sha
[
ETH_ALEN
];

65 
	m__¨_sù
[4];

66 
	m__¨_tha
[
ETH_ALEN
];

67 
	m__¨_tù
[4];

73 
	#ARPHRD_NETROM
 0

	)

74 
	#ARPHRD_ETHER
 1

	)

75 
	#ARPHRD_EETHER
 2

	)

76 
	#ARPHRD_AX25
 3

	)

77 
	#ARPHRD_PRONET
 4

	)

78 
	#ARPHRD_CHAOS
 5

	)

79 
	#ARPHRD_IEEE802
 6

	)

80 
	#ARPHRD_ARCNET
 7

	)

81 
	#ARPHRD_APPLETLK
 8

	)

82 
	#ARPHRD_DLCI
 15

	)

83 
	#ARPHRD_ATM
 19

	)

84 
	#ARPHRD_METRICOM
 23

	)

85 
	#ARPHRD_IEEE1394
 24

	)

86 
	#ARPHRD_EUI64
 27

	)

87 
	#ARPHRD_INFINIBAND
 32

	)

90 
	#ARPHRD_SLIP
 256

	)

91 
	#ARPHRD_CSLIP
 257

	)

92 
	#ARPHRD_SLIP6
 258

	)

93 
	#ARPHRD_CSLIP6
 259

	)

94 
	#ARPHRD_RSRVD
 260

	)

95 
	#ARPHRD_ADAPT
 264

	)

96 
	#ARPHRD_ROSE
 270

	)

97 
	#ARPHRD_X25
 271

	)

98 
	#ARPHRD_HWX25
 272

	)

99 
	#ARPHRD_PPP
 512

	)

100 
	#ARPHRD_CISCO
 513

	)

101 
	#ARPHRD_HDLC
 
ARPHRD_CISCO


	)

102 
	#ARPHRD_LAPB
 516

	)

103 
	#ARPHRD_DDCMP
 517

	)

104 
	#ARPHRD_RAWHDLC
 518

	)

106 
	#ARPHRD_TUNNEL
 768

	)

107 
	#ARPHRD_TUNNEL6
 769

	)

108 
	#ARPHRD_FRAD
 770

	)

109 
	#ARPHRD_SKIP
 771

	)

110 
	#ARPHRD_LOOPBACK
 772

	)

111 
	#ARPHRD_LOCALTLK
 773

	)

112 
	#ARPHRD_FDDI
 774

	)

113 
	#ARPHRD_BIF
 775

	)

114 
	#ARPHRD_SIT
 776

	)

115 
	#ARPHRD_IPDDP
 777

	)

116 
	#ARPHRD_IPGRE
 778

	)

117 
	#ARPHRD_PIMREG
 779

	)

118 
	#ARPHRD_HIPPI
 780

	)

119 
	#ARPHRD_ASH
 781

	)

120 
	#ARPHRD_ECONET
 782

	)

121 
	#ARPHRD_IRDA
 783

	)

122 
	#ARPHRD_FCPP
 784

	)

123 
	#ARPHRD_FCAL
 785

	)

124 
	#ARPHRD_FCPL
 786

	)

125 
	#ARPHRD_FCFABRIC
 787

	)

126 
	#ARPHRD_IEEE802_TR
 800

	)

127 
	#ARPHRD_IEEE80211
 801

	)

128 
	#ARPHRD_IEEE80211_PRISM
 802

	)

129 
	#ARPHRD_IEEE80211_RADIOTAP
 803

	)

130 
	#ARPHRD_IEEE802154
 804

	)

131 
	#ARPHRD_IEEE802154_PHY
 805

	)

133 
	#ARPHRD_VOID
 0xFFFF

	)

134 
	#ARPHRD_NONE
 0xFFFE

	)

138 
	s¨¥eq


140 
sockaddr
 
	m¨p_∑
;

141 
sockaddr
 
	m¨p_ha
;

142 
	m¨p_Êags
;

143 
sockaddr
 
	m¨p_√tmask
;

144 
	m¨p_dev
[16];

147 
	s¨¥eq_ﬁd


149 
sockaddr
 
	m¨p_∑
;

150 
sockaddr
 
	m¨p_ha
;

151 
	m¨p_Êags
;

152 
sockaddr
 
	m¨p_√tmask
;

156 
	#ATF_COM
 0x02

	)

157 
	#ATF_PERM
 0x04

	)

158 
	#ATF_PUBL
 0x08

	)

159 
	#ATF_USETRAILERS
 0x10

	)

160 
	#ATF_NETMASK
 0x20

	)

162 
	#ATF_DONTPUB
 0x40

	)

163 
	#ATF_MAGIC
 0x80

	)

167 
	#ARPD_UPDATE
 0x01

	)

168 
	#ARPD_LOOKUP
 0x02

	)

169 
	#ARPD_FLUSH
 0x03

	)

171 
	s¨pd_ªque°


173 
	mªq
;

174 
u_öt32_t
 
	mù
;

175 
	mdev
;

176 
	m°amp
;

177 
	mupd©ed
;

178 
	mha
[
MAX_ADDR_LEN
];

181 
	g__END_DECLS


	@/usr/include/net/route.h

20 #i‚de‡
_NET_ROUTE_H


21 
	#_NET_ROUTE_H
 1

	)

23 
	~<„©uªs.h
>

24 
	~<sys/sockë.h
>

25 
	~<sys/ty≥s.h
>

26 
	~<√töë/ö.h
>

27 
	~<bôs/w‹dsize.h
>

31 
	sπíåy


33 
	mπ_∑d1
;

34 
sockaddr
 
	mπ_d°
;

35 
sockaddr
 
	mπ_g©eway
;

36 
sockaddr
 
	mπ_gímask
;

37 
	mπ_Êags
;

38 
	mπ_∑d2
;

39 
	mπ_∑d3
;

40 
	mπ_tos
;

41 
	mπ_˛ass
;

42 #i‡
__WORDSIZE
 == 64

43 
	mπ_∑d4
[3];

45 
	mπ_∑d4
;

47 
	mπ_mëric
;

48 *
	mπ_dev
;

49 
	mπ_mtu
;

50 
	mπ_wödow
;

51 
	mπ_úâ
;

54 
	#π_mss
 
π_mtu


	)

57 
	sö6_πmsg


59 
ö6_addr
 
	mπmsg_d°
;

60 
ö6_addr
 
	mπmsg_§c
;

61 
ö6_addr
 
	mπmsg_g©eway
;

62 
u_öt32_t
 
	mπmsg_ty≥
;

63 
u_öt16_t
 
	mπmsg_d°_Àn
;

64 
u_öt16_t
 
	mπmsg_§c_Àn
;

65 
u_öt32_t
 
	mπmsg_mëric
;

66 
	mπmsg_öfo
;

67 
u_öt32_t
 
	mπmsg_Êags
;

68 
	mπmsg_ifödex
;

72 
	#RTF_UP
 0x0001

	)

73 
	#RTF_GATEWAY
 0x0002

	)

75 
	#RTF_HOST
 0x0004

	)

76 
	#RTF_REINSTATE
 0x0008

	)

77 
	#RTF_DYNAMIC
 0x0010

	)

78 
	#RTF_MODIFIED
 0x0020

	)

79 
	#RTF_MTU
 0x0040

	)

80 
	#RTF_MSS
 
RTF_MTU


	)

81 
	#RTF_WINDOW
 0x0080

	)

82 
	#RTF_IRTT
 0x0100

	)

83 
	#RTF_REJECT
 0x0200

	)

84 
	#RTF_STATIC
 0x0400

	)

85 
	#RTF_XRESOLVE
 0x0800

	)

86 
	#RTF_NOFORWARD
 0x1000

	)

87 
	#RTF_THROW
 0x2000

	)

88 
	#RTF_NOPMTUDISC
 0x4000

	)

91 
	#RTF_DEFAULT
 0x00010000

	)

92 
	#RTF_ALLONLINK
 0x00020000

	)

93 
	#RTF_ADDRCONF
 0x00040000

	)

95 
	#RTF_LINKRT
 0x00100000

	)

96 
	#RTF_NONEXTHOP
 0x00200000

	)

98 
	#RTF_CACHE
 0x01000000

	)

99 
	#RTF_FLOW
 0x02000000

	)

100 
	#RTF_POLICY
 0x04000000

	)

102 
	#RTCF_VALVE
 0x00200000

	)

103 
	#RTCF_MASQ
 0x00400000

	)

104 
	#RTCF_NAT
 0x00800000

	)

105 
	#RTCF_DOREDIRECT
 0x01000000

	)

106 
	#RTCF_LOG
 0x02000000

	)

107 
	#RTCF_DIRECTSRC
 0x04000000

	)

109 
	#RTF_LOCAL
 0x80000000

	)

110 
	#RTF_INTERFACE
 0x40000000

	)

111 
	#RTF_MULTICAST
 0x20000000

	)

112 
	#RTF_BROADCAST
 0x10000000

	)

113 
	#RTF_NAT
 0x08000000

	)

115 
	#RTF_ADDRCLASSMASK
 0xF8000000

	)

116 
	#RT_ADDRCLASS
(
Êags
Ë((
__u_öt32_t
ËÊag†>> 23)

	)

118 
	#RT_TOS
(
tos
Ë(—osË& 
IPTOS_TOS_MASK
)

	)

120 
	#RT_LOCALADDR
(
Êags
Ë((Êag†& 
RTF_ADDRCLASSMASK
) \

121 =(
RTF_LOCAL
|
RTF_INTERFACE
))

	)

123 
	#RT_CLASS_UNSPEC
 0

	)

124 
	#RT_CLASS_DEFAULT
 253

	)

126 
	#RT_CLASS_MAIN
 254

	)

127 
	#RT_CLASS_LOCAL
 255

	)

128 
	#RT_CLASS_MAX
 255

	)

131 
	#RTMSG_ACK
 
NLMSG_ACK


	)

132 
	#RTMSG_OVERRUN
 
NLMSG_OVERRUN


	)

134 
	#RTMSG_NEWDEVICE
 0x11

	)

135 
	#RTMSG_DELDEVICE
 0x12

	)

136 
	#RTMSG_NEWROUTE
 0x21

	)

137 
	#RTMSG_DELROUTE
 0x22

	)

138 
	#RTMSG_NEWRULE
 0x31

	)

139 
	#RTMSG_DELRULE
 0x32

	)

140 
	#RTMSG_CONTROL
 0x40

	)

142 
	#RTMSG_AR_FAILED
 0x51

	)

	@/usr/include/netdb.h

22 #i‚def 
_NETDB_H


23 
	#_NETDB_H
 1

	)

25 
	~<„©uªs.h
>

27 
	~<√töë/ö.h
>

28 
	~<°döt.h
>

29 #ifde‡
__USE_MISC


32 
	~<Ωc/√tdb.h
>

35 #ifde‡
__USE_GNU


36 
	#__√ed_sigevít_t


	)

37 
	~<bôs/sigöfo.h
>

38 
	#__√ed_time•ec


	)

39 
	~<time.h
>

42 
	~<bôs/√tdb.h
>

45 
	#_PATH_HEQUIV
 "/ëc/ho°s.equiv"

	)

46 
	#_PATH_HOSTS
 "/ëc/ho°s"

	)

47 
	#_PATH_NETWORKS
 "/ëc/√tw‹ks"

	)

48 
	#_PATH_NSSWITCH_CONF
 "/ëc/nsswôch.c⁄f"

	)

49 
	#_PATH_PROTOCOLS
 "/ëc/¥Ÿocﬁs"

	)

50 
	#_PATH_SERVICES
 "/ëc/£rvi˚s"

	)

53 
	g__BEGIN_DECLS


55 #i‡
deföed
 
__USE_MISC
 || !deföed 
__USE_XOPEN2K8


58 
	#h_î∫o
 (*
	`__h_î∫o_loˇti⁄
 ())

	)

61 *
	$__h_î∫o_loˇti⁄
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

65 
	#HOST_NOT_FOUND
 1

	)

66 
	#TRY_AGAIN
 2

	)

68 
	#NO_RECOVERY
 3

	)

70 
	#NO_DATA
 4

	)

73 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


74 
	#NETDB_INTERNAL
 -1

	)

75 
	#NETDB_SUCCESS
 0

	)

76 
	#NO_ADDRESS
 
NO_DATA


	)

79 #i‡
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_XOPEN_EXTENDED


81 
	#IPPORT_RESERVED
 1024

	)

84 #ifde‡
__USE_GNU


86 
	#SCOPE_DELIMITER
 '%'

	)

89 #ifde‡
__USE_MISC


92 
	$hîr‹
 (c⁄° *
__°r
Ë
__THROW
;

95 c⁄° *
	$h°ªº‹
 (
__îr_num
Ë
__THROW
;

100 
	sho°ít


102 *
h_«me
;

103 **
h_Æü£s
;

104 
h_addπy≥
;

105 
h_Àngth
;

106 **
h_addr_li°
;

107 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


108 
	#h_addr
 
h_addr_li°
[0]

	)

117 
	`£tho°ít
 (
__°ay_›í
);

123 
	`ídho°ít
 ();

130 
ho°ít
 *
	`gëho°ít
 ();

137 
ho°ít
 *
	`gëho°byaddr
 (c⁄° *
__addr
, 
__sockÀn_t
 
__Àn
,

138 
__ty≥
);

144 
ho°ít
 *
	`gëho°by«me
 (c⁄° *
__«me
);

146 #ifde‡
__USE_MISC


155 
ho°ít
 *
	`gëho°by«me2
 (c⁄° *
__«me
, 
__af
);

167 
	`gëho°ít_r
 (
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

168 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

169 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

170 *
__ª°ri˘
 
__h_î∫›
);

172 
	`gëho°byaddr_r
 (c⁄° *
__ª°ri˘
 
__addr
, 
__sockÀn_t
 
__Àn
,

173 
__ty≥
,

174 
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

175 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

176 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

177 *
__ª°ri˘
 
__h_î∫›
);

179 
	`gëho°by«me_r
 (c⁄° *
__ª°ri˘
 
__«me
,

180 
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

181 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

182 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

183 *
__ª°ri˘
 
__h_î∫›
);

185 
	`gëho°by«me2_r
 (c⁄° *
__ª°ri˘
 
__«me
, 
__af
,

186 
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

187 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

188 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

189 *
__ª°ri˘
 
__h_î∫›
);

198 
	`£äëít
 (
__°ay_›í
);

204 
	`íd√ã¡
 ();

211 
√ã¡
 *
	`gë√ã¡
 ();

218 
√ã¡
 *
	`gë√tbyaddr
 (
uöt32_t
 
__√t
, 
__ty≥
);

224 
√ã¡
 *
	`gë√tby«me
 (c⁄° *
__«me
);

226 #ifdef 
__USE_MISC


237 
	`gë√ã¡_r
 (
√ã¡
 *
__ª°ri˘
 
__ªsu…_buf
,

238 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

239 
√ã¡
 **
__ª°ri˘
 
__ªsu…
,

240 *
__ª°ri˘
 
__h_î∫›
);

242 
	`gë√tbyaddr_r
 (
uöt32_t
 
__√t
, 
__ty≥
,

243 
√ã¡
 *
__ª°ri˘
 
__ªsu…_buf
,

244 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

245 
√ã¡
 **
__ª°ri˘
 
__ªsu…
,

246 *
__ª°ri˘
 
__h_î∫›
);

248 
	`gë√tby«me_r
 (c⁄° *
__ª°ri˘
 
__«me
,

249 
√ã¡
 *
__ª°ri˘
 
__ªsu…_buf
,

250 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

251 
√ã¡
 **
__ª°ri˘
 
__ªsu…
,

252 *
__ª°ri˘
 
__h_î∫›
);

257 
	s£rvít


259 *
s_«me
;

260 **
s_Æü£s
;

261 
s_p‹t
;

262 *
s_¥Ÿo
;

270 
	`£t£rvít
 (
__°ay_›í
);

276 
	`íd£rvít
 ();

283 
£rvít
 *
	`gë£rvít
 ();

290 
£rvít
 *
	`gë£rvby«me
 (c⁄° *
__«me
, c⁄° *
__¥Ÿo
);

297 
£rvít
 *
	`gë£rvbyp‹t
 (
__p‹t
, c⁄° *
__¥Ÿo
);

300 #ifdef 
__USE_MISC


308 
	`gë£rvít_r
 (
£rvít
 *
__ª°ri˘
 
__ªsu…_buf
,

309 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

310 
£rvít
 **
__ª°ri˘
 
__ªsu…
);

312 
	`gë£rvby«me_r
 (c⁄° *
__ª°ri˘
 
__«me
,

313 c⁄° *
__ª°ri˘
 
__¥Ÿo
,

314 
£rvít
 *
__ª°ri˘
 
__ªsu…_buf
,

315 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

316 
£rvít
 **
__ª°ri˘
 
__ªsu…
);

318 
	`gë£rvbyp‹t_r
 (
__p‹t
, c⁄° *
__ª°ri˘
 
__¥Ÿo
,

319 
£rvít
 *
__ª°ri˘
 
__ªsu…_buf
,

320 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

321 
£rvít
 **
__ª°ri˘
 
__ªsu…
);

326 
	s¥Ÿ€¡


328 *
p_«me
;

329 **
p_Æü£s
;

330 
p_¥Ÿo
;

338 
	`£çrŸ€¡
 (
__°ay_›í
);

344 
	`íd¥Ÿ€¡
 ();

351 
¥Ÿ€¡
 *
	`gë¥Ÿ€¡
 ();

357 
¥Ÿ€¡
 *
	`gë¥Ÿoby«me
 (c⁄° *
__«me
);

363 
¥Ÿ€¡
 *
	`gë¥Ÿobynumbî
 (
__¥Ÿo
);

366 #ifdef 
__USE_MISC


374 
	`gë¥Ÿ€¡_r
 (
¥Ÿ€¡
 *
__ª°ri˘
 
__ªsu…_buf
,

375 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

376 
¥Ÿ€¡
 **
__ª°ri˘
 
__ªsu…
);

378 
	`gë¥Ÿoby«me_r
 (c⁄° *
__ª°ri˘
 
__«me
,

379 
¥Ÿ€¡
 *
__ª°ri˘
 
__ªsu…_buf
,

380 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

381 
¥Ÿ€¡
 **
__ª°ri˘
 
__ªsu…
);

383 
	`gë¥Ÿobynumbî_r
 (
__¥Ÿo
,

384 
¥Ÿ€¡
 *
__ª°ri˘
 
__ªsu…_buf
,

385 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

386 
¥Ÿ€¡
 **
__ª°ri˘
 
__ªsu…
);

395 
	`£äëgª¡
 (c⁄° *
__√tgroup
);

403 
	`íd√tgª¡
 ();

412 
	`gë√tgª¡
 (**
__ª°ri˘
 
__ho°p
,

413 **
__ª°ri˘
 
__u£Ω
,

414 **
__ª°ri˘
 
__domaöp
);

423 
	`ö√tgr
 (c⁄° *
__√tgroup
, c⁄° *
__ho°
,

424 c⁄° *
__u£r
, c⁄° *
__domaö
);

432 
	`gë√tgª¡_r
 (**
__ª°ri˘
 
__ho°p
,

433 **
__ª°ri˘
 
__u£Ω
,

434 **
__ª°ri˘
 
__domaöp
,

435 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
);

439 #ifde‡
__USE_BSD


451 
	`rcmd
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

452 c⁄° *
__ª°ri˘
 
__locu£r
,

453 c⁄° *
__ª°ri˘
 
__ªmu£r
,

454 c⁄° *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
);

463 
	`rcmd_af
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

464 c⁄° *
__ª°ri˘
 
__locu£r
,

465 c⁄° *
__ª°ri˘
 
__ªmu£r
,

466 c⁄° *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
,

467 
ß_Ámûy_t
 
__af
);

479 
	`ªxec
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

480 c⁄° *
__ª°ri˘
 
__«me
,

481 c⁄° *
__ª°ri˘
 
__∑ss
,

482 c⁄° *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
);

491 
	`ªxec_af
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

492 c⁄° *
__ª°ri˘
 
__«me
,

493 c⁄° *
__ª°ri˘
 
__∑ss
,

494 c⁄° *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
,

495 
ß_Ámûy_t
 
__af
);

505 
	`ru£rok
 (c⁄° *
__rho°
, 
__su£r
,

506 c⁄° *
__ªmu£r
, c⁄° *
__locu£r
);

515 
	`ru£rok_af
 (c⁄° *
__rho°
, 
__su£r
,

516 c⁄° *
__ªmu£r
, c⁄° *
__locu£r
,

517 
ß_Ámûy_t
 
__af
);

528 
	`úu£rok
 (
uöt32_t
 
__øddr
, 
__su£r
,

529 c⁄° *
__ªmu£r
, c⁄° *
__locu£r
);

539 
	`úu£rok_af
 (c⁄° *
__øddr
, 
__su£r
,

540 c⁄° *
__ªmu£r
, c⁄° *
__locu£r
,

541 
ß_Ámûy_t
 
__af
);

551 
	`ºesvp‹t
 (*
__Æp‹t
);

560 
	`ºesvp‹t_af
 (*
__Æp‹t
, 
ß_Ámûy_t
 
__af
);

565 #ifdef 
__USE_POSIX


567 
	saddröfo


569 
ai_Êags
;

570 
ai_Ámûy
;

571 
ai_sockty≥
;

572 
ai_¥Ÿocﬁ
;

573 
sockÀn_t
 
ai_addæí
;

574 
sockaddr
 *
ai_addr
;

575 *
ai_ˇn⁄«me
;

576 
addröfo
 *
ai_√xt
;

579 #ifde‡
__USE_GNU


581 
	sgaicb


583 c⁄° *
¨_«me
;

584 c⁄° *
¨_£rvi˚
;

585 c⁄° 
addröfo
 *
¨_ªque°
;

586 
addröfo
 *
¨_ªsu…
;

588 
__ªtu∫
;

589 
__unu£d
[5];

593 
	#GAI_WAIT
 0

	)

594 
	#GAI_NOWAIT
 1

	)

598 
	#AI_PASSIVE
 0x0001

	)

599 
	#AI_CANONNAME
 0x0002

	)

600 
	#AI_NUMERICHOST
 0x0004

	)

601 
	#AI_V4MAPPED
 0x0008

	)

602 
	#AI_ALL
 0x0010

	)

603 
	#AI_ADDRCONFIG
 0x0020

	)

605 #ifde‡
__USE_GNU


606 
	#AI_IDN
 0x0040

	)

609 
	#AI_CANONIDN
 0x0080

	)

610 
	#AI_IDN_ALLOW_UNASSIGNED
 0x0100

	)

612 
	#AI_IDN_USE_STD3_ASCII_RULES
 0x0200

	)

615 
	#AI_NUMERICSERV
 0x0400

	)

618 
	#EAI_BADFLAGS
 -1

	)

619 
	#EAI_NONAME
 -2

	)

620 
	#EAI_AGAIN
 -3

	)

621 
	#EAI_FAIL
 -4

	)

622 
	#EAI_FAMILY
 -6

	)

623 
	#EAI_SOCKTYPE
 -7

	)

624 
	#EAI_SERVICE
 -8

	)

625 
	#EAI_MEMORY
 -10

	)

626 
	#EAI_SYSTEM
 -11

	)

627 
	#EAI_OVERFLOW
 -12

	)

628 #ifde‡
__USE_GNU


629 
	#EAI_NODATA
 -5

	)

630 
	#EAI_ADDRFAMILY
 -9

	)

631 
	#EAI_INPROGRESS
 -100

	)

632 
	#EAI_CANCELED
 -101

	)

633 
	#EAI_NOTCANCELED
 -102

	)

634 
	#EAI_ALLDONE
 -103

	)

635 
	#EAI_INTR
 -104

	)

636 
	#EAI_IDN_ENCODE
 -105

	)

639 #ifde‡
__USE_MISC


640 
	#NI_MAXHOST
 1025

	)

641 
	#NI_MAXSERV
 32

	)

644 
	#NI_NUMERICHOST
 1

	)

645 
	#NI_NUMERICSERV
 2

	)

646 
	#NI_NOFQDN
 4

	)

647 
	#NI_NAMEREQD
 8

	)

648 
	#NI_DGRAM
 16

	)

649 #ifde‡
__USE_GNU


650 
	#NI_IDN
 32

	)

651 
	#NI_IDN_ALLOW_UNASSIGNED
 64

	)

653 
	#NI_IDN_USE_STD3_ASCII_RULES
 128

	)

662 
	`gëaddröfo
 (c⁄° *
__ª°ri˘
 
__«me
,

663 c⁄° *
__ª°ri˘
 
__£rvi˚
,

664 c⁄° 
addröfo
 *
__ª°ri˘
 
__ªq
,

665 
addröfo
 **
__ª°ri˘
 
__∑i
);

668 
	$‰ìaddröfo
 (
addröfo
 *
__ai
Ë
__THROW
;

671 c⁄° *
	$gai_°ªº‹
 (
__ecode
Ë
__THROW
;

677 
	`gë«meöfo
 (c⁄° 
sockaddr
 *
__ª°ri˘
 
__ß
,

678 
sockÀn_t
 
__ßÀn
, *
__ª°ri˘
 
__ho°
,

679 
sockÀn_t
 
__ho°Àn
, *
__ª°ri˘
 
__£rv
,

680 
sockÀn_t
 
__£rvÀn
, 
__Êags
);

683 #ifde‡
__USE_GNU


692 
	`gëaddröfo_a
 (
__mode
, 
gaicb
 *
__li°
[
__ª°ri˘_¨r
],

693 
__ít
, 
sigevít
 *
__ª°ri˘
 
__sig
);

703 
	`gai_su•íd
 (c⁄° 
gaicb
 *c⁄° 
__li°
[], 
__ít
,

704 c⁄° 
time•ec
 *
__timeout
);

707 
	$gai_îr‹
 (
gaicb
 *
__ªq
Ë
__THROW
;

710 
	$gai_ˇn˚l
 (
gaicb
 *
__gaicbp
Ë
__THROW
;

713 
__END_DECLS


	@/usr/include/netinet/icmp6.h

18 #i‚de‡
_NETINET_ICMP6_H


19 
	#_NETINET_ICMP6_H
 1

	)

21 
	~<öây≥s.h
>

22 
	~<°rög.h
>

23 
	~<sys/ty≥s.h
>

24 
	~<√töë/ö.h
>

26 
	#ICMP6_FILTER
 1

	)

28 
	#ICMP6_FILTER_BLOCK
 1

	)

29 
	#ICMP6_FILTER_PASS
 2

	)

30 
	#ICMP6_FILTER_BLOCKOTHERS
 3

	)

31 
	#ICMP6_FILTER_PASSONLY
 4

	)

33 
	sicmp6_fûãr


35 
uöt32_t
 
	micmp6_fût
[8];

38 
	sicmp6_hdr


40 
uöt8_t
 
	micmp6_ty≥
;

41 
uöt8_t
 
	micmp6_code
;

42 
uöt16_t
 
	micmp6_cksum
;

45 
uöt32_t
 
	micmp6_un_d©a32
[1];

46 
uöt16_t
 
	micmp6_un_d©a16
[2];

47 
uöt8_t
 
	micmp6_un_d©a8
[4];

48 } 
	micmp6_d©aun
;

51 
	#icmp6_d©a32
 
icmp6_d©aun
.
icmp6_un_d©a32


	)

52 
	#icmp6_d©a16
 
icmp6_d©aun
.
icmp6_un_d©a16


	)

53 
	#icmp6_d©a8
 
icmp6_d©aun
.
icmp6_un_d©a8


	)

54 
	#icmp6_µå
 
icmp6_d©a32
[0]

	)

55 
	#icmp6_mtu
 
icmp6_d©a32
[0]

	)

56 
	#icmp6_id
 
icmp6_d©a16
[0]

	)

57 
	#icmp6_£q
 
icmp6_d©a16
[1]

	)

58 
	#icmp6_maxdñay
 
icmp6_d©a16
[0]

	)

60 
	#ICMP6_DST_UNREACH
 1

	)

61 
	#ICMP6_PACKET_TOO_BIG
 2

	)

62 
	#ICMP6_TIME_EXCEEDED
 3

	)

63 
	#ICMP6_PARAM_PROB
 4

	)

65 
	#ICMP6_INFOMSG_MASK
 0x80

	)

67 
	#ICMP6_ECHO_REQUEST
 128

	)

68 
	#ICMP6_ECHO_REPLY
 129

	)

69 
	#MLD_LISTENER_QUERY
 130

	)

70 
	#MLD_LISTENER_REPORT
 131

	)

71 
	#MLD_LISTENER_REDUCTION
 132

	)

73 
	#ICMP6_DST_UNREACH_NOROUTE
 0

	)

74 
	#ICMP6_DST_UNREACH_ADMIN
 1

	)

76 
	#ICMP6_DST_UNREACH_BEYONDSCOPE
 2

	)

77 
	#ICMP6_DST_UNREACH_ADDR
 3

	)

78 
	#ICMP6_DST_UNREACH_NOPORT
 4

	)

80 
	#ICMP6_TIME_EXCEED_TRANSIT
 0

	)

81 
	#ICMP6_TIME_EXCEED_REASSEMBLY
 1

	)

83 
	#ICMP6_PARAMPROB_HEADER
 0

	)

84 
	#ICMP6_PARAMPROB_NEXTHEADER
 1

	)

85 
	#ICMP6_PARAMPROB_OPTION
 2

	)

87 
	#ICMP6_FILTER_WILLPASS
(
ty≥
, 
fûãΩ
) \

88 ((((
fûãΩ
)->
icmp6_fût
[(
ty≥
Ë>> 5]Ë& (1 << (—y≥Ë& 31))Ë=0)

	)

90 
	#ICMP6_FILTER_WILLBLOCK
(
ty≥
, 
fûãΩ
) \

91 ((((
fûãΩ
)->
icmp6_fût
[(
ty≥
Ë>> 5]Ë& (1 << (—y≥Ë& 31))Ë!0)

	)

93 
	#ICMP6_FILTER_SETPASS
(
ty≥
, 
fûãΩ
) \

94 ((((
fûãΩ
)->
icmp6_fût
[(
ty≥
Ë>> 5]Ë&~(1 << (—y≥Ë& 31))))

	)

96 
	#ICMP6_FILTER_SETBLOCK
(
ty≥
, 
fûãΩ
) \

97 ((((
fûãΩ
)->
icmp6_fût
[(
ty≥
Ë>> 5]Ë|(1 << (—y≥Ë& 31))))

	)

99 
	#ICMP6_FILTER_SETPASSALL
(
fûãΩ
) \

100 
	`mem£t
 (
fûãΩ
, 0,  (
icmp6_fûãr
));

	)

102 
	#ICMP6_FILTER_SETBLOCKALL
(
fûãΩ
) \

103 
	`mem£t
 (
fûãΩ
, 0xFF,  (
icmp6_fûãr
));

	)

105 
	#ND_ROUTER_SOLICIT
 133

	)

106 
	#ND_ROUTER_ADVERT
 134

	)

107 
	#ND_NEIGHBOR_SOLICIT
 135

	)

108 
	#ND_NEIGHBOR_ADVERT
 136

	)

109 
	#ND_REDIRECT
 137

	)

111 
	snd_rouãr_sﬁicô


113 
icmp6_hdr
 
	mnd_rs_hdr
;

117 
	#nd_rs_ty≥
 
nd_rs_hdr
.
icmp6_ty≥


	)

118 
	#nd_rs_code
 
nd_rs_hdr
.
icmp6_code


	)

119 
	#nd_rs_cksum
 
nd_rs_hdr
.
icmp6_cksum


	)

120 
	#nd_rs_ª£rved
 
nd_rs_hdr
.
icmp6_d©a32
[0]

	)

122 
	snd_rouãr_advît


124 
icmp6_hdr
 
	mnd_ø_hdr
;

125 
uöt32_t
 
	mnd_ø_ªachabÀ
;

126 
uöt32_t
 
	mnd_ø_ªå™smô
;

130 
	#nd_ø_ty≥
 
nd_ø_hdr
.
icmp6_ty≥


	)

131 
	#nd_ø_code
 
nd_ø_hdr
.
icmp6_code


	)

132 
	#nd_ø_cksum
 
nd_ø_hdr
.
icmp6_cksum


	)

133 
	#nd_ø_curh›limô
 
nd_ø_hdr
.
icmp6_d©a8
[0]

	)

134 
	#nd_ø_Êags_ª£rved
 
nd_ø_hdr
.
icmp6_d©a8
[1]

	)

135 
	#ND_RA_FLAG_MANAGED
 0x80

	)

136 
	#ND_RA_FLAG_OTHER
 0x40

	)

137 
	#ND_RA_FLAG_HOME_AGENT
 0x20

	)

138 
	#nd_ø_rouãr_li„time
 
nd_ø_hdr
.
icmp6_d©a16
[1]

	)

140 
	snd_√ighb‹_sﬁicô


142 
icmp6_hdr
 
	mnd_ns_hdr
;

143 
ö6_addr
 
	mnd_ns_èrgë
;

147 
	#nd_ns_ty≥
 
nd_ns_hdr
.
icmp6_ty≥


	)

148 
	#nd_ns_code
 
nd_ns_hdr
.
icmp6_code


	)

149 
	#nd_ns_cksum
 
nd_ns_hdr
.
icmp6_cksum


	)

150 
	#nd_ns_ª£rved
 
nd_ns_hdr
.
icmp6_d©a32
[0]

	)

152 
	snd_√ighb‹_advît


154 
icmp6_hdr
 
	mnd_«_hdr
;

155 
ö6_addr
 
	mnd_«_èrgë
;

159 
	#nd_«_ty≥
 
nd_«_hdr
.
icmp6_ty≥


	)

160 
	#nd_«_code
 
nd_«_hdr
.
icmp6_code


	)

161 
	#nd_«_cksum
 
nd_«_hdr
.
icmp6_cksum


	)

162 
	#nd_«_Êags_ª£rved
 
nd_«_hdr
.
icmp6_d©a32
[0]

	)

163 #i‡ 
BYTE_ORDER
 =
BIG_ENDIAN


164 
	#ND_NA_FLAG_ROUTER
 0x80000000

	)

165 
	#ND_NA_FLAG_SOLICITED
 0x40000000

	)

166 
	#ND_NA_FLAG_OVERRIDE
 0x20000000

	)

168 
	#ND_NA_FLAG_ROUTER
 0x00000080

	)

169 
	#ND_NA_FLAG_SOLICITED
 0x00000040

	)

170 
	#ND_NA_FLAG_OVERRIDE
 0x00000020

	)

173 
	snd_ªdúe˘


175 
icmp6_hdr
 
	mnd_rd_hdr
;

176 
ö6_addr
 
	mnd_rd_èrgë
;

177 
ö6_addr
 
	mnd_rd_d°
;

181 
	#nd_rd_ty≥
 
nd_rd_hdr
.
icmp6_ty≥


	)

182 
	#nd_rd_code
 
nd_rd_hdr
.
icmp6_code


	)

183 
	#nd_rd_cksum
 
nd_rd_hdr
.
icmp6_cksum


	)

184 
	#nd_rd_ª£rved
 
nd_rd_hdr
.
icmp6_d©a32
[0]

	)

186 
	snd_›t_hdr


188 
uöt8_t
 
	mnd_›t_ty≥
;

189 
uöt8_t
 
	mnd_›t_Àn
;

193 
	#ND_OPT_SOURCE_LINKADDR
 1

	)

194 
	#ND_OPT_TARGET_LINKADDR
 2

	)

195 
	#ND_OPT_PREFIX_INFORMATION
 3

	)

196 
	#ND_OPT_REDIRECTED_HEADER
 4

	)

197 
	#ND_OPT_MTU
 5

	)

198 
	#ND_OPT_RTR_ADV_INTERVAL
 7

	)

199 
	#ND_OPT_HOME_AGENT_INFO
 8

	)

201 
	snd_›t_¥efix_öfo


203 
uöt8_t
 
	mnd_›t_pi_ty≥
;

204 
uöt8_t
 
	mnd_›t_pi_Àn
;

205 
uöt8_t
 
	mnd_›t_pi_¥efix_Àn
;

206 
uöt8_t
 
	mnd_›t_pi_Êags_ª£rved
;

207 
uöt32_t
 
	mnd_›t_pi_vÆid_time
;

208 
uöt32_t
 
	mnd_›t_pi_¥e„ºed_time
;

209 
uöt32_t
 
	mnd_›t_pi_ª£rved2
;

210 
ö6_addr
 
	mnd_›t_pi_¥efix
;

213 
	#ND_OPT_PI_FLAG_ONLINK
 0x80

	)

214 
	#ND_OPT_PI_FLAG_AUTO
 0x40

	)

215 
	#ND_OPT_PI_FLAG_RADDR
 0x20

	)

217 
	snd_›t_rd_hdr


219 
uöt8_t
 
	mnd_›t_rh_ty≥
;

220 
uöt8_t
 
	mnd_›t_rh_Àn
;

221 
uöt16_t
 
	mnd_›t_rh_ª£rved1
;

222 
uöt32_t
 
	mnd_›t_rh_ª£rved2
;

226 
	snd_›t_mtu


228 
uöt8_t
 
	mnd_›t_mtu_ty≥
;

229 
uöt8_t
 
	mnd_›t_mtu_Àn
;

230 
uöt16_t
 
	mnd_›t_mtu_ª£rved
;

231 
uöt32_t
 
	mnd_›t_mtu_mtu
;

234 
	smld_hdr


236 
icmp6_hdr
 
	mmld_icmp6_hdr
;

237 
ö6_addr
 
	mmld_addr
;

240 
	#mld_ty≥
 
mld_icmp6_hdr
.
icmp6_ty≥


	)

241 
	#mld_code
 
mld_icmp6_hdr
.
icmp6_code


	)

242 
	#mld_cksum
 
mld_icmp6_hdr
.
icmp6_cksum


	)

243 
	#mld_maxdñay
 
mld_icmp6_hdr
.
icmp6_d©a16
[0]

	)

244 
	#mld_ª£rved
 
mld_icmp6_hdr
.
icmp6_d©a16
[1]

	)

246 
	#ICMP6_ROUTER_RENUMBERING
 138

	)

248 
	sicmp6_rouãr_ªnum


250 
icmp6_hdr
 
	mº_hdr
;

251 
uöt8_t
 
	mº_£gnum
;

252 
uöt8_t
 
	mº_Êags
;

253 
uöt16_t
 
	mº_maxdñay
;

254 
uöt32_t
 
	mº_ª£rved
;

257 
	#º_ty≥
 
º_hdr
.
icmp6_ty≥


	)

258 
	#º_code
 
º_hdr
.
icmp6_code


	)

259 
	#º_cksum
 
º_hdr
.
icmp6_cksum


	)

260 
	#º_£qnum
 
º_hdr
.
icmp6_d©a32
[0]

	)

263 
	#ICMP6_RR_FLAGS_TEST
 0x80

	)

264 
	#ICMP6_RR_FLAGS_REQRESULT
 0x40

	)

265 
	#ICMP6_RR_FLAGS_FORCEAPPLY
 0x20

	)

266 
	#ICMP6_RR_FLAGS_SPECSITE
 0x10

	)

267 
	#ICMP6_RR_FLAGS_PREVDONE
 0x08

	)

269 
	sº_pco_m©ch


271 
uöt8_t
 
	mΩm_code
;

272 
uöt8_t
 
	mΩm_Àn
;

273 
uöt8_t
 
	mΩm_‹döÆ
;

274 
uöt8_t
 
	mΩm_m©chÀn
;

275 
uöt8_t
 
	mΩm_möÀn
;

276 
uöt8_t
 
	mΩm_maxÀn
;

277 
uöt16_t
 
	mΩm_ª£rved
;

278 
ö6_addr
 
	mΩm_¥efix
;

282 
	#RPM_PCO_ADD
 1

	)

283 
	#RPM_PCO_CHANGE
 2

	)

284 
	#RPM_PCO_SETGLOBAL
 3

	)

286 
	sº_pco_u£


288 
uöt8_t
 
	mΩu_u£Àn
;

289 
uöt8_t
 
	mΩu_kì∂í
;

290 
uöt8_t
 
	mΩu_ømask
;

291 
uöt8_t
 
	mΩu_øÊags
;

292 
uöt32_t
 
	mΩu_v…ime
;

293 
uöt32_t
 
	mΩu_∂time
;

294 
uöt32_t
 
	mΩu_Êags
;

295 
ö6_addr
 
	mΩu_¥efix
;

298 
	#ICMP6_RR_PCOUSE_RAFLAGS_ONLINK
 0x20

	)

299 
	#ICMP6_RR_PCOUSE_RAFLAGS_AUTO
 0x10

	)

301 #i‡
BYTE_ORDER
 =
BIG_ENDIAN


302 
	#ICMP6_RR_PCOUSE_FLAGS_DECRVLTIME
 0x80000000

	)

303 
	#ICMP6_RR_PCOUSE_FLAGS_DECRPLTIME
 0x40000000

	)

304 #ñi‡
BYTE_ORDER
 =
LITTLE_ENDIAN


305 
	#ICMP6_RR_PCOUSE_FLAGS_DECRVLTIME
 0x80

	)

306 
	#ICMP6_RR_PCOUSE_FLAGS_DECRPLTIME
 0x40

	)

309 
	sº_ªsu…


311 
uöt16_t
 
	mºr_Êags
;

312 
uöt8_t
 
	mºr_‹döÆ
;

313 
uöt8_t
 
	mºr_m©chedÀn
;

314 
uöt32_t
 
	mºr_ifid
;

315 
ö6_addr
 
	mºr_¥efix
;

318 #i‡
BYTE_ORDER
 =
BIG_ENDIAN


319 
	#ICMP6_RR_RESULT_FLAGS_OOB
 0x0002

	)

320 
	#ICMP6_RR_RESULT_FLAGS_FORBIDDEN
 0x0001

	)

321 #ñi‡
BYTE_ORDER
 =
LITTLE_ENDIAN


322 
	#ICMP6_RR_RESULT_FLAGS_OOB
 0x0200

	)

323 
	#ICMP6_RR_RESULT_FLAGS_FORBIDDEN
 0x0100

	)

327 
	snd_›t_adv_öãrvÆ


329 
uöt8_t
 
	mnd_›t_adv_öãrvÆ_ty≥
;

330 
uöt8_t
 
	mnd_›t_adv_öãrvÆ_Àn
;

331 
uöt16_t
 
	mnd_›t_adv_öãrvÆ_ª£rved
;

332 
uöt32_t
 
	mnd_›t_adv_öãrvÆ_ivÆ
;

336 
	snd_›t_home_agít_öfo


338 
uöt8_t
 
	mnd_›t_home_agít_öfo_ty≥
;

339 
uöt8_t
 
	mnd_›t_home_agít_öfo_Àn
;

340 
uöt16_t
 
	mnd_›t_home_agít_öfo_ª£rved
;

341 
uöt16_t
 
	mnd_›t_home_agít_öfo_¥e„ªn˚
;

342 
uöt16_t
 
	mnd_›t_home_agít_öfo_li„time
;

	@/usr/include/netinet/in.h

19 #i‚def 
_NETINET_IN_H


20 
	#_NETINET_IN_H
 1

	)

22 
	~<„©uªs.h
>

23 
	~<°döt.h
>

24 
	~<sys/sockë.h
>

25 
	~<bôs/ty≥s.h
>

28 
__BEGIN_DECLS


33 
	mIPPROTO_IP
 = 0,

34 
	#IPPROTO_IP
 
IPPROTO_IP


	)

35 
	mIPPROTO_HOPOPTS
 = 0,

36 
	#IPPROTO_HOPOPTS
 
IPPROTO_HOPOPTS


	)

37 
	mIPPROTO_ICMP
 = 1,

38 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

39 
	mIPPROTO_IGMP
 = 2,

40 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

41 
	mIPPROTO_IPIP
 = 4,

42 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

43 
	mIPPROTO_TCP
 = 6,

44 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

45 
	mIPPROTO_EGP
 = 8,

46 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

47 
	mIPPROTO_PUP
 = 12,

48 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

49 
	mIPPROTO_UDP
 = 17,

50 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

51 
	mIPPROTO_IDP
 = 22,

52 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

53 
	mIPPROTO_TP
 = 29,

54 
	#IPPROTO_TP
 
IPPROTO_TP


	)

55 
	mIPPROTO_DCCP
 = 33,

56 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

57 
	mIPPROTO_IPV6
 = 41,

58 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

59 
	mIPPROTO_ROUTING
 = 43,

60 
	#IPPROTO_ROUTING
 
IPPROTO_ROUTING


	)

61 
	mIPPROTO_FRAGMENT
 = 44,

62 
	#IPPROTO_FRAGMENT
 
IPPROTO_FRAGMENT


	)

63 
	mIPPROTO_RSVP
 = 46,

64 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

65 
	mIPPROTO_GRE
 = 47,

66 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

67 
	mIPPROTO_ESP
 = 50,

68 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

69 
	mIPPROTO_AH
 = 51,

70 
	#IPPROTO_AH
 
IPPROTO_AH


	)

71 
	mIPPROTO_ICMPV6
 = 58,

72 
	#IPPROTO_ICMPV6
 
IPPROTO_ICMPV6


	)

73 
	mIPPROTO_NONE
 = 59,

74 
	#IPPROTO_NONE
 
IPPROTO_NONE


	)

75 
	mIPPROTO_DSTOPTS
 = 60,

76 
	#IPPROTO_DSTOPTS
 
IPPROTO_DSTOPTS


	)

77 
	mIPPROTO_MTP
 = 92,

78 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

79 
	mIPPROTO_ENCAP
 = 98,

80 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

81 
	mIPPROTO_PIM
 = 103,

82 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

83 
	mIPPROTO_COMP
 = 108,

84 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

85 
	mIPPROTO_SCTP
 = 132,

86 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

87 
	mIPPROTO_UDPLITE
 = 136,

88 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

89 
	mIPPROTO_RAW
 = 255,

90 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

91 
	mIPPROTO_MAX


96 
uöt16_t
 
	tö_p‹t_t
;

101 
	mIPPORT_ECHO
 = 7,

102 
	mIPPORT_DISCARD
 = 9,

103 
	mIPPORT_SYSTAT
 = 11,

104 
	mIPPORT_DAYTIME
 = 13,

105 
	mIPPORT_NETSTAT
 = 15,

106 
	mIPPORT_FTP
 = 21,

107 
	mIPPORT_TELNET
 = 23,

108 
	mIPPORT_SMTP
 = 25,

109 
	mIPPORT_TIMESERVER
 = 37,

110 
	mIPPORT_NAMESERVER
 = 42,

111 
	mIPPORT_WHOIS
 = 43,

112 
	mIPPORT_MTP
 = 57,

114 
	mIPPORT_TFTP
 = 69,

115 
	mIPPORT_RJE
 = 77,

116 
	mIPPORT_FINGER
 = 79,

117 
	mIPPORT_TTYLINK
 = 87,

118 
	mIPPORT_SUPDUP
 = 95,

121 
	mIPPORT_EXECSERVER
 = 512,

122 
	mIPPORT_LOGINSERVER
 = 513,

123 
	mIPPORT_CMDSERVER
 = 514,

124 
	mIPPORT_EFSSERVER
 = 520,

127 
	mIPPORT_BIFFUDP
 = 512,

128 
	mIPPORT_WHOSERVER
 = 513,

129 
	mIPPORT_ROUTESERVER
 = 520,

132 
	mIPPORT_RESERVED
 = 1024,

135 
	mIPPORT_USERRESERVED
 = 5000

140 
uöt32_t
 
	tö_addr_t
;

141 
	sö_addr


143 
ö_addr_t
 
	ms_addr
;

152 
	#IN_CLASSA
(
a
Ë((((
ö_addr_t
)◊)Ë& 0x80000000Ë=0)

	)

153 
	#IN_CLASSA_NET
 0xff000000

	)

154 
	#IN_CLASSA_NSHIFT
 24

	)

155 
	#IN_CLASSA_HOST
 (0xfffffff‡& ~
IN_CLASSA_NET
)

	)

156 
	#IN_CLASSA_MAX
 128

	)

158 
	#IN_CLASSB
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xc0000000Ë=0x80000000)

	)

159 
	#IN_CLASSB_NET
 0xffff0000

	)

160 
	#IN_CLASSB_NSHIFT
 16

	)

161 
	#IN_CLASSB_HOST
 (0xfffffff‡& ~
IN_CLASSB_NET
)

	)

162 
	#IN_CLASSB_MAX
 65536

	)

164 
	#IN_CLASSC
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xe0000000Ë=0xc0000000)

	)

165 
	#IN_CLASSC_NET
 0xffffff00

	)

166 
	#IN_CLASSC_NSHIFT
 8

	)

167 
	#IN_CLASSC_HOST
 (0xfffffff‡& ~
IN_CLASSC_NET
)

	)

169 
	#IN_CLASSD
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xf0000000Ë=0xe0000000)

	)

170 
	#IN_MULTICAST
(
a
Ë
	`IN_CLASSD
◊)

	)

172 
	#IN_EXPERIMENTAL
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xe0000000Ë=0xe0000000)

	)

173 
	#IN_BADCLASS
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xf0000000Ë=0xf0000000)

	)

176 
	#INADDR_ANY
 ((
ö_addr_t
Ë0x00000000)

	)

178 
	#INADDR_BROADCAST
 ((
ö_addr_t
Ë0xffffffff)

	)

180 
	#INADDR_NONE
 ((
ö_addr_t
Ë0xffffffff)

	)

183 
	#IN_LOOPBACKNET
 127

	)

185 #i‚de‡
INADDR_LOOPBACK


186 
	#INADDR_LOOPBACK
 ((
ö_addr_t
Ë0x7f000001Ë

	)

190 
	#INADDR_UNSPEC_GROUP
 ((
ö_addr_t
Ë0xe0000000Ë

	)

191 
	#INADDR_ALLHOSTS_GROUP
 ((
ö_addr_t
Ë0xe0000001Ë

	)

192 
	#INADDR_ALLRTRS_GROUP
 ((
ö_addr_t
Ë0xe0000002Ë

	)

193 
	#INADDR_MAX_LOCAL_GROUP
 ((
ö_addr_t
Ë0xe00000ffË

	)

197 
	sö6_addr


201 
uöt8_t
 
	m__u6_addr8
[16];

202 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


203 
uöt16_t
 
	m__u6_addr16
[8];

204 
uöt32_t
 
	m__u6_addr32
[4];

206 } 
	m__ö6_u
;

207 
	#s6_addr
 
__ö6_u
.
__u6_addr8


	)

208 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


209 
	#s6_addr16
 
__ö6_u
.
__u6_addr16


	)

210 
	#s6_addr32
 
__ö6_u
.
__u6_addr32


	)

214 c⁄° 
ö6_addr
 
ö6addr_™y
;

215 c⁄° 
ö6_addr
 
ö6addr_lo›back
;

216 
	#IN6ADDR_ANY_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }

	)

217 
	#IN6ADDR_LOOPBACK_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }

	)

219 
	#INET_ADDRSTRLEN
 16

	)

220 
	#INET6_ADDRSTRLEN
 46

	)

224 
	ssockaddr_ö


226 
__SOCKADDR_COMMON
 (
sö_
);

227 
ö_p‹t_t
 
	msö_p‹t
;

228 
ö_addr
 
	msö_addr
;

231 
	msö_zîo
[ (
sockaddr
) -

232 
__SOCKADDR_COMMON_SIZE
 -

233  (
ö_p‹t_t
) -

234  (
ö_addr
)];

238 
	ssockaddr_ö6


240 
__SOCKADDR_COMMON
 (
sö6_
);

241 
ö_p‹t_t
 
	msö6_p‹t
;

242 
uöt32_t
 
	msö6_Êowöfo
;

243 
ö6_addr
 
	msö6_addr
;

244 
uöt32_t
 
	msö6_sc›e_id
;

248 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


250 
	sù_mªq


253 
ö_addr
 
	mimr_mu…üddr
;

256 
ö_addr
 
	mimr_öãrÁ˚
;

259 
	sù_mªq_sour˚


262 
ö_addr
 
	mimr_mu…üddr
;

265 
ö_addr
 
	mimr_öãrÁ˚
;

268 
ö_addr
 
	mimr_sour˚addr
;

274 
	sùv6_mªq


277 
ö6_addr
 
	mùv6mr_mu…üddr
;

280 
	mùv6mr_öãrÁ˚
;

284 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


286 
	sgroup_ªq


289 
uöt32_t
 
	mgr_öãrÁ˚
;

292 
sockaddr_°‹age
 
	mgr_group
;

295 
	sgroup_sour˚_ªq


298 
uöt32_t
 
	mg§_öãrÁ˚
;

301 
sockaddr_°‹age
 
	mg§_group
;

304 
sockaddr_°‹age
 
	mg§_sour˚
;

309 
	sù_msfûãr


312 
ö_addr
 
	mimsf_mu…üddr
;

315 
ö_addr
 
	mimsf_öãrÁ˚
;

318 
uöt32_t
 
	mimsf_fmode
;

321 
uöt32_t
 
	mimsf_num§c
;

323 
ö_addr
 
	mimsf_¶i°
[1];

326 
	#IP_MSFILTER_SIZE
(
num§c
Ë( (
ù_msfûãr
) \

327 -  (
ö_addr
) \

328 + (
num§c
Ë*  (
ö_addr
))

	)

330 
	sgroup_fûãr


333 
uöt32_t
 
	mgf_öãrÁ˚
;

336 
sockaddr_°‹age
 
	mgf_group
;

339 
uöt32_t
 
	mgf_fmode
;

342 
uöt32_t
 
	mgf_num§c
;

344 
sockaddr_°‹age
 
	mgf_¶i°
[1];

347 
	#GROUP_FILTER_SIZE
(
num§c
Ë( (
group_fûãr
) \

348 -  (
sockaddr_°‹age
) \

349 + ((
num§c
) \

350 *  (
sockaddr_°‹age
)))

	)

355 
	~<bôs/ö.h
>

364 
uöt32_t
 
	$¡ohl
 (
uöt32_t
 
__√é⁄g
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

365 
uöt16_t
 
	$¡ohs
 (
uöt16_t
 
__√tsh‹t
)

366 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

367 
uöt32_t
 
	$ht⁄l
 (
uöt32_t
 
__ho°l⁄g
)

368 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

369 
uöt16_t
 
	$ht⁄s
 (
uöt16_t
 
__ho°sh‹t
)

370 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

372 
	~<ídün.h
>

375 
	~<bôs/byãsw≠.h
>

377 #ifde‡
__OPTIMIZE__


381 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


384 
	#¡ohl
(
x
Ë(x)

	)

385 
	#¡ohs
(
x
Ë(x)

	)

386 
	#ht⁄l
(
x
Ë(x)

	)

387 
	#ht⁄s
(
x
Ë(x)

	)

389 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


390 
	#¡ohl
(
x
Ë
	`__bsw≠_32
 (x)

	)

391 
	#¡ohs
(
x
Ë
	`__bsw≠_16
 (x)

	)

392 
	#ht⁄l
(
x
Ë
	`__bsw≠_32
 (x)

	)

393 
	#ht⁄s
(
x
Ë
	`__bsw≠_16
 (x)

	)

398 #ifde‡
__GNUC__


399 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

400 (
__exãnsi⁄__
 \

401 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

402 
__a
->
s6_addr32
[0] == 0 \

403 && 
__a
->
s6_addr32
[1] == 0 \

404 && 
__a
->
s6_addr32
[2] == 0 \

405 && 
__a
->
s6_addr32
[3] =0; 
	}
}))

	)

407 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

408 (
__exãnsi⁄__
 \

409 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

410 
__a
->
s6_addr32
[0] == 0 \

411 && 
__a
->
s6_addr32
[1] == 0 \

412 && 
__a
->
s6_addr32
[2] == 0 \

413 && 
__a
->
s6_addr32
[3] =
	`ht⁄l
 (1); }))

	)

415 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

416 (
__exãnsi⁄__
 \

417 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

418 (
__a
->
s6_addr32
[0] & 
	`ht⁄l
 (0xffc00000)Ë=ht⁄»(0x„800000); }))

	)

420 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

421 (
__exãnsi⁄__
 \

422 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

423 (
__a
->
s6_addr32
[0] & 
	`ht⁄l
 (0xffc00000)Ë=ht⁄»(0x„c00000); }))

	)

425 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

426 (
__exãnsi⁄__
 \

427 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

428 
__a
->
s6_addr32
[0] == 0 \

429 && 
__a
->
s6_addr32
[1] == 0 \

430 && 
__a
->
s6_addr32
[2] =
	`ht⁄l
 (0xffff); }))

	)

432 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

433 (
__exãnsi⁄__
 \

434 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

435 
__a
->
s6_addr32
[0] == 0 \

436 && 
__a
->
s6_addr32
[1] == 0 \

437 && 
__a
->
s6_addr32
[2] == 0 \

438 && 
	`¡ohl
 (
__a
->
s6_addr32
[3]Ë> 1; }))

	)

440 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

441 (
__exãnsi⁄__
 \

442 ({ c⁄° 
ö6_addr
 *
__a
 = (c⁄° ö6_add∏*Ë(
a
); \

443 c⁄° 
ö6_addr
 *
__b
 = (c⁄° ö6_add∏*Ë(
b
); \

444 
__a
->
s6_addr32
[0] =
__b
->s6_addr32[0] \

445 && 
__a
->
s6_addr32
[1] =
__b
->s6_addr32[1] \

446 && 
__a
->
s6_addr32
[2] =
__b
->s6_addr32[2] \

447 && 
__a
->
s6_addr32
[3] =
__b
->s6_addr32[3]; }))

	)

449 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

450 (((c⁄° 
uöt32_t
 *Ë(
a
))[0] == 0 \

451 && ((c⁄° 
uöt32_t
 *Ë(
a
))[1] == 0 \

452 && ((c⁄° 
uöt32_t
 *Ë(
a
))[2] == 0 \

453 && ((c⁄° 
uöt32_t
 *Ë(
a
))[3] =0)

	)

455 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

456 (((c⁄° 
uöt32_t
 *Ë(
a
))[0] == 0 \

457 && ((c⁄° 
uöt32_t
 *Ë(
a
))[1] == 0 \

458 && ((c⁄° 
uöt32_t
 *Ë(
a
))[2] == 0 \

459 && ((c⁄° 
uöt32_t
 *Ë(
a
))[3] =
	`ht⁄l
 (1))

	)

461 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

462 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] & 
	`ht⁄l
 (0xffc00000)) \

463 =
	`ht⁄l
 (0x„800000))

	)

465 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

466 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] & 
	`ht⁄l
 (0xffc00000)) \

467 =
	`ht⁄l
 (0x„c00000))

	)

469 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

470 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] == 0) \

471 && (((c⁄° 
uöt32_t
 *Ë(
a
))[1] == 0) \

472 && (((c⁄° 
uöt32_t
 *Ë(
a
))[2] =
	`ht⁄l
 (0xffff)))

	)

474 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

475 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] == 0) \

476 && (((c⁄° 
uöt32_t
 *Ë(
a
))[1] == 0) \

477 && (((c⁄° 
uöt32_t
 *Ë(
a
))[2] == 0) \

478 && (
	`¡ohl
 (((c⁄° 
uöt32_t
 *Ë(
a
))[3]Ë> 1))

	)

480 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

481 ((((c⁄° 
uöt32_t
 *Ë(
a
))[0] =((c⁄° uöt32_à*Ë(
b
))[0]) \

482 && (((c⁄° 
uöt32_t
 *Ë(
a
))[1] =((c⁄° uöt32_à*Ë(
b
))[1]) \

483 && (((c⁄° 
uöt32_t
 *Ë(
a
))[2] =((c⁄° uöt32_à*Ë(
b
))[2]) \

484 && (((c⁄° 
uöt32_t
 *Ë(
a
))[3] =((c⁄° uöt32_à*Ë(
b
))[3]))

	)

487 
	#IN6_IS_ADDR_MULTICAST
(
a
Ë(((c⁄° 
uöt8_t
 *Ë◊))[0] =0xff)

	)

489 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_GNU


491 
	$bödªsvp‹t
 (
__sockfd
, 
sockaddr_ö
 *
__sock_ö
Ë
__THROW
;

494 
	$bödªsvp‹t6
 (
__sockfd
, 
sockaddr_ö6
 *
__sock_ö
)

495 
__THROW
;

499 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

500 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

501 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x1))

	)

503 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

504 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

505 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x2))

	)

507 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

508 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

509 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x5))

	)

511 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

512 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

513 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x8))

	)

515 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

516 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

517 && ((((c⁄° 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0xe))

	)

520 #ifde‡
__USE_GNU


521 
cmsghdr
;

524 
	sö6_pktöfo


526 
ö6_addr
 
ùi6_addr
;

527 
ùi6_ifödex
;

531 
	sù6_mtuöfo


533 
sockaddr_ö6
 
ù6m_addr
;

534 
uöt32_t
 
ù6m_mtu
;

539 
	$öë6_›ti⁄_•a˚
 (
__nbyãs
)

540 
__THROW
 
__©åibuã_dïªˇãd__
;

541 
	$öë6_›ti⁄_öô
 (*
__bp
, 
cmsghdr
 **
__cmsgp
,

542 
__ty≥
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

543 
	$öë6_›ti⁄_≠≥nd
 (
cmsghdr
 *
__cmsg
,

544 c⁄° 
uöt8_t
 *
__ty≥p
, 
__mu…x
,

545 
__∂usy
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

546 
uöt8_t
 *
	$öë6_›ti⁄_Æloc
 (
cmsghdr
 *
__cmsg
, 
__d©Æí
,

547 
__mu…x
, 
__∂usy
)

548 
__THROW
 
__©åibuã_dïªˇãd__
;

549 
	$öë6_›ti⁄_√xt
 (c⁄° 
cmsghdr
 *
__cmsg
,

550 
uöt8_t
 **
__çåp
)

551 
__THROW
 
__©åibuã_dïªˇãd__
;

552 
	$öë6_›ti⁄_föd
 (c⁄° 
cmsghdr
 *
__cmsg
,

553 
uöt8_t
 **
__çåp
, 
__ty≥
)

554 
__THROW
 
__©åibuã_dïªˇãd__
;

558 
	$öë6_›t_öô
 (*
__extbuf
, 
sockÀn_t
 
__exéí
Ë
__THROW
;

559 
	$öë6_›t_≠≥nd
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
,

560 
uöt8_t
 
__ty≥
, 
sockÀn_t
 
__Àn
, uöt8_à
__Æign
,

561 **
__d©abuÂ
Ë
__THROW
;

562 
	$öë6_›t_föish
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
)

563 
__THROW
;

564 
	$öë6_›t_£t_vÆ
 (*
__d©abuf
, 
__off£t
, *
__vÆ
,

565 
sockÀn_t
 
__vÆÀn
Ë
__THROW
;

566 
	$öë6_›t_√xt
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
,

567 
uöt8_t
 *
__ty≥p
, 
sockÀn_t
 *
__À≈
,

568 **
__d©abuÂ
Ë
__THROW
;

569 
	$öë6_›t_föd
 (*
__extbuf
, 
sockÀn_t
 
__exéí
, 
__off£t
,

570 
uöt8_t
 
__ty≥
, 
sockÀn_t
 *
__À≈
,

571 **
__d©abuÂ
Ë
__THROW
;

572 
	$öë6_›t_gë_vÆ
 (*
__d©abuf
, 
__off£t
, *
__vÆ
,

573 
sockÀn_t
 
__vÆÀn
Ë
__THROW
;

577 
sockÀn_t
 
	$öë6_πh_•a˚
 (
__ty≥
, 
__£gmíts
Ë
__THROW
;

578 *
	$öë6_πh_öô
 (*
__bp
, 
sockÀn_t
 
__bp_Àn
, 
__ty≥
,

579 
__£gmíts
Ë
__THROW
;

580 
	$öë6_πh_add
 (*
__bp
, c⁄° 
ö6_addr
 *
__addr
Ë
__THROW
;

581 
	$öë6_πh_ªvî£
 (c⁄° *
__ö
, *
__out
Ë
__THROW
;

582 
	$öë6_πh_£gmíts
 (c⁄° *
__bp
Ë
__THROW
;

583 
ö6_addr
 *
	$öë6_πh_gëaddr
 (c⁄° *
__bp
, 
__ödex
)

584 
__THROW
;

590 
	$gëùv4sour˚fûãr
 (
__s
, 
ö_addr
 
__öãrÁ˚_addr
,

591 
ö_addr
 
__group
, 
uöt32_t
 *
__fmode
,

592 
uöt32_t
 *
__num§c
, 
ö_addr
 *
__¶i°
)

593 
__THROW
;

596 
	$£tùv4sour˚fûãr
 (
__s
, 
ö_addr
 
__öãrÁ˚_addr
,

597 
ö_addr
 
__group
, 
uöt32_t
 
__fmode
,

598 
uöt32_t
 
__num§c
,

599 c⁄° 
ö_addr
 *
__¶i°
)

600 
__THROW
;

604 
	$gësour˚fûãr
 (
__s
, 
uöt32_t
 
__öãrÁ˚_addr
,

605 c⁄° 
sockaddr
 *
__group
,

606 
sockÀn_t
 
__grou∂í
, 
uöt32_t
 *
__fmode
,

607 
uöt32_t
 *
__num§c
,

608 
sockaddr_°‹age
 *
__¶i°
Ë
__THROW
;

611 
	$£tsour˚fûãr
 (
__s
, 
uöt32_t
 
__öãrÁ˚_addr
,

612 c⁄° 
sockaddr
 *
__group
,

613 
sockÀn_t
 
__grou∂í
, 
uöt32_t
 
__fmode
,

614 
uöt32_t
 
__num§c
,

615 c⁄° 
sockaddr_°‹age
 *
__¶i°
Ë
__THROW
;

618 
__END_DECLS


	@/usr/include/netinet/tcp.h

32 #i‚de‡
_NETINET_TCP_H


33 
	#_NETINET_TCP_H
 1

	)

35 
	~<„©uªs.h
>

40 
	#TCP_NODELAY
 1

	)

41 
	#TCP_MAXSEG
 2

	)

42 
	#TCP_CORK
 3

	)

43 
	#TCP_KEEPIDLE
 4

	)

44 
	#TCP_KEEPINTVL
 5

	)

45 
	#TCP_KEEPCNT
 6

	)

46 
	#TCP_SYNCNT
 7

	)

47 
	#TCP_LINGER2
 8

	)

48 
	#TCP_DEFER_ACCEPT
 9

	)

49 
	#TCP_WINDOW_CLAMP
 10

	)

50 
	#TCP_INFO
 11

	)

51 
	#TCP_QUICKACK
 12

	)

52 
	#TCP_CONGESTION
 13

	)

53 
	#TCP_MD5SIG
 14

	)

54 
	#TCP_COOKIE_TRANSACTIONS
 15

	)

55 
	#TCP_THIN_LINEAR_TIMEOUTS
 16

	)

56 
	#TCP_THIN_DUPACK
 17

	)

57 
	#TCP_USER_TIMEOUT
 18

	)

58 
	#TCP_REPAIR
 19

	)

59 
	#TCP_REPAIR_QUEUE
 20

	)

60 
	#TCP_QUEUE_SEQ
 21

	)

61 
	#TCP_REPAIR_OPTIONS
 22

	)

62 
	#TCP_FASTOPEN
 23

	)

64 #ifde‡
__USE_MISC


65 
	~<sys/ty≥s.h
>

66 
	~<sys/sockë.h
>

68 #ifde‡
__FAVOR_BSD


69 
u_öt32_t
 
	tt˝_£q
;

74 
	st˝hdr


76 
u_öt16_t
 
	mth_•‹t
;

77 
u_öt16_t
 
	mth_dp‹t
;

78 
t˝_£q
 
	mth_£q
;

79 
t˝_£q
 
	mth_ack
;

80 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


81 
u_öt8_t
 
	mth_x2
:4;

82 
u_öt8_t
 
	mth_off
:4;

84 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


85 
u_öt8_t
 
	mth_off
:4;

86 
u_öt8_t
 
	mth_x2
:4;

88 
u_öt8_t
 
	mth_Êags
;

89 
	#TH_FIN
 0x01

	)

90 
	#TH_SYN
 0x02

	)

91 
	#TH_RST
 0x04

	)

92 
	#TH_PUSH
 0x08

	)

93 
	#TH_ACK
 0x10

	)

94 
	#TH_URG
 0x20

	)

95 
u_öt16_t
 
	mth_wö
;

96 
u_öt16_t
 
	mth_sum
;

97 
u_öt16_t
 
	mth_uΩ
;

101 
	st˝hdr


103 
u_öt16_t
 
	msour˚
;

104 
u_öt16_t
 
	mde°
;

105 
u_öt32_t
 
	m£q
;

106 
u_öt32_t
 
	mack_£q
;

107 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


108 
u_öt16_t
 
	mªs1
:4;

109 
u_öt16_t
 
	mdoff
:4;

110 
u_öt16_t
 
	mfö
:1;

111 
u_öt16_t
 
	msyn
:1;

112 
u_öt16_t
 
	mr°
:1;

113 
u_öt16_t
 
	mpsh
:1;

114 
u_öt16_t
 
	mack
:1;

115 
u_öt16_t
 
	murg
:1;

116 
u_öt16_t
 
	mªs2
:2;

117 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


118 
u_öt16_t
 
	mdoff
:4;

119 
u_öt16_t
 
	mªs1
:4;

120 
u_öt16_t
 
	mªs2
:2;

121 
u_öt16_t
 
	murg
:1;

122 
u_öt16_t
 
	mack
:1;

123 
u_öt16_t
 
	mpsh
:1;

124 
u_öt16_t
 
	mr°
:1;

125 
u_öt16_t
 
	msyn
:1;

126 
u_öt16_t
 
	mfö
:1;

130 
u_öt16_t
 
	mwödow
;

131 
u_öt16_t
 
	mcheck
;

132 
u_öt16_t
 
	murg_±r
;

138 
	mTCP_ESTABLISHED
 = 1,

139 
	mTCP_SYN_SENT
,

140 
	mTCP_SYN_RECV
,

141 
	mTCP_FIN_WAIT1
,

142 
	mTCP_FIN_WAIT2
,

143 
	mTCP_TIME_WAIT
,

144 
	mTCP_CLOSE
,

145 
	mTCP_CLOSE_WAIT
,

146 
	mTCP_LAST_ACK
,

147 
	mTCP_LISTEN
,

148 
	mTCP_CLOSING


151 
	#TCPOPT_EOL
 0

	)

152 
	#TCPOPT_NOP
 1

	)

153 
	#TCPOPT_MAXSEG
 2

	)

154 
	#TCPOLEN_MAXSEG
 4

	)

155 
	#TCPOPT_WINDOW
 3

	)

156 
	#TCPOLEN_WINDOW
 3

	)

157 
	#TCPOPT_SACK_PERMITTED
 4

	)

158 
	#TCPOLEN_SACK_PERMITTED
 2

	)

159 
	#TCPOPT_SACK
 5

	)

160 
	#TCPOPT_TIMESTAMP
 8

	)

161 
	#TCPOLEN_TIMESTAMP
 10

	)

162 
	#TCPOLEN_TSTAMP_APPA
 (
TCPOLEN_TIMESTAMP
+2Ë

	)

164 
	#TCPOPT_TSTAMP_HDR
 \

165 (
TCPOPT_NOP
<<24|TCPOPT_NOP<<16|
TCPOPT_TIMESTAMP
<<8|
TCPOLEN_TIMESTAMP
)

	)

173 
	#TCP_MSS
 512

	)

175 
	#TCP_MAXWIN
 65535

	)

177 
	#TCP_MAX_WINSHIFT
 14

	)

179 
	#SOL_TCP
 6

	)

182 
	#TCPI_OPT_TIMESTAMPS
 1

	)

183 
	#TCPI_OPT_SACK
 2

	)

184 
	#TCPI_OPT_WSCALE
 4

	)

185 
	#TCPI_OPT_ECN
 8

	)

186 
	#TCPI_OPT_ECN_SEEN
 16

	)

187 
	#TCPI_OPT_SYN_DATA
 32

	)

190 
	et˝_ˇ_°©e


192 
	mTCP_CA_O≥n
 = 0,

193 
	mTCP_CA_Dis‹dî
 = 1,

194 
	mTCP_CA_CWR
 = 2,

195 
	mTCP_CA_Recovîy
 = 3,

196 
	mTCP_CA_Loss
 = 4

199 
	st˝_öfo


201 
u_öt8_t
 
	mt˝i_°©e
;

202 
u_öt8_t
 
	mt˝i_ˇ_°©e
;

203 
u_öt8_t
 
	mt˝i_ªå™smôs
;

204 
u_öt8_t
 
	mt˝i_¥obes
;

205 
u_öt8_t
 
	mt˝i_backoff
;

206 
u_öt8_t
 
	mt˝i_›ti⁄s
;

207 
u_öt8_t
 
	mt˝i_¢d_wsˇÀ
 : 4, 
	mt˝i_rcv_wsˇÀ
 : 4;

209 
u_öt32_t
 
	mt˝i_πo
;

210 
u_öt32_t
 
	mt˝i_©o
;

211 
u_öt32_t
 
	mt˝i_¢d_mss
;

212 
u_öt32_t
 
	mt˝i_rcv_mss
;

214 
u_öt32_t
 
	mt˝i_u«cked
;

215 
u_öt32_t
 
	mt˝i_ßcked
;

216 
u_öt32_t
 
	mt˝i_lo°
;

217 
u_öt32_t
 
	mt˝i_ªå™s
;

218 
u_öt32_t
 
	mt˝i_Áckës
;

221 
u_öt32_t
 
	mt˝i_œ°_d©a_£¡
;

222 
u_öt32_t
 
	mt˝i_œ°_ack_£¡
;

223 
u_öt32_t
 
	mt˝i_œ°_d©a_ªcv
;

224 
u_öt32_t
 
	mt˝i_œ°_ack_ªcv
;

227 
u_öt32_t
 
	mt˝i_pmtu
;

228 
u_öt32_t
 
	mt˝i_rcv_s°hªsh
;

229 
u_öt32_t
 
	mt˝i_πt
;

230 
u_öt32_t
 
	mt˝i_πtv¨
;

231 
u_öt32_t
 
	mt˝i_¢d_s°hªsh
;

232 
u_öt32_t
 
	mt˝i_¢d_cwnd
;

233 
u_öt32_t
 
	mt˝i_advmss
;

234 
u_öt32_t
 
	mt˝i_ª‹dîög
;

236 
u_öt32_t
 
	mt˝i_rcv_πt
;

237 
u_öt32_t
 
	mt˝i_rcv_•a˚
;

239 
u_öt32_t
 
	mt˝i_tŸÆ_ªå™s
;

244 
	#TCP_MD5SIG_MAXKEYLEN
 80

	)

246 
	st˝_md5sig


248 
sockaddr_°‹age
 
	mt˝m_addr
;

249 
u_öt16_t
 
	m__t˝m_∑d1
;

250 
u_öt16_t
 
	mt˝m_keyÀn
;

251 
u_öt32_t
 
	m__t˝m_∑d2
;

252 
u_öt8_t
 
	mt˝m_key
[
TCP_MD5SIG_MAXKEYLEN
];

256 
	st˝_ª∑ú_›t


258 
u_öt32_t
 
	m›t_code
;

259 
u_öt32_t
 
	m›t_vÆ
;

265 
	mTCP_NO_QUEUE
,

266 
	mTCP_RECV_QUEUE
,

267 
	mTCP_SEND_QUEUE
,

268 
	mTCP_QUEUES_NR
,

272 
	#TCP_COOKIE_MIN
 8

	)

273 
	#TCP_COOKIE_MAX
 16

	)

274 
	#TCP_COOKIE_PAIR_SIZE
 (2*
TCP_COOKIE_MAX
)

	)

277 
	#TCP_COOKIE_IN_ALWAYS
 (1 << 0Ë

	)

278 
	#TCP_COOKIE_OUT_NEVER
 (1 << 1Ë

	)

282 
	#TCP_S_DATA_IN
 (1 << 2Ë

	)

283 
	#TCP_S_DATA_OUT
 (1 << 3Ë

	)

285 
	#TCP_MSS_DEFAULT
 536U

	)

286 
	#TCP_MSS_DESIRED
 1220U

	)

288 
	st˝_cookõ_å™ß˘i⁄s


290 
u_öt16_t
 
	mt˝˘_Êags
;

291 
u_öt8_t
 
	m__t˝˘_∑d1
;

292 
u_öt8_t
 
	mt˝˘_cookõ_desúed
;

293 
u_öt16_t
 
	mt˝˘_s_d©a_desúed
;

294 
u_öt16_t
 
	mt˝˘_u£d
;

295 
u_öt8_t
 
	mt˝˘_vÆue
[
TCP_MSS_DEFAULT
];

	@/usr/include/pcap.h

45 
	~<pˇp/pˇp.h
>

	@/usr/include/poll.h

1 
	~<sys/pﬁl.h
>

	@/usr/include/pthread.h

18 #i‚de‡
_PTHREAD_H


19 
	#_PTHREAD_H
 1

	)

21 
	~<„©uªs.h
>

22 
	~<ídün.h
>

23 
	~<sched.h
>

24 
	~<time.h
>

26 
	~<bôs/±hªadty≥s.h
>

27 
	~<bôs/£tjmp.h
>

28 
	~<bôs/w‹dsize.h
>

34 
	mPTHREAD_CREATE_JOINABLE
,

35 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

36 
	mPTHREAD_CREATE_DETACHED


37 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

44 
	mPTHREAD_MUTEX_TIMED_NP
,

45 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

46 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

47 
	mPTHREAD_MUTEX_ADAPTIVE_NP


48 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


50 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

51 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

52 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

53 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


55 #ifde‡
__USE_GNU


57 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_TIMED_NP


62 #ifde‡
__USE_XOPEN2K


66 
	mPTHREAD_MUTEX_STALLED
,

67 
	mPTHREAD_MUTEX_STALLED_NP
 = 
PTHREAD_MUTEX_STALLED
,

68 
	mPTHREAD_MUTEX_ROBUST
,

69 
	mPTHREAD_MUTEX_ROBUST_NP
 = 
PTHREAD_MUTEX_ROBUST


74 #i‡
deföed
 
__USE_POSIX199506
 || deföed 
__USE_UNIX98


78 
	mPTHREAD_PRIO_NONE
,

79 
	mPTHREAD_PRIO_INHERIT
,

80 
	mPTHREAD_PRIO_PROTECT


86 #ifde‡
__PTHREAD_MUTEX_HAVE_PREV


87 
	#PTHREAD_MUTEX_INITIALIZER
 \

88 { { 0, 0, 0, 0, 0, 0, { 0, 0 } } }

	)

89 #ifde‡
__USE_GNU


90 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

91 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 0, 0 } } }

	)

92 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

93 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 0, 0 } } }

	)

94 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

95 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 0, 0 } } }

	)

98 
	#PTHREAD_MUTEX_INITIALIZER
 \

99 { { 0, 0, 0, 0, 0, { 0 } } }

	)

100 #ifde‡
__USE_GNU


101 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

102 { { 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 0 } } }

	)

103 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

104 { { 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 0 } } }

	)

105 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

106 { { 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 0 } } }

	)

112 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


115 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

116 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

117 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

118 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_READER_NP


124 #i‚de‡
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


125 #i‡
__WORDSIZE
 == 64

126 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

131 
	#PTHREAD_RWLOCK_INITIALIZER
 \

132 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } }

	)

133 #ifde‡
__USE_GNU


134 #ifde‡
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


135 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

137 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
 } }

	)

139 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


140 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

141 { { 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, \

142 0, 0, 0, 0 } }

	)

144 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

145 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,\

146 0 } }

	)

156 
	mPTHREAD_INHERIT_SCHED
,

157 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

158 
	mPTHREAD_EXPLICIT_SCHED


159 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

166 
	mPTHREAD_SCOPE_SYSTEM
,

167 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

168 
	mPTHREAD_SCOPE_PROCESS


169 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

176 
	mPTHREAD_PROCESS_PRIVATE
,

177 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

178 
	mPTHREAD_PROCESS_SHARED


179 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

185 
	#PTHREAD_COND_INITIALIZER
 { { 0, 0, 0, 0, 0, (*Ë0, 0, 0 } }

	)

189 
	s_±hªad_˛ónup_buf„r


191 (*
	m__routöe
) (*);

192 *
	m__¨g
;

193 
	m__ˇn˚…y≥
;

194 
_±hªad_˛ónup_buf„r
 *
	m__¥ev
;

200 
	mPTHREAD_CANCEL_ENABLE
,

201 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

202 
	mPTHREAD_CANCEL_DISABLE


203 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

207 
	mPTHREAD_CANCEL_DEFERRED
,

208 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

209 
	mPTHREAD_CANCEL_ASYNCHRONOUS


210 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

212 
	#PTHREAD_CANCELED
 ((*Ë-1)

	)

216 
	#PTHREAD_ONCE_INIT
 0

	)

219 #ifde‡
__USE_XOPEN2K


223 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

227 
__BEGIN_DECLS


232 
±hªad_¸óã
 (
±hªad_t
 *
__ª°ri˘
 
__√wthªad
,

233 c⁄° 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

234 *(*
__°¨t_routöe
) (*),

235 *
__ª°ri˘
 
__¨g
Ë
__THROWNL
 
__n⁄nuŒ
 ((1, 3));

241 
	$±hªad_exô
 (*
__ªtvÆ
Ë
	`__©åibuã__
 ((
__n‹ëu∫__
));

249 
	`±hªad_joö
 (
±hªad_t
 
__th
, **
__thªad_ªtu∫
);

251 #ifde‡
__USE_GNU


254 
	$±hªad_åyjoö_≈
 (
±hªad_t
 
__th
, **
__thªad_ªtu∫
Ë
__THROW
;

262 
	`±hªad_timedjoö_≈
 (
±hªad_t
 
__th
, **
__thªad_ªtu∫
,

263 c⁄° 
time•ec
 *
__ab°ime
);

270 
	$±hªad_dëach
 (
±hªad_t
 
__th
Ë
__THROW
;

274 
±hªad_t
 
	$±hªad_£lf
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

277 
	$±hªad_equÆ
 (
±hªad_t
 
__thªad1
,Öthªad_à
__thªad2
)

278 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

286 
	$±hªad_©å_öô
 (
±hªad_©å_t
 *
__©å
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

289 
	$±hªad_©å_de°roy
 (
±hªad_©å_t
 *
__©å
)

290 
__THROW
 
	`__n⁄nuŒ
 ((1));

293 
	$±hªad_©å_gëdëach°©e
 (c⁄° 
±hªad_©å_t
 *
__©å
,

294 *
__dëach°©e
)

295 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

298 
	$±hªad_©å_£tdëach°©e
 (
±hªad_©å_t
 *
__©å
,

299 
__dëach°©e
)

300 
__THROW
 
	`__n⁄nuŒ
 ((1));

304 
	$±hªad_©å_gëgu¨dsize
 (c⁄° 
±hªad_©å_t
 *
__©å
,

305 
size_t
 *
__gu¨dsize
)

306 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

309 
	$±hªad_©å_£tgu¨dsize
 (
±hªad_©å_t
 *
__©å
,

310 
size_t
 
__gu¨dsize
)

311 
__THROW
 
	`__n⁄nuŒ
 ((1));

315 
	$±hªad_©å_gësched∑øm
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

316 
sched_∑øm
 *
__ª°ri˘
 
__∑øm
)

317 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

320 
	$±hªad_©å_£tsched∑øm
 (
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

321 c⁄° 
sched_∑øm
 *
__ª°ri˘


322 
__∑øm
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

325 
	$±hªad_©å_gëschedpﬁicy
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘


326 
__©å
, *
__ª°ri˘
 
__pﬁicy
)

327 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

330 
	$±hªad_©å_£tschedpﬁicy
 (
±hªad_©å_t
 *
__©å
, 
__pﬁicy
)

331 
__THROW
 
	`__n⁄nuŒ
 ((1));

334 
	$±hªad_©å_gëöhîôsched
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘


335 
__©å
, *
__ª°ri˘
 
__öhîô
)

336 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

339 
	$±hªad_©å_£töhîôsched
 (
±hªad_©å_t
 *
__©å
,

340 
__öhîô
)

341 
__THROW
 
	`__n⁄nuŒ
 ((1));

345 
	$±hªad_©å_gësc›e
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

346 *
__ª°ri˘
 
__sc›e
)

347 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

350 
	$±hªad_©å_£tsc›e
 (
±hªad_©å_t
 *
__©å
, 
__sc›e
)

351 
__THROW
 
	`__n⁄nuŒ
 ((1));

354 
	$±hªad_©å_gë°ackaddr
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘


355 
__©å
, **
__ª°ri˘
 
__°ackaddr
)

356 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__©åibuã_dïªˇãd__
;

362 
	$±hªad_©å_£t°ackaddr
 (
±hªad_©å_t
 *
__©å
,

363 *
__°ackaddr
)

364 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__©åibuã_dïªˇãd__
;

367 
	$±hªad_©å_gë°acksize
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘


368 
__©å
, 
size_t
 *
__ª°ri˘
 
__°acksize
)

369 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

374 
	$±hªad_©å_£t°acksize
 (
±hªad_©å_t
 *
__©å
,

375 
size_t
 
__°acksize
)

376 
__THROW
 
	`__n⁄nuŒ
 ((1));

378 #ifde‡
__USE_XOPEN2K


380 
	$±hªad_©å_gë°ack
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

381 **
__ª°ri˘
 
__°ackaddr
,

382 
size_t
 *
__ª°ri˘
 
__°acksize
)

383 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3));

388 
	$±hªad_©å_£t°ack
 (
±hªad_©å_t
 *
__©å
, *
__°ackaddr
,

389 
size_t
 
__°acksize
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

392 #ifde‡
__USE_GNU


395 
	$±hªad_©å_£èfföôy_≈
 (
±hªad_©å_t
 *
__©å
,

396 
size_t
 
__˝u£tsize
,

397 c⁄° 
˝u_£t_t
 *
__˝u£t
)

398 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

402 
	$±hªad_©å_gëafföôy_≈
 (c⁄° 
±hªad_©å_t
 *
__©å
,

403 
size_t
 
__˝u£tsize
,

404 
˝u_£t_t
 *
__˝u£t
)

405 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

411 
	$±hªad_gë©å_≈
 (
±hªad_t
 
__th
, 
±hªad_©å_t
 *
__©å
)

412 
__THROW
 
	`__n⁄nuŒ
 ((2));

420 
	$±hªad_£tsched∑øm
 (
±hªad_t
 
__èrgë_thªad
, 
__pﬁicy
,

421 c⁄° 
sched_∑øm
 *
__∑øm
)

422 
__THROW
 
	`__n⁄nuŒ
 ((3));

425 
	$±hªad_gësched∑øm
 (
±hªad_t
 
__èrgë_thªad
,

426 *
__ª°ri˘
 
__pﬁicy
,

427 
sched_∑øm
 *
__ª°ri˘
 
__∑øm
)

428 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

431 
	$±hªad_£tsched¥io
 (
±hªad_t
 
__èrgë_thªad
, 
__¥io
)

432 
__THROW
;

435 #ifde‡
__USE_GNU


437 
	$±hªad_gë«me_≈
 (
±hªad_t
 
__èrgë_thªad
, *
__buf
,

438 
size_t
 
__buÊí
)

439 
__THROW
 
	`__n⁄nuŒ
 ((2));

442 
	$±hªad_£äame_≈
 (
±hªad_t
 
__èrgë_thªad
, c⁄° *
__«me
)

443 
__THROW
 
	`__n⁄nuŒ
 ((2));

447 #ifde‡
__USE_UNIX98


449 
	$±hªad_gëc⁄cuºícy
 (Ë
__THROW
;

452 
	$±hªad_£tc⁄cuºícy
 (
__Àvñ
Ë
__THROW
;

455 #ifde‡
__USE_GNU


460 
	$±hªad_yõld
 (Ë
__THROW
;

465 
	$±hªad_£èfföôy_≈
 (
±hªad_t
 
__th
, 
size_t
 
__˝u£tsize
,

466 c⁄° 
˝u_£t_t
 *
__˝u£t
)

467 
__THROW
 
	`__n⁄nuŒ
 ((3));

470 
	$±hªad_gëafföôy_≈
 (
±hªad_t
 
__th
, 
size_t
 
__˝u£tsize
,

471 
˝u_£t_t
 *
__˝u£t
)

472 
__THROW
 
	`__n⁄nuŒ
 ((3));

485 
	`±hªad_⁄˚
 (
±hªad_⁄˚_t
 *
__⁄˚_c⁄åﬁ
,

486 (*
__öô_routöe
Ë()Ë
	`__n⁄nuŒ
 ((1, 2));

497 
	`±hªad_£tˇn˚l°©e
 (
__°©e
, *
__ﬁd°©e
);

501 
	`±hªad_£tˇn˚…y≥
 (
__ty≥
, *
__ﬁdty≥
);

504 
	`±hªad_ˇn˚l
 (
±hªad_t
 
__th
);

509 
	`±hªad_ã°ˇn˚l
 ();

518 
__jmp_buf
 
__ˇn˚l_jmp_buf
;

519 
__mask_was_ßved
;

520 } 
__ˇn˚l_jmp_buf
[1];

521 *
__∑d
[4];

522 } 
	t__±hªad_unwöd_buf_t
 
	t__©åibuã__
 ((
	t__Æig√d__
));

525 #i‚de‡
__˛ónup_f˘_©åibuã


526 
	#__˛ónup_f˘_©åibuã


	)

531 
	s__±hªad_˛ónup_‰ame


533 (*
__ˇn˚l_routöe
) (*);

534 *
__ˇn˚l_¨g
;

535 
__do_ô
;

536 
__ˇn˚l_ty≥
;

539 #i‡
deföed
 
__GNUC__
 && deföed 
__EXCEPTIONS


540 #ifde‡
__˝lu•lus


542 ˛as†
	c__±hªad_˛ónup_˛ass


544 (*
__ˇn˚l_routöe
) (*);

545 *
__ˇn˚l_¨g
;

546 
__do_ô
;

547 
__ˇn˚l_ty≥
;

549 
public
:

550 
	`__±hªad_˛ónup_˛ass
 ((*
__f˘
Ë(*), *
__¨g
)

551 : 
	`__ˇn˚l_routöe
 (
__f˘
), 
	`__ˇn˚l_¨g
 (
__¨g
), 
	$__do_ô
 (1) { }

552 ~
	$__±hªad_˛ónup_˛ass
 (Ë{ i‡(
__do_ô
Ë
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); 
	}
}

553 
	$__£tdoô
 (
__√wvÆ
Ë{ 
__do_ô
 = __√wvÆ; 
	}
}

554 
	$__de„r
 (Ë{ 
	`±hªad_£tˇn˚…y≥
 (
PTHREAD_CANCEL_DEFERRED
,

555 &
__ˇn˚l_ty≥
); 
	}
}

556 
	$__ª°‹e
 (Ëc⁄° { 
	`±hªad_£tˇn˚…y≥
 (
__ˇn˚l_ty≥
, 0); 
	}
}

566 
	#±hªad_˛ónup_push
(
routöe
, 
¨g
) \

568 
__±hªad_˛ónup_˛ass
 
	`__˛‰ame
 (
routöe
, 
¨g
)

	)

572 
	#±hªad_˛ónup_p›
(
execuã
) \

573 
__˛‰ame
.
	`__£tdoô
 (
execuã
); \

574 } 0)

	)

576 #ifde‡
__USE_GNU


580 
	#±hªad_˛ónup_push_de„r_≈
(
routöe
, 
¨g
) \

582 
__±hªad_˛ónup_˛ass
 
	`__˛‰ame
 (
routöe
, 
¨g
); \

583 
__˛‰ame
.
	`__de„r
 ()

	)

588 
	#±hªad_˛ónup_p›_ª°‹e_≈
(
execuã
) \

589 
__˛‰ame
.
	`__ª°‹e
 (); \

590 
__˛‰ame
.
	`__£tdoô
 (
execuã
); \

591 } 0)

	)

598 
__exã∫_ölöe
 

599 
	$__±hªad_˛ónup_routöe
 (
__±hªad_˛ónup_‰ame
 *
__‰ame
)

601 i‡(
__‰ame
->
__do_ô
)

602 
__‰ame
->
	`__ˇn˚l_routöe
 (__‰ame->
__ˇn˚l_¨g
);

603 
	}
}

612 
	#±hªad_˛ónup_push
(
routöe
, 
¨g
) \

614 
__±hªad_˛ónup_‰ame
 
__˛‰ame
 \

615 
	`__©åibuã__
 ((
	`__˛ónup__
 (
__±hªad_˛ónup_routöe
))) \

616 { .
__ˇn˚l_routöe
 = (
routöe
), .
__ˇn˚l_¨g
 = (
¨g
), \

617 .
__do_ô
 = 1 };

	)

621 
	#±hªad_˛ónup_p›
(
execuã
) \

622 
__˛‰ame
.
__do_ô
 = (
execuã
); \

623 } 0)

	)

625 #ifde‡
__USE_GNU


629 
	#±hªad_˛ónup_push_de„r_≈
(
routöe
, 
¨g
) \

631 
__±hªad_˛ónup_‰ame
 
__˛‰ame
 \

632 
	`__©åibuã__
 ((
	`__˛ónup__
 (
__±hªad_˛ónup_routöe
))) \

633 { .
__ˇn˚l_routöe
 = (
routöe
), .
__ˇn˚l_¨g
 = (
¨g
), \

634 .
__do_ô
 = 1 }; \

635 (Ë
	`±hªad_£tˇn˚…y≥
 (
PTHREAD_CANCEL_DEFERRED
, \

636 &
__˛‰ame
.
__ˇn˚l_ty≥
)

	)

641 
	#±hªad_˛ónup_p›_ª°‹e_≈
(
execuã
) \

642 (Ë
	`±hªad_£tˇn˚…y≥
 (
__˛‰ame
.
__ˇn˚l_ty≥
, 
NULL
); \

643 
__˛‰ame
.
__do_ô
 = (
execuã
); \

644 } 0)

	)

655 
	#±hªad_˛ónup_push
(
routöe
, 
¨g
) \

657 
__±hªad_unwöd_buf_t
 
__ˇn˚l_buf
; \

658 (*
__ˇn˚l_routöe
Ë(*Ë(
routöe
); \

659 *
__ˇn˚l_¨g
 = (
¨g
); \

660 
__nŸ_fú°_ˇŒ
 = 
	`__sig£tjmp
 ((
__jmp_buf_èg
 *) (*) \

661 
__ˇn˚l_buf
.
__ˇn˚l_jmp_buf
, 0); \

662 i‡(
	`__glibc_u∆ikñy
 (
__nŸ_fú°_ˇŒ
)) \

664 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

665 
	`__±hªad_unwöd_√xt
 (&
__ˇn˚l_buf
); \

669 
	`__±hªad_ªgi°î_ˇn˚l
 (&
__ˇn˚l_buf
); \

670 dÿ{

	)

671 
__±hªad_ªgi°î_ˇn˚l
 (
__±hªad_unwöd_buf_t
 *
__buf
)

672 
__˛ónup_f˘_©åibuã
;

676 
	#±hªad_˛ónup_p›
(
execuã
) \

679 
	`__±hªad_uƒegi°î_ˇn˚l
 (&
__ˇn˚l_buf
); \

680 i‡(
execuã
) \

681 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

682 } 0)

	)

683 
	$__±hªad_uƒegi°î_ˇn˚l
 (
__±hªad_unwöd_buf_t
 *
__buf
)

684 
__˛ónup_f˘_©åibuã
;

686 #ifde‡
__USE_GNU


690 
	#±hªad_˛ónup_push_de„r_≈
(
routöe
, 
¨g
) \

692 
__±hªad_unwöd_buf_t
 
__ˇn˚l_buf
; \

693 (*
__ˇn˚l_routöe
Ë(*Ë(
routöe
); \

694 *
__ˇn˚l_¨g
 = (
¨g
); \

695 
__nŸ_fú°_ˇŒ
 = 
	`__sig£tjmp
 ((
__jmp_buf_èg
 *) (*) \

696 
__ˇn˚l_buf
.
__ˇn˚l_jmp_buf
, 0); \

697 i‡(
	`__glibc_u∆ikñy
 (
__nŸ_fú°_ˇŒ
)) \

699 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

700 
	`__±hªad_unwöd_√xt
 (&
__ˇn˚l_buf
); \

704 
	`__±hªad_ªgi°î_ˇn˚l_de„r
 (&
__ˇn˚l_buf
); \

705 dÿ{

	)

706 
	`__±hªad_ªgi°î_ˇn˚l_de„r
 (
__±hªad_unwöd_buf_t
 *
__buf
)

707 
__˛ónup_f˘_©åibuã
;

712 
	#±hªad_˛ónup_p›_ª°‹e_≈
(
execuã
) \

715 
	`__±hªad_uƒegi°î_ˇn˚l_ª°‹e
 (&
__ˇn˚l_buf
); \

716 i‡(
execuã
) \

717 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

718 
	}
} 0)

	)

719 
	$__±hªad_uƒegi°î_ˇn˚l_ª°‹e
 (
__±hªad_unwöd_buf_t
 *
__buf
)

720 
__˛ónup_f˘_©åibuã
;

724 
	$__±hªad_unwöd_√xt
 (
__±hªad_unwöd_buf_t
 *
__buf
)

725 
__˛ónup_f˘_©åibuã
 
	`__©åibuã__
 ((
__n‹ëu∫__
))

726 #i‚de‡
SHARED


727 
	`__©åibuã__
 ((
__wók__
))

733 
__jmp_buf_èg
;

734 
	$__sig£tjmp
 (
__jmp_buf_èg
 *
__ív
, 
__ßvemask
Ë
__THROWNL
;

740 
	$±hªad_muãx_öô
 (
±hªad_muãx_t
 *
__muãx
,

741 c⁄° 
±hªad_muãx©å_t
 *
__muãx©å
)

742 
__THROW
 
	`__n⁄nuŒ
 ((1));

745 
	$±hªad_muãx_de°roy
 (
±hªad_muãx_t
 *
__muãx
)

746 
__THROW
 
	`__n⁄nuŒ
 ((1));

749 
	$±hªad_muãx_åylock
 (
±hªad_muãx_t
 *
__muãx
)

750 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

753 
	$±hªad_muãx_lock
 (
±hªad_muãx_t
 *
__muãx
)

754 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

756 #ifde‡
__USE_XOPEN2K


758 
	$±hªad_muãx_timedlock
 (
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

759 c⁄° 
time•ec
 *
__ª°ri˘


760 
__ab°ime
Ë
__THROWNL
 
	`__n⁄nuŒ
 ((1, 2));

764 
	$±hªad_muãx_u∆ock
 (
±hªad_muãx_t
 *
__muãx
)

765 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

769 
	$±hªad_muãx_gë¥io˚ûög
 (c⁄° 
±hªad_muãx_t
 *

770 
__ª°ri˘
 
__muãx
,

771 *
__ª°ri˘
 
__¥io˚ûög
)

772 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

776 
	$±hªad_muãx_£çrio˚ûög
 (
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

777 
__¥io˚ûög
,

778 *
__ª°ri˘
 
__ﬁd_˚ûög
)

779 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

782 #ifde‡
__USE_XOPEN2K8


784 
	$±hªad_muãx_c⁄si°ít
 (
±hªad_muãx_t
 *
__muãx
)

785 
__THROW
 
	`__n⁄nuŒ
 ((1));

786 #ifde‡
__USE_GNU


787 
	$±hªad_muãx_c⁄si°ít_≈
 (
±hªad_muãx_t
 *
__muãx
)

788 
__THROW
 
	`__n⁄nuŒ
 ((1));

797 
	$±hªad_muãx©å_öô
 (
±hªad_muãx©å_t
 *
__©å
)

798 
__THROW
 
	`__n⁄nuŒ
 ((1));

801 
	$±hªad_muãx©å_de°roy
 (
±hªad_muãx©å_t
 *
__©å
)

802 
__THROW
 
	`__n⁄nuŒ
 ((1));

805 
	$±hªad_muãx©å_gëpsh¨ed
 (c⁄° 
±hªad_muãx©å_t
 *

806 
__ª°ri˘
 
__©å
,

807 *
__ª°ri˘
 
__psh¨ed
)

808 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

811 
	$±hªad_muãx©å_£çsh¨ed
 (
±hªad_muãx©å_t
 *
__©å
,

812 
__psh¨ed
)

813 
__THROW
 
	`__n⁄nuŒ
 ((1));

815 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


817 
	$±hªad_muãx©å_gëty≥
 (c⁄° 
±hªad_muãx©å_t
 *
__ª°ri˘


818 
__©å
, *
__ª°ri˘
 
__köd
)

819 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

824 
	$±hªad_muãx©å_£ây≥
 (
±hªad_muãx©å_t
 *
__©å
, 
__köd
)

825 
__THROW
 
	`__n⁄nuŒ
 ((1));

829 
	$±hªad_muãx©å_gë¥Ÿocﬁ
 (c⁄° 
±hªad_muãx©å_t
 *

830 
__ª°ri˘
 
__©å
,

831 *
__ª°ri˘
 
__¥Ÿocﬁ
)

832 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

836 
	$±hªad_muãx©å_£çrŸocﬁ
 (
±hªad_muãx©å_t
 *
__©å
,

837 
__¥Ÿocﬁ
)

838 
__THROW
 
	`__n⁄nuŒ
 ((1));

841 
	$±hªad_muãx©å_gë¥io˚ûög
 (c⁄° 
±hªad_muãx©å_t
 *

842 
__ª°ri˘
 
__©å
,

843 *
__ª°ri˘
 
__¥io˚ûög
)

844 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

847 
	$±hªad_muãx©å_£çrio˚ûög
 (
±hªad_muãx©å_t
 *
__©å
,

848 
__¥io˚ûög
)

849 
__THROW
 
	`__n⁄nuŒ
 ((1));

851 #ifde‡
__USE_XOPEN2K


853 
	$±hªad_muãx©å_gërobu°
 (c⁄° 
±hªad_muãx©å_t
 *
__©å
,

854 *
__robu°√ss
)

855 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

856 #ifde‡
__USE_GNU


857 
	$±hªad_muãx©å_gërobu°_≈
 (c⁄° 
±hªad_muãx©å_t
 *
__©å
,

858 *
__robu°√ss
)

859 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

863 
	$±hªad_muãx©å_£åobu°
 (
±hªad_muãx©å_t
 *
__©å
,

864 
__robu°√ss
)

865 
__THROW
 
	`__n⁄nuŒ
 ((1));

866 #ifde‡
__USE_GNU


867 
	$±hªad_muãx©å_£åobu°_≈
 (
±hªad_muãx©å_t
 *
__©å
,

868 
__robu°√ss
)

869 
__THROW
 
	`__n⁄nuŒ
 ((1));

874 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


879 
	$±hªad_rwlock_öô
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

880 c⁄° 
±hªad_rwlock©å_t
 *
__ª°ri˘


881 
__©å
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

884 
	$±hªad_rwlock_de°roy
 (
±hªad_rwlock_t
 *
__rwlock
)

885 
__THROW
 
	`__n⁄nuŒ
 ((1));

888 
	$±hªad_rwlock_rdlock
 (
±hªad_rwlock_t
 *
__rwlock
)

889 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

892 
	$±hªad_rwlock_åyrdlock
 (
±hªad_rwlock_t
 *
__rwlock
)

893 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

895 #ifde‡
__USE_XOPEN2K


897 
	$±hªad_rwlock_timedrdlock
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

898 c⁄° 
time•ec
 *
__ª°ri˘


899 
__ab°ime
Ë
__THROWNL
 
	`__n⁄nuŒ
 ((1, 2));

903 
	$±hªad_rwlock_wæock
 (
±hªad_rwlock_t
 *
__rwlock
)

904 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

907 
	$±hªad_rwlock_åywæock
 (
±hªad_rwlock_t
 *
__rwlock
)

908 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

910 #ifde‡
__USE_XOPEN2K


912 
	$±hªad_rwlock_timedwæock
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

913 c⁄° 
time•ec
 *
__ª°ri˘


914 
__ab°ime
Ë
__THROWNL
 
	`__n⁄nuŒ
 ((1, 2));

918 
	$±hªad_rwlock_u∆ock
 (
±hªad_rwlock_t
 *
__rwlock
)

919 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

925 
	$±hªad_rwlock©å_öô
 (
±hªad_rwlock©å_t
 *
__©å
)

926 
__THROW
 
	`__n⁄nuŒ
 ((1));

929 
	$±hªad_rwlock©å_de°roy
 (
±hªad_rwlock©å_t
 *
__©å
)

930 
__THROW
 
	`__n⁄nuŒ
 ((1));

933 
	$±hªad_rwlock©å_gëpsh¨ed
 (c⁄° 
±hªad_rwlock©å_t
 *

934 
__ª°ri˘
 
__©å
,

935 *
__ª°ri˘
 
__psh¨ed
)

936 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

939 
	$±hªad_rwlock©å_£çsh¨ed
 (
±hªad_rwlock©å_t
 *
__©å
,

940 
__psh¨ed
)

941 
__THROW
 
	`__n⁄nuŒ
 ((1));

944 
	$±hªad_rwlock©å_gëköd_≈
 (c⁄° 
±hªad_rwlock©å_t
 *

945 
__ª°ri˘
 
__©å
,

946 *
__ª°ri˘
 
__¥ef
)

947 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

950 
	$±hªad_rwlock©å_£tköd_≈
 (
±hªad_rwlock©å_t
 *
__©å
,

951 
__¥ef
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

959 
	$±hªad_c⁄d_öô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

960 c⁄° 
±hªad_c⁄d©å_t
 *
__ª°ri˘
 
__c⁄d_©å
)

961 
__THROW
 
	`__n⁄nuŒ
 ((1));

964 
	$±hªad_c⁄d_de°roy
 (
±hªad_c⁄d_t
 *
__c⁄d
)

965 
__THROW
 
	`__n⁄nuŒ
 ((1));

968 
	$±hªad_c⁄d_sig«l
 (
±hªad_c⁄d_t
 *
__c⁄d
)

969 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

972 
	$±hªad_c⁄d_brﬂdˇ°
 (
±hªad_c⁄d_t
 *
__c⁄d
)

973 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

980 
	$±hªad_c⁄d_waô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

981 
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
)

982 
	`__n⁄nuŒ
 ((1, 2));

991 
	$±hªad_c⁄d_timedwaô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

992 
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

993 c⁄° 
time•ec
 *
__ª°ri˘
 
__ab°ime
)

994 
	`__n⁄nuŒ
 ((1, 2, 3));

999 
	$±hªad_c⁄d©å_öô
 (
±hªad_c⁄d©å_t
 *
__©å
)

1000 
__THROW
 
	`__n⁄nuŒ
 ((1));

1003 
	$±hªad_c⁄d©å_de°roy
 (
±hªad_c⁄d©å_t
 *
__©å
)

1004 
__THROW
 
	`__n⁄nuŒ
 ((1));

1007 
	$±hªad_c⁄d©å_gëpsh¨ed
 (c⁄° 
±hªad_c⁄d©å_t
 *

1008 
__ª°ri˘
 
__©å
,

1009 *
__ª°ri˘
 
__psh¨ed
)

1010 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1013 
	$±hªad_c⁄d©å_£çsh¨ed
 (
±hªad_c⁄d©å_t
 *
__©å
,

1014 
__psh¨ed
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

1016 #ifde‡
__USE_XOPEN2K


1018 
	$±hªad_c⁄d©å_gë˛ock
 (c⁄° 
±hªad_c⁄d©å_t
 *

1019 
__ª°ri˘
 
__©å
,

1020 
__˛ockid_t
 *
__ª°ri˘
 
__˛ock_id
)

1021 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1024 
	$±hªad_c⁄d©å_£t˛ock
 (
±hªad_c⁄d©å_t
 *
__©å
,

1025 
__˛ockid_t
 
__˛ock_id
)

1026 
__THROW
 
	`__n⁄nuŒ
 ((1));

1030 #ifde‡
__USE_XOPEN2K


1035 
	$±hªad_•ö_öô
 (
±hªad_•ölock_t
 *
__lock
, 
__psh¨ed
)

1036 
__THROW
 
	`__n⁄nuŒ
 ((1));

1039 
	$±hªad_•ö_de°roy
 (
±hªad_•ölock_t
 *
__lock
)

1040 
__THROW
 
	`__n⁄nuŒ
 ((1));

1043 
	$±hªad_•ö_lock
 (
±hªad_•ölock_t
 *
__lock
)

1044 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1047 
	$±hªad_•ö_åylock
 (
±hªad_•ölock_t
 *
__lock
)

1048 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1051 
	$±hªad_•ö_u∆ock
 (
±hªad_•ölock_t
 *
__lock
)

1052 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1059 
	$±hªad_b¨rõr_öô
 (
±hªad_b¨rõr_t
 *
__ª°ri˘
 
__b¨rõr
,

1060 c⁄° 
±hªad_b¨rõøâr_t
 *
__ª°ri˘


1061 
__©å
, 
__cou¡
)

1062 
__THROW
 
	`__n⁄nuŒ
 ((1));

1065 
	$±hªad_b¨rõr_de°roy
 (
±hªad_b¨rõr_t
 *
__b¨rõr
)

1066 
__THROW
 
	`__n⁄nuŒ
 ((1));

1069 
	$±hªad_b¨rõr_waô
 (
±hªad_b¨rõr_t
 *
__b¨rõr
)

1070 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1074 
	$±hªad_b¨rõøâr_öô
 (
±hªad_b¨rõøâr_t
 *
__©å
)

1075 
__THROW
 
	`__n⁄nuŒ
 ((1));

1078 
	$±hªad_b¨rõøâr_de°roy
 (
±hªad_b¨rõøâr_t
 *
__©å
)

1079 
__THROW
 
	`__n⁄nuŒ
 ((1));

1082 
	$±hªad_b¨rõøâr_gëpsh¨ed
 (c⁄° 
±hªad_b¨rõøâr_t
 *

1083 
__ª°ri˘
 
__©å
,

1084 *
__ª°ri˘
 
__psh¨ed
)

1085 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1088 
	$±hªad_b¨rõøâr_£çsh¨ed
 (
±hªad_b¨rõøâr_t
 *
__©å
,

1089 
__psh¨ed
)

1090 
__THROW
 
	`__n⁄nuŒ
 ((1));

1102 
	`±hªad_key_¸óã
 (
±hªad_key_t
 *
__key
,

1103 (*
__de°r_fun˘i⁄
) (*))

1104 
__THROW
 
	`__n⁄nuŒ
 ((1));

1107 
	$±hªad_key_dñëe
 (
±hªad_key_t
 
__key
Ë
__THROW
;

1110 *
	$±hªad_gë•ecific
 (
±hªad_key_t
 
__key
Ë
__THROW
;

1113 
	$±hªad_£t•ecific
 (
±hªad_key_t
 
__key
,

1114 c⁄° *
__poöãr
Ë
__THROW
 ;

1117 #ifde‡
__USE_XOPEN2K


1119 
	$±hªad_gë˝u˛ockid
 (
±hªad_t
 
__thªad_id
,

1120 
__˛ockid_t
 *
__˛ock_id
)

1121 
__THROW
 
	`__n⁄nuŒ
 ((2));

1136 
	`±hªad_©f‹k
 ((*
__¥ï¨e
) (),

1137 (*
__∑ª¡
) (),

1138 (*
__chûd
Ë()Ë
__THROW
;

1141 #ifde‡
__USE_EXTERN_INLINES


1143 
__exã∫_ölöe
 

1144 
	`__NTH
 (
	$±hªad_equÆ
 (
±hªad_t
 
__thªad1
,Öthªad_à
__thªad2
))

1146  
__thªad1
 =
__thªad2
;

1147 
	}
}

1150 
	g__END_DECLS


	@/usr/include/regex.h

21 #i‚de‡
_REGEX_H


22 
	#_REGEX_H
 1

	)

24 
	~<sys/ty≥s.h
>

25 
	~<gnu/›ti⁄-groups.h
>

28 #ifde‡
__˝lu•lus


36 
	ts_ªg_t
;

37 
	ta˘ive_ªg_t
;

44 
	tªg_sy¡ax_t
;

46 #ifde‡
__USE_GNU


49 
	#RE_BACKSLASH_ESCAPE_IN_LISTS
 ((Ë1)

	)

54 
	#RE_BK_PLUS_QM
 (
RE_BACKSLASH_ESCAPE_IN_LISTS
 << 1)

	)

60 
	#RE_CHAR_CLASSES
 (
RE_BK_PLUS_QM
 << 1)

	)

74 
	#RE_CONTEXT_INDEP_ANCHORS
 (
RE_CHAR_CLASSES
 << 1)

	)

82 
	#RE_CONTEXT_INDEP_OPS
 (
RE_CONTEXT_INDEP_ANCHORS
 << 1)

	)

86 
	#RE_CONTEXT_INVALID_OPS
 (
RE_CONTEXT_INDEP_OPS
 << 1)

	)

90 
	#RE_DOT_NEWLINE
 (
RE_CONTEXT_INVALID_OPS
 << 1)

	)

94 
	#RE_DOT_NOT_NULL
 (
RE_DOT_NEWLINE
 << 1)

	)

98 
	#RE_HAT_LISTS_NOT_NEWLINE
 (
RE_DOT_NOT_NULL
 << 1)

	)

103 
	#RE_INTERVALS
 (
RE_HAT_LISTS_NOT_NEWLINE
 << 1)

	)

107 
	#RE_LIMITED_OPS
 (
RE_INTERVALS
 << 1)

	)

111 
	#RE_NEWLINE_ALT
 (
RE_LIMITED_OPS
 << 1)

	)

116 
	#RE_NO_BK_BRACES
 (
RE_NEWLINE_ALT
 << 1)

	)

120 
	#RE_NO_BK_PARENS
 (
RE_NO_BK_BRACES
 << 1)

	)

124 
	#RE_NO_BK_REFS
 (
RE_NO_BK_PARENS
 << 1)

	)

128 
	#RE_NO_BK_VBAR
 (
RE_NO_BK_REFS
 << 1)

	)

134 
	#RE_NO_EMPTY_RANGES
 (
RE_NO_BK_VBAR
 << 1)

	)

138 
	#RE_UNMATCHED_RIGHT_PAREN_ORD
 (
RE_NO_EMPTY_RANGES
 << 1)

	)

142 
	#RE_NO_POSIX_BACKTRACKING
 (
RE_UNMATCHED_RIGHT_PAREN_ORD
 << 1)

	)

146 
	#RE_NO_GNU_OPS
 (
RE_NO_POSIX_BACKTRACKING
 << 1)

	)

154 
	#RE_DEBUG
 (
RE_NO_GNU_OPS
 << 1)

	)

159 
	#RE_INVALID_INTERVAL_ORD
 (
RE_DEBUG
 << 1)

	)

162 #ifde‡
__OPTION_POSIX_REGEXP_GLIBC


165 
	#RE_ICASE
 (
RE_INVALID_INTERVAL_ORD
 << 1)

	)

170 
	#RE_CARET_ANCHORS_HERE
 (
RE_ICASE
 << 1)

	)

174 
	#RE_CONTEXT_INVALID_DUP
 (
RE_CARET_ANCHORS_HERE
 << 1)

	)

178 
	#RE_NO_SUB
 (
RE_CONTEXT_INVALID_DUP
 << 1)

	)

186 
ªg_sy¡ax_t
 
ª_sy¡ax_›ti⁄s
;

188 #ifde‡
__USE_GNU


193 
	#RE_SYNTAX_EMACS
 0

	)

195 
	#RE_SYNTAX_AWK
 \

196 (
RE_BACKSLASH_ESCAPE_IN_LISTS
 | 
RE_DOT_NOT_NULL
 \

197 | 
RE_NO_BK_PARENS
 | 
RE_NO_BK_REFS
 \

198 | 
RE_NO_BK_VBAR
 | 
RE_NO_EMPTY_RANGES
 \

199 | 
RE_DOT_NEWLINE
 | 
RE_CONTEXT_INDEP_ANCHORS
 \

200 | 
RE_CHAR_CLASSES
 \

201 | 
RE_UNMATCHED_RIGHT_PAREN_ORD
 | 
RE_NO_GNU_OPS
)

	)

203 
	#RE_SYNTAX_GNU_AWK
 \

204 ((
RE_SYNTAX_POSIX_EXTENDED
 | 
RE_BACKSLASH_ESCAPE_IN_LISTS
 \

205 | 
RE_INVALID_INTERVAL_ORD
) \

206 & ~(
RE_DOT_NOT_NULL
 | 
RE_CONTEXT_INDEP_OPS
 \

207 | 
RE_CONTEXT_INVALID_OPS
 ))

	)

209 
	#RE_SYNTAX_POSIX_AWK
 \

210 (
RE_SYNTAX_POSIX_EXTENDED
 | 
RE_BACKSLASH_ESCAPE_IN_LISTS
 \

211 | 
RE_INTERVALS
 | 
RE_NO_GNU_OPS
 \

212 | 
RE_INVALID_INTERVAL_ORD
)

	)

214 
	#RE_SYNTAX_GREP
 \

215 (
RE_BK_PLUS_QM
 | 
RE_CHAR_CLASSES
 \

216 | 
RE_HAT_LISTS_NOT_NEWLINE
 | 
RE_INTERVALS
 \

217 | 
RE_NEWLINE_ALT
)

	)

219 
	#RE_SYNTAX_EGREP
 \

220 (
RE_CHAR_CLASSES
 | 
RE_CONTEXT_INDEP_ANCHORS
 \

221 | 
RE_CONTEXT_INDEP_OPS
 | 
RE_HAT_LISTS_NOT_NEWLINE
 \

222 | 
RE_NEWLINE_ALT
 | 
RE_NO_BK_PARENS
 \

223 | 
RE_NO_BK_VBAR
)

	)

225 
	#RE_SYNTAX_POSIX_EGREP
 \

226 (
RE_SYNTAX_EGREP
 | 
RE_INTERVALS
 | 
RE_NO_BK_BRACES
 \

227 | 
RE_INVALID_INTERVAL_ORD
)

	)

230 
	#RE_SYNTAX_ED
 
RE_SYNTAX_POSIX_BASIC


	)

232 
	#RE_SYNTAX_SED
 
RE_SYNTAX_POSIX_BASIC


	)

235 
	#_RE_SYNTAX_POSIX_COMMON
 \

236 (
RE_CHAR_CLASSES
 | 
RE_DOT_NEWLINE
 | 
RE_DOT_NOT_NULL
 \

237 | 
RE_INTERVALS
 | 
RE_NO_EMPTY_RANGES
)

	)

239 #ifde‡
__OPTION_POSIX_REGEXP_GLIBC


240 
	#RE_SYNTAX_POSIX_BASIC
 \

241 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_BK_PLUS_QM
 | 
RE_CONTEXT_INVALID_DUP
)

	)

243 
	#RE_SYNTAX_POSIX_BASIC
 \

244 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_BK_PLUS_QM
)

	)

250 
	#RE_SYNTAX_POSIX_MINIMAL_BASIC
 \

251 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_LIMITED_OPS
)

	)

253 
	#RE_SYNTAX_POSIX_EXTENDED
 \

254 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_CONTEXT_INDEP_ANCHORS
 \

255 | 
RE_CONTEXT_INDEP_OPS
 | 
RE_NO_BK_BRACES
 \

256 | 
RE_NO_BK_PARENS
 | 
RE_NO_BK_VBAR
 \

257 | 
RE_CONTEXT_INVALID_OPS
 | 
RE_UNMATCHED_RIGHT_PAREN_ORD
)

	)

261 
	#RE_SYNTAX_POSIX_MINIMAL_EXTENDED
 \

262 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_CONTEXT_INDEP_ANCHORS
 \

263 | 
RE_CONTEXT_INVALID_OPS
 | 
RE_NO_BK_BRACES
 \

264 | 
RE_NO_BK_PARENS
 | 
RE_NO_BK_REFS
 \

265 | 
RE_NO_BK_VBAR
 | 
RE_UNMATCHED_RIGHT_PAREN_ORD
)

	)

271 #ifde‡
RE_DUP_MAX


272 #unde‡
RE_DUP_MAX


275 
	#RE_DUP_MAX
 (0x7fff)

	)

283 
	#REG_EXTENDED
 1

	)

287 
	#REG_ICASE
 (
REG_EXTENDED
 << 1)

	)

292 
	#REG_NEWLINE
 (
REG_ICASE
 << 1)

	)

296 
	#REG_NOSUB
 (
REG_NEWLINE
 << 1)

	)

306 
	#REG_NOTBOL
 1

	)

309 
	#REG_NOTEOL
 (1 << 1)

	)

311 #ifde‡
__OPTION_POSIX_REGEXP_GLIBC


314 
	#REG_STARTEND
 (1 << 2)

	)

322 #i‡
deföed
 
_XOPEN_SOURCE
 || deföed 
__USE_XOPEN2K


323 
	gREG_ENOSYS
 = -1,

326 
	gREG_NOERROR
 = 0,

327 
	gREG_NOMATCH
,

331 
	gREG_BADPAT
,

332 
	gREG_ECOLLATE
,

333 
	gREG_ECTYPE
,

334 
	gREG_EESCAPE
,

335 
	gREG_ESUBREG
,

336 
	gREG_EBRACK
,

337 
	gREG_EPAREN
,

338 
	gREG_EBRACE
,

339 
	gREG_BADBR
,

340 
	gREG_ERANGE
,

341 
	gREG_ESPACE
,

342 
	gREG_BADRPT
,

345 
	gREG_EEND
,

346 
	gREG_ESIZE
,

347 
	gREG_ERPAREN


348 } 
	tªg_îrcode_t
;

356 #i‚de‡
RE_TRANSLATE_TYPE


357 
	#__RE_TRANSLATE_TYPE
 *

	)

358 #ifde‡
__USE_GNU


359 
	#RE_TRANSLATE_TYPE
 
__RE_TRANSLATE_TYPE


	)

363 #ifde‡
__USE_GNU


364 
	#__REPB_PREFIX
(
«me
Ë
	)
name

366 
	#__REPB_PREFIX
(
«me
Ë
__
##
	)
name

369 
	sª_∑âîn_buf„r


374 *
__REPB_PREFIX
(
buf„r
);

377 
__REPB_PREFIX
(
Æloˇãd
);

380 
__REPB_PREFIX
(
u£d
);

383 
ªg_sy¡ax_t
 
__REPB_PREFIX
(
sy¡ax
);

388 *
__REPB_PREFIX
(
Á°m≠
);

394 
__RE_TRANSLATE_TYPE
 
__REPB_PREFIX
(
å™¶©e
);

397 
size_t
 
	gª_nsub
;

403 
__REPB_PREFIX
(
ˇn_be_nuŒ
) : 1;

409 #ifde‡
__USE_GNU


410 
	#REGS_UNALLOCATED
 0

	)

411 
	#REGS_REALLOCATE
 1

	)

412 
	#REGS_FIXED
 2

	)

414 
__REPB_PREFIX
(
ªgs_Æloˇãd
) : 2;

418 
__REPB_PREFIX
(
Á°m≠_accuøã
) : 1;

422 
__REPB_PREFIX
(
no_sub
) : 1;

426 
__REPB_PREFIX
(
nŸ_bﬁ
) : 1;

429 
__REPB_PREFIX
(
nŸ_eﬁ
) : 1;

432 
__REPB_PREFIX
(
√wlöe_™ch‹
) : 1;

435 
ª_∑âîn_buf„r
 
	tªgex_t
;

438 
	tªgoff_t
;

441 #ifde‡
__USE_GNU


444 
	sª_ªgi°îs


446 
	gnum_ªgs
;

447 
ªgoff_t
 *
	g°¨t
;

448 
ªgoff_t
 *
	gíd
;

455 #i‚de‡
RE_NREGS


456 
	#RE_NREGS
 30

	)

466 
ªgoff_t
 
	grm_so
;

467 
ªgoff_t
 
	grm_eo
;

468 } 
	tªgm©ch_t
;

472 #ifde‡
__USE_GNU


475 
ªg_sy¡ax_t
 
ª_£t_sy¡ax
 (ªg_sy¡ax_à
__sy¡ax
);

485 c⁄° *
ª_compûe_∑âîn
 (c⁄° *
__∑âîn
, 
size_t
 
__Àngth
,

486 
ª_∑âîn_buf„r
 *
__buf„r
);

492 
ª_compûe_Á°m≠
 (
ª_∑âîn_buf„r
 *
__buf„r
);

500 
ª_£¨ch
 (
ª_∑âîn_buf„r
 *
__buf„r
, c⁄° *
__°rög
,

501 
__Àngth
, 
__°¨t
, 
__ønge
,

502 
ª_ªgi°îs
 *
__ªgs
);

507 
ª_£¨ch_2
 (
ª_∑âîn_buf„r
 *
__buf„r
,

508 c⁄° *
__°rög1
, 
__Àngth1
,

509 c⁄° *
__°rög2
, 
__Àngth2
, 
__°¨t
,

510 
__ønge
, 
ª_ªgi°îs
 *
__ªgs
, 
__°›
);

515 
ª_m©ch
 (
ª_∑âîn_buf„r
 *
__buf„r
, c⁄° *
__°rög
,

516 
__Àngth
, 
__°¨t
, 
ª_ªgi°îs
 *
__ªgs
);

520 
ª_m©ch_2
 (
ª_∑âîn_buf„r
 *
__buf„r
,

521 c⁄° *
__°rög1
, 
__Àngth1
,

522 c⁄° *
__°rög2
, 
__Àngth2
, 
__°¨t
,

523 
ª_ªgi°îs
 *
__ªgs
, 
__°›
);

538 
ª_£t_ªgi°îs
 (
ª_∑âîn_buf„r
 *
__buf„r
,

539 
ª_ªgi°îs
 *
__ªgs
,

540 
__num_ªgs
,

541 
ªgoff_t
 *
__°¨ts
,Ñegoff_à*
__íds
);

544 #i‡
deföed
 
_REGEX_RE_COMP
 || (deföed 
_LIBC
 && deföed 
__USE_BSD
)

545 #i‚de‡
_CRAY


547 *
ª_comp
 (const *);

548 
ª_exec
 (const *);

554 #i‚de‡
__ª°ri˘


555 #i‡! (2 < 
__GNUC__
 || (2 =__GNUC__ && 95 <
__GNUC_MINOR__
))

556 #i‡
deföed
 
ª°ri˘
 || 199901L <
__STDC_VERSION__


557 
	#__ª°ri˘
 
ª°ri˘


	)

559 
	#__ª°ri˘


	)

564 #i‚de‡
__ª°ri˘_¨r


565 #i‡(
__GNUC__
 > 3 || (__GNUC__ =3 && 
__GNUC_MINOR__
 >= 1)) \

566 && !
deföed
 
	g__GNUG__


567 
	#__ª°ri˘_¨r
 
__ª°ri˘


	)

569 
	#__ª°ri˘_¨r


	)

574 
ªgcomp
 (
ªgex_t
 *
__ª°ri˘
 
__¥eg
,

575 c⁄° *
__ª°ri˘
 
__∑âîn
,

576 
__cÊags
);

578 
ªgexec
 (c⁄° 
ªgex_t
 *
__ª°ri˘
 
__¥eg
,

579 c⁄° *
__ª°ri˘
 
__°rög
, 
size_t
 
__nm©ch
,

580 
ªgm©ch_t
 
__pm©ch
[
__ª°ri˘_¨r
],

581 
__eÊags
);

583 
size_t
 
ªgîr‹
 (
__îrcode
, c⁄° 
ªgex_t
 *
__ª°ri˘
 
__¥eg
,

584 *
__ª°ri˘
 
__îrbuf
, 
size_t
 
__îrbuf_size
);

586 
ªg‰ì
 (
ªgex_t
 *
__¥eg
);

589 #ifde‡
__˝lu•lus


	@/usr/include/signal.h

22 #i‚def 
_SIGNAL_H


24 #i‡!
deföed
 
__√ed_sig_©omic_t
 && !deföed 
__√ed_sig£t_t


25 
	#_SIGNAL_H


	)

28 
	~<„©uªs.h
>

30 
	g__BEGIN_DECLS


32 
	~<bôs/sig£t.h
>

36 #i‡
deföed
 
__√ed_sig_©omic_t
 || deföed 
_SIGNAL_H


37 #i‚de‡
__sig_©omic_t_deföed


38 
	#__sig_©omic_t_deföed


	)

39 
__BEGIN_NAMESPACE_STD


40 
__sig_©omic_t
 
	tsig_©omic_t
;

41 
	g__END_NAMESPACE_STD


43 #unde‡
__√ed_sig_©omic_t


46 #i‡
deföed
 
__√ed_sig£t_t
 || (deföed 
_SIGNAL_H
 && deföed 
__USE_POSIX
)

47 #i‚de‡
__sig£t_t_deföed


48 
	#__sig£t_t_deföed


	)

49 
__sig£t_t
 
	tsig£t_t
;

51 #unde‡
__√ed_sig£t_t


54 #ifde‡
_SIGNAL_H


56 
	~<bôs/ty≥s.h
>

57 
	~<bôs/signum.h
>

59 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


60 #i‚de‡
__pid_t_deföed


61 
__pid_t
 
	tpid_t
;

62 
	#__pid_t_deföed


	)

64 #ifde‡
__USE_XOPEN


66 #i‚de‡
__uid_t_deföed


67 
__uid_t
 
	tuid_t
;

68 
	#__uid_t_deföed


	)

72 #ifde‡
__USE_POSIX199309


74 
	#__√ed_time•ec


	)

75 
	~<time.h
>

78 #i‡
deföed
 
__USE_POSIX199309
 || deföed 
__USE_XOPEN_EXTENDED


80 
	~<bôs/sigöfo.h
>

85 (*
	t__sigh™dÀr_t
) ();

90 
__sigh™dÀr_t
 
	$__sysv_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

91 
__THROW
;

92 #ifde‡
__USE_GNU


93 
__sigh™dÀr_t
 
	$sysv_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

94 
__THROW
;

100 
__BEGIN_NAMESPACE_STD


101 #ifde‡
__USE_BSD


102 
__sigh™dÀr_t
 
	$sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

103 
__THROW
;

106 #ifde‡
__REDIRECT_NTH


107 
__sigh™dÀr_t
 
	`__REDIRECT_NTH
 (
sig«l
,

108 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
),

109 
__sysv_sig«l
);

111 
	#sig«l
 
__sysv_sig«l


	)

114 
__END_NAMESPACE_STD


116 #ifde‡
__USE_XOPEN


119 
__sigh™dÀr_t
 
	$bsd_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

120 
__THROW
;

126 #ifde‡
__USE_POSIX


127 
	$kûl
 (
__pid_t
 
__pid
, 
__sig
Ë
__THROW
;

130 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


134 
	$kûÕg
 (
__pid_t
 
__pgΩ
, 
__sig
Ë
__THROW
;

137 
__BEGIN_NAMESPACE_STD


139 
	$øi£
 (
__sig
Ë
__THROW
;

140 
__END_NAMESPACE_STD


142 #ifde‡
__USE_SVID


144 
__sigh™dÀr_t
 
	$ssig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

145 
__THROW
;

146 
	$gsig«l
 (
__sig
Ë
__THROW
;

149 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN2K


151 
	`psig«l
 (
__sig
, c⁄° *
__s
);

154 #ifde‡
__USE_XOPEN2K


156 
	`psigöfo
 (c⁄° 
sigöfo_t
 *
__pöfo
, c⁄° *
__s
);

169 
	`__sig∑u£
 (
__sig_‹_mask
, 
__is_sig
);

171 #ifde‡
__FAVOR_BSD


174 
	$sig∑u£
 (
__mask
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

176 #ifde‡
__USE_XOPEN


177 #ifde‡
__GNUC__


178 
	$sig∑u£
 (
__sig
Ë
	`__asm__
 ("__xpg_sigpause");

181 
	#sig∑u£
(
sig
Ë
	`__sig∑u£
 ((sig), 1)

	)

187 #ifde‡
__USE_BSD


194 
	#sigmask
(
sig
Ë
	`__sigmask
(sig)

	)

197 
	$sigblock
 (
__mask
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

200 
	$sig£tmask
 (
__mask
Ë
__THROW
 
__©åibuã_dïªˇãd__
;

203 
	$siggëmask
 (Ë
__THROW
 
__©åibuã_dïªˇãd__
;

207 #ifde‡
__USE_MISC


208 
	#NSIG
 
_NSIG


	)

211 #ifde‡
__USE_GNU


212 
__sigh™dÀr_t
 
	tsigh™dÀr_t
;

216 #ifde‡
__USE_BSD


217 
__sigh™dÀr_t
 
	tsig_t
;

220 #ifde‡
__USE_POSIX


223 
	$sigem±y£t
 (
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

226 
	$sigfûl£t
 (
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

229 
	$sigadd£t
 (
sig£t_t
 *
__£t
, 
__signo
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

232 
	$sigdñ£t
 (
sig£t_t
 *
__£t
, 
__signo
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

235 
	$sigismembî
 (c⁄° 
sig£t_t
 *
__£t
, 
__signo
)

236 
__THROW
 
	`__n⁄nuŒ
 ((1));

238 #ifde‡
__USE_GNU


240 
	$sigi£m±y£t
 (c⁄° 
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

243 
	$sig™d£t
 (
sig£t_t
 *
__£t
, c⁄° sig£t_à*
__À·
,

244 c⁄° 
sig£t_t
 *
__right
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3));

247 
	$sig‹£t
 (
sig£t_t
 *
__£t
, c⁄° sig£t_à*
__À·
,

248 c⁄° 
sig£t_t
 *
__right
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3));

253 
	~<bôs/siga˘i⁄.h
>

256 
	$sig¥ocmask
 (
__how
, c⁄° 
sig£t_t
 *
__ª°ri˘
 
__£t
,

257 
sig£t_t
 *
__ª°ri˘
 
__o£t
Ë
__THROW
;

264 
	$sigsu•íd
 (c⁄° 
sig£t_t
 *
__£t
Ë
	`__n⁄nuŒ
 ((1));

267 
	$siga˘i⁄
 (
__sig
, c⁄° 
siga˘i⁄
 *
__ª°ri˘
 
__a˘
,

268 
siga˘i⁄
 *
__ª°ri˘
 
__ﬂ˘
Ë
__THROW
;

271 
	$sig≥ndög
 (
sig£t_t
 *
__£t
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

278 
	$sigwaô
 (c⁄° 
sig£t_t
 *
__ª°ri˘
 
__£t
, *__ª°ri˘ 
__sig
)

279 
	`__n⁄nuŒ
 ((1, 2));

281 #ifde‡
__USE_POSIX199309


286 
	$sigwaôöfo
 (c⁄° 
sig£t_t
 *
__ª°ri˘
 
__£t
,

287 
sigöfo_t
 *
__ª°ri˘
 
__öfo
Ë
	`__n⁄nuŒ
 ((1));

294 
	$sigtimedwaô
 (c⁄° 
sig£t_t
 *
__ª°ri˘
 
__£t
,

295 
sigöfo_t
 *
__ª°ri˘
 
__öfo
,

296 c⁄° 
time•ec
 *
__ª°ri˘
 
__timeout
)

297 
	`__n⁄nuŒ
 ((1));

301 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, c⁄° 
sigvÆ
 
__vÆ
)

302 
__THROW
;

307 #ifde‡
__USE_BSD


311 c⁄° *c⁄° 
_sys_sigli°
[
_NSIG
];

312 c⁄° *c⁄° 
sys_sigli°
[
_NSIG
];

315 
	ssigvec


317 
__sigh™dÀr_t
 
sv_h™dÀr
;

318 
sv_mask
;

320 
sv_Êags
;

321 
	#sv_⁄°ack
 
sv_Êags


	)

325 
	#SV_ONSTACK
 (1 << 0)

	)

326 
	#SV_INTERRUPT
 (1 << 1)

	)

327 
	#SV_RESETHAND
 (1 << 2)

	)

335 
	$sigvec
 (
__sig
, c⁄° 
sigvec
 *
__vec
,

336 
sigvec
 *
__ovec
Ë
__THROW
;

340 
	~<bôs/sigc⁄ãxt.h
>

343 
	$sigªtu∫
 (
sigc⁄ãxt
 *
__s˝
Ë
__THROW
;

348 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


349 
	#__√ed_size_t


	)

350 
	~<°ddef.h
>

355 
	$sigöãºu±
 (
__sig
, 
__öãºu±
Ë
__THROW
;

357 
	~<bôs/sig°ack.h
>

358 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


360 
	~<sys/uc⁄ãxt.h
>

366 
	$sig°ack
 (
sig°ack
 *
__ss
, sig°ack *
__oss
)

367 
__THROW
 
__©åibuã_dïªˇãd__
;

371 
	$sigÆt°ack
 (c⁄° 
sigÆt°ack
 *
__ª°ri˘
 
__ss
,

372 
sigÆt°ack
 *
__ª°ri˘
 
__oss
Ë
__THROW
;

376 #ifde‡
__USE_XOPEN_EXTENDED


380 
	$sighﬁd
 (
__sig
Ë
__THROW
;

383 
	$sigªl£
 (
__sig
Ë
__THROW
;

386 
	$sigign‹e
 (
__sig
Ë
__THROW
;

389 
__sigh™dÀr_t
 
	$sig£t
 (
__sig
, 
__sigh™dÀr_t
 
__di•
Ë
__THROW
;

392 #i‡
deföed
 
__USE_POSIX199506
 || deföed 
__USE_UNIX98


395 
	~<bôs/±hªadty≥s.h
>

396 
	~<bôs/sigthªad.h
>

403 
	$__libc_cuºít_sigπmö
 (Ë
__THROW
;

405 
	$__libc_cuºít_sigπmax
 (Ë
__THROW
;

409 
__END_DECLS


	@/usr/include/stdint.h

22 #i‚de‡
_STDINT_H


23 
	#_STDINT_H
 1

	)

25 
	~<„©uªs.h
>

26 
	~<bôs/wch¨.h
>

27 
	~<bôs/w‹dsize.h
>

34 #i‚de‡
__öt8_t_deföed


35 
	#__öt8_t_deföed


	)

36 sig√d 
	töt8_t
;

37 
	töt16_t
;

38 
	töt32_t
;

39 #i‡
__WORDSIZE
 == 64

40 
	töt64_t
;

42 
__exãnsi⁄__


43 
	töt64_t
;

48 
	tuöt8_t
;

49 
	tuöt16_t
;

50 #i‚de‡
__uöt32_t_deföed


51 
	tuöt32_t
;

52 
	#__uöt32_t_deföed


	)

54 #i‡
__WORDSIZE
 == 64

55 
	tuöt64_t
;

57 
__exãnsi⁄__


58 
	tuöt64_t
;

65 sig√d 
	töt_Àa°8_t
;

66 
	töt_Àa°16_t
;

67 
	töt_Àa°32_t
;

68 #i‡
__WORDSIZE
 == 64

69 
	töt_Àa°64_t
;

71 
__exãnsi⁄__


72 
	töt_Àa°64_t
;

76 
	tuöt_Àa°8_t
;

77 
	tuöt_Àa°16_t
;

78 
	tuöt_Àa°32_t
;

79 #i‡
__WORDSIZE
 == 64

80 
	tuöt_Àa°64_t
;

82 
__exãnsi⁄__


83 
	tuöt_Àa°64_t
;

90 sig√d 
	töt_Á°8_t
;

91 #i‡
__WORDSIZE
 == 64

92 
	töt_Á°16_t
;

93 
	töt_Á°32_t
;

94 
	töt_Á°64_t
;

96 
	töt_Á°16_t
;

97 
	töt_Á°32_t
;

98 
__exãnsi⁄__


99 
	töt_Á°64_t
;

103 
	tuöt_Á°8_t
;

104 #i‡
__WORDSIZE
 == 64

105 
	tuöt_Á°16_t
;

106 
	tuöt_Á°32_t
;

107 
	tuöt_Á°64_t
;

109 
	tuöt_Á°16_t
;

110 
	tuöt_Á°32_t
;

111 
__exãnsi⁄__


112 
	tuöt_Á°64_t
;

117 #i‡
__WORDSIZE
 == 64

118 #i‚de‡
__öçå_t_deföed


119 
	töçå_t
;

120 
	#__öçå_t_deföed


	)

122 
	tuöçå_t
;

124 #i‚de‡
__öçå_t_deföed


125 
	töçå_t
;

126 
	#__öçå_t_deföed


	)

128 
	tuöçå_t
;

133 #i‡
__WORDSIZE
 == 64

134 
	tötmax_t
;

135 
	tuötmax_t
;

137 
__exãnsi⁄__


138 
	tötmax_t
;

139 
__exãnsi⁄__


140 
	tuötmax_t
;

146 #i‡!
deföed
 
__˝lu•lus
 || deföed 
__STDC_LIMIT_MACROS


148 #i‡
__WORDSIZE
 == 64

149 
	#__INT64_C
(
c
Ë¯## 
L


	)

150 
	#__UINT64_C
(
c
Ë¯## 
UL


	)

152 
	#__INT64_C
(
c
Ë¯## 
LL


	)

153 
	#__UINT64_C
(
c
Ë¯## 
ULL


	)

159 
	#INT8_MIN
 (-128)

	)

160 
	#INT16_MIN
 (-32767-1)

	)

161 
	#INT32_MIN
 (-2147483647-1)

	)

162 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

164 
	#INT8_MAX
 (127)

	)

165 
	#INT16_MAX
 (32767)

	)

166 
	#INT32_MAX
 (2147483647)

	)

167 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

170 
	#UINT8_MAX
 (255)

	)

171 
	#UINT16_MAX
 (65535)

	)

172 
	#UINT32_MAX
 (4294967295U)

	)

173 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

177 
	#INT_LEAST8_MIN
 (-128)

	)

178 
	#INT_LEAST16_MIN
 (-32767-1)

	)

179 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

180 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

182 
	#INT_LEAST8_MAX
 (127)

	)

183 
	#INT_LEAST16_MAX
 (32767)

	)

184 
	#INT_LEAST32_MAX
 (2147483647)

	)

185 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

188 
	#UINT_LEAST8_MAX
 (255)

	)

189 
	#UINT_LEAST16_MAX
 (65535)

	)

190 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

191 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

195 
	#INT_FAST8_MIN
 (-128)

	)

196 #i‡
__WORDSIZE
 == 64

197 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

198 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

200 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

201 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

203 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

205 
	#INT_FAST8_MAX
 (127)

	)

206 #i‡
__WORDSIZE
 == 64

207 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

208 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

210 
	#INT_FAST16_MAX
 (2147483647)

	)

211 
	#INT_FAST32_MAX
 (2147483647)

	)

213 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

216 
	#UINT_FAST8_MAX
 (255)

	)

217 #i‡
__WORDSIZE
 == 64

218 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

219 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

221 
	#UINT_FAST16_MAX
 (4294967295U)

	)

222 
	#UINT_FAST32_MAX
 (4294967295U)

	)

224 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

228 #i‡
__WORDSIZE
 == 64

229 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

230 
	#INTPTR_MAX
 (9223372036854775807L)

	)

231 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

233 
	#INTPTR_MIN
 (-2147483647-1)

	)

234 
	#INTPTR_MAX
 (2147483647)

	)

235 
	#UINTPTR_MAX
 (4294967295U)

	)

240 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

242 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

245 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

251 #i‡
__WORDSIZE
 == 64

252 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

253 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

255 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

256 
	#PTRDIFF_MAX
 (2147483647)

	)

260 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

261 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

264 #i‡
__WORDSIZE
 == 64

265 
	#SIZE_MAX
 (18446744073709551615UL)

	)

267 
	#SIZE_MAX
 (4294967295U)

	)

271 #i‚de‡
WCHAR_MIN


273 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

274 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

278 
	#WINT_MIN
 (0u)

	)

279 
	#WINT_MAX
 (4294967295u)

	)

286 #i‡!
deföed
 
__˝lu•lus
 || deföed 
__STDC_CONSTANT_MACROS


289 
	#INT8_C
(
c
Ë
	)
c

290 
	#INT16_C
(
c
Ë
	)
c

291 
	#INT32_C
(
c
Ë
	)
c

292 #i‡
__WORDSIZE
 == 64

293 
	#INT64_C
(
c
Ë¯## 
L


	)

295 
	#INT64_C
(
c
Ë¯## 
LL


	)

299 
	#UINT8_C
(
c
Ë
	)
c

300 
	#UINT16_C
(
c
Ë
	)
c

301 
	#UINT32_C
(
c
Ë¯## 
U


	)

302 #i‡
__WORDSIZE
 == 64

303 
	#UINT64_C
(
c
Ë¯## 
UL


	)

305 
	#UINT64_C
(
c
Ë¯## 
ULL


	)

309 #i‡
__WORDSIZE
 == 64

310 
	#INTMAX_C
(
c
Ë¯## 
L


	)

311 
	#UINTMAX_C
(
c
Ë¯## 
UL


	)

313 
	#INTMAX_C
(
c
Ë¯## 
LL


	)

314 
	#UINTMAX_C
(
c
Ë¯## 
ULL


	)

	@/usr/include/stdio.h

23 #i‚de‡
_STDIO_H


25 #i‡!
deföed
 
__√ed_FILE
 && !deföed 
__√ed___FILE


26 
	#_STDIO_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


31 
	#__√ed_size_t


	)

32 
	#__√ed_NULL


	)

33 
	~<°ddef.h
>

35 
	~<bôs/ty≥s.h
>

36 
	#__√ed_FILE


	)

37 
	#__√ed___FILE


	)

41 #i‡!
deföed
 
__FILE_deföed
 && deföed 
__√ed_FILE


44 
	g_IO_FILE
;

46 
__BEGIN_NAMESPACE_STD


48 
_IO_FILE
 
	tFILE
;

49 
	g__END_NAMESPACE_STD


50 #i‡
deföed
 
__USE_LARGEFILE64
 || deföed 
__USE_SVID
 || deföed 
__USE_POSIX
 \

51 || 
deföed
 
	g__USE_BSD
 || deföed 
	g__USE_ISOC99
 || deföed 
	g__USE_XOPEN
 \

52 || 
deföed
 
__USE_POSIX2


53 
	$__USING_NAMESPACE_STD
(
FILE
)

56 
	#__FILE_deföed
 1

	)

58 #unde‡
__√ed_FILE


61 #i‡!
deföed
 
____FILE_deföed
 && deföed 
__√ed___FILE


64 
_IO_FILE
 
	t__FILE
;

66 
	#____FILE_deföed
 1

	)

68 #unde‡
__√ed___FILE


71 #ifdef 
_STDIO_H


72 
	#_STDIO_USES_IOSTREAM


	)

74 
	~<libio.h
>

76 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


77 #ifde‡
__GNUC__


78 #i‚de‡
_VA_LIST_DEFINED


79 
_G_va_li°
 
	tva_li°
;

80 
	#_VA_LIST_DEFINED


	)

83 
	~<°d¨g.h
>

87 #ifde‡
__USE_XOPEN2K8


88 #i‚de‡
__off_t_deföed


89 #i‚de‡
__USE_FILE_OFFSET64


90 
__off_t
 
	toff_t
;

92 
__off64_t
 
	toff_t
;

94 
	#__off_t_deföed


	)

96 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


97 
__off64_t
 
	toff64_t
;

98 
	#__off64_t_deföed


	)

101 #i‚de‡
__ssize_t_deföed


102 
__ssize_t
 
	tssize_t
;

103 
	#__ssize_t_deföed


	)

108 
__BEGIN_NAMESPACE_STD


109 #i‚de‡
__USE_FILE_OFFSET64


110 
_G_Âos_t
 
	tÂos_t
;

112 
_G_Âos64_t
 
	tÂos_t
;

114 
__END_NAMESPACE_STD


115 #ifde‡
__USE_LARGEFILE64


116 
_G_Âos64_t
 
	tÂos64_t
;

120 
	#_IOFBF
 0

	)

121 
	#_IOLBF
 1

	)

122 
	#_IONBF
 2

	)

126 #i‚de‡
BUFSIZ


127 
	#BUFSIZ
 
_IO_BUFSIZ


	)

133 #i‚de‡
EOF


134 
	#EOF
 (-1)

	)

140 
	#SEEK_SET
 0

	)

141 
	#SEEK_CUR
 1

	)

142 
	#SEEK_END
 2

	)

143 #ifde‡
__USE_GNU


144 
	#SEEK_DATA
 3

	)

145 
	#SEEK_HOLE
 4

	)

149 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


151 
	#P_tmpdú
 "/tmp"

	)

164 
	~<bôs/°dio_lim.h
>

168 
_IO_FILE
 *
°dö
;

169 
_IO_FILE
 *
°dout
;

170 
_IO_FILE
 *
°dîr
;

172 
	#°dö
 
°dö


	)

173 
	#°dout
 
°dout


	)

174 
	#°dîr
 
°dîr


	)

176 
__BEGIN_NAMESPACE_STD


178 
	$ªmove
 (c⁄° *
__fûíame
Ë
__THROW
;

180 
	$ª«me
 (c⁄° *
__ﬁd
, c⁄° *
__√w
Ë
__THROW
;

181 
__END_NAMESPACE_STD


183 #ifde‡
__USE_ATFILE


185 
	$ª«mót
 (
__ﬁdfd
, c⁄° *
__ﬁd
, 
__√wfd
,

186 c⁄° *
__√w
Ë
__THROW
;

189 
__BEGIN_NAMESPACE_STD


194 #i‚de‡
__USE_FILE_OFFSET64


195 
FILE
 *
	$tmpfûe
 (Ë
__wur
;

197 #ifde‡
__REDIRECT


198 
FILE
 *
	`__REDIRECT
 (
tmpfûe
, (), 
tmpfûe64
Ë
__wur
;

200 
	#tmpfûe
 
tmpfûe64


	)

204 #ifde‡
__USE_LARGEFILE64


205 
FILE
 *
	$tmpfûe64
 (Ë
__wur
;

209 *
	$tm≤am
 (*
__s
Ë
__THROW
 
__wur
;

210 
__END_NAMESPACE_STD


212 #ifde‡
__USE_MISC


215 *
	$tm≤am_r
 (*
__s
Ë
__THROW
 
__wur
;

219 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


227 *
	$ãm≤am
 (c⁄° *
__dú
, c⁄° *
__pfx
)

228 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

232 
__BEGIN_NAMESPACE_STD


237 
	`f˛o£
 (
FILE
 *
__°ªam
);

242 
	`fÊush
 (
FILE
 *
__°ªam
);

243 
__END_NAMESPACE_STD


245 #ifde‡
__USE_MISC


252 
	`fÊush_u∆ocked
 (
FILE
 *
__°ªam
);

255 #ifde‡
__USE_GNU


262 
	`f˛o£Æl
 ();

266 
__BEGIN_NAMESPACE_STD


267 #i‚de‡
__USE_FILE_OFFSET64


272 
FILE
 *
	$f›í
 (c⁄° *
__ª°ri˘
 
__fûíame
,

273 c⁄° *
__ª°ri˘
 
__modes
Ë
__wur
;

278 
FILE
 *
	$‰e›í
 (c⁄° *
__ª°ri˘
 
__fûíame
,

279 c⁄° *
__ª°ri˘
 
__modes
,

280 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

282 #ifde‡
__REDIRECT


283 
FILE
 *
	`__REDIRECT
 (
f›í
, (c⁄° *
__ª°ri˘
 
__fûíame
,

284 c⁄° *
__ª°ri˘
 
__modes
), 
f›í64
)

285 
__wur
;

286 
FILE
 *
	`__REDIRECT
 (
‰e›í
, (c⁄° *
__ª°ri˘
 
__fûíame
,

287 c⁄° *
__ª°ri˘
 
__modes
,

288 
FILE
 *
__ª°ri˘
 
__°ªam
), 
‰e›í64
)

289 
__wur
;

291 
	#f›í
 
f›í64


	)

292 
	#‰e›í
 
‰e›í64


	)

295 
__END_NAMESPACE_STD


296 #ifde‡
__USE_LARGEFILE64


297 
FILE
 *
	$f›í64
 (c⁄° *
__ª°ri˘
 
__fûíame
,

298 c⁄° *
__ª°ri˘
 
__modes
Ë
__wur
;

299 
FILE
 *
	$‰e›í64
 (c⁄° *
__ª°ri˘
 
__fûíame
,

300 c⁄° *
__ª°ri˘
 
__modes
,

301 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

304 #ifdef 
__USE_POSIX


306 
FILE
 *
	$fd›í
 (
__fd
, c⁄° *
__modes
Ë
__THROW
 
__wur
;

309 #ifdef 
__USE_GNU


312 
FILE
 *
	$f›ícookõ
 (*
__ª°ri˘
 
__magic_cookõ
,

313 c⁄° *
__ª°ri˘
 
__modes
,

314 
_IO_cookõ_io_fun˘i⁄s_t
 
__io_funcs
Ë
__THROW
 
__wur
;

317 #ifde‡
__USE_XOPEN2K8


319 
FILE
 *
	$fmem›í
 (*
__s
, 
size_t
 
__Àn
, c⁄° *
__modes
)

320 
__THROW
 
__wur
;

325 
FILE
 *
	$›í_mem°ªam
 (**
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
 
__wur
;

329 
__BEGIN_NAMESPACE_STD


332 
	$£tbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
Ë
__THROW
;

336 
	$£tvbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

337 
__modes
, 
size_t
 
__n
Ë
__THROW
;

338 
__END_NAMESPACE_STD


340 #ifdef 
__USE_BSD


343 
	$£tbuf„r
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

344 
size_t
 
__size
Ë
__THROW
;

347 
	$£éöebuf
 (
FILE
 *
__°ªam
Ë
__THROW
;

351 
__BEGIN_NAMESPACE_STD


356 
	`Ârötf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

357 c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

362 
	`¥ötf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

364 
	$•rötf
 (*
__ª°ri˘
 
__s
,

365 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROWNL
;

371 
	`vÂrötf
 (
FILE
 *
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

372 
_G_va_li°
 
__¨g
);

377 
	`v¥ötf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
);

379 
	$v•rötf
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

380 
_G_va_li°
 
__¨g
Ë
__THROWNL
;

381 
__END_NAMESPACE_STD


383 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_ISOC99
 || deföed 
__USE_UNIX98


384 
__BEGIN_NAMESPACE_C99


386 
	$¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

387 c⁄° *
__ª°ri˘
 
__f‹m©
, ...)

388 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 4)));

390 
	$v¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

391 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

392 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 0)));

393 
__END_NAMESPACE_C99


396 #ifde‡
__USE_GNU


399 
	$va•rötf
 (**
__ª°ri˘
 
__±r
, c⁄° *__ª°ri˘ 
__f
,

400 
_G_va_li°
 
__¨g
)

401 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 0))Ë
__wur
;

402 
	$__a•rötf
 (**
__ª°ri˘
 
__±r
,

403 c⁄° *
__ª°ri˘
 
__fmt
, ...)

404 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

405 
	$a•rötf
 (**
__ª°ri˘
 
__±r
,

406 c⁄° *
__ª°ri˘
 
__fmt
, ...)

407 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

410 #ifde‡
__USE_XOPEN2K8


412 
	$vd¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
,

413 
_G_va_li°
 
__¨g
)

414 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

415 
	$d¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
, ...)

416 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

420 
__BEGIN_NAMESPACE_STD


425 
	$fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

426 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

431 
	$sˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

433 
	$ssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

434 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

436 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

437 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

438 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

439 #ifde‡
__REDIRECT


443 
	`__REDIRECT
 (
fsˇnf
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

444 c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

445 
__isoc99_fsˇnf
Ë
__wur
;

446 
	`__REDIRECT
 (
sˇnf
, (c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

447 
__isoc99_sˇnf
Ë
__wur
;

448 
	`__REDIRECT_NTH
 (
ssˇnf
, (c⁄° *
__ª°ri˘
 
__s
,

449 c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

450 
__isoc99_ssˇnf
);

452 
	$__isoc99_fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

453 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

454 
	$__isoc99_sˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

455 
	$__isoc99_ssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

456 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

457 
	#fsˇnf
 
__isoc99_fsˇnf


	)

458 
	#sˇnf
 
__isoc99_sˇnf


	)

459 
	#ssˇnf
 
__isoc99_ssˇnf


	)

463 
__END_NAMESPACE_STD


465 #ifdef 
__USE_ISOC99


466 
__BEGIN_NAMESPACE_C99


471 
	$vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

472 
_G_va_li°
 
__¨g
)

473 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

479 
	$vsˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

480 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

483 
	$vssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

484 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

485 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

487 #i‡!
deföed
 
__USE_GNU
 \

488 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

489 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

490 #ifde‡
__REDIRECT


494 
	`__REDIRECT
 (
vfsˇnf
,

495 (
FILE
 *
__ª°ri˘
 
__s
,

496 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
),

497 
__isoc99_vfsˇnf
)

498 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

499 
	`__REDIRECT
 (
vsˇnf
, (c⁄° *
__ª°ri˘
 
__f‹m©
,

500 
_G_va_li°
 
__¨g
), 
__isoc99_vsˇnf
)

501 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

502 
	`__REDIRECT_NTH
 (
vssˇnf
,

503 (c⁄° *
__ª°ri˘
 
__s
,

504 c⁄° *
__ª°ri˘
 
__f‹m©
,

505 
_G_va_li°
 
__¨g
), 
__isoc99_vssˇnf
)

506 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

508 
	$__isoc99_vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
,

509 c⁄° *
__ª°ri˘
 
__f‹m©
,

510 
_G_va_li°
 
__¨g
Ë
__wur
;

511 
	$__isoc99_vsˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
,

512 
_G_va_li°
 
__¨g
Ë
__wur
;

513 
	$__isoc99_vssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

514 c⁄° *
__ª°ri˘
 
__f‹m©
,

515 
_G_va_li°
 
__¨g
Ë
__THROW
;

516 
	#vfsˇnf
 
__isoc99_vfsˇnf


	)

517 
	#vsˇnf
 
__isoc99_vsˇnf


	)

518 
	#vssˇnf
 
__isoc99_vssˇnf


	)

522 
__END_NAMESPACE_C99


526 
__BEGIN_NAMESPACE_STD


531 
	`fgëc
 (
FILE
 *
__°ªam
);

532 
	`gëc
 (
FILE
 *
__°ªam
);

538 
	`gëch¨
 ();

539 
__END_NAMESPACE_STD


543 
	#gëc
(
_Â
Ë
	`_IO_gëc
 (_Â)

	)

545 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


550 
	`gëc_u∆ocked
 (
FILE
 *
__°ªam
);

551 
	`gëch¨_u∆ocked
 ();

554 #ifde‡
__USE_MISC


561 
	`fgëc_u∆ocked
 (
FILE
 *
__°ªam
);

565 
__BEGIN_NAMESPACE_STD


573 
	`Âutc
 (
__c
, 
FILE
 *
__°ªam
);

574 
	`putc
 (
__c
, 
FILE
 *
__°ªam
);

580 
	`putch¨
 (
__c
);

581 
__END_NAMESPACE_STD


585 
	#putc
(
_ch
, 
_Â
Ë
	`_IO_putc
 (_ch, _Â)

	)

587 #ifde‡
__USE_MISC


594 
	`Âutc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

597 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


602 
	`putc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

603 
	`putch¨_u∆ocked
 (
__c
);

607 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 \

608 || (
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

610 
	`gëw
 (
FILE
 *
__°ªam
);

613 
	`putw
 (
__w
, 
FILE
 *
__°ªam
);

617 
__BEGIN_NAMESPACE_STD


622 *
	$fgës
 (*
__ª°ri˘
 
__s
, 
__n
, 
FILE
 *__ª°ri˘ 
__°ªam
)

623 
__wur
;

625 #i‡!
deföed
 
__USE_ISOC11
 \

626 || (
deföed
 
__˝lu•lus
 && __cplusplus <= 201103L)

638 *
	$gës
 (*
__s
Ë
__wur
 
__©åibuã_dïªˇãd__
;

640 
__END_NAMESPACE_STD


642 #ifde‡
__USE_GNU


649 *
	$fgës_u∆ocked
 (*
__ª°ri˘
 
__s
, 
__n
,

650 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

654 #ifdef 
__USE_XOPEN2K8


665 
_IO_ssize_t
 
	$__gëdñim
 (**
__ª°ri˘
 
__löïå
,

666 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

667 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

668 
_IO_ssize_t
 
	$gëdñim
 (**
__ª°ri˘
 
__löïå
,

669 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

670 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

678 
_IO_ssize_t
 
	$gëlöe
 (**
__ª°ri˘
 
__löïå
,

679 
size_t
 *
__ª°ri˘
 
__n
,

680 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

684 
__BEGIN_NAMESPACE_STD


689 
	`Âuts
 (c⁄° *
__ª°ri˘
 
__s
, 
FILE
 *__ª°ri˘ 
__°ªam
);

695 
	`puts
 (c⁄° *
__s
);

702 
	`ungëc
 (
__c
, 
FILE
 *
__°ªam
);

709 
size_t
 
	$‰ód
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

710 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

715 
size_t
 
	`fwrôe
 (c⁄° *
__ª°ri˘
 
__±r
, size_à
__size
,

716 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__s
);

717 
__END_NAMESPACE_STD


719 #ifde‡
__USE_GNU


726 
	`Âuts_u∆ocked
 (c⁄° *
__ª°ri˘
 
__s
,

727 
FILE
 *
__ª°ri˘
 
__°ªam
);

730 #ifde‡
__USE_MISC


737 
size_t
 
	$‰ód_u∆ocked
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

738 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

739 
size_t
 
	`fwrôe_u∆ocked
 (c⁄° *
__ª°ri˘
 
__±r
, size_à
__size
,

740 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
);

744 
__BEGIN_NAMESPACE_STD


749 
	`f£ek
 (
FILE
 *
__°ªam
, 
__off
, 
__whí˚
);

754 
	$·ñl
 (
FILE
 *
__°ªam
Ë
__wur
;

759 
	`ªwöd
 (
FILE
 *
__°ªam
);

760 
__END_NAMESPACE_STD


767 #i‡
deföed
 
__USE_LARGEFILE
 || deföed 
__USE_XOPEN2K


768 #i‚de‡
__USE_FILE_OFFSET64


773 
	`f£eko
 (
FILE
 *
__°ªam
, 
__off_t
 
__off
, 
__whí˚
);

778 
__off_t
 
	$·ñlo
 (
FILE
 *
__°ªam
Ë
__wur
;

780 #ifde‡
__REDIRECT


781 
	`__REDIRECT
 (
f£eko
,

782 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
),

783 
f£eko64
);

784 
__off64_t
 
	`__REDIRECT
 (
·ñlo
, (
FILE
 *
__°ªam
), 
·ñlo64
);

786 
	#f£eko
 
f£eko64


	)

787 
	#·ñlo
 
·ñlo64


	)

792 
__BEGIN_NAMESPACE_STD


793 #i‚de‡
__USE_FILE_OFFSET64


798 
	`fgëpos
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos_t
 *__ª°ri˘ 
__pos
);

803 
	`f£ços
 (
FILE
 *
__°ªam
, c⁄° 
Âos_t
 *
__pos
);

805 #ifde‡
__REDIRECT


806 
	`__REDIRECT
 (
fgëpos
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

807 
Âos_t
 *
__ª°ri˘
 
__pos
), 
fgëpos64
);

808 
	`__REDIRECT
 (
f£ços
,

809 (
FILE
 *
__°ªam
, c⁄° 
Âos_t
 *
__pos
), 
f£ços64
);

811 
	#fgëpos
 
fgëpos64


	)

812 
	#f£ços
 
f£ços64


	)

815 
__END_NAMESPACE_STD


817 #ifde‡
__USE_LARGEFILE64


818 
	`f£eko64
 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
);

819 
__off64_t
 
	$·ñlo64
 (
FILE
 *
__°ªam
Ë
__wur
;

820 
	`fgëpos64
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos64_t
 *__ª°ri˘ 
__pos
);

821 
	`f£ços64
 (
FILE
 *
__°ªam
, c⁄° 
Âos64_t
 *
__pos
);

824 
__BEGIN_NAMESPACE_STD


826 
	$˛óªº
 (
FILE
 *
__°ªam
Ë
__THROW
;

828 
	$„of
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

830 
	$„º‹
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

831 
__END_NAMESPACE_STD


833 #ifde‡
__USE_MISC


835 
	$˛óªº_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
;

836 
	$„of_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

837 
	$„º‹_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

841 
__BEGIN_NAMESPACE_STD


846 
	`≥º‹
 (c⁄° *
__s
);

847 
__END_NAMESPACE_STD


853 
	~<bôs/sys_îæi°.h
>

856 #ifdef 
__USE_POSIX


858 
	$fûío
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

861 #ifde‡
__USE_MISC


863 
	$fûío_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

867 #i‡(
deföed
 
__USE_POSIX2
 || deföed 
__USE_SVID
 || deföed 
__USE_BSD
 || \

868 
deföed
 
__USE_MISC
)

873 
FILE
 *
	$p›í
 (c⁄° *
__comm™d
, c⁄° *
__modes
Ë
__wur
;

879 
	`p˛o£
 (
FILE
 *
__°ªam
);

883 #ifdef 
__USE_POSIX


885 *
	$˘îmid
 (*
__s
Ë
__THROW
;

889 #ifde‡
__USE_XOPEN


891 *
	`cu£rid
 (*
__s
);

895 #ifdef 
__USE_GNU


896 
ob°ack
;

899 
	$ob°ack_¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

900 c⁄° *
__ª°ri˘
 
__f‹m©
, ...)

901 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

902 
	$ob°ack_v¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

903 c⁄° *
__ª°ri˘
 
__f‹m©
,

904 
_G_va_li°
 
__¨gs
)

905 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

909 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


913 
	$Êockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

917 
	$·rylockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

920 
	$fu∆ockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

923 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


927 
	#__√ed_gë›t


	)

928 
	~<gë›t.h
>

933 #ifde‡
__USE_EXTERN_INLINES


934 
	~<bôs/°dio.h
>

936 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__exã∫_Æways_ölöe


937 
	~<bôs/°dio2.h
>

939 #ifde‡
__LDBL_COMPAT


940 
	~<bôs/°dio-ldbl.h
>

943 
__END_DECLS


	@/usr/include/stdlib.h

22 #i‚def 
_STDLIB_H


24 
	~<„©uªs.h
>

27 
	#__√ed_size_t


	)

28 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


29 
	#__√ed_wch¨_t


	)

30 
	#__√ed_NULL


	)

32 
	~<°ddef.h
>

34 
	g__BEGIN_DECLS


36 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


37 
	#_STDLIB_H
 1

	)

39 #i‡(
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8
Ë&& !deföed 
_SYS_WAIT_H


41 
	~<bôs/waôÊags.h
>

42 
	~<bôs/waô°©us.h
>

44 #ifde‡
__USE_BSD


49 #i‡
deföed
 
__GNUC__
 && !deföed 
__˝lu•lus


50 
	#__WAIT_INT
(
°©us
) \

51 (
	`__exãnsi⁄__
 (((uni⁄ { 
	`__ty≥of
(
°©us
Ë
__ö
; 
__i
; }) \

52 { .
__ö
 = (
°©us
Ë}).
__i
))

	)

54 
	#__WAIT_INT
(
°©us
Ë(*(*Ë&(°©us))

	)

62 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2 || deföed 
__˝lu•lus


63 
	#__WAIT_STATUS
 *

	)

64 
	#__WAIT_STATUS_DEFN
 *

	)

69 
waô
 *
	m__u±r
;

70 *
	m__ùå
;

71 } 
	t__WAIT_STATUS
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

72 
	#__WAIT_STATUS_DEFN
 *

	)

77 
	#__WAIT_INT
(
°©us
Ë(°©us)

	)

78 
	#__WAIT_STATUS
 *

	)

79 
	#__WAIT_STATUS_DEFN
 *

	)

84 
	#WEXITSTATUS
(
°©us
Ë
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (°©us))

	)

85 
	#WTERMSIG
(
°©us
Ë
	`__WTERMSIG
 (
	`__WAIT_INT
 (°©us))

	)

86 
	#WSTOPSIG
(
°©us
Ë
	`__WSTOPSIG
 (
	`__WAIT_INT
 (°©us))

	)

87 
	#WIFEXITED
(
°©us
Ë
	`__WIFEXITED
 (
	`__WAIT_INT
 (°©us))

	)

88 
	#WIFSIGNALED
(
°©us
Ë
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (°©us))

	)

89 
	#WIFSTOPPED
(
°©us
Ë
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (°©us))

	)

90 #ifde‡
__WIFCONTINUED


91 
	#WIFCONTINUED
(
°©us
Ë
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (°©us))

	)

95 
__BEGIN_NAMESPACE_STD


99 
	mquŸ
;

100 
	mªm
;

101 } 
	tdiv_t
;

104 #i‚de‡
__ldiv_t_deföed


107 
	mquŸ
;

108 
	mªm
;

109 } 
	tldiv_t
;

110 
	#__ldiv_t_deföed
 1

	)

112 
	g__END_NAMESPACE_STD


114 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__Œdiv_t_deföed


115 
__BEGIN_NAMESPACE_C99


117 
__exãnsi⁄__
 struct

119 
	mquŸ
;

120 
	mªm
;

121 } 
	tŒdiv_t
;

122 
	#__Œdiv_t_deföed
 1

	)

123 
	g__END_NAMESPACE_C99


128 
	#RAND_MAX
 2147483647

	)

133 
	#EXIT_FAILURE
 1

	)

134 
	#EXIT_SUCCESS
 0

	)

138 
	#MB_CUR_MAX
 (
	`__˘y≥_gë_mb_cur_max
 ())

	)

139 
size_t
 
	$__˘y≥_gë_mb_cur_max
 (Ë
__THROW
 
__wur
;

142 
__BEGIN_NAMESPACE_STD


144 
	$©of
 (c⁄° *
__≈å
)

145 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

147 
	$©oi
 (c⁄° *
__≈å
)

148 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

150 
	$©ﬁ
 (c⁄° *
__≈å
)

151 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

152 
__END_NAMESPACE_STD


154 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_MISC
)

155 
__BEGIN_NAMESPACE_C99


157 
__exãnsi⁄__
 
	$©ﬁl
 (c⁄° *
__≈å
)

158 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

159 
__END_NAMESPACE_C99


162 
__BEGIN_NAMESPACE_STD


164 
	$°πod
 (c⁄° *
__ª°ri˘
 
__≈å
,

165 **
__ª°ri˘
 
__íd±r
)

166 
__THROW
 
	`__n⁄nuŒ
 ((1));

167 
__END_NAMESPACE_STD


169 #ifdef 
__USE_ISOC99


170 
__BEGIN_NAMESPACE_C99


172 
	$°πof
 (c⁄° *
__ª°ri˘
 
__≈å
,

173 **
__ª°ri˘
 
__íd±r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

175 
	$°πﬁd
 (c⁄° *
__ª°ri˘
 
__≈å
,

176 **
__ª°ri˘
 
__íd±r
)

177 
__THROW
 
	`__n⁄nuŒ
 ((1));

178 
__END_NAMESPACE_C99


181 
__BEGIN_NAMESPACE_STD


183 
	$°πﬁ
 (c⁄° *
__ª°ri˘
 
__≈å
,

184 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

185 
__THROW
 
	`__n⁄nuŒ
 ((1));

187 
	$°πoul
 (c⁄° *
__ª°ri˘
 
__≈å
,

188 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

189 
__THROW
 
	`__n⁄nuŒ
 ((1));

190 
__END_NAMESPACE_STD


192 #i‡
deföed
 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_BSD


194 
__exãnsi⁄__


195 
	$°πoq
 (c⁄° *
__ª°ri˘
 
__≈å
,

196 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

197 
__THROW
 
	`__n⁄nuŒ
 ((1));

199 
__exãnsi⁄__


200 
	$°πouq
 (c⁄° *
__ª°ri˘
 
__≈å
,

201 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

202 
__THROW
 
	`__n⁄nuŒ
 ((1));

205 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_MISC
)

206 
__BEGIN_NAMESPACE_C99


208 
__exãnsi⁄__


209 
	$°πﬁl
 (c⁄° *
__ª°ri˘
 
__≈å
,

210 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

211 
__THROW
 
	`__n⁄nuŒ
 ((1));

213 
__exãnsi⁄__


214 
	$°πouŒ
 (c⁄° *
__ª°ri˘
 
__≈å
,

215 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

216 
__THROW
 
	`__n⁄nuŒ
 ((1));

217 
__END_NAMESPACE_C99


221 #ifde‡
__USE_GNU


235 
	~<xloˇÀ.h
>

239 
	$°πﬁ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

240 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

241 
__loˇÀ_t
 
__loc
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

243 
	$°πoul_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

244 **
__ª°ri˘
 
__íd±r
,

245 
__ba£
, 
__loˇÀ_t
 
__loc
)

246 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

248 
__exãnsi⁄__


249 
	$°πﬁl_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

250 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

251 
__loˇÀ_t
 
__loc
)

252 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

254 
__exãnsi⁄__


255 
	$°πouŒ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

256 **
__ª°ri˘
 
__íd±r
,

257 
__ba£
, 
__loˇÀ_t
 
__loc
)

258 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

260 
	$°πod_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

261 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

262 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

264 
	$°πof_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

265 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

266 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

268 
	$°πﬁd_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

269 **
__ª°ri˘
 
__íd±r
,

270 
__loˇÀ_t
 
__loc
)

271 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

275 #ifde‡
__USE_EXTERN_INLINES


276 
__BEGIN_NAMESPACE_STD


277 
__exã∫_ölöe
 

278 
	`__NTH
 (
	$©oi
 (c⁄° *
__≈å
))

280  (Ë
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

281 
	}
}

282 
__exã∫_ölöe
 

283 
__NTH
 (
	$©ﬁ
 (c⁄° *
__≈å
))

285  
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

286 
	}
}

287 
	g__END_NAMESPACE_STD


289 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


290 
__BEGIN_NAMESPACE_C99


291 
__exãnsi⁄__
 
__exã∫_ölöe
 

292 
__NTH
 (
	$©ﬁl
 (c⁄° *
__≈å
))

294  
	`°πﬁl
 (
__≈å
, (**Ë
NULL
, 10);

295 
	}
}

296 
	g__END_NAMESPACE_C99


301 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED


305 *
	$l64a
 (
__n
Ë
__THROW
 
__wur
;

308 
	$a64l
 (c⁄° *
__s
)

309 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

313 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_BSD


314 
	~<sys/ty≥s.h
>

321 
	$øndom
 (Ë
__THROW
;

324 
	$§™dom
 (
__£ed
Ë
__THROW
;

330 *
	$öô°©e
 (
__£ed
, *
__°©ebuf
,

331 
size_t
 
__°©ñí
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

335 *
	$£t°©e
 (*
__°©ebuf
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

338 #ifde‡
__USE_MISC


343 
	søndom_d©a


345 
öt32_t
 *
Âå
;

346 
öt32_t
 *
Ωå
;

347 
öt32_t
 *
°©e
;

348 
ønd_ty≥
;

349 
ønd_deg
;

350 
ønd_£p
;

351 
öt32_t
 *
íd_±r
;

354 
	$øndom_r
 (
øndom_d©a
 *
__ª°ri˘
 
__buf
,

355 
öt32_t
 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

357 
	$§™dom_r
 (
__£ed
, 
øndom_d©a
 *
__buf
)

358 
__THROW
 
	`__n⁄nuŒ
 ((2));

360 
	$öô°©e_r
 (
__£ed
, *
__ª°ri˘
 
__°©ebuf
,

361 
size_t
 
__°©ñí
,

362 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

363 
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

365 
	$£t°©e_r
 (*
__ª°ri˘
 
__°©ebuf
,

366 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

367 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

372 
__BEGIN_NAMESPACE_STD


374 
	$ønd
 (Ë
__THROW
;

376 
	$§™d
 (
__£ed
Ë
__THROW
;

377 
__END_NAMESPACE_STD


379 #ifde‡
__USE_POSIX


381 
	$ønd_r
 (*
__£ed
Ë
__THROW
;

385 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


389 
	$dønd48
 (Ë
__THROW
;

390 
	$î™d48
 (
__xsubi
[3]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

393 
	$Ã™d48
 (Ë
__THROW
;

394 
	$ƒ™d48
 (
__xsubi
[3])

395 
__THROW
 
	`__n⁄nuŒ
 ((1));

398 
	$mønd48
 (Ë
__THROW
;

399 
	$jønd48
 (
__xsubi
[3])

400 
__THROW
 
	`__n⁄nuŒ
 ((1));

403 
	$§™d48
 (
__£edvÆ
Ë
__THROW
;

404 *
	$£ed48
 (
__£ed16v
[3])

405 
__THROW
 
	`__n⁄nuŒ
 ((1));

406 
	$lc⁄g48
 (
__∑øm
[7]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

408 #ifde‡
__USE_MISC


412 
	sdønd48_d©a


414 
__x
[3];

415 
__ﬁd_x
[3];

416 
__c
;

417 
__öô
;

418 
__a
;

422 
	$dønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

423 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

424 
	$î™d48_r
 (
__xsubi
[3],

425 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

426 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

429 
	$Ã™d48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

430 *
__ª°ri˘
 
__ªsu…
)

431 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

432 
	$ƒ™d48_r
 (
__xsubi
[3],

433 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

434 *
__ª°ri˘
 
__ªsu…
)

435 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

438 
	$mønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

439 *
__ª°ri˘
 
__ªsu…
)

440 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

441 
	$jønd48_r
 (
__xsubi
[3],

442 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

443 *
__ª°ri˘
 
__ªsu…
)

444 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

447 
	$§™d48_r
 (
__£edvÆ
, 
dønd48_d©a
 *
__buf„r
)

448 
__THROW
 
	`__n⁄nuŒ
 ((2));

450 
	$£ed48_r
 (
__£ed16v
[3],

451 
dønd48_d©a
 *
__buf„r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

453 
	$lc⁄g48_r
 (
__∑øm
[7],

454 
dønd48_d©a
 *
__buf„r
)

455 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

461 #i‚de‡
__mÆloc_™d_ˇŒoc_deföed


462 
	#__mÆloc_™d_ˇŒoc_deföed


	)

463 
__BEGIN_NAMESPACE_STD


465 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

467 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

468 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

469 
__END_NAMESPACE_STD


472 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


473 
__BEGIN_NAMESPACE_STD


479 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
)

480 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

482 
	$‰ì
 (*
__±r
Ë
__THROW
;

483 
__END_NAMESPACE_STD


485 #ifdef 
__USE_MISC


487 
	$c‰ì
 (*
__±r
Ë
__THROW
;

490 #i‡
deföed
 
__USE_GNU
 || deföed 
__USE_BSD
 || deföed 
__USE_MISC


491 
	~<Æloˇ.h
>

494 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

495 || 
deföed
 
__USE_BSD


497 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

500 #ifde‡
__USE_XOPEN2K


502 
	$posix_memÆign
 (**
__mem±r
, 
size_t
 
__Æignmít
, size_à
__size
)

503 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

506 #ifde‡
__USE_ISOC11


508 *
	$Æig√d_Æloc
 (
size_t
 
__Æignmít
, size_à
__size
)

509 
__THROW
 
__wur
 
	`__©åibuã__
 ((
__mÆloc__
, 
	`__Æloc_size__
 (2)));

512 
__BEGIN_NAMESPACE_STD


514 
	$ab‹t
 (Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

518 
	`©exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

520 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


522 #ifde‡
__˝lu•lus


523 "C++" 
	`©_quick_exô
 ((*
__func
) ())

524 
__THROW
 
	`__asm
 ("©_quick_exô"Ë
	`__n⁄nuŒ
 ((1));

526 
	`©_quick_exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

529 
__END_NAMESPACE_STD


531 #ifdef 
__USE_MISC


534 
	`⁄_exô
 ((*
__func
Ë(
__°©us
, *
__¨g
), *__arg)

535 
__THROW
 
	`__n⁄nuŒ
 ((1));

538 
__BEGIN_NAMESPACE_STD


542 
	$exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

544 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


548 
	$quick_exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

550 
__END_NAMESPACE_STD


552 #ifde‡
__USE_ISOC99


553 
__BEGIN_NAMESPACE_C99


556 
	$_Exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

557 
__END_NAMESPACE_C99


561 
__BEGIN_NAMESPACE_STD


563 *
	$gëív
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

564 
__END_NAMESPACE_STD


566 #ifde‡
__USE_GNU


569 *
	$£cuª_gëív
 (c⁄° *
__«me
)

570 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

573 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


577 
	$puãnv
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

580 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


583 
	$£ãnv
 (c⁄° *
__«me
, c⁄° *
__vÆue
, 
__ª∂a˚
)

584 
__THROW
 
	`__n⁄nuŒ
 ((2));

587 
	$un£ãnv
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

590 #ifdef 
__USE_MISC


594 
	$˛óªnv
 (Ë
__THROW
;

598 #i‡
deföed
 
__USE_MISC
 \

599 || (
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
)

605 *
	$mkãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

608 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 \

609 || 
deföed
 
__USE_XOPEN2K8


618 #i‚de‡
__USE_FILE_OFFSET64


619 
	$mk°emp
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

621 #ifde‡
__REDIRECT


622 
	`__REDIRECT
 (
mk°emp
, (*
__ãm∂©e
), 
mk°emp64
)

623 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

625 
	#mk°emp
 
mk°emp64


	)

628 #ifde‡
__USE_LARGEFILE64


629 
	$mk°emp64
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

633 #ifde‡
__USE_MISC


640 #i‚de‡
__USE_FILE_OFFSET64


641 
	$mk°emps
 (*
__ãm∂©e
, 
__suffixÀn
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

643 #ifde‡
__REDIRECT


644 
	`__REDIRECT
 (
mk°emps
, (*
__ãm∂©e
, 
__suffixÀn
),

645 
mk°emps64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

647 
	#mk°emps
 
mk°emps64


	)

650 #ifde‡
__USE_LARGEFILE64


651 
	$mk°emps64
 (*
__ãm∂©e
, 
__suffixÀn
)

652 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

656 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K8


662 *
	$mkdãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

665 #ifde‡
__USE_GNU


672 #i‚de‡
__USE_FILE_OFFSET64


673 
	$mko°emp
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

675 #ifde‡
__REDIRECT


676 
	`__REDIRECT
 (
mko°emp
, (*
__ãm∂©e
, 
__Êags
), 
mko°emp64
)

677 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

679 
	#mko°emp
 
mko°emp64


	)

682 #ifde‡
__USE_LARGEFILE64


683 
	$mko°emp64
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

692 #i‚de‡
__USE_FILE_OFFSET64


693 
	$mko°emps
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

694 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

696 #ifde‡
__REDIRECT


697 
	`__REDIRECT
 (
mko°emps
, (*
__ãm∂©e
, 
__suffixÀn
,

698 
__Êags
), 
mko°emps64
)

699 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

701 
	#mko°emps
 
mko°emps64


	)

704 #ifde‡
__USE_LARGEFILE64


705 
	$mko°emps64
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

706 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

711 
__BEGIN_NAMESPACE_STD


716 
	$sy°em
 (c⁄° *
__comm™d
Ë
__wur
;

717 
__END_NAMESPACE_STD


720 #ifdef 
__USE_GNU


723 *
	$ˇn⁄iˇlize_fûe_«me
 (c⁄° *
__«me
)

724 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

727 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


733 *
	$ªÆ∑th
 (c⁄° *
__ª°ri˘
 
__«me
,

734 *
__ª°ri˘
 
__ªsﬁved
Ë
__THROW
 
__wur
;

739 #i‚de‡
__COMPAR_FN_T


740 
	#__COMPAR_FN_T


	)

741 (*
	t__com∑r_‚_t
) (const *, const *);

743 #ifdef 
__USE_GNU


744 
__com∑r_‚_t
 
	tcom∑ris⁄_‚_t
;

747 #ifde‡
__USE_GNU


748 (*
	t__com∑r_d_‚_t
) (const *, const *, *);

751 
__BEGIN_NAMESPACE_STD


754 *
	$b£¨ch
 (c⁄° *
__key
, c⁄° *
__ba£
,

755 
size_t
 
__nmemb
, size_à
__size
, 
__com∑r_‚_t
 
__com∑r
)

756 
	`__n⁄nuŒ
 ((1, 2, 5)Ë
__wur
;

760 
	$qs‹t
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

761 
__com∑r_‚_t
 
__com∑r
Ë
	`__n⁄nuŒ
 ((1, 4));

762 #ifde‡
__USE_GNU


763 
	$qs‹t_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

764 
__com∑r_d_‚_t
 
__com∑r
, *
__¨g
)

765 
	`__n⁄nuŒ
 ((1, 4));

770 
	$abs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

771 
	$œbs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

772 
__END_NAMESPACE_STD


774 #ifde‡
__USE_ISOC99


775 
__exãnsi⁄__
 
	$Œabs
 (
__x
)

776 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

780 
__BEGIN_NAMESPACE_STD


784 
div_t
 
	$div
 (
__numî
, 
__díom
)

785 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

786 
ldiv_t
 
	$ldiv
 (
__numî
, 
__díom
)

787 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

788 
__END_NAMESPACE_STD


790 #ifde‡
__USE_ISOC99


791 
__BEGIN_NAMESPACE_C99


792 
__exãnsi⁄__
 
Œdiv_t
 
	$Œdiv
 (
__numî
,

793 
__díom
)

794 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

795 
__END_NAMESPACE_C99


799 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

800 || 
deföed
 
__USE_SVID


807 *
	$ecvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

808 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

813 *
	$fcvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

814 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

819 *
	$gcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

820 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

823 #ifde‡
__USE_MISC


825 *
	$qecvt
 (
__vÆue
, 
__ndigô
,

826 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

827 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

828 *
	$qfcvt
 (
__vÆue
, 
__ndigô
,

829 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

830 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

831 *
	$qgcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

832 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

837 
	$ecvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

838 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

839 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

840 
	$fcvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

841 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

842 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

844 
	$qecvt_r
 (
__vÆue
, 
__ndigô
,

845 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

846 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

847 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

848 
	$qfcvt_r
 (
__vÆue
, 
__ndigô
,

849 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

850 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

851 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

856 
__BEGIN_NAMESPACE_STD


859 
	$mbÀn
 (c⁄° *
__s
, 
size_t
 
__n
Ë
__THROW
 
__wur
;

862 
	$mbtowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

863 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
 
__wur
;

866 
	$w˘omb
 (*
__s
, 
wch¨_t
 
__wch¨
Ë
__THROW
 
__wur
;

870 
size_t
 
	$mb°owcs
 (
wch¨_t
 *
__ª°ri˘
 
__pwcs
,

871 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

873 
size_t
 
	$wc°ombs
 (*
__ª°ri˘
 
__s
,

874 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__pwcs
, 
size_t
 
__n
)

875 
__THROW
;

876 
__END_NAMESPACE_STD


879 #ifde‡
__USE_SVID


884 
	$Ωm©ch
 (c⁄° *
__ª•⁄£
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

888 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


895 
	$gësub›t
 (**
__ª°ri˘
 
__›ti⁄p
,

896 *c⁄° *
__ª°ri˘
 
__tokís
,

897 **
__ª°ri˘
 
__vÆuï
)

898 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3)Ë
__wur
;

902 #ifde‡
__USE_XOPEN


904 
	$£tkey
 (c⁄° *
__key
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

910 #ifde‡
__USE_XOPEN2KXSI


912 
	$posix_›í±
 (
__oÊag
Ë
__wur
;

915 #ifde‡
__USE_XOPEN


920 
	$gø¡±
 (
__fd
Ë
__THROW
;

924 
	$u∆ock±
 (
__fd
Ë
__THROW
;

929 *
	$±¢ame
 (
__fd
Ë
__THROW
 
__wur
;

932 #ifde‡
__USE_GNU


936 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

937 
__THROW
 
	`__n⁄nuŒ
 ((2));

940 
	`gë±
 ();

943 #ifde‡
__USE_BSD


947 
	$gëlﬂdavg
 (
__lﬂdavg
[], 
__√Àm
)

948 
__THROW
 
	`__n⁄nuŒ
 ((1));

951 
	~<bôs/°dlib-Êﬂt.h
>

954 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


955 
	~<bôs/°dlib.h
>

957 #ifde‡
__LDBL_COMPAT


958 
	~<bôs/°dlib-ldbl.h
>

962 #unde‡
__√ed_mÆloc_™d_ˇŒoc


964 
__END_DECLS


	@/usr/include/string.h

22 #i‚def 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


30 
	#__√ed_size_t


	)

31 
	#__√ed_NULL


	)

32 
	~<°ddef.h
>

35 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

36 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

40 
__BEGIN_NAMESPACE_STD


42 *
	$mem˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

43 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

46 *
	$memmove
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

47 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

48 
__END_NAMESPACE_STD


53 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN


54 *
	$memc˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

55 
__c
, 
size_t
 
__n
)

56 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

60 
__BEGIN_NAMESPACE_STD


62 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

65 
	$memcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

66 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

69 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


72 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

73 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

74 c⁄° *
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

75 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

77 #ifde‡
__OPTIMIZE__


78 
__exã∫_Æways_ölöe
 *

79 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


81  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

84 
__exã∫_Æways_ölöe
 const *

85 
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


87  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

90 
	}
}

92 *
	$memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

93 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

95 
__END_NAMESPACE_STD


97 #ifde‡
__USE_GNU


100 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


101 "C++" *
	$øwmemchr
 (*
__s
, 
__c
)

102 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

103 "C++" c⁄° *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

104 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

106 *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

107 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

111 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


112 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

113 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

114 "C++" c⁄° *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

115 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

117 *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

118 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

123 
__BEGIN_NAMESPACE_STD


125 *
	$°r˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

126 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

128 *
	$°∫˝y
 (*
__ª°ri˘
 
__de°
,

129 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

130 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

133 *
	$°rˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

134 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

136 *
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

137 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

140 
	$°rcmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

141 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

143 
	$°∫cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

144 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

147 
	$°rcﬁl
 (c⁄° *
__s1
, c⁄° *
__s2
)

148 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

150 
size_t
 
	$°rx‰m
 (*
__ª°ri˘
 
__de°
,

151 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

152 
__THROW
 
	`__n⁄nuŒ
 ((2));

153 
__END_NAMESPACE_STD


155 #ifde‡
__USE_XOPEN2K8


159 
	~<xloˇÀ.h
>

162 
	$°rcﬁl_l
 (c⁄° *
__s1
, c⁄° *
__s2
, 
__loˇÀ_t
 
__l
)

163 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

165 
size_t
 
	$°rx‰m_l
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
,

166 
__loˇÀ_t
 
__l
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

169 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 \

170 || 
deföed
 
__USE_XOPEN2K8


172 *
	$°rdup
 (c⁄° *
__s
)

173 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

179 #i‡
deföed
 
__USE_XOPEN2K8


180 *
	$°∫dup
 (c⁄° *
__°rög
, 
size_t
 
__n
)

181 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

184 #i‡
deföed
 
__USE_GNU
 && deföed 
__GNUC__


186 
	#°rdu∑
(
s
) \

187 (
__exãnsi⁄__
 \

189 c⁄° *
__ﬁd
 = (
s
); \

190 
size_t
 
__Àn
 = 
	`°æí
 (
__ﬁd
) + 1; \

191 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
); \

192 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

193 
	}
}))

	)

196 
	#°∫du∑
(
s
, 
n
) \

197 (
__exãnsi⁄__
 \

199 c⁄° *
__ﬁd
 = (
s
); \

200 
size_t
 
__Àn
 = 
	`°∫Àn
 (
__ﬁd
, (
n
)); \

201 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
 + 1); \

202 
__√w
[
__Àn
] = '\0'; \

203 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

204 }))

	)

207 
	g__BEGIN_NAMESPACE_STD


209 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


212 *
°rchr
 (*
__s
, 
__c
)

213 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

214 c⁄° *
°rchr
 (c⁄° *
__s
, 
__c
)

215 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

217 #ifde‡
__OPTIMIZE__


218 
__exã∫_Æways_ölöe
 *

219 
°rchr
 (*
__s
, 
__c
Ë
	g__THROW


221  
__buûtö_°rchr
 (
__s
, 
__c
);

224 
__exã∫_Æways_ölöe
 const *

225 
°rchr
 (c⁄° *
__s
, 
__c
Ë
	g__THROW


227  
__buûtö_°rchr
 (
__s
, 
__c
);

232 *
	$°rchr
 (c⁄° *
__s
, 
__c
)

233 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

236 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


239 *
	`°ºchr
 (*
__s
, 
__c
)

240 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

241 c⁄° *
	`°ºchr
 (c⁄° *
__s
, 
__c
)

242 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

244 #ifde‡
__OPTIMIZE__


245 
__exã∫_Æways_ölöe
 *

246 
	`°ºchr
 (*
__s
, 
__c
Ë
__THROW


248  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

251 
__exã∫_Æways_ölöe
 const *

252 
	`°ºchr
 (c⁄° *
__s
, 
__c
Ë
__THROW


254  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

257 
	}
}

259 *
	$°ºchr
 (c⁄° *
__s
, 
__c
)

260 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

262 
__END_NAMESPACE_STD


264 #ifde‡
__USE_GNU


267 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


268 "C++" *
	$°rch∫ul
 (*
__s
, 
__c
)

269 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

270 "C++" c⁄° *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

271 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

273 *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

274 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

278 
__BEGIN_NAMESPACE_STD


281 
size_t
 
	$°rc•n
 (c⁄° *
__s
, c⁄° *
__ªje˘
)

282 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

285 
size_t
 
	$°r•n
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

286 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

288 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


291 *
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
)

292 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

293 c⁄° *
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

294 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

296 #ifde‡
__OPTIMIZE__


297 
__exã∫_Æways_ölöe
 *

298 
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
Ë
__THROW


300  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

303 
__exã∫_Æways_ölöe
 const *

304 
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
Ë
__THROW


306  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

309 
	}
}

311 *
	$°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

312 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

315 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


318 *
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

319 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

320 c⁄° *
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

321 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

323 #ifde‡
__OPTIMIZE__


324 
__exã∫_Æways_ölöe
 *

325 
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


327  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

330 
__exã∫_Æways_ölöe
 const *

331 
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


333  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

336 
	}
}

338 *
	$°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

339 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

344 *
	$°πok
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
)

345 
__THROW
 
	`__n⁄nuŒ
 ((2));

346 
__END_NAMESPACE_STD


350 *
	$__°πok_r
 (*
__ª°ri˘
 
__s
,

351 c⁄° *
__ª°ri˘
 
__dñim
,

352 **
__ª°ri˘
 
__ßve_±r
)

353 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

354 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


355 *
	$°πok_r
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
,

356 **
__ª°ri˘
 
__ßve_±r
)

357 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

360 #ifde‡
__USE_GNU


362 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


363 "C++" *
	$°rˇ£°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

364 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

365 "C++" c⁄° *
	$°rˇ£°r
 (c⁄° *
__hay°ack
,

366 c⁄° *
__√edÀ
)

367 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

369 *
	$°rˇ£°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

370 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

374 #ifde‡
__USE_GNU


378 *
	$memmem
 (c⁄° *
__hay°ack
, 
size_t
 
__hay°ackÀn
,

379 c⁄° *
__√edÀ
, 
size_t
 
__√edÀÀn
)

380 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 3));

384 *
	$__memp˝y
 (*
__ª°ri˘
 
__de°
,

385 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

386 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

387 *
	$memp˝y
 (*
__ª°ri˘
 
__de°
,

388 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

389 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

393 
__BEGIN_NAMESPACE_STD


395 
size_t
 
	$°æí
 (c⁄° *
__s
)

396 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

397 
__END_NAMESPACE_STD


399 #ifdef 
__USE_XOPEN2K8


402 
size_t
 
	$°∫Àn
 (c⁄° *
__°rög
, 
size_t
 
__maxÀn
)

403 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

407 
__BEGIN_NAMESPACE_STD


409 *
	$°ªº‹
 (
__î∫um
Ë
__THROW
;

410 
__END_NAMESPACE_STD


411 #i‡
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_MISC


419 #i‡
deföed
 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


422 #ifde‡
__REDIRECT_NTH


423 
	`__REDIRECT_NTH
 (
°ªº‹_r
,

424 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
),

425 
__xpg_°ªº‹_r
Ë
	`__n⁄nuŒ
 ((2));

427 
	$__xpg_°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

428 
__THROW
 
	`__n⁄nuŒ
 ((2));

429 
	#°ªº‹_r
 
__xpg_°ªº‹_r


	)

434 *
	$°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

435 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

439 #ifde‡
__USE_XOPEN2K8


441 *
	$°ªº‹_l
 (
__î∫um
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

447 
	$__bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

449 #ifde‡
__USE_BSD


451 
	$bc›y
 (c⁄° *
__§c
, *
__de°
, 
size_t
 
__n
)

452 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

455 
	$bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

458 
	$bcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

459 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

462 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


465 *
	`ödex
 (*
__s
, 
__c
)

466 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

467 c⁄° *
	`ödex
 (c⁄° *
__s
, 
__c
)

468 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

470 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


471 
__exã∫_Æways_ölöe
 *

472 
	`ödex
 (*
__s
, 
__c
Ë
__THROW


474  
	`__buûtö_ödex
 (
__s
, 
__c
);

477 
__exã∫_Æways_ölöe
 const *

478 
	`ödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


480  
	`__buûtö_ödex
 (
__s
, 
__c
);

483 
	}
}

485 *
	$ödex
 (c⁄° *
__s
, 
__c
)

486 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

490 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


493 *
	`rödex
 (*
__s
, 
__c
)

494 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

495 c⁄° *
	`rödex
 (c⁄° *
__s
, 
__c
)

496 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

498 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


499 
__exã∫_Æways_ölöe
 *

500 
	`rödex
 (*
__s
, 
__c
Ë
__THROW


502  
	`__buûtö_rödex
 (
__s
, 
__c
);

505 
__exã∫_Æways_ölöe
 const *

506 
	`rödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


508  
	`__buûtö_rödex
 (
__s
, 
__c
);

511 
	}
}

513 *
	$rödex
 (c⁄° *
__s
, 
__c
)

514 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

519 
	$ffs
 (
__i
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

523 #ifdef 
__USE_GNU


524 
	$ff¶
 (
__l
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

525 #ifde‡
__GNUC__


526 
__exãnsi⁄__
 
	$ff¶l
 (
__Œ
)

527 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

532 
	$°rˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

533 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

536 
	$°∫ˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

537 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

540 #ifdef 
__USE_GNU


543 
	$°rˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

544 
__loˇÀ_t
 
__loc
)

545 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

547 
	$°∫ˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

548 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
)

549 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 4));

552 #ifdef 
__USE_BSD


555 *
	$°r£p
 (**
__ª°ri˘
 
__°rögp
,

556 c⁄° *
__ª°ri˘
 
__dñim
)

557 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

560 #ifdef 
__USE_XOPEN2K8


562 *
	$°rsig«l
 (
__sig
Ë
__THROW
;

565 *
	$__°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

566 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

567 *
	$°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

568 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

572 *
	$__°≤˝y
 (*
__ª°ri˘
 
__de°
,

573 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

574 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

575 *
	$°≤˝y
 (*
__ª°ri˘
 
__de°
,

576 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

577 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

580 #ifdef 
__USE_GNU


582 
	$°rvîscmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

583 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

586 *
	$°r‰y
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

589 *
	$mem‰ob
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

591 #i‚de‡
ba£«me


596 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


597 "C++" *
	$ba£«me
 (*
__fûíame
)

598 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

599 "C++" c⁄° *
	$ba£«me
 (c⁄° *
__fûíame
)

600 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

602 *
	$ba£«me
 (c⁄° *
__fûíame
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

608 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

609 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__OPTIMIZE_SIZE__
 \

610 && !
deföed
 
__NO_INLINE__
 && !deföed 
__˝lu•lus


630 
	~<bôs/°rög.h
>

633 
	~<bôs/°rög2.h
>

636 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


638 
	~<bôs/°rög3.h
>

642 
__END_DECLS


	@/usr/include/syslog.h

1 
	~<sys/sy¶og.h
>

	@/usr/include/time.h

22 #i‚def 
_TIME_H


24 #i‡(! 
deföed
 
__√ed_time_t
 && !deföed 
__√ed_˛ock_t
 && \

25 ! 
deföed
 
	g__√ed_time•ec
)

26 
	#_TIME_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


33 #ifdef 
_TIME_H


35 
	#__√ed_size_t


	)

36 
	#__√ed_NULL


	)

37 
	~<°ddef.h
>

41 
	~<bôs/time.h
>

44 #i‡!
deföed
 
__STRICT_ANSI__
 && !deföed 
__USE_XOPEN2K


45 #i‚de‡
CLK_TCK


46 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

52 #i‡!
deföed
 
__˛ock_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_˛ock_t
)

53 
	#__˛ock_t_deföed
 1

	)

55 
	~<bôs/ty≥s.h
>

57 
__BEGIN_NAMESPACE_STD


59 
__˛ock_t
 
	t˛ock_t
;

60 
	g__END_NAMESPACE_STD


61 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


62 
	$__USING_NAMESPACE_STD
(
˛ock_t
)

66 #unde‡
__√ed_˛ock_t


68 #i‡!
deföed
 
__time_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_time_t
)

69 
	#__time_t_deföed
 1

	)

71 
	~<bôs/ty≥s.h
>

73 
__BEGIN_NAMESPACE_STD


75 
__time_t
 
	ttime_t
;

76 
__END_NAMESPACE_STD


77 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC
 || deföed 
__USE_SVID


78 
	$__USING_NAMESPACE_STD
(
time_t
)

82 #unde‡
__√ed_time_t


84 #i‡!
deföed
 
__˛ockid_t_deföed
 && \

85 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_˛ockid_t
)

86 
	#__˛ockid_t_deföed
 1

	)

88 
	~<bôs/ty≥s.h
>

91 
__˛ockid_t
 
	t˛ockid_t
;

94 #unde‡
__˛ockid_time_t


96 #i‡!
deföed
 
__timî_t_deföed
 && \

97 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_timî_t
)

98 
	#__timî_t_deföed
 1

	)

100 
	~<bôs/ty≥s.h
>

103 
__timî_t
 
	ttimî_t
;

106 #unde‡
__√ed_timî_t


109 #i‡(!
deföed
 
__time•ec_deföed
 \

110 && ((
deföed
 
_TIME_H
 \

111 && (
deföed
 
__USE_POSIX199309
 || deföed 
__USE_MISC
 \

112 || 
deföed
 
__USE_ISOC11
)) \

113 || 
deföed
 
__√ed_time•ec
))

114 
	#__time•ec_deföed
 1

	)

116 
	~<bôs/ty≥s.h
>

120 
	stime•ec


122 
__time_t
 
tv_£c
;

123 
__sysˇŒ_¶⁄g_t
 
tv_n£c
;

127 #unde‡
__√ed_time•ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mö
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_m⁄
;

140 
tm_yór
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd°
;

145 #ifdef 
__USE_BSD


146 
tm_gmtoff
;

147 c⁄° *
tm_z⁄e
;

149 
__tm_gmtoff
;

150 c⁄° *
__tm_z⁄e
;

153 
__END_NAMESPACE_STD


154 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifde‡
__USE_POSIX199309


161 
	sôimî•ec


163 
time•ec
 
ô_öãrvÆ
;

164 
time•ec
 
ô_vÆue
;

168 
sigevít
;

172 #ifde‡
__USE_XOPEN2K


173 #i‚de‡
__pid_t_deföed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_deföed


	)

180 #ifde‡
__USE_ISOC11


182 
	#TIME_UTC
 1

	)

186 
__BEGIN_NAMESPACE_STD


189 
˛ock_t
 
	$˛ock
 (Ë
__THROW
;

192 
time_t
 
	$time
 (
time_t
 *
__timî
Ë
__THROW
;

195 
	$dif·ime
 (
time_t
 
__time1
,Åime_à
__time0
)

196 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

199 
time_t
 
	$mktime
 (
tm
 *
__ç
Ë
__THROW
;

205 
size_t
 
	$°r·ime
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

206 c⁄° *
__ª°ri˘
 
__f‹m©
,

207 c⁄° 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

208 
__END_NAMESPACE_STD


210 #ifde‡
__USE_XOPEN


213 *
	$°Ωtime
 (c⁄° *
__ª°ri˘
 
__s
,

214 c⁄° *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
)

215 
__THROW
;

218 #ifde‡
__USE_XOPEN2K8


221 
	~<xloˇÀ.h
>

223 
size_t
 
	$°r·ime_l
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

224 c⁄° *
__ª°ri˘
 
__f‹m©
,

225 c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

226 
__loˇÀ_t
 
__loc
Ë
__THROW
;

229 #ifde‡
__USE_GNU


230 *
	$°Ωtime_l
 (c⁄° *
__ª°ri˘
 
__s
,

231 c⁄° *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
,

232 
__loˇÀ_t
 
__loc
Ë
__THROW
;

236 
__BEGIN_NAMESPACE_STD


239 
tm
 *
	$gmtime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

243 
tm
 *
	$loˇ…ime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

244 
__END_NAMESPACE_STD


246 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


249 
tm
 *
	$gmtime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

250 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

254 
tm
 *
	$loˇ…ime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

255 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

258 
__BEGIN_NAMESPACE_STD


261 *
	$as˘ime
 (c⁄° 
tm
 *
__ç
Ë
__THROW
;

264 *
	$˘ime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

265 
__END_NAMESPACE_STD


267 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


272 *
	$as˘ime_r
 (c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

273 *
__ª°ri˘
 
__buf
Ë
__THROW
;

276 *
	$˘ime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

277 *
__ª°ri˘
 
__buf
Ë
__THROW
;

282 *
__tz«me
[2];

283 
__daylight
;

284 
__timez⁄e
;

287 #ifdef 
__USE_POSIX


289 *
tz«me
[2];

293 
	$tz£t
 (Ë
__THROW
;

296 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


297 
daylight
;

298 
timez⁄e
;

301 #ifde‡
__USE_SVID


304 
	$°ime
 (c⁄° 
time_t
 *
__whí
Ë
__THROW
;

310 
	#__i¶óp
(
yór
) \

311 ((
yór
Ë% 4 =0 && ((yórË% 100 !0 || (yórË% 400 =0))

	)

314 #ifde‡
__USE_MISC


319 
time_t
 
	$timegm
 (
tm
 *
__ç
Ë
__THROW
;

322 
time_t
 
	$timñoˇl
 (
tm
 *
__ç
Ë
__THROW
;

325 
	$dysize
 (
__yór
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

329 #ifde‡
__USE_POSIX199309


334 
	`«no¶ìp
 (c⁄° 
time•ec
 *
__ªque°ed_time
,

335 
time•ec
 *
__ªmaöög
);

339 
	$˛ock_gëªs
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ªs
Ë
__THROW
;

342 
	$˛ock_gëtime
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ç
Ë
__THROW
;

345 
	$˛ock_£âime
 (
˛ockid_t
 
__˛ock_id
, c⁄° 
time•ec
 *
__ç
)

346 
__THROW
;

348 #ifde‡
__USE_XOPEN2K


353 
	`˛ock_«no¶ìp
 (
˛ockid_t
 
__˛ock_id
, 
__Êags
,

354 c⁄° 
time•ec
 *
__ªq
,

355 
time•ec
 *
__ªm
);

358 
	$˛ock_gë˝u˛ockid
 (
pid_t
 
__pid
, 
˛ockid_t
 *
__˛ock_id
Ë
__THROW
;

363 
	$timî_¸óã
 (
˛ockid_t
 
__˛ock_id
,

364 
sigevít
 *
__ª°ri˘
 
__evp
,

365 
timî_t
 *
__ª°ri˘
 
__timîid
Ë
__THROW
;

368 
	$timî_dñëe
 (
timî_t
 
__timîid
Ë
__THROW
;

371 
	$timî_£âime
 (
timî_t
 
__timîid
, 
__Êags
,

372 c⁄° 
ôimî•ec
 *
__ª°ri˘
 
__vÆue
,

373 
ôimî•ec
 *
__ª°ri˘
 
__ovÆue
Ë
__THROW
;

376 
	$timî_gëtime
 (
timî_t
 
__timîid
, 
ôimî•ec
 *
__vÆue
)

377 
__THROW
;

380 
	$timî_gëovîrun
 (
timî_t
 
__timîid
Ë
__THROW
;

384 #ifde‡
__USE_ISOC11


386 
	$time•ec_gë
 (
time•ec
 *
__ts
, 
__ba£
)

387 
__THROW
 
	`__n⁄nuŒ
 ((1));

391 #ifde‡
__USE_XOPEN_EXTENDED


403 
gëd©e_îr
;

412 
tm
 *
	`gëd©e
 (c⁄° *
__°rög
);

415 #ifde‡
__USE_GNU


426 
	`gëd©e_r
 (c⁄° *
__ª°ri˘
 
__°rög
,

427 
tm
 *
__ª°ri˘
 
__ªsbuÂ
);

430 
__END_DECLS


	@/usr/include/unistd.h

22 #i‚def 
_UNISTD_H


23 
	#_UNISTD_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


32 #ifde‡
__USE_XOPEN2K8


34 
	#_POSIX_VERSION
 200809L

	)

35 #ñi‡
deföed
 
__USE_XOPEN2K


37 
	#_POSIX_VERSION
 200112L

	)

38 #ñi‡
deföed
 
__USE_POSIX199506


40 
	#_POSIX_VERSION
 199506L

	)

41 #ñi‡
deföed
 
__USE_POSIX199309


43 
	#_POSIX_VERSION
 199309L

	)

46 
	#_POSIX_VERSION
 199009L

	)

52 #ifde‡
__USE_XOPEN2K8


53 
	#__POSIX2_THIS_VERSION
 200809L

	)

55 #ñi‡
deföed
 
__USE_XOPEN2K


57 
	#__POSIX2_THIS_VERSION
 200112L

	)

58 #ñi‡
deföed
 
__USE_POSIX199506


60 
	#__POSIX2_THIS_VERSION
 199506L

	)

63 
	#__POSIX2_THIS_VERSION
 199209L

	)

67 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

71 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

75 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

79 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

83 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

86 #ifde‡
__USE_XOPEN2K8


87 
	#_XOPEN_VERSION
 700

	)

88 #ñi‡
deföed
 
__USE_XOPEN2K


89 
	#_XOPEN_VERSION
 600

	)

90 #ñi‡
deföed
 
__USE_UNIX98


91 
	#_XOPEN_VERSION
 500

	)

93 
	#_XOPEN_VERSION
 4

	)

97 
	#_XOPEN_XCU_VERSION
 4

	)

100 
	#_XOPEN_XPG2
 1

	)

101 
	#_XOPEN_XPG3
 1

	)

102 
	#_XOPEN_XPG4
 1

	)

105 
	#_XOPEN_UNIX
 1

	)

108 
	#_XOPEN_CRYPT
 1

	)

112 
	#_XOPEN_ENH_I18N
 1

	)

115 
	#_XOPEN_LEGACY
 1

	)

202 
	~<bôs/posix_›t.h
>

205 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


206 
	~<bôs/ívú⁄míts.h
>

210 
	#STDIN_FILENO
 0

	)

211 
	#STDOUT_FILENO
 1

	)

212 
	#STDERR_FILENO
 2

	)

217 
	~<bôs/ty≥s.h
>

219 #i‚def 
__ssize_t_deföed


220 
__ssize_t
 
	tssize_t
;

221 
	#__ssize_t_deföed


	)

224 
	#__√ed_size_t


	)

225 
	#__√ed_NULL


	)

226 
	~<°ddef.h
>

228 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


231 #i‚de‡
__gid_t_deföed


232 
__gid_t
 
	tgid_t
;

233 
	#__gid_t_deföed


	)

236 #i‚de‡
__uid_t_deföed


237 
__uid_t
 
	tuid_t
;

238 
	#__uid_t_deföed


	)

241 #i‚de‡
__off_t_deföed


242 #i‚de‡
__USE_FILE_OFFSET64


243 
__off_t
 
	toff_t
;

245 
__off64_t
 
	toff_t
;

247 
	#__off_t_deföed


	)

249 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


250 
__off64_t
 
	toff64_t
;

251 
	#__off64_t_deföed


	)

254 #i‚de‡
__u£c⁄ds_t_deföed


255 
__u£c⁄ds_t
 
	tu£c⁄ds_t
;

256 
	#__u£c⁄ds_t_deföed


	)

259 #i‚de‡
__pid_t_deföed


260 
__pid_t
 
	tpid_t
;

261 
	#__pid_t_deföed


	)

265 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


266 #i‚de‡
__öçå_t_deföed


267 
__öçå_t
 
	töçå_t
;

268 
	#__öçå_t_deföed


	)

272 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN


273 #i‚de‡
__sockÀn_t_deföed


274 
__sockÀn_t
 
	tsockÀn_t
;

275 
	#__sockÀn_t_deföed


	)

281 
	#R_OK
 4

	)

282 
	#W_OK
 2

	)

283 
	#X_OK
 1

	)

284 
	#F_OK
 0

	)

287 
	$ac˚ss
 (c⁄° *
__«me
, 
__ty≥
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

289 #ifde‡
__USE_GNU


292 
	$euidac˚ss
 (c⁄° *
__«me
, 
__ty≥
)

293 
__THROW
 
	`__n⁄nuŒ
 ((1));

296 
	$óc˚ss
 (c⁄° *
__«me
, 
__ty≥
)

297 
__THROW
 
	`__n⁄nuŒ
 ((1));

300 #ifde‡
__USE_ATFILE


304 
	$Ác˚sßt
 (
__fd
, c⁄° *
__fûe
, 
__ty≥
, 
__Êag
)

305 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

310 #i‚def 
_STDIO_H


311 
	#SEEK_SET
 0

	)

312 
	#SEEK_CUR
 1

	)

313 
	#SEEK_END
 2

	)

314 #ifde‡
__USE_GNU


315 
	#SEEK_DATA
 3

	)

316 
	#SEEK_HOLE
 4

	)

320 #i‡
deföed
 
__USE_BSD
 && !deföed 
L_SET


322 
	#L_SET
 
SEEK_SET


	)

323 
	#L_INCR
 
SEEK_CUR


	)

324 
	#L_XTND
 
SEEK_END


	)

333 #i‚de‡
__USE_FILE_OFFSET64


334 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__whí˚
Ë
__THROW
;

336 #ifde‡
__REDIRECT_NTH


337 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

338 (
__fd
, 
__off64_t
 
__off£t
, 
__whí˚
),

339 
l£ek64
);

341 
	#l£ek
 
l£ek64


	)

344 #ifde‡
__USE_LARGEFILE64


345 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__whí˚
)

346 
__THROW
;

353 
	`˛o£
 (
__fd
);

360 
ssize_t
 
	$ªad
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
Ë
__wur
;

366 
ssize_t
 
	$wrôe
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
Ë
__wur
;

368 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


369 #i‚de‡
__USE_FILE_OFFSET64


376 
ssize_t
 
	$¥ód
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

377 
__off_t
 
__off£t
Ë
__wur
;

384 
ssize_t
 
	$pwrôe
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
,

385 
__off_t
 
__off£t
Ë
__wur
;

387 #ifde‡
__REDIRECT


388 
ssize_t
 
	`__REDIRECT
 (
¥ód
, (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

389 
__off64_t
 
__off£t
),

390 
¥ód64
Ë
__wur
;

391 
ssize_t
 
	`__REDIRECT
 (
pwrôe
, (
__fd
, c⁄° *
__buf
,

392 
size_t
 
__nbyãs
, 
__off64_t
 
__off£t
),

393 
pwrôe64
Ë
__wur
;

395 
	#¥ód
 
¥ód64


	)

396 
	#pwrôe
 
pwrôe64


	)

400 #ifde‡
__USE_LARGEFILE64


404 
ssize_t
 
	$¥ód64
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

405 
__off64_t
 
__off£t
Ë
__wur
;

408 
ssize_t
 
	$pwrôe64
 (
__fd
, c⁄° *
__buf
, 
size_t
 
__n
,

409 
__off64_t
 
__off£t
Ë
__wur
;

417 
	$pùe
 (
__pùedes
[2]Ë
__THROW
 
__wur
;

419 #ifde‡
__USE_GNU


422 
	$pùe2
 (
__pùedes
[2], 
__Êags
Ë
__THROW
 
__wur
;

432 
	$Æ¨m
 (
__£c⁄ds
Ë
__THROW
;

444 
	`¶ìp
 (
__£c⁄ds
);

446 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

447 || 
deföed
 
__USE_BSD


452 
__u£c⁄ds_t
 
	$uÆ¨m
 (
__u£c⁄ds_t
 
__vÆue
, __u£c⁄ds_à
__öãrvÆ
)

453 
__THROW
;

460 
	`u¶ìp
 (
__u£c⁄ds_t
 
__u£c⁄ds
);

469 
	`∑u£
 ();

473 
	$chown
 (c⁄° *
__fûe
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
)

474 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

476 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


478 
	$fchown
 (
__fd
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
Ë
__THROW
 
__wur
;

483 
	$lchown
 (c⁄° *
__fûe
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
)

484 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

488 #ifde‡
__USE_ATFILE


491 
	$fchow«t
 (
__fd
, c⁄° *
__fûe
, 
__uid_t
 
__ow√r
,

492 
__gid_t
 
__group
, 
__Êag
)

493 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

497 
	$chdú
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

499 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


501 
	$fchdú
 (
__fd
Ë
__THROW
 
__wur
;

511 *
	$gëcwd
 (*
__buf
, 
size_t
 
__size
Ë
__THROW
 
__wur
;

513 #ifdef 
__USE_GNU


517 *
	$gë_cuºít_dú_«me
 (Ë
__THROW
;

520 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

521 || 
deföed
 
__USE_BSD


525 *
	$gëwd
 (*
__buf
)

526 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__©åibuã_dïªˇãd__
 
__wur
;

531 
	$dup
 (
__fd
Ë
__THROW
 
__wur
;

534 
	$dup2
 (
__fd
, 
__fd2
Ë
__THROW
;

536 #ifde‡
__USE_GNU


539 
	$dup3
 (
__fd
, 
__fd2
, 
__Êags
Ë
__THROW
;

543 **
__ívú⁄
;

544 #ifde‡
__USE_GNU


545 **
ívú⁄
;

551 
	$execve
 (c⁄° *
__∑th
, *c⁄° 
__¨gv
[],

552 *c⁄° 
__ívp
[]Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

554 #ifde‡
__USE_XOPEN2K8


557 
	$„xecve
 (
__fd
, *c⁄° 
__¨gv
[], *c⁄° 
__ívp
[])

558 
__THROW
 
	`__n⁄nuŒ
 ((2));

563 
	$execv
 (c⁄° *
__∑th
, *c⁄° 
__¨gv
[])

564 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

568 
	$exe˛e
 (c⁄° *
__∑th
, c⁄° *
__¨g
, ...)

569 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

573 
	$exe˛
 (c⁄° *
__∑th
, c⁄° *
__¨g
, ...)

574 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

578 
	$execvp
 (c⁄° *
__fûe
, *c⁄° 
__¨gv
[])

579 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

584 
	$exe˛p
 (c⁄° *
__fûe
, c⁄° *
__¨g
, ...)

585 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

587 #ifde‡
__USE_GNU


590 
	$execv≥
 (c⁄° *
__fûe
, *c⁄° 
__¨gv
[],

591 *c⁄° 
__ívp
[])

592 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

596 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


598 
	$ni˚
 (
__öc
Ë
__THROW
 
__wur
;

603 
	$_exô
 (
__°©us
Ë
	`__©åibuã__
 ((
__n‹ëu∫__
));

609 
	~<bôs/c⁄‚ame.h
>

612 
	$∑thc⁄f
 (c⁄° *
__∑th
, 
__«me
)

613 
__THROW
 
	`__n⁄nuŒ
 ((1));

616 
	$Â©hc⁄f
 (
__fd
, 
__«me
Ë
__THROW
;

619 
	$sysc⁄f
 (
__«me
Ë
__THROW
;

621 #ifdef 
__USE_POSIX2


623 
size_t
 
	$c⁄f°r
 (
__«me
, *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

628 
__pid_t
 
	$gëpid
 (Ë
__THROW
;

631 
__pid_t
 
	$gëµid
 (Ë
__THROW
;

635 #i‚de‡
__FAVOR_BSD


636 
__pid_t
 
	$gëpgΩ
 (Ë
__THROW
;

638 #ifde‡
__REDIRECT_NTH


639 
__pid_t
 
	`__REDIRECT_NTH
 (
gëpgΩ
, (__pid_à
__pid
), 
__gëpgid
);

641 
	#gëpgΩ
 
__gëpgid


	)

646 
__pid_t
 
	$__gëpgid
 (
__pid_t
 
__pid
Ë
__THROW
;

647 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


648 
__pid_t
 
	$gëpgid
 (
__pid_t
 
__pid
Ë
__THROW
;

655 
	$£çgid
 (
__pid_t
 
__pid
, __pid_à
__pgid
Ë
__THROW
;

657 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


668 #i‚de‡
__FAVOR_BSD


672 
	$£çgΩ
 (Ë
__THROW
;

677 #ifde‡
__REDIRECT_NTH


678 
	`__REDIRECT_NTH
 (
£çgΩ
, (
__pid_t
 
__pid
, __pid_à
__pgΩ
), 
£çgid
);

680 
	#£çgΩ
 
£çgid


	)

689 
__pid_t
 
	$£tsid
 (Ë
__THROW
;

691 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


693 
__pid_t
 
	$gësid
 (
__pid_t
 
__pid
Ë
__THROW
;

697 
__uid_t
 
	$gëuid
 (Ë
__THROW
;

700 
__uid_t
 
	$gëeuid
 (Ë
__THROW
;

703 
__gid_t
 
	$gëgid
 (Ë
__THROW
;

706 
__gid_t
 
	$gëegid
 (Ë
__THROW
;

711 
	$gëgroups
 (
__size
, 
__gid_t
 
__li°
[]Ë
__THROW
 
__wur
;

713 #ifdef 
__USE_GNU


715 
	$group_membî
 (
__gid_t
 
__gid
Ë
__THROW
;

722 
	$£tuid
 (
__uid_t
 
__uid
Ë
__THROW
 
__wur
;

724 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


727 
	$£åeuid
 (
__uid_t
 
__ruid
, __uid_à
__euid
Ë
__THROW
 
__wur
;

730 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


732 
	$£ãuid
 (
__uid_t
 
__uid
Ë
__THROW
 
__wur
;

739 
	$£tgid
 (
__gid_t
 
__gid
Ë
__THROW
 
__wur
;

741 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


744 
	$£åegid
 (
__gid_t
 
__rgid
, __gid_à
__egid
Ë
__THROW
 
__wur
;

747 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


749 
	$£ãgid
 (
__gid_t
 
__gid
Ë
__THROW
 
__wur
;

752 #ifde‡
__USE_GNU


755 
	$gëªsuid
 (
__uid_t
 *
__ruid
, __uid_à*
__euid
, __uid_à*
__suid
)

756 
__THROW
;

760 
	$gëªsgid
 (
__gid_t
 *
__rgid
, __gid_à*
__egid
, __gid_à*
__sgid
)

761 
__THROW
;

765 
	$£åesuid
 (
__uid_t
 
__ruid
, __uid_à
__euid
, __uid_à
__suid
)

766 
__THROW
 
__wur
;

770 
	$£åesgid
 (
__gid_t
 
__rgid
, __gid_à
__egid
, __gid_à
__sgid
)

771 
__THROW
 
__wur
;

778 
__pid_t
 
	$f‹k
 (Ë
__THROWNL
;

780 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

781 || 
deföed
 
__USE_BSD


786 
__pid_t
 
	$vf‹k
 (Ë
__THROW
;

792 *
	$ây«me
 (
__fd
Ë
__THROW
;

796 
	$ây«me_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

797 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

801 
	$ißây
 (
__fd
Ë
__THROW
;

803 #i‡
deföed
 
__USE_BSD
 \

804 || (
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_UNIX98
)

807 
	$ây¶Ÿ
 (Ë
__THROW
;

812 
	$lök
 (c⁄° *
__‰om
, c⁄° *
__to
)

813 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

815 #ifde‡
__USE_ATFILE


818 
	$lök©
 (
__‰omfd
, c⁄° *
__‰om
, 
__tofd
,

819 c⁄° *
__to
, 
__Êags
)

820 
__THROW
 
	`__n⁄nuŒ
 ((2, 4)Ë
__wur
;

823 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


825 
	$symlök
 (c⁄° *
__‰om
, c⁄° *
__to
)

826 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

831 
ssize_t
 
	$ªadlök
 (c⁄° *
__ª°ri˘
 
__∑th
,

832 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

833 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__wur
;

836 #ifde‡
__USE_ATFILE


838 
	$symlök©
 (c⁄° *
__‰om
, 
__tofd
,

839 c⁄° *
__to
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 3)Ë
__wur
;

842 
ssize_t
 
	$ªadlök©
 (
__fd
, c⁄° *
__ª°ri˘
 
__∑th
,

843 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

844 
__THROW
 
	`__n⁄nuŒ
 ((2, 3)Ë
__wur
;

848 
	$u∆ök
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

850 #ifde‡
__USE_ATFILE


852 
	$u∆ök©
 (
__fd
, c⁄° *
__«me
, 
__Êag
)

853 
__THROW
 
	`__n⁄nuŒ
 ((2));

857 
	$rmdú
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

861 
__pid_t
 
	$tcgëpgΩ
 (
__fd
Ë
__THROW
;

864 
	$tc£çgΩ
 (
__fd
, 
__pid_t
 
__pgΩ_id
Ë
__THROW
;

871 *
	`gëlogö
 ();

872 #i‡
deföed
 
__USE_REENTRANT
 || deföed 
__USE_POSIX199506


879 
	$gëlogö_r
 (*
__«me
, 
size_t
 
__«me_Àn
Ë
	`__n⁄nuŒ
 ((1));

882 #ifdef 
__USE_BSD


884 
	$£éogö
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

888 #ifdef 
__USE_POSIX2


892 
	#__√ed_gë›t


	)

893 
	~<gë›t.h
>

897 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


901 
	$gëho°«me
 (*
__«me
, 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

905 #i‡
deföed
 
__USE_BSD
 || (deföed 
__USE_XOPEN
 && !deföed 
__USE_UNIX98
)

908 
	$£tho°«me
 (c⁄° *
__«me
, 
size_t
 
__Àn
)

909 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

913 
	$£tho°id
 (
__id
Ë
__THROW
 
__wur
;

919 
	$gëdomaö«me
 (*
__«me
, 
size_t
 
__Àn
)

920 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

921 
	$£tdomaö«me
 (c⁄° *
__«me
, 
size_t
 
__Àn
)

922 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

928 
	$vh™gup
 (Ë
__THROW
;

931 
	$ªvoke
 (c⁄° *
__fûe
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

939 
	$¥ofû
 (*
__ßm∂e_buf„r
, 
size_t
 
__size
,

940 
size_t
 
__off£t
, 
__sˇÀ
)

941 
__THROW
 
	`__n⁄nuŒ
 ((1));

947 
	$ac˘
 (c⁄° *
__«me
Ë
__THROW
;

951 *
	$gëu£rshñl
 (Ë
__THROW
;

952 
	$ídu£rshñl
 (Ë
__THROW
;

953 
	$£tu£rshñl
 (Ë
__THROW
;

959 
	$d´m⁄
 (
__nochdú
, 
__no˛o£
Ë
__THROW
 
__wur
;

963 #i‡
deföed
 
__USE_BSD
 || (deföed 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

966 
	$chroŸ
 (c⁄° *
__∑th
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

970 *
	$gë∑ss
 (c⁄° *
__¥om±
Ë
	`__n⁄nuŒ
 ((1));

978 
	`fsync
 (
__fd
);

981 #ifde‡
__USE_GNU


984 
	$syncfs
 (
__fd
Ë
__THROW
;

988 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


991 
	`gëho°id
 ();

994 
	$sync
 (Ë
__THROW
;

997 #i‡
deföed
 
__USE_BSD
 || !deföed 
__USE_XOPEN2K


1000 
	$gë∑gesize
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

1005 
	$gëdèbÀsize
 (Ë
__THROW
;

1011 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


1014 #i‚de‡
__USE_FILE_OFFSET64


1015 
	$åunˇã
 (c⁄° *
__fûe
, 
__off_t
 
__Àngth
)

1016 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1018 #ifde‡
__REDIRECT_NTH


1019 
	`__REDIRECT_NTH
 (
åunˇã
,

1020 (c⁄° *
__fûe
, 
__off64_t
 
__Àngth
),

1021 
åunˇã64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1023 
	#åunˇã
 
åunˇã64


	)

1026 #ifde‡
__USE_LARGEFILE64


1027 
	$åunˇã64
 (c⁄° *
__fûe
, 
__off64_t
 
__Àngth
)

1028 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

1033 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_POSIX199309
 \

1034 || 
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


1037 #i‚de‡
__USE_FILE_OFFSET64


1038 
	$·runˇã
 (
__fd
, 
__off_t
 
__Àngth
Ë
__THROW
 
__wur
;

1040 #ifde‡
__REDIRECT_NTH


1041 
	`__REDIRECT_NTH
 (
·runˇã
, (
__fd
, 
__off64_t
 
__Àngth
),

1042 
·runˇã64
Ë
__wur
;

1044 
	#·runˇã
 
·runˇã64


	)

1047 #ifde‡
__USE_LARGEFILE64


1048 
	$·runˇã64
 (
__fd
, 
__off64_t
 
__Àngth
Ë
__THROW
 
__wur
;

1054 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

1055 || 
deföed
 
__USE_MISC


1059 
	$brk
 (*
__addr
Ë
__THROW
 
__wur
;

1065 *
	$sbrk
 (
öçå_t
 
__dñè
Ë
__THROW
;

1069 #ifde‡
__USE_MISC


1080 
	$sysˇŒ
 (
__sy¢o
, ...Ë
__THROW
;

1085 #i‡(
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
Ë&& !deföed 
F_LOCK


1097 
	#F_ULOCK
 0

	)

1098 
	#F_LOCK
 1

	)

1099 
	#F_TLOCK
 2

	)

1100 
	#F_TEST
 3

	)

1102 #i‚de‡
__USE_FILE_OFFSET64


1103 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Àn
Ë
__wur
;

1105 #ifde‡
__REDIRECT


1106 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
),

1107 
lockf64
Ë
__wur
;

1109 
	#lockf
 
lockf64


	)

1112 #ifde‡
__USE_LARGEFILE64


1113 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
Ë
__wur
;

1118 #ifde‡
__USE_GNU


1123 
	#TEMP_FAILURE_RETRY
(
ex¥essi⁄
) \

1124 (
__exãnsi⁄__
 \

1125 ({ 
__ªsu…
; \

1126 dÿ
__ªsu…
 = (Ë(
ex¥essi⁄
); \

1127 
__ªsu…
 =-1L && 
î∫o
 =
EINTR
); \

1128 
__ªsu…
; 
	}
}))

	)

1131 #i‡
deföed
 
__USE_POSIX199309
 || deföed 
__USE_UNIX98


1134 
fd©async
 (
__fûdes
);

1140 #ifdef 
__USE_XOPEN


1142 *
	$¸y±
 (c⁄° *
__key
, c⁄° *
__ß…
)

1143 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1147 
	$í¸y±
 (*
__libc_block
, 
__edÊag
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

1154 
	$swab
 (c⁄° *
__ª°ri˘
 
__‰om
, *__ª°ri˘ 
__to
,

1155 
ssize_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1161 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K


1163 *
	$˘îmid
 (*
__s
Ë
__THROW
;

1168 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


1169 
	~<bôs/uni°d.h
>

1172 
__END_DECLS


	@/usr/include/alloca.h

18 #i‚def 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<„©uªs.h
>

23 
	#__√ed_size_t


	)

24 
	~<°ddef.h
>

26 
	g__BEGIN_DECLS


29 #unde‡
Æloˇ


32 *
	$Æloˇ
 (
size_t
 
__size
Ë
__THROW
;

34 #ifdef 
__GNUC__


35 
	#Æloˇ
(
size
Ë
	`__buûtö_Æloˇ
 (size)

	)

38 
__END_DECLS


	@/usr/include/boost/config.hpp

17 #i‚de‡
BOOST_CONFIG_HPP


18 
	#BOOST_CONFIG_HPP


	)

21 #i‡!
deföed
(
BOOST_USER_CONFIG
Ë&& !deföed(
BOOST_NO_USER_CONFIG
)

22 
	#BOOST_USER_CONFIG
 <
boo°
/
c⁄fig
/
u£r
.
hµ
>

	)

25 #ifde‡
BOOST_USER_CONFIG


26 #ö˛udê
BOOST_USER_CONFIG


30 #i‡!
deföed
(
BOOST_COMPILER_CONFIG
Ë&& !deföed(
BOOST_NO_COMPILER_CONFIG
Ë&& !deföed(
BOOST_NO_CONFIG
)

31 
	~<boo°/c⁄fig/£À˘_compûî_c⁄fig.hµ
>

34 #ifde‡
BOOST_COMPILER_CONFIG


35 #ö˛udê
BOOST_COMPILER_CONFIG


39 #i‡!
deföed
(
BOOST_STDLIB_CONFIG
Ë&& !deföed(
BOOST_NO_STDLIB_CONFIG
Ë&& !deföed(
BOOST_NO_CONFIG
Ë&& deföed(
__˝lu•lus
)

40 
	~<boo°/c⁄fig/£À˘_°dlib_c⁄fig.hµ
>

43 #ifde‡
BOOST_STDLIB_CONFIG


44 #ö˛udê
BOOST_STDLIB_CONFIG


48 #i‡!
deföed
(
BOOST_PLATFORM_CONFIG
Ë&& !deföed(
BOOST_NO_PLATFORM_CONFIG
Ë&& !deföed(
BOOST_NO_CONFIG
)

49 
	~<boo°/c⁄fig/£À˘_∂©f‹m_c⁄fig.hµ
>

52 #ifde‡
BOOST_PLATFORM_CONFIG


53 #ö˛udê
BOOST_PLATFORM_CONFIG


57 
	~<boo°/c⁄fig/suffix.hµ
>

	@/usr/include/boost/detail/workaround.hpp

5 #i‚de‡
WORKAROUND_DWA2002126_HPP


6 
	#WORKAROUND_DWA2002126_HPP


	)

39 #i‚de‡
BOOST_STRICT_CONFIG


41 
	~<boo°/c⁄fig.hµ
>

43 #i‚de‡
__BORLANDC__


44 
	#__BORLANDC___WORKAROUND_GUARD
 1

	)

46 
	#__BORLANDC___WORKAROUND_GUARD
 0

	)

48 #i‚de‡
__CODEGEARC__


49 
	#__CODEGEARC___WORKAROUND_GUARD
 1

	)

51 
	#__CODEGEARC___WORKAROUND_GUARD
 0

	)

53 #i‚de‡
_MSC_VER


54 
	#_MSC_VER_WORKAROUND_GUARD
 1

	)

56 
	#_MSC_VER_WORKAROUND_GUARD
 0

	)

58 #i‚de‡
_MSC_FULL_VER


59 
	#_MSC_FULL_VER_WORKAROUND_GUARD
 1

	)

61 
	#_MSC_FULL_VER_WORKAROUND_GUARD
 0

	)

63 #i‚de‡
BOOST_MSVC


64 
	#BOOST_MSVC_WORKAROUND_GUARD
 1

	)

66 
	#BOOST_MSVC_WORKAROUND_GUARD
 0

	)

68 #i‚de‡
BOOST_MSVC_FULL_VER


69 
	#BOOST_MSVC_FULL_VER_WORKAROUND_GUARD
 1

	)

71 
	#BOOST_MSVC_FULL_VER_WORKAROUND_GUARD
 0

	)

73 #i‚de‡
__GNUC__


74 
	#__GNUC___WORKAROUND_GUARD
 1

	)

76 
	#__GNUC___WORKAROUND_GUARD
 0

	)

78 #i‚de‡
__GNUC_MINOR__


79 
	#__GNUC_MINOR___WORKAROUND_GUARD
 1

	)

81 
	#__GNUC_MINOR___WORKAROUND_GUARD
 0

	)

83 #i‚de‡
__GNUC_PATCHLEVEL__


84 
	#__GNUC_PATCHLEVEL___WORKAROUND_GUARD
 1

	)

86 
	#__GNUC_PATCHLEVEL___WORKAROUND_GUARD
 0

	)

88 #i‚de‡
__IBMCPP__


89 
	#__IBMCPP___WORKAROUND_GUARD
 1

	)

91 
	#__IBMCPP___WORKAROUND_GUARD
 0

	)

93 #i‚de‡
__SUNPRO_CC


94 
	#__SUNPRO_CC_WORKAROUND_GUARD
 1

	)

96 
	#__SUNPRO_CC_WORKAROUND_GUARD
 0

	)

98 #i‚de‡
__DECCXX_VER


99 
	#__DECCXX_VER_WORKAROUND_GUARD
 1

	)

101 
	#__DECCXX_VER_WORKAROUND_GUARD
 0

	)

103 #i‚de‡
__MWERKS__


104 
	#__MWERKS___WORKAROUND_GUARD
 1

	)

106 
	#__MWERKS___WORKAROUND_GUARD
 0

	)

108 #i‚de‡
__EDG__


109 
	#__EDG___WORKAROUND_GUARD
 1

	)

111 
	#__EDG___WORKAROUND_GUARD
 0

	)

113 #i‚de‡
__EDG_VERSION__


114 
	#__EDG_VERSION___WORKAROUND_GUARD
 1

	)

116 
	#__EDG_VERSION___WORKAROUND_GUARD
 0

	)

118 #i‚de‡
__HP_aCC


119 
	#__HP_aCC_WORKAROUND_GUARD
 1

	)

121 
	#__HP_aCC_WORKAROUND_GUARD
 0

	)

123 #i‚de‡
__hpx°d98


124 
	#__hpx°d98_WORKAROUND_GUARD
 1

	)

126 
	#__hpx°d98_WORKAROUND_GUARD
 0

	)

128 #i‚de‡
_CRAYC


129 
	#_CRAYC_WORKAROUND_GUARD
 1

	)

131 
	#_CRAYC_WORKAROUND_GUARD
 0

	)

133 #i‚de‡
__DMC__


134 
	#__DMC___WORKAROUND_GUARD
 1

	)

136 
	#__DMC___WORKAROUND_GUARD
 0

	)

138 #i‚de‡
MPW_CPLUS


139 
	#MPW_CPLUS_WORKAROUND_GUARD
 1

	)

141 
	#MPW_CPLUS_WORKAROUND_GUARD
 0

	)

143 #i‚de‡
__COMO__


144 
	#__COMO___WORKAROUND_GUARD
 1

	)

146 
	#__COMO___WORKAROUND_GUARD
 0

	)

148 #i‚de‡
__COMO_VERSION__


149 
	#__COMO_VERSION___WORKAROUND_GUARD
 1

	)

151 
	#__COMO_VERSION___WORKAROUND_GUARD
 0

	)

153 #i‚de‡
__INTEL_COMPILER


154 
	#__INTEL_COMPILER_WORKAROUND_GUARD
 1

	)

156 
	#__INTEL_COMPILER_WORKAROUND_GUARD
 0

	)

158 #i‚de‡
__ICL


159 
	#__ICL_WORKAROUND_GUARD
 1

	)

161 
	#__ICL_WORKAROUND_GUARD
 0

	)

163 #i‚de‡
_COMPILER_VERSION


164 
	#_COMPILER_VERSION_WORKAROUND_GUARD
 1

	)

166 
	#_COMPILER_VERSION_WORKAROUND_GUARD
 0

	)

169 #i‚de‡
_RWSTD_VER


170 
	#_RWSTD_VER_WORKAROUND_GUARD
 1

	)

172 
	#_RWSTD_VER_WORKAROUND_GUARD
 0

	)

174 #i‚de‡
BOOST_RWSTD_VER


175 
	#BOOST_RWSTD_VER_WORKAROUND_GUARD
 1

	)

177 
	#BOOST_RWSTD_VER_WORKAROUND_GUARD
 0

	)

179 #i‚de‡
__GLIBCPP__


180 
	#__GLIBCPP___WORKAROUND_GUARD
 1

	)

182 
	#__GLIBCPP___WORKAROUND_GUARD
 0

	)

184 #i‚de‡
_GLIBCXX_USE_C99_FP_MACROS_DYNAMIC


185 
	#_GLIBCXX_USE_C99_FP_MACROS_DYNAMIC_WORKAROUND_GUARD
 1

	)

187 
	#_GLIBCXX_USE_C99_FP_MACROS_DYNAMIC_WORKAROUND_GUARD
 0

	)

189 #i‚de‡
__SGI_STL_PORT


190 
	#__SGI_STL_PORT_WORKAROUND_GUARD
 1

	)

192 
	#__SGI_STL_PORT_WORKAROUND_GUARD
 0

	)

194 #i‚de‡
_STLPORT_VERSION


195 
	#_STLPORT_VERSION_WORKAROUND_GUARD
 1

	)

197 
	#_STLPORT_VERSION_WORKAROUND_GUARD
 0

	)

199 #i‚de‡
__LIBCOMO_VERSION__


200 
	#__LIBCOMO_VERSION___WORKAROUND_GUARD
 1

	)

202 
	#__LIBCOMO_VERSION___WORKAROUND_GUARD
 0

	)

204 #i‚de‡
_CPPLIB_VER


205 
	#_CPPLIB_VER_WORKAROUND_GUARD
 1

	)

207 
	#_CPPLIB_VER_WORKAROUND_GUARD
 0

	)

210 #i‚de‡
BOOST_INTEL_CXX_VERSION


211 
	#BOOST_INTEL_CXX_VERSION_WORKAROUND_GUARD
 1

	)

213 
	#BOOST_INTEL_CXX_VERSION_WORKAROUND_GUARD
 0

	)

215 #i‚de‡
BOOST_INTEL_WIN


216 
	#BOOST_INTEL_WIN_WORKAROUND_GUARD
 1

	)

218 
	#BOOST_INTEL_WIN_WORKAROUND_GUARD
 0

	)

220 #i‚de‡
BOOST_DINKUMWARE_STDLIB


221 
	#BOOST_DINKUMWARE_STDLIB_WORKAROUND_GUARD
 1

	)

223 
	#BOOST_DINKUMWARE_STDLIB_WORKAROUND_GUARD
 0

	)

225 #i‚de‡
BOOST_INTEL


226 
	#BOOST_INTEL_WORKAROUND_GUARD
 1

	)

228 
	#BOOST_INTEL_WORKAROUND_GUARD
 0

	)

231 
	#BOOST_MPL_CFG_GCC_WORKAROUND_GUARD
 0

	)

233 
	#BOOST_WORKAROUND
(
symbﬁ
, 
ã°
) \

234 ((
symbﬁ
 ## 
_WORKAROUND_GUARD
 + 0 == 0) && \

235 (
symbﬁ
 !0Ë&& (1 % (–(symbﬁ 
ã°
ËË+ 1)))

	)

254 #ifde‡
BOOST_DETECT_OUTDATED_WORKAROUNDS


255 
	#BOOST_OPEN_PAREN
 (

	)

256 
	#BOOST_TESTED_AT
(
vÆue
Ë> vÆueË?(-1): 
BOOST_OPEN_PAREN
 1

	)

258 
	#BOOST_TESTED_AT
(
vÆue
Ë!((vÆue)-(vÆue))

	)

263 
	#BOOST_WORKAROUND
(
symbﬁ
, 
ã°
Ë0

	)

	@/usr/include/features.h

18 #i‚def 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

98 #unde‡
__USE_ISOC11


99 #unde‡
__USE_ISOC99


100 #unde‡
__USE_ISOC95


101 #unde‡
__USE_ISOCXX11


102 #unde‡
__USE_POSIX


103 #unde‡
__USE_POSIX2


104 #unde‡
__USE_POSIX199309


105 #unde‡
__USE_POSIX199506


106 #unde‡
__USE_XOPEN


107 #unde‡
__USE_XOPEN_EXTENDED


108 #unde‡
__USE_UNIX98


109 #unde‡
__USE_XOPEN2K


110 #unde‡
__USE_XOPEN2KXSI


111 #unde‡
__USE_XOPEN2K8


112 #unde‡
__USE_XOPEN2K8XSI


113 #unde‡
__USE_LARGEFILE


114 #unde‡
__USE_LARGEFILE64


115 #unde‡
__USE_FILE_OFFSET64


116 #unde‡
__USE_BSD


117 #unde‡
__USE_SVID


118 #unde‡
__USE_MISC


119 #unde‡
__USE_ATFILE


120 #unde‡
__USE_GNU


121 #unde‡
__USE_REENTRANT


122 #unde‡
__USE_FORTIFY_LEVEL


123 #unde‡
__FAVOR_BSD


124 #unde‡
__KERNEL_STRICT_NAMES


128 #i‚de‡
_LOOSE_KERNEL_NAMES


129 
	#__KERNEL_STRICT_NAMES


	)

133 
	#__USE_ANSI
 1

	)

142 #i‡
deföed
 
__GNUC__
 && deföed 
__GNUC_MINOR__


143 
	#__GNUC_PREREQ
(
maj
, 
mö
) \

144 ((
__GNUC__
 << 16Ë+ 
__GNUC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

146 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë0

	)

151 #i‡
deföed
 
_BSD_SOURCE
 && \

152 !(
deföed
 
	g_POSIX_SOURCE
 || deföed 
	g_POSIX_C_SOURCE
 || \

153 
deföed
 
	g_XOPEN_SOURCE
 || deföed 
	g_GNU_SOURCE
 || deföed 
	g_SVID_SOURCE
)

154 
	#__FAVOR_BSD
 1

	)

158 #ifde‡
_GNU_SOURCE


159 #unde‡
_ISOC95_SOURCE


160 
	#_ISOC95_SOURCE
 1

	)

161 #unde‡
_ISOC99_SOURCE


162 
	#_ISOC99_SOURCE
 1

	)

163 #unde‡
_ISOC11_SOURCE


164 
	#_ISOC11_SOURCE
 1

	)

165 #unde‡
_POSIX_SOURCE


166 
	#_POSIX_SOURCE
 1

	)

167 #unde‡
_POSIX_C_SOURCE


168 
	#_POSIX_C_SOURCE
 200809L

	)

169 #unde‡
_XOPEN_SOURCE


170 
	#_XOPEN_SOURCE
 700

	)

171 #unde‡
_XOPEN_SOURCE_EXTENDED


172 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

173 #unde‡
_LARGEFILE64_SOURCE


174 
	#_LARGEFILE64_SOURCE
 1

	)

175 #unde‡
_BSD_SOURCE


176 
	#_BSD_SOURCE
 1

	)

177 #unde‡
_SVID_SOURCE


178 
	#_SVID_SOURCE
 1

	)

179 #unde‡
_ATFILE_SOURCE


180 
	#_ATFILE_SOURCE
 1

	)

185 #i‡(!
deföed
 
__STRICT_ANSI__
 && !deföed 
_ISOC99_SOURCE
 && \

186 !
deföed
 
	g_POSIX_SOURCE
 && !deföed 
	g_POSIX_C_SOURCE
 && \

187 !
deföed
 
	g_XOPEN_SOURCE
 && !deföed 
	g_BSD_SOURCE
 && !deföed 
	g_SVID_SOURCE
)

188 
	#_BSD_SOURCE
 1

	)

189 
	#_SVID_SOURCE
 1

	)

193 #i‡(
deföed
 
_ISOC11_SOURCE
 \

194 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

195 
	#__USE_ISOC11
 1

	)

199 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

200 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

201 
	#__USE_ISOC99
 1

	)

205 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

206 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

207 
	#__USE_ISOC95
 1

	)

214 #i‡((
deföed
 
__˝lu•lus
 && __cplusplus >= 201103L) \

215 || 
deföed
 
__GXX_EXPERIMENTAL_CXX0X__
)

216 
	#__USE_ISOCXX11
 1

	)

221 #i‡((!
deföed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

222 !
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE
)

223 
	#_POSIX_SOURCE
 1

	)

224 #i‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

225 
	#_POSIX_C_SOURCE
 2

	)

226 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

227 
	#_POSIX_C_SOURCE
 199506L

	)

228 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

229 
	#_POSIX_C_SOURCE
 200112L

	)

231 
	#_POSIX_C_SOURCE
 200809L

	)

233 
	#__USE_POSIX_IMPLICITLY
 1

	)

236 #i‡
deföed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >1 || deföed 
_XOPEN_SOURCE


237 
	#__USE_POSIX
 1

	)

240 #i‡
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >2 || deföed 
_XOPEN_SOURCE


241 
	#__USE_POSIX2
 1

	)

244 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199309L

245 
	#__USE_POSIX199309
 1

	)

248 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199506L

249 
	#__USE_POSIX199506
 1

	)

252 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200112L

253 
	#__USE_XOPEN2K
 1

	)

254 #unde‡
__USE_ISOC95


255 
	#__USE_ISOC95
 1

	)

256 #unde‡
__USE_ISOC99


257 
	#__USE_ISOC99
 1

	)

260 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200809L

261 
	#__USE_XOPEN2K8
 1

	)

262 #unde‡
_ATFILE_SOURCE


263 
	#_ATFILE_SOURCE
 1

	)

266 #ifdef 
_XOPEN_SOURCE


267 
	#__USE_XOPEN
 1

	)

268 #i‡(
_XOPEN_SOURCE
 - 0) >= 500

269 
	#__USE_XOPEN_EXTENDED
 1

	)

270 
	#__USE_UNIX98
 1

	)

271 #unde‡
_LARGEFILE_SOURCE


272 
	#_LARGEFILE_SOURCE
 1

	)

273 #i‡(
_XOPEN_SOURCE
 - 0) >= 600

274 #i‡(
_XOPEN_SOURCE
 - 0) >= 700

275 
	#__USE_XOPEN2K8
 1

	)

276 
	#__USE_XOPEN2K8XSI
 1

	)

278 
	#__USE_XOPEN2K
 1

	)

279 
	#__USE_XOPEN2KXSI
 1

	)

280 #unde‡
__USE_ISOC95


281 
	#__USE_ISOC95
 1

	)

282 #unde‡
__USE_ISOC99


283 
	#__USE_ISOC99
 1

	)

286 #ifde‡
_XOPEN_SOURCE_EXTENDED


287 
	#__USE_XOPEN_EXTENDED
 1

	)

292 #ifde‡
_LARGEFILE_SOURCE


293 
	#__USE_LARGEFILE
 1

	)

296 #ifde‡
_LARGEFILE64_SOURCE


297 
	#__USE_LARGEFILE64
 1

	)

300 #i‡
deföed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

301 
	#__USE_FILE_OFFSET64
 1

	)

304 #i‡
deföed
 
_BSD_SOURCE
 || deföed 
_SVID_SOURCE


305 
	#__USE_MISC
 1

	)

308 #ifdef 
_BSD_SOURCE


309 
	#__USE_BSD
 1

	)

312 #ifdef 
_SVID_SOURCE


313 
	#__USE_SVID
 1

	)

316 #ifdef 
_ATFILE_SOURCE


317 
	#__USE_ATFILE
 1

	)

320 #ifdef 
_GNU_SOURCE


321 
	#__USE_GNU
 1

	)

324 #i‡
deföed
 
_REENTRANT
 || deföed 
_THREAD_SAFE


325 
	#__USE_REENTRANT
 1

	)

328 #i‡
deföed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

329 && 
__GNUC_PREREQ
 (4, 1Ë&& 
deföed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

330 #i‡
_FORTIFY_SOURCE
 > 1

331 
	#__USE_FORTIFY_LEVEL
 2

	)

333 
	#__USE_FORTIFY_LEVEL
 1

	)

336 
	#__USE_FORTIFY_LEVEL
 0

	)

341 
	~<°dc-¥edef.h
>

349 #unde‡
__GNU_LIBRARY__


350 
	#__GNU_LIBRARY__
 6

	)

354 
	#__GLIBC__
 2

	)

355 
	#__GLIBC_MINOR__
 17

	)

357 
	#__GLIBC_PREREQ
(
maj
, 
mö
) \

358 ((
__GLIBC__
 << 16Ë+ 
__GLIBC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

361 #i‡
deföed
 
__GNUC__
 \

362 || (
deföed
 
	g__PGI
 && deföed 
	g__i386__
 ) \

363 || (
deföed
 
	g__INTEL_COMPILER
 && (deföed 
	g__i386__
 || deföed 
	g__ü64__
)) \

364 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L)

365 
	#__GLIBC_HAVE_LONG_LONG
 1

	)

369 #i‚de‡
__ASSEMBLER__


370 #i‚de‡
_SYS_CDEFS_H


371 
	~<sys/cdefs.h
>

376 #i‡
deföed
 
__USE_FILE_OFFSET64
 && !deföed 
__REDIRECT


377 
	#__USE_LARGEFILE
 1

	)

378 
	#__USE_LARGEFILE64
 1

	)

384 #i‡
__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

385 && !
deföed
 
	g__OPTIMIZE_SIZE__
 && !deföed 
	g__NO_INLINE__
 \

386 && 
deföed
 
	g__exã∫_ölöe


387 
	#__USE_EXTERN_INLINES
 1

	)

395 
	~<gnu/°ubs.h
>

	@/usr/include/libio.h

29 #i‚de‡
_IO_STDIO_H


30 
	#_IO_STDIO_H


	)

32 
	~<_G_c⁄fig.h
>

34 
	#_IO_Âos_t
 
_G_Âos_t


	)

35 
	#_IO_Âos64_t
 
_G_Âos64_t


	)

36 
	#_IO_size_t
 
size_t


	)

37 
	#_IO_ssize_t
 
__ssize_t


	)

38 
	#_IO_off_t
 
__off_t


	)

39 
	#_IO_off64_t
 
__off64_t


	)

40 
	#_IO_pid_t
 
__pid_t


	)

41 
	#_IO_uid_t
 
__uid_t


	)

42 
	#_IO_ic⁄v_t
 
_G_ic⁄v_t


	)

43 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

44 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

45 
	#_IO_va_li°
 
_G_va_li°


	)

46 
	#_IO_wöt_t
 
wöt_t


	)

49 
	#__√ed___va_li°


	)

50 
	~<°d¨g.h
>

51 #ifde‡
__GNUC_VA_LIST


52 #unde‡
_IO_va_li°


53 
	#_IO_va_li°
 
__gnuc_va_li°


	)

56 #i‚de‡
__P


57 
	~<sys/cdefs.h
>

60 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

62 #i‚de‡
EOF


63 
	#EOF
 (-1)

	)

65 #i‚de‡
NULL


66 #i‡
deföed
 
__GNUG__
 && \

67 (
	g__GNUC__
 > 2 || (__GNUC__ =2 && 
__GNUC_MINOR__
 >= 8))

68 
	#NULL
 (
__nuŒ
)

	)

70 #i‡!
deföed
(
__˝lu•lus
)

71 
	#NULL
 ((*)0)

	)

73 
	#NULL
 (0)

	)

78 
	#_IOS_INPUT
 1

	)

79 
	#_IOS_OUTPUT
 2

	)

80 
	#_IOS_ATEND
 4

	)

81 
	#_IOS_APPEND
 8

	)

82 
	#_IOS_TRUNC
 16

	)

83 
	#_IOS_NOCREATE
 32

	)

84 
	#_IOS_NOREPLACE
 64

	)

85 
	#_IOS_BIN
 128

	)

93 
	#_IO_MAGIC
 0xFBAD0000

	)

94 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

95 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

96 
	#_IO_USER_BUF
 1

	)

97 
	#_IO_UNBUFFERED
 2

	)

98 
	#_IO_NO_READS
 4

	)

99 
	#_IO_NO_WRITES
 8

	)

100 
	#_IO_EOF_SEEN
 0x10

	)

101 
	#_IO_ERR_SEEN
 0x20

	)

102 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

103 
	#_IO_LINKED
 0x80

	)

104 
	#_IO_IN_BACKUP
 0x100

	)

105 
	#_IO_LINE_BUF
 0x200

	)

106 
	#_IO_TIED_PUT_GET
 0x400

	)

107 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

108 
	#_IO_IS_APPENDING
 0x1000

	)

109 
	#_IO_IS_FILEBUF
 0x2000

	)

110 
	#_IO_BAD_SEEN
 0x4000

	)

111 
	#_IO_USER_LOCK
 0x8000

	)

113 
	#_IO_FLAGS2_MMAP
 1

	)

114 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

115 #ifde‡
_LIBC


116 
	#_IO_FLAGS2_FORTIFY
 4

	)

118 
	#_IO_FLAGS2_USER_WBUF
 8

	)

119 #ifde‡
_LIBC


120 
	#_IO_FLAGS2_SCANF_STD
 16

	)

121 
	#_IO_FLAGS2_NOCLOSE
 32

	)

122 
	#_IO_FLAGS2_CLOEXEC
 64

	)

126 
	#_IO_SKIPWS
 01

	)

127 
	#_IO_LEFT
 02

	)

128 
	#_IO_RIGHT
 04

	)

129 
	#_IO_INTERNAL
 010

	)

130 
	#_IO_DEC
 020

	)

131 
	#_IO_OCT
 040

	)

132 
	#_IO_HEX
 0100

	)

133 
	#_IO_SHOWBASE
 0200

	)

134 
	#_IO_SHOWPOINT
 0400

	)

135 
	#_IO_UPPERCASE
 01000

	)

136 
	#_IO_SHOWPOS
 02000

	)

137 
	#_IO_SCIENTIFIC
 04000

	)

138 
	#_IO_FIXED
 010000

	)

139 
	#_IO_UNITBUF
 020000

	)

140 
	#_IO_STDIO
 040000

	)

141 
	#_IO_DONT_CLOSE
 0100000

	)

142 
	#_IO_BOOLALPHA
 0200000

	)

145 
_IO_jump_t
; 
	g_IO_FILE
;

148 #ifde‡
_IO_MTSAFE_IO


149 #i‡
deföed
 
__GLIBC__
 && __GLIBC__ >= 2

150 
	~<bôs/°dio-lock.h
>

155 
	t_IO_lock_t
;

161 
	s_IO_m¨kî
 {

162 
_IO_m¨kî
 *
	m_√xt
;

163 
_IO_FILE
 *
	m_sbuf
;

167 
	m_pos
;

169 
£t_°ªampos
(
°ªampos
 
•
Ë{ 
	m_•os
 = sp; }

170 
£t_off£t
(
off£t
Ë{ 
	m_pos
 = off£t; 
	m_•os
 = (
°ªampos
)(-2); }

171 
	mpublic
:

172 
°ªamm¨kî
(
°ªambuf
 *
sb
);

173 ~
°ªamm¨kî
();

174 
ßvög
(Ë{  
	m_•os
 == -2; }

175 
dñè
(
°ªamm¨kî
&);

176 
dñè
();

181 
	e__codecvt_ªsu…


183 
	m__codecvt_ok
,

184 
	m__codecvt_∑πül
,

185 
	m__codecvt_îr‹
,

186 
	m__codecvt_noc⁄v


189 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


192 
	s_IO_codecvt


194 (*
	m__codecvt_de°r
Ë(
	m_IO_codecvt
 *);

195 
__codecvt_ªsu…
 (*
__codecvt_do_out
Ë(
	m_IO_codecvt
 *,

196 
	m__mb°©e_t
 *,

197 c⁄° 
	mwch¨_t
 *,

198 c⁄° 
	mwch¨_t
 *,

199 c⁄° 
	mwch¨_t
 **, *,

201 
__codecvt_ªsu…
 (*
__codecvt_do_unshi·
Ë(
	m_IO_codecvt
 *,

202 
	m__mb°©e_t
 *, *,

204 
__codecvt_ªsu…
 (*
__codecvt_do_ö
Ë(
	m_IO_codecvt
 *,

205 
	m__mb°©e_t
 *,

207 c⁄° **, 
	mwch¨_t
 *,

208 
	mwch¨_t
 *, wchar_t **);

209 (*
	m__codecvt_do_ícodög
Ë(
	m_IO_codecvt
 *);

210 (*
	m__codecvt_do_Æways_noc⁄v
Ë(
	m_IO_codecvt
 *);

211 (*
	m__codecvt_do_Àngth
Ë(
	m_IO_codecvt
 *, 
	m__mb°©e_t
 *,

212 c⁄° *, c⁄° *, 
	m_IO_size_t
);

213 (*
	m__codecvt_do_max_Àngth
Ë(
	m_IO_codecvt
 *);

215 
_IO_ic⁄v_t
 
	m__cd_ö
;

216 
_IO_ic⁄v_t
 
	m__cd_out
;

220 
	s_IO_wide_d©a


222 
wch¨_t
 *
	m_IO_ªad_±r
;

223 
wch¨_t
 *
	m_IO_ªad_íd
;

224 
wch¨_t
 *
	m_IO_ªad_ba£
;

225 
wch¨_t
 *
	m_IO_wrôe_ba£
;

226 
wch¨_t
 *
	m_IO_wrôe_±r
;

227 
wch¨_t
 *
	m_IO_wrôe_íd
;

228 
wch¨_t
 *
	m_IO_buf_ba£
;

229 
wch¨_t
 *
	m_IO_buf_íd
;

231 
wch¨_t
 *
	m_IO_ßve_ba£
;

232 
wch¨_t
 *
	m_IO_backup_ba£
;

234 
wch¨_t
 *
	m_IO_ßve_íd
;

236 
__mb°©e_t
 
	m_IO_°©e
;

237 
__mb°©e_t
 
	m_IO_œ°_°©e
;

238 
_IO_codecvt
 
	m_codecvt
;

240 
wch¨_t
 
	m_sh‹tbuf
[1];

242 c⁄° 
_IO_jump_t
 *
	m_wide_vèbÀ
;

246 
	s_IO_FILE
 {

247 
	m_Êags
;

248 
	#_IO_fûe_Êags
 
_Êags


	)

252 * 
	m_IO_ªad_±r
;

253 * 
	m_IO_ªad_íd
;

254 * 
	m_IO_ªad_ba£
;

255 * 
	m_IO_wrôe_ba£
;

256 * 
	m_IO_wrôe_±r
;

257 * 
	m_IO_wrôe_íd
;

258 * 
	m_IO_buf_ba£
;

259 * 
	m_IO_buf_íd
;

261 *
	m_IO_ßve_ba£
;

262 *
	m_IO_backup_ba£
;

263 *
	m_IO_ßve_íd
;

265 
_IO_m¨kî
 *
	m_m¨kîs
;

267 
_IO_FILE
 *
	m_chaö
;

269 
	m_fûío
;

271 
	m_blksize
;

273 
	m_Êags2
;

275 
_IO_off_t
 
	m_ﬁd_off£t
;

277 
	#__HAVE_COLUMN


	)

279 
	m_cur_cﬁumn
;

280 sig√d 
	m_vèbÀ_off£t
;

281 
	m_sh‹tbuf
[1];

285 
_IO_lock_t
 *
	m_lock
;

286 #ifde‡
_IO_USE_OLD_IO_FILE


289 
	s_IO_FILE_com∂ëe


291 
_IO_FILE
 
	m_fûe
;

293 #i‡
deföed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

294 
_IO_off64_t
 
	m_off£t
;

295 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


297 
_IO_codecvt
 *
	m_codecvt
;

298 
_IO_wide_d©a
 *
	m_wide_d©a
;

299 
_IO_FILE
 *
	m_‰ìªs_li°
;

300 *
	m_‰ìªs_buf
;

301 
size_t
 
	m_‰ìªs_size
;

303 *
	m__∑d1
;

304 *
	m__∑d2
;

305 *
	m__∑d3
;

306 *
	m__∑d4
;

307 
size_t
 
	m__∑d5
;

309 
	m_mode
;

311 
	m_unu£d2
[15 *  (Ë- 4 *  (*Ë-  (
size_t
)];

315 #i‚de‡
__˝lu•lus


316 
_IO_FILE
 
	t_IO_FILE
;

319 
	g_IO_FILE_∂us
;

321 
_IO_FILE_∂us
 
_IO_2_1_°dö_
;

322 
_IO_FILE_∂us
 
_IO_2_1_°dout_
;

323 
_IO_FILE_∂us
 
_IO_2_1_°dîr_
;

324 #i‚de‡
_LIBC


325 
	#_IO_°dö
 ((
_IO_FILE
*)(&
_IO_2_1_°dö_
))

	)

326 
	#_IO_°dout
 ((
_IO_FILE
*)(&
_IO_2_1_°dout_
))

	)

327 
	#_IO_°dîr
 ((
_IO_FILE
*)(&
_IO_2_1_°dîr_
))

	)

329 
_IO_FILE
 *
_IO_°dö
 
©åibuã_hiddí
;

330 
_IO_FILE
 *
_IO_°dout
 
©åibuã_hiddí
;

331 
_IO_FILE
 *
_IO_°dîr
 
©åibuã_hiddí
;

339 
__ssize_t
 
	t__io_ªad_‚
 (*
	t__cookõ
, *
	t__buf
, 
	tsize_t
 
	t__nbyãs
);

347 
__ssize_t
 
	t__io_wrôe_‚
 (*
	t__cookõ
, c⁄° *
	t__buf
,

348 
	tsize_t
 
	t__n
);

356 
	t__io_£ek_‚
 (*
	t__cookõ
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

359 
	t__io_˛o£_‚
 (*
	t__cookõ
);

362 #ifde‡
_GNU_SOURCE


364 
__io_ªad_‚
 
	tcookõ_ªad_fun˘i⁄_t
;

365 
__io_wrôe_‚
 
	tcookõ_wrôe_fun˘i⁄_t
;

366 
__io_£ek_‚
 
	tcookõ_£ek_fun˘i⁄_t
;

367 
__io_˛o£_‚
 
	tcookõ_˛o£_fun˘i⁄_t
;

372 
__io_ªad_‚
 *
	mªad
;

373 
__io_wrôe_‚
 *
	mwrôe
;

374 
__io_£ek_‚
 *
	m£ek
;

375 
__io_˛o£_‚
 *
	m˛o£
;

376 } 
	t_IO_cookõ_io_fun˘i⁄s_t
;

377 
_IO_cookõ_io_fun˘i⁄s_t
 
	tcookõ_io_fun˘i⁄s_t
;

379 
	g_IO_cookõ_fûe
;

382 
_IO_cookõ_öô
 (
_IO_cookõ_fûe
 *
__cfûe
, 
__ªad_wrôe
,

383 *
__cookõ
, 
_IO_cookõ_io_fun˘i⁄s_t
 
__‚s
);

387 #ifde‡
__˝lu•lus


391 
__undîÊow
 (
_IO_FILE
 *);

392 
__uÊow
 (
_IO_FILE
 *);

393 
__ovîÊow
 (
_IO_FILE
 *, );

394 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


395 
_IO_wöt_t
 
__wundîÊow
 (
_IO_FILE
 *);

396 
_IO_wöt_t
 
__wuÊow
 (
_IO_FILE
 *);

397 
_IO_wöt_t
 
__wovîÊow
 (
_IO_FILE
 *, _IO_wint_t);

400 #i‡ 
__GNUC__
 >= 3

401 
	#_IO_BE
(
ex¥
, 
ªs
Ë
	`__buûtö_ex≥˘
 (”x¥),Ñes)

	)

403 
	#_IO_BE
(
ex¥
, 
ªs
Ë”x¥)

	)

406 
	#_IO_gëc_u∆ocked
(
_Â
) \

407 (
	`_IO_BE
 ((
_Â
)->
_IO_ªad_±r
 >(_Â)->
_IO_ªad_íd
, 0) \

408 ? 
	`__uÊow
 (
_Â
Ë: *(*Ë(_Â)->
_IO_ªad_±r
++)

	)

409 
	#_IO_≥ekc_u∆ocked
(
_Â
) \

410 (
	`_IO_BE
 ((
_Â
)->
_IO_ªad_±r
 >(_Â)->
_IO_ªad_íd
, 0) \

411 && 
	`__undîÊow
 (
_Â
Ë=
EOF
 ? EOF \

412 : *(*Ë(
_Â
)->
_IO_ªad_±r
)

	)

413 
	#_IO_putc_u∆ocked
(
_ch
, 
_Â
) \

414 (
	`_IO_BE
 ((
_Â
)->
_IO_wrôe_±r
 >(_Â)->
_IO_wrôe_íd
, 0) \

415 ? 
	`__ovîÊow
 (
_Â
, (Ë(
_ch
)) \

416 : (Ë(*(
_Â
)->
_IO_wrôe_±r
++ = (
_ch
)))

	)

418 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


419 
	#_IO_gëwc_u∆ocked
(
_Â
) \

420 (
	`_IO_BE
 ((
_Â
)->
_wide_d©a
 =
NULL
 \

421 || ((
_Â
)->
_wide_d©a
->
_IO_ªad_±r
 \

422 >(
_Â
)->
_wide_d©a
->
_IO_ªad_íd
), 0) \

423 ? 
	`__wuÊow
 (
_Â
Ë: (
_IO_wöt_t
Ë*(_Â)->
_wide_d©a
->
_IO_ªad_±r
++)

	)

424 
	#_IO_putwc_u∆ocked
(
_wch
, 
_Â
) \

425 (
	`_IO_BE
 ((
_Â
)->
_wide_d©a
 =
NULL
 \

426 || ((
_Â
)->
_wide_d©a
->
_IO_wrôe_±r
 \

427 >(
_Â
)->
_wide_d©a
->
_IO_wrôe_íd
), 0) \

428 ? 
	`__wovîÊow
 (
_Â
, 
_wch
) \

429 : (
_IO_wöt_t
Ë(*(
_Â
)->
_wide_d©a
->
_IO_wrôe_±r
++ = (
_wch
)))

	)

432 
	#_IO_„of_u∆ocked
(
__Â
Ë(((__Â)->
_Êags
 & 
_IO_EOF_SEEN
Ë!0)

	)

433 
	#_IO_„º‹_u∆ocked
(
__Â
Ë(((__Â)->
_Êags
 & 
_IO_ERR_SEEN
Ë!0)

	)

435 
_IO_gëc
 (
_IO_FILE
 *
__Â
);

436 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__Â
);

437 
_IO_„of
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

438 
_IO_„º‹
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

440 
_IO_≥ekc_locked
 (
_IO_FILE
 *
__Â
);

443 
	#_IO_PENDING_OUTPUT_COUNT
(
_Â
) \

444 ((
_Â
)->
_IO_wrôe_±r
 - (_Â)->
_IO_wrôe_ba£
)

	)

446 
_IO_Êockfûe
 (
_IO_FILE
 *Ë
__THROW
;

447 
_IO_fu∆ockfûe
 (
_IO_FILE
 *Ë
__THROW
;

448 
_IO_·rylockfûe
 (
_IO_FILE
 *Ë
__THROW
;

450 #ifde‡
_IO_MTSAFE_IO


451 
	#_IO_≥ekc
(
_Â
Ë
	`_IO_≥ekc_locked
 (_Â)

	)

452 
	#_IO_Êockfûe
(
_Â
) \

453 i‡(((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0Ë
	`_IO_Êockfûe
 (_Â)

	)

454 
	#_IO_fu∆ockfûe
(
_Â
) \

455 i‡(((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0Ë
	`_IO_fu∆ockfûe
 (_Â)

	)

457 
	#_IO_≥ekc
(
_Â
Ë
	`_IO_≥ekc_u∆ocked
 (_Â)

	)

458 
	#_IO_Êockfûe
(
_Â
Ë

	)

459 
	#_IO_fu∆ockfûe
(
_Â
Ë

	)

460 
	#_IO_·rylockfûe
(
_Â
Ë

	)

461 
	#_IO_˛ónup_ªgi⁄_°¨t
(
_f˘
, 
_Â
Ë

	)

462 
	#_IO_˛ónup_ªgi⁄_íd
(
_Doô
Ë

	)

465 
_IO_vfsˇnf
 (
_IO_FILE
 * 
__ª°ri˘
, const * __restrict,

466 
_IO_va_li°
, *
__ª°ri˘
);

467 
_IO_vÂrötf
 (
_IO_FILE
 *
__ª°ri˘
, const *__restrict,

468 
_IO_va_li°
);

469 
_IO_ssize_t
 
_IO_∑dn
 (
_IO_FILE
 *, , _IO_ssize_t);

470 
_IO_size_t
 
_IO_sgën
 (
_IO_FILE
 *, *, _IO_size_t);

472 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

473 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

475 
_IO_‰ì_backup_¨ó
 (
_IO_FILE
 *Ë
__THROW
;

477 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


478 
_IO_wöt_t
 
_IO_gëwc
 (
_IO_FILE
 *
__Â
);

479 
_IO_wöt_t
 
_IO_putwc
 (
wch¨_t
 
__wc
, 
_IO_FILE
 *
__Â
);

480 
_IO_fwide
 (
_IO_FILE
 *
__Â
, 
__mode
Ë
__THROW
;

481 #i‡
__GNUC__
 >= 2

484 #i‡
deföed
 
_LIBC
 && deföed 
SHARED


485 
	~<shlib-com∑t.h
>

486 #i‡
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

487 
	#_IO_fwide_maybe_öcom∑tibÀ
 \

488 (
	`__buûtö_ex≥˘
 (&
_IO_°dö_u£d
 =
NULL
, 0))

	)

489 c⁄° 
_IO_°dö_u£d
;

490 
wók_exã∫
 (
_IO_°dö_u£d
);

493 #i‚de‡
_IO_fwide_maybe_öcom∑tibÀ


494 
	#_IO_fwide_maybe_öcom∑tibÀ
 (0)

	)

498 
	#_IO_fwide
(
__Â
, 
__mode
) \

499 ({ 
__ªsu…
 = (
__mode
); \

500 i‡(
__ªsu…
 < 0 && ! 
_IO_fwide_maybe_öcom∑tibÀ
) \

502 i‡((
__Â
)->
_mode
 == 0) \

504 (
__Â
)->
_mode
 = -1; \

505 
__ªsu…
 = (
__Â
)->
_mode
; \

507 i‡(
	`__buûtö_c⁄°™t_p
 (
__mode
) && (__mode) == 0) \

508 
__ªsu…
 = 
_IO_fwide_maybe_öcom∑tibÀ
 ? -1 : (
__Â
)->
_mode
; \

510 
__ªsu…
 = 
	`_IO_fwide
 (
__Â
, __result); \

511 
__ªsu…
; })

	)

514 
_IO_vfwsˇnf
 (
_IO_FILE
 * 
__ª°ri˘
, c⁄° 
wch¨_t
 * __restrict,

515 
_IO_va_li°
, *
__ª°ri˘
);

516 
_IO_vfw¥ötf
 (
_IO_FILE
 *
__ª°ri˘
, c⁄° 
wch¨_t
 *__restrict,

517 
_IO_va_li°
);

518 
_IO_ssize_t
 
_IO_w∑dn
 (
_IO_FILE
 *, 
wöt_t
, _IO_ssize_t);

519 
_IO_‰ì_wbackup_¨ó
 (
_IO_FILE
 *Ë
__THROW
;

522 #ifde‡
__LDBL_COMPAT


523 
	~<bôs/libio-ldbl.h
>

526 #ifde‡
__˝lu•lus


	@/usr/include/linux/filter.h

5 #i‚de‡
__LINUX_FILTER_H__


6 
	#__LINUX_FILTER_H__


	)

9 
	~<löux/ty≥s.h
>

15 
	#BPF_MAJOR_VERSION
 1

	)

16 
	#BPF_MINOR_VERSION
 1

	)

23 
	ssock_fûãr
 {

24 
__u16
 
	mcode
;

25 
__u8
 
	mjt
;

26 
__u8
 
	mjf
;

27 
__u32
 
	mk
;

30 
	ssock_Ârog
 {

31 
	mÀn
;

32 
sock_fûãr
 *
	mfûãr
;

39 
	#BPF_CLASS
(
code
Ë((codeË& 0x07)

	)

40 
	#BPF_LD
 0x00

	)

41 
	#BPF_LDX
 0x01

	)

42 
	#BPF_ST
 0x02

	)

43 
	#BPF_STX
 0x03

	)

44 
	#BPF_ALU
 0x04

	)

45 
	#BPF_JMP
 0x05

	)

46 
	#BPF_RET
 0x06

	)

47 
	#BPF_MISC
 0x07

	)

50 
	#BPF_SIZE
(
code
Ë((codeË& 0x18)

	)

51 
	#BPF_W
 0x00

	)

52 
	#BPF_H
 0x08

	)

53 
	#BPF_B
 0x10

	)

54 
	#BPF_MODE
(
code
Ë((codeË& 0xe0)

	)

55 
	#BPF_IMM
 0x00

	)

56 
	#BPF_ABS
 0x20

	)

57 
	#BPF_IND
 0x40

	)

58 
	#BPF_MEM
 0x60

	)

59 
	#BPF_LEN
 0x80

	)

60 
	#BPF_MSH
 0xa0

	)

63 
	#BPF_OP
(
code
Ë((codeË& 0xf0)

	)

64 
	#BPF_ADD
 0x00

	)

65 
	#BPF_SUB
 0x10

	)

66 
	#BPF_MUL
 0x20

	)

67 
	#BPF_DIV
 0x30

	)

68 
	#BPF_OR
 0x40

	)

69 
	#BPF_AND
 0x50

	)

70 
	#BPF_LSH
 0x60

	)

71 
	#BPF_RSH
 0x70

	)

72 
	#BPF_NEG
 0x80

	)

73 
	#BPF_MOD
 0x90

	)

74 
	#BPF_XOR
 0xa0

	)

76 
	#BPF_JA
 0x00

	)

77 
	#BPF_JEQ
 0x10

	)

78 
	#BPF_JGT
 0x20

	)

79 
	#BPF_JGE
 0x30

	)

80 
	#BPF_JSET
 0x40

	)

81 
	#BPF_SRC
(
code
Ë((codeË& 0x08)

	)

82 
	#BPF_K
 0x00

	)

83 
	#BPF_X
 0x08

	)

86 
	#BPF_RVAL
(
code
Ë((codeË& 0x18)

	)

87 
	#BPF_A
 0x10

	)

90 
	#BPF_MISCOP
(
code
Ë((codeË& 0xf8)

	)

91 
	#BPF_TAX
 0x00

	)

92 
	#BPF_TXA
 0x80

	)

94 #i‚de‡
BPF_MAXINSNS


95 
	#BPF_MAXINSNS
 4096

	)

101 #i‚de‡
BPF_STMT


102 
	#BPF_STMT
(
code
, 
k
Ë{ ()(code), 0, 0, k }

	)

104 #i‚de‡
BPF_JUMP


105 
	#BPF_JUMP
(
code
, 
k
, 
jt
, 
jf
Ë{ ()(code), jt, jf, k }

	)

111 
	#BPF_MEMWORDS
 16

	)

118 
	#SKF_AD_OFF
 (-0x1000)

	)

119 
	#SKF_AD_PROTOCOL
 0

	)

120 
	#SKF_AD_PKTTYPE
 4

	)

121 
	#SKF_AD_IFINDEX
 8

	)

122 
	#SKF_AD_NLATTR
 12

	)

123 
	#SKF_AD_NLATTR_NEST
 16

	)

124 
	#SKF_AD_MARK
 20

	)

125 
	#SKF_AD_QUEUE
 24

	)

126 
	#SKF_AD_HATYPE
 28

	)

127 
	#SKF_AD_RXHASH
 32

	)

128 
	#SKF_AD_CPU
 36

	)

129 
	#SKF_AD_ALU_XOR_X
 40

	)

130 
	#SKF_AD_VLAN_TAG
 44

	)

131 
	#SKF_AD_VLAN_TAG_PRESENT
 48

	)

132 
	#SKF_AD_PAY_OFFSET
 52

	)

133 
	#SKF_AD_MAX
 56

	)

134 
	#SKF_NET_OFF
 (-0x100000)

	)

135 
	#SKF_LL_OFF
 (-0x200000)

	)

	@/usr/include/linux/if_addr.h

1 #i‚de‡
__LINUX_IF_ADDR_H


2 
	#__LINUX_IF_ADDR_H


	)

4 
	~<löux/ty≥s.h
>

5 
	~<löux/√éök.h
>

7 
	siÁddrmsg
 {

8 
__u8
 
	miÁ_Ámûy
;

9 
__u8
 
	miÁ_¥efixÀn
;

10 
__u8
 
	miÁ_Êags
;

11 
__u8
 
	miÁ_sc›e
;

12 
__u32
 
	miÁ_ödex
;

23 
	mIFA_UNSPEC
,

24 
	mIFA_ADDRESS
,

25 
	mIFA_LOCAL
,

26 
	mIFA_LABEL
,

27 
	mIFA_BROADCAST
,

28 
	mIFA_ANYCAST
,

29 
	mIFA_CACHEINFO
,

30 
	mIFA_MULTICAST
,

31 
	m__IFA_MAX
,

34 
	#IFA_MAX
 (
__IFA_MAX
 - 1)

	)

37 
	#IFA_F_SECONDARY
 0x01

	)

38 
	#IFA_F_TEMPORARY
 
IFA_F_SECONDARY


	)

40 
	#IFA_F_NODAD
 0x02

	)

41 
	#IFA_F_OPTIMISTIC
 0x04

	)

42 
	#IFA_F_DADFAILED
 0x08

	)

43 
	#IFA_F_HOMEADDRESS
 0x10

	)

44 
	#IFA_F_DEPRECATED
 0x20

	)

45 
	#IFA_F_TENTATIVE
 0x40

	)

46 
	#IFA_F_PERMANENT
 0x80

	)

48 
	siÁ_ˇcheöfo
 {

49 
__u32
 
	miÁ_¥e„ªd
;

50 
__u32
 
	miÁ_vÆid
;

51 
__u32
 
	mc°amp
;

52 
__u32
 
	mt°amp
;

56 
	#IFA_RTA
(
r
Ë((
π©å
*)(((*)‘)Ë+ 
	`NLMSG_ALIGN
((
iÁddrmsg
))))

	)

57 
	#IFA_PAYLOAD
(
n
Ë
	`NLMSG_PAYLOAD
“,(
iÁddrmsg
))

	)

	@/usr/include/linux/if_ether.h

21 #i‚de‡
_LINUX_IF_ETHER_H


22 
	#_LINUX_IF_ETHER_H


	)

24 
	~<löux/ty≥s.h
>

31 
	#ETH_ALEN
 6

	)

32 
	#ETH_HLEN
 14

	)

33 
	#ETH_ZLEN
 60

	)

34 
	#ETH_DATA_LEN
 1500

	)

35 
	#ETH_FRAME_LEN
 1514

	)

36 
	#ETH_FCS_LEN
 4

	)

42 
	#ETH_P_LOOP
 0x0060

	)

43 
	#ETH_P_PUP
 0x0200

	)

44 
	#ETH_P_PUPAT
 0x0201

	)

45 
	#ETH_P_IP
 0x0800

	)

46 
	#ETH_P_X25
 0x0805

	)

47 
	#ETH_P_ARP
 0x0806

	)

48 
	#ETH_P_BPQ
 0x08FF

	)

49 
	#ETH_P_IEEEPUP
 0x0a00

	)

50 
	#ETH_P_IEEEPUPAT
 0x0a01

	)

51 
	#ETH_P_BATMAN
 0x4305

	)

52 
	#ETH_P_DEC
 0x6000

	)

53 
	#ETH_P_DNA_DL
 0x6001

	)

54 
	#ETH_P_DNA_RC
 0x6002

	)

55 
	#ETH_P_DNA_RT
 0x6003

	)

56 
	#ETH_P_LAT
 0x6004

	)

57 
	#ETH_P_DIAG
 0x6005

	)

58 
	#ETH_P_CUST
 0x6006

	)

59 
	#ETH_P_SCA
 0x6007

	)

60 
	#ETH_P_TEB
 0x6558

	)

61 
	#ETH_P_RARP
 0x8035

	)

62 
	#ETH_P_ATALK
 0x809B

	)

63 
	#ETH_P_AARP
 0x80F3

	)

64 
	#ETH_P_8021Q
 0x8100

	)

65 
	#ETH_P_IPX
 0x8137

	)

66 
	#ETH_P_IPV6
 0x86DD

	)

67 
	#ETH_P_PAUSE
 0x8808

	)

68 
	#ETH_P_SLOW
 0x8809

	)

69 
	#ETH_P_WCCP
 0x883E

	)

71 
	#ETH_P_PPP_DISC
 0x8863

	)

72 
	#ETH_P_PPP_SES
 0x8864

	)

73 
	#ETH_P_MPLS_UC
 0x8847

	)

74 
	#ETH_P_MPLS_MC
 0x8848

	)

75 
	#ETH_P_ATMMPOA
 0x884¯

	)

76 
	#ETH_P_LINK_CTL
 0x886¯

	)

77 
	#ETH_P_ATMFATE
 0x8884

	)

80 
	#ETH_P_PAE
 0x888E

	)

81 
	#ETH_P_AOE
 0x88A2

	)

82 
	#ETH_P_8021AD
 0x88A8

	)

83 
	#ETH_P_802_EX1
 0x88B5

	)

84 
	#ETH_P_TIPC
 0x88CA

	)

85 
	#ETH_P_8021AH
 0x88E7

	)

86 
	#ETH_P_MVRP
 0x88F5

	)

87 
	#ETH_P_1588
 0x88F7

	)

88 
	#ETH_P_FCOE
 0x8906

	)

89 
	#ETH_P_TDLS
 0x890D

	)

90 
	#ETH_P_FIP
 0x8914

	)

91 
	#ETH_P_QINQ1
 0x9100

	)

92 
	#ETH_P_QINQ2
 0x9200

	)

93 
	#ETH_P_QINQ3
 0x9300

	)

94 
	#ETH_P_EDSA
 0xDADA

	)

95 
	#ETH_P_AF_IUCV
 0xFBFB

	)

97 
	#ETH_P_802_3_MIN
 0x0600

	)

104 
	#ETH_P_802_3
 0x0001

	)

105 
	#ETH_P_AX25
 0x0002

	)

106 
	#ETH_P_ALL
 0x0003

	)

107 
	#ETH_P_802_2
 0x0004

	)

108 
	#ETH_P_SNAP
 0x0005

	)

109 
	#ETH_P_DDCMP
 0x0006

	)

110 
	#ETH_P_WAN_PPP
 0x0007

	)

111 
	#ETH_P_PPP_MP
 0x0008

	)

112 
	#ETH_P_LOCALTALK
 0x0009

	)

113 
	#ETH_P_CAN
 0x000C

	)

114 
	#ETH_P_CANFD
 0x000D

	)

115 
	#ETH_P_PPPTALK
 0x0010

	)

116 
	#ETH_P_TR_802_2
 0x0011

	)

117 
	#ETH_P_MOBITEX
 0x0015

	)

118 
	#ETH_P_CONTROL
 0x0016

	)

119 
	#ETH_P_IRDA
 0x0017

	)

120 
	#ETH_P_ECONET
 0x0018

	)

121 
	#ETH_P_HDLC
 0x0019

	)

122 
	#ETH_P_ARCNET
 0x001A

	)

123 
	#ETH_P_DSA
 0x001B

	)

124 
	#ETH_P_TRAILER
 0x001C

	)

125 
	#ETH_P_PHONET
 0x00F5

	)

126 
	#ETH_P_IEEE802154
 0x00F6

	)

127 
	#ETH_P_CAIF
 0x00F7

	)

133 
	sëhhdr
 {

134 
	mh_de°
[
ETH_ALEN
];

135 
	mh_sour˚
[
ETH_ALEN
];

136 
__be16
 
	mh_¥Ÿo
;

137 } 
__©åibuã__
((
∑cked
));

	@/usr/include/linux/if_link.h

1 #i‚de‡
_LINUX_IF_LINK_H


2 
	#_LINUX_IF_LINK_H


	)

4 
	~<löux/ty≥s.h
>

5 
	~<löux/√éök.h
>

8 
	sπ∆_lök_°©s
 {

9 
__u32
 
	mrx_∑ckës
;

10 
__u32
 
	mtx_∑ckës
;

11 
__u32
 
	mrx_byãs
;

12 
__u32
 
	mtx_byãs
;

13 
__u32
 
	mrx_îr‹s
;

14 
__u32
 
	mtx_îr‹s
;

15 
__u32
 
	mrx_dr›≥d
;

16 
__u32
 
	mtx_dr›≥d
;

17 
__u32
 
	mmu…iˇ°
;

18 
__u32
 
	mcﬁlisi⁄s
;

21 
__u32
 
	mrx_Àngth_îr‹s
;

22 
__u32
 
	mrx_ovî_îr‹s
;

23 
__u32
 
	mrx_¸c_îr‹s
;

24 
__u32
 
	mrx_‰ame_îr‹s
;

25 
__u32
 
	mrx_fifo_îr‹s
;

26 
__u32
 
	mrx_mis£d_îr‹s
;

29 
__u32
 
	mtx_ab‹ãd_îr‹s
;

30 
__u32
 
	mtx_ˇºõr_îr‹s
;

31 
__u32
 
	mtx_fifo_îr‹s
;

32 
__u32
 
	mtx_hóπbót_îr‹s
;

33 
__u32
 
	mtx_wödow_îr‹s
;

36 
__u32
 
	mrx_com¥es£d
;

37 
__u32
 
	mtx_com¥es£d
;

41 
	sπ∆_lök_°©s64
 {

42 
__u64
 
	mrx_∑ckës
;

43 
__u64
 
	mtx_∑ckës
;

44 
__u64
 
	mrx_byãs
;

45 
__u64
 
	mtx_byãs
;

46 
__u64
 
	mrx_îr‹s
;

47 
__u64
 
	mtx_îr‹s
;

48 
__u64
 
	mrx_dr›≥d
;

49 
__u64
 
	mtx_dr›≥d
;

50 
__u64
 
	mmu…iˇ°
;

51 
__u64
 
	mcﬁlisi⁄s
;

54 
__u64
 
	mrx_Àngth_îr‹s
;

55 
__u64
 
	mrx_ovî_îr‹s
;

56 
__u64
 
	mrx_¸c_îr‹s
;

57 
__u64
 
	mrx_‰ame_îr‹s
;

58 
__u64
 
	mrx_fifo_îr‹s
;

59 
__u64
 
	mrx_mis£d_îr‹s
;

62 
__u64
 
	mtx_ab‹ãd_îr‹s
;

63 
__u64
 
	mtx_ˇºõr_îr‹s
;

64 
__u64
 
	mtx_fifo_îr‹s
;

65 
__u64
 
	mtx_hóπbót_îr‹s
;

66 
__u64
 
	mtx_wödow_îr‹s
;

69 
__u64
 
	mrx_com¥es£d
;

70 
__u64
 
	mtx_com¥es£d
;

74 
	sπ∆_lök_ifm≠
 {

75 
__u64
 
	mmem_°¨t
;

76 
__u64
 
	mmem_íd
;

77 
__u64
 
	mba£_addr
;

78 
__u16
 
	múq
;

79 
__u8
 
	mdma
;

80 
__u8
 
	mp‹t
;

102 
	mIFLA_UNSPEC
,

103 
	mIFLA_ADDRESS
,

104 
	mIFLA_BROADCAST
,

105 
	mIFLA_IFNAME
,

106 
	mIFLA_MTU
,

107 
	mIFLA_LINK
,

108 
	mIFLA_QDISC
,

109 
	mIFLA_STATS
,

110 
	mIFLA_COST
,

111 
	#IFLA_COST
 
IFLA_COST


	)

112 
	mIFLA_PRIORITY
,

113 
	#IFLA_PRIORITY
 
IFLA_PRIORITY


	)

114 
	mIFLA_MASTER
,

115 
	#IFLA_MASTER
 
IFLA_MASTER


	)

116 
	mIFLA_WIRELESS
,

117 
	#IFLA_WIRELESS
 
IFLA_WIRELESS


	)

118 
	mIFLA_PROTINFO
,

119 
	#IFLA_PROTINFO
 
IFLA_PROTINFO


	)

120 
	mIFLA_TXQLEN
,

121 
	#IFLA_TXQLEN
 
IFLA_TXQLEN


	)

122 
	mIFLA_MAP
,

123 
	#IFLA_MAP
 
IFLA_MAP


	)

124 
	mIFLA_WEIGHT
,

125 
	#IFLA_WEIGHT
 
IFLA_WEIGHT


	)

126 
	mIFLA_OPERSTATE
,

127 
	mIFLA_LINKMODE
,

128 
	mIFLA_LINKINFO
,

129 
	#IFLA_LINKINFO
 
IFLA_LINKINFO


	)

130 
	mIFLA_NET_NS_PID
,

131 
	mIFLA_IFALIAS
,

132 
	mIFLA_NUM_VF
,

133 
	mIFLA_VFINFO_LIST
,

134 
	mIFLA_STATS64
,

135 
	mIFLA_VF_PORTS
,

136 
	mIFLA_PORT_SELF
,

137 
	mIFLA_AF_SPEC
,

138 
	mIFLA_GROUP
,

139 
	mIFLA_NET_NS_FD
,

140 
	mIFLA_EXT_MASK
,

141 
	mIFLA_PROMISCUITY
,

142 
	#IFLA_PROMISCUITY
 
IFLA_PROMISCUITY


	)

143 
	mIFLA_NUM_TX_QUEUES
,

144 
	mIFLA_NUM_RX_QUEUES
,

145 
	mIFLA_CARRIER
,

146 
	m__IFLA_MAX


150 
	#IFLA_MAX
 (
__IFLA_MAX
 - 1)

	)

153 
	#IFLA_RTA
(
r
Ë((
π©å
*)(((*)‘)Ë+ 
	`NLMSG_ALIGN
((
iföfomsg
))))

	)

154 
	#IFLA_PAYLOAD
(
n
Ë
	`NLMSG_PAYLOAD
“,(
iföfomsg
))

	)

157 
	mIFLA_INET_UNSPEC
,

158 
	mIFLA_INET_CONF
,

159 
	m__IFLA_INET_MAX
,

162 
	#IFLA_INET_MAX
 (
__IFLA_INET_MAX
 - 1)

	)

195 
	mIFLA_INET6_UNSPEC
,

196 
	mIFLA_INET6_FLAGS
,

197 
	mIFLA_INET6_CONF
,

198 
	mIFLA_INET6_STATS
,

199 
	mIFLA_INET6_MCAST
,

200 
	mIFLA_INET6_CACHEINFO
,

201 
	mIFLA_INET6_ICMP6STATS
,

202 
	mIFLA_INET6_TOKEN
,

203 
	m__IFLA_INET6_MAX


206 
	#IFLA_INET6_MAX
 (
__IFLA_INET6_MAX
 - 1)

	)

209 
	mBRIDGE_MODE_UNSPEC
,

210 
	mBRIDGE_MODE_HAIRPIN
,

214 
	mIFLA_BRPORT_UNSPEC
,

215 
	mIFLA_BRPORT_STATE
,

216 
	mIFLA_BRPORT_PRIORITY
,

217 
	mIFLA_BRPORT_COST
,

218 
	mIFLA_BRPORT_MODE
,

219 
	mIFLA_BRPORT_GUARD
,

220 
	mIFLA_BRPORT_PROTECT
,

221 
	mIFLA_BRPORT_FAST_LEAVE
,

222 
	mIFLA_BRPORT_LEARNING
,

223 
	mIFLA_BRPORT_UNICAST_FLOOD
,

224 
	m__IFLA_BRPORT_MAX


226 
	#IFLA_BRPORT_MAX
 (
__IFLA_BRPORT_MAX
 - 1)

	)

228 
	siÊa_ˇcheöfo
 {

229 
__u32
 
	mmax_ªasm_Àn
;

230 
__u32
 
	mt°amp
;

231 
__u32
 
	mªachabÀ_time
;

232 
__u32
 
	mªå™s_time
;

236 
	mIFLA_INFO_UNSPEC
,

237 
	mIFLA_INFO_KIND
,

238 
	mIFLA_INFO_DATA
,

239 
	mIFLA_INFO_XSTATS
,

240 
	m__IFLA_INFO_MAX
,

243 
	#IFLA_INFO_MAX
 (
__IFLA_INFO_MAX
 - 1)

	)

248 
	mIFLA_VLAN_UNSPEC
,

249 
	mIFLA_VLAN_ID
,

250 
	mIFLA_VLAN_FLAGS
,

251 
	mIFLA_VLAN_EGRESS_QOS
,

252 
	mIFLA_VLAN_INGRESS_QOS
,

253 
	mIFLA_VLAN_PROTOCOL
,

254 
	m__IFLA_VLAN_MAX
,

257 
	#IFLA_VLAN_MAX
 (
__IFLA_VLAN_MAX
 - 1)

	)

259 
	siÊa_vœn_Êags
 {

260 
__u32
 
	mÊags
;

261 
__u32
 
	mmask
;

265 
	mIFLA_VLAN_QOS_UNSPEC
,

266 
	mIFLA_VLAN_QOS_MAPPING
,

267 
	m__IFLA_VLAN_QOS_MAX


270 
	#IFLA_VLAN_QOS_MAX
 (
__IFLA_VLAN_QOS_MAX
 - 1)

	)

272 
	siÊa_vœn_qos_m≠pög
 {

273 
__u32
 
	m‰om
;

274 
__u32
 
	mto
;

279 
	mIFLA_MACVLAN_UNSPEC
,

280 
	mIFLA_MACVLAN_MODE
,

281 
	mIFLA_MACVLAN_FLAGS
,

282 
	m__IFLA_MACVLAN_MAX
,

285 
	#IFLA_MACVLAN_MAX
 (
__IFLA_MACVLAN_MAX
 - 1)

	)

287 
	emacvœn_mode
 {

288 
	mMACVLAN_MODE_PRIVATE
 = 1,

289 
	mMACVLAN_MODE_VEPA
 = 2,

290 
	mMACVLAN_MODE_BRIDGE
 = 4,

291 
	mMACVLAN_MODE_PASSTHRU
 = 8,

294 
	#MACVLAN_FLAG_NOPROMISC
 1

	)

298 
	mIFLA_VXLAN_UNSPEC
,

299 
	mIFLA_VXLAN_ID
,

300 
	mIFLA_VXLAN_GROUP
,

301 
	mIFLA_VXLAN_LINK
,

302 
	mIFLA_VXLAN_LOCAL
,

303 
	mIFLA_VXLAN_TTL
,

304 
	mIFLA_VXLAN_TOS
,

305 
	mIFLA_VXLAN_LEARNING
,

306 
	mIFLA_VXLAN_AGEING
,

307 
	mIFLA_VXLAN_LIMIT
,

308 
	mIFLA_VXLAN_PORT_RANGE
,

309 
	mIFLA_VXLAN_PROXY
,

310 
	mIFLA_VXLAN_RSC
,

311 
	mIFLA_VXLAN_L2MISS
,

312 
	mIFLA_VXLAN_L3MISS
,

313 
	mIFLA_VXLAN_PORT
,

314 
	m__IFLA_VXLAN_MAX


316 
	#IFLA_VXLAN_MAX
 (
__IFLA_VXLAN_MAX
 - 1)

	)

318 
	siÊa_vxœn_p‹t_ønge
 {

319 
__be16
 
	mlow
;

320 
__be16
 
	mhigh
;

326 
	mIFLA_VF_INFO_UNSPEC
,

327 
	mIFLA_VF_INFO
,

328 
	m__IFLA_VF_INFO_MAX
,

331 
	#IFLA_VF_INFO_MAX
 (
__IFLA_VF_INFO_MAX
 - 1)

	)

334 
	mIFLA_VF_UNSPEC
,

335 
	mIFLA_VF_MAC
,

336 
	mIFLA_VF_VLAN
,

337 
	mIFLA_VF_TX_RATE
,

338 
	mIFLA_VF_SPOOFCHK
,

339 
	mIFLA_VF_LINK_STATE
,

340 
	m__IFLA_VF_MAX
,

343 
	#IFLA_VF_MAX
 (
__IFLA_VF_MAX
 - 1)

	)

345 
	siÊa_vf_mac
 {

346 
__u32
 
	mvf
;

347 
__u8
 
	mmac
[32];

350 
	siÊa_vf_vœn
 {

351 
__u32
 
	mvf
;

352 
__u32
 
	mvœn
;

353 
__u32
 
	mqos
;

356 
	siÊa_vf_tx_øã
 {

357 
__u32
 
	mvf
;

358 
__u32
 
	møã
;

361 
	siÊa_vf_•oofchk
 {

362 
__u32
 
	mvf
;

363 
__u32
 
	m£âög
;

367 
	mIFLA_VF_LINK_STATE_AUTO
,

368 
	mIFLA_VF_LINK_STATE_ENABLE
,

369 
	mIFLA_VF_LINK_STATE_DISABLE
,

370 
	m__IFLA_VF_LINK_STATE_MAX
,

373 
	siÊa_vf_lök_°©e
 {

374 
__u32
 
	mvf
;

375 
__u32
 
	mlök_°©e
;

394 
	mIFLA_VF_PORT_UNSPEC
,

395 
	mIFLA_VF_PORT
,

396 
	m__IFLA_VF_PORT_MAX
,

399 
	#IFLA_VF_PORT_MAX
 (
__IFLA_VF_PORT_MAX
 - 1)

	)

402 
	mIFLA_PORT_UNSPEC
,

403 
	mIFLA_PORT_VF
,

404 
	mIFLA_PORT_PROFILE
,

405 
	mIFLA_PORT_VSI_TYPE
,

406 
	mIFLA_PORT_INSTANCE_UUID
,

407 
	mIFLA_PORT_HOST_UUID
,

408 
	mIFLA_PORT_REQUEST
,

409 
	mIFLA_PORT_RESPONSE
,

410 
	m__IFLA_PORT_MAX
,

413 
	#IFLA_PORT_MAX
 (
__IFLA_PORT_MAX
 - 1)

	)

415 
	#PORT_PROFILE_MAX
 40

	)

416 
	#PORT_UUID_MAX
 16

	)

417 
	#PORT_SELF_VF
 -1

	)

420 
	mPORT_REQUEST_PREASSOCIATE
 = 0,

421 
	mPORT_REQUEST_PREASSOCIATE_RR
,

422 
	mPORT_REQUEST_ASSOCIATE
,

423 
	mPORT_REQUEST_DISASSOCIATE
,

427 
	mPORT_VDP_RESPONSE_SUCCESS
 = 0,

428 
	mPORT_VDP_RESPONSE_INVALID_FORMAT
,

429 
	mPORT_VDP_RESPONSE_INSUFFICIENT_RESOURCES
,

430 
	mPORT_VDP_RESPONSE_UNUSED_VTID
,

431 
	mPORT_VDP_RESPONSE_VTID_VIOLATION
,

432 
	mPORT_VDP_RESPONSE_VTID_VERSION_VIOALTION
,

433 
	mPORT_VDP_RESPONSE_OUT_OF_SYNC
,

435 
	mPORT_PROFILE_RESPONSE_SUCCESS
 = 0x100,

436 
	mPORT_PROFILE_RESPONSE_INPROGRESS
,

437 
	mPORT_PROFILE_RESPONSE_INVALID
,

438 
	mPORT_PROFILE_RESPONSE_BADSTATE
,

439 
	mPORT_PROFILE_RESPONSE_INSUFFICIENT_RESOURCES
,

440 
	mPORT_PROFILE_RESPONSE_ERROR
,

443 
	siÊa_p‹t_vsi
 {

444 
__u8
 
	mvsi_mgr_id
;

445 
__u8
 
	mvsi_ty≥_id
[3];

446 
__u8
 
	mvsi_ty≥_vîsi⁄
;

447 
__u8
 
	m∑d
[3];

454 
	mIFLA_IPOIB_UNSPEC
,

455 
	mIFLA_IPOIB_PKEY
,

456 
	mIFLA_IPOIB_MODE
,

457 
	mIFLA_IPOIB_UMCAST
,

458 
	m__IFLA_IPOIB_MAX


462 
	mIPOIB_MODE_DATAGRAM
 = 0,

463 
	mIPOIB_MODE_CONNECTED
 = 1,

466 
	#IFLA_IPOIB_MAX
 (
__IFLA_IPOIB_MAX
 - 1)

	)

	@/usr/include/linux/neighbour.h

1 #i‚de‡
__LINUX_NEIGHBOUR_H


2 
	#__LINUX_NEIGHBOUR_H


	)

4 
	~<löux/ty≥s.h
>

5 
	~<löux/√éök.h
>

7 
	sndmsg
 {

8 
__u8
 
	mndm_Ámûy
;

9 
__u8
 
	mndm_∑d1
;

10 
__u16
 
	mndm_∑d2
;

11 
__s32
 
	mndm_ifödex
;

12 
__u16
 
	mndm_°©e
;

13 
__u8
 
	mndm_Êags
;

14 
__u8
 
	mndm_ty≥
;

18 
	mNDA_UNSPEC
,

19 
	mNDA_DST
,

20 
	mNDA_LLADDR
,

21 
	mNDA_CACHEINFO
,

22 
	mNDA_PROBES
,

23 
	mNDA_VLAN
,

24 
	mNDA_PORT
,

25 
	mNDA_VNI
,

26 
	mNDA_IFINDEX
,

27 
	m__NDA_MAX


30 
	#NDA_MAX
 (
__NDA_MAX
 - 1)

	)

36 
	#NTF_USE
 0x01

	)

37 
	#NTF_PROXY
 0x08

	)

38 
	#NTF_ROUTER
 0x80

	)

40 
	#NTF_SELF
 0x02

	)

41 
	#NTF_MASTER
 0x04

	)

47 
	#NUD_INCOMPLETE
 0x01

	)

48 
	#NUD_REACHABLE
 0x02

	)

49 
	#NUD_STALE
 0x04

	)

50 
	#NUD_DELAY
 0x08

	)

51 
	#NUD_PROBE
 0x10

	)

52 
	#NUD_FAILED
 0x20

	)

55 
	#NUD_NOARP
 0x40

	)

56 
	#NUD_PERMANENT
 0x80

	)

57 
	#NUD_NONE
 0x00

	)

64 
	snda_ˇcheöfo
 {

65 
__u32
 
	mndm_c⁄fúmed
;

66 
__u32
 
	mndm_u£d
;

67 
__u32
 
	mndm_upd©ed
;

68 
__u32
 
	mndm_ªf˙t
;

96 
	sndt_°©s
 {

97 
__u64
 
	mndts_Ælocs
;

98 
__u64
 
	mndts_de°roys
;

99 
__u64
 
	mndts_hash_grows
;

100 
__u64
 
	mndts_ªs_Áûed
;

101 
__u64
 
	mndts_lookups
;

102 
__u64
 
	mndts_hôs
;

103 
__u64
 
	mndts_rcv_¥obes_mˇ°
;

104 
__u64
 
	mndts_rcv_¥obes_uˇ°
;

105 
__u64
 
	mndts_≥riodic_gc_runs
;

106 
__u64
 
	mndts_f‹˚d_gc_runs
;

110 
	mNDTPA_UNSPEC
,

111 
	mNDTPA_IFINDEX
,

112 
	mNDTPA_REFCNT
,

113 
	mNDTPA_REACHABLE_TIME
,

114 
	mNDTPA_BASE_REACHABLE_TIME
,

115 
	mNDTPA_RETRANS_TIME
,

116 
	mNDTPA_GC_STALETIME
,

117 
	mNDTPA_DELAY_PROBE_TIME
,

118 
	mNDTPA_QUEUE_LEN
,

119 
	mNDTPA_APP_PROBES
,

120 
	mNDTPA_UCAST_PROBES
,

121 
	mNDTPA_MCAST_PROBES
,

122 
	mNDTPA_ANYCAST_DELAY
,

123 
	mNDTPA_PROXY_DELAY
,

124 
	mNDTPA_PROXY_QLEN
,

125 
	mNDTPA_LOCKTIME
,

126 
	mNDTPA_QUEUE_LENBYTES
,

127 
	m__NDTPA_MAX


129 
	#NDTPA_MAX
 (
__NDTPA_MAX
 - 1)

	)

131 
	sndtmsg
 {

132 
__u8
 
	mndtm_Ámûy
;

133 
__u8
 
	mndtm_∑d1
;

134 
__u16
 
	mndtm_∑d2
;

137 
	sndt_c⁄fig
 {

138 
__u16
 
	mndtc_key_Àn
;

139 
__u16
 
	mndtc_íåy_size
;

140 
__u32
 
	mndtc_íåõs
;

141 
__u32
 
	mndtc_œ°_Êush
;

142 
__u32
 
	mndtc_œ°_ønd
;

143 
__u32
 
	mndtc_hash_∫d
;

144 
__u32
 
	mndtc_hash_mask
;

145 
__u32
 
	mndtc_hash_chaö_gc
;

146 
__u32
 
	mndtc_¥oxy_qÀn
;

150 
	mNDTA_UNSPEC
,

151 
	mNDTA_NAME
,

152 
	mNDTA_THRESH1
,

153 
	mNDTA_THRESH2
,

154 
	mNDTA_THRESH3
,

155 
	mNDTA_CONFIG
,

156 
	mNDTA_PARMS
,

157 
	mNDTA_STATS
,

158 
	mNDTA_GC_INTERVAL
,

159 
	m__NDTA_MAX


161 
	#NDTA_MAX
 (
__NDTA_MAX
 - 1)

	)

	@/usr/include/linux/netlink.h

1 #i‚de‡
__LINUX_NETLINK_H


2 
	#__LINUX_NETLINK_H


	)

4 
	~<löux/kî√l.h
>

5 
	~<löux/sockë.h
>

6 
	~<löux/ty≥s.h
>

8 
	#NETLINK_ROUTE
 0

	)

9 
	#NETLINK_UNUSED
 1

	)

10 
	#NETLINK_USERSOCK
 2

	)

11 
	#NETLINK_FIREWALL
 3

	)

12 
	#NETLINK_SOCK_DIAG
 4

	)

13 
	#NETLINK_NFLOG
 5

	)

14 
	#NETLINK_XFRM
 6

	)

15 
	#NETLINK_SELINUX
 7

	)

16 
	#NETLINK_ISCSI
 8

	)

17 
	#NETLINK_AUDIT
 9

	)

18 
	#NETLINK_FIB_LOOKUP
 10

	)

19 
	#NETLINK_CONNECTOR
 11

	)

20 
	#NETLINK_NETFILTER
 12

	)

21 
	#NETLINK_IP6_FW
 13

	)

22 
	#NETLINK_DNRTMSG
 14

	)

23 
	#NETLINK_KOBJECT_UEVENT
 15

	)

24 
	#NETLINK_GENERIC
 16

	)

26 
	#NETLINK_SCSITRANSPORT
 18

	)

27 
	#NETLINK_ECRYPTFS
 19

	)

28 
	#NETLINK_RDMA
 20

	)

29 
	#NETLINK_CRYPTO
 21

	)

31 
	#NETLINK_INET_DIAG
 
NETLINK_SOCK_DIAG


	)

33 
	#MAX_LINKS
 32

	)

35 
	ssockaddr_∆
 {

36 
__kî√l_ß_Ámûy_t
 
	m∆_Ámûy
;

37 
	m∆_∑d
;

38 
__u32
 
	m∆_pid
;

39 
__u32
 
	m∆_groups
;

42 
	s∆msghdr
 {

43 
__u32
 
	m∆msg_Àn
;

44 
__u16
 
	m∆msg_ty≥
;

45 
__u16
 
	m∆msg_Êags
;

46 
__u32
 
	m∆msg_£q
;

47 
__u32
 
	m∆msg_pid
;

52 
	#NLM_F_REQUEST
 1

	)

53 
	#NLM_F_MULTI
 2

	)

54 
	#NLM_F_ACK
 4

	)

55 
	#NLM_F_ECHO
 8

	)

56 
	#NLM_F_DUMP_INTR
 16

	)

59 
	#NLM_F_ROOT
 0x100

	)

60 
	#NLM_F_MATCH
 0x200

	)

61 
	#NLM_F_ATOMIC
 0x400

	)

62 
	#NLM_F_DUMP
 (
NLM_F_ROOT
|
NLM_F_MATCH
)

	)

65 
	#NLM_F_REPLACE
 0x100

	)

66 
	#NLM_F_EXCL
 0x200

	)

67 
	#NLM_F_CREATE
 0x400

	)

68 
	#NLM_F_APPEND
 0x800

	)

79 
	#NLMSG_ALIGNTO
 4U

	)

80 
	#NLMSG_ALIGN
(
Àn
Ë–(÷í)+
NLMSG_ALIGNTO
-1Ë& ~(NLMSG_ALIGNTO-1Ë)

	)

81 
	#NLMSG_HDRLEN
 ((Ë
	`NLMSG_ALIGN
((
∆msghdr
)))

	)

82 
	#NLMSG_LENGTH
(
Àn
Ë(÷íË+ 
NLMSG_HDRLEN
)

	)

83 
	#NLMSG_SPACE
(
Àn
Ë
	`NLMSG_ALIGN
(
	`NLMSG_LENGTH
÷í))

	)

84 
	#NLMSG_DATA
(
∆h
Ë((*)(((*ÍlhË+ 
	`NLMSG_LENGTH
(0)))

	)

85 
	#NLMSG_NEXT
(
∆h
,
Àn
Ë(÷íË-
	`NLMSG_ALIGN
(“lh)->
∆msg_Àn
), \

86 (
∆msghdr
*)(((*)(
∆h
)Ë+ 
	`NLMSG_ALIGN
(“lh)->
∆msg_Àn
)))

	)

87 
	#NLMSG_OK
(
∆h
,
Àn
Ë(÷íË>()(
∆msghdr
) && \

88 (
∆h
)->
∆msg_Àn
 >(
∆msghdr
) && \

89 (
∆h
)->
∆msg_Àn
 <(
Àn
))

	)

90 
	#NLMSG_PAYLOAD
(
∆h
,
Àn
Ë(“lh)->
∆msg_Àn
 - 
	`NLMSG_SPACE
(÷í)))

	)

92 
	#NLMSG_NOOP
 0x1

	)

93 
	#NLMSG_ERROR
 0x2

	)

94 
	#NLMSG_DONE
 0x3

	)

95 
	#NLMSG_OVERRUN
 0x4

	)

97 
	#NLMSG_MIN_TYPE
 0x10

	)

99 
	s∆msgîr
 {

100 
	mîr‹
;

101 
∆msghdr
 
	mmsg
;

104 
	#NETLINK_ADD_MEMBERSHIP
 1

	)

105 
	#NETLINK_DROP_MEMBERSHIP
 2

	)

106 
	#NETLINK_PKTINFO
 3

	)

107 
	#NETLINK_BROADCAST_ERROR
 4

	)

108 
	#NETLINK_NO_ENOBUFS
 5

	)

109 
	#NETLINK_RX_RING
 6

	)

110 
	#NETLINK_TX_RING
 7

	)

112 
	s∆_pktöfo
 {

113 
__u32
 
	mgroup
;

116 
	s∆_mm≠_ªq
 {

117 
	mnm_block_size
;

118 
	mnm_block_ƒ
;

119 
	mnm_‰ame_size
;

120 
	mnm_‰ame_ƒ
;

123 
	s∆_mm≠_hdr
 {

124 
	mnm_°©us
;

125 
	mnm_Àn
;

126 
__u32
 
	mnm_group
;

128 
__u32
 
	mnm_pid
;

129 
__u32
 
	mnm_uid
;

130 
__u32
 
	mnm_gid
;

133 
	e∆_mm≠_°©us
 {

134 
	mNL_MMAP_STATUS_UNUSED
,

135 
	mNL_MMAP_STATUS_RESERVED
,

136 
	mNL_MMAP_STATUS_VALID
,

137 
	mNL_MMAP_STATUS_COPY
,

138 
	mNL_MMAP_STATUS_SKIP
,

141 
	#NL_MMAP_MSG_ALIGNMENT
 
NLMSG_ALIGNTO


	)

142 
	#NL_MMAP_MSG_ALIGN
(
sz
Ë
	`__ALIGN_KERNEL
(sz, 
NL_MMAP_MSG_ALIGNMENT
)

	)

143 
	#NL_MMAP_HDRLEN
 
	`NL_MMAP_MSG_ALIGN
((
∆_mm≠_hdr
))

	)

145 
	#NET_MAJOR
 36

	)

148 
	mNETLINK_UNCONNECTED
 = 0,

149 
	mNETLINK_CONNECTED
,

161 
	s∆©å
 {

162 
__u16
 
	m∆a_Àn
;

163 
__u16
 
	m∆a_ty≥
;

176 
	#NLA_F_NESTED
 (1 << 15)

	)

177 
	#NLA_F_NET_BYTEORDER
 (1 << 14)

	)

178 
	#NLA_TYPE_MASK
 ~(
NLA_F_NESTED
 | 
NLA_F_NET_BYTEORDER
)

	)

180 
	#NLA_ALIGNTO
 4

	)

181 
	#NLA_ALIGN
(
Àn
Ë((÷íË+ 
NLA_ALIGNTO
 - 1Ë& ~(NLA_ALIGNTO - 1))

	)

182 
	#NLA_HDRLEN
 ((Ë
	`NLA_ALIGN
((
∆©å
)))

	)

	@/usr/include/linux/posix_types.h

1 #i‚de‡
_LINUX_POSIX_TYPES_H


2 
	#_LINUX_POSIX_TYPES_H


	)

4 
	~<löux/°ddef.h
>

21 #unde‡
__FD_SETSIZE


22 
	#__FD_SETSIZE
 1024

	)

25 
	mfds_bôs
[
__FD_SETSIZE
 / (8 * ())];

26 } 
	t__kî√l_fd_£t
;

29 (*
	t__kî√l_sigh™dÀr_t
)();

32 
	t__kî√l_key_t
;

33 
	t__kî√l_mqd_t
;

35 
	~<asm/posix_ty≥s.h
>

	@/usr/include/pcap/pcap.h

37 #i‚de‡
lib_pˇp_pˇp_h


38 
	#lib_pˇp_pˇp_h


	)

40 #i‡
deföed
(
WIN32
)

41 
	~<pˇp-°döc.h
>

42 #ñi‡
deföed
(
MSDOS
)

43 
	~<sys/ty≥s.h
>

44 
	~<sys/sockë.h
>

46 
	~<sys/ty≥s.h
>

47 
	~<sys/time.h
>

50 #i‚de‡
PCAP_DONT_INCLUDE_PCAP_BPF_H


51 
	~<pˇp/bpf.h
>

54 
	~<°dio.h
>

56 #ifde‡
__˝lu•lus


67 
	#PCAP_VERSION_MAJOR
 2

	)

68 
	#PCAP_VERSION_MINOR
 4

	)

70 
	#PCAP_ERRBUF_SIZE
 256

	)

76 #i‡
BPF_RELEASE
 - 0 < 199406

77 
	tbpf_öt32
;

78 
u_öt
 
	tbpf_u_öt32
;

81 
pˇp
 
	tpˇp_t
;

82 
pˇp_dum≥r
 
	tpˇp_dum≥r_t
;

83 
pˇp_if
 
	tpˇp_if_t
;

84 
pˇp_addr
 
	tpˇp_addr_t
;

124 
	spˇp_fûe_hódî
 {

125 
bpf_u_öt32
 
magic
;

126 
u_sh‹t
 
vîsi⁄_maj‹
;

127 
u_sh‹t
 
vîsi⁄_mö‹
;

128 
bpf_öt32
 
thisz⁄e
;

129 
bpf_u_öt32
 
sigfigs
;

130 
bpf_u_öt32
 
¢≠Àn
;

131 
bpf_u_öt32
 
lökty≥
;

140 
	#LT_FCS_LENGTH_PRESENT
(
x
Ë((xË& 0x04000000)

	)

141 
	#LT_FCS_LENGTH
(
x
Ë(((xË& 0xF0000000Ë>> 28)

	)

142 
	#LT_FCS_DATALINK_EXT
(
x
Ë((((xË& 0xFË<< 28Ë| 0x04000000)

	)

145 
PCAP_D_INOUT
 = 0,

146 
PCAP_D_IN
,

147 
PCAP_D_OUT


148 } 
	tpˇp_dúe˘i⁄_t
;

162 
	spˇp_pkthdr
 {

163 
timevÆ
 
ts
;

164 
bpf_u_öt32
 
ˇ∂í
;

165 
bpf_u_öt32
 
Àn
;

171 
	spˇp_°©
 {

172 
u_öt
 
ps_ªcv
;

173 
u_öt
 
ps_dr›
;

174 
u_öt
 
ps_ifdr›
;

175 #ifde‡
WIN32


176 
u_öt
 
bs_ˇ±
;

180 #ifde‡
MSDOS


184 
	spˇp_°©_ex
 {

185 
u_l⁄g
 
rx_∑ckës
;

186 
u_l⁄g
 
tx_∑ckës
;

187 
u_l⁄g
 
rx_byãs
;

188 
u_l⁄g
 
tx_byãs
;

189 
u_l⁄g
 
rx_îr‹s
;

190 
u_l⁄g
 
tx_îr‹s
;

191 
u_l⁄g
 
rx_dr›≥d
;

192 
u_l⁄g
 
tx_dr›≥d
;

193 
u_l⁄g
 
mu…iˇ°
;

194 
u_l⁄g
 
cﬁlisi⁄s
;

197 
u_l⁄g
 
rx_Àngth_îr‹s
;

198 
u_l⁄g
 
rx_ovî_îr‹s
;

199 
u_l⁄g
 
rx_¸c_îr‹s
;

200 
u_l⁄g
 
rx_‰ame_îr‹s
;

201 
u_l⁄g
 
rx_fifo_îr‹s
;

202 
u_l⁄g
 
rx_mis£d_îr‹s
;

205 
u_l⁄g
 
tx_ab‹ãd_îr‹s
;

206 
u_l⁄g
 
tx_ˇºõr_îr‹s
;

207 
u_l⁄g
 
tx_fifo_îr‹s
;

208 
u_l⁄g
 
tx_hóπbót_îr‹s
;

209 
u_l⁄g
 
tx_wödow_îr‹s
;

216 
	spˇp_if
 {

217 
pˇp_if
 *
√xt
;

218 *
«me
;

219 *
des¸ùti⁄
;

220 
pˇp_addr
 *
addªs£s
;

221 
bpf_u_öt32
 
Êags
;

224 
	#PCAP_IF_LOOPBACK
 0x00000001

	)

229 
	spˇp_addr
 {

230 
pˇp_addr
 *
√xt
;

231 
sockaddr
 *
addr
;

232 
sockaddr
 *
√tmask
;

233 
sockaddr
 *
brﬂdaddr
;

234 
sockaddr
 *
d°addr
;

237 (*
pˇp_h™dÀr
)(
	tu_ch¨
 *, c⁄° 
	tpˇp_pkthdr
 *,

238 c⁄° 
	tu_ch¨
 *);

246 
	#PCAP_ERROR
 -1

	)

247 
	#PCAP_ERROR_BREAK
 -2

	)

248 
	#PCAP_ERROR_NOT_ACTIVATED
 -3

	)

249 
	#PCAP_ERROR_ACTIVATED
 -4

	)

250 
	#PCAP_ERROR_NO_SUCH_DEVICE
 -5

	)

251 
	#PCAP_ERROR_RFMON_NOTSUP
 -6

	)

252 
	#PCAP_ERROR_NOT_RFMON
 -7

	)

253 
	#PCAP_ERROR_PERM_DENIED
 -8

	)

254 
	#PCAP_ERROR_IFACE_NOT_UP
 -9

	)

255 
	#PCAP_ERROR_CANTSET_TSTAMP_TYPE
 -10

	)

256 
	#PCAP_ERROR_PROMISC_PERM_DENIED
 -11

	)

263 
	#PCAP_WARNING
 1

	)

264 
	#PCAP_WARNING_PROMISC_NOTSUP
 2

	)

265 
	#PCAP_WARNING_TSTAMP_TYPE_NOTSUP
 3

	)

271 
	#PCAP_NETMASK_UNKNOWN
 0xffffffff

	)

273 *
pˇp_lookupdev
(*);

274 
pˇp_looku≤ë
(c⁄° *, 
bpf_u_öt32
 *, bpf_u_int32 *, *);

276 
pˇp_t
 *
pˇp_¸óã
(const *, *);

277 
pˇp_£t_¢≠Àn
(
pˇp_t
 *, );

278 
pˇp_£t_¥omisc
(
pˇp_t
 *, );

279 
pˇp_ˇn_£t_rfm⁄
(
pˇp_t
 *);

280 
pˇp_£t_rfm⁄
(
pˇp_t
 *, );

281 
pˇp_£t_timeout
(
pˇp_t
 *, );

282 
pˇp_£t_t°amp_ty≥
(
pˇp_t
 *, );

283 
pˇp_£t_buf„r_size
(
pˇp_t
 *, );

284 
pˇp_a˘iv©e
(
pˇp_t
 *);

286 
pˇp_li°_t°amp_ty≥s
(
pˇp_t
 *, **);

287 
pˇp_‰ì_t°amp_ty≥s
(*);

288 
pˇp_t°amp_ty≥_«me_to_vÆ
(const *);

289 c⁄° *
pˇp_t°amp_ty≥_vÆ_to_«me
();

290 c⁄° *
pˇp_t°amp_ty≥_vÆ_to_des¸ùti⁄
();

330 
	#PCAP_TSTAMP_HOST
 0

	)

331 
	#PCAP_TSTAMP_HOST_LOWPREC
 1

	)

332 
	#PCAP_TSTAMP_HOST_HIPREC
 2

	)

333 
	#PCAP_TSTAMP_ADAPTER
 3

	)

334 
	#PCAP_TSTAMP_ADAPTER_UNSYNCED
 4

	)

336 
pˇp_t
 *
pˇp_›í_live
(const *, , , , *);

337 
pˇp_t
 *
pˇp_›í_dód
(, );

338 
pˇp_t
 *
pˇp_›í_ofÊöe
(const *, *);

339 #i‡
deföed
(
WIN32
)

340 
pˇp_t
 *
pˇp_h›í_ofÊöe
(
öçå_t
, *);

341 #i‡!
deföed
(
LIBPCAP_EXPORTS
)

342 
	#pˇp_f›í_ofÊöe
(
f
,
b
) \

343 
	`pˇp_h›í_ofÊöe
(
	`_gë_osfh™dÀ
(
	`_fûío
(
f
)), 
b
)

	)

345 
pˇp_t
 *
pˇp_f›í_ofÊöe
(
FILE
 *, *);

348 
pˇp_t
 *
pˇp_f›í_ofÊöe
(
FILE
 *, *);

351 
pˇp_˛o£
(
pˇp_t
 *);

352 
pˇp_lo›
(
pˇp_t
 *, , 
pˇp_h™dÀr
, 
u_ch¨
 *);

353 
pˇp_di•©ch
(
pˇp_t
 *, , 
pˇp_h™dÀr
, 
u_ch¨
 *);

354 c⁄° 
u_ch¨
*

355 
pˇp_√xt
(
pˇp_t
 *, 
pˇp_pkthdr
 *);

356 
pˇp_√xt_ex
(
pˇp_t
 *, 
pˇp_pkthdr
 **, c⁄° 
u_ch¨
 **);

357 
pˇp_bªaklo›
(
pˇp_t
 *);

358 
pˇp_°©s
(
pˇp_t
 *, 
pˇp_°©
 *);

359 
pˇp_£tfûãr
(
pˇp_t
 *, 
bpf_¥ogøm
 *);

360 
pˇp_£tdúe˘i⁄
(
pˇp_t
 *, 
pˇp_dúe˘i⁄_t
);

361 
pˇp_gën⁄block
(
pˇp_t
 *, *);

362 
pˇp_£ä⁄block
(
pˇp_t
 *, , *);

363 
pˇp_öje˘
(
pˇp_t
 *, c⁄° *, 
size_t
);

364 
pˇp_£nd∑ckë
(
pˇp_t
 *, c⁄° 
u_ch¨
 *, );

365 c⁄° *
pˇp_°©u°o°r
();

366 c⁄° *
pˇp_°ªº‹
();

367 *
pˇp_gëîr
(
pˇp_t
 *);

368 
pˇp_≥º‹
(
pˇp_t
 *, *);

369 
pˇp_compûe
(
pˇp_t
 *, 
bpf_¥ogøm
 *, const *, ,

370 
bpf_u_öt32
);

371 
pˇp_compûe_n›ˇp
(, , 
bpf_¥ogøm
 *,

372 c⁄° *, , 
bpf_u_öt32
);

373 
pˇp_‰ìcode
(
bpf_¥ogøm
 *);

374 
pˇp_ofÊöe_fûãr
(c⁄° 
bpf_¥ogøm
 *,

375 c⁄° 
pˇp_pkthdr
 *, c⁄° 
u_ch¨
 *);

376 
pˇp_d©Æök
(
pˇp_t
 *);

377 
pˇp_d©Æök_ext
(
pˇp_t
 *);

378 
pˇp_li°_d©Æöks
(
pˇp_t
 *, **);

379 
pˇp_£t_d©Æök
(
pˇp_t
 *, );

380 
pˇp_‰ì_d©Æöks
(*);

381 
pˇp_d©Æök_«me_to_vÆ
(const *);

382 c⁄° *
pˇp_d©Æök_vÆ_to_«me
();

383 c⁄° *
pˇp_d©Æök_vÆ_to_des¸ùti⁄
();

384 
pˇp_¢≠shŸ
(
pˇp_t
 *);

385 
pˇp_is_sw≠≥d
(
pˇp_t
 *);

386 
pˇp_maj‹_vîsi⁄
(
pˇp_t
 *);

387 
pˇp_mö‹_vîsi⁄
(
pˇp_t
 *);

390 
FILE
 *
pˇp_fûe
(
pˇp_t
 *);

391 
pˇp_fûío
(
pˇp_t
 *);

393 
pˇp_dum≥r_t
 *
pˇp_dump_›í
(
pˇp_t
 *, const *);

394 
pˇp_dum≥r_t
 *
pˇp_dump_f›í
(
pˇp_t
 *, 
FILE
 *
Â
);

395 
FILE
 *
pˇp_dump_fûe
(
pˇp_dum≥r_t
 *);

396 
pˇp_dump_·ñl
(
pˇp_dum≥r_t
 *);

397 
pˇp_dump_Êush
(
pˇp_dum≥r_t
 *);

398 
pˇp_dump_˛o£
(
pˇp_dum≥r_t
 *);

399 
pˇp_dump
(
u_ch¨
 *, c⁄° 
pˇp_pkthdr
 *, const u_char *);

401 
pˇp_födÆldevs
(
pˇp_if_t
 **, *);

402 
pˇp_‰ìÆldevs
(
pˇp_if_t
 *);

404 c⁄° *
pˇp_lib_vîsi⁄
();

413 #i‚de‡
__NëBSD__


414 
u_öt
 
bpf_fûãr
(c⁄° 
bpf_ö¢
 *, c⁄° 
u_ch¨
 *, u_int, u_int);

416 
bpf_vÆid©e
(c⁄° 
bpf_ö¢
 *
f
, 
Àn
);

417 *
bpf_image
(c⁄° 
bpf_ö¢
 *, );

418 
bpf_dump
(c⁄° 
bpf_¥ogøm
 *, );

420 #i‡
deföed
(
WIN32
)

426 
pˇp_£tbuff
(
pˇp_t
 *
p
, 
dim
);

427 
pˇp_£tmode
(
pˇp_t
 *
p
, 
mode
);

428 
pˇp_£tmötoc›y
(
pˇp_t
 *
p
, 
size
);

430 #ifde‡
WPCAP


432 
	~<Wö32-Exãnsi⁄s.h
>

435 
	#MODE_CAPT
 0

	)

436 
	#MODE_STAT
 1

	)

437 
	#MODE_MON
 2

	)

439 #ñi‡
deföed
(
MSDOS
)

445 
pˇp_°©s_ex
 (
pˇp_t
 *, 
pˇp_°©_ex
 *);

446 
pˇp_£t_waô
 (
pˇp_t
 *
p
, (*
yõld
)(), 
waô
);

447 
u_l⁄g
 
pˇp_mac_∑ckës
 ();

455 
pˇp_gë_£À˘abÀ_fd
(
pˇp_t
 *);

459 #ifde‡
__˝lu•lus


	@/usr/include/rpc/netdb.h

36 #i‚de‡
_RPC_NETDB_H


37 
	#_RPC_NETDB_H
 1

	)

39 
	~<„©uªs.h
>

41 
	#__√ed_size_t


	)

42 
	~<°ddef.h
>

44 
__BEGIN_DECLS


46 
	sΩ˚¡


48 *
	mr_«me
;

49 **
	mr_Æü£s
;

50 
	mr_numbî
;

53 
	$£åp˚¡
 (
__°ay›í
Ë
__THROW
;

54 
	$ídΩ˚¡
 (Ë
__THROW
;

55 
Ω˚¡
 *
	$gëΩcby«me
 (c⁄° *
__«me
Ë
__THROW
;

56 
Ω˚¡
 *
	$gëΩcbynumbî
 (
__numbî
Ë
__THROW
;

57 
Ω˚¡
 *
	$gëΩ˚¡
 (Ë
__THROW
;

59 #ifde‡
__USE_MISC


60 
	$gëΩcby«me_r
 (c⁄° *
__«me
, 
Ω˚¡
 *
__ªsu…_buf
,

61 *
__buf„r
, 
size_t
 
__buÊí
,

62 
Ω˚¡
 **
__ªsu…
Ë
__THROW
;

64 
	$gëΩcbynumbî_r
 (
__numbî
, 
Ω˚¡
 *
__ªsu…_buf
,

65 *
__buf„r
, 
size_t
 
__buÊí
,

66 
Ω˚¡
 **
__ªsu…
Ë
__THROW
;

68 
	$gëΩ˚¡_r
 (
Ω˚¡
 *
__ªsu…_buf
, *
__buf„r
,

69 
size_t
 
__buÊí
, 
Ω˚¡
 **
__ªsu…
Ë
__THROW
;

72 
__END_DECLS


	@/usr/include/sched.h

20 #i‚def 
_SCHED_H


21 
	#_SCHED_H
 1

	)

23 
	~<„©uªs.h
>

26 
	~<bôs/ty≥s.h
>

28 
	#__√ed_size_t


	)

29 
	~<°ddef.h
>

31 
	#__√ed_time_t


	)

32 
	#__√ed_time•ec


	)

33 
	~<time.h
>

35 #i‚de‡
__pid_t_deföed


36 
__pid_t
 
	tpid_t
;

37 
	#__pid_t_deföed


	)

42 
	~<bôs/sched.h
>

44 
	#sched_¥i‹ôy
 
__sched_¥i‹ôy


	)

47 
__BEGIN_DECLS


50 
	$sched_£ç¨am
 (
__pid_t
 
__pid
, c⁄° 
sched_∑øm
 *
__∑øm
)

51 
__THROW
;

54 
	$sched_gë∑øm
 (
__pid_t
 
__pid
, 
sched_∑øm
 *
__∑øm
Ë
__THROW
;

57 
	$sched_£tscheduÀr
 (
__pid_t
 
__pid
, 
__pﬁicy
,

58 c⁄° 
sched_∑øm
 *
__∑øm
Ë
__THROW
;

61 
	$sched_gëscheduÀr
 (
__pid_t
 
__pid
Ë
__THROW
;

64 
	$sched_yõld
 (Ë
__THROW
;

67 
	$sched_gë_¥i‹ôy_max
 (
__Æg‹ôhm
Ë
__THROW
;

70 
	$sched_gë_¥i‹ôy_mö
 (
__Æg‹ôhm
Ë
__THROW
;

73 
	$sched_º_gë_öãrvÆ
 (
__pid_t
 
__pid
, 
time•ec
 *
__t
Ë
__THROW
;

76 #ifde‡
__USE_GNU


78 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

79 
	#CPU_SET
(
˝u
, 
˝u£ç
Ë
	`__CPU_SET_S
 (˝u,  (
˝u_£t_t
), cpu£ç)

	)

80 
	#CPU_CLR
(
˝u
, 
˝u£ç
Ë
	`__CPU_CLR_S
 (˝u,  (
˝u_£t_t
), cpu£ç)

	)

81 
	#CPU_ISSET
(
˝u
, 
˝u£ç
Ë
	`__CPU_ISSET_S
 (˝u,  (
˝u_£t_t
), \

82 
˝u£ç
)

	)

83 
	#CPU_ZERO
(
˝u£ç
Ë
	`__CPU_ZERO_S
 ( (
˝u_£t_t
), cpu£ç)

	)

84 
	#CPU_COUNT
(
˝u£ç
Ë
	`__CPU_COUNT_S
 ( (
˝u_£t_t
), cpu£ç)

	)

86 
	#CPU_SET_S
(
˝u
, 
£tsize
, 
˝u£ç
Ë
	`__CPU_SET_S
 (˝u, sësize, cpu£ç)

	)

87 
	#CPU_CLR_S
(
˝u
, 
£tsize
, 
˝u£ç
Ë
	`__CPU_CLR_S
 (˝u, sësize, cpu£ç)

	)

88 
	#CPU_ISSET_S
(
˝u
, 
£tsize
, 
˝u£ç
Ë
	`__CPU_ISSET_S
 (cpu, setsize, \

89 
˝u£ç
)

	)

90 
	#CPU_ZERO_S
(
£tsize
, 
˝u£ç
Ë
	`__CPU_ZERO_S
 (£tsize, cpu£ç)

	)

91 
	#CPU_COUNT_S
(
£tsize
, 
˝u£ç
Ë
	`__CPU_COUNT_S
 (£tsize, cpu£ç)

	)

93 
	#CPU_EQUAL
(
˝u£ç1
, 
˝u£ç2
) \

94 
	`__CPU_EQUAL_S
 ( (
˝u_£t_t
), 
˝u£ç1
, 
˝u£ç2
)

	)

95 
	#CPU_EQUAL_S
(
£tsize
, 
˝u£ç1
, 
˝u£ç2
) \

96 
	`__CPU_EQUAL_S
 (
£tsize
, 
˝u£ç1
, 
˝u£ç2
)

	)

98 
	#CPU_AND
(
de°£t
, 
§c£t1
, 
§c£t2
) \

99 
	`__CPU_OP_S
 ( (
˝u_£t_t
), 
de°£t
, 
§c£t1
, 
§c£t2
, &)

	)

100 
	#CPU_OR
(
de°£t
, 
§c£t1
, 
§c£t2
) \

101 
	`__CPU_OP_S
 ( (
˝u_£t_t
), 
de°£t
, 
§c£t1
, 
§c£t2
, |)

	)

102 
	#CPU_XOR
(
de°£t
, 
§c£t1
, 
§c£t2
) \

103 
	`__CPU_OP_S
 ( (
˝u_£t_t
), 
de°£t
, 
§c£t1
, 
§c£t2
, ^)

	)

104 
	#CPU_AND_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
) \

105 
	`__CPU_OP_S
 (
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, &)

	)

106 
	#CPU_OR_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
) \

107 
	`__CPU_OP_S
 (
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, |)

	)

108 
	#CPU_XOR_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
) \

109 
	`__CPU_OP_S
 (
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, ^)

	)

111 
	#CPU_ALLOC_SIZE
(
cou¡
Ë
	`__CPU_ALLOC_SIZE
 (cou¡)

	)

112 
	#CPU_ALLOC
(
cou¡
Ë
	`__CPU_ALLOC
 (cou¡)

	)

113 
	#CPU_FREE
(
˝u£t
Ë
	`__CPU_FREE
 (˝u£t)

	)

117 
	$sched_£èfföôy
 (
__pid_t
 
__pid
, 
size_t
 
__˝u£tsize
,

118 c⁄° 
˝u_£t_t
 *
__˝u£t
Ë
__THROW
;

121 
	$sched_gëafföôy
 (
__pid_t
 
__pid
, 
size_t
 
__˝u£tsize
,

122 
˝u_£t_t
 *
__˝u£t
Ë
__THROW
;

125 
__END_DECLS


	@/usr/include/xlocale.h

20 #i‚de‡
_XLOCALE_H


21 
	#_XLOCALE_H
 1

	)

27 
	s__loˇÀ_°ru˘


30 
__loˇÀ_d©a
 *
	m__loˇÀs
[13];

33 c⁄° *
	m__˘y≥_b
;

34 c⁄° *
	m__˘y≥_tﬁowî
;

35 c⁄° *
	m__˘y≥_touµî
;

38 c⁄° *
	m__«mes
[13];

39 } *
	t__loˇÀ_t
;

42 
__loˇÀ_t
 
	tloˇÀ_t
;

	@/usr/include/_G_config.h

4 #i‚de‡
_G_c⁄fig_h


5 
	#_G_c⁄fig_h
 1

	)

9 
	~<bôs/ty≥s.h
>

10 
	#__√ed_size_t


	)

11 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


12 
	#__√ed_wch¨_t


	)

14 
	#__√ed_NULL


	)

15 
	~<°ddef.h
>

16 
	#__√ed_mb°©e_t


	)

17 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


18 
	#__√ed_wöt_t


	)

20 
	~<wch¨.h
>

23 
__off_t
 
	m__pos
;

24 
__mb°©e_t
 
	m__°©e
;

25 } 
	t_G_Âos_t
;

28 
__off64_t
 
	m__pos
;

29 
__mb°©e_t
 
	m__°©e
;

30 } 
	t_G_Âos64_t
;

31 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


32 
	~<gc⁄v.h
>

35 
__gc⁄v_öfo
 
	m__cd
;

38 
__gc⁄v_öfo
 
	m__cd
;

39 
__gc⁄v_°ï_d©a
 
	m__d©a
;

40 } 
	m__comböed
;

41 } 
	t_G_ic⁄v_t
;

46 
	#_G_va_li°
 
__gnuc_va_li°


	)

48 
	#_G_HAVE_MMAP
 1

	)

49 
	#_G_HAVE_MREMAP
 1

	)

51 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

54 
	#_G_HAVE_ST_BLKSIZE
 
	`deföed
 (
_STATBUF_ST_BLKSIZE
)

	)

56 
	#_G_BUFSIZ
 8192

	)

	@/usr/include/boost/config/select_compiler_config.hpp

16 #i‡
deföed
(
__GCCXML__
)

18 
	#BOOST_COMPILER_CONFIG
 "boo°/c⁄fig/compûî/gcc_xml.hµ"

	)

20 #ñi‡
deföed
(
_CRAYC
)

22 
	#BOOST_COMPILER_CONFIG
 "boo°/c⁄fig/compûî/¸ay.hµ"

	)

24 #ñi‡
deföed
 
__CUDACC__


26 
	#BOOST_COMPILER_CONFIG
 "boo°/c⁄fig/compûî/nvcc.hµ"

	)

28 #ñi‡
deföed
 
__COMO__


30 
	#BOOST_COMPILER_CONFIG
 "boo°/c⁄fig/compûî/comóu.hµ"

	)

32 #ñi‡
deföed
(
__PATHSCALE__
Ë&& (
__PATHCC__
 >= 4)

34 
	#BOOST_COMPILER_CONFIG
 "boo°/c⁄fig/compûî/∑thsˇÀ.hµ"

	)

36 #ñi‡
deföed
 
__˛™g__


38 
	#BOOST_COMPILER_CONFIG
 "boo°/c⁄fig/compûî/˛™g.hµ"

	)

40 #ñi‡
deföed
 
__DMC__


42 
	#BOOST_COMPILER_CONFIG
 "boo°/c⁄fig/compûî/digôÆm¨s.hµ"

	)

44 #ñi‡
deföed
(
__INTEL_COMPILER
Ë|| deföed(
__ICL
Ë|| deföed(
__ICC
Ë|| deföed(
__ECC
)

46 
	#BOOST_COMPILER_CONFIG
 "boo°/c⁄fig/compûî/öãl.hµ"

	)

48 #ñi‡
deföed
 
__GNUC__


50 
	#BOOST_COMPILER_CONFIG
 "boo°/c⁄fig/compûî/gcc.hµ"

	)

52 #ñi‡
deföed
 
__KCC


54 
	#BOOST_COMPILER_CONFIG
 "boo°/c⁄fig/compûî/kai.hµ"

	)

56 #ñi‡
deföed
 
__sgi


58 
	#BOOST_COMPILER_CONFIG
 "boo°/c⁄fig/compûî/sgi_mù•ro.hµ"

	)

60 #ñi‡
deföed
 
__DECCXX


62 
	#BOOST_COMPILER_CONFIG
 "boo°/c⁄fig/compûî/com∑q_cxx.hµ"

	)

64 #ñi‡
deföed
 
__ghs


66 
	#BOOST_COMPILER_CONFIG
 "boo°/c⁄fig/compûî/gªíhûls.hµ"

	)

68 #ñi‡
deföed
 
__CODEGEARC__


70 
	#BOOST_COMPILER_CONFIG
 "boo°/c⁄fig/compûî/codegór.hµ"

	)

72 #ñi‡
deföed
 
__BORLANDC__


74 
	#BOOST_COMPILER_CONFIG
 "boo°/c⁄fig/compûî/b‹œnd.hµ"

	)

76 #ñi‡
deföed
 
__MWERKS__


78 
	#BOOST_COMPILER_CONFIG
 "boo°/c⁄fig/compûî/mërowîks.hµ"

	)

80 #ñi‡
deföed
 
__SUNPRO_CC


82 
	#BOOST_COMPILER_CONFIG
 "boo°/c⁄fig/compûî/su≈ro_cc.hµ"

	)

84 #ñi‡
deföed
 
__HP_aCC


86 
	#BOOST_COMPILER_CONFIG
 "boo°/c⁄fig/compûî/hp_acc.hµ"

	)

88 #ñi‡
deföed
(
__MRC__
Ë|| deföed(
__SC__
)

90 
	#BOOST_COMPILER_CONFIG
 "boo°/c⁄fig/compûî/mpw.hµ"

	)

92 #ñi‡
deföed
(
__IBMCPP__
)

94 
	#BOOST_COMPILER_CONFIG
 "boo°/c⁄fig/compûî/va˝p.hµ"

	)

96 #ñi‡
deföed
(
__PGI
)

98 
	#BOOST_COMPILER_CONFIG
 "boo°/c⁄fig/compûî/pgi.hµ"

	)

100 #ñi‡
deföed
 
_MSC_VER


105 
	#BOOST_COMPILER_CONFIG
 "boo°/c⁄fig/compûî/visuÆc.hµ"

	)

107 #ñi‡
deföed
 (
BOOST_ASSERT_CONFIG
)

	@/usr/include/boost/config/select_platform_config.hpp

16 #i‡(
deföed
(
löux
Ë|| deföed(
__löux
Ë|| deföed(
__löux__
Ë|| deföed(
__GNU__
Ë|| deföed(
__GLIBC__
)Ë&& !deföed(
_CRAYC
)

18 
	#BOOST_PLATFORM_CONFIG
 "boo°/c⁄fig/∂©f‹m/löux.hµ"

	)

20 #ñi‡
deföed
(
__FªeBSD__
Ë|| deföed(
__NëBSD__
Ë|| deföed(
__O≥nBSD__
Ë|| deföed(
__Døg⁄Fly__
)

22 
	#BOOST_PLATFORM_CONFIG
 "boo°/c⁄fig/∂©f‹m/bsd.hµ"

	)

24 #ñi‡
deföed
(
sun
Ë|| deföed(
__sun
)

26 
	#BOOST_PLATFORM_CONFIG
 "boo°/c⁄fig/∂©f‹m/sﬁ¨is.hµ"

	)

28 #ñi‡
deföed
(
__sgi
)

30 
	#BOOST_PLATFORM_CONFIG
 "boo°/c⁄fig/∂©f‹m/úix.hµ"

	)

32 #ñi‡
deföed
(
__hpux
)

34 
	#BOOST_PLATFORM_CONFIG
 "boo°/c⁄fig/∂©f‹m/hpux.hµ"

	)

36 #ñi‡
deföed
(
__CYGWIN__
)

38 
	#BOOST_PLATFORM_CONFIG
 "boo°/c⁄fig/∂©f‹m/cygwö.hµ"

	)

40 #ñi‡
deföed
(
_WIN32
Ë|| deföed(
__WIN32__
Ë|| deföed(
WIN32
)

42 
	#BOOST_PLATFORM_CONFIG
 "boo°/c⁄fig/∂©f‹m/wö32.hµ"

	)

44 #ñi‡
deföed
(
__BEOS__
)

46 
	#BOOST_PLATFORM_CONFIG
 "boo°/c⁄fig/∂©f‹m/beos.hµ"

	)

48 #ñi‡
deföed
(
macötosh
Ë|| deföed(
__APPLE__
Ë|| deföed(
__APPLE_CC__
)

50 
	#BOOST_PLATFORM_CONFIG
 "boo°/c⁄fig/∂©f‹m/macos.hµ"

	)

52 #ñi‡
deföed
(
__IBMCPP__
Ë|| deföed(
_AIX
)

54 
	#BOOST_PLATFORM_CONFIG
 "boo°/c⁄fig/∂©f‹m/aix.hµ"

	)

56 #ñi‡
deföed
(
__amigaos__
)

58 
	#BOOST_PLATFORM_CONFIG
 "boo°/c⁄fig/∂©f‹m/amigaos.hµ"

	)

60 #ñi‡
deföed
(
__QNXNTO__
)

62 
	#BOOST_PLATFORM_CONFIG
 "boo°/c⁄fig/∂©f‹m/qnx¡o.hµ"

	)

64 #ñi‡
deföed
(
__VXWORKS__
)

66 
	#BOOST_PLATFORM_CONFIG
 "boo°/c⁄fig/∂©f‹m/vxw‹ks.hµ"

	)

68 #ñi‡
deföed
(
__SYMBIAN32__
)

70 
	#BOOST_PLATFORM_CONFIG
 "boo°/c⁄fig/∂©f‹m/symbün.hµ"

	)

72 #ñi‡
deföed
(
_CRAYC
)

74 
	#BOOST_PLATFORM_CONFIG
 "boo°/c⁄fig/∂©f‹m/¸ay.hµ"

	)

76 #ñi‡
deföed
(
__VMS
)

78 
	#BOOST_PLATFORM_CONFIG
 "boo°/c⁄fig/∂©f‹m/vms.hµ"

	)

81 #i‡
deföed
(
unix
) \

82 || 
deföed
(
__unix
) \

83 || 
deföed
(
_XOPEN_SOURCE
) \

84 || 
	$deföed
(
_POSIX_SOURCE
)

88 #i‚de‡
BOOST_HAS_UNISTD_H


89 
	#BOOST_HAS_UNISTD_H


	)

92 
	~<boo°/c⁄fig/posix_„©uªs.hµ
>

96 #i‡
	`deföed
 (
BOOST_ASSERT_CONFIG
)

	@/usr/include/boost/config/select_stdlib_config.hpp

17 #ifde‡
__˝lu•lus


18 
	~<c°ddef
>

20 
	~<°ddef.h
>

23 #i‡
deföed
(
__SGI_STL_PORT
Ë|| deföed(
_STLPORT_VERSION
)

27 
	#BOOST_STDLIB_CONFIG
 "boo°/c⁄fig/°dlib/°Õ‹t.hµ"

	)

37 
	~<boo°/c⁄fig/no_å1/utûôy.hµ
>

39 #i‡
deföed
(
__LIBCOMO__
)

41 
	#BOOST_STDLIB_CONFIG
 "boo°/c⁄fig/°dlib/libcomo.hµ"

	)

43 #ñi‡
deföed
(
__STD_RWCOMPILER_H__
Ë|| deföed(
_RWSTD_VER
)

45 
	#BOOST_STDLIB_CONFIG
 "boo°/c⁄fig/°dlib/roguewave.hµ"

	)

47 #ñi‡
deföed
(
_LIBCPP_VERSION
)

49 
	#BOOST_STDLIB_CONFIG
 "boo°/c⁄fig/°dlib/lib˝p.hµ"

	)

51 #ñi‡
deföed
(
__GLIBCPP__
Ë|| deföed(
__GLIBCXX__
)

53 
	#BOOST_STDLIB_CONFIG
 "boo°/c⁄fig/°dlib/lib°d˝p3.hµ"

	)

55 #ñi‡
deföed
(
__STL_CONFIG_H
)

57 
	#BOOST_STDLIB_CONFIG
 "boo°/c⁄fig/°dlib/sgi.hµ"

	)

59 #ñi‡
deföed
(
__MSL_CPP__
)

61 
	#BOOST_STDLIB_CONFIG
 "boo°/c⁄fig/°dlib/m¶.hµ"

	)

63 #ñi‡
deföed
(
__IBMCPP__
)

65 
	#BOOST_STDLIB_CONFIG
 "boo°/c⁄fig/°dlib/va˝p.hµ"

	)

67 #ñi‡
deföed
(
MSIPL_COMPILE_H
)

69 
	#BOOST_STDLIB_CONFIG
 "boo°/c⁄fig/°dlib/modía.hµ"

	)

71 #ñi‡(
deföed
(
_YVALS
Ë&& !deföed(
__IBMCPP__
)Ë|| deföed(
_CPPLIB_VER
)

73 
	#BOOST_STDLIB_CONFIG
 "boo°/c⁄fig/°dlib/dökumw¨e.hµ"

	)

75 #ñi‡
deföed
 (
BOOST_ASSERT_CONFIG
)

	@/usr/include/boost/config/suffix.hpp

26 #i‚de‡
BOOST_CONFIG_SUFFIX_HPP


27 
	#BOOST_CONFIG_SUFFIX_HPP


	)

29 #i‡
deföed
(
__GNUC__
) && (__GNUC__ >= 4)

34 #¥agm®
GCC
 
sy°em_hódî


40 #i‚de‡
BOOST_SYMBOL_EXPORT


41 
	#BOOST_SYMBOL_EXPORT


	)

43 #i‚de‡
BOOST_SYMBOL_IMPORT


44 
	#BOOST_SYMBOL_IMPORT


	)

46 #i‚de‡
BOOST_SYMBOL_VISIBLE


47 
	#BOOST_SYMBOL_VISIBLE


	)

56 #i‡!
deföed
(
BOOST_HAS_LONG_LONG
Ë&& !deföed(
BOOST_NO_LONG_LONG
) \

57 && !
deföed
(
BOOST_MSVC
Ë&& !
	$deföed
(
__BORLANDC__
)

58 
	~<limôs.h
>

59 #i‡(
	`deföed
(
ULLONG_MAX
Ë|| deföed(
ULONG_LONG_MAX
Ë|| deföed(
ULONGLONG_MAX
))

60 
	#BOOST_HAS_LONG_LONG


	)

62 
	#BOOST_NO_LONG_LONG


	)

69 #i‡
	`deföed
(
__GNUC__
Ë&& (__GNUC__ >3Ë&& deföed(
BOOST_NO_CTYPE_FUNCTIONS
)

70 #unde‡
BOOST_NO_CTYPE_FUNCTIONS


76 #i‚de‡
BOOST_STD_EXTENSION_NAMESPACE


77 
	#BOOST_STD_EXTENSION_NAMESPACE
 
°d


	)

83 #i‡
	`deföed
(
BOOST_NO_CV_SPECIALIZATIONS
) \

84 && !
	$deföed
(
BOOST_NO_CV_VOID_SPECIALIZATIONS
)

85 
	#BOOST_NO_CV_VOID_SPECIALIZATIONS


	)

92 #i‡
	`deföed
(
BOOST_NO_LIMITS
) \

93 && !
	$deföed
(
BOOST_NO_LIMITS_COMPILE_TIME_CONSTANTS
)

94 
	#BOOST_NO_LIMITS_COMPILE_TIME_CONSTANTS


	)

95 
	#BOOST_NO_MS_INT64_NUMERIC_LIMITS


	)

96 
	#BOOST_NO_LONG_LONG_NUMERIC_LIMITS


	)

103 #i‡!
	`deföed
(
BOOST_HAS_LONG_LONG
Ë&& !deföed(
BOOST_NO_LONG_LONG_NUMERIC_LIMITS
)

104 
	#BOOST_NO_LONG_LONG_NUMERIC_LIMITS


	)

111 #i‡!
	`deföed
(
BOOST_HAS_MS_INT64
Ë&& !deföed(
BOOST_NO_MS_INT64_NUMERIC_LIMITS
)

112 
	#BOOST_NO_MS_INT64_NUMERIC_LIMITS


	)

119 #i‡!
	`deföed
(
BOOST_NO_MEMBER_TEMPLATES
) \

120 && !
	$deföed
(
BOOST_MSVC6_MEMBER_TEMPLATES
)

121 
	#BOOST_MSVC6_MEMBER_TEMPLATES


	)

127 #i‡
	`deföed
(
BOOST_NO_TEMPLATE_PARTIAL_SPECIALIZATION
) \

128 && !
	$deföed
(
BOOST_BCB_PARTIAL_SPECIALIZATION_BUG
)

129 
	#BOOST_BCB_PARTIAL_SPECIALIZATION_BUG


	)

135 #i‡
	`deföed
(
BOOST_NO_TEMPLATE_PARTIAL_SPECIALIZATION
) \

136 && !
	$deföed
(
BOOST_NO_ARRAY_TYPE_SPECIALIZATIONS
)

137 
	#BOOST_NO_ARRAY_TYPE_SPECIALIZATIONS


	)

143 #i‡
	`deföed
(
BOOST_NO_TEMPLATE_PARTIAL_SPECIALIZATION
) \

144 && !
	$deföed
(
BOOST_NO_STD_ITERATOR_TRAITS
)

145 
	#BOOST_NO_STD_ITERATOR_TRAITS


	)

152 #i‡
	`deföed
(
BOOST_NO_TEMPLATE_PARTIAL_SPECIALIZATION
) \

153 && !
	$deföed
(
BOOST_NO_PARTIAL_SPECIALIZATION_IMPLICIT_DEFAULT_ARGS
)

154 
	#BOOST_NO_PARTIAL_SPECIALIZATION_IMPLICIT_DEFAULT_ARGS


	)

161 #i‡
	`deföed
(
BOOST_NO_MEMBER_TEMPLATES
) \

162 && !
	`deföed
(
BOOST_MSVC6_MEMBER_TEMPLATES
) \

163 && !
	$deföed
(
BOOST_NO_TEMPLATED_ITERATOR_CONSTRUCTORS
)

164 
	#BOOST_NO_TEMPLATED_ITERATOR_CONSTRUCTORS


	)

171 #i‡
	`deföed
(
BOOST_NO_MEMBER_TEMPLATES
) \

172 && !
	`deföed
(
BOOST_MSVC6_MEMBER_TEMPLATES
) \

173 && !
	$deföed
(
BOOST_NO_STD_ALLOCATOR
)

174 
	#BOOST_NO_STD_ALLOCATOR


	)

180 #i‡
	`deföed
(
BOOST_NO_ARGUMENT_DEPENDENT_LOOKUP
Ë&& !deföed(
BOOST_FUNCTION_SCOPE_USING_DECLARATION_BREAKS_ADL
)

181 
	#BOOST_FUNCTION_SCOPE_USING_DECLARATION_BREAKS_ADL


	)

187 #i‡
	`deföed
(
BOOST_NO_TYPEID
Ë&& !deföed(
BOOST_NO_RTTI
)

188 
	#BOOST_NO_RTTI


	)

194 #i‡!
	`deföed
(
BOOST_NO_STD_ALLOCATOR
)

195 
	#BOOST_HAS_PARTIAL_STD_ALLOCATOR


	)

201 #i‡
	`deföed
(
BOOST_NO_STD_LOCALE
Ë&& !deföed(
BOOST_NO_STD_USE_FACET
)

202 
	#BOOST_NO_STD_USE_FACET


	)

208 #i‡
	`deföed
(
BOOST_NO_STD_LOCALE
Ë&& !deföed(
BOOST_NO_STD_MESSAGES
)

209 
	#BOOST_NO_STD_MESSAGES


	)

215 #i‡
	`deföed
(
BOOST_NO_STD_LOCALE
Ë&& !deföed(
BOOST_NO_STD_WSTREAMBUF
)

216 
	#BOOST_NO_STD_WSTREAMBUF


	)

222 #i‡
	`deföed
(
BOOST_NO_CWCHAR
Ë&& !deföed(
BOOST_NO_CWCTYPE
)

223 
	#BOOST_NO_CWCTYPE


	)

229 #i‡
	`deföed
(
BOOST_NO_CWCHAR
Ë&& !deföed(
BOOST_NO_SWPRINTF
)

230 
	#BOOST_NO_SWPRINTF


	)

238 #i‡
	`deföed
(
BOOST_DISABLE_WIN32
Ë&& deföed(
_WIN32
) \

239 && !
	`deföed
(
BOOST_DISABLE_THREADS
Ë&& !
	$deföed
(
BOOST_HAS_PTHREADS
)

240 
	#BOOST_DISABLE_THREADS


	)

249 #i‡(
	`deföed
(
__MT__
Ë|| deföed(
_MT
Ë|| deföed(
_REENTRANT
) \

250 || 
	`deföed
(
_PTHREADS
Ë|| deföed(
__APPLE__
Ë|| deföed(
__Døg⁄Fly__
)) \

251 && !
	$deföed
(
BOOST_HAS_THREADS
)

252 
	#BOOST_HAS_THREADS


	)

258 #i‡
	`deföed
(
BOOST_DISABLE_THREADS
Ë&& deföed(
BOOST_HAS_THREADS
)

259 #unde‡
BOOST_HAS_THREADS


265 #i‡
	`deföed
(
BOOST_HAS_THREADS
Ë&& !deföed(
BOOST_HAS_PTHREADS
)\

266 && !
	`deföed
(
BOOST_HAS_WINTHREADS
Ë&& !deföed(
BOOST_HAS_BETHREADS
)\

267 && !
	$deföed
(
BOOST_HAS_MPTASKS
)

268 #unde‡
BOOST_HAS_THREADS


274 #i‚de‡
BOOST_HAS_THREADS


275 #unde‡
BOOST_HAS_PTHREADS


276 #unde‡
BOOST_HAS_PTHREAD_MUTEXATTR_SETTYPE


277 #unde‡
BOOST_HAS_PTHREAD_YIELD


278 #unde‡
BOOST_HAS_PTHREAD_DELAY_NP


279 #unde‡
BOOST_HAS_WINTHREADS


280 #unde‡
BOOST_HAS_BETHREADS


281 #unde‡
BOOST_HAS_MPTASKS


288 #i‡
	`deföed
(
__STDC_VERSION__
) && (__STDC_VERSION__ >= 199901)

289 
	#BOOST_HAS_STDINT_H


	)

290 #i‚de‡
BOOST_HAS_LOG1P


291 
	#BOOST_HAS_LOG1P


	)

293 #i‚de‡
BOOST_HAS_EXPM1


294 
	#BOOST_HAS_EXPM1


	)

302 #i‡!
	`deföed
(
BOOST_HAS_SLIST
Ë&& !deföed(
BOOST_NO_SLIST
)

303 
	#BOOST_NO_SLIST


	)

306 #i‡!
	`deföed
(
BOOST_HAS_HASH
Ë&& !deföed(
BOOST_NO_HASH
)

307 
	#BOOST_NO_HASH


	)

313 #i‡
	`deföed
(
BOOST_HAS_SLIST
Ë&& !deföed(
BOOST_SLIST_HEADER
)

314 
	#BOOST_SLIST_HEADER
 <
¶i°
>

	)

320 #i‡
	`deföed
(
BOOST_HAS_HASH
Ë&& !deföed(
BOOST_HASH_SET_HEADER
)

321 
	#BOOST_HASH_SET_HEADER
 <
hash_£t
>

	)

327 #i‡
	`deföed
(
BOOST_HAS_HASH
Ë&& !deföed(
BOOST_HASH_MAP_HEADER
)

328 
	#BOOST_HASH_MAP_HEADER
 <
hash_m≠
>

	)

334 #i‡
	`deföed
(
BOOST_ABI_PREFIX
Ë&& deföed(
BOOST_ABI_SUFFIX
Ë&& !deföed(
BOOST_HAS_ABI_HEADERS
)

335 
	#BOOST_HAS_ABI_HEADERS


	)

338 #i‡
	`deföed
(
BOOST_HAS_ABI_HEADERS
Ë&& deföed(
BOOST_DISABLE_ABI_HEADERS
)

339 #unde‡
BOOST_HAS_ABI_HEADERS


351 #i‡
	`deföed
(
BOOST_NO_STDC_NAMESPACE
Ë&& deföed(
__˝lu•lus
)

352 
	~<c°ddef
>

353 
«me•a˚
 
°d
 { 
usög
 ::
±rdiff_t
; usög ::
size_t
; 
	}
}

358 
	#BOOST_PREVENT_MACRO_SUBSTITUTION


	)

360 #i‚de‡
BOOST_USING_STD_MIN


361 
	#BOOST_USING_STD_MIN
(Ë
usög
 
°d
::
mö


	)

364 #i‚de‡
BOOST_USING_STD_MAX


365 
	#BOOST_USING_STD_MAX
(Ë
usög
 
°d
::
max


	)

370 #i‡
deföed
(
BOOST_NO_STD_MIN_MAX
Ë&& deföed(
__˝lu•lus
)

372 
«me•a˚
 
	g°d
 {

373 
	gãm∂©e
 <
˛ass
 
	g_Tp
>

374 
ölöe
 c⁄° 
	g_Tp
& 
mö
 
BOOST_PREVENT_MACRO_SUBSTITUTION
 (c⁄° 
_Tp
& 
__a
, c⁄° _Tp& 
__b
) {

375  
	g__b
 < 
	g__a
 ? __b : 
__a
;

377 
	gãm∂©e
 <
˛ass
 
	g_Tp
>

378 
ölöe
 c⁄° 
	g_Tp
& 
max
 
BOOST_PREVENT_MACRO_SUBSTITUTION
 (c⁄° 
_Tp
& 
__a
, c⁄° _Tp& 
__b
) {

379  
	g__a
 < 
	g__b
 ? __b : 
__a
;

391 #ifde‡
BOOST_NO_INCLASS_MEMBER_INITIALIZATION


392 
	#BOOST_STATIC_CONSTANT
(
ty≥
, 
assignmít
Ëíum {ássignmíà}

	)

394 
	#BOOST_STATIC_CONSTANT
(
ty≥
, 
assignmít
Ëc⁄°Åy≥ 
	)
assignment

410 #i‡
deföed
(
BOOST_NO_STD_USE_FACET
)

411 #ifde‡
BOOST_HAS_TWO_ARG_USE_FACET


412 
	#BOOST_USE_FACET
(
Ty≥
, 
loc
Ë
°d
::
	`u£_Á˚t
÷oc, 
°©ic_ˇ°
<Ty≥*>(0))

	)

413 
	#BOOST_HAS_FACET
(
Ty≥
, 
loc
Ë
°d
::
	`has_Á˚t
÷oc, 
°©ic_ˇ°
<Ty≥*>(0))

	)

414 #ñi‡
deföed
(
BOOST_HAS_MACRO_USE_FACET
)

415 
	#BOOST_USE_FACET
(
Ty≥
, 
loc
Ë
°d
::
	`_USE
÷oc, Ty≥)

	)

416 
	#BOOST_HAS_FACET
(
Ty≥
, 
loc
Ë
°d
::
	`_HAS
÷oc, Ty≥)

	)

417 #ñi‡
deföed
(
BOOST_HAS_STLP_USE_FACET
)

418 
	#BOOST_USE_FACET
(
Ty≥
, 
loc
Ë(*
°d
::
_U£_Á˚t
<Ty≥ >÷oc))

	)

419 
	#BOOST_HAS_FACET
(
Ty≥
, 
loc
Ë
°d
::
has_Á˚t
< Ty≥ >÷oc)

	)

422 
	#BOOST_USE_FACET
(
Ty≥
, 
loc
Ë
°d
::
u£_Á˚t
< Ty≥ >÷oc)

	)

423 
	#BOOST_HAS_FACET
(
Ty≥
, 
loc
Ë
°d
::
has_Á˚t
< Ty≥ >÷oc)

	)

436 #i‚de‡
BOOST_NO_MEMBER_TEMPLATE_KEYWORD


437 
	#BOOST_NESTED_TEMPLATE
 
ãm∂©e


	)

439 
	#BOOST_NESTED_TEMPLATE


	)

447 #ifde‡
BOOST_NO_UNREACHABLE_RETURN_DETECTION


448 
	#BOOST_UNREACHABLE_RETURN
(
x
Ë x;

	)

450 
	#BOOST_UNREACHABLE_RETURN
(
x
)

	)

464 #i‚de‡
BOOST_NO_DEDUCED_TYPENAME


465 
	#BOOST_DEDUCED_TYPENAME
 
ty≥«me


	)

467 
	#BOOST_DEDUCED_TYPENAME


	)

470 #i‚de‡
BOOST_NO_TYPENAME_WITH_CTOR


471 
	#BOOST_CTOR_TYPENAME
 
ty≥«me


	)

473 
	#BOOST_CTOR_TYPENAME


	)

481 #i‡
deföed
(
BOOST_HAS_LONG_LONG
Ë&& deföed(
__˝lu•lus
)

482 
«me•a˚
 
	gboo°
{

483 #ifde‡
__GNUC__


484 
__exãnsi⁄__
 
	tl⁄g_l⁄g_ty≥
;

485 
__exãnsi⁄__
 
	tul⁄g_l⁄g_ty≥
;

487 
	tl⁄g_l⁄g_ty≥
;

488 
	tul⁄g_l⁄g_ty≥
;

493 #i‡
deföed
(
BOOST_HAS_INT128
Ë&& deföed(
__˝lu•lus
)

494 
«me•a˚
 
	gboo°
{

495 #ifde‡
__GNUC__


496 
__exãnsi⁄__
 
__öt128
 
	töt128_ty≥
;

497 
__exãnsi⁄__
 
	t__öt128
 
	tuöt128_ty≥
;

499 
__öt128
 
	töt128_ty≥
;

500 
	t__öt128
 
	tuöt128_ty≥
;

547 #i‡
deföed
(
BOOST_NO_EXPLICIT_FUNCTION_TEMPLATE_ARGUMENTS
Ë&& deföed(
__˝lu•lus
)

549 
	~"boo°/ty≥.hµ
"

550 
	~"boo°/n⁄_ty≥.hµ
"

552 
	#BOOST_EXPLICIT_TEMPLATE_TYPE
(
t
Ë
boo°
::
ty≥
<t>* = 0

	)

553 
	#BOOST_EXPLICIT_TEMPLATE_TYPE_SPEC
(
t
Ë
boo°
::
ty≥
<t>*

	)

554 
	#BOOST_EXPLICIT_TEMPLATE_NON_TYPE
(
t
, 
v
Ë
boo°
::
n⁄_ty≥
<t, v>* = 0

	)

555 
	#BOOST_EXPLICIT_TEMPLATE_NON_TYPE_SPEC
(
t
, 
v
Ë
boo°
::
n⁄_ty≥
<t, v>*

	)

557 
	#BOOST_APPEND_EXPLICIT_TEMPLATE_TYPE
(
t
) \

558 , 
	`BOOST_EXPLICIT_TEMPLATE_TYPE
(
t
)

	)

559 
	#BOOST_APPEND_EXPLICIT_TEMPLATE_TYPE_SPEC
(
t
) \

560 , 
	`BOOST_EXPLICIT_TEMPLATE_TYPE_SPEC
(
t
)

	)

561 
	#BOOST_APPEND_EXPLICIT_TEMPLATE_NON_TYPE
(
t
, 
v
) \

562 , 
	`BOOST_EXPLICIT_TEMPLATE_NON_TYPE
(
t
, 
v
)

	)

563 
	#BOOST_APPEND_EXPLICIT_TEMPLATE_NON_TYPE_SPEC
(
t
, 
v
) \

564 , 
	`BOOST_EXPLICIT_TEMPLATE_NON_TYPE_SPEC
(
t
, 
v
)

	)

570 
	#BOOST_EXPLICIT_TEMPLATE_TYPE
(
t
)

	)

571 
	#BOOST_EXPLICIT_TEMPLATE_TYPE_SPEC
(
t
)

	)

572 
	#BOOST_EXPLICIT_TEMPLATE_NON_TYPE
(
t
, 
v
)

	)

573 
	#BOOST_EXPLICIT_TEMPLATE_NON_TYPE_SPEC
(
t
, 
v
)

	)

575 
	#BOOST_APPEND_EXPLICIT_TEMPLATE_TYPE
(
t
)

	)

576 
	#BOOST_APPEND_EXPLICIT_TEMPLATE_TYPE_SPEC
(
t
)

	)

577 
	#BOOST_APPEND_EXPLICIT_TEMPLATE_NON_TYPE
(
t
, 
v
)

	)

578 
	#BOOST_APPEND_EXPLICIT_TEMPLATE_NON_TYPE_SPEC
(
t
, 
v
)

	)

585 #i‡
deföed
(
BOOST_NO_STD_TYPEINFO
Ë&& deföed(
__˝lu•lus
)

586 
	~<ty≥öfo
>

587 
«me•a˚
 
	g°d
{ 
	gusög
 ::
ty≥_öfo
; }

597 
	#BOOST_STRINGIZE
(
X
Ë
	`BOOST_DO_STRINGIZE
(X)

	)

598 
	#BOOST_DO_STRINGIZE
(
X
Ë#X

	)

608 
	#BOOST_JOIN
–
X
, 
Y
 ) 
	`BOOST_DO_JOIN
–X, Y )

	)

609 
	#BOOST_DO_JOIN
–
X
, 
Y
 ) 
	`BOOST_DO_JOIN2
(X,Y)

	)

610 
	#BOOST_DO_JOIN2
–
X
, 
Y
 ) X##
	)
Y

616 #i‚de‡
BOOST_COMPILER


617 
	#BOOST_COMPILER
 "Unknow¿ISO C++ Compûî"

	)

619 #i‚de‡
BOOST_STDLIB


620 
	#BOOST_STDLIB
 "Unknow¿ISO sènd¨dÜibøry"

	)

622 #i‚de‡
BOOST_PLATFORM


623 #i‡
deföed
(
unix
Ë|| deföed(
__unix
Ë|| deföed(
_XOPEN_SOURCE
) \

624 || 
	$deföed
(
_POSIX_SOURCE
)

625 
	#BOOST_PLATFORM
 "Gíîi¯Unix"

	)

627 
	#BOOST_PLATFORM
 "Unknown"

	)

634 #i‚de‡
BOOST_GPU_ENABLED


635 
	#BOOST_GPU_ENABLED


	)

640 #i‡!
	`deföed
(
BOOST_FORCEINLINE
)

641 #i‡
	`deföed
(
_MSC_VER
)

642 
	#BOOST_FORCEINLINE
 
__f‹˚ölöe


	)

643 #ñi‡
	`deföed
(
__GNUC__
) && __GNUC__ > 3

644 
	#BOOST_FORCEINLINE
 
ölöe
 
	`__©åibuã__
 ((
Æways_ölöe
))

	)

646 
	#BOOST_FORCEINLINE
 
ölöe


	)

653 #i‡
	`deföed
(
BOOST_NO_CXX11_DECLTYPE
Ë&& !deföed(
BOOST_NO_CXX11_DECLTYPE_N3276
)

654 
	#BOOST_NO_CXX11_DECLTYPE_N3276
 
BOOST_NO_CXX11_DECLTYPE


	)

662 #i‡
	`deföed
(
BOOST_NO_CXX11_HDR_UNORDERED_MAP
Ë|| deföed (
BOOST_NO_CXX11_HDR_UNORDERED_SET
)

663 #i‚de‡
BOOST_NO_CXX11_STD_UNORDERED


664 
	#BOOST_NO_CXX11_STD_UNORDERED


	)

669 #i‡
	`deföed
(
BOOST_NO_CXX11_HDR_INITIALIZER_LIST
Ë&& !deföed(
BOOST_NO_INITIALIZER_LISTS
)

670 
	#BOOST_NO_INITIALIZER_LISTS


	)

674 #i‡
	`deföed
(
BOOST_NO_CXX11_HDR_ARRAY
Ë&& !deföed(
BOOST_NO_BOOST_NO_0X_HDR_ARRAY
)

675 
	#BOOST_NO_0X_HDR_ARRAY


	)

678 #i‡
	`deföed
(
BOOST_NO_CXX11_HDR_CHRONO
Ë&& !deföed(
BOOST_NO_0X_HDR_CHRONO
)

679 
	#BOOST_NO_0X_HDR_CHRONO


	)

682 #i‡
	`deföed
(
BOOST_NO_CXX11_HDR_CODECVT
Ë&& !deföed(
BOOST_NO_0X_HDR_CODECVT
)

683 
	#BOOST_NO_0X_HDR_CODECVT


	)

686 #i‡
	`deföed
(
BOOST_NO_CXX11_HDR_CONDITION_VARIABLE
Ë&& !deföed(
BOOST_NO_0X_HDR_CONDITION_VARIABLE
)

687 
	#BOOST_NO_0X_HDR_CONDITION_VARIABLE


	)

690 #i‡
	`deföed
(
BOOST_NO_CXX11_HDR_FORWARD_LIST
Ë&& !deföed(
BOOST_NO_0X_HDR_FORWARD_LIST
)

691 
	#BOOST_NO_0X_HDR_FORWARD_LIST


	)

694 #i‡
	`deföed
(
BOOST_NO_CXX11_HDR_FUTURE
Ë&& !deföed(
BOOST_NO_0X_HDR_FUTURE
)

695 
	#BOOST_NO_0X_HDR_FUTURE


	)

700 #ifde‡
BOOST_NO_CXX11_HDR_INITIALIZER_LIST


701 #i‚de‡
BOOST_NO_0X_HDR_INITIALIZER_LIST


702 
	#BOOST_NO_0X_HDR_INITIALIZER_LIST


	)

704 #i‚de‡
BOOST_NO_INITIALIZER_LISTS


705 
	#BOOST_NO_INITIALIZER_LISTS


	)

710 #i‡
	`deföed
(
BOOST_NO_CXX11_HDR_MUTEX
Ë&& !deföed(
BOOST_NO_0X_HDR_MUTEX
)

711 
	#BOOST_NO_0X_HDR_MUTEX


	)

714 #i‡
	`deföed
(
BOOST_NO_CXX11_HDR_RANDOM
Ë&& !deföed(
BOOST_NO_0X_HDR_RANDOM
)

715 
	#BOOST_NO_0X_HDR_RANDOM


	)

718 #i‡
	`deföed
(
BOOST_NO_CXX11_HDR_RATIO
Ë&& !deföed(
BOOST_NO_0X_HDR_RATIO
)

719 
	#BOOST_NO_0X_HDR_RATIO


	)

722 #i‡
	`deföed
(
BOOST_NO_CXX11_HDR_REGEX
Ë&& !deföed(
BOOST_NO_0X_HDR_REGEX
)

723 
	#BOOST_NO_0X_HDR_REGEX


	)

726 #i‡
	`deföed
(
BOOST_NO_CXX11_HDR_SYSTEM_ERROR
Ë&& !deföed(
BOOST_NO_0X_HDR_SYSTEM_ERROR
)

727 
	#BOOST_NO_0X_HDR_SYSTEM_ERROR


	)

730 #i‡
	`deföed
(
BOOST_NO_CXX11_HDR_THREAD
Ë&& !deföed(
BOOST_NO_0X_HDR_THREAD
)

731 
	#BOOST_NO_0X_HDR_THREAD


	)

734 #i‡
	`deföed
(
BOOST_NO_CXX11_HDR_TUPLE
Ë&& !deföed(
BOOST_NO_0X_HDR_TUPLE
)

735 
	#BOOST_NO_0X_HDR_TUPLE


	)

738 #i‡
	`deföed
(
BOOST_NO_CXX11_HDR_TYPE_TRAITS
Ë&& !deföed(
BOOST_NO_0X_HDR_TYPE_TRAITS
)

739 
	#BOOST_NO_0X_HDR_TYPE_TRAITS


	)

742 #i‡
	`deföed
(
BOOST_NO_CXX11_HDR_TYPEINDEX
Ë&& !deföed(
BOOST_NO_0X_HDR_TYPEINDEX
)

743 
	#BOOST_NO_0X_HDR_TYPEINDEX


	)

746 #i‡
	`deföed
(
BOOST_NO_CXX11_HDR_UNORDERED_MAP
Ë&& !deföed(
BOOST_NO_0X_HDR_UNORDERED_MAP
)

747 
	#BOOST_NO_0X_HDR_UNORDERED_MAP


	)

750 #i‡
	`deföed
(
BOOST_NO_CXX11_HDR_UNORDERED_SET
Ë&& !deföed(
BOOST_NO_0X_HDR_UNORDERED_SET
)

751 
	#BOOST_NO_0X_HDR_UNORDERED_SET


	)

760 #i‡
	`deföed
(
BOOST_NO_CXX11_AUTO_DECLARATIONS
Ë&& !deföed(
BOOST_NO_AUTO_DECLARATIONS
)

761 
	#BOOST_NO_AUTO_DECLARATIONS


	)

764 #i‡
	`deföed
(
BOOST_NO_CXX11_AUTO_MULTIDECLARATIONS
Ë&& !deföed(
BOOST_NO_AUTO_MULTIDECLARATIONS
)

765 
	#BOOST_NO_AUTO_MULTIDECLARATIONS


	)

768 #i‡
	`deföed
(
BOOST_NO_CXX11_CHAR16_T
Ë&& !deföed(
BOOST_NO_CHAR16_T
)

769 
	#BOOST_NO_CHAR16_T


	)

772 #i‡
	`deföed
(
BOOST_NO_CXX11_CHAR32_T
Ë&& !deföed(
BOOST_NO_CHAR32_T
)

773 
	#BOOST_NO_CHAR32_T


	)

776 #i‡
	`deföed
(
BOOST_NO_CXX11_TEMPLATE_ALIASES
Ë&& !deföed(
BOOST_NO_TEMPLATE_ALIASES
)

777 
	#BOOST_NO_TEMPLATE_ALIASES


	)

780 #i‡
	`deföed
(
BOOST_NO_CXX11_CONSTEXPR
Ë&& !deföed(
BOOST_NO_CONSTEXPR
)

781 
	#BOOST_NO_CONSTEXPR


	)

784 #i‡
	`deföed
(
BOOST_NO_CXX11_DECLTYPE_N3276
Ë&& !deföed(
BOOST_NO_DECLTYPE_N3276
)

785 
	#BOOST_NO_DECLTYPE_N3276


	)

788 #i‡
	`deföed
(
BOOST_NO_CXX11_DECLTYPE
Ë&& !deföed(
BOOST_NO_DECLTYPE
)

789 
	#BOOST_NO_DECLTYPE


	)

792 #i‡
	`deföed
(
BOOST_NO_CXX11_DEFAULTED_FUNCTIONS
Ë&& !deföed(
BOOST_NO_DEFAULTED_FUNCTIONS
)

793 
	#BOOST_NO_DEFAULTED_FUNCTIONS


	)

796 #i‡
	`deföed
(
BOOST_NO_CXX11_DELETED_FUNCTIONS
Ë&& !deföed(
BOOST_NO_DELETED_FUNCTIONS
)

797 
	#BOOST_NO_DELETED_FUNCTIONS


	)

800 #i‡
	`deföed
(
BOOST_NO_CXX11_EXPLICIT_CONVERSION_OPERATORS
Ë&& !deföed(
BOOST_NO_EXPLICIT_CONVERSION_OPERATORS
)

801 
	#BOOST_NO_EXPLICIT_CONVERSION_OPERATORS


	)

804 #i‡
	`deföed
(
BOOST_NO_CXX11_EXTERN_TEMPLATE
Ë&& !deföed(
BOOST_NO_EXTERN_TEMPLATE
)

805 
	#BOOST_NO_EXTERN_TEMPLATE


	)

808 #i‡
	`deföed
(
BOOST_NO_CXX11_FUNCTION_TEMPLATE_DEFAULT_ARGS
Ë&& !deföed(
BOOST_NO_FUNCTION_TEMPLATE_DEFAULT_ARGS
)

809 
	#BOOST_NO_FUNCTION_TEMPLATE_DEFAULT_ARGS


	)

812 #i‡
	`deföed
(
BOOST_NO_CXX11_LAMBDAS
Ë&& !deföed(
BOOST_NO_LAMBDAS
)

813 
	#BOOST_NO_LAMBDAS


	)

816 #i‡
	`deföed
(
BOOST_NO_CXX11_LOCAL_CLASS_TEMPLATE_PARAMETERS
Ë&& !deföed(
BOOST_NO_LOCAL_CLASS_TEMPLATE_PARAMETERS
)

817 
	#BOOST_NO_LOCAL_CLASS_TEMPLATE_PARAMETERS


	)

820 #i‡
	`deföed
(
BOOST_NO_CXX11_NOEXCEPT
Ë&& !deföed(
BOOST_NO_NOEXCEPT
)

821 
	#BOOST_NO_NOEXCEPT


	)

824 #i‡
	`deföed
(
BOOST_NO_CXX11_NULLPTR
Ë&& !deföed(
BOOST_NO_NULLPTR
)

825 
	#BOOST_NO_NULLPTR


	)

828 #i‡
	`deföed
(
BOOST_NO_CXX11_RAW_LITERALS
Ë&& !deföed(
BOOST_NO_RAW_LITERALS
)

829 
	#BOOST_NO_RAW_LITERALS


	)

832 #i‡
	`deföed
(
BOOST_NO_CXX11_RVALUE_REFERENCES
Ë&& !deföed(
BOOST_NO_RVALUE_REFERENCES
)

833 
	#BOOST_NO_RVALUE_REFERENCES


	)

836 #i‡
	`deföed
(
BOOST_NO_CXX11_SCOPED_ENUMS
Ë&& !deföed(
BOOST_NO_SCOPED_ENUMS
)

837 
	#BOOST_NO_SCOPED_ENUMS


	)

840 #i‡
	`deföed
(
BOOST_NO_CXX11_STATIC_ASSERT
Ë&& !deföed(
BOOST_NO_STATIC_ASSERT
)

841 
	#BOOST_NO_STATIC_ASSERT


	)

844 #i‡
	`deföed
(
BOOST_NO_CXX11_STD_UNORDERED
Ë&& !deföed(
BOOST_NO_STD_UNORDERED
)

845 
	#BOOST_NO_STD_UNORDERED


	)

848 #i‡
	`deföed
(
BOOST_NO_CXX11_UNICODE_LITERALS
Ë&& !deföed(
BOOST_NO_UNICODE_LITERALS
)

849 
	#BOOST_NO_UNICODE_LITERALS


	)

852 #i‡
	`deföed
(
BOOST_NO_CXX11_UNIFIED_INITIALIZATION_SYNTAX
Ë&& !deföed(
BOOST_NO_UNIFIED_INITIALIZATION_SYNTAX
)

853 
	#BOOST_NO_UNIFIED_INITIALIZATION_SYNTAX


	)

856 #i‡
	`deföed
(
BOOST_NO_CXX11_VARIADIC_TEMPLATES
Ë&& !deföed(
BOOST_NO_VARIADIC_TEMPLATES
)

857 
	#BOOST_NO_VARIADIC_TEMPLATES


	)

860 #i‡
	`deföed
(
BOOST_NO_CXX11_VARIADIC_MACROS
Ë&& !deföed(
BOOST_NO_VARIADIC_MACROS
)

861 
	#BOOST_NO_VARIADIC_MACROS


	)

864 #i‡
	`deföed
(
BOOST_NO_CXX11_NUMERIC_LIMITS
Ë&& !deföed(
BOOST_NO_NUMERIC_LIMITS_LOWEST
)

865 
	#BOOST_NO_NUMERIC_LIMITS_LOWEST


	)

875 #ifde‡
BOOST_NO_CXX11_NOEXCEPT


876 
	#BOOST_NOEXCEPT


	)

877 
	#BOOST_NOEXCEPT_IF
(
Pªdiˇã
)

	)

878 
	#BOOST_NOEXCEPT_EXPR
(
Ex¥essi⁄
Ë
Ál£


	)

880 
	#BOOST_NOEXCEPT
 
n€x˚±


	)

881 
	#BOOST_NOEXCEPT_IF
(
Pªdiˇã
Ë
	`n€x˚±
((Pªdiˇã))

	)

882 
	#BOOST_NOEXCEPT_EXPR
(
Ex¥essi⁄
Ë
	`n€x˚±
((Ex¥essi⁄))

	)

888 #i‡
	`deföed
(
BOOST_NO_CXX11_CONSTEXPR
)

889 
	#BOOST_CONSTEXPR


	)

890 
	#BOOST_CONSTEXPR_OR_CONST
 c⁄°

	)

892 
	#BOOST_CONSTEXPR
 
c⁄°ex¥


	)

893 
	#BOOST_CONSTEXPR_OR_CONST
 
c⁄°ex¥


	)

896 
	#BOOST_STATIC_CONSTEXPR
 
BOOST_CONSTEXPR_OR_CONST


	)

901 #i‡!
	`deföed
(
BOOST_NO_CXX11_STATIC_ASSERT
Ë&& !deföed(
BOOST_HAS_STATIC_ASSERT
)

902 
	#BOOST_HAS_STATIC_ASSERT


	)

908 #i‡!
	`deföed
(
BOOST_NO_CXX11_RVALUE_REFERENCES
Ë&& !deföed(
BOOST_HAS_RVALUE_REFS
)

909 
	#BOOST_HAS_RVALUE_REFS


	)

915 #i‡!
	`deföed
(
BOOST_NO_CXX11_VARIADIC_TEMPLATES
Ë&& !deföed(
BOOST_HAS_VARIADIC_TMPL
)

916 
	#BOOST_HAS_VARIADIC_TMPL


	)

	@/usr/include/linux/kernel.h

1 #i‚de‡
_LINUX_KERNEL_H


2 
	#_LINUX_KERNEL_H


	)

4 
	~<löux/sysöfo.h
>

9 
	#__ALIGN_KERNEL
(
x
, 
a
Ë
	`__ALIGN_KERNEL_MASK
(x, (
	`ty≥of
(x))◊Ë- 1)

	)

10 
	#__ALIGN_KERNEL_MASK
(
x
, 
mask
Ë(((xË+ (mask)Ë& ~(mask))

	)

	@/usr/include/linux/socket.h

1 #i‚de‡
_LINUX_SOCKET_H


2 
	#_LINUX_SOCKET_H


	)

7 
	#_K_SS_MAXSIZE
 128

	)

8 
	#_K_SS_ALIGNSIZE
 (
	`__Æignof__
 (
sockaddr
 *))

	)

11 
	t__kî√l_ß_Ámûy_t
;

13 
	s__kî√l_sockaddr_°‹age
 {

14 
__kî√l_ß_Ámûy_t
 
	mss_Ámûy
;

16 
	m__d©a
[
_K_SS_MAXSIZE
 - ()];

19 } 
__©åibuã__
 ((
Æig√d
(
_K_SS_ALIGNSIZE
)));

	@/usr/include/linux/stddef.h

	@/usr/include/pcap/bpf.h

73 #i‡!
deföed
(
_NET_BPF_H_
Ë&& !deföed(
_BPF_H_
Ë&& !deföed(
_H_BPF
Ë&& !deföed(
lib_pˇp_bpf_h
)

74 
	#lib_pˇp_bpf_h


	)

76 #ifde‡
__˝lu•lus


81 
	#BPF_RELEASE
 199606

	)

83 #ifde‡
MSDOS


84 
	tbpf_öt32
;

85 
	tbpf_u_öt32
;

87 
	tbpf_öt32
;

88 
u_öt
 
	tbpf_u_öt32
;

97 #i‚de‡
__NëBSD__


98 
	#BPF_ALIGNMENT
 (
bpf_öt32
)

	)

100 
	#BPF_ALIGNMENT
 ()

	)

102 
	#BPF_WORDALIGN
(
x
Ë(((x)+(
BPF_ALIGNMENT
-1))&~(BPF_ALIGNMENT-1))

	)

107 
	sbpf_¥ogøm
 {

108 
u_öt
 
bf_Àn
;

109 
bpf_ö¢
 *
bf_ö¢s
;

134 
	#DLT_NULL
 0

	)

135 
	#DLT_EN10MB
 1

	)

136 
	#DLT_EN3MB
 2

	)

137 
	#DLT_AX25
 3

	)

138 
	#DLT_PRONET
 4

	)

139 
	#DLT_CHAOS
 5

	)

140 
	#DLT_IEEE802
 6

	)

141 
	#DLT_ARCNET
 7

	)

142 
	#DLT_SLIP
 8

	)

143 
	#DLT_PPP
 9

	)

144 
	#DLT_FDDI
 10

	)

155 
	#DLT_ATM_RFC1483
 11

	)

157 #ifde‡
__O≥nBSD__


158 
	#DLT_RAW
 14

	)

160 
	#DLT_RAW
 12

	)

169 #i‡
deföed
(
__NëBSD__
Ë|| deföed(
__FªeBSD__
)

170 #i‚de‡
DLT_SLIP_BSDOS


171 
	#DLT_SLIP_BSDOS
 13

	)

172 
	#DLT_PPP_BSDOS
 14

	)

175 
	#DLT_SLIP_BSDOS
 15

	)

176 
	#DLT_PPP_BSDOS
 16

	)

207 #i‡
deföed
(
__O≥nBSD__
Ë|| deföed(
__NëBSD__
Ë|| deföed(
__Døg⁄Fly__
Ë|| deföed(
__APPLE__
)

208 
	#DLT_PFSYNC
 18

	)

211 
	#DLT_ATM_CLIP
 19

	)

217 
	#DLT_REDBACK_SMARTEDGE
 32

	)

224 
	#DLT_PPP_SERIAL
 50

	)

225 
	#DLT_PPP_ETHER
 51

	)

234 
	#DLT_SYMANTEC_FIREWALL
 99

	)

253 
	#DLT_MATCHING_MIN
 104

	)

269 
	#DLT_C_HDLC
 104

	)

270 
	#DLT_CHDLC
 
DLT_C_HDLC


	)

272 
	#DLT_IEEE802_11
 105

	)

287 
	#DLT_FRELAY
 107

	)

296 #ifde‡
__O≥nBSD__


297 
	#DLT_LOOP
 12

	)

299 
	#DLT_LOOP
 108

	)

307 #ifde‡
__O≥nBSD__


308 
	#DLT_ENC
 13

	)

310 
	#DLT_ENC
 109

	)

323 
	#DLT_LINUX_SLL
 113

	)

328 
	#DLT_LTALK
 114

	)

333 
	#DLT_ECONET
 115

	)

338 
	#DLT_IPFILTER
 116

	)

343 
	#DLT_PFLOG
 117

	)

348 
	#DLT_CISCO_IOS
 118

	)

355 
	#DLT_PRISM_HEADER
 119

	)

361 
	#DLT_AIRONET_HEADER
 120

	)

401 #ifde‡
__FªeBSD__


402 
	#DLT_PFSYNC
 121

	)

404 
	#DLT_HHDLC
 121

	)

415 
	#DLT_IP_OVER_FC
 122

	)

431 
	#DLT_SUNATM
 123

	)

437 
	#DLT_RIO
 124

	)

438 
	#DLT_PCI_EXP
 125

	)

439 
	#DLT_AURORA
 126

	)

446 
	#DLT_IEEE802_11_RADIO
 127

	)

456 
	#DLT_TZSP
 128

	)

469 
	#DLT_ARCNET_LINUX
 129

	)

477 
	#DLT_JUNIPER_MLPPP
 130

	)

478 
	#DLT_JUNIPER_MLFR
 131

	)

479 
	#DLT_JUNIPER_ES
 132

	)

480 
	#DLT_JUNIPER_GGSN
 133

	)

481 
	#DLT_JUNIPER_MFR
 134

	)

482 
	#DLT_JUNIPER_ATM2
 135

	)

483 
	#DLT_JUNIPER_SERVICES
 136

	)

484 
	#DLT_JUNIPER_ATM1
 137

	)

501 
	#DLT_APPLE_IP_OVER_IEEE1394
 138

	)

507 
	#DLT_MTP2_WITH_PHDR
 139

	)

508 
	#DLT_MTP2
 140

	)

509 
	#DLT_MTP3
 141

	)

510 
	#DLT_SCCP
 142

	)

515 
	#DLT_DOCSIS
 143

	)

532 
	#DLT_LINUX_IRDA
 144

	)

537 
	#DLT_IBM_SP
 145

	)

538 
	#DLT_IBM_SN
 146

	)

565 
	#DLT_USER0
 147

	)

566 
	#DLT_USER1
 148

	)

567 
	#DLT_USER2
 149

	)

568 
	#DLT_USER3
 150

	)

569 
	#DLT_USER4
 151

	)

570 
	#DLT_USER5
 152

	)

571 
	#DLT_USER6
 153

	)

572 
	#DLT_USER7
 154

	)

573 
	#DLT_USER8
 155

	)

574 
	#DLT_USER9
 156

	)

575 
	#DLT_USER10
 157

	)

576 
	#DLT_USER11
 158

	)

577 
	#DLT_USER12
 159

	)

578 
	#DLT_USER13
 160

	)

579 
	#DLT_USER14
 161

	)

580 
	#DLT_USER15
 162

	)

592 
	#DLT_IEEE802_11_RADIO_AVS
 163

	)

600 
	#DLT_JUNIPER_MONITOR
 164

	)

605 
	#DLT_BACNET_MS_TP
 165

	)

621 
	#DLT_PPP_PPPD
 166

	)

627 
	#DLT_PPP_WITH_DIRECTION
 
DLT_PPP_PPPD


	)

628 
	#DLT_LINUX_PPP_WITHDIRECTION
 
DLT_PPP_PPPD


	)

636 
	#DLT_JUNIPER_PPPOE
 167

	)

637 
	#DLT_JUNIPER_PPPOE_ATM
 168

	)

639 
	#DLT_GPRS_LLC
 169

	)

640 
	#DLT_GPF_T
 170

	)

641 
	#DLT_GPF_F
 171

	)

647 
	#DLT_GCOM_T1E1
 172

	)

648 
	#DLT_GCOM_SERIAL
 173

	)

655 
	#DLT_JUNIPER_PIC_PEER
 174

	)

663 
	#DLT_ERF_ETH
 175

	)

664 
	#DLT_ERF_POS
 176

	)

672 
	#DLT_LINUX_LAPD
 177

	)

681 
	#DLT_JUNIPER_ETHER
 178

	)

682 
	#DLT_JUNIPER_PPP
 179

	)

683 
	#DLT_JUNIPER_FRELAY
 180

	)

684 
	#DLT_JUNIPER_CHDLC
 181

	)

689 
	#DLT_MFR
 182

	)

697 
	#DLT_JUNIPER_VP
 183

	)

706 
	#DLT_A429
 184

	)

713 
	#DLT_A653_ICM
 185

	)

719 
	#DLT_USB
 186

	)

725 
	#DLT_BLUETOOTH_HCI_H4
 187

	)

731 
	#DLT_IEEE802_16_MAC_CPS
 188

	)

737 
	#DLT_USB_LINUX
 189

	)

746 
	#DLT_CAN20B
 190

	)

752 
	#DLT_IEEE802_15_4_LINUX
 191

	)

758 
	#DLT_PPI
 192

	)

764 
	#DLT_IEEE802_16_MAC_CPS_RADIO
 193

	)

772 
	#DLT_JUNIPER_ISM
 194

	)

780 
	#DLT_IEEE802_15_4
 195

	)

786 
	#DLT_SITA
 196

	)

793 
	#DLT_ERF
 197

	)

800 
	#DLT_RAIF1
 198

	)

807 
	#DLT_IPMB
 199

	)

814 
	#DLT_JUNIPER_ST
 200

	)

820 
	#DLT_BLUETOOTH_HCI_H4_WITH_PHDR
 201

	)

829 
	#DLT_AX25_KISS
 202

	)

836 
	#DLT_LAPD
 203

	)

844 
	#DLT_PPP_WITH_DIR
 204

	)

845 
	#DLT_C_HDLC_WITH_DIR
 205

	)

846 
	#DLT_FRELAY_WITH_DIR
 206

	)

847 
	#DLT_LAPB_WITH_DIR
 207

	)

858 
	#DLT_IPMB_LINUX
 209

	)

864 
	#DLT_FLEXRAY
 210

	)

871 
	#DLT_MOST
 211

	)

878 
	#DLT_LIN
 212

	)

884 
	#DLT_X2E_SERIAL
 213

	)

890 
	#DLT_X2E_XORAYA
 214

	)

901 
	#DLT_IEEE802_15_4_NONASK_PHY
 215

	)

909 
	#DLT_LINUX_EVDEV
 216

	)

916 
	#DLT_GSMTAP_UM
 217

	)

917 
	#DLT_GSMTAP_ABIS
 218

	)

924 
	#DLT_MPLS
 219

	)

930 
	#DLT_USB_LINUX_MMAPPED
 220

	)

936 
	#DLT_DECT
 221

	)

947 
	#DLT_AOS
 222

	)

956 
	#DLT_WIHART
 223

	)

962 
	#DLT_FC_2
 224

	)

976 
	#DLT_FC_2_WITH_FRAME_DELIMS
 225

	)

1024 
	#DLT_IPNET
 226

	)

1033 
	#DLT_CAN_SOCKETCAN
 227

	)

1039 
	#DLT_IPV4
 228

	)

1040 
	#DLT_IPV6
 229

	)

1047 
	#DLT_IEEE802_15_4_NOFCS
 230

	)

1065 
	#DLT_DBUS
 231

	)

1071 
	#DLT_JUNIPER_VS
 232

	)

1072 
	#DLT_JUNIPER_SRX_E2E
 233

	)

1073 
	#DLT_JUNIPER_FIBRECHANNEL
 234

	)

1085 
	#DLT_DVB_CI
 235

	)

1092 
	#DLT_MUX27010
 236

	)

1098 
	#DLT_STANAG_5066_D_PDU
 237

	)

1104 
	#DLT_JUNIPER_ATM_CEMIC
 238

	)

1112 
	#DLT_NFLOG
 239

	)

1122 
	#DLT_NETANALYZER
 240

	)

1133 
	#DLT_NETANALYZER_TRANSPARENT
 241

	)

1140 
	#DLT_IPOIB
 242

	)

1147 
	#DLT_MPEG_2_TS
 243

	)

1155 
	#DLT_NG40
 244

	)

1165 
	#DLT_NFC_LLCP
 245

	)

1174 #i‡!
deföed
(
__FªeBSD__
Ë&& !deföed(
__O≥nBSD__
Ë&& !deföed(
__NëBSD__
Ë&& !deföed(
__Døg⁄Fly__
Ë&& !deföed(
__APPLE__
)

1175 
	#DLT_PFSYNC
 246

	)

1183 
	#DLT_INFINIBAND
 247

	)

1190 
	#DLT_SCTP
 248

	)

1192 
	#DLT_MATCHING_MAX
 248

	)

1199 
	#DLT_CLASS
(
x
Ë((xË& 0x03ff0000)

	)

1208 
	#DLT_CLASS_NETBSD_RAWAF
 0x02240000

	)

1209 
	#DLT_NETBSD_RAWAF
(
af
Ë(
DLT_CLASS_NETBSD_RAWAF
 | (af))

	)

1210 
	#DLT_NETBSD_RAWAF_AF
(
x
Ë((xË& 0x0000ffff)

	)

1211 
	#DLT_IS_NETBSD_RAWAF
(
x
Ë(
	`DLT_CLASS
(xË=
DLT_CLASS_NETBSD_RAWAF
)

	)

1218 
	#BPF_CLASS
(
code
Ë((codeË& 0x07)

	)

1219 
	#BPF_LD
 0x00

	)

1220 
	#BPF_LDX
 0x01

	)

1221 
	#BPF_ST
 0x02

	)

1222 
	#BPF_STX
 0x03

	)

1223 
	#BPF_ALU
 0x04

	)

1224 
	#BPF_JMP
 0x05

	)

1225 
	#BPF_RET
 0x06

	)

1226 
	#BPF_MISC
 0x07

	)

1229 
	#BPF_SIZE
(
code
Ë((codeË& 0x18)

	)

1230 
	#BPF_W
 0x00

	)

1231 
	#BPF_H
 0x08

	)

1232 
	#BPF_B
 0x10

	)

1233 
	#BPF_MODE
(
code
Ë((codeË& 0xe0)

	)

1234 
	#BPF_IMM
 0x00

	)

1235 
	#BPF_ABS
 0x20

	)

1236 
	#BPF_IND
 0x40

	)

1237 
	#BPF_MEM
 0x60

	)

1238 
	#BPF_LEN
 0x80

	)

1239 
	#BPF_MSH
 0xa0

	)

1242 
	#BPF_OP
(
code
Ë((codeË& 0xf0)

	)

1243 
	#BPF_ADD
 0x00

	)

1244 
	#BPF_SUB
 0x10

	)

1245 
	#BPF_MUL
 0x20

	)

1246 
	#BPF_DIV
 0x30

	)

1247 
	#BPF_OR
 0x40

	)

1248 
	#BPF_AND
 0x50

	)

1249 
	#BPF_LSH
 0x60

	)

1250 
	#BPF_RSH
 0x70

	)

1251 
	#BPF_NEG
 0x80

	)

1252 
	#BPF_JA
 0x00

	)

1253 
	#BPF_JEQ
 0x10

	)

1254 
	#BPF_JGT
 0x20

	)

1255 
	#BPF_JGE
 0x30

	)

1256 
	#BPF_JSET
 0x40

	)

1257 
	#BPF_SRC
(
code
Ë((codeË& 0x08)

	)

1258 
	#BPF_K
 0x00

	)

1259 
	#BPF_X
 0x08

	)

1262 
	#BPF_RVAL
(
code
Ë((codeË& 0x18)

	)

1263 
	#BPF_A
 0x10

	)

1266 
	#BPF_MISCOP
(
code
Ë((codeË& 0xf8)

	)

1267 
	#BPF_TAX
 0x00

	)

1268 
	#BPF_TXA
 0x80

	)

1273 
	sbpf_ö¢
 {

1274 
u_sh‹t
 
code
;

1275 
u_ch¨
 
jt
;

1276 
u_ch¨
 
jf
;

1277 
bpf_u_öt32
 
k
;

1283 
	#BPF_STMT
(
code
, 
k
Ë{ (
u_sh‹t
)(code), 0, 0, k }

	)

1284 
	#BPF_JUMP
(
code
, 
k
, 
jt
, 
jf
Ë{ (
u_sh‹t
)(code), jt, jf, k }

	)

1286 #i‡
__STDC__
 || 
deföed
(
__˝lu•lus
)

1287 
bpf_vÆid©e
(c⁄° 
bpf_ö¢
 *, );

1288 
u_öt
 
bpf_fûãr
(c⁄° 
bpf_ö¢
 *, c⁄° 
u_ch¨
 *, u_int, u_int);

1290 
bpf_vÆid©e
();

1291 
u_öt
 
bpf_fûãr
();

1297 
	#BPF_MEMWORDS
 16

	)

1299 #ifde‡
__˝lu•lus


	@/usr/include/stdc-predef.h

18 #i‚def 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

30 
	~<bôs/¥edefs.h
>

34 
	#__STDC_ISO_10646__
 201103L

	)

37 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/boost/config/no_tr1/utility.hpp

13 #i‚de‡
BOOST_CONFIG_UTILITY


14 
	#BOOST_CONFIG_UTILITY


	)

16 #i‚de‡
BOOST_TR1_NO_RECURSION


17 
	#BOOST_TR1_NO_RECURSION


	)

18 
	#BOOST_CONFIG_NO_UTILITY_RECURSION


	)

21 
	~<utûôy
>

23 #ifde‡
BOOST_CONFIG_NO_UTILITY_RECURSION


24 #unde‡
BOOST_TR1_NO_RECURSION


25 #unde‡
BOOST_CONFIG_NO_UTILITY_RECURSION


	@/usr/include/boost/config/posix_features.hpp

17 #i‡
deföed
(
BOOST_HAS_UNISTD_H
)

18 
	~<uni°d.h
>

21 #i‡
deföed
(
_XOPEN_VERSION
) && (_XOPEN_VERSION >= 3)

22 
	#BOOST_HAS_NL_TYPES_H


	)

26 #i‡
deföed
(
_POSIX_VERSION
) && (_POSIX_VERSION >= 200100)

27 
	#BOOST_HAS_STDINT_H


	)

31 #i‡
deföed
(
_POSIX_VERSION
) && (_POSIX_VERSION >= 199009L)

32 
	#BOOST_HAS_DIRENT_H


	)

36 #i‡
deföed
(
_POSIX_VERSION
) && (_POSIX_VERSION >= 199506L)

37 
	#BOOST_HAS_SIGACTION


	)

45 #i‡
deföed
(
_POSIX_THREADS
Ë&& (_POSIX_THREADS+0 >0Ë&& !deföed(
BOOST_HAS_WINTHREADS
Ë&& !deföed(
BOOST_HAS_MPTASKS
)

46 
	#BOOST_HAS_PTHREADS


	)

51 #i‡(
deföed
(
_POSIX_TIMERS
) && (_POSIX_TIMERS+0 >= 0)) \

52 || (
deföed
(
_XOPEN_REALTIME
Ë&& (
	g_XOPEN_REALTIME
+0 >= 0))

53 
	#BOOST_HAS_NANOSLEEP


	)

60 #i‡(
deföed
(
_POSIX_TIMERS
) && (_POSIX_TIMERS+0 >= 0))

61 
	#BOOST_HAS_CLOCK_GETTIME


	)

67 #i‡
deföed
(
_POSIX_PRIORITY_SCHEDULING
) && (_POSIX_PRIORITY_SCHEDULING+0 > 0)\

68 || (
deföed
(
_POSIX_THREAD_PRIORITY_SCHEDULING
) && (_POSIX_THREAD_PRIORITY_SCHEDULING+0 > 0))\

69 || (
deföed
(
_XOPEN_REALTIME
) && (_XOPEN_REALTIME+0 >= 0))

70 
	#BOOST_HAS_SCHED_YIELD


	)

78 #i‡
deföed
(
_XOPEN_VERSION
) && (_XOPEN_VERSION+0 >= 500)

79 
	#BOOST_HAS_GETTIMEOFDAY


	)

80 #i‡
deföed
(
_XOPEN_SOURCE
) && (_XOPEN_SOURCE+0 >= 500)

81 
	#BOOST_HAS_PTHREAD_MUTEXATTR_SETTYPE


	)

83 #i‚de‡
BOOST_HAS_LOG1P


84 
	#BOOST_HAS_LOG1P


	)

86 #i‚de‡
BOOST_HAS_EXPM1


87 
	#BOOST_HAS_EXPM1


	)

	@/usr/include/boost/non_type.hpp

11 #i‚de‡
BOOST_NON_TYPE_HPP_GP_20030417


12 
	#BOOST_NON_TYPE_HPP_GP_20030417


	)

15 
«me•a˚
 
	gboo°
 {

20 
	gãm∂©e
 <
ty≥«me
 
	gT
, 
T
 
	gn
>

21 
	sn⁄_ty≥
 { };

	@/usr/include/boost/type.hpp

6 #i‚de‡
BOOST_TYPE_DWA20010120_HPP


7 
	#BOOST_TYPE_DWA20010120_HPP


	)

9 
«me•a˚
 
	gboo°
 {

13 
	gãm∂©e
 <
˛ass
 
	gT
>

14 
	sty≥
 {};

	@/usr/include/gconv.h

22 #i‚de‡
_GCONV_H


23 
	#_GCONV_H
 1

	)

25 
	~<„©uªs.h
>

26 
	#__√ed_mb°©e_t


	)

27 
	#__√ed_wöt_t


	)

28 
	~<wch¨.h
>

29 
	#__√ed_size_t


	)

30 
	#__√ed_wch¨_t


	)

31 
	~<°ddef.h
>

34 
	#__UNKNOWN_10646_CHAR
 ((
wch¨_t
Ë0xfffd)

	)

39 
	m__GCONV_OK
 = 0,

40 
	m__GCONV_NOCONV
,

41 
	m__GCONV_NODB
,

42 
	m__GCONV_NOMEM
,

44 
	m__GCONV_EMPTY_INPUT
,

45 
	m__GCONV_FULL_OUTPUT
,

46 
	m__GCONV_ILLEGAL_INPUT
,

47 
	m__GCONV_INCOMPLETE_INPUT
,

49 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

50 
	m__GCONV_INTERNAL_ERROR


57 
	m__GCONV_IS_LAST
 = 0x0001,

58 
	m__GCONV_IGNORE_ERRORS
 = 0x0002,

59 
	m__GCONV_SWAP
 = 0x0004

64 
	g__gc⁄v_°ï
;

65 
	g__gc⁄v_°ï_d©a
;

66 
	g__gc⁄v_lﬂded_obje˘
;

67 
	g__gc⁄v_å™s_d©a
;

71 (*
	t__gc⁄v_f˘
Ë(
	t__gc⁄v_°ï
 *, 
	t__gc⁄v_°ï_d©a
 *,

73 **, 
	tsize_t
 *, , );

76 
	$wöt_t
 (*
	t__gc⁄v_btowc_f˘
Ë(
	t__gc⁄v_°ï
 *, );

79 (*
	t__gc⁄v_öô_f˘
Ë(
	t__gc⁄v_°ï
 *);

80 (*
	t__gc⁄v_íd_f˘
Ë(
	t__gc⁄v_°ï
 *);

84 (*
	t__gc⁄v_å™s_f˘
Ë(
	t__gc⁄v_°ï
 *,

85 
	t__gc⁄v_°ï_d©a
 *, *,

89 
	tsize_t
 *);

92 (*
	t__gc⁄v_å™s_c⁄ãxt_f˘
) (*, const *,

97 (*
	t__gc⁄v_å™s_quîy_f˘
) (const *, const ***,

98 
	tsize_t
 *);

101 (*
	t__gc⁄v_å™s_öô_f˘
) (**, const *);

102 (*
	t__gc⁄v_å™s_íd_f˘
) (*);

104 
	s__gc⁄v_å™s_d©a


107 
__gc⁄v_å™s_f˘
 
__å™s_f˘
;

108 
__gc⁄v_å™s_c⁄ãxt_f˘
 
__å™s_c⁄ãxt_f˘
;

109 
__gc⁄v_å™s_íd_f˘
 
__å™s_íd_f˘
;

110 *
__d©a
;

111 
__gc⁄v_å™s_d©a
 *
__√xt
;

116 
	s__gc⁄v_°ï


118 
__gc⁄v_lﬂded_obje˘
 *
__shlib_h™dÀ
;

119 c⁄° *
__mod«me
;

121 
__cou¡î
;

123 *
__‰om_«me
;

124 *
__to_«me
;

126 
__gc⁄v_f˘
 
__f˘
;

127 
__gc⁄v_btowc_f˘
 
__btowc_f˘
;

128 
__gc⁄v_öô_f˘
 
__öô_f˘
;

129 
__gc⁄v_íd_f˘
 
__íd_f˘
;

133 
__mö_√eded_‰om
;

134 
__max_√eded_‰om
;

135 
__mö_√eded_to
;

136 
__max_√eded_to
;

139 
__°©eful
;

141 *
__d©a
;

146 
	s__gc⁄v_°ï_d©a


148 *
__outbuf
;

149 *
__outbu„nd
;

153 
__Êags
;

157 
__övoˇti⁄_cou¡î
;

161 
__öã∫Æ_u£
;

163 
__mb°©e_t
 *
__°©ï
;

164 
__mb°©e_t
 
__°©e
;

168 
__gc⁄v_å™s_d©a
 *
__å™s
;

173 
	s__gc⁄v_öfo


175 
size_t
 
__n°ïs
;

176 
__gc⁄v_°ï
 *
__°ïs
;

177 
__exãnsi⁄__
 
__gc⁄v_°ï_d©a
 
__d©a
 
__Êex¨r
;

178 } *
	t__gc⁄v_t
;

	@/usr/include/linux/sysinfo.h

1 #i‚de‡
_LINUX_SYSINFO_H


2 
	#_LINUX_SYSINFO_H


	)

4 
	~<löux/ty≥s.h
>

6 
	#SI_LOAD_SHIFT
 16

	)

7 
	ssysöfo
 {

8 
__kî√l_l⁄g_t
 
	mu±ime
;

9 
__kî√l_ul⁄g_t
 
	mlﬂds
[3];

10 
__kî√l_ul⁄g_t
 
	mtŸÆøm
;

11 
__kî√l_ul⁄g_t
 
	m‰ìøm
;

12 
__kî√l_ul⁄g_t
 
	msh¨edøm
;

13 
__kî√l_ul⁄g_t
 
	mbuf„ºam
;

14 
__kî√l_ul⁄g_t
 
	mtŸÆsw≠
;

15 
__kî√l_ul⁄g_t
 
	m‰ìsw≠
;

16 
__u16
 
	m¥ocs
;

17 
__u16
 
	m∑d
;

18 
__kî√l_ul⁄g_t
 
	mtŸÆhigh
;

19 
__kî√l_ul⁄g_t
 
	m‰ìhigh
;

20 
__u32
 
	mmem_unô
;

21 
	m_f
[20-2*(
__kî√l_ul⁄g_t
)-(
__u32
)];

	@/usr/include/wchar.h

23 #i‚de‡
_WCHAR_H


25 #i‡!
deföed
 
__√ed_mb°©e_t
 && !deföed 
__√ed_wöt_t


26 
	#_WCHAR_H
 1

	)

27 
	~<„©uªs.h
>

30 #ifde‡
_WCHAR_H


32 
	#__√ed___FILE


	)

33 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


34 
	#__√ed_FILE


	)

36 
	~<°dio.h
>

38 
	#__√ed___va_li°


	)

39 
	~<°d¨g.h
>

41 
	~<bôs/wch¨.h
>

44 
	#__√ed_size_t


	)

45 
	#__√ed_wch¨_t


	)

46 
	#__√ed_NULL


	)

48 #i‡
deföed
 
_WCHAR_H
 || deföed 
__√ed_wöt_t
 || !deföed 
__WINT_TYPE__


49 #unde‡
__√ed_wöt_t


50 
	#__√ed_wöt_t


	)

51 
	~<°ddef.h
>

55 #i‚de‡
_WINT_T


60 
	#_WINT_T


	)

61 
	twöt_t
;

65 #i‡
deföed
 
__˝lu•lus
 && deföed 
_GLIBCPP_USE_NAMESPACES
 \

66 && 
deföed
 
__WINT_TYPE__


67 
__BEGIN_NAMESPACE_STD


68 
__WINT_TYPE__
 
	twöt_t
;

69 
	g__END_NAMESPACE_STD


74 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

75 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

79 #i‡(
deföed
 
_WCHAR_H
 || deföed 
__√ed_mb°©e_t
Ë&& !deföed 
____mb°©e_t_deföed


80 
	#____mb°©e_t_deföed
 1

	)

84 
	m__cou¡
;

87 #ifde‡
__WINT_TYPE__


88 
__WINT_TYPE__
 
	m__wch
;

90 
wöt_t
 
	m__wch
;

92 
	m__wchb
[4];

93 } 
	m__vÆue
;

94 } 
	t__mb°©e_t
;

96 #unde‡
__√ed_mb°©e_t


101 #ifde‡
_WCHAR_H


103 #i‚de‡
__mb°©e_t_deföed


104 
__BEGIN_NAMESPACE_C99


106 
__mb°©e_t
 
	tmb°©e_t
;

107 
	g__END_NAMESPACE_C99


108 
	#__mb°©e_t_deföed
 1

	)

111 #ifde‡
__USE_GNU


112 
	$__USING_NAMESPACE_C99
(
mb°©e_t
)

115 #i‚de‡
WCHAR_MIN


117 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

118 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

121 #i‚de‡
WEOF


122 
	#WEOF
 (0xffffffffu)

	)

127 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_UNIX98


128 
	~<w˘y≥.h
>

132 
__BEGIN_DECLS


134 
__BEGIN_NAMESPACE_STD


137 
tm
;

138 
__END_NAMESPACE_STD


142 
	$__USING_NAMESPACE_STD
(
tm
)

145 
__BEGIN_NAMESPACE_STD


147 
wch¨_t
 *
	$wcs˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

148 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

150 
wch¨_t
 *
	$wc¢˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

151 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

152 
__THROW
;

155 
wch¨_t
 *
	$wcsˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

156 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

158 
wch¨_t
 *
	$wc¢ˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

159 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

160 
__THROW
;

163 
	$wcscmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
)

164 
__THROW
 
__©åibuã_puª__
;

166 
	$wc¢cmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

167 
__THROW
 
__©åibuã_puª__
;

168 
__END_NAMESPACE_STD


170 #ifde‡
__USE_XOPEN2K8


172 
	$wcsˇ£cmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
Ë
__THROW
;

175 
	$wc¢ˇ£cmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

176 
size_t
 
__n
Ë
__THROW
;

180 
	~<xloˇÀ.h
>

182 
	$wcsˇ£cmp_l
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

183 
__loˇÀ_t
 
__loc
Ë
__THROW
;

185 
	$wc¢ˇ£cmp_l
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

186 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

189 
__BEGIN_NAMESPACE_STD


192 
	$wcscﬁl
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
Ë
__THROW
;

196 
size_t
 
	$wcsx‰m
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

197 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
Ë
__THROW
;

198 
__END_NAMESPACE_STD


200 #ifde‡
__USE_XOPEN2K8


206 
	$wcscﬁl_l
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

207 
__loˇÀ_t
 
__loc
Ë
__THROW
;

212 
size_t
 
	$wcsx‰m_l
 (
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

213 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

216 
wch¨_t
 *
	$wcsdup
 (c⁄° 
wch¨_t
 *
__s
Ë
__THROW
 
__©åibuã_mÆloc__
;

219 
__BEGIN_NAMESPACE_STD


221 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


222 "C++" 
wch¨_t
 *
	$wcschr
 (
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

223 
__THROW
 
	`__asm
 ("wcschr"Ë
__©åibuã_puª__
;

224 "C++" c⁄° 
wch¨_t
 *
	$wcschr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

225 
__THROW
 
	`__asm
 ("wcschr"Ë
__©åibuã_puª__
;

227 
wch¨_t
 *
	$wcschr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

228 
__THROW
 
__©åibuã_puª__
;

231 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


232 "C++" 
wch¨_t
 *
	$wc§chr
 (
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

233 
__THROW
 
	`__asm
 ("wc§chr"Ë
__©åibuã_puª__
;

234 "C++" c⁄° 
wch¨_t
 *
	$wc§chr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

235 
__THROW
 
	`__asm
 ("wc§chr"Ë
__©åibuã_puª__
;

237 
wch¨_t
 *
	$wc§chr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

238 
__THROW
 
__©åibuã_puª__
;

240 
__END_NAMESPACE_STD


242 #ifde‡
__USE_GNU


245 
wch¨_t
 *
	$wcsch∫ul
 (c⁄° 
wch¨_t
 *
__s
, wch¨_à
__wc
)

246 
__THROW
 
__©åibuã_puª__
;

249 
__BEGIN_NAMESPACE_STD


252 
size_t
 
	$wcsc•n
 (c⁄° 
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ªje˘
)

253 
__THROW
 
__©åibuã_puª__
;

256 
size_t
 
	$wcs•n
 (c⁄° 
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ac˚±
)

257 
__THROW
 
__©åibuã_puª__
;

259 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


260 "C++" 
wch¨_t
 *
	$wc•brk
 (
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ac˚±
)

261 
__THROW
 
	`__asm
 ("wc•brk"Ë
__©åibuã_puª__
;

262 "C++" c⁄° 
wch¨_t
 *
	$wc•brk
 (c⁄° 
wch¨_t
 *
__wcs
,

263 c⁄° 
wch¨_t
 *
__ac˚±
)

264 
__THROW
 
	`__asm
 ("wc•brk"Ë
__©åibuã_puª__
;

266 
wch¨_t
 *
	$wc•brk
 (c⁄° 
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ac˚±
)

267 
__THROW
 
__©åibuã_puª__
;

270 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


271 "C++" 
wch¨_t
 *
	$wcs°r
 (
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

272 
__THROW
 
	`__asm
 ("wcs°r"Ë
__©åibuã_puª__
;

273 "C++" c⁄° 
wch¨_t
 *
	$wcs°r
 (c⁄° 
wch¨_t
 *
__hay°ack
,

274 c⁄° 
wch¨_t
 *
__√edÀ
)

275 
__THROW
 
	`__asm
 ("wcs°r"Ë
__©åibuã_puª__
;

277 
wch¨_t
 *
	$wcs°r
 (c⁄° 
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

278 
__THROW
 
__©åibuã_puª__
;

282 
wch¨_t
 *
	$wc°ok
 (
wch¨_t
 *
__ª°ri˘
 
__s
,

283 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__dñim
,

284 
wch¨_t
 **
__ª°ri˘
 
__±r
Ë
__THROW
;

287 
size_t
 
	$wc¶í
 (c⁄° 
wch¨_t
 *
__s
Ë
__THROW
 
__©åibuã_puª__
;

288 
__END_NAMESPACE_STD


290 #ifde‡
__USE_XOPEN


292 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


293 "C++" 
wch¨_t
 *
	$wcswcs
 (
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

294 
__THROW
 
	`__asm
 ("wcswcs"Ë
__©åibuã_puª__
;

295 "C++" c⁄° 
wch¨_t
 *
	$wcswcs
 (c⁄° 
wch¨_t
 *
__hay°ack
,

296 c⁄° 
wch¨_t
 *
__√edÀ
)

297 
__THROW
 
	`__asm
 ("wcswcs"Ë
__©åibuã_puª__
;

299 
wch¨_t
 *
	$wcswcs
 (c⁄° 
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

300 
__THROW
 
__©åibuã_puª__
;

304 #ifde‡
__USE_XOPEN2K8


306 
size_t
 
	$wc¢Àn
 (c⁄° 
wch¨_t
 *
__s
, 
size_t
 
__maxÀn
)

307 
__THROW
 
__©åibuã_puª__
;

311 
__BEGIN_NAMESPACE_STD


313 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


314 "C++" 
wch¨_t
 *
	$wmemchr
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
)

315 
__THROW
 
	`__asm
 ("wmemchr"Ë
__©åibuã_puª__
;

316 "C++" c⁄° 
wch¨_t
 *
	$wmemchr
 (c⁄° 
wch¨_t
 *
__s
, wch¨_à
__c
,

317 
size_t
 
__n
)

318 
__THROW
 
	`__asm
 ("wmemchr"Ë
__©åibuã_puª__
;

320 
wch¨_t
 *
	$wmemchr
 (c⁄° 
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
)

321 
__THROW
 
__©åibuã_puª__
;

325 
	$wmemcmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

326 
__THROW
 
__©åibuã_puª__
;

329 
wch¨_t
 *
	$wmem˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

330 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
Ë
__THROW
;

334 
wch¨_t
 *
	$wmemmove
 (
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

335 
__THROW
;

338 
wch¨_t
 *
	$wmem£t
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
Ë
__THROW
;

339 
__END_NAMESPACE_STD


341 #ifde‡
__USE_GNU


344 
wch¨_t
 *
	$wmemp˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

345 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
)

346 
__THROW
;

350 
__BEGIN_NAMESPACE_STD


353 
wöt_t
 
	$btowc
 (
__c
Ë
__THROW
;

357 
	$w˘ob
 (
wöt_t
 
__c
Ë
__THROW
;

361 
	$mbsöô
 (c⁄° 
mb°©e_t
 *
__ps
Ë
__THROW
 
__©åibuã_puª__
;

365 
size_t
 
	$mbπowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

366 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

367 
mb°©e_t
 *
__ª°ri˘
 
__p
Ë
__THROW
;

370 
size_t
 
	$w¸tomb
 (*
__ª°ri˘
 
__s
, 
wch¨_t
 
__wc
,

371 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

374 
size_t
 
	$__mbæí
 (c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

375 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

376 
size_t
 
	$mbæí
 (c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

377 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

378 
__END_NAMESPACE_STD


380 #ifde‡
__USE_EXTERN_INLINES


386 
wöt_t
 
	$__btowc_Æüs
 (
__c
Ë
	`__asm
 ("btowc");

387 
__exã∫_ölöe
 
wöt_t


388 
	`__NTH
 (
	$btowc
 (
__c
))

389 {  (
	`__buûtö_c⁄°™t_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

390 ? (
wöt_t
Ë
__c
 : 
	`__btowc_Æüs
 (__c)); 
	}
}

392 
	$__w˘ob_Æüs
 (
wöt_t
 
__c
Ë
	`__asm
 ("wctob");

393 
__exã∫_ölöe
 

394 
	`__NTH
 (
	$w˘ob
 (
wöt_t
 
__wc
))

395 {  (
	`__buûtö_c⁄°™t_p
 (
__wc
Ë&& __w¯>
L
'\0' && __wc <= L'\x7f'

396 ? (Ë
__wc
 : 
	`__w˘ob_Æüs
 (__wc)); 
	}
}

398 
__exã∫_ölöe
 
size_t


399 
__NTH
 (
	$mbæí
 (c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

400 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

401 {  (
__ps
 !
NULL


402 ? 
	`mbπowc
 (
NULL
, 
__s
, 
__n
, 
__ps
Ë: 
	`__mbæí
 (__s, __n, NULL)); 
	}
}

405 
__BEGIN_NAMESPACE_STD


408 
size_t
 
	$mb§towcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

409 c⁄° **
__ª°ri˘
 
__§c
, 
size_t
 
__Àn
,

410 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

414 
size_t
 
	$wc§tombs
 (*
__ª°ri˘
 
__d°
,

415 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
, 
size_t
 
__Àn
,

416 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

417 
__END_NAMESPACE_STD


420 #ifdef 
__USE_XOPEN2K8


423 
size_t
 
	$mb¢πowcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

424 c⁄° **
__ª°ri˘
 
__§c
, 
size_t
 
__nmc
,

425 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

429 
size_t
 
	$wc¢πombs
 (*
__ª°ri˘
 
__d°
,

430 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
,

431 
size_t
 
__nwc
, size_à
__Àn
,

432 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

437 #ifde‡
__USE_XOPEN


439 
	$wcwidth
 (
wch¨_t
 
__c
Ë
__THROW
;

443 
	$wcswidth
 (c⁄° 
wch¨_t
 *
__s
, 
size_t
 
__n
Ë
__THROW
;

447 
__BEGIN_NAMESPACE_STD


450 
	$wc°od
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

451 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

452 
__END_NAMESPACE_STD


454 #ifde‡
__USE_ISOC99


455 
__BEGIN_NAMESPACE_C99


457 
	$wc°of
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

458 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

459 
	$wc°ﬁd
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

460 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

461 
__END_NAMESPACE_C99


465 
__BEGIN_NAMESPACE_STD


468 
	$wc°ﬁ
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

469 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

473 
	$wc°oul
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

474 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

475 
__THROW
;

476 
__END_NAMESPACE_STD


478 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GNUC__
 && deföed 
__USE_GNU
)

479 
__BEGIN_NAMESPACE_C99


482 
__exãnsi⁄__


483 
	$wc°ﬁl
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

484 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

485 
__THROW
;

489 
__exãnsi⁄__


490 
	$wc°ouŒ
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

491 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

492 
__ba£
Ë
__THROW
;

493 
__END_NAMESPACE_C99


496 #i‡
deföed
 
__GNUC__
 && deföed 
__USE_GNU


499 
__exãnsi⁄__


500 
	$wc°oq
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

501 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

502 
__THROW
;

506 
__exãnsi⁄__


507 
	$wc°ouq
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

508 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

509 
__ba£
Ë
__THROW
;

512 #ifde‡
__USE_GNU


526 
	~<xloˇÀ.h
>

530 
	$wc°ﬁ_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

531 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

532 
__loˇÀ_t
 
__loc
Ë
__THROW
;

534 
	$wc°oul_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

535 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

536 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

538 
__exãnsi⁄__


539 
	$wc°ﬁl_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

540 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

541 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

543 
__exãnsi⁄__


544 
	$wc°ouŒ_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

545 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

546 
__ba£
, 
__loˇÀ_t
 
__loc
)

547 
__THROW
;

549 
	$wc°od_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

550 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

551 
__THROW
;

553 
	$wc°of_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

554 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

555 
__THROW
;

557 
	$wc°ﬁd_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

558 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

559 
__loˇÀ_t
 
__loc
Ë
__THROW
;

563 #ifde‡
__USE_XOPEN2K8


566 
wch¨_t
 *
	$w˝˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

567 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

571 
wch¨_t
 *
	$w˝n˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

572 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

573 
__THROW
;

580 
__FILE
 *
	$›í_wmem°ªam
 (
wch¨_t
 **
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
;

583 #i‡
deföed
 
__USE_ISOC95
 || deföed 
__USE_UNIX98


584 
__BEGIN_NAMESPACE_STD


587 
	$fwide
 (
__FILE
 *
__Â
, 
__mode
Ë
__THROW
;

594 
	`fw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

595 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

601 
	`w¥ötf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

604 
	$sw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

605 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

606 
__THROW
 ;

612 
	`vfw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__s
,

613 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

614 
__gnuc_va_li°
 
__¨g
)

620 
	`vw¥ötf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

621 
__gnuc_va_li°
 
__¨g
)

625 
	$vsw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

626 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

627 
__gnuc_va_li°
 
__¨g
)

628 
__THROW
 ;

635 
	`fwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

636 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

642 
	`wsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

645 
	$swsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

646 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

647 
__THROW
 ;

649 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

650 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

651 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

652 #ifde‡
__REDIRECT


656 
	`__REDIRECT
 (
fwsˇnf
, (
__FILE
 *
__ª°ri˘
 
__°ªam
,

657 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...),

658 
__isoc99_fwsˇnf
)

660 
	`__REDIRECT
 (
wsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...),

661 
__isoc99_wsˇnf
)

663 
	`__REDIRECT_NTH
 (
swsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

664 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

665 ...), 
__isoc99_swsˇnf
)

668 
	`__isoc99_fwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

669 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

670 
	`__isoc99_wsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

671 
	$__isoc99_swsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

672 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

673 
__THROW
;

674 
	#fwsˇnf
 
__isoc99_fwsˇnf


	)

675 
	#wsˇnf
 
__isoc99_wsˇnf


	)

676 
	#swsˇnf
 
__isoc99_swsˇnf


	)

680 
__END_NAMESPACE_STD


683 #ifde‡
__USE_ISOC99


684 
__BEGIN_NAMESPACE_C99


689 
	`vfwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__s
,

690 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

691 
__gnuc_va_li°
 
__¨g
)

697 
	`vwsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

698 
__gnuc_va_li°
 
__¨g
)

701 
	$vswsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

702 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

703 
__gnuc_va_li°
 
__¨g
)

704 
__THROW
 ;

706 #i‡!
deföed
 
__USE_GNU
 \

707 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

708 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

709 #ifde‡
__REDIRECT


710 
	`__REDIRECT
 (
vfwsˇnf
, (
__FILE
 *
__ª°ri˘
 
__s
,

711 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

712 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vfwsˇnf
)

714 
	`__REDIRECT
 (
vwsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

715 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vwsˇnf
)

717 
	`__REDIRECT_NTH
 (
vswsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

718 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

719 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vswsˇnf
)

722 
	`__isoc99_vfwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__s
,

723 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

724 
__gnuc_va_li°
 
__¨g
);

725 
	`__isoc99_vwsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

726 
__gnuc_va_li°
 
__¨g
);

727 
	$__isoc99_vswsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

728 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

729 
__gnuc_va_li°
 
__¨g
Ë
__THROW
;

730 
	#vfwsˇnf
 
__isoc99_vfwsˇnf


	)

731 
	#vwsˇnf
 
__isoc99_vwsˇnf


	)

732 
	#vswsˇnf
 
__isoc99_vswsˇnf


	)

736 
__END_NAMESPACE_C99


740 
__BEGIN_NAMESPACE_STD


745 
wöt_t
 
	`fgëwc
 (
__FILE
 *
__°ªam
);

746 
wöt_t
 
	`gëwc
 (
__FILE
 *
__°ªam
);

752 
wöt_t
 
	`gëwch¨
 ();

759 
wöt_t
 
	`Âutwc
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

760 
wöt_t
 
	`putwc
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

766 
wöt_t
 
	`putwch¨
 (
wch¨_t
 
__wc
);

774 
wch¨_t
 *
	`fgëws
 (wch¨_à*
__ª°ri˘
 
__ws
, 
__n
,

775 
__FILE
 *
__ª°ri˘
 
__°ªam
);

781 
	`Âutws
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__ws
,

782 
__FILE
 *
__ª°ri˘
 
__°ªam
);

789 
wöt_t
 
	`ungëwc
 (wöt_à
__wc
, 
__FILE
 *
__°ªam
);

790 
__END_NAMESPACE_STD


793 #ifde‡
__USE_GNU


801 
wöt_t
 
	`gëwc_u∆ocked
 (
__FILE
 *
__°ªam
);

802 
wöt_t
 
	`gëwch¨_u∆ocked
 ();

810 
wöt_t
 
	`fgëwc_u∆ocked
 (
__FILE
 *
__°ªam
);

818 
wöt_t
 
	`Âutwc_u∆ocked
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

827 
wöt_t
 
	`putwc_u∆ocked
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

828 
wöt_t
 
	`putwch¨_u∆ocked
 (
wch¨_t
 
__wc
);

837 
wch¨_t
 *
	`fgëws_u∆ocked
 (wch¨_à*
__ª°ri˘
 
__ws
, 
__n
,

838 
__FILE
 *
__ª°ri˘
 
__°ªam
);

846 
	`Âutws_u∆ocked
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__ws
,

847 
__FILE
 *
__ª°ri˘
 
__°ªam
);

851 
__BEGIN_NAMESPACE_C99


855 
size_t
 
	$wcs·ime
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

856 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

857 c⁄° 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

858 
__END_NAMESPACE_C99


860 #ifde‡
__USE_GNU


861 
	~<xloˇÀ.h
>

865 
size_t
 
	$wcs·ime_l
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

866 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

867 c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

868 
__loˇÀ_t
 
__loc
Ë
__THROW
;

877 #i‡
deföed
 
__USE_UNIX98
 && !deföed 
__USE_GNU


878 
	#__√ed_iswxxx


	)

879 
	~<w˘y≥.h
>

883 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


884 
	~<bôs/wch¨2.h
>

887 #ifde‡
__LDBL_COMPAT


888 
	~<bôs/wch¨-ldbl.h
>

891 
__END_DECLS


899 #unde‡
__√ed_mb°©e_t


900 #unde‡
__√ed_wöt_t


	@/usr/include/wctype.h

23 #i‚de‡
_WCTYPE_H


25 
	~<„©uªs.h
>

26 
	~<bôs/ty≥s.h
>

28 #i‚de‡
__√ed_iswxxx


29 
	#_WCTYPE_H
 1

	)

32 
	#__√ed_wöt_t


	)

33 
	~<wch¨.h
>

37 #i‚de‡
WEOF


38 
	#WEOF
 (0xffffffffu)

	)

41 #unde‡
__√ed_iswxxx


46 #i‚de‡
__iswxxx_deföed


47 
	#__iswxxx_deföed
 1

	)

49 
__BEGIN_NAMESPACE_C99


52 
	tw˘y≥_t
;

53 
	g__END_NAMESPACE_C99


55 #i‚de‡
_ISwbô


60 
	~<ídün.h
>

61 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


62 
	#_ISwbô
(
bô
Ë(1 << (bô))

	)

64 
	#_ISwbô
(
bô
) \

65 ((
bô
) < 8 ? () ((1UL << (bit)) << 24) \

66 : ((
bô
) < 16 ? () ((1UL << (bit)) << 8) \

67 : ((
bô
) < 24 ? () ((1UL << (bit)) >> 8) \

68 : (Ë((1UL << (
bô
)Ë>> 24))))

	)

73 
	m__ISwuµî
 = 0,

74 
	m__ISwlowî
 = 1,

75 
	m__ISwÆpha
 = 2,

76 
	m__ISwdigô
 = 3,

77 
	m__ISwxdigô
 = 4,

78 
	m__ISw•a˚
 = 5,

79 
	m__ISw¥öt
 = 6,

80 
	m__ISwgøph
 = 7,

81 
	m__ISwbœnk
 = 8,

82 
	m__ISw˙ål
 = 9,

83 
	m__ISwpun˘
 = 10,

84 
	m__ISwÆnum
 = 11,

86 
	m_ISwuµî
 = 
_ISwbô
 (
__ISwuµî
),

87 
	m_ISwlowî
 = 
_ISwbô
 (
__ISwlowî
),

88 
	m_ISwÆpha
 = 
_ISwbô
 (
__ISwÆpha
),

89 
	m_ISwdigô
 = 
_ISwbô
 (
__ISwdigô
),

90 
	m_ISwxdigô
 = 
_ISwbô
 (
__ISwxdigô
),

91 
	m_ISw•a˚
 = 
_ISwbô
 (
__ISw•a˚
),

92 
	m_ISw¥öt
 = 
_ISwbô
 (
__ISw¥öt
),

93 
	m_ISwgøph
 = 
_ISwbô
 (
__ISwgøph
),

94 
	m_ISwbœnk
 = 
_ISwbô
 (
__ISwbœnk
),

95 
	m_ISw˙ål
 = 
_ISwbô
 (
__ISw˙ål
),

96 
	m_ISwpun˘
 = 
_ISwbô
 (
__ISwpun˘
),

97 
	m_ISwÆnum
 = 
_ISwbô
 (
__ISwÆnum
)

102 
__BEGIN_DECLS


104 
__BEGIN_NAMESPACE_C99


111 
	$iswÆnum
 (
wöt_t
 
__wc
Ë
__THROW
;

117 
	$iswÆpha
 (
wöt_t
 
__wc
Ë
__THROW
;

120 
	$isw˙ål
 (
wöt_t
 
__wc
Ë
__THROW
;

124 
	$iswdigô
 (
wöt_t
 
__wc
Ë
__THROW
;

128 
	$iswgøph
 (
wöt_t
 
__wc
Ë
__THROW
;

133 
	$iswlowî
 (
wöt_t
 
__wc
Ë
__THROW
;

136 
	$isw¥öt
 (
wöt_t
 
__wc
Ë
__THROW
;

141 
	$iswpun˘
 (
wöt_t
 
__wc
Ë
__THROW
;

146 
	$isw•a˚
 (
wöt_t
 
__wc
Ë
__THROW
;

151 
	$iswuµî
 (
wöt_t
 
__wc
Ë
__THROW
;

156 
	$iswxdigô
 (
wöt_t
 
__wc
Ë
__THROW
;

161 #ifde‡
__USE_ISOC99


162 
	$iswbœnk
 (
wöt_t
 
__wc
Ë
__THROW
;

171 
w˘y≥_t
 
	$w˘y≥
 (c⁄° *
__¥›îty
Ë
__THROW
;

175 
	$isw˘y≥
 (
wöt_t
 
__wc
, 
w˘y≥_t
 
__desc
Ë
__THROW
;

176 
__END_NAMESPACE_C99


183 
__BEGIN_NAMESPACE_C99


186 c⁄° 
	t__öt32_t
 *
	tw˘øns_t
;

187 
__END_NAMESPACE_C99


188 #ifde‡
__USE_GNU


189 
	$__USING_NAMESPACE_C99
(
w˘øns_t
)

192 
__BEGIN_NAMESPACE_C99


194 
wöt_t
 
	$towlowî
 (
wöt_t
 
__wc
Ë
__THROW
;

197 
wöt_t
 
	$towuµî
 (
wöt_t
 
__wc
Ë
__THROW
;

198 
__END_NAMESPACE_C99


200 
__END_DECLS


207 #ifde‡
_WCTYPE_H


213 
__BEGIN_DECLS


215 
__BEGIN_NAMESPACE_C99


218 
w˘øns_t
 
	$w˘øns
 (c⁄° *
__¥›îty
Ë
__THROW
;

221 
wöt_t
 
	$tow˘øns
 (
wöt_t
 
__wc
, 
w˘øns_t
 
__desc
Ë
__THROW
;

222 
__END_NAMESPACE_C99


224 #ifde‡
__USE_XOPEN2K8


226 
	~<xloˇÀ.h
>

230 
	$iswÆnum_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

236 
	$iswÆpha_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

239 
	$isw˙ål_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

243 
	$iswdigô_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

247 
	$iswgøph_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

252 
	$iswlowî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

255 
	$isw¥öt_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

260 
	$iswpun˘_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

265 
	$isw•a˚_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

270 
	$iswuµî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

275 
	$iswxdigô_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

280 
	$iswbœnk_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

284 
w˘y≥_t
 
	$w˘y≥_l
 (c⁄° *
__¥›îty
, 
__loˇÀ_t
 
__loˇÀ
)

285 
__THROW
;

289 
	$isw˘y≥_l
 (
wöt_t
 
__wc
, 
w˘y≥_t
 
__desc
, 
__loˇÀ_t
 
__loˇÀ
)

290 
__THROW
;

298 
wöt_t
 
	$towlowî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

301 
wöt_t
 
	$towuµî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

305 
w˘øns_t
 
	$w˘øns_l
 (c⁄° *
__¥›îty
, 
__loˇÀ_t
 
__loˇÀ
)

306 
__THROW
;

309 
wöt_t
 
	$tow˘øns_l
 (
wöt_t
 
__wc
, 
w˘øns_t
 
__desc
,

310 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

314 
__END_DECLS


	@
1
.
1
/usr/include
276
5717
config.h
include/openflow/nicira-ext.h
include/openflow/of_hw_api.h
include/openflow/openflow-ext.h
include/openflow/openflow-netlink.h
include/openflow/openflow.h
include/openflow/private-ext.h
lib/backtrace.c
lib/backtrace.h
lib/byte-order.h
lib/command-line.c
lib/command-line.h
lib/compiler.h
lib/csum.c
lib/csum.h
lib/daemon.c
lib/daemon.h
lib/dhcp-client.c
lib/dhcp-client.h
lib/dhcp.c
lib/dhcp.h
lib/dhparams.h
lib/dirs.c
lib/dirs.h
lib/dpif.c
lib/dpif.h
lib/dynamic-string.c
lib/dynamic-string.h
lib/fatal-signal.c
lib/fatal-signal.h
lib/fault.c
lib/fault.h
lib/flow.c
lib/flow.h
lib/hash.c
lib/hash.h
lib/hmap.c
lib/hmap.h
lib/ipv6_util.c
lib/ipv6_util.h
lib/leak-checker.c
lib/leak-checker.h
lib/list.c
lib/list.h
lib/mac-learning.c
lib/mac-learning.h
lib/netdev.c
lib/netdev.h
lib/netlink-protocol.h
lib/netlink.c
lib/netlink.h
lib/ofp.c
lib/ofp.h
lib/ofpbuf.c
lib/ofpbuf.h
lib/ofpstat.c
lib/ofpstat.h
lib/packets.h
lib/pcap.c
lib/pcap.h
lib/poll-loop.c
lib/poll-loop.h
lib/port-array.c
lib/port-array.h
lib/process.c
lib/process.h
lib/queue.c
lib/queue.h
lib/random.c
lib/random.h
lib/rconn.c
lib/rconn.h
lib/sat-math.h
lib/shash.c
lib/shash.h
lib/signals.c
lib/signals.h
lib/socket-util.c
lib/socket-util.h
lib/stp.c
lib/stp.h
lib/svec.c
lib/svec.h
lib/tag.c
lib/tag.h
lib/timeval.c
lib/timeval.h
lib/type-props.h
lib/unaligned.h
lib/util.c
lib/util.h
lib/vconn-netlink.c
lib/vconn-provider.h
lib/vconn-ssl.c
lib/vconn-ssl.h
lib/vconn-stream.c
lib/vconn-stream.h
lib/vconn-tcp.c
lib/vconn-unix.c
lib/vconn.c
lib/vconn.h
lib/vlog-socket.c
lib/vlog-socket.h
lib/vlog.c
lib/vlog.h
lib/xtoxll.h
nbee_link/nbee_link.h
oflib-exp/ofl-exp-nicira.c
oflib-exp/ofl-exp-nicira.h
oflib-exp/ofl-exp-openflow.c
oflib-exp/ofl-exp-openflow.h
oflib-exp/ofl-exp.c
oflib-exp/ofl-exp.h
oflib/ofl-actions-pack.c
oflib/ofl-actions-print.c
oflib/ofl-actions-unpack.c
oflib/ofl-actions.c
oflib/ofl-actions.h
oflib/ofl-log-vlog-cc.h
oflib/ofl-log-vlog.h
oflib/ofl-log.h
oflib/ofl-messages-pack.c
oflib/ofl-messages-print.c
oflib/ofl-messages-unpack.c
oflib/ofl-messages.c
oflib/ofl-messages.h
oflib/ofl-packets.h
oflib/ofl-print.c
oflib/ofl-print.h
oflib/ofl-structs-match.c
oflib/ofl-structs-pack.c
oflib/ofl-structs-print.c
oflib/ofl-structs-unpack.c
oflib/ofl-structs.c
oflib/ofl-structs.h
oflib/ofl-utils.h
oflib/ofl.h
oflib/oxm-match.c
oflib/oxm-match.h
secchan/discovery.c
secchan/discovery.h
secchan/failover.c
secchan/failover.h
secchan/in-band.c
secchan/in-band.h
secchan/port-watcher.c
secchan/port-watcher.h
secchan/ratelimit.c
secchan/ratelimit.h
secchan/secchan.c
secchan/secchan.h
secchan/status.c
secchan/status.h
secchan/stp-secchan.c
secchan/stp-secchan.h
udatapath/action_set.c
udatapath/action_set.h
udatapath/crc32.c
udatapath/crc32.h
udatapath/datapath.c
udatapath/datapath.h
udatapath/dp_actions.c
udatapath/dp_actions.h
udatapath/dp_buffers.c
udatapath/dp_buffers.h
udatapath/dp_capabilities.h
udatapath/dp_control.c
udatapath/dp_control.h
udatapath/dp_exp.c
udatapath/dp_exp.h
udatapath/dp_ports.c
udatapath/dp_ports.h
udatapath/flow_entry.c
udatapath/flow_entry.h
udatapath/flow_table.c
udatapath/flow_table.h
udatapath/group_entry.c
udatapath/group_entry.h
udatapath/group_table.c
udatapath/group_table.h
udatapath/match_std.c
udatapath/match_std.h
udatapath/meter_entry.c
udatapath/meter_entry.h
udatapath/meter_table.c
udatapath/meter_table.h
udatapath/packet.c
udatapath/packet.h
udatapath/packet_handle_std.c
udatapath/packet_handle_std.h
udatapath/pipeline.c
udatapath/pipeline.h
udatapath/state_table.c
udatapath/state_table.h
udatapath/udatapath.c
utilities/dpctl.c
utilities/dpctl.h
utilities/ofp-discover.c
utilities/ofp-kill.c
utilities/ofp-read.c
utilities/vlogconf.c
/usr/include/arpa/inet.h
/usr/include/assert.h
/usr/include/boost/static_assert.hpp
/usr/include/ctype.h
/usr/include/dirent.h
/usr/include/dlfcn.h
/usr/include/endian.h
/usr/include/errno.h
/usr/include/fcntl.h
/usr/include/getopt.h
/usr/include/inttypes.h
/usr/include/limits.h
/usr/include/linux/ethtool.h
/usr/include/linux/if_packet.h
/usr/include/linux/if_tun.h
/usr/include/linux/rtnetlink.h
/usr/include/linux/sockios.h
/usr/include/linux/types.h
/usr/include/linux/version.h
/usr/include/malloc.h
/usr/include/math.h
/usr/include/net/ethernet.h
/usr/include/net/if.h
/usr/include/net/if_arp.h
/usr/include/net/route.h
/usr/include/netdb.h
/usr/include/netinet/icmp6.h
/usr/include/netinet/in.h
/usr/include/netinet/tcp.h
/usr/include/pcap.h
/usr/include/poll.h
/usr/include/pthread.h
/usr/include/regex.h
/usr/include/signal.h
/usr/include/stdint.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/syslog.h
/usr/include/time.h
/usr/include/unistd.h
/usr/include/alloca.h
/usr/include/boost/config.hpp
/usr/include/boost/detail/workaround.hpp
/usr/include/features.h
/usr/include/libio.h
/usr/include/linux/filter.h
/usr/include/linux/if_addr.h
/usr/include/linux/if_ether.h
/usr/include/linux/if_link.h
/usr/include/linux/neighbour.h
/usr/include/linux/netlink.h
/usr/include/linux/posix_types.h
/usr/include/pcap/pcap.h
/usr/include/rpc/netdb.h
/usr/include/sched.h
/usr/include/xlocale.h
/usr/include/_G_config.h
/usr/include/boost/config/select_compiler_config.hpp
/usr/include/boost/config/select_platform_config.hpp
/usr/include/boost/config/select_stdlib_config.hpp
/usr/include/boost/config/suffix.hpp
/usr/include/linux/kernel.h
/usr/include/linux/socket.h
/usr/include/linux/stddef.h
/usr/include/pcap/bpf.h
/usr/include/stdc-predef.h
/usr/include/boost/config/no_tr1/utility.hpp
/usr/include/boost/config/posix_features.hpp
/usr/include/boost/non_type.hpp
/usr/include/boost/type.hpp
/usr/include/gconv.h
/usr/include/linux/sysinfo.h
/usr/include/wchar.h
/usr/include/wctype.h
